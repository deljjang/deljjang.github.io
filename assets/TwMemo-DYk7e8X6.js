import{G as W,e as v,r as a,w as R,cf as y,j as t,n as L,v as p,k as S,s as B}from"./index-CCcUv6gy.js";import{T as j,a as E,b as F,c as I,d as N}from"./TwMemoMain-BKJXY07a.js";import{f as $}from"./fireMemoDetail-BI4jE5tU.js";import{g as U,H as q}from"./HomeChartForm-DoH1C7Sm.js";import{g as C}from"./memoFun-DpPhML4t.js";import"./TwTitleItem-CbOnTw63.js";import"./SinyImageList-CRJmSC7p.js";import"./ImageListItem-B-wpsDhC.js";import"./HtmlCode-B9HlM69G.js";/* empty css                 */import"./copy-CMYw6Isf.js";import"./TwBadge-CIWgNE8x.js";import"./ComponentCard-B3VywcOA.js";import"./TwRadio-z4kFf0c9.js";import"./toPropertyKey-DCwh5dYN.js";import"./CodeText-BOJlXFs8.js";import"./commonUtil-DMQ4LLfw.js";import"./useWindowDimensions-COVZ52Oy.js";import"./datetime-BDx6lZXm.js";import"./index.esm-SS4bI5SV.js";import"./TwCheckbox-B8wpOMoY.js";import"./TwTextArea-Cz8CUu0_.js";import"./SinyDate-Dj7Il1ej.js";import"./Grid-CyWkkp2K.js";import"./index-CIXebmk9.js";import"./TextField-m_p4G382.js";import"./InputAdornment-BHxxH06o.js";import"./Popper-CcZwW4Xh.js";import"./Button-bfF4f_L4.js";import"./Chip-BMYAO0uv.js";import"./TwSelect-Cz83Yz1f.js";import"./TwDatePicker-DsgeZB43.js";import"./IpInfo-Cio4lLAw.js";import"./HomeChartSemiDonut-cRKW_lGp.js";const Tt=({setSideContents:H,setSideType:K})=>{const D=W(),{user:r}=v(),s=a.useRef(),n=a.useRef(!0),d=a.useRef(),[m,f]=a.useState(),h=a.useRef(!1),c=R(),e=c.pathname.startsWith("/m")?"memo":c.pathname.startsWith("/home")?"home":c.pathname.startsWith("/bible")?"bible":"default",k=a.useRef(!1);k.current=c?.state?.reflash===!0;const i=y({queryKey:["twTreeData",r?.uid,s.current],queryFn:()=>U(e,r?.uid,s.current)});i.data!==void 0&&i.data!==""&&!h.current&&(h.current=!0);const b=()=>{const o=m;o&&(o.bookmark=o.bookmark==="Y"?"N":"Y"),console.log("onBookmark.memoDetailData.bookmark=",o.bookmark),console.log("onBookmark.rootDb=",e);const u=e==="memo"?`memo_tree/${r.uid}/${d.current}/bm`:`home_txt/${d.current}/bookmark`;B(u,m.bookmark),f({...m,bookmark:o.bookmark})};a.useEffect(()=>{r!==void 0&&r!=null&&i.refetch()},[r]),a.useEffect(()=>{const o=async x=>{if(x!==""&&r){const l=await $(e,r?.uid,x,s.current);e==="memo"&&(l.path=C(i.data,x)),l.code==="404"&&(l.title="No title"),n.current=!1,f(l===void 0?{}:l)}else f({})},u=c.pathname.split("/"),g=u.length>2?u[u.length-1]:"";n.current=!0,d.current=g,o(g)},[c.pathname,r,k.current]),a.useEffect(()=>{r!==void 0&&r!=null&&i.refetch()},[k.current]);const T=o=>{h.current=!1,o!==void 0&&(s.current=o),i.refetch()},w=()=>{if(r==null){alert("로그인 후 이용 가능합니다.");return}const o=`/${e==="memo"?"m":e}/insert/insert`;D(o)},M=o=>{};return t.jsxs(t.Fragment,{children:[t.jsx(a.Suspense,{fallback:t.jsx(S,{}),children:t.jsxs(L,{children:[t.jsx(p,{path:"/edit/:memoId",element:t.jsx(j,{rootDb:e,isLoading:n.current,searchWord:s.current,memoDetailData:m})}),t.jsx(p,{path:"/insert/:memoId",element:t.jsx(j,{rootDb:e,isLoading:n.current,searchWord:s.current,memoDetailData:m})}),t.jsx(p,{path:"/util/:memoId",element:t.jsx(E,{rootDb:e,isLoading:n.current,searchWord:s.current,memoDetailData:m})}),t.jsx(p,{path:"/:memoId",element:t.jsx(F,{rootDb:e,isLoading:n.current,searchWord:s.current,memoDetailData:m,onTreeUpdate:T,onBookmark:b,data:i.data})}),t.jsx(p,{path:"*",element:t.jsx(I,{searchWord:s.current,data:i.data,onNewMemoBtn:w,title:e==="memo"?"메모장":"홈페이지관리",rootDb:e})})]})}),e==="memo"?t.jsx(N,{onSelected:M}):null,d.current===""?t.jsx(q,{data:i.data}):null]})};export{Tt as default};
