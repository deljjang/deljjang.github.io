const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MemoSheetGrid-Dw53CXM0.js","assets/index-DZJXdJZI.js","assets/router-v4BRDFYV.js","assets/vendor-CCYiWZgt.js","assets/index-DXH-viZ_.css","assets/App-BBnVgfD7.js","assets/App-B2l0q4wA.css","assets/MemoDetailEdit-DBTkKZp_.js","assets/HtmlBadge-CGY7bENR.js","assets/TwCheckbox-DSLns_3S.js","assets/TwTextArea-qUZrFlmt.js","assets/IpInfo-D-DAHLOp.js","assets/angle-right-BCeYVboh.js","assets/MemoDetailEdit-CXguKeju.css","assets/MemoDetailUtil-3sqfHG5k.js"])))=>i.map(i=>d[i]);
import{j as t,_ as oe}from"./index-DZJXdJZI.js";import{aI as st,aJ as at,aK as K,aL as ge,aM as We,aN as He,aO as nt,aP as rt,aQ as ot,aR as lt,aS as it,aT as ct,aU as Pe,aV as dt,aW as ut,aX as ve,aY as Z,aZ as Ve,a_ as ke,a$ as Fe,b0 as ue,b1 as ye,a1 as mt,a3 as ht,a9 as ft,b2 as pt,a6 as xt,b as W,b3 as le,ay as ie,i as V,c as Q,e as R,b4 as gt,b5 as Ne,q as g,b6 as vt,b7 as Ye,aC as he,b8 as yt,ad as Xe,b9 as bt,h as D,ba as wt,bb as jt,bc as kt,bd as Nt,be as Ct,bf as St,bg as Lt,bh as Mt,O as Tt,bi as fe,p as E,m as pe,bj as Et,K as Ce,X as Se,H as $t,ae as zt,af as _t,bk as Ot,bl as Bt,bm as It,bn as Rt,bo as At,bp as Ge,bq as Dt,br as Wt,bs as Ht,bt as Pt,bu as Vt,bv as Le,bw as Ft,bx as Yt,by as Xt,bz as Gt,bA as Kt,bB as Ut,bC as Jt,bD as qt}from"./App-BBnVgfD7.js";import{r as c,a as ce,c as Zt,u as de,N as Me,R as ee,e as Qt,f as X}from"./router-v4BRDFYV.js";import{I as es}from"./IpInfo-D-DAHLOp.js";import{S as Ke,a as ts,b as ss}from"./angle-right-BCeYVboh.js";const ae=new WeakMap;let ne;const Ue=(e,a,s)=>(n,r)=>r&&r[0]?r[0][e+"Size"]:at(n)&&"getBBox"in n?n.getBBox()[a]:n[s],as=Ue("inline","width","offsetWidth"),ns=Ue("block","height","offsetHeight");function rs({target:e,borderBoxSize:a}){ae.get(e)?.forEach(s=>{s(e,{get width(){return as(e,a)},get height(){return ns(e,a)}})})}function os(e){e.forEach(rs)}function ls(){typeof ResizeObserver>"u"||(ne=new ResizeObserver(os))}function is(e,a){ne||ls();const s=st(e);return s.forEach(n=>{let r=ae.get(n);r||(r=new Set,ae.set(n,r)),r.add(a),ne?.observe(n)}),()=>{s.forEach(n=>{const r=ae.get(n);r?.delete(a),r?.size||ne?.unobserve(n)})}}const re=new Set;let G;function cs(){G=()=>{const e={get width(){return window.innerWidth},get height(){return window.innerHeight}};re.forEach(a=>a(e))},window.addEventListener("resize",G)}function ds(e){return re.add(e),G||cs(),()=>{re.delete(e),!re.size&&typeof G=="function"&&(window.removeEventListener("resize",G),G=void 0)}}function us(e,a){return typeof e=="function"?ds(e):is(e,a)}function Je(e,a){let s;const n=()=>{const{currentTime:r}=a,l=(r===null?0:r.value)/100;s!==l&&e(l),s=l};return K.preUpdate(n,!0),()=>ge(n)}function ms(...e){const a=!Array.isArray(e[0]),s=a?0:-1,n=e[0+s],r=e[1+s],o=e[2+s],l=e[3+s],i=We(r,o,l);return a?i(n):i}function hs(e,a,s){const n=e.get();let r=null,o=n,l;const i=typeof n=="string"?n.replace(/[\d.-]/g,""):void 0,u=()=>{r&&(r.stop(),r=null)},m=()=>{u(),r=new nt({keyframes:[Ee(e.get()),Ee(o)],velocity:e.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...s,onUpdate:l})};if(e.attach((d,h)=>{o=d,l=p=>h(Te(p,i)),K.postRender(m)},u),He(a)){const d=a.on("change",p=>e.set(Te(p,i))),h=e.on("destroy",d);return()=>{d(),h()}}return u}function Te(e,a){return a?e+a:e}function Ee(e){return typeof e=="number"?e:parseFloat(e)}const fs=50,$e=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),ps=()=>({time:0,x:$e(),y:$e()}),xs={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function ze(e,a,s,n){const r=s[a],{length:o,position:l}=xs[a],i=r.current,u=s.time;r.current=e[`scroll${l}`],r.scrollLength=e[`scroll${o}`]-e[`client${o}`],r.offset.length=0,r.offset[0]=0,r.offset[1]=r.scrollLength,r.progress=rt(0,r.scrollLength,r.current);const m=n-u;r.velocity=m>fs?0:ot(r.current-i,m)}function gs(e,a,s){ze(e,"x",a,s),ze(e,"y",a,s),a.time=s}function vs(e,a){const s={x:0,y:0};let n=e;for(;n&&n!==a;)if(lt(n))s.x+=n.offsetLeft,s.y+=n.offsetTop,n=n.offsetParent;else if(n.tagName==="svg"){const r=n.getBoundingClientRect();n=n.parentElement;const o=n.getBoundingClientRect();s.x+=r.left-o.left,s.y+=r.top-o.top}else if(n instanceof SVGGraphicsElement){const{x:r,y:o}=n.getBBox();s.x+=r,s.y+=o;let l=null,i=n.parentNode;for(;!l;)i.tagName==="svg"&&(l=i),i=n.parentNode;n=l}else break;return s}const xe={start:0,center:.5,end:1};function _e(e,a,s=0){let n=0;if(e in xe&&(e=xe[e]),typeof e=="string"){const r=parseFloat(e);e.endsWith("px")?n=r:e.endsWith("%")?e=r/100:e.endsWith("vw")?n=r/100*document.documentElement.clientWidth:e.endsWith("vh")?n=r/100*document.documentElement.clientHeight:e=r}return typeof e=="number"&&(n=a*e),s+n}const ys=[0,0];function bs(e,a,s,n){let r=Array.isArray(e)?e:ys,o=0,l=0;return typeof e=="number"?r=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?r=e.split(" "):r=[e,xe[e]?e:"0"]),o=_e(r[0],s,n),l=_e(r[1],a),o-l}const ws={All:[[0,0],[1,1]]},js={x:0,y:0};function ks(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function Ns(e,a,s){const{offset:n=ws.All}=s,{target:r=e,axis:o="y"}=s,l=o==="y"?"height":"width",i=r!==e?vs(r,e):js,u=r===e?{width:e.scrollWidth,height:e.scrollHeight}:ks(r),m={width:e.clientWidth,height:e.clientHeight};a[o].offset.length=0;let d=!a[o].interpolate;const h=n.length;for(let p=0;p<h;p++){const w=bs(n[p],m[l],u[l],i[o]);!d&&w!==a[o].interpolatorOffsets[p]&&(d=!0),a[o].offset[p]=w}d&&(a[o].interpolate=We(a[o].offset,it(n),{clamp:!1}),a[o].interpolatorOffsets=[...a[o].offset]),a[o].progress=ct(0,1,a[o].interpolate(a[o].current))}function Cs(e,a=e,s){if(s.x.targetOffset=0,s.y.targetOffset=0,a!==e){let n=a;for(;n&&n!==e;)s.x.targetOffset+=n.offsetLeft,s.y.targetOffset+=n.offsetTop,n=n.offsetParent}s.x.targetLength=a===e?a.scrollWidth:a.clientWidth,s.y.targetLength=a===e?a.scrollHeight:a.clientHeight,s.x.containerLength=e.clientWidth,s.y.containerLength=e.clientHeight}function Ss(e,a,s,n={}){return{measure:r=>{Cs(e,n.target,s),gs(e,s,r),(n.offset||n.target)&&Ns(e,s,n)},notify:()=>a(s)}}const q=new WeakMap,Oe=new WeakMap,me=new WeakMap,Be=e=>e===document.scrollingElement?window:e;function qe(e,{container:a=document.scrollingElement,...s}={}){if(!a)return Pe;let n=me.get(a);n||(n=new Set,me.set(a,n));const r=ps(),o=Ss(a,e,r,s);if(n.add(o),!q.has(a)){const i=()=>{for(const h of n)h.measure(dt.timestamp);K.preUpdate(u)},u=()=>{for(const h of n)h.notify()},m=()=>K.read(i);q.set(a,m);const d=Be(a);window.addEventListener("resize",m,{passive:!0}),a!==document.documentElement&&Oe.set(a,us(a,m)),d.addEventListener("scroll",m,{passive:!0}),m()}const l=q.get(a);return K.read(l,!1,!0),()=>{ge(l);const i=me.get(a);if(!i||(i.delete(o),i.size))return;const u=q.get(a);q.delete(a),u&&(Be(a).removeEventListener("scroll",u),Oe.get(a)?.(),window.removeEventListener("resize",u))}}const Ie=new Map;function Ls(e){const a={value:0},s=qe(n=>{a.value=n[e.axis].progress*100},e);return{currentTime:a,cancel:s}}function Ze({source:e,container:a,...s}){const{axis:n}=s;e&&(a=e);const r=Ie.get(a)??new Map;Ie.set(a,r);const o=s.target??"self",l=r.get(o)??{},i=n+(s.offset??[]).join(",");return l[i]||(l[i]=!s.target&&ut()?new ScrollTimeline({source:a,axis:n}):Ls({container:a,...s})),l[i]}function Ms(e,a){const s=Ze(a);return e.attachTimeline({timeline:a.target?void 0:s,observe:n=>(n.pause(),Je(r=>{n.time=n.iterationDuration*r},s))})}function Ts(e){return e.length===2}function Es(e,a){return Ts(e)?qe(s=>{e(s[a.axis].progress,s)},a):Je(e,Ze(a))}function $s(e,{axis:a="y",container:s=document.scrollingElement,...n}={}){if(!s)return Pe;const r={axis:a,container:s,...n};return typeof e=="function"?Es(e,r):Ms(e,r)}const zs=()=>({scrollX:Z(0),scrollY:Z(0),scrollXProgress:Z(0),scrollYProgress:Z(0)}),se=e=>e?!e.current:!1;function _s({container:e,target:a,...s}={}){const n=ve(zs),r=c.useRef(null),o=c.useRef(!1),l=c.useCallback(()=>(r.current=$s((i,{x:u,y:m})=>{n.scrollX.set(u.current),n.scrollXProgress.set(u.progress),n.scrollY.set(m.current),n.scrollYProgress.set(m.progress)},{...s,container:e?.current||void 0,target:a?.current||void 0}),()=>{r.current?.()}),[e,a,JSON.stringify(s.offset)]);return Ve(()=>{if(o.current=!1,se(e)||se(a)){o.current=!0;return}else return l()},[l]),c.useEffect(()=>{if(o.current)return ke(!se(e)),ke(!se(a)),l()},[l]),n}function Qe(e){const a=ve(()=>Z(e)),{isStatic:s}=c.useContext(Fe);if(s){const[,n]=c.useState(e);c.useEffect(()=>a.on("change",n),[])}return a}function et(e,a){const s=Qe(a()),n=()=>s.set(a());return n(),Ve(()=>{const r=()=>K.preRender(n,!1,!0),o=e.map(l=>l.on("change",r));return()=>{o.forEach(l=>l()),ge(n)}}),s}function Os(e){ue.current=[],e();const a=et(ue.current,e);return ue.current=void 0,a}function Bs(e,a,s,n){if(typeof e=="function")return Os(e);const r=ms(a,s,n);return Array.isArray(e)?Re(e,r):Re([e],([o])=>r(o))}function Re(e,a){const s=ve(()=>[]);return et(e,()=>{s.length=0;const n=e.length;for(let r=0;r<n;r++)s[r]=e[r].get();return a(s)})}function Is(e,a={}){const{isStatic:s}=c.useContext(Fe),n=()=>He(e)?e.get():e;if(s)return Bs(n);const r=Qe(n());return c.useInsertionEffect(()=>hs(r,e,a),[r,JSON.stringify(a)]),r}const Rs=({className:e})=>t.jsx("svg",{className:e,fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",clipRule:"evenodd"})}),As=({className:e})=>t.jsx("svg",{className:e,fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});async function Ds(e,a,s=""){if(a==null||a==="")return"";if(e==="home"){const m=await ye("home/tree");if(m!=null)try{return JSON.parse(m)}catch(d){console.error("Error parsing JSON data:",d)}}const n=e==="home"?"home_txt":s===""?`${e}_tree/${a}`:`${e}_txt/${a}`,r=mt(ht(ft,n)),o=await pt(r);if(!o.exists()||!o.exists())return null;const l=o.val(),i=[{text:"1.React",id:"react",key:"react",parent:"root"},{text:"2.CSS",id:"css",key:"css",parent:"root"},{text:"3.Android",id:"android",key:"android",parent:"root"},{text:"4.Java",id:"java",key:"java",parent:"root"},{text:"5.이미지",id:"image",key:"image",parent:"root"},{text:"6.Etc",id:"etc",key:"etc",parent:"root"}],u=[];e==="home"&&u.push(...i);for(const m in l){const d=l[m];d.id=m;const h={id:m,key:m,text:d.title,parent:e==="home"?d.gbn:d.parent};e==="memo"?(h.icon=d.bm==="Y"?t.jsx(Rs,{className:"w-4 h-4 text-red-500"}):d.icon==="Y"?t.jsx(As,{className:"w-4 h-4 text-green-500"}):null,h.droppable=!0):h.droppable=!1,!((s===""||s===void 0||s===null)&&(h.parent===void 0||h.parent===null||h.parent===""))&&(e==="home"||s===""||s===void 0||s===null?u.push(h):(d.id=m,(d.memo+"").toLowerCase().indexOf(s.toLowerCase())>-1&&(h.parent="root",h.droppable=!1,u.push(h))))}return u.sort((m,d)=>m.title>d.title?1:-1),e==="home"&&xt("home/tree",JSON.stringify(u)),u}const Ws=({isOpen:e,onClose:a,data:s})=>{const{t:n}=W();if(!e||!s)return null;const{label:r,value:o,items:l}=s;return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",onClick:a,children:t.jsxs("div",{className:"bg-white dark:bg-zinc-800 rounded-lg shadow-xl w-11/12 md:w-1/2 lg:w-1/3 max-h-[80vh] flex flex-col",onClick:i=>i.stopPropagation(),children:[t.jsxs("div",{className:"flex justify-between items-center border-b p-4 dark:border-zinc-600",children:[t.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:r}),t.jsx("button",{onClick:a,className:"text-gray-400 hover:bg-gray-200 dark:hover:bg-zinc-700 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center",children:t.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),t.jsxs("div",{className:"p-4 overflow-y-auto",children:[t.jsxs("p",{className:"text-base leading-relaxed text-gray-600 dark:text-gray-300 mb-4",children:[n("count","개수"),": ",t.jsx("span",{className:"font-bold",children:o.toLocaleString()})]}),t.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:n("main_list","주요 목록")}),t.jsx("ul",{className:"list-disc list-inside bg-gray-50 dark:bg-zinc-700 p-3 rounded-md",children:l&&l.length>0?l.map((i,u)=>t.jsx("li",{className:"text-gray-700 dark:text-gray-300",children:i.text},u)):t.jsx("li",{className:"text-gray-500",children:n("no_results","결과 없음")})})]})]})})};function Hs({series:e,labels:a,onDataPointClick:s}){const[n,r]=c.useState({labels:[],colors:le,dataLabels:{style:{colors:["#333"]}},responsive:[{breakpoint:480,options:{chart:{width:"100%"},legend:{position:"bottom"}}}]});return c.useEffect(()=>{r(o=>({...o,labels:a}))},[a]),t.jsx("div",{className:"bg-amber-50 dark:bg-gray-900 shadow-md rounded-sm",children:e&&e.length>0?t.jsx(ie,{type:"donut",series:e,options:n}):t.jsx("div",{className:"text-center text-gray-500",children:"표시할 데이터가 없습니다."})})}function Ps({series:e,labels:a,onDataPointClick:s}){const[n,r]=c.useState({chart:{type:"radar",toolbar:{show:!1},events:{dataPointSelection:(o,l,i)=>{s&&s(i.dataPointIndex)}}},colors:le,plotOptions:{radar:{polygons:{distributed:!0}}},dataLabels:{enabled:!1},xaxis:{categories:[]},legend:{show:!0},tooltip:{theme:"dark",style:{fontSize:"12px"},y:{formatter:o=>o.toLocaleString()}}});return c.useEffect(()=>{r(o=>({...o,xaxis:{...o.xaxis,categories:a}}))},[a]),t.jsx("div",{className:"bg-white dark:bg-black shadow-md rounded-sm w-full h-full",children:e&&e.length>0&&e[0].data.length>0?t.jsx(ie,{type:"radar",series:e,options:n}):t.jsx("div",{className:"text-center text-gray-500 py-10",children:"표시할 데이터가 없습니다."})})}function Vs({series:e,labels:a,onDataPointClick:s}){const[n,r]=c.useState({labels:[],chart:{events:{dataPointSelection:(o,l,i)=>{s&&s(i.dataPointIndex)}}},colors:le,plotOptions:{pie:{startAngle:-90,endAngle:90,offsetY:10}},grid:{padding:{bottom:-80}},dataLabels:{style:{colors:["#333"]}},responsive:[{breakpoint:480,options:{chart:{width:"100%"},legend:{position:"bottom"}}}],tooltip:{theme:"dark",style:{fontSize:"12px"},y:{formatter:o=>o.toLocaleString()}},legend:{show:!0}});return c.useEffect(()=>{r(o=>({...o,labels:a}))},[a]),t.jsx("div",{className:"bg-amber-50 dark:bg-gray-900 shadow-md rounded-sm p-2",children:e&&e.length>0&&t.jsx(ie,{type:"donut",series:e,options:n})})}function Fs({series:e,labels:a,showDownload:s=!0,onDataPointClick:n}){const[r,o]=c.useState({chart:{type:"bar",toolbar:{tools:{download:s}},events:{dataPointSelection:(l,i,u)=>{n&&n(u.dataPointIndex)}}},colors:le,plotOptions:{bar:{borderRadius:4,horizontal:!1,distributed:!0}},dataLabels:{enabled:!1},xaxis:{categories:[]},legend:{show:!1},tooltip:{theme:"dark",style:{fontSize:"12px"},y:{formatter:l=>l.toLocaleString()}}});return c.useEffect(()=>{o(l=>({...l,xaxis:{...l.xaxis,categories:a}}))},[a]),t.jsx("div",{className:"bg-white dark:bg-black shadow-md rounded-sm w-full p-2",children:e&&e.length>0&&e[0].data&&e[0].data.length>0?t.jsx(ie,{type:"bar",series:e,options:r,height:"350"}):t.jsx("div",{className:"text-center text-gray-500 py-10",children:"표시할 데이터가 없습니다."})})}const Ys=({rootDb:e})=>{const{user:a}=V(),{t:s}=W(),n=Q(),r=R(y=>{try{return gt(e)(y)}catch(S){return console.warn("HomeChartForm selector error:",S),{labels:[],series:[],status:"idle",error:null}}}),[o,l]=c.useState(!0),[i,u]=c.useState("donut"),[m,d]=c.useState(!1),[h,p]=c.useState(null),[w,M]=c.useState([]),[$,z]=c.useState([]),[N,_]=c.useState({labels:[],series:[]}),L=["#6366f1","#3b82f6","#22c55e","#ef4444","#f97316","#eab308","#8b5cf6","#d946ef","#14b8a6","#a855f7"],F=[{value:"donut",label:s("donut_chart","도넛 차트")},{value:"bar",label:s("bar_chart","수평 막대 차트")},{value:"radar",label:s("radar_chart","레이더 차트")},{value:"verticalBar",label:s("vertical_bar_chart","수직 막대 차트")},{value:"semiDonut",label:s("semi_donut_chart","반원 도넛 차트")}],T=c.useCallback(y=>{let S=[];if(M(y||[]),y&&y.length>0){const U=y.filter(j=>j.parent==="root").sort((j,O)=>j.text.localeCompare(O.text)),H=(j,O)=>{const P=O.filter(B=>B.parent===j);let I=P.length;for(const B of P)I+=H(B.id,O);return I};S=U.map(j=>({node:j,count:H(j.id,y)})).filter(j=>j.count>=10);const te=S.map(j=>j.node.text),J=S.map(j=>j.count),Y={labels:te,series:J};z(S),_(Y),n(Ne({rootDb:e,data:Y}))}else _({labels:[],series:[]}),n(Ne({rootDb:e,data:{labels:[],series:[]}}));l(!1)},[e,n]),f=c.useCallback(async()=>{l(!0);const y=await Ds(e==="sheet"?"memo":e,a?.uid);T(y)},[e,a?.uid,T]);c.useEffect(()=>{a?.uid&&(r?.labels&&Array.isArray(r.labels)&&r.labels.length>0?(_(r),l(!1)):f())},[e,a?.uid,r?.labels?.length,f]);const x=y=>{if(y<0||y>=$.length)return;const S=$[y].node,U=S.text,H=(j,O)=>{const P=O.filter(B=>B.parent===j);let I=[...P];return P.forEach(B=>{I=[...I,...H(B.id,O)]}),I},J=H(S.id,w).length,Y=w.filter(j=>j.parent===S.id);p({label:U,value:J,items:Y}),d(!0)},b=()=>t.jsx("div",{className:"w-full h-full flex justify-center items-center p-4",children:t.jsxs("div",{className:"w-full h-full bg-gray-200 dark:bg-zinc-800 rounded-md animate-pulse relative overflow-hidden",children:[t.jsx("div",{className:"absolute top-1/4 left-1/4 w-1/2 h-1/2 bg-gray-300 dark:bg-zinc-700 rounded-full opacity-50"}),t.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-1/3 h-1/3 bg-gray-300 dark:bg-zinc-700 rounded-lg opacity-50"})]})}),k=()=>{f()},C=t.jsxs("div",{className:`HomeChartForm ${g.between}`,children:[t.jsx("div",{children:s("count_stats")}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("select",{value:i,onChange:y=>u(y.target.value),className:"rounded-md border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-200 focus:ring-indigo-500 focus:border-indigo-500 text-sm","aria-label":s("select_chart_type","차트 종류 선택"),children:F.map(y=>t.jsx("option",{value:y.value,children:y.label},y.value))}),t.jsx("button",{onClick:k,className:"rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ","aria-label":s("reload_chart"),children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h5M20 20v-5h-5M4 4l1.5 1.5A9 9 0 0121.5 12M20 20l-1.5-1.5A9 9 0 012.5 12"})})})]})]});return t.jsxs("div",{className:`w-full justify-center ${g.card} `,children:[t.jsx("div",{className:"flex pl-6 py-4",children:t.jsx(vt,{title:C})}),o?t.jsx(b,{}):t.jsxs("div",{className:"w-full justify-center items-center",children:[i==="donut"&&t.jsx(Hs,{series:N.series,labels:N.labels,colors:L,onDataPointClick:x}),i==="bar"&&t.jsx(Ye,{series:[{name:s("count"),data:N.series}],labels:N.labels,colors:L,onDataPointClick:x}),i==="radar"&&t.jsx(Ps,{series:[{name:s("count"),data:N.series}],labels:N.labels,colors:L,onDataPointClick:x}),i==="verticalBar"&&t.jsx(Fs,{series:[{name:s("count"),data:N.series}],labels:N.labels,colors:L,onDataPointClick:x}),i==="semiDonut"&&t.jsx(Vs,{series:N.series,labels:N.labels,colors:L,onDataPointClick:x})]}),t.jsx(Ws,{isOpen:m,onClose:()=>d(!1),data:h})]})},Xs=()=>{const[e,a]=c.useState({labels:[],series:[]}),[s,n]=c.useState(null),[r,o]=c.useState({isOpen:!1}),{t:l}=W();return c.useEffect(()=>{(async()=>{const u=await ye("home_cnt");if(u){n(u);const d=Object.keys(u).sort().reverse().slice(0,10),h=d.map(w=>w.split("-").slice(1).join("-")),p=d.map(w=>Object.keys(u[w]).length);a({labels:h,series:p})}})()},[]),t.jsxs("div",{className:`w-full justify-center ${g.card} `,children:[t.jsx("div",{className:"flex pl-6 py-4",children:l("visitors.count")}),t.jsx(Ye,{series:[{name:l("count"),data:e.series}],labels:e.labels,showDownload:!1,onDataPointSelection:(i,u,m)=>{const d=m.dataPointIndex;if(s&&d>-1){const p=Object.keys(s).sort().reverse()[d],w=s[p],M=Object.keys(w).join("<br/>");console.log("filteredNodes=",M),o({isOpen:!0,title:`${p} ${l("visitors.count")}`,message:M,onClose:()=>o({isOpen:!1})})}}}),t.jsx(he,{...r})]})},Gs=({item:e})=>{const{user:a}=V(),s=ce();return t.jsx("div",{onClick:()=>s(`/m/${e.key}`),className:`${g.roundedXl} border border-gray-200 
      bg-white dark:border-gray-800 dark:bg-white/[0.03] 
      overflow-hidden cursor-pointer hover:shadow-md transition-shadow h-full flex flex-col`,children:t.jsx("div",{className:"px-4 py-3",children:t.jsx("h3",{className:"text-base font-medium text-gray-800 dark:text-white/90 truncate",children:e.title})})})};function Ks(){const{user:e}=V(),{t:a}=W(),s=Q(),{items:n,status:r}=R(i=>i.bookmark),o=r==="loading";c.useEffect(()=>{e&&s(yt(e.uid))},[e,s]);const l="grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4";return e===null?t.jsx(t.Fragment,{}):t.jsx(Xe,{title:a("main_list"),children:t.jsx("div",{className:"p-2",children:o?t.jsx(bt,{}):t.jsx("div",{className:`grid ${l} gap-3`,children:n?.map(i=>t.jsx(Gs,{item:i},i.id))})})})}const Us=({rootDb:e})=>{const{user:a}=V(),{t:s}=W(),n=s(e==="memo"?"appMemo":"home_mng"),r=t.jsx("div",{className:`displayTitle text-center  ${g.text3Xl} ${g.textIndigo}`,children:n});return t.jsx(t.Fragment,{children:t.jsx(Xe,{title:r,className:"MemoMain mt-3 mb-5",children:t.jsxs("div",{className:"grid gird-cols-1 md:grid-cols-5 items-center gap-3",children:[a===null?t.jsx("p",{className:`${g.textRed500} ${g.textLgFontSemiboldLeft} ${g.mdColSpan3}`,children:s("login_used")}):t.jsx("p",{className:`${g.textGray600DarkZinc400} text-left ${g.mdColSpan3}`,dangerouslySetInnerHTML:{__html:s("memo_main_guide").replace(`
`,"<br/>")}}),t.jsx("div",{className:`w-full ${g.flexCenter} md:col-span-2`,children:t.jsx(es,{})})]})})})},Ae=e=>{const{t:a}=W(),s=async()=>{try{await wt.purge(),alert("Redux 상태가 초기화되었습니다.")}catch(n){console.error("Redux 상태 초기화 실패:",n),alert("상태 초기화 중 오류가 발생했습니다.")}};return t.jsxs("div",{className:"mx-auto grid w-full max-w-lg grid-cols-6 items-center justify-center gap-2 px-4 py-2 text-center",children:[e.master&&t.jsx(D,{size:"sm",variant:"outlined",color:"brand",onClick:e.onUtil,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l-.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),t.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("util")})]})}),t.jsx(D,{size:"sm",variant:"outlined",color:"brand",onClick:e.onEdit,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),t.jsx("path",{d:"m15 5 4 4"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("edit")})]})}),t.jsx(D,{size:"sm",variant:"outlined",color:"brand",onClick:e.onNewMemo,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M5 12h14"}),t.jsx("path",{d:"M12 5v14"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("new")})]})}),t.jsx(D,{size:"sm",variant:"outlined",color:"error",onClick:e.onDelete,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M3 6h18"}),t.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),t.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("delete")})]})}),e.onCopy&&t.jsx(D,{size:"sm",variant:"outlined",color:"secondary",onClick:e.onCopy,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:t.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("public")})]})}),e.master&&t.jsx(D,{size:"sm",variant:"outlined",color:"danger",onClick:s,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("polyline",{points:"23 4 23 10 17 10"}),t.jsx("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("reset")})]})})]})},Js=Ct("memo/deleteMemo",async({rootDb:e,userId:a,memoId:s},{rejectWithValue:n})=>{try{const r=e==="memo"?`${e}_txt/${a}/${s}`:`${e}_txt/${s}`,o=e==="memo"?`${e}_tree/${a}/${s}`:`${e}/${s}`;return await Lt(r,o),{memoId:s}}catch(r){return console.error("삭제 중 오류 발생:",r),n(r.message)}});function qs(e,a,s,n){const r=Q(),o=R(jt(s)),l=R(kt(s)),i=l==="loading";return c.useEffect(()=>{a?.uid&&s&&s!=="insert"&&l!=="succeeded"&&r(Nt({rootDb:e,userId:a.uid,memoId:s}))},[r,e,a?.uid,s,l]),{memoDetailData:o||{},isLoading:i,onBookmark:()=>{if(!o)return;const m=o.bookmark==="Y"?"N":"Y";r(St({rootDb:e,userId:a.uid,memoId:s,newBookmarkState:m})).unwrap().then(()=>{r(m==="Y"?{type:"bookmark/addBookmarkItem",payload:{...o,id:s,key:s,text:o.title}}:{type:"bookmark/removeBookmarkItem",payload:s})})}}}const Zs=({rootDb:e,searchWord:a})=>{const{user:s}=V(),{memoId:n}=Zt(),r=Q(),{memoDetailData:o,isLoading:l,onBookmark:i}=qs(e,s,n),[u,m]=c.useState(!1),{alertInfo:d,setAlertInfo:h,resetAlertInfo:p}=Mt(),[w,M]=c.useState(!1),[$,z]=c.useState(""),[N,_]=c.useState(!1),[L,F]=c.useState(""),[T,f]=c.useState(!1),{t:x}=W(),{scrollYProgress:b}=_s(),k=Is(b,{stiffness:100,damping:30,restDelta:.001}),C=ce(),S=de()?.state?.fullIndex,U=R(v=>v.treeData.data),H=async()=>{if(!s||!n||e!=="memo"){h({isOpen:!0,title:x("error"),message:"Only private memos can be copied.",color:"error",onConfirm:p,onClose:p});return}try{await r(At({userId:s.uid,memoId:n,memoDetailData:o})).unwrap(),h({isOpen:!0,title:x("complete"),message:x("copy_completed"),color:"success",onConfirm:p,onClose:p})}catch(v){console.error("Copy failed:",v);const A=`${x("copy_failed")} ${v?`: ${v}`:""}`;h({isOpen:!0,title:x("error"),message:A,color:"error",onConfirm:p,onClose:p})}},te=()=>{r(It({rootDb:e,memoId:n,newMemoContent:$})).unwrap().then(()=>{M(!1)}).catch(v=>{console.error("메모 저장 중 오류 발생:",v)})},J=()=>{z(o?.memo||""),M(!0)},Y=()=>{F(o?.title||""),_(!0)},j=v=>{F(v.target.value)},O=()=>{r(Ot({rootDb:e,userId:s.uid,memoId:n,newTitle:L})).unwrap().then(()=>{_(!1),r({type:"tabs/updateTabTitle",payload:{id:n,title:L}}),r({type:"bookmark/updateBookmarkTitle",payload:{id:n,title:L}}),r(Bt({id:n,newTitle:L}))}).catch(v=>{console.error("제목 업데이트 중 오류 발생:",v),_(!1)})},P=v=>{v.key==="Enter"?O():v.key==="Escape"&&_(!1)},I=()=>{const v=`/${e==="memo"?"m":e}/edit/${n}`;C(v,{state:{fullIndex:S}})},B=()=>{const v=`/${e==="memo"?"m":e}/util/${n}`;C(v,{state:{fullIndex:S}})},be=()=>{const v=`/${e==="memo"?"m":e}/insert/${n}`;C(v,{state:{fullIndex:S}})},we=()=>{m(!0)},je=()=>{H()},tt=async()=>{m(!1);try{r({type:"tabs/setDeleteId",payload:n}),r({type:"tabs/removeTab",payload:n}),C(`/${e==="memo"?"m":e}`),await r(Js({rootDb:e,userId:s.uid,memoId:n})).unwrap(),e==="memo"&&await r(Rt({userId:s.uid,nodeId:n,currentTreeData:U})).unwrap()}catch(v){console.error("삭제 중 오류 발생:",v)}};return c.useEffect(()=>{function v(){const A=o.scrollY?o.scrollY:0;window.scrollTo({top:A})}o&&o.memo!==null&&(v(),o.image&&o.image.map((A,la)=>A),Tt({title:o.title,description:""}))},[o]),n===""||s===void 0?null:l?t.jsx(fe,{}):o?t.jsxs("div",{className:"MemoDetail py-4 relative rounded-t-lg",children:[t.jsx(E.div,{className:`progress-bar sticky ${T?"top-28":"top-16"} z-10`,style:{scaleX:k}}),t.jsxs("div",{className:"MemoDetail_body overflow-hidden ",children:[t.jsxs("div",{className:`sticky top-0 z-20 ${g.card} backdrop-blur-sm`,children:[t.jsxs("div",{className:"p-3 sm:p-4",children:[t.jsxs("div",{className:g.between,children:[t.jsxs("p",{className:`${g.truncate} ${g.textXs} ${g.textGray500DarkZinc400}`,children:[t.jsx(Me,{to:e==="memo"?"/m":"/home",className:"hover:!text-gray-900 dark:hover:!text-white",children:e==="memo"?"MEMO":"HOME"}),o?.path?.map((v,A)=>o.path.length===A+1?` > ${v?.title}`:t.jsxs(ee.Fragment,{children:[" "," > ",t.jsx(Me,{to:e==="memo"?`/m/${v.id}`:`/home/${v.id}`,className:"hover:!text-gray-900 dark:hover:!text-white",children:v?.title})]},A))]}),t.jsx(E.button,{whileTap:{scale:.8},className:`${g.flexShrink0} ${g.roundedFull} p-2 ${g.buttonHoverGrayLight}`,"aria-label":x("bookmark"),onClick:i,children:o?.bookmark==="Y"?t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`${g.h5W5} ${g.textRed500}`,fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}):t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`${g.h5W5} ${g.textGray500}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})})]}),N?t.jsx("input",{type:"text",value:L,onChange:j,onKeyDown:P,onBlur:O,className:`w-full bg-transparent border-b-2 border-blue-500 focus:outline-none 
													${g.heading2XlBoldSm3Xl} ${g.textGray900}`,autoFocus:!0}):t.jsx("div",{onDoubleClick:Y,className:`MemoDetail_Title text-left ${g.heading2XlBoldSm3Xl} ${g.textGray900} cursor-pointer`,children:o?.title}),t.jsx("button",{onClick:()=>f(!T),className:`${g.floatingActionButton} absolute top-11 sm:top-14 right-2 sm:right-3`,children:t.jsx(E.div,{animate:{rotate:T?135:0},children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})})]}),t.jsx(E.div,{initial:!1,animate:{height:T?"auto":0,opacity:T?1:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:t.jsx("div",{className:"border-t border-gray-200 bg-gray-50 dark:border-zinc-800 dark:bg-zinc-900/50",children:t.jsx(Ae,{master:s?.uid===pe,rootDb:e,onEdit:I,onUtil:B,onNewMemo:be,onDelete:we,onCopy:e==="memo"?je:null})})})]}),o&&o.html==="sheet"&&t.jsx(Et,{rootDb:e,detailData:o}),t.jsxs("div",{className:`MemoDetail_Content ${o?.memo?.length>0?`${g.card} my-4 p-2 sm:p-4`:"p-1"}`,onDoubleClick:J,children:[w?t.jsxs("div",{className:`${g.card} p-4`,children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Ce,{children:x("input")}),t.jsx("textarea",{className:"w-full min-h-[100px] p-2 border rounded dark:bg-gray-700 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500",value:$,rows:`${$.split(/\r\n|\r|\n/g).length}`,onChange:v=>z(v.target.value),autoFocus:!0})]}),t.jsxs("div",{children:[t.jsx(Ce,{children:x("preview")}),t.jsx("div",{className:"prose dark:prose-invert max-w-none p-2 border rounded min-h-[100px] overflow-y-auto dark:bg-gray-700 dark:border-gray-600",children:t.jsx(Se,{postData:$,highlightWord:""})})]})]}),t.jsxs("div",{className:"mt-2 flex justify-end gap-2",children:[t.jsx(D,{variant:"outlined",color:g.button.indigo,size:"sm",onClick:()=>M(!1),children:x("cancel")}),t.jsx(D,{color:g.button.indigo,onClick:te,children:x("save")})]})]}):o&&o.html!=="sheet"?o?.html==="N"?t.jsx(Se,{postData:o?.memo,highlightWord:a}):o?.html!=="N"&&o?.memo&&t.jsx($t,{text:o.memo}):"",t.jsx(zt,{imageList:o?.image}),!o&&t.jsx("div",{className:"flex justify-center py-12",children:t.jsx("div",{className:`${g.flexCenter} py-12`})})]})]}),t.jsx(_t,{rootDb:e,memoId:n,enableEdit:!0}),t.jsx(E.div,{initial:!1,animate:{height:T?"auto":0,opacity:T?1:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:t.jsx("div",{className:`${g.line}`,children:t.jsx(Ae,{master:s?.uid===pe,rootDb:e,onEdit:I,onUtil:B,onNewMemo:be,onDelete:we,onCopy:e==="memo"?je:null})})}),t.jsx(he,{isOpen:u,size:"sm",color:"warning",title:x("delete_confirm_title"),message:x("delete_confirm_message"),onClose:()=>m(!1),onConfirm:tt}),t.jsx(he,{...d})]}):t.jsx("div",{children:"데이터가 없습니다."})},Qs=ee.lazy(()=>oe(()=>import("./MemoSheetGrid-Dw53CXM0.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),De=ee.lazy(()=>oe(()=>import("./MemoDetailEdit-DBTkKZp_.js"),__vite__mapDeps([7,1,2,3,4,5,6,8,9,10,11,12,13]))),ea=ee.lazy(()=>oe(()=>import("./MemoDetailUtil-3sqfHG5k.js"),__vite__mapDeps([14,1,2,3,4,5,6,10,8,11,12]))),ta=ee.lazy(()=>oe(()=>import("./App-BBnVgfD7.js").then(e=>e.c2),__vite__mapDeps([5,1,2,3,4,6]))),sa=({rootDb:e,user:a,memoId:s,isLoading:n,onBookmark:r,handleCloseTab:o})=>{const l=de();return t.jsx(c.Suspense,{fallback:t.jsx(fe,{}),children:t.jsx(Ge,{children:t.jsxs(Qt,{location:l,children:[t.jsx(X,{path:"todo",element:t.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(ta,{})})}),t.jsx(X,{path:"sheet/:sheetId?",element:t.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(Qs,{})})}),t.jsx(X,{path:"edit/:memoId",element:t.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(De,{rootDb:e,isLoading:n})})}),t.jsx(X,{path:"insert/:memoId",element:t.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(De,{rootDb:e,isLoading:n})})}),t.jsx(X,{path:"util/:memoId",element:t.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(ea,{rootDb:e,isLoading:n})})}),t.jsx(X,{path:":memoId",element:t.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:n?t.jsx(fe,{}):t.jsx(Zs,{rootDb:e,onBookmark:r,onDeleteTab:()=>{o&&o(null,{id:s})}})})})]},l.pathname)})})},aa=e=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...e,children:t.jsx("path",{fillRule:"evenodd",d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zM6 20V4h7v5h5v11H6zM8 12h3v3H8v-3zm0 4h3v3H8v-3zm4-4h3v3h-3v-3zm0 4h3v3h-3v-3z",clipRule:"evenodd"})}),na=({tabInfo:e,handleCloseTab:a,isActive:s,onClickTab:n})=>{const{t:r}=W(),{user:o}=V(),{attributes:l,listeners:i,setNodeRef:u,transform:m,transition:d,isDragging:h}=Dt({id:e.id}),p={transform:Wt.Transform?.toString(m),transition:d,zIndex:h?1:"auto"};return t.jsxs("div",{ref:u,style:p,...l,...i,"data-tab-id":e.id,onClick:n,title:e.title,className:`SortableTab group relative flex flex-shrink-0 items-center pl-3 pr-2 py-1.5 text-sm rounded-t-md transition-colors duration-200 min-w-28 max-w-48 border-b-2 cursor-pointer
				${s?"bg-gray-200 dark:bg-zinc-700 border-blue-500 text-gray-800 dark:text-gray-100":"border-transparent text-secondary hover:bg-gray-200/70 dark:hover:bg-zinc-700/70"}
				${h?"opacity-50 shadow-lg":""}`,children:[e.rootDb==="memo"?t.jsx(Ht,{className:`w-5 h-5 mr-1 flex-shrink-0 transition-transform duration-200 ${s?"scale-110":""}`,fill:"currentColor"}):e.rootDb==="sheet"?t.jsx(aa,{className:`w-5 h-5 mr-1 flex-shrink-0 transition-transform duration-200 ${s?"scale-110":""}`}):null,t.jsx("span",{className:"truncate pr-1",style:{fontFamily:"sans-serif"},children:e.title||r("loading")}),t.jsx("button",{onClick:w=>{w.preventDefault(),w.stopPropagation(),a(e.id)},className:`ml-auto flex-shrink-0 p-1 rounded-full transition-opacity duration-200 opacity-0 group-hover:opacity-100
					text-gray-500 dark:text-gray-400 
					hover:bg-gray-300/50 dark:hover:bg-gray-600/50 hover:text-gray-700 dark:hover:text-white
				`,children:t.jsx(Ke,{className:"w-3 h-3"})})]})},ra=c.memo(({rootDb:e,user:a})=>{const s=c.useRef(null),[n,r]=c.useState({left:!1,right:!1}),[o,l]=c.useState(!0),i=c.useRef(0),u=ce(),m=de(),d=m.pathname.split("/").pop(),h=Q(),p=R(f=>f?.tabs?.tabs||[]),w=R(f=>f?.tabs?.activeTab||null),M=R(f=>f?.tabs?.deleteId||null),$=c.useRef(null);c.useEffect(()=>{if((async()=>{if(M!==d&&d&&d!=="insert"&&m.pathname!=="/m"&&m.pathname!=="/home")if(p.some(b=>b.id===d))w!==d&&p.some(b=>b.id===d)&&$.current===null&&h(Le(d));else{let b="Loading...";try{let k;if(e==="sheet"?k=`memo_sheet/${a?.uid}/${d}/title`:e==="memo"?k=`${e}_txt/${a?.uid}/${d}/title`:e==="home"&&(k=`${e}_txt/${d}/title`),k){const C=await ye(k);C&&(b=C)}}catch(k){console.error("Error fetching tab title:",k)}h(Jt({id:d,path:m.pathname,rootDb:e,title:b}))}})(),$.current=null,M){const x=setTimeout(()=>{h(Pt())},500);return()=>clearTimeout(x)}},[d,m.pathname,e,w,a?.uid,M,p,h]);const z=c.useCallback(()=>{const f=s.current;if(f){const x=f.scrollWidth>f.clientWidth,b=f.scrollLeft===0,k=f.scrollLeft+f.clientWidth>=f.scrollWidth-1;r(C=>{const y={left:x&&!b,right:x&&!k};return C.left===y.left&&C.right===y.right?C:y})}},[]);c.useEffect(()=>{const f=()=>{const x=window.pageYOffset||document.documentElement.scrollTop;x>i.current?l(!1):l(!0),i.current=x<=0?0:x};return window.addEventListener("scroll",f),()=>{window.removeEventListener("scroll",f)}},[]);const N=f=>{s.current?.scrollBy({left:f==="left"?-200:200,behavior:"smooth"})},_=c.useCallback(f=>{const x=p.findIndex(b=>b.id===f);if(x!==-1&&(h(Vt(f)),h({type:"tabs/setDeleteId",payload:f}),w===f))if(p.length>1){const b=x>0?x-1:0,k=p[b===x?b+1:b];u(k.path)}else u(e==="memo"?"/m":"/home")},[p,w,h,u,e]),L=c.useCallback(f=>{const x=f.split("/").pop();$.current=x,h(Le(x)),requestAnimationFrame(()=>{u(f)})},[h,u]),F=c.useCallback(()=>{h(Ft())},[h]),T=c.useCallback(f=>{const{active:x,over:b}=f;if(b&&x.id!==b.id){const k=p.findIndex(y=>y.id===x.id),C=p.findIndex(y=>y.id===b.id);h(Yt(Xt(p,k,C)))}},[p,h]);return c.useEffect(()=>{z();const f=s.current;return f?.addEventListener("scroll",z),window.addEventListener("resize",z),()=>{f?.removeEventListener("scroll",z),window.removeEventListener("resize",z)}},[z,p.length]),t.jsx("div",{className:`MemoTabs sticky ${o?"top-18":"top-1"} z-1000 rounded-t-md bg-gray-50/70 dark:bg-zinc-800/70 backdrop-blur-sm shadow-sm`,children:t.jsxs("div",{className:"relative flex items-center justify-between ",children:[n.left&&t.jsx("button",{onClick:()=>N("left"),className:"absolute left-0 z-10 p-1 border border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 bg-white dark:bg-zinc-900 dark:hover:!text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full group",children:t.jsx(ts,{className:"w-5 h-5 fill-current"})}),t.jsx(Gt,{id:"memo-tabs",onDragEnd:T,children:t.jsx("div",{ref:s,className:"MemoTabs relative flex items-center overflow-x-scroll scrollbar-hide whitespace-nowrap",children:t.jsx(Kt,{items:p.map(f=>f.id),strategy:Ut,children:t.jsx(Ge,{children:p.map(f=>t.jsx(E.div,{layout:!0,initial:{opacity:0,scale:.8},transition:{type:"spring",stiffness:350,damping:30},animate:{opacity:1,scale:1},exit:{opacity:0,width:0,paddingLeft:0,paddingRight:0,transition:{duration:.3}},children:t.jsx(na,{tabInfo:f,onClickTab:()=>L(f.path),handleCloseTab:_,isActive:f.id===d})},f.id))})})})}),t.jsxs("div",{className:"flex items-center",children:[n.right&&t.jsx("button",{onClick:()=>N("right"),className:"z-10 p-1 border border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 bg-white dark:bg-zinc-900 dark:hover:!text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full group",children:t.jsx(ss,{className:"w-5 h-5 fill-current"})}),p.length>0&&t.jsx("button",{onClick:F,className:"ml-2 mr-2 p-1.5 text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md",title:"Close all tabs",children:t.jsx(Ke,{className:"w-4 h-4"})})]})]})})}),oa=()=>{ce();const{user:e}=V(),a=R(qt),s=de(),{rootDb:n,memoId:r}=c.useMemo(()=>{const o=s.pathname,l=o.startsWith("/m/sheet")?"sheet":o.startsWith("/m")?"memo":o.startsWith("/home")?"home":o.startsWith("/bible")?"bible":"default",i=o.split("/").pop()||"";return{rootDb:l,memoId:i}},[s.pathname]);return t.jsxs(t.Fragment,{children:[a&&t.jsx(ra,{rootDb:n,user:e,activeId:r}),t.jsx(sa,{rootDb:n,user:e,memoId:r}),s.pathname==="/m"&&t.jsx(Us,{rootDb:n}),(n==="memo"||n==="sheet")&&t.jsx(Ks,{}),(s.pathname==="/m"||s.pathname==="/home")&&e?.uid===pe&&t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-5",children:[t.jsx(Xs,{}),t.jsx(Ys,{rootDb:n})]})]})},ha=Object.freeze(Object.defineProperty({__proto__:null,default:oa},Symbol.toStringTag,{value:"Module"}));export{ha as M,Is as a,qs as b,_s as u};
