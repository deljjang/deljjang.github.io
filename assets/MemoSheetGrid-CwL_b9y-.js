import{d7 as k,Q as bu,d8 as Gc,d9 as Hc,da as Wc,db as Yc,dc as Zt,dd as zc,de as $c,df as Xc,dg as Kc,dh as jc,di as qc,dj as Qc,dk as Zc,dl as Jc,dm as ed,dn as td,dp as rd,dq as nd,dr as sd,ds as xu,dt as id,du as ad,dv as Pu,dw as ni,dx as od,dy as ud,dz as Vu,dA as hd,dB as ld,dC as Du,dD as cd,dE as dd,dF as Bu,dG as pd,dH as so,dI as fd,dJ as md,dK as gd,dL as Ed,dM as Rd,dN as Td,dO as Nd,dP as Sd,dQ as Ad,dR as yd,dS as Cd,dT as vd,dU as Id,dV as Od,dW as Md,dX as wd,dY as _d,dZ as Ld,d_ as Fd,d$ as Ud,e0 as bd,e1 as xd,e2 as Pd,e3 as Vd,e4 as Dd,e5 as Bd,e6 as kd,e7 as Gd,e8 as Hd,e9 as Wd,ea as Yd,eb as zd,ec as $d,ed as Xd,ee as Kd,ef as jd,eg as qd,eh as Qd,ei as Zd,ej as Jd,ek as ep,el as tp,em as rp,en as np,eo as sp,ep as ip,eq as ap,er as op,es as up,et as hp,eu as lp,ev as cp,ew as dp,ex as pp,ey as fp,ez as mp,eA as gp,eB as Ep,eC as Rp,eD as Tp,eE as Np,eF as Sp,eG as Ap,eH as yp,eI as Cp,eJ as vp,eK as Ip,eL as Op,eM as Mp,eN as wp,eO as _p,eP as Lp,eQ as Fp,h as ku,j as H,a1 as Jr,bg as Gi,r as ve,O as Up,eR as bp,p as xp,n as Pp,bh as Vp,N as Dp,c9 as io,H as Ni,ch as Bp,be as kp,w as Jn,eS as Gp,bm as Hp,bn as Wp,z as Yp,A as zp,bo as $p,G as Hr}from"./index-PE43pimI.js";import{L as Xp}from"./HtmlCode-7snD5dKt.js";import{A as es}from"./AniButton-De0HIEbo.js";import{T as Kp}from"./TwLoading-Fi4sJgzj.js";import{M as ao}from"./HtmlCode-BKHoQ8ol.js";import"./HtmlText-CDJcmHgc.js";import"./index-DdR5mU5g.js";/* empty css                   */import"./Button-D0F3C60H.js";import"./copy-D6ICVw_0.js";import"./ComponentCard-B2VO4gey.js";import"./TwRadio-DGEYusrO.js";import"./TwBadge-BO57FpWL.js";import"./toPropertyKey-DCwh5dYN.js";function jp(s){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(t){const r=this.first();let n=r.data("handsontable");if(typeof t!="string"){const l=t||{};return n?n.updateSettings(l):(n=new s.Core(r[0],l),r.data("handsontable",n),n.init()),r}let i;if(n)if(typeof n[t]<"u"){for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];i=n[t].call(n,...o),t==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${t}`);return i})}var Si,Ai,yi,Ci,vi;bu();jp(k);k.__GhostTable=Gc;k._getListenersCounter=Hc;k._getRegisteredMapsCounter=Wc;k.EventManager=Yc;const qp=[zc,$c,Xc,Kc,jc,qc,Qc,Zc,Jc,ed,td,rd],Qp=[nd,sd];k.helper={};k.dom={};Zt(qp,s=>{Zt(Object.getOwnPropertyNames(s),e=>{e.charAt(0)!=="_"&&(k.helper[e]=s[e])})});Zt(Qp,s=>{Zt(Object.getOwnPropertyNames(s),e=>{e.charAt(0)!=="_"&&(k.dom[e]=s[e])})});k.cellTypes=(Si=k.cellTypes)!==null&&Si!==void 0?Si:{};Zt(id(),s=>{k.cellTypes[s]=xu(s)});k.cellTypes.registerCellType=ad;k.cellTypes.getCellType=xu;k.editors=(Ai=k.editors)!==null&&Ai!==void 0?Ai:{};Zt(od(),s=>{k.editors[`${ni(s)}Editor`]=Pu(s)});k.editors.registerEditor=ud;k.editors.getEditor=Pu;k.renderers=(yi=k.renderers)!==null&&yi!==void 0?yi:{};Zt(hd(),s=>{const e=Vu(s);s==="base"&&(k.renderers.cellDecorator=e),k.renderers[`${ni(s)}Renderer`]=e});k.renderers.registerRenderer=ld;k.renderers.getRenderer=Vu;k.validators=(Ci=k.validators)!==null&&Ci!==void 0?Ci:{};Zt(cd(),s=>{k.validators[`${ni(s)}Validator`]=Du(s)});k.validators.registerValidator=dd;k.validators.getValidator=Du;k.plugins=(vi=k.plugins)!==null&&vi!==void 0?vi:{};Zt(pd(),s=>{k.plugins[s]=Bu(s)});k.plugins[`${ni(so.PLUGIN_KEY)}Plugin`]=so;k.plugins.registerPlugin=fd;k.plugins.getPlugin=Bu;/**
 * @preserve
 * Authors: Hwang, Gun-gu
 * Last updated: Aug 20, 2018
 *
 * Description: Definition file for Korean - Korea language-country.
 */const Zp={languageCode:"ko-KR",[Fp]:"위쪽에 행 삽입",[Lp]:"아래쪽에 행 삽입",[_p]:"왼쪽에 열 삽입",[wp]:"오른쪽에 열 삽입",[Mp]:["행 삭제","여러 행 삭제"],[Op]:["열 삭제","여러 열 삭제"],[Ip]:"되돌리기",[vp]:"다시하기",[Cp]:"읽기 전용",[yp]:"열 지우기",[Ap]:"정렬",[Sp]:"왼쪽",[Np]:"중앙",[Tp]:"오른쪽",[Rp]:"자동",[Ep]:"위쪽",[gp]:"가운데",[mp]:"아래쪽",[fp]:"열 고정",[pp]:"열 고정 해제",[dp]:"테두리",[cp]:"위쪽",[lp]:"오른쪽",[hp]:"아래쪽",[up]:"왼쪽",[op]:"테두리 지우기",[ap]:"댓글 달기",[ip]:"댓글 편집",[sp]:"댓글 삭제",[np]:"읽기 전용 댓글",[rp]:"셀 병합",[tp]:"셀 병합 해제",[ep]:"복사",[Jd]:"잘라내기",[Zd]:"자녀 행 추가",[Qd]:"부모행에서 제거",[qd]:["열 숨기기","여러 열 숨기기"],[jd]:["열 숨기기 해제","여러 열 숨기기 해제"],[Kd]:["행 숨기기","여러 행 숨기기"],[Xd]:["행 숨기기 해제","여러 행 숨기기 해제"],[$d]:"조건없음",[zd]:"비어있음",[Yd]:"비어있지 않음",[Wd]:"같",[Hd]:"같지 않음",[Gd]:"시작 문자",[kd]:"끝 문자",[Bd]:"포함",[Dd]:"포함하지 않음",[Vd]:"보다 큼",[Pd]:"크거나 같음",[xd]:"보다 작",[bd]:"작거나 같음",[Ud]:"사이",[Fd]:"사이 제외",[Ld]:"다음",[_d]:"전",[wd]:"오늘",[Md]:"내일",[Od]:"어제",[Id]:"공란",[vd]:"조건부 필터",[Cd]:"값 필터",[yd]:"그리고",[Ad]:"또는",[Sd]:"전체선택",[Nd]:"지우기",[Td]:"확인",[Rd]:"취소",[Ed]:"찾기",[gd]:"값",[md]:"두번째 값"},Jp=({ui:s,onInsert:e,onDelete:t,onReload:r,onCsvSave:n,onSaveAll:i})=>{const{t:a}=ku();return s==="tailwind"?H.jsxs("div",{className:"my-2 flex justify-end items-center",children:[H.jsx(Jr,{size:"sm",variant:"outlined",color:"brand",className:"mr-2",onClick:i,children:a("save")}),H.jsx(Jr,{size:"sm",variant:"outlined",color:"brand",className:"mr-2",onClick:e,children:a("insert")}),H.jsx(Jr,{size:"sm",variant:"outlined",color:"warning",className:"mr-1",onClick:t,children:a("delete")}),H.jsx(Jr,{size:"sm",variant:"outlined",color:"brand",className:"ml-1",onClick:n,children:a("csv_save")})]}):H.jsxs("div",{className:"my-2 flex justify-end items-center gap-1",children:[H.jsx(es,{type:"button",size:"small",variant:"outlined",color:"warning",className:"mr-2",onClick:e,children:a("insert")}),H.jsx(es,{type:"button",size:"small",variant:"outlined",color:"error",className:"mr-2",onClick:t,children:a("delete")}),H.jsx(es,{type:"button",size:"small",variant:"outlined",color:"success",className:"mr-2",onClick:r,children:a("reload")}),H.jsx(es,{type:"button",size:"small",variant:"outlined",color:"success",onClick:n,children:a("csv_save")})]})};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var fe;(function(s){s.RELATIVE="RELATIVE",s.ABSOLUTE="ABSOLUTE"})(fe||(fe={}));class ke{constructor(e,t,r){this.type=e,this.col=t,this.sheet=r}static absolute(e,t){return new ke(fe.ABSOLUTE,e,t)}static relative(e,t){return new ke(fe.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleColumnAddress(e).col-r.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===fe.ABSOLUTE}isColumnRelative(){return this.type===fe.RELATIVE}isAbsolute(){return this.type===fe.ABSOLUTE&&this.sheet!==void 0}moved(e,t,r){const n=this.sheet===void 0?void 0:e;return new ke(this.type,this.col+t,n)}shiftedByColumns(e){return new ke(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){const t=Mt(this,e);let r=this.col;return this.isColumnRelative()&&(r=e.col+this.col),fl(t,r)}shiftRelativeDimensions(e,t){const r=this.isColumnRelative()?this.col+e:this.col;return new ke(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isColumnAbsolute()?this.col+e:this.col;return new ke(this.type,r,this.sheet)}withSheet(e){return new ke(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case fe.RELATIVE:return`${t}#COLR${this.col}`;case fe.ABSOLUTE:return`${t}#COLA${this.col}`}}unparse(e){const t=this.toSimpleColumnAddress(e);if(xE(t))return;const r=ii(t.col);return`${this.type===fe.ABSOLUTE?"$":""}${r}`}exceedsSheetSizeLimits(e){return this.col>=e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Ve{constructor(e,t,r){this.type=e,this.row=t,this.sheet=r}static absolute(e,t){return new Ve(fe.ABSOLUTE,e,t)}static relative(e,t){return new Ve(fe.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleRowAddress(e).row-r.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===fe.ABSOLUTE}isRowRelative(){return this.type===fe.RELATIVE}isAbsolute(){return this.type===fe.ABSOLUTE&&this.sheet!==void 0}moved(e,t,r){const n=this.sheet===void 0?void 0:e;return new Ve(this.type,this.row+r,n)}shiftedByRows(e){return new Ve(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){const t=Mt(this,e);let r=this.row;return this.isRowRelative()&&(r=e.row+this.row),pl(t,r)}shiftRelativeDimensions(e,t){const r=this.isRowRelative()?this.row+t:this.row;return new Ve(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isRowAbsolute()?this.row+t:this.row;return new Ve(this.type,r,this.sheet)}withSheet(e){return new Ve(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case fe.RELATIVE:return`${t}#ROWR${this.row}`;case fe.ABSOLUTE:return`${t}#ROWA${this.row}`}}unparse(e){const t=this.toSimpleRowAddress(e);return bE(t)?void 0:`${this.type===fe.ABSOLUTE?"$":""}${t.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var Q;(function(s){s.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",s.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",s.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",s.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"})(Q||(Q={}));class ee{constructor(e,t,r,n){this.col=e,this.row=t,this.type=r,this.sheet=n}static fromColAndRow(e,t,r){return(e.isColumnAbsolute()&&t.isRowAbsolute()?ee.absolute.bind(this):e.isColumnAbsolute()?ee.absoluteCol.bind(this):t.isRowAbsolute()?ee.absoluteRow.bind(this):ee.relative.bind(this))(e.col,t.row,r)}static relative(e,t,r){return new ee(e,t,Q.CELL_REFERENCE_RELATIVE,r)}static absolute(e,t,r){return new ee(e,t,Q.CELL_REFERENCE_ABSOLUTE,r)}static absoluteCol(e,t,r){return new ee(e,t,Q.CELL_REFERENCE_ABSOLUTE_COL,r)}static absoluteRow(e,t,r){return new ee(e,t,Q.CELL_REFERENCE_ABSOLUTE_ROW,r)}toSimpleCellAddress(e){const t=Mt(this,e);return this.type===Q.CELL_REFERENCE_ABSOLUTE?O(t,this.col,this.row):this.type===Q.CELL_REFERENCE_ABSOLUTE_ROW?O(t,e.col+this.col,this.row):this.type===Q.CELL_REFERENCE_ABSOLUTE_COL?O(t,this.col,e.row+this.row):O(t,e.col+this.col,e.row+this.row)}toColumnAddress(){const e=this.isColumnRelative()?fe.RELATIVE:fe.ABSOLUTE;return new ke(e,this.col,this.sheet)}toRowAddress(){const e=this.isRowRelative()?fe.RELATIVE:fe.ABSOLUTE;return new Ve(e,this.row,this.sheet)}toSimpleColumnAddress(e){const t=Mt(this,e);let r=this.col;return this.isColumnRelative()&&(r+=e.col),fl(t,r)}toSimpleRowAddress(e){const t=Mt(this,e);let r=this.row;return this.isRowRelative()&&(r+=e.row),pl(t,r)}isRowAbsolute(){return this.type===Q.CELL_REFERENCE_ABSOLUTE||this.type===Q.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===Q.CELL_REFERENCE_ABSOLUTE||this.type===Q.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===Q.CELL_REFERENCE_RELATIVE||this.type===Q.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===Q.CELL_REFERENCE_RELATIVE||this.type===Q.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===Q.CELL_REFERENCE_ABSOLUTE&&this.sheet!==void 0}shiftedByRows(e){return new ee(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new ee(this.col+e,this.row,this.type,this.sheet)}moved(e,t,r){const n=this.sheet===void 0?void 0:e;return new ee(this.col+t,this.row+r,this.type,n)}withSheet(e){return new ee(this.col,this.row,this.type,e)}isInvalid(e){return $e(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,t){const r=this.isColumnAbsolute()?this.col:this.col+e,n=this.isRowAbsolute()?this.row:this.row+t;return new ee(r,n,this.type,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isColumnRelative()?this.col:this.col+e,n=this.isRowRelative()?this.row:this.row+t;return new ee(r,n,this.type,this.sheet)}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case Q.CELL_REFERENCE_RELATIVE:return`${t}#${this.row}R${this.col}`;case Q.CELL_REFERENCE_ABSOLUTE:return`${t}#${this.row}A${this.col}`;case Q.CELL_REFERENCE_ABSOLUTE_COL:return`${t}#${this.row}AC${this.col}`;case Q.CELL_REFERENCE_ABSOLUTE_ROW:return`${t}#${this.row}AR${this.col}`}}unparse(e){const t=this.toSimpleCellAddress(e);if($e(t))return;const r=ii(t.col),n=this.type===Q.CELL_REFERENCE_ABSOLUTE||this.type===Q.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";return`${this.type===Q.CELL_REFERENCE_ABSOLUTE||this.type===Q.CELL_REFERENCE_ABSOLUTE_COL?"$":""}${r}${n}${t.row+1}`}exceedsSheetSizeLimits(e,t){return this.row>=t||this.col>=e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const zn=":",Ge="$",ef="\\s+",tf="[ \\t\\n\\r]+",si="A-Za-zÀ-ʯ",Sa=`${si}0-9_.`,Gu=`[${si}0-9_]+`,rf="'(((?!').|'')*)'",fn=`(${Gu}|${rf})!`,Hu=`(${fn})?\\${Ge}?[A-Za-z]+\\${Ge}?[0-9]+`,oo=`(${fn})?\\${Ge}?[A-Za-z]+`,uo=`(${fn})?\\${Ge}?[0-9]+`,Wu="[rR][0-9]*[cC][0-9]*",nf=`(${Hu})[^${Sa}]`,Yu=`[${si}_][${Sa}]*`,sf=["0","1","2","3","4","5","6","7","8","9"],zu=[...Array.from(Array(26)).map((s,e)=>e+65),...Array.from(Array(26)).map((s,e)=>e+97),...Array.from(Array(496)).map((s,e)=>e+192)].map(s=>String.fromCharCode(s));/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const $u=new RegExp(`^(${fn})?(\\${Ge}?)([A-Za-z]+)(\\${Ge}?)([0-9]+)$`),af=new RegExp(`^(${fn})?(\\${Ge}?)([A-Za-z]+)$`),of=new RegExp(`^(${fn})?(\\${Ge}?)([0-9]+)$`),uf=new RegExp(`^${Gu}$`),Xr=(s,e,t)=>{const r=$u.exec(e),n=Aa(r[6]);let i=ai(r,s);if(i===void 0)return;i===null&&(i=void 0);const a=Number(r[8])-1;return r[5]===Ge&&r[7]===Ge?ee.absolute(n,a,i):r[5]===Ge?ee.absoluteCol(n,a-t.row,i):r[7]===Ge?ee.absoluteRow(n-t.col,a,i):ee.relative(n-t.col,a-t.row,i)},Ls=(s,e,t)=>{const r=af.exec(e);let n=ai(r,s);if(n===void 0)return;n===null&&(n=void 0);const i=Aa(r[6]);return r[5]===Ge?ke.absolute(i,n):ke.relative(i-t.col,n)},Fs=(s,e,t)=>{const r=of.exec(e);let n=ai(r,s);if(n===void 0)return;n===null&&(n=void 0);const i=Number(r[6])-1;return r[5]===Ge?Ve.absolute(i,n):Ve.relative(i-t.row,n)},Hi=(s,e,t)=>{const r=$u.exec(e);if(!r)return;const n=Aa(r[6]);let i=ai(r,s);if(i===void 0)return;i===null&&(i=t);const a=Number(r[8])-1;return O(i,n,a)},hf=(s,e,t)=>{const r=e.split(zn);if(r.length!==2)return;const[n,i]=r,a=Hi(s,n,t);if(a===void 0)return;const o=Hi(s,i,a.sheet);if(o!==void 0&&a.sheet===o.sheet)return na(a,o)},Us=(s,e,t)=>{const r=ii(e.col),n=Xu(e.sheet,s);if(n!==void 0)return t!==e.sheet?`${n}!${r}${e.row+1}`:`${r}${e.row+1}`},lf=(s,e,t)=>{const r=Us(s,e.start,t),n=Us(s,e.end,e.start.sheet);if(!(r===void 0||n===void 0))return`${r}${zn}${n}`};function Aa(s){return s.length===1?s.toUpperCase().charCodeAt(0)-65:s.split("").reduce((e,t)=>e*26+(t.toUpperCase().charCodeAt(0)-64),0)-1}function ii(s){let e="";for(;s>=0;)e=String.fromCharCode(s%26+97)+e,s=Math.floor(s/26)-1;return e.toUpperCase()}function Xu(s,e){let t=e(s);if(t!==void 0)return uf.test(t)?t:(t=t.replace(/'/g,"''"),`'${t}'`)}function ai(s,e){var t;let r=(t=s[3])!==null&&t!==void 0?t:s[2];return r?(r=r.replace(/''/g,"'"),e(r)):null}function te(s){return s&&s.length===0}function er(s){return s==null?[]:Object.keys(s)}function De(s){for(var e=[],t=Object.keys(s),r=0;r<t.length;r++)e.push(s[t[r]]);return e}function cf(s,e){for(var t=[],r=er(s),n=0;n<r.length;n++){var i=r[n];t.push(e.call(null,s[i],i))}return t}function _(s,e){for(var t=[],r=0;r<s.length;r++)t.push(e.call(null,s[r],r));return t}function je(s){for(var e=[],t=0;t<s.length;t++){var r=s[t];Array.isArray(r)?e=e.concat(je(r)):e.push(r)}return e}function pt(s){return te(s)?void 0:s[0]}function Ku(s){var e=s&&s.length;return e?s[e-1]:void 0}function b(s,e){if(Array.isArray(s))for(var t=0;t<s.length;t++)e.call(null,s[t],t);else if(Ca(s))for(var r=er(s),t=0;t<r.length;t++){var n=r[t],i=s[n];e.call(null,i,n)}else throw Error("non exhaustive match")}function kt(s){return typeof s=="string"}function ft(s){return s===void 0}function fr(s){return s instanceof Function}function Fe(s,e){return e===void 0&&(e=1),s.slice(e,s.length)}function xn(s,e){return e===void 0&&(e=1),s.slice(0,s.length-e)}function wt(s,e){var t=[];if(Array.isArray(s))for(var r=0;r<s.length;r++){var n=s[r];e.call(null,n)&&t.push(n)}return t}function _r(s,e){return wt(s,function(t){return!e(t)})}function Et(s,e){for(var t=Object.keys(s),r={},n=0;n<t.length;n++){var i=t[n],a=s[i];e(a)&&(r[i]=a)}return r}function U(s,e){return Ca(s)?s.hasOwnProperty(e):!1}function ye(s,e){return cn(s,function(t){return t===e})!==void 0}function qe(s){for(var e=[],t=0;t<s.length;t++)e.push(s[t]);return e}function $n(s){var e={};for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&(e[t]=s[t]);return e}function cn(s,e){for(var t=0;t<s.length;t++){var r=s[t];if(e.call(null,r))return r}}function df(s,e){for(var t=[],r=0;r<s.length;r++){var n=s[r];e.call(null,n)&&t.push(n)}return t}function be(s,e,t){for(var r=Array.isArray(s),n=r?s:De(s),i=r?[]:er(s),a=t,o=0;o<n.length;o++)a=e.call(null,a,n[o],r?o:i[o]);return a}function Xn(s){return _r(s,function(e){return e==null})}function ya(s,e){e===void 0&&(e=function(r){return r});var t=[];return be(s,function(r,n){var i=e(n);return ye(t,i)?r:(t.push(i),r.concat(n))},[])}function Ot(s){return Array.isArray(s)}function Jt(s){return s instanceof RegExp}function Ca(s){return s instanceof Object}function dt(s,e){for(var t=0;t<s.length;t++)if(!e(s[t],t))return!1;return!0}function oi(s,e){return _r(s,function(t){return ye(e,t)})}function ju(s,e){for(var t=0;t<s.length;t++)if(e(s[t]))return!0;return!1}function pf(s,e){for(var t=0;t<s.length;t++)if(s[t]===e)return t;return-1}function _t(s){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r++)for(var n=e[r],i=er(n),a=0;a<i.length;a++){var o=i[a];s[o]=n[o]}return s}function ff(s){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r++){var n=e[r];if(!ft(n))for(var i=er(n),a=0;a<i.length;a++){var o=i[a];U(s,o)||(s[o]=n[o])}}return s}function ui(){for(var s=[],e=0;e<arguments.length;e++)s[e]=arguments[e];return ff.apply(null,[{}].concat(s))}function qu(s,e){var t={};return b(s,function(r){var n=e(r),i=t[n];i?i.push(r):t[n]=[r]}),t}function ho(s,e){for(var t=$n(s),r=er(e),n=0;n<r.length;n++){var i=r[n],a=e[i];t[i]=a}return t}function Ce(){}function lo(s){return s}function mf(s){for(var e=[],t=0;t<s.length;t++){var r=s[t];e.push(r!==void 0?r:void 0)}return e}function Wi(s){console&&console.error&&console.error("Error: "+s)}function va(s){console&&console.warn&&console.warn("Warning: "+s)}function co(){return typeof Map=="function"}function gf(s,e){e.forEach(function(t){var r=t.prototype;Object.getOwnPropertyNames(r).forEach(function(n){if(n!=="constructor"){var i=Object.getOwnPropertyDescriptor(r,n);i&&(i.get||i.set)?Object.defineProperty(s.prototype,n,i):s.prototype[n]=t.prototype[n]}})})}function Qu(s){function e(){}e.prototype=s;var t=new e;function r(){return typeof t.bar}return r(),r(),s}function bs(s){return s[s.length-1]}function Zu(s){var e=new Date().getTime(),t=s(),r=new Date().getTime(),n=r-e;return{time:n,value:t}}var Rs={exports:{}},Ef=Rs.exports,po;function Rf(){return po||(po=1,function(s){(function(e,t){s.exports?s.exports=t():e.regexpToAst=t()})(typeof self<"u"?self:Ef,function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(E){this.idx=E.idx,this.input=E.input,this.groupIdx=E.groupIdx},e.prototype.pattern=function(E){this.idx=0,this.input=E,this.groupIdx=0,this.consumeChar("/");var S=this.disjunction();this.consumeChar("/");for(var A={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":o(A,"global");break;case"i":o(A,"ignoreCase");break;case"m":o(A,"multiLine");break;case"u":o(A,"unicode");break;case"y":o(A,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:A,value:S}},e.prototype.disjunction=function(){var E=[];for(E.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),E.push(this.alternative());return{type:"Disjunction",value:E}},e.prototype.alternative=function(){for(var E=[];this.isTerm();)E.push(this.term());return{type:"Alternative",value:E}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var E;switch(this.popChar()){case"=":E="Lookahead";break;case"!":E="NegativeLookahead";break}u(E);var S=this.disjunction();return this.consumeChar(")"),{type:E,value:S}}l()},e.prototype.quantifier=function(E){var S;switch(this.popChar()){case"*":S={atLeast:0,atMost:1/0};break;case"+":S={atLeast:1,atMost:1/0};break;case"?":S={atLeast:0,atMost:1};break;case"{":var A=this.integerIncludingZero();switch(this.popChar()){case"}":S={atLeast:A,atMost:A};break;case",":var y;this.isDigit()?(y=this.integerIncludingZero(),S={atLeast:A,atMost:y}):S={atLeast:A,atMost:1/0},this.consumeChar("}");break}if(E===!0&&S===void 0)return;u(S);break}if(!(E===!0&&S===void 0))return u(S),this.peekChar(0)==="?"?(this.consumeChar("?"),S.greedy=!1):S.greedy=!0,S.type="Quantifier",S},e.prototype.atom=function(){var E;switch(this.peekChar()){case".":E=this.dotAll();break;case"\\":E=this.atomEscape();break;case"[":E=this.characterClass();break;case"(":E=this.group();break}return E===void 0&&this.isPatternCharacter()&&(E=this.patternCharacter()),u(E),this.isQuantifier()&&(E.quantifier=this.quantifier()),E},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[i(`
`),i("\r"),i("\u2028"),i("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){var E=this.positiveInteger();return{type:"GroupBackReference",value:E}},e.prototype.characterClassEscape=function(){var E,S=!1;switch(this.popChar()){case"d":E=d;break;case"D":E=d,S=!0;break;case"s":E=T;break;case"S":E=T,S=!0;break;case"w":E=f;break;case"W":E=f,S=!0;break}return u(E),{type:"Set",value:E,complement:S}},e.prototype.controlEscapeAtom=function(){var E;switch(this.popChar()){case"f":E=i("\f");break;case"n":E=i(`
`);break;case"r":E=i("\r");break;case"t":E=i("	");break;case"v":E=i("\v");break}return u(E),{type:"Character",value:E}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var E=this.popChar();if(/[a-zA-Z]/.test(E)===!1)throw Error("Invalid ");var S=E.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:S}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:i("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){var E=this.popChar();return{type:"Character",value:i(E)}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var E=this.popChar();return{type:"Character",value:i(E)}}},e.prototype.characterClass=function(){var E=[],S=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),S=!0);this.isClassAtom();){var A=this.classAtom(),y=A.type==="Character";if(y&&this.isRangeDash()){this.consumeChar("-");var C=this.classAtom(),M=C.type==="Character";if(M){if(C.value<A.value)throw Error("Range out of order in character class");E.push({from:A.value,to:C.value})}else a(A.value,E),E.push(i("-")),a(C.value,E)}else a(A.value,E)}return this.consumeChar("]"),{type:"Set",complement:S,value:E}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:i("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var E=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),E=!1;break;default:this.groupIdx++;break}var S=this.disjunction();this.consumeChar(")");var A={type:"Group",capturing:E,value:S};return E&&(A.idx=this.groupIdx),A},e.prototype.positiveInteger=function(){var E=this.popChar();if(n.test(E)===!1)throw Error("Expecting a positive integer");for(;r.test(this.peekChar(0));)E+=this.popChar();return parseInt(E,10)},e.prototype.integerIncludingZero=function(){var E=this.popChar();if(r.test(E)===!1)throw Error("Expecting an integer");for(;r.test(this.peekChar(0));)E+=this.popChar();return parseInt(E,10)},e.prototype.patternCharacter=function(){var E=this.popChar();switch(E){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:i(E)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},e.prototype.isDigit=function(){return r.test(this.peekChar(0))},e.prototype.isClassAtom=function(E){switch(E===void 0&&(E=0),this.peekChar(E)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},e.prototype.isQuantifier=function(){var E=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(E)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(E){for(var S="",A=0;A<E;A++){var y=this.popChar();if(t.test(y)===!1)throw Error("Expecting a HexDecimal digits");S+=y}var C=parseInt(S,16);return{type:"Character",value:C}},e.prototype.peekChar=function(E){return E===void 0&&(E=0),this.input[this.idx+E]},e.prototype.popChar=function(){var E=this.peekChar(0);return this.consumeChar(),E},e.prototype.consumeChar=function(E){if(E!==void 0&&this.input[this.idx]!==E)throw Error("Expected: '"+E+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t=/[0-9a-fA-F]/,r=/[0-9]/,n=/[1-9]/;function i(E){return E.charCodeAt(0)}function a(E,S){E.length!==void 0?E.forEach(function(A){S.push(A)}):S.push(E)}function o(E,S){if(E[S]===!0)throw"duplicate flag "+S;E[S]=!0}function u(E){if(E===void 0)throw Error("Internal Error - Should never get here!")}function l(){throw Error("Internal Error - Should never get here!")}var c,d=[];for(c=i("0");c<=i("9");c++)d.push(c);var f=[i("_")].concat(d);for(c=i("a");c<=i("z");c++)f.push(c);for(c=i("A");c<=i("Z");c++)f.push(c);var T=[i(" "),i("\f"),i(`
`),i("\r"),i("	"),i("\v"),i("	"),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i("\u2028"),i("\u2029"),i(" "),i(" "),i("　"),i("\uFEFF")];function N(){}return N.prototype.visitChildren=function(E){for(var S in E){var A=E[S];E.hasOwnProperty(S)&&(A.type!==void 0?this.visit(A):Array.isArray(A)&&A.forEach(function(y){this.visit(y)},this))}},N.prototype.visit=function(E){switch(E.type){case"Pattern":this.visitPattern(E);break;case"Flags":this.visitFlags(E);break;case"Disjunction":this.visitDisjunction(E);break;case"Alternative":this.visitAlternative(E);break;case"StartAnchor":this.visitStartAnchor(E);break;case"EndAnchor":this.visitEndAnchor(E);break;case"WordBoundary":this.visitWordBoundary(E);break;case"NonWordBoundary":this.visitNonWordBoundary(E);break;case"Lookahead":this.visitLookahead(E);break;case"NegativeLookahead":this.visitNegativeLookahead(E);break;case"Character":this.visitCharacter(E);break;case"Set":this.visitSet(E);break;case"Group":this.visitGroup(E);break;case"GroupBackReference":this.visitGroupBackReference(E);break;case"Quantifier":this.visitQuantifier(E);break}this.visitChildren(E)},N.prototype.visitPattern=function(E){},N.prototype.visitFlags=function(E){},N.prototype.visitDisjunction=function(E){},N.prototype.visitAlternative=function(E){},N.prototype.visitStartAnchor=function(E){},N.prototype.visitEndAnchor=function(E){},N.prototype.visitWordBoundary=function(E){},N.prototype.visitNonWordBoundary=function(E){},N.prototype.visitLookahead=function(E){},N.prototype.visitNegativeLookahead=function(E){},N.prototype.visitCharacter=function(E){},N.prototype.visitSet=function(E){},N.prototype.visitGroup=function(E){},N.prototype.visitGroupBackReference=function(E){},N.prototype.visitQuantifier=function(E){},{RegExpParser:e,BaseRegExpVisitor:N,VERSION:"0.4.0"}})}(Rs)),Rs.exports}var Kn=Rf(),Ts={},Tf=new Kn.RegExpParser;function hi(s){var e=s.toString();if(Ts.hasOwnProperty(e))return Ts[e];var t=Tf.pattern(e);return Ts[e]=t,t}function Nf(){Ts={}}var Sf=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},s(e,t)};return function(e,t){s(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Ju="Complement Sets are not supported for first char optimization",xs=`Unable to use "first char" lexer optimizations:
`;function Af(s,e){e===void 0&&(e=!1);try{var t=hi(s),r=Yi(t.value,{},t.flags.ignoreCase);return r}catch(i){if(i.message===Ju)e&&va(""+xs+("	Unable to optimize: < "+s.toString()+` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var n="";e&&(n=`
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),Wi(xs+`
`+("	Failed parsing: < "+s.toString()+` >
`)+("	Using the regexp-to-ast library version: "+Kn.VERSION+`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+n)}}return[]}function Yi(s,e,t){switch(s.type){case"Disjunction":for(var r=0;r<s.value.length;r++)Yi(s.value[r],e,t);break;case"Alternative":for(var n=s.value,r=0;r<n.length;r++){var i=n[r];switch(i.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var a=i;switch(a.type){case"Character":ts(a.value,e,t);break;case"Set":if(a.complement===!0)throw Error(Ju);b(a.value,function(l){if(typeof l=="number")ts(l,e,t);else{var c=l;if(t===!0)for(var d=c.from;d<=c.to;d++)ts(d,e,t);else{for(var d=c.from;d<=c.to&&d<Nn;d++)ts(d,e,t);if(c.to>=Nn)for(var f=c.from>=Nn?c.from:Nn,T=c.to,N=pr(f),E=pr(T),S=N;S<=E;S++)e[S]=S}}});break;case"Group":Yi(a.value,e,t);break;default:throw Error("Non Exhaustive Match")}var o=a.quantifier!==void 0&&a.quantifier.atLeast===0;if(a.type==="Group"&&zi(a)===!1||a.type!=="Group"&&o===!1)break}break;default:throw Error("non exhaustive match!")}return De(e)}function ts(s,e,t){var r=pr(s);e[r]=r,t===!0&&yf(s,e)}function yf(s,e){var t=String.fromCharCode(s),r=t.toUpperCase();if(r!==t){var n=pr(r.charCodeAt(0));e[n]=n}else{var i=t.toLowerCase();if(i!==t){var n=pr(i.charCodeAt(0));e[n]=n}}}function fo(s,e){return cn(s.value,function(t){if(typeof t=="number")return ye(e,t);var r=t;return cn(e,function(n){return r.from<=n&&n<=r.to})!==void 0})}function zi(s){return s.quantifier&&s.quantifier.atLeast===0?!0:s.value?Ot(s.value)?dt(s.value,zi):zi(s.value):!1}var Cf=function(s){Sf(e,s);function e(t){var r=s.call(this)||this;return r.targetCharCodes=t,r.found=!1,r}return e.prototype.visitChildren=function(t){if(this.found!==!0){switch(t.type){case"Lookahead":this.visitLookahead(t);return;case"NegativeLookahead":this.visitNegativeLookahead(t);return}s.prototype.visitChildren.call(this,t)}},e.prototype.visitCharacter=function(t){ye(this.targetCharCodes,t.value)&&(this.found=!0)},e.prototype.visitSet=function(t){t.complement?fo(t,this.targetCharCodes)===void 0&&(this.found=!0):fo(t,this.targetCharCodes)!==void 0&&(this.found=!0)},e}(Kn.BaseRegExpVisitor);function Ia(s,e){if(e instanceof RegExp){var t=hi(e),r=new Cf(s);return r.visit(t),r.found}else return cn(e,function(n){return ye(s,n.charCodeAt(0))})!==void 0}var eh=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},s(e,t)};return function(e,t){s(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Gt="PATTERN",Or="defaultMode",rs="modes",th=typeof new RegExp("(?:)").sticky=="boolean";function vf(s,e){e=ui(e,{useSticky:th,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(y,C){return C()}});var t=e.tracer;t("initCharCodeToOptimizedIndexMap",function(){Kf()});var r;t("Reject Lexer.NA",function(){r=_r(s,function(y){return y[Gt]===Ke.NA})});var n=!1,i;t("Transform Patterns",function(){n=!1,i=_(r,function(y){var C=y[Gt];if(Jt(C)){var M=C.source;return M.length===1&&M!=="^"&&M!=="$"&&M!=="."?M:M.length===2&&M[0]==="\\"&&!ye(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],M[1])?M[1]:e.useSticky?go(C):mo(C)}else{if(fr(C))return n=!0,{exec:C};if(U(C,"exec"))return n=!0,C;if(typeof C=="string"){if(C.length===1)return C;var re=C.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),J=new RegExp(re);return e.useSticky?go(J):mo(J)}else throw Error("non exhaustive match")}})});var a,o,u,l,c;t("misc mapping",function(){a=_(r,function(y){return y.tokenTypeIdx}),o=_(r,function(y){var C=y.GROUP;if(C!==Ke.SKIPPED){if(kt(C))return C;if(ft(C))return!1;throw Error("non exhaustive match")}}),u=_(r,function(y){var C=y.LONGER_ALT;if(C){var M=pf(r,C);return M}}),l=_(r,function(y){return y.PUSH_MODE}),c=_(r,function(y){return U(y,"POP_MODE")})});var d;t("Line Terminator Handling",function(){var y=sh(e.lineTerminatorCharacters);d=_(r,function(C){return!1}),e.positionTracking!=="onlyOffset"&&(d=_(r,function(C){if(U(C,"LINE_BREAKS"))return C.LINE_BREAKS;if(nh(C,y)===!1)return Ia(y,C.PATTERN)}))});var f,T,N,E;t("Misc Mapping #2",function(){f=_(r,rh),T=_(i,zf),N=be(r,function(y,C){var M=C.GROUP;return kt(M)&&M!==Ke.SKIPPED&&(y[M]=[]),y},{}),E=_(i,function(y,C){return{pattern:i[C],longerAlt:u[C],canLineTerminator:d[C],isCustom:f[C],short:T[C],group:o[C],push:l[C],pop:c[C],tokenTypeIdx:a[C],tokenType:r[C]}})});var S=!0,A=[];return e.safeMode||t("First Char Optimization",function(){A=be(r,function(y,C,M){if(typeof C.PATTERN=="string"){var re=C.PATTERN.charCodeAt(0),J=pr(re);Ii(y,J,E[M])}else if(Ot(C.START_CHARS_HINT)){var j;b(C.START_CHARS_HINT,function(he){var le=typeof he=="string"?he.charCodeAt(0):he,q=pr(le);j!==q&&(j=q,Ii(y,q,E[M]))})}else if(Jt(C.PATTERN))if(C.PATTERN.unicode)S=!1,e.ensureOptimizations&&Wi(""+xs+("	Unable to analyze < "+C.PATTERN.toString()+` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var ue=Af(C.PATTERN,e.ensureOptimizations);te(ue)&&(S=!1),b(ue,function(he){Ii(y,he,E[M])})}else e.ensureOptimizations&&Wi(""+xs+("	TokenType: <"+C.name+`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),S=!1;return y},[])}),t("ArrayPacking",function(){A=mf(A)}),{emptyGroups:N,patternIdxToConfig:E,charCodeToPatternIdxToConfig:A,hasCustom:n,canBeOptimized:S}}function If(s,e){var t=[],r=Mf(s);t=t.concat(r.errors);var n=wf(r.valid),i=n.valid;return t=t.concat(n.errors),t=t.concat(Of(i)),t=t.concat(Vf(i)),t=t.concat(Df(i,e)),t=t.concat(Bf(i)),t}function Of(s){var e=[],t=wt(s,function(r){return Jt(r[Gt])});return e=e.concat(Lf(t)),e=e.concat(bf(t)),e=e.concat(xf(t)),e=e.concat(Pf(t)),e=e.concat(Ff(t)),e}function Mf(s){var e=wt(s,function(n){return!U(n,Gt)}),t=_(e,function(n){return{message:"Token Type: ->"+n.name+"<- missing static 'PATTERN' property",type:Re.MISSING_PATTERN,tokenTypes:[n]}}),r=oi(s,e);return{errors:t,valid:r}}function wf(s){var e=wt(s,function(n){var i=n[Gt];return!Jt(i)&&!fr(i)&&!U(i,"exec")&&!kt(i)}),t=_(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:Re.INVALID_PATTERN,tokenTypes:[n]}}),r=oi(s,e);return{errors:t,valid:r}}var _f=/[^\\][\$]/;function Lf(s){var e=function(n){eh(i,n);function i(){var a=n!==null&&n.apply(this,arguments)||this;return a.found=!1,a}return i.prototype.visitEndAnchor=function(a){this.found=!0},i}(Kn.BaseRegExpVisitor),t=wt(s,function(n){var i=n[Gt];try{var a=hi(i),o=new e;return o.visit(a),o.found}catch{return _f.test(i.source)}}),r=_(t,function(n){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+n.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Re.EOI_ANCHOR_FOUND,tokenTypes:[n]}});return r}function Ff(s){var e=wt(s,function(r){var n=r[Gt];return n.test("")}),t=_(e,function(r){return{message:"Token Type: ->"+r.name+"<- static 'PATTERN' must not match an empty string",type:Re.EMPTY_MATCH_PATTERN,tokenTypes:[r]}});return t}var Uf=/[^\\[][\^]|^\^/;function bf(s){var e=function(n){eh(i,n);function i(){var a=n!==null&&n.apply(this,arguments)||this;return a.found=!1,a}return i.prototype.visitStartAnchor=function(a){this.found=!0},i}(Kn.BaseRegExpVisitor),t=wt(s,function(n){var i=n[Gt];try{var a=hi(i),o=new e;return o.visit(a),o.found}catch{return Uf.test(i.source)}}),r=_(t,function(n){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+n.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Re.SOI_ANCHOR_FOUND,tokenTypes:[n]}});return r}function xf(s){var e=wt(s,function(r){var n=r[Gt];return n instanceof RegExp&&(n.multiline||n.global)}),t=_(e,function(r){return{message:"Token Type: ->"+r.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:Re.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[r]}});return t}function Pf(s){var e=[],t=_(s,function(i){return be(s,function(a,o){return i.PATTERN.source===o.PATTERN.source&&!ye(e,o)&&o.PATTERN!==Ke.NA&&(e.push(o),a.push(o)),a},[])});t=Xn(t);var r=wt(t,function(i){return i.length>1}),n=_(r,function(i){var a=_(i,function(u){return u.name}),o=pt(i).PATTERN;return{message:"The same RegExp pattern ->"+o+"<-"+("has been used in all of the following Token Types: "+a.join(", ")+" <-"),type:Re.DUPLICATE_PATTERNS_FOUND,tokenTypes:i}});return n}function Vf(s){var e=wt(s,function(r){if(!U(r,"GROUP"))return!1;var n=r.GROUP;return n!==Ke.SKIPPED&&n!==Ke.NA&&!kt(n)}),t=_(e,function(r){return{message:"Token Type: ->"+r.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:Re.INVALID_GROUP_TYPE_FOUND,tokenTypes:[r]}});return t}function Df(s,e){var t=wt(s,function(n){return n.PUSH_MODE!==void 0&&!ye(e,n.PUSH_MODE)}),r=_(t,function(n){var i="Token Type: ->"+n.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+n.PUSH_MODE+"<-which does not exist";return{message:i,type:Re.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[n]}});return r}function Bf(s){var e=[],t=be(s,function(r,n,i){var a=n.PATTERN;return a===Ke.NA||(kt(a)?r.push({str:a,idx:i,tokenType:n}):Jt(a)&&Gf(a)&&r.push({str:a.source,idx:i,tokenType:n})),r},[]);return b(s,function(r,n){b(t,function(i){var a=i.str,o=i.idx,u=i.tokenType;if(n<o&&kf(a,r.PATTERN)){var l="Token: ->"+u.name+`<- can never be matched.
`+("Because it appears AFTER the Token Type ->"+r.name+"<-")+`in the lexer's definition.
See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:l,type:Re.UNREACHABLE_PATTERN,tokenTypes:[r,u]})}})}),e}function kf(s,e){if(Jt(e)){var t=e.exec(s);return t!==null&&t.index===0}else{if(fr(e))return e(s,0,[],{});if(U(e,"exec"))return e.exec(s,0,[],{});if(typeof e=="string")return e===s;throw Error("non exhaustive match")}}function Gf(s){var e=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return cn(e,function(t){return s.source.indexOf(t)!==-1})===void 0}function mo(s){var e=s.ignoreCase?"i":"";return new RegExp("^(?:"+s.source+")",e)}function go(s){var e=s.ignoreCase?"iy":"y";return new RegExp(""+s.source,e)}function Hf(s,e,t){var r=[];return U(s,Or)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+Or+`> property in its definition
`,type:Re.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),U(s,rs)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+rs+`> property in its definition
`,type:Re.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),U(s,rs)&&U(s,Or)&&!U(s.modes,s.defaultMode)&&r.push({message:"A MultiMode Lexer cannot be initialized with a "+Or+": <"+s.defaultMode+`>which does not exist
`,type:Re.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),U(s,rs)&&b(s.modes,function(n,i){b(n,function(a,o){ft(a)&&r.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+("<"+i+"> at index: <"+o+`>
`),type:Re.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),r}function Wf(s,e,t){var r=[],n=!1,i=Xn(je(cf(s.modes,function(u){return u}))),a=_r(i,function(u){return u[Gt]===Ke.NA}),o=sh(t);return e&&b(a,function(u){var l=nh(u,o);if(l!==!1){var c=Xf(u,l),d={message:c,type:l.issue,tokenType:u};r.push(d)}else U(u,"LINE_BREAKS")?u.LINE_BREAKS===!0&&(n=!0):Ia(o,u.PATTERN)&&(n=!0)}),e&&!n&&r.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:Re.NO_LINE_BREAKS_FLAGS}),r}function Yf(s){var e={},t=er(s);return b(t,function(r){var n=s[r];if(Ot(n))e[r]=[];else throw Error("non exhaustive match")}),e}function rh(s){var e=s.PATTERN;if(Jt(e))return!1;if(fr(e))return!0;if(U(e,"exec"))return!0;if(kt(e))return!1;throw Error("non exhaustive match")}function zf(s){return kt(s)&&s.length===1?s.charCodeAt(0):!1}var $f={test:function(s){for(var e=s.length,t=this.lastIndex;t<e;t++){var r=s.charCodeAt(t);if(r===10)return this.lastIndex=t+1,!0;if(r===13)return s.charCodeAt(t+1)===10?this.lastIndex=t+2:this.lastIndex=t+1,!0}return!1},lastIndex:0};function nh(s,e){if(U(s,"LINE_BREAKS"))return!1;if(Jt(s.PATTERN)){try{Ia(e,s.PATTERN)}catch(t){return{issue:Re.IDENTIFY_TERMINATOR,errMsg:t.message}}return!1}else{if(kt(s.PATTERN))return!1;if(rh(s))return{issue:Re.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function Xf(s,e){if(e.issue===Re.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+("	The problem is in the <"+s.name+`> Token Type
`)+("	 Root cause: "+e.errMsg+`.
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===Re.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+("	The problem is in the <"+s.name+`> Token Type
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function sh(s){var e=_(s,function(t){return kt(t)&&t.length>0?t.charCodeAt(0):t});return e}function Ii(s,e,t){s[e]===void 0?s[e]=[t]:s[e].push(t)}var Nn=256;function pr(s){return s<Nn?s:Ns[s]}var Ns=[];function Kf(){if(te(Ns)){Ns=new Array(65536);for(var s=0;s<65536;s++)Ns[s]=s>255?255+~~(s/255):s}}function li(s,e){var t=s.tokenTypeIdx;return t===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[t]===!0}function Ps(s,e){return s.tokenTypeIdx===e.tokenTypeIdx}var Eo=1,ih={};function jn(s){var e=jf(s);qf(e),Zf(e),Qf(e),b(e,function(t){t.isParent=t.categoryMatches.length>0})}function jf(s){for(var e=qe(s),t=s,r=!0;r;){t=Xn(je(_(t,function(i){return i.CATEGORIES})));var n=oi(t,e);e=e.concat(n),te(n)?r=!1:t=n}return e}function qf(s){b(s,function(e){oh(e)||(ih[Eo]=e,e.tokenTypeIdx=Eo++),Ro(e)&&!Ot(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),Ro(e)||(e.CATEGORIES=[]),Jf(e)||(e.categoryMatches=[]),em(e)||(e.categoryMatchesMap={})})}function Qf(s){b(s,function(e){e.categoryMatches=[],b(e.categoryMatchesMap,function(t,r){e.categoryMatches.push(ih[r].tokenTypeIdx)})})}function Zf(s){b(s,function(e){ah([],e)})}function ah(s,e){b(s,function(t){e.categoryMatchesMap[t.tokenTypeIdx]=!0}),b(e.CATEGORIES,function(t){var r=s.concat(e);ye(r,t)||ah(r,t)})}function oh(s){return U(s,"tokenTypeIdx")}function Ro(s){return U(s,"CATEGORIES")}function Jf(s){return U(s,"categoryMatches")}function em(s){return U(s,"categoryMatchesMap")}function tm(s){return U(s,"tokenTypeIdx")}var rm={buildUnableToPopLexerModeMessage:function(s){return"Unable to pop Lexer Mode after encountering Token ->"+s.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(s,e,t,r,n){return"unexpected character: ->"+s.charAt(e)+"<- at offset: "+e+","+(" skipped "+t+" characters.")}},Re;(function(s){s[s.MISSING_PATTERN=0]="MISSING_PATTERN",s[s.INVALID_PATTERN=1]="INVALID_PATTERN",s[s.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",s[s.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",s[s.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",s[s.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",s[s.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",s[s.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",s[s.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",s[s.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",s[s.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",s[s.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",s[s.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",s[s.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",s[s.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",s[s.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",s[s.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(Re||(Re={}));var Sn={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:rm,traceInitPerf:!1,skipValidations:!1};Object.freeze(Sn);var Ke=function(){function s(e,t){var r=this;if(t===void 0&&(t=Sn),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},typeof t=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=ho(Sn,t);var n=this.config.traceInitPerf;n===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof n=="number"&&(this.traceInitMaxIdent=n,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var i,a=!0;r.TRACE_INIT("Lexer Config handling",function(){if(r.config.lineTerminatorsPattern===Sn.lineTerminatorsPattern)r.config.lineTerminatorsPattern=$f;else if(r.config.lineTerminatorCharacters===Sn.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');r.trackStartLines=/full|onlyStart/i.test(r.config.positionTracking),r.trackEndLines=/full/i.test(r.config.positionTracking),Ot(e)?(i={modes:{}},i.modes[Or]=qe(e),i[Or]=Or):(a=!1,i=$n(e))}),r.config.skipValidations===!1&&(r.TRACE_INIT("performRuntimeChecks",function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(Hf(i,r.trackStartLines,r.config.lineTerminatorCharacters))}),r.TRACE_INIT("performWarningRuntimeChecks",function(){r.lexerDefinitionWarning=r.lexerDefinitionWarning.concat(Wf(i,r.trackStartLines,r.config.lineTerminatorCharacters))})),i.modes=i.modes?i.modes:{},b(i.modes,function(c,d){i.modes[d]=_r(c,function(f){return ft(f)})});var o=er(i.modes);if(b(i.modes,function(c,d){r.TRACE_INIT("Mode: <"+d+"> processing",function(){if(r.modes.push(d),r.config.skipValidations===!1&&r.TRACE_INIT("validatePatterns",function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(If(c,o))}),te(r.lexerDefinitionErrors)){jn(c);var f;r.TRACE_INIT("analyzeTokenTypes",function(){f=vf(c,{lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:r.TRACE_INIT.bind(r)})}),r.patternIdxToConfig[d]=f.patternIdxToConfig,r.charCodeToPatternIdxToConfig[d]=f.charCodeToPatternIdxToConfig,r.emptyGroups=ho(r.emptyGroups,f.emptyGroups),r.hasCustom=f.hasCustom||r.hasCustom,r.canModeBeOptimized[d]=f.canBeOptimized}})}),r.defaultMode=i.defaultMode,!te(r.lexerDefinitionErrors)&&!r.config.deferDefinitionErrorsHandling){var u=_(r.lexerDefinitionErrors,function(c){return c.message}),l=u.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+l)}b(r.lexerDefinitionWarning,function(c){va(c.message)}),r.TRACE_INIT("Choosing sub-methods implementations",function(){if(th?(r.chopInput=lo,r.match=r.matchWithTest):(r.updateLastIndex=Ce,r.match=r.matchWithExec),a&&(r.handleModes=Ce),r.trackStartLines===!1&&(r.computeNewColumn=lo),r.trackEndLines===!1&&(r.updateTokenEndLineColumnLocation=Ce),/full/i.test(r.config.positionTracking))r.createTokenInstance=r.createFullToken;else if(/onlyStart/i.test(r.config.positionTracking))r.createTokenInstance=r.createStartOnlyToken;else if(/onlyOffset/i.test(r.config.positionTracking))r.createTokenInstance=r.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+r.config.positionTracking+'"');r.hasCustom?(r.addToken=r.addTokenUsingPush,r.handlePayload=r.handlePayloadWithCustom):(r.addToken=r.addTokenUsingMemberAccess,r.handlePayload=r.handlePayloadNoCustom)}),r.TRACE_INIT("Failed Optimization Warnings",function(){var c=be(r.canModeBeOptimized,function(d,f,T){return f===!1&&d.push(T),d},[]);if(t.ensureOptimizations&&!te(c))throw Error("Lexer Modes: < "+c.join(", ")+` > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),r.TRACE_INIT("clearRegExpParserCache",function(){Nf()}),r.TRACE_INIT("toFastProperties",function(){Qu(r)})})}return s.prototype.tokenize=function(e,t){if(t===void 0&&(t=this.defaultMode),!te(this.lexerDefinitionErrors)){var r=_(this.lexerDefinitionErrors,function(a){return a.message}),n=r.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+n)}var i=this.tokenizeInternal(e,t);return i},s.prototype.tokenizeInternal=function(e,t){var r=this,n,i,a,o,u,l,c,d,f,T,N,E,S,A,y=e,C=y.length,M=0,re=0,J=this.hasCustom?0:Math.floor(e.length/10),j=new Array(J),ue=[],he=this.trackStartLines?1:void 0,le=this.trackStartLines?1:void 0,q=Yf(this.emptyGroups),Rt=this.trackStartLines,He=this.config.lineTerminatorsPattern,Tt=0,Ze=[],rr=[],nr=[],Pr=[];Object.freeze(Pr);var Yt=void 0;function Vr(){return Ze}function Dr(Be){var Rn=pr(Be),Gr=rr[Rn];return Gr===void 0?Pr:Gr}var gn=function(Be){if(nr.length===1&&Be.tokenType.PUSH_MODE===void 0){var Rn=r.config.errorMessageProvider.buildUnableToPopLexerModeMessage(Be);ue.push({offset:Be.startOffset,line:Be.startLine!==void 0?Be.startLine:void 0,column:Be.startColumn!==void 0?Be.startColumn:void 0,length:Be.image.length,message:Rn})}else{nr.pop();var Gr=Ku(nr);Ze=r.patternIdxToConfig[Gr],rr=r.charCodeToPatternIdxToConfig[Gr],Tt=Ze.length;var kc=r.canModeBeOptimized[Gr]&&r.config.safeMode===!1;rr&&kc?Yt=Dr:Yt=Vr}};function Br(Be){nr.push(Be),rr=this.charCodeToPatternIdxToConfig[Be],Ze=this.patternIdxToConfig[Be],Tt=Ze.length,Tt=Ze.length;var Rn=this.canModeBeOptimized[Be]&&this.config.safeMode===!1;rr&&Rn?Yt=Dr:Yt=Vr}Br.call(this,t);for(var xe;M<C;){u=null;var Qn=y.charCodeAt(M),Zn=Yt(Qn),Ri=Zn.length;for(n=0;n<Ri;n++){xe=Zn[n];var Nt=xe.pattern;l=null;var Rr=xe.short;if(Rr!==!1?Qn===Rr&&(u=Nt):xe.isCustom===!0?(A=Nt.exec(y,M,j,q),A!==null?(u=A[0],A.payload!==void 0&&(l=A.payload)):u=null):(this.updateLastIndex(Nt,M),u=this.match(Nt,e,M)),u!==null){if(o=xe.longerAlt,o!==void 0){var Y=Ze[o],Se=Y.pattern;c=null,Y.isCustom===!0?(A=Se.exec(y,M,j,q),A!==null?(a=A[0],A.payload!==void 0&&(c=A.payload)):a=null):(this.updateLastIndex(Se,M),a=this.match(Se,e,M)),a&&a.length>u.length&&(u=a,l=c,xe=Y)}break}}if(u!==null){if(d=u.length,f=xe.group,f!==void 0&&(T=xe.tokenTypeIdx,N=this.createTokenInstance(u,M,T,xe.tokenType,he,le,d),this.handlePayload(N,l),f===!1?re=this.addToken(j,re,N):q[f].push(N)),e=this.chopInput(e,d),M=M+d,le=this.computeNewColumn(le,d),Rt===!0&&xe.canLineTerminator===!0){var ut=0,Je=void 0,St=void 0;He.lastIndex=0;do Je=He.test(u),Je===!0&&(St=He.lastIndex-1,ut++);while(Je===!0);ut!==0&&(he=he+ut,le=d-St,this.updateTokenEndLineColumnLocation(N,f,St,ut,he,le,d))}this.handleModes(xe,gn,Br,N)}else{for(var Tr=M,kr=he,no=le,En=!1;!En&&M<C;)for(y.charCodeAt(M),e=this.chopInput(e,1),M++,i=0;i<Tt;i++){var Ti=Ze[i],Nt=Ti.pattern,Rr=Ti.short;if(Rr!==!1?y.charCodeAt(M)===Rr&&(En=!0):Ti.isCustom===!0?En=Nt.exec(y,M,j,q)!==null:(this.updateLastIndex(Nt,M),En=Nt.exec(e)!==null),En===!0)break}E=M-Tr,S=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(y,Tr,E,kr,no),ue.push({offset:Tr,line:kr,column:no,length:E,message:S})}}return this.hasCustom||(j.length=re),{tokens:j,groups:q,errors:ue}},s.prototype.handleModes=function(e,t,r,n){if(e.pop===!0){var i=e.push;t(n),i!==void 0&&r.call(this,i)}else e.push!==void 0&&r.call(this,e.push)},s.prototype.chopInput=function(e,t){return e.substring(t)},s.prototype.updateLastIndex=function(e,t){e.lastIndex=t},s.prototype.updateTokenEndLineColumnLocation=function(e,t,r,n,i,a,o){var u,l;t!==void 0&&(u=r===o-1,l=u?-1:0,n===1&&u===!0||(e.endLine=i+l,e.endColumn=a-1+-l))},s.prototype.computeNewColumn=function(e,t){return e+t},s.prototype.createTokenInstance=function(){return null},s.prototype.createOffsetOnlyToken=function(e,t,r,n){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:n}},s.prototype.createStartOnlyToken=function(e,t,r,n,i,a){return{image:e,startOffset:t,startLine:i,startColumn:a,tokenTypeIdx:r,tokenType:n}},s.prototype.createFullToken=function(e,t,r,n,i,a,o){return{image:e,startOffset:t,endOffset:t+o-1,startLine:i,endLine:i,startColumn:a,endColumn:a+o-1,tokenTypeIdx:r,tokenType:n}},s.prototype.addToken=function(e,t,r){return 666},s.prototype.addTokenUsingPush=function(e,t,r){return e.push(r),t},s.prototype.addTokenUsingMemberAccess=function(e,t,r){return e[t]=r,t++,t},s.prototype.handlePayload=function(e,t){},s.prototype.handlePayloadNoCustom=function(e,t){},s.prototype.handlePayloadWithCustom=function(e,t){t!==null&&(e.payload=t)},s.prototype.match=function(e,t,r){return null},s.prototype.matchWithTest=function(e,t,r){var n=e.test(t);return n===!0?t.substring(r,e.lastIndex):null},s.prototype.matchWithExec=function(e,t){var r=e.exec(t);return r!==null?r[0]:r},s.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+e+">");var n=Zu(t),i=n.time,a=n.value,o=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&o(r+"<-- <"+e+"> time: "+i+"ms"),this.traceInitIndent--,a}else return t()},s.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",s.NA=/NOT_APPLICABLE/,s}();function sn(s){return uh(s)?s.LABEL:s.name}function uh(s){return kt(s.LABEL)&&s.LABEL!==""}var nm="parent",To="categories",No="label",So="group",Ao="push_mode",yo="pop_mode",Co="longer_alt",vo="line_breaks",Io="start_chars_hint";function W(s){return sm(s)}function sm(s){var e=s.pattern,t={};if(t.name=s.name,ft(e)||(t.PATTERN=e),U(s,nm))throw`The parent property is no longer supported.
See: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.`;return U(s,To)&&(t.CATEGORIES=s[To]),jn([t]),U(s,No)&&(t.LABEL=s[No]),U(s,So)&&(t.GROUP=s[So]),U(s,yo)&&(t.POP_MODE=s[yo]),U(s,Ao)&&(t.PUSH_MODE=s[Ao]),U(s,Co)&&(t.LONGER_ALT=s[Co]),U(s,vo)&&(t.LINE_BREAKS=s[vo]),U(s,Io)&&(t.START_CHARS_HINT=s[Io]),t}var Lr=W({name:"EOF",pattern:Ke.NA});jn([Lr]);function Oa(s,e,t,r,n,i,a,o){return{image:e,startOffset:t,endOffset:r,startLine:n,endLine:i,startColumn:a,endColumn:o,tokenTypeIdx:s.tokenTypeIdx,tokenType:s}}function Z(s,e){return li(s,e)}var tr=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},s(e,t)};return function(e,t){s(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Ht=function(){function s(e){this.definition=e}return s.prototype.accept=function(e){e.visit(this),b(this.definition,function(t){t.accept(e)})},s}(),it=function(s){tr(e,s);function e(t){var r=s.call(this,[])||this;return r.idx=1,_t(r,Et(t,function(n){return n!==void 0})),r}return Object.defineProperty(e.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.accept=function(t){t.visit(this)},e}(Ht),mn=function(s){tr(e,s);function e(t){var r=s.call(this,t.definition)||this;return r.orgText="",_t(r,Et(t,function(n){return n!==void 0})),r}return e}(Ht),Qe=function(s){tr(e,s);function e(t){var r=s.call(this,t.definition)||this;return r.ignoreAmbiguities=!1,_t(r,Et(t,function(n){return n!==void 0})),r}return e}(Ht),Ue=function(s){tr(e,s);function e(t){var r=s.call(this,t.definition)||this;return r.idx=1,_t(r,Et(t,function(n){return n!==void 0})),r}return e}(Ht),mt=function(s){tr(e,s);function e(t){var r=s.call(this,t.definition)||this;return r.idx=1,_t(r,Et(t,function(n){return n!==void 0})),r}return e}(Ht),gt=function(s){tr(e,s);function e(t){var r=s.call(this,t.definition)||this;return r.idx=1,_t(r,Et(t,function(n){return n!==void 0})),r}return e}(Ht),Ee=function(s){tr(e,s);function e(t){var r=s.call(this,t.definition)||this;return r.idx=1,_t(r,Et(t,function(n){return n!==void 0})),r}return e}(Ht),at=function(s){tr(e,s);function e(t){var r=s.call(this,t.definition)||this;return r.idx=1,_t(r,Et(t,function(n){return n!==void 0})),r}return e}(Ht),ot=function(s){tr(e,s);function e(t){var r=s.call(this,t.definition)||this;return r.idx=1,r.ignoreAmbiguities=!1,r.hasPredicates=!1,_t(r,Et(t,function(n){return n!==void 0})),r}return e}(Ht),oe=function(){function s(e){this.idx=1,_t(this,Et(e,function(t){return t!==void 0}))}return s.prototype.accept=function(e){e.visit(this)},s}();function im(s){return _(s,Ss)}function Ss(s){function e(n){return _(n,Ss)}if(s instanceof it)return{type:"NonTerminal",name:s.nonTerminalName,idx:s.idx};if(s instanceof Qe)return{type:"Flat",definition:e(s.definition)};if(s instanceof Ue)return{type:"Option",idx:s.idx,definition:e(s.definition)};if(s instanceof mt)return{type:"RepetitionMandatory",name:s.name,idx:s.idx,definition:e(s.definition)};if(s instanceof gt)return{type:"RepetitionMandatoryWithSeparator",name:s.name,idx:s.idx,separator:Ss(new oe({terminalType:s.separator})),definition:e(s.definition)};if(s instanceof at)return{type:"RepetitionWithSeparator",name:s.name,idx:s.idx,separator:Ss(new oe({terminalType:s.separator})),definition:e(s.definition)};if(s instanceof Ee)return{type:"Repetition",name:s.name,idx:s.idx,definition:e(s.definition)};if(s instanceof ot)return{type:"Alternation",name:s.name,idx:s.idx,definition:e(s.definition)};if(s instanceof oe){var t={type:"Terminal",name:s.terminalType.name,label:sn(s.terminalType),idx:s.idx},r=s.terminalType.PATTERN;return s.terminalType.PATTERN&&(t.pattern=Jt(r)?r.source:r),t}else{if(s instanceof mn)return{type:"Rule",name:s.name,orgText:s.orgText,definition:e(s.definition)};throw Error("non exhaustive match")}}var ci=function(){function s(){}return s.prototype.walk=function(e,t){var r=this;t===void 0&&(t=[]),b(e.definition,function(n,i){var a=Fe(e.definition,i+1);if(n instanceof it)r.walkProdRef(n,a,t);else if(n instanceof oe)r.walkTerminal(n,a,t);else if(n instanceof Qe)r.walkFlat(n,a,t);else if(n instanceof Ue)r.walkOption(n,a,t);else if(n instanceof mt)r.walkAtLeastOne(n,a,t);else if(n instanceof gt)r.walkAtLeastOneSep(n,a,t);else if(n instanceof at)r.walkManySep(n,a,t);else if(n instanceof Ee)r.walkMany(n,a,t);else if(n instanceof ot)r.walkOr(n,a,t);else throw Error("non exhaustive match")})},s.prototype.walkTerminal=function(e,t,r){},s.prototype.walkProdRef=function(e,t,r){},s.prototype.walkFlat=function(e,t,r){var n=t.concat(r);this.walk(e,n)},s.prototype.walkOption=function(e,t,r){var n=t.concat(r);this.walk(e,n)},s.prototype.walkAtLeastOne=function(e,t,r){var n=[new Ue({definition:e.definition})].concat(t,r);this.walk(e,n)},s.prototype.walkAtLeastOneSep=function(e,t,r){var n=Oo(e,t,r);this.walk(e,n)},s.prototype.walkMany=function(e,t,r){var n=[new Ue({definition:e.definition})].concat(t,r);this.walk(e,n)},s.prototype.walkManySep=function(e,t,r){var n=Oo(e,t,r);this.walk(e,n)},s.prototype.walkOr=function(e,t,r){var n=this,i=t.concat(r);b(e.definition,function(a){var o=new Qe({definition:[a]});n.walk(o,i)})},s}();function Oo(s,e,t){var r=[new Ue({definition:[new oe({terminalType:s.separator})].concat(s.definition)})],n=r.concat(e,t);return n}var br=function(){function s(){}return s.prototype.visit=function(e){var t=e;switch(t.constructor){case it:return this.visitNonTerminal(t);case Qe:return this.visitFlat(t);case Ue:return this.visitOption(t);case mt:return this.visitRepetitionMandatory(t);case gt:return this.visitRepetitionMandatoryWithSeparator(t);case at:return this.visitRepetitionWithSeparator(t);case Ee:return this.visitRepetition(t);case ot:return this.visitAlternation(t);case oe:return this.visitTerminal(t);case mn:return this.visitRule(t);default:throw Error("non exhaustive match")}},s.prototype.visitNonTerminal=function(e){},s.prototype.visitFlat=function(e){},s.prototype.visitOption=function(e){},s.prototype.visitRepetition=function(e){},s.prototype.visitRepetitionMandatory=function(e){},s.prototype.visitRepetitionMandatoryWithSeparator=function(e){},s.prototype.visitRepetitionWithSeparator=function(e){},s.prototype.visitAlternation=function(e){},s.prototype.visitTerminal=function(e){},s.prototype.visitRule=function(e){},s}(),am=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},s(e,t)};return function(e,t){s(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();function om(s){return s instanceof Qe||s instanceof Ue||s instanceof Ee||s instanceof mt||s instanceof gt||s instanceof at||s instanceof oe||s instanceof mn}function Vs(s,e){e===void 0&&(e=[]);var t=s instanceof Ue||s instanceof Ee||s instanceof at;return t?!0:s instanceof ot?ju(s.definition,function(r){return Vs(r,e)}):s instanceof it&&ye(e,s)?!1:s instanceof Ht?(s instanceof it&&e.push(s),dt(s.definition,function(r){return Vs(r,e)})):!1}function um(s){return s instanceof ot}function Ct(s){if(s instanceof it)return"SUBRULE";if(s instanceof Ue)return"OPTION";if(s instanceof ot)return"OR";if(s instanceof mt)return"AT_LEAST_ONE";if(s instanceof gt)return"AT_LEAST_ONE_SEP";if(s instanceof at)return"MANY_SEP";if(s instanceof Ee)return"MANY";if(s instanceof oe)return"CONSUME";throw Error("non exhaustive match")}var hm=function(s){am(e,s);function e(){var t=s!==null&&s.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(t){var r=t.terminalType.name+this.separator+"Terminal";U(this.dslMethods,r)||(this.dslMethods[r]=[]),this.dslMethods[r].push(t)},e.prototype.visitNonTerminal=function(t){var r=t.nonTerminalName+this.separator+"Terminal";U(this.dslMethods,r)||(this.dslMethods[r]=[]),this.dslMethods[r].push(t)},e.prototype.visitOption=function(t){this.dslMethods.option.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.dslMethods.repetitionWithSeparator.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.dslMethods.repetitionMandatory.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)},e.prototype.visitRepetition=function(t){this.dslMethods.repetition.push(t)},e.prototype.visitAlternation=function(t){this.dslMethods.alternation.push(t)},e}(br),ns=new hm;function lm(s){ns.reset(),s.accept(ns);var e=ns.dslMethods;return ns.reset(),e}function qn(s){if(s instanceof it)return qn(s.referencedRule);if(s instanceof oe)return pm(s);if(om(s))return cm(s);if(um(s))return dm(s);throw Error("non exhaustive match")}function cm(s){for(var e=[],t=s.definition,r=0,n=t.length>r,i,a=!0;n&&a;)i=t[r],a=Vs(i),e=e.concat(qn(i)),r=r+1,n=t.length>r;return ya(e)}function dm(s){var e=_(s.definition,function(t){return qn(t)});return ya(je(e))}function pm(s){return[s.terminalType]}var hh="_~IN~_",fm=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},s(e,t)};return function(e,t){s(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),mm=function(s){fm(e,s);function e(t){var r=s.call(this)||this;return r.topProd=t,r.follows={},r}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(t,r,n){},e.prototype.walkProdRef=function(t,r,n){var i=Em(t.referencedRule,t.idx)+this.topProd.name,a=r.concat(n),o=new Qe({definition:a}),u=qn(o);this.follows[i]=u},e}(ci);function gm(s){var e={};return b(s,function(t){var r=new mm(t).startWalking();_t(e,r)}),e}function Em(s,e){return s.name+e+hh}var Rm=4,mr=8,Tm=8,an=1<<mr,Ds=2<<mr,vn=3<<mr,In=4<<mr,On=5<<mr,en=6<<mr;function Mn(s,e,t){return t|e|s}var Nm=32-Tm;function lh(s,e,t,r){var n=r+1<<Nm;return Mn(s,e,t)|n}var Sm=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},s(e,t)};return function(e,t){s(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();function Mo(s,e){isNaN(s.startOffset)===!0?(s.startOffset=e.startOffset,s.endOffset=e.endOffset):s.endOffset<e.endOffset&&(s.endOffset=e.endOffset)}function wo(s,e){isNaN(s.startOffset)===!0?(s.startOffset=e.startOffset,s.startColumn=e.startColumn,s.startLine=e.startLine,s.endOffset=e.endOffset,s.endColumn=e.endColumn,s.endLine=e.endLine):s.endOffset<e.endOffset&&(s.endOffset=e.endOffset,s.endColumn=e.endColumn,s.endLine=e.endLine)}function Am(s,e,t){s.children[t]===void 0?s.children[t]=[e]:s.children[t].push(e)}function _o(s,e,t){s.children[e]===void 0?s.children[e]=[t]:s.children[e].push(t)}var Ma=function(s){Sm(e,s);function e(t){var r=s.call(this)||this;return r.result=[],r.ruleIdx=t,r}return e.prototype.collectNamedDSLMethod=function(t,r,n){if(!ft(t.name)){var i=void 0;if(t instanceof Ue||t instanceof Ee||t instanceof mt||t instanceof ot)i=new r({definition:t.definition,idx:t.idx});else if(t instanceof gt||t instanceof at)i=new r({definition:t.definition,idx:t.idx,separator:t.separator});else throw Error("non exhaustive match");var a=[i],o=Mn(this.ruleIdx,n,t.idx);this.result.push({def:a,key:o,name:t.name,orgProd:t})}},e.prototype.visitOption=function(t){this.collectNamedDSLMethod(t,Ue,Ds)},e.prototype.visitRepetition=function(t){this.collectNamedDSLMethod(t,Ee,vn)},e.prototype.visitRepetitionMandatory=function(t){this.collectNamedDSLMethod(t,mt,In)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.collectNamedDSLMethod(t,gt,en)},e.prototype.visitRepetitionWithSeparator=function(t){this.collectNamedDSLMethod(t,at,On)},e.prototype.visitAlternation=function(t){var r=this;this.collectNamedDSLMethod(t,ot,an);var n=t.definition.length>1;b(t.definition,function(i,a){if(!ft(i.name)){var o=i.definition;n?o=[new Ue({definition:i.definition})]:o=i.definition;var u=lh(r.ruleIdx,an,t.idx,a);r.result.push({def:o,key:u,name:i.name,orgProd:i})}})},e}(br);function ym(s,e){var t={allRuleNames:[]};return b(s,function(r){var n=e[r.name];t.allRuleNames.push(r.name);var i=new Ma(n);r.accept(i),b(i.result,function(a){a.def,a.key;var o=a.name;t.allRuleNames.push(r.name+o)})}),t}var xr=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},s(e,t)};return function(e,t){s(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Cm=function(s){xr(e,s);function e(t,r){var n=s.call(this)||this;return n.topProd=t,n.path=r,n.possibleTokTypes=[],n.nextProductionName="",n.nextProductionOccurrence=0,n.found=!1,n.isAtEndOfPath=!1,n}return e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=qe(this.path.ruleStack).reverse(),this.occurrenceStack=qe(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(t,r){r===void 0&&(r=[]),this.found||s.prototype.walk.call(this,t,r)},e.prototype.walkProdRef=function(t,r,n){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){var i=r.concat(n);this.updateExpectedNext(),this.walk(t.referencedRule,i)}},e.prototype.updateExpectedNext=function(){te(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e}(ci),vm=function(s){xr(e,s);function e(t,r){var n=s.call(this,t,r)||this;return n.path=r,n.nextTerminalName="",n.nextTerminalOccurrence=0,n.nextTerminalName=n.path.lastTok.name,n.nextTerminalOccurrence=n.path.lastTokOccurrence,n}return e.prototype.walkTerminal=function(t,r,n){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){var i=r.concat(n),a=new Qe({definition:i});this.possibleTokTypes=qn(a),this.found=!0}},e}(Cm),di=function(s){xr(e,s);function e(t,r){var n=s.call(this)||this;return n.topRule=t,n.occurrence=r,n.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},n}return e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e}(ci),Im=function(s){xr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.walkMany=function(t,r,n){if(t.idx===this.occurrence){var i=pt(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof oe&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else s.prototype.walkMany.call(this,t,r,n)},e}(di),Lo=function(s){xr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.walkManySep=function(t,r,n){if(t.idx===this.occurrence){var i=pt(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof oe&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else s.prototype.walkManySep.call(this,t,r,n)},e}(di),Om=function(s){xr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.walkAtLeastOne=function(t,r,n){if(t.idx===this.occurrence){var i=pt(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof oe&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else s.prototype.walkAtLeastOne.call(this,t,r,n)},e}(di),Fo=function(s){xr(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.walkAtLeastOneSep=function(t,r,n){if(t.idx===this.occurrence){var i=pt(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof oe&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else s.prototype.walkAtLeastOneSep.call(this,t,r,n)},e}(di);function $i(s,e,t){t===void 0&&(t=[]),t=qe(t);var r=[],n=0;function i(l){return l.concat(Fe(s,n+1))}function a(l){var c=$i(i(l),e,t);return r.concat(c)}for(;t.length<e&&n<s.length;){var o=s[n];if(o instanceof Qe)return a(o.definition);if(o instanceof it)return a(o.definition);if(o instanceof Ue)r=a(o.definition);else if(o instanceof mt){var u=o.definition.concat([new Ee({definition:o.definition})]);return a(u)}else if(o instanceof gt){var u=[new Qe({definition:o.definition}),new Ee({definition:[new oe({terminalType:o.separator})].concat(o.definition)})];return a(u)}else if(o instanceof at){var u=o.definition.concat([new Ee({definition:[new oe({terminalType:o.separator})].concat(o.definition)})]);r=a(u)}else if(o instanceof Ee){var u=o.definition.concat([new Ee({definition:o.definition})]);r=a(u)}else{if(o instanceof ot)return b(o.definition,function(l){r=a(l.definition)}),r;if(o instanceof oe)t.push(o.terminalType);else throw Error("non exhaustive match")}n++}return r.push({partialPath:t,suffixDef:Fe(s,n)}),r}function ch(s,e,t,r){var n="EXIT_NONE_TERMINAL",i=[n],a="EXIT_ALTERNATIVE",o=!1,u=e.length,l=u-r-1,c=[],d=[];for(d.push({idx:-1,def:s,ruleStack:[],occurrenceStack:[]});!te(d);){var f=d.pop();if(f===a){o&&Ku(d).idx<=l&&d.pop();continue}var T=f.def,N=f.idx,E=f.ruleStack,S=f.occurrenceStack;if(!te(T)){var A=T[0];if(A===n){var y={idx:N,def:Fe(T),ruleStack:xn(E),occurrenceStack:xn(S)};d.push(y)}else if(A instanceof oe)if(N<u-1){var C=N+1,M=e[C];if(t(M,A.terminalType)){var y={idx:C,def:Fe(T),ruleStack:E,occurrenceStack:S};d.push(y)}}else if(N===u-1)c.push({nextTokenType:A.terminalType,nextTokenOccurrence:A.idx,ruleStack:E,occurrenceStack:S}),o=!0;else throw Error("non exhaustive match");else if(A instanceof it){var re=qe(E);re.push(A.nonTerminalName);var J=qe(S);J.push(A.idx);var y={idx:N,def:A.definition.concat(i,Fe(T)),ruleStack:re,occurrenceStack:J};d.push(y)}else if(A instanceof Ue){var j={idx:N,def:Fe(T),ruleStack:E,occurrenceStack:S};d.push(j),d.push(a);var ue={idx:N,def:A.definition.concat(Fe(T)),ruleStack:E,occurrenceStack:S};d.push(ue)}else if(A instanceof mt){var he=new Ee({definition:A.definition,idx:A.idx}),le=A.definition.concat([he],Fe(T)),y={idx:N,def:le,ruleStack:E,occurrenceStack:S};d.push(y)}else if(A instanceof gt){var q=new oe({terminalType:A.separator}),he=new Ee({definition:[q].concat(A.definition),idx:A.idx}),le=A.definition.concat([he],Fe(T)),y={idx:N,def:le,ruleStack:E,occurrenceStack:S};d.push(y)}else if(A instanceof at){var j={idx:N,def:Fe(T),ruleStack:E,occurrenceStack:S};d.push(j),d.push(a);var q=new oe({terminalType:A.separator}),Rt=new Ee({definition:[q].concat(A.definition),idx:A.idx}),le=A.definition.concat([Rt],Fe(T)),ue={idx:N,def:le,ruleStack:E,occurrenceStack:S};d.push(ue)}else if(A instanceof Ee){var j={idx:N,def:Fe(T),ruleStack:E,occurrenceStack:S};d.push(j),d.push(a);var Rt=new Ee({definition:A.definition,idx:A.idx}),le=A.definition.concat([Rt],Fe(T)),ue={idx:N,def:le,ruleStack:E,occurrenceStack:S};d.push(ue)}else if(A instanceof ot)for(var He=A.definition.length-1;He>=0;He--){var Tt=A.definition[He],Ze={idx:N,def:Tt.definition.concat(Fe(T)),ruleStack:E,occurrenceStack:S};d.push(Ze),d.push(a)}else if(A instanceof Qe)d.push({idx:N,def:A.definition.concat(Fe(T)),ruleStack:E,occurrenceStack:S});else if(A instanceof mn)d.push(Mm(A,N,E,S));else throw Error("non exhaustive match")}}return c}function Mm(s,e,t,r){var n=qe(t);n.push(s.name);var i=qe(r);return i.push(1),{idx:e,def:s.definition,ruleStack:n,occurrenceStack:i}}var dh=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},s(e,t)};return function(e,t){s(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),ne;(function(s){s[s.OPTION=0]="OPTION",s[s.REPETITION=1]="REPETITION",s[s.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",s[s.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",s[s.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",s[s.ALTERNATION=5]="ALTERNATION"})(ne||(ne={}));function wm(s){if(s instanceof Ue)return ne.OPTION;if(s instanceof Ee)return ne.REPETITION;if(s instanceof mt)return ne.REPETITION_MANDATORY;if(s instanceof gt)return ne.REPETITION_MANDATORY_WITH_SEPARATOR;if(s instanceof at)return ne.REPETITION_WITH_SEPARATOR;if(s instanceof ot)return ne.ALTERNATION;throw Error("non exhaustive match")}function _m(s,e,t,r,n,i){var a=wa(s,e,t),o=mh(a)?Ps:li;return i(a,r,o,n)}function Lm(s,e,t,r,n,i){var a=_a(s,e,n,t),o=mh(a)?Ps:li;return i(a[0],o,r)}function Fm(s,e,t,r){var n=s.length,i=dt(s,function(u){return dt(u,function(l){return l.length===1})});if(e)return function(u){for(var l=_(u,function(C){return C.GATE}),c=0;c<n;c++){var d=s[c],f=d.length,T=l[c];if(!(T!==void 0&&T.call(this)===!1))e:for(var N=0;N<f;N++){for(var E=d[N],S=E.length,A=0;A<S;A++){var y=this.LA(A+1);if(t(y,E[A])===!1)continue e}return c}}};if(i&&!r){var a=_(s,function(u){return je(u)}),o=be(a,function(u,l,c){return b(l,function(d){U(u,d.tokenTypeIdx)||(u[d.tokenTypeIdx]=c),b(d.categoryMatches,function(f){U(u,f)||(u[f]=c)})}),u},[]);return function(){var u=this.LA(1);return o[u.tokenTypeIdx]}}else return function(){for(var u=0;u<n;u++){var l=s[u],c=l.length;e:for(var d=0;d<c;d++){for(var f=l[d],T=f.length,N=0;N<T;N++){var E=this.LA(N+1);if(t(E,f[N])===!1)continue e}return u}}}}function Um(s,e,t){var r=dt(s,function(l){return l.length===1}),n=s.length;if(r&&!t){var i=je(s);if(i.length===1&&te(i[0].categoryMatches)){var a=i[0],o=a.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===o}}else{var u=be(i,function(l,c,d){return l[c.tokenTypeIdx]=!0,b(c.categoryMatches,function(f){l[f]=!0}),l},[]);return function(){var l=this.LA(1);return u[l.tokenTypeIdx]===!0}}}else return function(){e:for(var l=0;l<n;l++){for(var c=s[l],d=c.length,f=0;f<d;f++){var T=this.LA(f+1);if(e(T,c[f])===!1)continue e}return!0}return!1}}var bm=function(s){dh(e,s);function e(t,r,n){var i=s.call(this)||this;return i.topProd=t,i.targetOccurrence=r,i.targetProdType=n,i}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(t,r,n,i){return t.idx===this.targetOccurrence&&this.targetProdType===r?(this.restDef=n.concat(i),!0):!1},e.prototype.walkOption=function(t,r,n){this.checkIsTarget(t,ne.OPTION,r,n)||s.prototype.walkOption.call(this,t,r,n)},e.prototype.walkAtLeastOne=function(t,r,n){this.checkIsTarget(t,ne.REPETITION_MANDATORY,r,n)||s.prototype.walkOption.call(this,t,r,n)},e.prototype.walkAtLeastOneSep=function(t,r,n){this.checkIsTarget(t,ne.REPETITION_MANDATORY_WITH_SEPARATOR,r,n)||s.prototype.walkOption.call(this,t,r,n)},e.prototype.walkMany=function(t,r,n){this.checkIsTarget(t,ne.REPETITION,r,n)||s.prototype.walkOption.call(this,t,r,n)},e.prototype.walkManySep=function(t,r,n){this.checkIsTarget(t,ne.REPETITION_WITH_SEPARATOR,r,n)||s.prototype.walkOption.call(this,t,r,n)},e}(ci),ph=function(s){dh(e,s);function e(t,r,n){var i=s.call(this)||this;return i.targetOccurrence=t,i.targetProdType=r,i.targetRef=n,i.result=[],i}return e.prototype.checkIsTarget=function(t,r){t.idx===this.targetOccurrence&&this.targetProdType===r&&(this.targetRef===void 0||t===this.targetRef)&&(this.result=t.definition)},e.prototype.visitOption=function(t){this.checkIsTarget(t,ne.OPTION)},e.prototype.visitRepetition=function(t){this.checkIsTarget(t,ne.REPETITION)},e.prototype.visitRepetitionMandatory=function(t){this.checkIsTarget(t,ne.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.checkIsTarget(t,ne.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(t){this.checkIsTarget(t,ne.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(t){this.checkIsTarget(t,ne.ALTERNATION)},e}(br);function Uo(s){for(var e=new Array(s),t=0;t<s;t++)e[t]=[];return e}function Oi(s){for(var e=[""],t=0;t<s.length;t++){for(var r=s[t],n=[],i=0;i<e.length;i++){var a=e[i];n.push(a+"_"+r.tokenTypeIdx);for(var o=0;o<r.categoryMatches.length;o++){var u="_"+r.categoryMatches[o];n.push(a+u)}}e=n}return e}function xm(s,e,t){for(var r=0;r<s.length;r++)if(r!==t)for(var n=s[r],i=0;i<e.length;i++){var a=e[i];if(n[a]===!0)return!1}return!0}function fh(s,e){for(var t=_(s,function(c){return $i([c],1)}),r=Uo(t.length),n=_(t,function(c){var d={};return b(c,function(f){var T=Oi(f.partialPath);b(T,function(N){d[N]=!0})}),d}),i=t,a=1;a<=e;a++){var o=i;i=Uo(o.length);for(var u=function(c){for(var d=o[c],f=0;f<d.length;f++){var T=d[f].partialPath,N=d[f].suffixDef,E=Oi(T),S=xm(n,E,c);if(S||te(N)||T.length===e){var A=r[c];if(Xi(A,T)===!1){A.push(T);for(var y=0;y<E.length;y++){var C=E[y];n[c][C]=!0}}}else{var M=$i(N,a+1,T);i[c]=i[c].concat(M),b(M,function(re){var J=Oi(re.partialPath);b(J,function(j){n[c][j]=!0})})}}},l=0;l<o.length;l++)u(l)}return r}function wa(s,e,t,r){var n=new ph(s,ne.ALTERNATION,r);return e.accept(n),fh(n.result,t)}function _a(s,e,t,r){var n=new ph(s,t);e.accept(n);var i=n.result,a=new bm(e,s,t),o=a.startWalking(),u=new Qe({definition:i}),l=new Qe({definition:o});return fh([u,l],r)}function Xi(s,e){e:for(var t=0;t<s.length;t++){var r=s[t];if(r.length===e.length){for(var n=0;n<r.length;n++){var i=e[n],a=r[n],o=i===a||a.categoryMatchesMap[i.tokenTypeIdx]!==void 0;if(o===!1)continue e}return!0}}return!1}function Pm(s,e){return s.length<e.length&&dt(s,function(t,r){var n=e[r];return t===n||n.categoryMatchesMap[t.tokenTypeIdx]})}function mh(s){return dt(s,function(e){return dt(e,function(t){return dt(t,function(r){return te(r.categoryMatches)})})})}var La=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},s(e,t)};return function(e,t){s(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();function Vm(s,e,t,r,n,i){var a=_(s,function(y){return Bm(y,n)}),o=_(s,function(y){return Rh(y,y,n)}),u=[],l=[],c=[];dt(o,te)&&(u=_(s,function(y){return Xm(y,n)}),l=_(s,function(y){return Km(y,e,r,n)}),c=Qm(s,e,n));var d=eg(s,t,n),f=_(t,function(y){return Ym(y,n)}),T=Dm(s,n),N=tg(s,n),E=_(s,function(y){return qm(y,n)}),S=_(s,function(y){return Hm(y,n)}),A=_(s,function(y){return zm(y,s,i,n)});return je(a.concat(f,T,N,c,o,u,l,d,E,S,A))}function Dm(s,e){var t=[];return b(s,function(r){var n=new Ma("");r.accept(n);var i=_(n.result,function(a){return a.orgProd});t.push(_(i,function(a){return Wm(r,a,e)}))}),je(t)}function Bm(s,e){var t=new Gm;s.accept(t);var r=t.allProductions,n=qu(r,km),i=Et(n,function(o){return o.length>1}),a=_(De(i),function(o){var u=pt(o),l=e.buildDuplicateFoundError(s,o),c=Ct(u),d={message:l,type:we.DUPLICATE_PRODUCTIONS,ruleName:s.name,dslName:c,occurrence:u.idx},f=gh(u);return f&&(d.parameter=f),d});return a}function km(s){return Ct(s)+"_#_"+s.idx+"_#_"+gh(s)}function gh(s){return s instanceof oe?s.terminalType.name:s instanceof it?s.nonTerminalName:""}var Gm=function(s){La(e,s);function e(){var t=s!==null&&s.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitNonTerminal=function(t){this.allProductions.push(t)},e.prototype.visitOption=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e.prototype.visitAlternation=function(t){this.allProductions.push(t)},e.prototype.visitTerminal=function(t){this.allProductions.push(t)},e}(br),Fr=/^[a-zA-Z_]\w*$/,Eh=new RegExp(Fr.source.replace("^","^\\$"));function Hm(s,e){var t=[],r=s.name;return r.match(Fr)||t.push({message:e.buildInvalidRuleNameError({topLevelRule:s,expectedPattern:Fr}),type:we.INVALID_RULE_NAME,ruleName:r}),t}function Wm(s,e,t){var r=[],n;return e.name.match(Eh)||(n=t.buildInvalidNestedRuleNameError(s,e),r.push({message:n,type:we.INVALID_NESTED_RULE_NAME,ruleName:s.name})),r}function Ym(s,e){var t=[],r=s.name;return r.match(Fr)||t.push({message:e.buildTokenNameError({tokenType:s,expectedPattern:Fr}),type:we.INVALID_TOKEN_NAME}),t}function zm(s,e,t,r){var n=[],i=be(e,function(o,u){return u.name===s.name?o+1:o},0);if(i>1){var a=r.buildDuplicateRuleNameError({topLevelRule:s,grammarName:t});n.push({message:a,type:we.DUPLICATE_RULE_NAME,ruleName:s.name})}return n}function $m(s,e,t){var r=[],n;return ye(e,s)||(n="Invalid rule override, rule: ->"+s+"<- cannot be overridden in the grammar: ->"+t+"<-as it is not defined in any of the super grammars ",r.push({message:n,type:we.INVALID_RULE_OVERRIDE,ruleName:s})),r}function Rh(s,e,t,r){r===void 0&&(r=[]);var n=[],i=As(e.definition);if(te(i))return[];var a=s.name,o=ye(i,s);o&&n.push({message:t.buildLeftRecursionError({topLevelRule:s,leftRecursionPath:r}),type:we.LEFT_RECURSION,ruleName:a});var u=oi(i,r.concat([s])),l=_(u,function(c){var d=qe(r);return d.push(c),Rh(s,c,t,d)});return n.concat(je(l))}function As(s){var e=[];if(te(s))return e;var t=pt(s);if(t instanceof it)e.push(t.referencedRule);else if(t instanceof Qe||t instanceof Ue||t instanceof mt||t instanceof gt||t instanceof at||t instanceof Ee)e=e.concat(As(t.definition));else if(t instanceof ot)e=je(_(t.definition,function(a){return As(a.definition)}));else if(!(t instanceof oe))throw Error("non exhaustive match");var r=Vs(t),n=s.length>1;if(r&&n){var i=Fe(s);return e.concat(As(i))}else return e}var Fa=function(s){La(e,s);function e(){var t=s!==null&&s.apply(this,arguments)||this;return t.alternations=[],t}return e.prototype.visitAlternation=function(t){this.alternations.push(t)},e}(br);function Xm(s,e){var t=new Fa;s.accept(t);var r=t.alternations,n=be(r,function(i,a){var o=xn(a.definition),u=_(o,function(l,c){var d=ch([l],[],null,1);return te(d)?{message:e.buildEmptyAlternationError({topLevelRule:s,alternation:a,emptyChoiceIdx:c}),type:we.NONE_LAST_EMPTY_ALT,ruleName:s.name,occurrence:a.idx,alternative:c+1}:null});return i.concat(Xn(u))},[]);return n}function Km(s,e,t,r){var n=new Fa;s.accept(n);var i=n.alternations,a=t[s.name];a&&(i=_r(i,function(u){return a[Ct(u)+(u.idx===0?"":u.idx)]})),i=_r(i,function(u){return u.ignoreAmbiguities===!0});var o=be(i,function(u,l){var c=l.idx,d=l.maxLookahead||e,f=wa(c,s,d,l),T=Zm(f,l,s,r),N=Jm(f,l,s,r);return u.concat(T,N)},[]);return o}var jm=function(s){La(e,s);function e(){var t=s!==null&&s.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e}(br);function qm(s,e){var t=new Fa;s.accept(t);var r=t.alternations,n=be(r,function(i,a){return a.definition.length>255&&i.push({message:e.buildTooManyAlternativesError({topLevelRule:s,alternation:a}),type:we.TOO_MANY_ALTS,ruleName:s.name,occurrence:a.idx}),i},[]);return n}function Qm(s,e,t){var r=[];return b(s,function(n){var i=new jm;n.accept(i);var a=i.allProductions;b(a,function(o){var u=wm(o),l=o.maxLookahead||e,c=o.idx,d=_a(c,n,u,l),f=d[0];if(te(je(f))){var T=t.buildEmptyRepetitionError({topLevelRule:n,repetition:o});r.push({message:T,type:we.NO_NON_EMPTY_LOOKAHEAD,ruleName:n.name})}})}),r}function Zm(s,e,t,r){var n=[],i=be(s,function(o,u,l){return e.definition[l].ignoreAmbiguities===!0||b(u,function(c){var d=[l];b(s,function(f,T){l!==T&&Xi(f,c)&&e.definition[T].ignoreAmbiguities!==!0&&d.push(T)}),d.length>1&&!Xi(n,c)&&(n.push(c),o.push({alts:d,path:c}))}),o},[]),a=_(i,function(o){var u=_(o.alts,function(c){return c+1}),l=r.buildAlternationAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:u,prefixPath:o.path});return{message:l,type:we.AMBIGUOUS_ALTS,ruleName:t.name,occurrence:e.idx,alternatives:[o.alts]}});return a}function Jm(s,e,t,r){var n=[],i=be(s,function(a,o,u){var l=_(o,function(c){return{idx:u,path:c}});return a.concat(l)},[]);return b(i,function(a){var o=e.definition[a.idx];if(o.ignoreAmbiguities!==!0){var u=a.idx,l=a.path,c=df(i,function(f){return e.definition[f.idx].ignoreAmbiguities!==!0&&f.idx<u&&Pm(f.path,l)}),d=_(c,function(f){var T=[f.idx+1,u+1],N=e.idx===0?"":e.idx,E=r.buildAlternationPrefixAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:T,prefixPath:f.path});return{message:E,type:we.AMBIGUOUS_PREFIX_ALTS,ruleName:t.name,occurrence:N,alternatives:T}});n=n.concat(d)}}),n}function eg(s,e,t){var r=[],n=_(e,function(i){return i.name});return b(s,function(i){var a=i.name;if(ye(n,a)){var o=t.buildNamespaceConflictError(i);r.push({message:o,type:we.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:a})}}),r}function tg(s,e){var t=[];return b(s,function(r){var n=new Ma("");r.accept(n);var i=qu(n.result,function(o){return o.name}),a=Et(i,function(o){return o.length>1});b(De(a),function(o){var u=_(o,function(c){return c.orgProd}),l=e.buildDuplicateNestedRuleNameError(r,u);t.push({message:l,type:we.DUPLICATE_NESTED_NAME,ruleName:r.name})})}),t}var Th={buildMismatchTokenMessage:function(s){var e=s.expected,t=s.actual;s.previous,s.ruleName;var r=uh(e),n=r?"--> "+sn(e)+" <--":"token of type --> "+e.name+" <--",i="Expecting "+n+" but found --> '"+t.image+"' <--";return i},buildNotAllInputParsedMessage:function(s){var e=s.firstRedundant;return s.ruleName,"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(s){var e=s.expectedPathsPerAlt,t=s.actual;s.previous;var r=s.customUserDescription;s.ruleName;var n="Expecting: ",i=pt(t).image,a=`
but found: '`+i+"'";if(r)return n+r+a;var o=be(e,function(d,f){return d.concat(f)},[]),u=_(o,function(d){return"["+_(d,function(f){return sn(f)}).join(", ")+"]"}),l=_(u,function(d,f){return"  "+(f+1)+". "+d}),c=`one of these possible Token sequences:
`+l.join(`
`);return n+c+a},buildEarlyExitMessage:function(s){var e=s.expectedIterationPaths,t=s.actual,r=s.customUserDescription;s.ruleName;var n="Expecting: ",i=pt(t).image,a=`
but found: '`+i+"'";if(r)return n+r+a;var o=_(e,function(l){return"["+_(l,function(c){return sn(c)}).join(",")+"]"}),u=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+("<"+o.join(" ,")+">");return n+u+a}};Object.freeze(Th);var rg={buildRuleNotFoundError:function(s,e){var t="Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+s.name+"<-";return t}},Ua={buildDuplicateFoundError:function(s,e){function t(c){return c instanceof oe?c.terminalType.name:c instanceof it?c.nonTerminalName:""}var r=s.name,n=pt(e),i=n.idx,a=Ct(n),o=t(n),u=i>0,l="->"+a+(u?i:"")+"<- "+(o?"with argument: ->"+o+"<-":"")+`
                  appears more than once (`+e.length+" times) in the top level rule: ->"+r+`<-.                  
                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return l=l.replace(/[ \t]+/g," "),l=l.replace(/\s\s+/g,`
`),l},buildInvalidNestedRuleNameError:function(s,e){var t="Invalid nested rule name: ->"+e.name+"<- inside rule: ->"+s.name+`<-
`+("it must match the pattern: ->"+Eh.toString()+`<-.
`)+"Note that this means a nested rule name must start with the '$'(dollar) sign.";return t},buildDuplicateNestedRuleNameError:function(s,e){var t=pt(e).name,r="Duplicate nested rule name: ->"+t+"<- inside rule: ->"+s.name+`<-
A nested name must be unique in the scope of a top level grammar rule.`;return r},buildNamespaceConflictError:function(s){var e=`Namespace conflict found in grammar.
`+("The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+s.name+`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return e},buildAlternationPrefixAmbiguityError:function(s){var e=_(s.prefixPath,function(n){return sn(n)}).join(", "),t=s.alternation.idx===0?"":s.alternation.idx,r="Ambiguous alternatives: <"+s.ambiguityIndices.join(" ,")+`> due to common lookahead prefix
`+("in <OR"+t+"> inside <"+s.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`)+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return r},buildAlternationAmbiguityError:function(s){var e=_(s.prefixPath,function(n){return sn(n)}).join(", "),t=s.alternation.idx===0?"":s.alternation.idx,r="Ambiguous Alternatives Detected: <"+s.ambiguityIndices.join(" ,")+"> in <OR"+t+">"+(" inside <"+s.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`);return r=r+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r},buildEmptyRepetitionError:function(s){var e=Ct(s.repetition);s.repetition.idx!==0&&(e+=s.repetition.idx);var t="The repetition <"+e+"> within Rule <"+s.topLevelRule.name+`> can never consume any tokens.
This could lead to an infinite loop.`;return t},buildTokenNameError:function(s){var e=s.tokenType.name,t="Invalid Grammar Token name: ->"+e+"<- it must match the pattern: ->"+s.expectedPattern.toString()+"<-";return t},buildEmptyAlternationError:function(s){var e="Ambiguous empty alternative: <"+(s.emptyChoiceIdx+1)+">"+(" in <OR"+s.alternation.idx+"> inside <"+s.topLevelRule.name+`> Rule.
`)+"Only the last alternative may be an empty alternative.";return e},buildTooManyAlternativesError:function(s){var e=`An Alternation cannot have more than 256 alternatives:
`+("<OR"+s.alternation.idx+"> inside <"+s.topLevelRule.name+`> Rule.
 has `+(s.alternation.definition.length+1)+" alternatives.");return e},buildLeftRecursionError:function(s){var e=s.topLevelRule.name,t=_(s.leftRecursionPath,function(i){return i.name}),r=e+" --> "+t.concat([e]).join(" --> "),n=`Left Recursion found in grammar.
`+("rule: <"+e+`> can be invoked from itself (directly or indirectly)
`)+(`without consuming any Tokens. The grammar path that causes this is: 
 `+r+`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.`;return n},buildInvalidRuleNameError:function(s){var e=s.topLevelRule.name,t=s.expectedPattern.toString(),r="Invalid grammar rule name: ->"+e+"<- it must match the pattern: ->"+t+"<-";return r},buildDuplicateRuleNameError:function(s){var e;s.topLevelRule instanceof mn?e=s.topLevelRule.name:e=s.topLevelRule;var t="Duplicate definition, rule: ->"+e+"<- is already defined in the grammar: ->"+s.grammarName+"<-";return t}},ng=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},s(e,t)};return function(e,t){s(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();function sg(s,e){var t=new ig(s,e);return t.resolveRefs(),t.errors}var ig=function(s){ng(e,s);function e(t,r){var n=s.call(this)||this;return n.nameToTopRule=t,n.errMsgProvider=r,n.errors=[],n}return e.prototype.resolveRefs=function(){var t=this;b(De(this.nameToTopRule),function(r){t.currTopLevel=r,r.accept(t)})},e.prototype.visitNonTerminal=function(t){var r=this.nameToTopRule[t.nonTerminalName];if(r)t.referencedRule=r;else{var n=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:n,type:we.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}},e}(br);function ag(s){s=ui(s,{errMsgProvider:rg});var e={};return b(s.rules,function(t){e[t.name]=t}),sg(e,s.errMsgProvider)}function og(s){return s=ui(s,{errMsgProvider:Ua,ignoredIssues:{}}),Vm(s.rules,s.maxLookahead,s.tokenTypes,s.ignoredIssues,s.errMsgProvider,s.grammarName)}var Nh="MismatchedTokenException",Sh="NoViableAltException",Ah="EarlyExitException",yh="NotAllInputParsedException",Ch=[Nh,Sh,Ah,yh];Object.freeze(Ch);function Bs(s){return ye(Ch,s.name)}function ba(s,e,t){this.name=Nh,this.message=s,this.token=e,this.previousToken=t,this.resyncedTokens=[]}ba.prototype=Error.prototype;function vh(s,e,t){this.name=Sh,this.message=s,this.token=e,this.previousToken=t,this.resyncedTokens=[]}vh.prototype=Error.prototype;function Ih(s,e){this.name=yh,this.message=s,this.token=e,this.resyncedTokens=[]}Ih.prototype=Error.prototype;function Oh(s,e,t){this.name=Ah,this.message=s,this.token=e,this.previousToken=t,this.resyncedTokens=[]}Oh.prototype=Error.prototype;var Mi={},Mh="InRuleRecoveryException";function wh(s){this.name=Mh,this.message=s}wh.prototype=Error.prototype;var ug=function(){function s(){}return s.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=U(e,"recoveryEnabled")?e.recoveryEnabled:ze.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=hg)},s.prototype.getTokenToInsert=function(e){var t=Oa(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},s.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},s.prototype.tryInRepetitionRecovery=function(e,t,r,n){for(var i=this,a=this.findReSyncTokenType(),o=this.exportLexerState(),u=[],l=!1,c=this.LA(1),d=this.LA(1),f=function(){var T=i.LA(0),N=i.errorMessageProvider.buildMismatchTokenMessage({expected:n,actual:c,previous:T,ruleName:i.getCurrRuleFullName()}),E=new ba(N,c,i.LA(0));E.resyncedTokens=xn(u),i.SAVE_ERROR(E)};!l;)if(this.tokenMatcher(d,n)){f();return}else if(r.call(this)){f(),e.apply(this,t);return}else this.tokenMatcher(d,a)?l=!0:(d=this.SKIP_TOKEN(),this.addToResyncTokens(d,u));this.importLexerState(o)},s.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,r){return!(r===!1||e===void 0||t===void 0||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))},s.prototype.getFollowsForInRuleRecovery=function(e,t){var r=this.getCurrentGrammarPath(e,t),n=this.getNextPossibleTokenTypes(r);return n},s.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t)){var r=this.getTokenToInsert(e);return r}if(this.canRecoverWithSingleTokenDeletion(e)){var n=this.SKIP_TOKEN();return this.consumeToken(),n}throw new wh("sad sad panda")},s.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},s.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(e)||te(t))return!1;var n=this.LA(1),i=cn(t,function(a){return r.tokenMatcher(n,a)})!==void 0;return i},s.prototype.canRecoverWithSingleTokenDeletion=function(e){var t=this.tokenMatcher(this.LA(2),e);return t},s.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(t);return ye(r,e)},s.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),r=2;;){var n=t.tokenType;if(ye(e,n))return n;t=this.LA(r),r++}},s.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return Mi;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(r)}},s.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return te(this.LAST_EXPLICIT_RULE_STACK)||(t=_(this.LAST_EXPLICIT_RULE_STACK,function(n){return e.RULE_STACK[n]}),r=_(this.LAST_EXPLICIT_RULE_STACK,function(n){return e.RULE_OCCURRENCE_STACK[n]})),_(t,function(n,i){return i===0?Mi:{ruleName:e.shortRuleNameToFullName(n),idxInCallingRule:r[i],inRule:e.shortRuleNameToFullName(t[i-1])}})},s.prototype.flattenFollowSet=function(){var e=this,t=_(this.buildFullFollowKeyStack(),function(r){return e.getFollowSetFromFollowKey(r)});return je(t)},s.prototype.getFollowSetFromFollowKey=function(e){if(e===Mi)return[Lr];var t=e.ruleName+e.idxInCallingRule+hh+e.inRule;return this.resyncFollows[t]},s.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,Lr)||t.push(e),t},s.prototype.reSyncTo=function(e){for(var t=[],r=this.LA(1);this.tokenMatcher(r,e)===!1;)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return xn(t)},s.prototype.attemptInRepetitionRecovery=function(e,t,r,n,i,a,o){},s.prototype.getCurrentGrammarPath=function(e,t){var r=this.getHumanReadableRuleStack(),n=qe(this.RULE_OCCURRENCE_STACK),i={ruleStack:r,occurrenceStack:n,lastTok:e,lastTokOccurrence:t};return i},s.prototype.getHumanReadableRuleStack=function(){var e=this;return te(this.LAST_EXPLICIT_RULE_STACK)?_(this.RULE_STACK,function(t){return e.shortRuleNameToFullName(t)}):_(this.LAST_EXPLICIT_RULE_STACK,function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])})},s}();function hg(s,e,t,r,n,i,a){var o=this.getKeyForAutomaticLookahead(r,n),u=this.firstAfterRepMap[o];if(u===void 0){var l=this.getCurrRuleFullName(),c=this.getGAstProductions()[l],d=new i(c,n);u=d.startWalking(),this.firstAfterRepMap[o]=u}var f=u.token,T=u.occurrence,N=u.isEndOfRule;this.RULE_STACK.length===1&&N&&f===void 0&&(f=Lr,T=1),this.shouldInRepetitionRecoveryBeTried(f,T,a)&&this.tryInRepetitionRecovery(s,e,t,f)}var lg=function(){function s(){}return s.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=U(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:ze.dynamicTokensEnabled,this.maxLookahead=U(e,"maxLookahead")?e.maxLookahead:ze.maxLookahead,this.lookAheadFuncsCache=co()?new Map:[],co()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},s.prototype.preComputeLookaheadFunctions=function(e){var t=this;b(e,function(r){t.TRACE_INIT(r.name+" Rule Lookahead",function(){var n=lm(r),i=n.alternation,a=n.repetition,o=n.option,u=n.repetitionMandatory,l=n.repetitionMandatoryWithSeparator,c=n.repetitionWithSeparator;b(i,function(d){var f=d.idx===0?"":d.idx;t.TRACE_INIT(""+Ct(d)+f,function(){var T=_m(d.idx,r,d.maxLookahead||t.maxLookahead,d.hasPredicates,t.dynamicTokensEnabled,t.lookAheadBuilderForAlternatives),N=Mn(t.fullRuleNameToShort[r.name],an,d.idx);t.setLaFuncCache(N,T)})}),b(a,function(d){t.computeLookaheadFunc(r,d.idx,vn,ne.REPETITION,d.maxLookahead,Ct(d))}),b(o,function(d){t.computeLookaheadFunc(r,d.idx,Ds,ne.OPTION,d.maxLookahead,Ct(d))}),b(u,function(d){t.computeLookaheadFunc(r,d.idx,In,ne.REPETITION_MANDATORY,d.maxLookahead,Ct(d))}),b(l,function(d){t.computeLookaheadFunc(r,d.idx,en,ne.REPETITION_MANDATORY_WITH_SEPARATOR,d.maxLookahead,Ct(d))}),b(c,function(d){t.computeLookaheadFunc(r,d.idx,On,ne.REPETITION_WITH_SEPARATOR,d.maxLookahead,Ct(d))})})})},s.prototype.computeLookaheadFunc=function(e,t,r,n,i,a){var o=this;this.TRACE_INIT(""+a+(t===0?"":t),function(){var u=Lm(t,e,i||o.maxLookahead,o.dynamicTokensEnabled,n,o.lookAheadBuilderForOptional),l=Mn(o.fullRuleNameToShort[e.name],r,t);o.setLaFuncCache(l,u)})},s.prototype.lookAheadBuilderForOptional=function(e,t,r){return Um(e,t,r)},s.prototype.lookAheadBuilderForAlternatives=function(e,t,r,n){return Fm(e,t,r,n)},s.prototype.getKeyForAutomaticLookahead=function(e,t){var r=this.getLastExplicitRuleShortName();return Mn(r,e,t)},s.prototype.getLaFuncFromCache=function(e){},s.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},s.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},s.prototype.setLaFuncCache=function(e,t){},s.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},s.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},s}();function cg(s){return pi(s.constructor)}var dg=/^\s*function\s*(\S*)\s*\(/,bo="name";function pi(s){var e=s.name;if(e)return e;var t=s.toString().match(dg)[1];return t}function _h(s,e){var t=Object.getOwnPropertyDescriptor(s,bo);return ft(t)||t.configurable?(Object.defineProperty(s,bo,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0):!1}function pg(s,e){for(var t=er(s),r=t.length,n=0;n<r;n++)for(var i=t[n],a=s[i],o=a.length,u=0;u<o;u++){var l=a[u];l.tokenTypeIdx===void 0&&(l.fullName!==void 0?this[l.fullName](l.children,e):this[l.name](l.children,e))}}function fg(s,e){var t=function(){};_h(t,s+"BaseSemantics");var r={visit:function(n,i){if(Ot(n)&&(n=n[0]),!ft(n))return n.fullName!==void 0?this[n.fullName](n.children,i):this[n.name](n.children,i)},validateVisitor:function(){var n=gg(this,e);if(!te(n)){var i=_(n,function(a){return a.msg});throw Error("Errors Detected in CST Visitor <"+pi(this.constructor)+`>:
	`+(""+i.join(`

`).replace(/\n/g,`
	`)))}}};return t.prototype=r,t.prototype.constructor=t,t._RULE_NAMES=e,t}function mg(s,e,t){var r=function(){};_h(r,s+"BaseSemanticsWithDefaults");var n=Object.create(t.prototype);return b(e,function(i){n[i]=pg}),r.prototype=n,r.prototype.constructor=r,r}var ks;(function(s){s[s.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",s[s.MISSING_METHOD=1]="MISSING_METHOD"})(ks||(ks={}));function gg(s,e){var t=Eg(s,e),r=Tg(s,e);return t.concat(r)}function Eg(s,e){var t=_(e,function(r){if(!fr(s[r]))return{msg:"Missing visitor method: <"+r+"> on "+pi(s.constructor)+" CST Visitor.",type:ks.MISSING_METHOD,methodName:r}});return Xn(t)}var Rg=["constructor","visit","validateVisitor"];function Tg(s,e){var t=[];for(var r in s)Fr.test(r)&&fr(s[r])&&!ye(Rg,r)&&!ye(e,r)&&t.push({msg:"Redundant visitor method: <"+r+"> on "+pi(s.constructor)+` CST Visitor
There is no Grammar Rule corresponding to this method's name.
`+("For utility methods on visitor classes use methods names that do not match /"+Fr.source+"/."),type:ks.REDUNDANT_METHOD,methodName:r});return t}var Ng=function(){function s(){}return s.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=U(e,"outputCst")?e.outputCst:ze.outputCst,this.nodeLocationTracking=U(e,"nodeLocationTracking")?e.nodeLocationTracking:ze.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=Ce,this.cstFinallyStateUpdate=Ce,this.cstPostTerminal=Ce,this.cstPostNonTerminal=Ce,this.cstPostRule=Ce,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=wo,this.setNodeLocationFromNode=wo,this.cstPostRule=Ce,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=Ce,this.setNodeLocationFromNode=Ce,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Mo,this.setNodeLocationFromNode=Mo,this.cstPostRule=Ce,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=Ce,this.setNodeLocationFromNode=Ce,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=Ce,this.setNodeLocationFromNode=Ce,this.cstPostRule=Ce,this.setInitialNodeLocation=Ce;else throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"')},s.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},s.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},s.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},s.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},s.prototype.cstNestedInvocationStateUpdate=function(e,t){var r={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},s.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var r={name:e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},s.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},s.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},s.prototype.cstPostRuleFull=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset?(r.endOffset=t.endOffset,r.endLine=t.endLine,r.endColumn=t.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)},s.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset?r.endOffset=t.endOffset:r.startOffset=NaN},s.prototype.cstPostTerminal=function(e,t){var r=this.CST_STACK[this.CST_STACK.length-1];Am(r,t,e),this.setNodeLocationFromToken(r.location,t)},s.prototype.cstPostNonTerminal=function(e,t){if(this.isBackTracking()!==!0){var r=this.CST_STACK[this.CST_STACK.length-1];_o(r,t,e),this.setNodeLocationFromNode(r.location,e.location)}},s.prototype.getBaseCstVisitorConstructor=function(){if(ft(this.baseCstVisitorConstructor)){var e=fg(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},s.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(ft(this.baseCstVisitorWithDefaultsConstructor)){var e=mg(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},s.prototype.nestedRuleBeforeClause=function(e,t){var r;if(e.NAME!==void 0)return r=e.NAME,this.nestedRuleInvocationStateUpdate(r,t),r},s.prototype.nestedAltBeforeClause=function(e,t,r,n){var i=this.getLastExplicitRuleShortName(),a=lh(i,r,t,n),o;if(e.NAME!==void 0)return o=e.NAME,this.nestedRuleInvocationStateUpdate(o,a),{shortName:a,nestedName:o}},s.prototype.nestedRuleFinallyClause=function(e,t){var r=this.CST_STACK,n=r[r.length-1];this.nestedRuleFinallyStateUpdate();var i=r[r.length-1];_o(i,t,n),this.setNodeLocationFromNode(i.location,n.location)},s.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},s.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},s.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},s.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},s.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},s.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},s.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},s.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},s}(),Sg=function(){function s(){}return s.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(s.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),s.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):Hs},s.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?Hs:this.tokVector[t]},s.prototype.consumeToken=function(){this.currIdx++},s.prototype.exportLexerState=function(){return this.currIdx},s.prototype.importLexerState=function(e){this.currIdx=e},s.prototype.resetLexerState=function(){this.currIdx=-1},s.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},s.prototype.getLexerPosition=function(){return this.exportLexerState()},s}(),Ag=function(){function s(){}return s.prototype.ACTION=function(e){return e.call(this)},s.prototype.consume=function(e,t,r){return this.consumeInternal(t,e,r)},s.prototype.subrule=function(e,t,r){return this.subruleInternal(t,e,r)},s.prototype.option=function(e,t){return this.optionInternal(t,e)},s.prototype.or=function(e,t){return this.orInternal(t,e)},s.prototype.many=function(e,t){return this.manyInternal(e,t)},s.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},s.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},s.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},s.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},s.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},s.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},s.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},s.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},s.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},s.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},s.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},s.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},s.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},s.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},s.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},s.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},s.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},s.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},s.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},s.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},s.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},s.prototype.OPTION=function(e){return this.optionInternal(e,0)},s.prototype.OPTION1=function(e){return this.optionInternal(e,1)},s.prototype.OPTION2=function(e){return this.optionInternal(e,2)},s.prototype.OPTION3=function(e){return this.optionInternal(e,3)},s.prototype.OPTION4=function(e){return this.optionInternal(e,4)},s.prototype.OPTION5=function(e){return this.optionInternal(e,5)},s.prototype.OPTION6=function(e){return this.optionInternal(e,6)},s.prototype.OPTION7=function(e){return this.optionInternal(e,7)},s.prototype.OPTION8=function(e){return this.optionInternal(e,8)},s.prototype.OPTION9=function(e){return this.optionInternal(e,9)},s.prototype.OR=function(e){return this.orInternal(e,0)},s.prototype.OR1=function(e){return this.orInternal(e,1)},s.prototype.OR2=function(e){return this.orInternal(e,2)},s.prototype.OR3=function(e){return this.orInternal(e,3)},s.prototype.OR4=function(e){return this.orInternal(e,4)},s.prototype.OR5=function(e){return this.orInternal(e,5)},s.prototype.OR6=function(e){return this.orInternal(e,6)},s.prototype.OR7=function(e){return this.orInternal(e,7)},s.prototype.OR8=function(e){return this.orInternal(e,8)},s.prototype.OR9=function(e){return this.orInternal(e,9)},s.prototype.MANY=function(e){this.manyInternal(0,e)},s.prototype.MANY1=function(e){this.manyInternal(1,e)},s.prototype.MANY2=function(e){this.manyInternal(2,e)},s.prototype.MANY3=function(e){this.manyInternal(3,e)},s.prototype.MANY4=function(e){this.manyInternal(4,e)},s.prototype.MANY5=function(e){this.manyInternal(5,e)},s.prototype.MANY6=function(e){this.manyInternal(6,e)},s.prototype.MANY7=function(e){this.manyInternal(7,e)},s.prototype.MANY8=function(e){this.manyInternal(8,e)},s.prototype.MANY9=function(e){this.manyInternal(9,e)},s.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},s.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},s.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},s.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},s.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},s.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},s.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},s.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},s.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},s.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},s.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},s.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},s.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},s.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},s.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},s.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},s.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},s.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},s.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},s.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},s.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},s.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},s.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},s.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},s.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},s.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},s.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},s.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},s.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},s.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},s.prototype.RULE=function(e,t,r){if(r===void 0&&(r=Ws),ye(this.definedRulesNames,e)){var n=Ua.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),i={message:n,type:we.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(i)}this.definedRulesNames.push(e);var a=this.defineRule(e,t,r);return this[e]=a,a},s.prototype.OVERRIDE_RULE=function(e,t,r){r===void 0&&(r=Ws);var n=[];n=n.concat($m(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,n);var i=this.defineRule(e,t,r);return this[e]=i,i},s.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return e.apply(this,t),!0}catch(n){if(Bs(n))return!1;throw n}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},s.prototype.getGAstProductions=function(){return this.gastProductionsCache},s.prototype.getSerializedGastProductions=function(){return im(De(this.gastProductionsCache))},s}(),yg=function(){function s(){}return s.prototype.initRecognizerEngine=function(e,t){if(this.className=cg(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=Ps,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},U(t,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(Ot(e)){if(te(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(Ot(e))this.tokensMap=be(e,function(a,o){return a[o.name]=o,a},{});else if(U(e,"modes")&&dt(je(De(e.modes)),tm)){var r=je(De(e.modes)),n=ya(r);this.tokensMap=be(n,function(a,o){return a[o.name]=o,a},{})}else if(Ca(e))this.tokensMap=$n(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=Lr;var i=dt(De(e),function(a){return te(a.categoryMatches)});this.tokenMatcher=i?Ps:li,jn(De(this.tokensMap))},s.prototype.defineRule=function(e,t,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+`> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);var n=U(r,"resyncEnabled")?r.resyncEnabled:Ws.resyncEnabled,i=U(r,"recoveryValueFunc")?r.recoveryValueFunc:Ws.recoveryValueFunc,a=this.ruleShortNameIdx<<Rm+mr;this.ruleShortNameIdx++,this.shortRuleNameToFull[a]=e,this.fullRuleNameToShort[e]=a;function o(c){try{if(this.outputCst===!0){t.apply(this,c);var d=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(d),d}else return t.apply(this,c)}catch(f){return this.invokeRuleCatch(f,n,i)}finally{this.ruleFinallyStateUpdate()}}var u;u=function(c,d){return c===void 0&&(c=0),this.ruleInvocationStateUpdate(a,e,c),o.call(this,d)};var l="ruleName";return u[l]=e,u.originalGrammarAction=t,u},s.prototype.invokeRuleCatch=function(e,t,r){var n=this.RULE_STACK.length===1,i=t&&!this.isBackTracking()&&this.recoveryEnabled;if(Bs(e)){var a=e;if(i){var o=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(o))if(a.resyncedTokens=this.reSyncTo(o),this.outputCst){var u=this.CST_STACK[this.CST_STACK.length-1];return u.recoveredNode=!0,u}else return r();else{if(this.outputCst){var u=this.CST_STACK[this.CST_STACK.length-1];u.recoveredNode=!0,a.partialCstResult=u}throw a}}else{if(n)return this.moveToTerminatedState(),r();throw a}}else throw e},s.prototype.optionInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Ds,t),n=this.nestedRuleBeforeClause(e,r);try{return this.optionInternalLogic(e,t,r)}finally{n!==void 0&&this.nestedRuleFinallyClause(r,n)}},s.prototype.optionInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(Ds,t);return this.optionInternalLogic(e,t,r)},s.prototype.optionInternalLogic=function(e,t,r){var n=this,i=this.getLaFuncFromCache(r),a,o;if(e.DEF!==void 0){if(a=e.DEF,o=e.GATE,o!==void 0){var u=i;i=function(){return o.call(n)&&u.call(n)}}}else a=e;if(i.call(this)===!0)return a.call(this)},s.prototype.atLeastOneInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(In,e),n=this.nestedRuleBeforeClause(t,r);try{return this.atLeastOneInternalLogic(e,t,r)}finally{n!==void 0&&this.nestedRuleFinallyClause(r,n)}},s.prototype.atLeastOneInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(In,e);this.atLeastOneInternalLogic(e,t,r)},s.prototype.atLeastOneInternalLogic=function(e,t,r){var n=this,i=this.getLaFuncFromCache(r),a,o;if(t.DEF!==void 0){if(a=t.DEF,o=t.GATE,o!==void 0){var u=i;i=function(){return o.call(n)&&u.call(n)}}}else a=t;if(i.call(this)===!0)for(var l=this.doSingleRepetition(a);i.call(this)===!0&&l===!0;)l=this.doSingleRepetition(a);else throw this.raiseEarlyExitException(e,ne.REPETITION_MANDATORY,t.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],i,In,e,Om)},s.prototype.atLeastOneSepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(en,e),n=this.nestedRuleBeforeClause(t,r);try{this.atLeastOneSepFirstInternalLogic(e,t,r)}finally{n!==void 0&&this.nestedRuleFinallyClause(r,n)}},s.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(en,e);this.atLeastOneSepFirstInternalLogic(e,t,r)},s.prototype.atLeastOneSepFirstInternalLogic=function(e,t,r){var n=this,i=t.DEF,a=t.SEP,o=this.getLaFuncFromCache(r);if(o.call(this)===!0){i.call(this);for(var u=function(){return n.tokenMatcher(n.LA(1),a)};this.tokenMatcher(this.LA(1),a)===!0;)this.CONSUME(a),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,a,u,i,Fo],u,en,e,Fo)}else throw this.raiseEarlyExitException(e,ne.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG)},s.prototype.manyInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(vn,e),n=this.nestedRuleBeforeClause(t,r);try{return this.manyInternalLogic(e,t,r)}finally{n!==void 0&&this.nestedRuleFinallyClause(r,n)}},s.prototype.manyInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(vn,e);return this.manyInternalLogic(e,t,r)},s.prototype.manyInternalLogic=function(e,t,r){var n=this,i=this.getLaFuncFromCache(r),a,o;if(t.DEF!==void 0){if(a=t.DEF,o=t.GATE,o!==void 0){var u=i;i=function(){return o.call(n)&&u.call(n)}}}else a=t;for(var l=!0;i.call(this)===!0&&l===!0;)l=this.doSingleRepetition(a);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],i,vn,e,Im,l)},s.prototype.manySepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(On,e),n=this.nestedRuleBeforeClause(t,r);try{this.manySepFirstInternalLogic(e,t,r)}finally{n!==void 0&&this.nestedRuleFinallyClause(r,n)}},s.prototype.manySepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(On,e);this.manySepFirstInternalLogic(e,t,r)},s.prototype.manySepFirstInternalLogic=function(e,t,r){var n=this,i=t.DEF,a=t.SEP,o=this.getLaFuncFromCache(r);if(o.call(this)===!0){i.call(this);for(var u=function(){return n.tokenMatcher(n.LA(1),a)};this.tokenMatcher(this.LA(1),a)===!0;)this.CONSUME(a),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,a,u,i,Lo],u,On,e,Lo)}},s.prototype.repetitionSepSecondInternal=function(e,t,r,n,i){for(;r();)this.CONSUME(t),n.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,n,i],r,en,e,i)},s.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();e.call(this);var r=this.getLexerPosition();return r>t},s.prototype.orInternalNoCst=function(e,t){var r=Ot(e)?e:e.DEF,n=this.getKeyForAutomaticLookahead(an,t),i=this.getLaFuncFromCache(n),a=i.call(this,r);if(a!==void 0){var o=r[a];return o.ALT.call(this)}this.raiseNoAltException(t,e.ERR_MSG)},s.prototype.orInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(an,t),n=this.nestedRuleBeforeClause(e,r);try{var i=Ot(e)?e:e.DEF,a=this.getLaFuncFromCache(r),o=a.call(this,i);if(o!==void 0){var u=i[o],l=this.nestedAltBeforeClause(u,t,an,o);try{return u.ALT.call(this)}finally{l!==void 0&&this.nestedRuleFinallyClause(l.shortName,l.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{n!==void 0&&this.nestedRuleFinallyClause(r,n)}},s.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new Ih(t,e))}},s.prototype.subruleInternal=function(e,t,r){var n;try{var i=r!==void 0?r.ARGS:void 0;return n=e.call(this,t,i),this.cstPostNonTerminal(n,r!==void 0&&r.LABEL!==void 0?r.LABEL:e.ruleName),n}catch(a){this.subruleInternalError(a,r,e.ruleName)}},s.prototype.subruleInternalError=function(e,t,r){throw Bs(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,t!==void 0&&t.LABEL!==void 0?t.LABEL:r),delete e.partialCstResult),e},s.prototype.consumeInternal=function(e,t,r){var n;try{var i=this.LA(1);this.tokenMatcher(i,e)===!0?(this.consumeToken(),n=i):this.consumeInternalError(e,i,r)}catch(a){n=this.consumeInternalRecovery(e,t,a)}return this.cstPostTerminal(r!==void 0&&r.LABEL!==void 0?r.LABEL:e.name,n),n},s.prototype.consumeInternalError=function(e,t,r){var n,i=this.LA(0);throw r!==void 0&&r.ERR_MSG?n=r.ERR_MSG:n=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:i,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new ba(n,t,i))},s.prototype.consumeInternalRecovery=function(e,t,r){if(this.recoveryEnabled&&r.name==="MismatchedTokenException"&&!this.isBackTracking()){var n=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,n)}catch(i){throw i.name===Mh?r:i}}else throw r},s.prototype.saveRecogState=function(){var e=this.errors,t=qe(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},s.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},s.prototype.ruleInvocationStateUpdate=function(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},s.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},s.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},s.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},s.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),Lr)},s.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},s}(),Cg=function(){function s(){}return s.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=ui(e.errorMessageProvider,ze.errorMessageProvider)},s.prototype.SAVE_ERROR=function(e){if(Bs(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:qe(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(s.prototype,"errors",{get:function(){return qe(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),s.prototype.raiseEarlyExitException=function(e,t,r){for(var n=this.getCurrRuleFullName(),i=this.getGAstProductions()[n],a=_a(e,i,t,this.maxLookahead),o=a[0],u=[],l=1;l<=this.maxLookahead;l++)u.push(this.LA(l));var c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:u,previous:this.LA(0),customUserDescription:r,ruleName:n});throw this.SAVE_ERROR(new Oh(c,this.LA(1),this.LA(0)))},s.prototype.raiseNoAltException=function(e,t){for(var r=this.getCurrRuleFullName(),n=this.getGAstProductions()[r],i=wa(e,n,this.maxLookahead),a=[],o=1;o<=this.maxLookahead;o++)a.push(this.LA(o));var u=this.LA(0),l=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:i,actual:a,previous:u,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new vh(l,this.LA(1),u))},s}(),vg=function(){function s(){}return s.prototype.initContentAssist=function(){},s.prototype.computeContentAssist=function(e,t){var r=this.gastProductionsCache[e];if(ft(r))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return ch([r],t,this.tokenMatcher,this.maxLookahead)},s.prototype.getNextPossibleTokenTypes=function(e){var t=pt(e.ruleStack),r=this.getGAstProductions(),n=r[t],i=new vm(n,e).startWalking();return i},s}(),fi={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(fi);var xo=!0,Po=Math.pow(2,mr)-1,Lh=W({name:"RECORDING_PHASE_TOKEN",pattern:Ke.NA});jn([Lh]);var Fh=Oa(Lh,`This IToken indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(Fh);var Ig={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,children:{}},Og=function(){function s(){}return s.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},s.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var t=function(n){var i=n>0?n:"";e["CONSUME"+i]=function(a,o){return this.consumeInternalRecord(a,n,o)},e["SUBRULE"+i]=function(a,o){return this.subruleInternalRecord(a,n,o)},e["OPTION"+i]=function(a){return this.optionInternalRecord(a,n)},e["OR"+i]=function(a){return this.orInternalRecord(a,n)},e["MANY"+i]=function(a){this.manyInternalRecord(n,a)},e["MANY_SEP"+i]=function(a){this.manySepFirstInternalRecord(n,a)},e["AT_LEAST_ONE"+i]=function(a){this.atLeastOneInternalRecord(n,a)},e["AT_LEAST_ONE_SEP"+i]=function(a){this.atLeastOneSepFirstInternalRecord(n,a)}},r=0;r<10;r++)t(r);e.consume=function(n,i,a){return this.consumeInternalRecord(i,n,a)},e.subrule=function(n,i,a){return this.subruleInternalRecord(i,n,a)},e.option=function(n,i){return this.optionInternalRecord(i,n)},e.or=function(n,i){return this.orInternalRecord(i,n)},e.many=function(n,i){this.manyInternalRecord(n,i)},e.atLeastOne=function(n,i){this.atLeastOneInternalRecord(n,i)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD})},s.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var t=0;t<10;t++){var r=t>0?t:"";delete e["CONSUME"+r],delete e["SUBRULE"+r],delete e["OPTION"+r],delete e["OR"+r],delete e["MANY"+r],delete e["MANY_SEP"+r],delete e["AT_LEAST_ONE"+r],delete e["AT_LEAST_ONE_SEP"+r]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})},s.prototype.ACTION_RECORD=function(e){},s.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},s.prototype.LA_RECORD=function(e){return Hs},s.prototype.topLevelRuleRecord=function(e,t){try{var r=new mn({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),t.call(this),this.recordingProdStack.pop(),r}catch(n){if(n.KNOWN_RECORDER_ERROR!==!0)try{n.message=n.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording`}catch{throw n}throw n}},s.prototype.optionInternalRecord=function(e,t){return Tn.call(this,Ue,e,t)},s.prototype.atLeastOneInternalRecord=function(e,t){Tn.call(this,mt,t,e)},s.prototype.atLeastOneSepFirstInternalRecord=function(e,t){Tn.call(this,gt,t,e,xo)},s.prototype.manyInternalRecord=function(e,t){Tn.call(this,Ee,t,e)},s.prototype.manySepFirstInternalRecord=function(e,t){Tn.call(this,at,t,e,xo)},s.prototype.orInternalRecord=function(e,t){return Mg.call(this,e,t)},s.prototype.subruleInternalRecord=function(e,t,r){if(Gs(t),!e||U(e,"ruleName")===!1){var n=new Error("<SUBRULE"+Vo(t)+"> argument is invalid"+(" expecting a Parser method reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw n.KNOWN_RECORDER_ERROR=!0,n}var i=bs(this.recordingProdStack),a=e.ruleName,o=new it({idx:t,nonTerminalName:a,referencedRule:void 0});return i.definition.push(o),this.outputCst?Ig:fi},s.prototype.consumeInternalRecord=function(e,t,r){if(Gs(t),!oh(e)){var n=new Error("<CONSUME"+Vo(t)+"> argument is invalid"+(" expecting a TokenType reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw n.KNOWN_RECORDER_ERROR=!0,n}var i=bs(this.recordingProdStack),a=new oe({idx:t,terminalType:e});return i.definition.push(a),Fh},s}();function Tn(s,e,t,r){r===void 0&&(r=!1),Gs(t);var n=bs(this.recordingProdStack),i=fr(e)?e:e.DEF,a=new s({definition:[],idx:t});return U(e,"NAME")&&(a.name=e.NAME),r&&(a.separator=e.SEP),U(e,"MAX_LOOKAHEAD")&&(a.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(a),i.call(this),n.definition.push(a),this.recordingProdStack.pop(),fi}function Mg(s,e){var t=this;Gs(e);var r=bs(this.recordingProdStack),n=Ot(s)===!1,i=n===!1?s:s.DEF,a=new ot({definition:[],idx:e,ignoreAmbiguities:n&&s.IGNORE_AMBIGUITIES===!0});U(s,"NAME")&&(a.name=s.NAME),U(s,"MAX_LOOKAHEAD")&&(a.maxLookahead=s.MAX_LOOKAHEAD);var o=ju(i,function(u){return fr(u.GATE)});return a.hasPredicates=o,r.definition.push(a),b(i,function(u){var l=new Qe({definition:[]});a.definition.push(l),U(u,"NAME")&&(l.name=u.NAME),U(u,"IGNORE_AMBIGUITIES")?l.ignoreAmbiguities=u.IGNORE_AMBIGUITIES:U(u,"GATE")&&(l.ignoreAmbiguities=!0),t.recordingProdStack.push(l),u.ALT.call(t),t.recordingProdStack.pop()}),fi}function Vo(s){return s===0?"":""+s}function Gs(s){if(s<0||s>Po){var e=new Error("Invalid DSL Method idx value: <"+s+`>
	`+("Idx value must be a none negative value smaller than "+(Po+1)));throw e.KNOWN_RECORDER_ERROR=!0,e}}var wg=function(){function s(){}return s.prototype.initPerformanceTracer=function(e){if(U(e,"traceInitPerf")){var t=e.traceInitPerf,r=typeof t=="number";this.traceInitMaxIdent=r?t:1/0,this.traceInitPerf=r?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=ze.traceInitPerf;this.traceInitIndent=-1},s.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+e+">");var n=Zu(t),i=n.time,a=n.value,o=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&o(r+"<-- <"+e+"> time: "+i+"ms"),this.traceInitIndent--,a}else return t()},s}(),Uh=function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},s(e,t)};return function(e,t){s(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Hs=Oa(Lr,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(Hs);var ze=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:Th,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),Ws=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),we;(function(s){s[s.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",s[s.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",s[s.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",s[s.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",s[s.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",s[s.LEFT_RECURSION=5]="LEFT_RECURSION",s[s.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",s[s.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",s[s.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",s[s.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",s[s.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",s[s.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",s[s.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",s[s.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",s[s.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"})(we||(we={}));function _g(s){return s===void 0&&(s=void 0),function(){return s}}var xa=function(){function s(e,t){t===void 0&&(t=ze),this.ignoredIssues=ze.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var r=this;r.initErrorHandler(t),r.initLexerAdapter(),r.initLooksAhead(t),r.initRecognizerEngine(e,t),r.initRecoverable(t),r.initTreeBuilder(t),r.initContentAssist(),r.initGastRecorder(t),r.initPerformanceTracer(t),U(t,"ignoredIssues")&&t.ignoredIssues!==ze.ignoredIssues&&va(`The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.`),this.ignoredIssues=U(t,"ignoredIssues")?t.ignoredIssues:ze.ignoredIssues,this.skipValidations=U(t,"skipValidations")?t.skipValidations:ze.skipValidations}return s.performSelfAnalysis=function(e){e.performSelfAnalysis()},s.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",function(){var t;e.selfAnalysisDone=!0;var r=e.className;e.TRACE_INIT("toFastProps",function(){Qu(e)}),e.TRACE_INIT("Grammar Recording",function(){try{e.enableRecording(),b(e.definedRulesNames,function(i){var a=e[i],o=a.originalGrammarAction,u=void 0;e.TRACE_INIT(i+" Rule",function(){u=e.topLevelRuleRecord(i,o)}),e.gastProductionsCache[i]=u})}finally{e.disableRecording()}});var n=[];if(e.TRACE_INIT("Grammar Resolving",function(){n=ag({rules:De(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,n)}),e.TRACE_INIT("Grammar Validations",function(){if(te(n)&&e.skipValidations===!1){var i=og({rules:De(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:De(e.tokensMap),ignoredIssues:e.ignoredIssues,errMsgProvider:Ua,grammarName:r});e.definitionErrors.push.apply(e.definitionErrors,i)}}),te(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",function(){var i=gm(De(e.gastProductionsCache));e.resyncFollows=i}),e.TRACE_INIT("ComputeLookaheadFunctions",function(){e.preComputeLookaheadFunctions(De(e.gastProductionsCache))})),e.TRACE_INIT("expandAllNestedRuleNames",function(){var i=ym(De(e.gastProductionsCache),e.fullRuleNameToShort);e.allRuleNames=i.allRuleNames}),!s.DEFER_DEFINITION_ERRORS_HANDLING&&!te(e.definitionErrors))throw t=_(e.definitionErrors,function(i){return i.message}),new Error(`Parser Definition Errors detected:
 `+t.join(`
-------------------------------
`))})},s.DEFER_DEFINITION_ERRORS_HANDLING=!1,s}();gf(xa,[ug,lg,Ng,Sg,yg,Ag,Cg,vg,Og,wg]);(function(s){Uh(e,s);function e(t,r){r===void 0&&(r=ze);var n=this,i=$n(r);return i.outputCst=!0,n=s.call(this,t,i)||this,n}return e})(xa);var Lg=function(s){Uh(e,s);function e(t,r){r===void 0&&(r=ze);var n=this,i=$n(r);return i.outputCst=!1,n=s.call(this,t,i)||this,n}return e}(xa);/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const Do=(s,e)=>({type:s,message:e});var pe;(function(s){s.LexingError="LexingError",s.ParserError="ParsingError",s.StaticOffsetError="StaticOffsetError",s.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",s.RangeOffsetNotAllowed="RangeOffsetNotAllowed",s.InvalidRangeSize="InvalidRangeSize"})(pe||(pe={}));var g;(function(s){s.EMPTY="EMPTY",s.NUMBER="NUMBER",s.STRING="STRING",s.MINUS_UNARY_OP="MINUS_UNARY_OP",s.PLUS_UNARY_OP="PLUS_UNARY_OP",s.PERCENT_OP="PERCENT_OP",s.CONCATENATE_OP="CONCATENATE_OP",s.EQUALS_OP="EQUALS_OP",s.NOT_EQUAL_OP="NOT_EQUAL_OP",s.GREATER_THAN_OP="GREATER_THAN_OP",s.LESS_THAN_OP="LESS_THAN_OP",s.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",s.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",s.PLUS_OP="PLUS_OP",s.MINUS_OP="MINUS_OP",s.TIMES_OP="TIMES_OP",s.DIV_OP="DIV_OP",s.POWER_OP="POWER_OP",s.FUNCTION_CALL="FUNCTION_CALL",s.NAMED_EXPRESSION="NAMED_EXPRESSION",s.PARENTHESIS="PARENTHESES",s.CELL_REFERENCE="CELL_REFERENCE",s.CELL_RANGE="CELL_RANGE",s.COLUMN_RANGE="COLUMN_RANGE",s.ROW_RANGE="ROW_RANGE",s.ERROR="ERROR",s.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",s.ARRAY="ARRAY"})(g||(g={}));var tt;(function(s){s[s.RELATIVE=0]="RELATIVE",s[s.START_ABSOLUTE=1]="START_ABSOLUTE",s[s.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"})(tt||(tt={}));const Fg=s=>({type:g.EMPTY,leadingWhitespace:s?.image}),Ug=(s,e)=>({type:g.NUMBER,value:s,leadingWhitespace:e?.image}),bg=s=>{var e;return{type:g.STRING,value:s.image.slice(1,-1),leadingWhitespace:(e=s.leadingWhitespace)===null||e===void 0?void 0:e.image}},Bo=(s,e)=>({type:g.CELL_REFERENCE,reference:s,leadingWhitespace:e?.image}),ko=(s,e,t,r)=>(Pa(s,e,t),{type:g.CELL_RANGE,start:s,end:e,sheetReferenceType:t,leadingWhitespace:r}),xg=(s,e,t,r)=>(Pa(s,e,t),{type:g.COLUMN_RANGE,start:s,end:e,sheetReferenceType:t,leadingWhitespace:r?.image}),Pg=(s,e,t,r)=>(Pa(s,e,t),{type:g.ROW_RANGE,start:s,end:e,sheetReferenceType:t,leadingWhitespace:r?.image}),Vg=(s,e,t)=>({type:g.CONCATENATE_OP,left:s,right:e,leadingWhitespace:t?.image}),Dg=(s,e,t)=>({type:g.EQUALS_OP,left:s,right:e,leadingWhitespace:t?.image}),Bg=(s,e,t)=>({type:g.NOT_EQUAL_OP,left:s,right:e,leadingWhitespace:t?.image}),kg=(s,e,t)=>({type:g.GREATER_THAN_OP,left:s,right:e,leadingWhitespace:t?.image}),Gg=(s,e,t)=>({type:g.LESS_THAN_OP,left:s,right:e,leadingWhitespace:t?.image}),Hg=(s,e,t)=>({type:g.GREATER_THAN_OR_EQUAL_OP,left:s,right:e,leadingWhitespace:t?.image}),Wg=(s,e,t)=>({type:g.LESS_THAN_OR_EQUAL_OP,left:s,right:e,leadingWhitespace:t?.image}),Yg=(s,e,t)=>({type:g.PLUS_OP,left:s,right:e,leadingWhitespace:t?.image}),zg=(s,e,t)=>({type:g.MINUS_OP,left:s,right:e,leadingWhitespace:t?.image}),$g=(s,e,t)=>({type:g.TIMES_OP,left:s,right:e,leadingWhitespace:t?.image}),Xg=(s,e,t)=>({type:g.DIV_OP,left:s,right:e,leadingWhitespace:t?.image}),Kg=(s,e,t)=>({type:g.POWER_OP,left:s,right:e,leadingWhitespace:t?.image}),jg=(s,e)=>({type:g.MINUS_UNARY_OP,value:s,leadingWhitespace:e?.image}),qg=(s,e)=>({type:g.PLUS_UNARY_OP,value:s,leadingWhitespace:e?.image}),Qg=(s,e)=>({type:g.PERCENT_OP,value:s,leadingWhitespace:e?.image}),Zg=(s,e,t,r,n)=>({type:g.FUNCTION_CALL,procedureName:s,args:e,leadingWhitespace:t?.image,internalWhitespace:r?.image,hyperlink:n}),Go=(s,e,t)=>({type:g.ARRAY,args:s,leadingWhitespace:e?.image,internalWhitespace:t?.image}),Jg=(s,e)=>({type:g.NAMED_EXPRESSION,expressionName:s,leadingWhitespace:e?.image}),eE=(s,e,t)=>({type:g.PARENTHESIS,expression:s,leadingWhitespace:e?.image,internalWhitespace:t?.image}),xt=(s,e)=>({type:g.ERROR,error:s,leadingWhitespace:e?.image}),Wr=(s,e,t)=>({type:g.ERROR_WITH_RAW_INPUT,error:e,rawInput:s,leadingWhitespace:t?.image}),Ki=()=>({type:g.ERROR,error:p.parsingError()});function Pa(s,e,t){if(s.sheet!==void 0&&e.sheet===void 0||s.sheet===void 0&&e.sheet!==void 0)throw new Error("Start address inconsistent with end address");if(s.sheet===void 0&&t!==tt.RELATIVE||s.sheet!==void 0&&t===tt.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function z(s,e){return(e??"")+s}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const bh={[g.PLUS_OP]:"+",[g.MINUS_OP]:"-",[g.TIMES_OP]:"*",[g.DIV_OP]:"/",[g.CONCATENATE_OP]:"&",[g.POWER_OP]:"^",[g.EQUALS_OP]:"=",[g.NOT_EQUAL_OP]:"<>",[g.GREATER_THAN_OP]:">",[g.GREATER_THAN_OR_EQUAL_OP]:">=",[g.LESS_THAN_OP]:"<",[g.LESS_THAN_OR_EQUAL_OP]:"<="};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const tE=(s,e,t,r)=>({ast:s,relativeDependencies:e,hasVolatileFunction:t,hasStructuralChangeFunction:r});class rE{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,t){const r=gi(t,this.functionRegistry),n=tE(t,r,sr(t,this.functionRegistry.isFunctionVolatile),sr(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,n),n}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,t){const r=this.cache.get(e);return r!==void 0?r.ast:(this.set(e,t),t)}}const sr=(s,e)=>{switch(s.type){case g.EMPTY:case g.NUMBER:case g.STRING:case g.ERROR:case g.ERROR_WITH_RAW_INPUT:case g.CELL_REFERENCE:case g.CELL_RANGE:case g.COLUMN_RANGE:case g.ROW_RANGE:case g.NAMED_EXPRESSION:return!1;case g.PERCENT_OP:case g.PLUS_UNARY_OP:case g.MINUS_UNARY_OP:return sr(s.value,e);case g.CONCATENATE_OP:case g.EQUALS_OP:case g.NOT_EQUAL_OP:case g.LESS_THAN_OP:case g.GREATER_THAN_OP:case g.LESS_THAN_OR_EQUAL_OP:case g.GREATER_THAN_OR_EQUAL_OP:case g.MINUS_OP:case g.PLUS_OP:case g.TIMES_OP:case g.DIV_OP:case g.POWER_OP:return sr(s.left,e)||sr(s.right,e);case g.PARENTHESIS:return sr(s.expression,e);case g.FUNCTION_CALL:return e(s.procedureName)?!0:s.args.some(t=>sr(t,e));case g.ARRAY:return s.args.some(t=>t.some(r=>sr(r,e)))}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class R{}R.DistinctSigns="Distinct signs.";R.WrongArgNumber="Wrong number of arguments.";R.EmptyArg="Empty function argument.";R.EmptyArray="Empty array not allowed.";R.ArrayDimensions="Array dimensions are not compatible.";R.NoSpaceForArrayResult="No space for array result.";R.ValueSmall="Value too small.";R.ValueLarge="Value too large.";R.BadCriterion="Incorrect criterion.";R.RangeManySheets="Range spans more than one sheet.";R.CellRangeExpected="Cell range expected.";R.WrongDimension="Wrong range dimension.";R.ScalarExpected="Cell range not allowed.";R.NumberCoercion="Value cannot be coerced to number.";R.NumberExpected="Number argument expected.";R.IntegerExpected="Value needs to be an integer.";R.BadMode="Mode not recognized.";R.DateBounds="Date outside of bounds.";R.OutOfSheet="Resulting reference is out of the sheet.";R.WrongType="Wrong type of argument.";R.NaN="NaN or infinite value encountered.";R.EqualLength="Ranges need to be of equal length.";R.Negative="Value cannot be negative.";R.NotBinary="String does not represent a binary number.";R.NotOctal="String does not represent an octal number.";R.NotHex="String does not represent a hexadecimal number.";R.EndStartPeriod="End period needs to be at least start period.";R.CellRefExpected="Cell reference expected.";R.EmptyRange="Empty range not allowed.";R.BadRef="Address is not correct.";R.NumberRange="Number-only range expected.";R.ValueNotFound="Value not found.";R.ValueBaseLarge="Value in base too large.";R.ValueBaseSmall="Value in base too small.";R.ValueBaseLong="Value in base too long.";R.NegativeLength="Length cannot be negative.";R.PatternNotFound="Pattern not found.";R.OneValue="Needs at least one value.";R.TwoValues="Range needs to contain at least two elements.";R.ThreeValues="Range needs to contain at least three elements.";R.IndexBounds="Index out of bounds.";R.IndexLarge="Index too large.";R.Formula="Expected formula.";R.NegativeCount="Count cannot be negative.";R.ParseError="Parsing error.";R.SheetRef="Sheet does not exist.";R.PeriodLong="Period number cannot exceed life length.";R.InvalidDate="Invalid date.";R.BitshiftLong="Result of bitshift is too long.";R.EmptyString="Empty-string argument not allowed.";R.LengthBounds="Length out of bounds.";R.NegativeTime="Time cannot be negative.";R.NoDefault="No default option.";R.NoConditionMet="None of the conditions were met.";R.Selector="Selector cannot exceed the number of arguments.";R.StartEndDate="Start date needs to be earlier than end date.";R.IncorrectDateTime="String does not represent correct DateTime.";R.CharacterCodeBounds="Character code out of bounds.";R.NonZero="Argument cannot be 0.";R.LessThanOne="Argument cannot be less than 1.";R.WeekendString="Incorrect weekend bitmask string.";R.InvalidRoman="Invalid roman numeral.";R.WrongOrder="Wrong order of values.";R.ComplexNumberExpected="Complex number expected.";R.ShouldBeIorJ="Should be 'i' or 'j'.";R.SizeMismatch="Array dimensions mismatched.";R.FunctionName=s=>`Function name ${s} not recognized.`;R.NamedExpressionName=s=>`Named expression ${s} not recognized.`;R.LicenseKey=s=>`License key is ${s}.`;/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class nE{constructor(){this.POSSIBLE_START_CHARACTERS=[...zu,...sf,Ge,"'","_"],this.cellReferenceRegexp=new RegExp(nf,"y")}match(e,t){this.cellReferenceRegexp.lastIndex=t;const r=this.cellReferenceRegexp.exec(e+"@");return r==null||r[1]==null?null:(r[0]=r[1],r)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class sE{constructor(){this.POSSIBLE_START_CHARACTERS=[...zu,"_"],this.namedExpressionRegexp=new RegExp(Yu,"y"),this.r1c1CellRefRegexp=new RegExp(`^${Wu}$`)}match(e,t){this.namedExpressionRegexp.lastIndex=t;const r=this.namedExpressionRegexp.exec(e);return r==null||r[0]==null||this.r1c1CellRefRegexp.test(r[0])?null:r}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const Pn=W({name:"AdditionOp",pattern:Ke.NA}),ji=W({name:"PlusOp",pattern:/\+/,categories:Pn}),qi=W({name:"MinusOp",pattern:/-/,categories:Pn}),mi=W({name:"MultiplicationOp",pattern:Ke.NA}),xh=W({name:"TimesOp",pattern:/\*/,categories:mi}),Ph=W({name:"DivOp",pattern:/\//,categories:mi}),Qi=W({name:"PowerOp",pattern:/\^/}),Vh=W({name:"PercentOp",pattern:/%/}),gr=W({name:"BooleanOp",pattern:Ke.NA}),Zi=W({name:"EqualsOp",pattern:/=/,categories:gr}),Dh=W({name:"NotEqualOp",pattern:/<>/,categories:gr}),Bh=W({name:"GreaterThanOp",pattern:/>/,categories:gr}),kh=W({name:"LessThanOp",pattern:/</,categories:gr}),Gh=W({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:gr}),Hh=W({name:"LessThanOrEqualOp",pattern:/<=/,categories:gr}),Wh=W({name:"ConcatenateOp",pattern:/&/}),Ji=W({name:"LParen",pattern:/\(/}),ys=W({name:"RParen",pattern:/\)/}),Yh=W({name:"ArrayLParen",pattern:/{/}),zh=W({name:"ArrayRParen",pattern:/}/}),$h=W({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),Xh=W({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),Vn=W({name:"RangeSeparator",pattern:new RegExp(zn)}),Va=W({name:"ColumnRange",pattern:new RegExp(`${oo}${zn}${oo}`)}),Da=W({name:"RowRange",pattern:new RegExp(`${uo}${zn}${uo}`)}),Ba=W({name:"ProcedureName",pattern:new RegExp(`([${si}][${Sa}]*)\\(`)}),wi=new nE,ur=W({name:"CellReference",pattern:wi.match.bind(wi),start_chars_hint:wi.POSSIBLE_START_CHARACTERS,line_breaks:!1}),_i=new sE,Kh=W({name:"NamedExpression",pattern:_i.match.bind(_i),start_chars_hint:_i.POSSIBLE_START_CHARACTERS,line_breaks:!1}),ka=s=>{const e=s.translationPackage.getFunctionTranslation("OFFSET"),t=s.errorMapping,r=s.translationPackage.buildFunctionMapping(),n=new RegExp(s.ignoreWhiteSpace==="standard"?tf:ef),i=W({name:"WhiteSpace",pattern:n}),a=W({name:"ArrayRowSep",pattern:s.arrayRowSeparator}),o=W({name:"ArrayColSep",pattern:s.arrayColumnSeparator}),u=W({name:"NumberLiteral",pattern:new RegExp(`(([${s.decimalSeparator}]\\d+)|(\\d+([${s.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),l=W({name:"OffsetProcedureName",pattern:new RegExp(e,"i")});let c,d;s.functionArgSeparator===s.arrayColumnSeparator?(c=o,d=[]):s.functionArgSeparator===s.arrayRowSeparator?(c=a,d=[]):(c=W({name:"ArgSeparator",pattern:s.functionArgSeparator}),d=[c]);const f=[i,ji,qi,xh,Ph,Qi,Zi,Dh,Vh,Gh,Hh,Bh,kh,Ji,ys,Yh,zh,l,Ba,Vn,...d,Va,Da,u,$h,Xh,Wh,gr,Pn,mi,ur,Kh,a,o];return{ArgSeparator:c,NumberLiteral:u,OffsetProcedureName:l,ArrayRowSeparator:a,ArrayColSeparator:o,WhiteSpace:i,allTokens:f,errorMapping:t,functionMapping:r,decimalSeparator:s.decimalSeparator,maxColumns:s.maxColumns,maxRows:s.maxRows}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class tn extends Lg{constructor(e,t){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",()=>this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:_g(Fg())}])),this.procedureExpression=this.RULE("procedureExpression",()=>{var r;const n=this.CONSUME(Ba),i=n.image.toUpperCase().slice(0,-1),a=(r=this.lexerConfig.functionMapping[i])!==null&&r!==void 0?r:i,o=[];let u=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY(()=>{var c;const d=this.CONSUME(this.lexerConfig.ArgSeparator);u.type===g.EMPTY&&(u.leadingWhitespace=(c=d.leadingWhitespace)===null||c===void 0?void 0:c.image),o.push(u),u=this.SUBRULE2(this.booleanExpressionOrEmpty)}),o.push(u),o.length===1&&o[0].type===g.EMPTY&&(o.length=0);const l=this.CONSUME(ys);return Zg(a,o,n.leadingWhitespace,l.leadingWhitespace)}),this.namedExpressionExpression=this.RULE("namedExpressionExpression",()=>{const r=this.CONSUME(Kh);return Jg(r.image,r.leadingWhitespace)}),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",()=>{const r=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(Ji),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{r.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(ys),this.handleOffsetHeuristic(r)}),this.columnRangeExpression=this.RULE("columnRangeExpression",()=>{const r=this.CONSUME(Va),[n,i]=r.image.split(":"),a=this.ACTION(()=>Ls(this.sheetMapping,n,this.formulaAddress)),o=this.ACTION(()=>Ls(this.sheetMapping,i,this.formulaAddress));if(a===void 0||o===void 0)return xt(new p(m.REF));if(a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return Wr(r.image,new p(m.NAME),r.leadingWhitespace);if(a.sheet===void 0&&o.sheet!==void 0)return this.parsingError(pe.ParserError,"Malformed range expression");const{firstEnd:u,secondEnd:l,sheetRefType:c}=tn.fixSheetIdsForRangeEnds(a,o);return xg(u,l,c,r.leadingWhitespace)}),this.rowRangeExpression=this.RULE("rowRangeExpression",()=>{const r=this.CONSUME(Da),[n,i]=r.image.split(":"),a=this.ACTION(()=>Fs(this.sheetMapping,n,this.formulaAddress)),o=this.ACTION(()=>Fs(this.sheetMapping,i,this.formulaAddress));if(a===void 0||o===void 0)return xt(new p(m.REF));if(a.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||o.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return Wr(r.image,new p(m.NAME),r.leadingWhitespace);if(a.sheet===void 0&&o.sheet!==void 0)return this.parsingError(pe.ParserError,"Malformed range expression");const{firstEnd:u,secondEnd:l,sheetRefType:c}=tn.fixSheetIdsForRangeEnds(a,o);return Pg(u,l,c,r.leadingWhitespace)}),this.cellReference=this.RULE("cellReference",()=>{const r=this.CONSUME(ur),n=this.ACTION(()=>Xr(this.sheetMapping,r.image,this.formulaAddress));return n===void 0?Wr(r.image,new p(m.REF),r.leadingWhitespace):n.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?Wr(r.image,new p(m.NAME),r.leadingWhitespace):Bo(n,r.leadingWhitespace)}),this.endRangeReference=this.RULE("endRangeReference",r=>{var n;const i=this.CONSUME(ur),a=this.ACTION(()=>Xr(this.sheetMapping,r.image,this.formulaAddress)),o=this.ACTION(()=>Xr(this.sheetMapping,i.image,this.formulaAddress));return a===void 0||o===void 0?this.ACTION(()=>Wr(`${r.image}:${i.image}`,new p(m.REF),r.leadingWhitespace)):a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION(()=>Wr(`${r.image}:${i.image}`,new p(m.NAME),r.leadingWhitespace)):this.buildCellRange(a,o,(n=r.leadingWhitespace)===null||n===void 0?void 0:n.image)}),this.endOfRangeExpression=this.RULE("endOfRangeExpression",r=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[r]})},{ALT:()=>{var n;const i=this.SUBRULE(this.offsetProcedureExpression),a=this.ACTION(()=>Xr(this.sheetMapping,r.image,this.formulaAddress));return a===void 0?xt(new p(m.REF)):i.type===g.CELL_REFERENCE?this.buildCellRange(a,i.reference,(n=r.leadingWhitespace)===null||n===void 0?void 0:n.image):this.parsingError(pe.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.cellRangeExpression=this.RULE("cellRangeExpression",()=>{const r=this.CONSUME(ur);return this.CONSUME2(Vn),this.SUBRULE(this.endOfRangeExpression,{ARGS:[r]})}),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",r=>{const n=this.CONSUME(ur),i=this.ACTION(()=>Xr(this.sheetMapping,n.image,this.formulaAddress));return i===void 0?this.ACTION(()=>xt(new p(m.REF))):this.buildCellRange(r.reference,i,r.leadingWhitespace)}),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",r=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[r]})},{ALT:()=>{const n=this.SUBRULE(this.offsetProcedureExpression);return n.type===g.CELL_REFERENCE?this.buildCellRange(r.reference,n.reference,r.leadingWhitespace):this.parsingError(pe.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.offsetExpression=this.RULE("offsetExpression",()=>{const r=this.SUBRULE(this.offsetProcedureExpression);let n;return this.OPTION(()=>{this.CONSUME(Vn),r.type===g.CELL_RANGE?n=this.parsingError(pe.RangeOffsetNotAllowed,"Range offset not allowed here"):n=this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[r]})}),n!==void 0?n:r}),this.insideArrayExpression=this.RULE("insideArrayExpression",()=>{const r=[[]];return r[r.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY(()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),r[r.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),r.push([]),r[r.length-1].push(this.SUBRULE3(this.booleanExpression))}}])}),Go(r)}),this.parenthesisExpression=this.RULE("parenthesisExpression",()=>{const r=this.CONSUME(Ji),n=this.SUBRULE(this.booleanExpression),i=this.CONSUME(ys);return eE(n,r.leadingWhitespace,i.leadingWhitespace)}),this.arrayExpression=this.RULE("arrayExpression",()=>this.OR([{ALT:()=>{const r=this.CONSUME(Yh),n=this.SUBRULE(this.insideArrayExpression),i=this.CONSUME(zh);return Go(n.args,r.leadingWhitespace,i.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}])),this.numericStringToNumber=r=>{const n=r.replace(this.lexerConfig.decimalSeparator,".");return Number(n)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",()=>{var r;return this.OR((r=this.atomicExpCache)!==null&&r!==void 0?r:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{const n=this.CONSUME(this.lexerConfig.NumberLiteral);return Ug(this.numericStringToNumber(n.image),n.leadingWhitespace)}},{ALT:()=>{const n=this.CONSUME($h);return bg(n)}},{ALT:()=>{const n=this.CONSUME(Xh),i=n.image.toUpperCase(),a=this.lexerConfig.errorMapping[i];return a?xt(new p(a),n.leadingWhitespace):this.parsingError(pe.ParserError,"Unknown error literal")}}])}),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",()=>{const r=this.SUBRULE(this.positiveAtomicExpression),n=this.OPTION(()=>this.CONSUME(Vh));return n?Qg(r,n.leadingWhitespace):r}),this.atomicExpression=this.RULE("atomicExpression",()=>this.OR([{ALT:()=>{const r=this.CONSUME(Pn),n=this.SUBRULE(this.atomicExpression);return Z(r,ji)?qg(n,r.leadingWhitespace):Z(r,qi)?jg(n,r.leadingWhitespace):(this.customParsingError=Do(pe.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}])),this.powerExpression=this.RULE("powerExpression",()=>{let r=this.SUBRULE(this.atomicExpression);return this.MANY(()=>{const n=this.CONSUME(Qi),i=this.SUBRULE2(this.atomicExpression);Z(n,Qi)?r=Kg(r,i,n.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.multiplicationExpression=this.RULE("multiplicationExpression",()=>{let r=this.SUBRULE(this.powerExpression);return this.MANY(()=>{const n=this.CONSUME(mi),i=this.SUBRULE2(this.powerExpression);Z(n,xh)?r=$g(r,i,n.leadingWhitespace):Z(n,Ph)?r=Xg(r,i,n.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.additionExpression=this.RULE("additionExpression",()=>{let r=this.SUBRULE(this.multiplicationExpression);return this.MANY(()=>{const n=this.CONSUME(Pn),i=this.SUBRULE2(this.multiplicationExpression);Z(n,ji)?r=Yg(r,i,n.leadingWhitespace):Z(n,qi)?r=zg(r,i,n.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.concatenateExpression=this.RULE("concatenateExpression",()=>{let r=this.SUBRULE(this.additionExpression);return this.MANY(()=>{const n=this.CONSUME(Wh),i=this.SUBRULE2(this.additionExpression);r=Vg(r,i,n.leadingWhitespace)}),r}),this.booleanExpression=this.RULE("booleanExpression",()=>{let r=this.SUBRULE(this.concatenateExpression);return this.MANY(()=>{const n=this.CONSUME(gr),i=this.SUBRULE2(this.concatenateExpression);Z(n,Zi)?r=Dg(r,i,n.leadingWhitespace):Z(n,Dh)?r=Bg(r,i,n.leadingWhitespace):Z(n,Bh)?r=kg(r,i,n.leadingWhitespace):Z(n,kh)?r=Gg(r,i,n.leadingWhitespace):Z(n,Gh)?r=Hg(r,i,n.leadingWhitespace):Z(n,Hh)?r=Wg(r,i,n.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.formula=this.RULE("formula",()=>(this.CONSUME(Zi),this.SUBRULE(this.booleanExpression))),this.lexerConfig=e,this.sheetMapping=t,this.formulaAddress=O(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,t){this.input=e;let r=this.formulaWithContext(t),n=[];return this.customParsingError&&n.push(this.customParsingError),n=n.concat(this.errors.map(i=>({type:pe.ParserError,message:i.message}))),n.length>0&&(r=Ki()),{ast:r,errors:n}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,t,r){if(e.sheet===void 0&&t.sheet!==void 0)return this.parsingError(pe.ParserError,"Malformed range expression");const{firstEnd:n,secondEnd:i,sheetRefType:a}=tn.fixSheetIdsForRangeEnds(e,t);return ko(n,i,a,r)}static fixSheetIdsForRangeEnds(e,t){const r=tn.rangeSheetReferenceType(e.sheet,t.sheet),n=e.sheet!==void 0&&t.sheet===void 0?t.withSheet(e.sheet):t;return{firstEnd:e,secondEnd:n,sheetRefType:r}}handleOffsetHeuristic(e){var t;const r=e[0];if(r.type!==g.CELL_REFERENCE)return this.parsingError(pe.StaticOffsetError,"First argument to OFFSET is not a reference");const n=e[1];let i;if(n.type===g.NUMBER&&Number.isInteger(n.value))i=n.value;else if(n.type===g.PLUS_UNARY_OP&&n.value.type===g.NUMBER&&Number.isInteger(n.value.value))i=n.value.value;else if(n.type===g.MINUS_UNARY_OP&&n.value.type===g.NUMBER&&Number.isInteger(n.value.value))i=-n.value.value;else return this.parsingError(pe.StaticOffsetError,"Second argument to OFFSET is not a static number");const a=e[2];let o;if(a.type===g.NUMBER&&Number.isInteger(a.value))o=a.value;else if(a.type===g.PLUS_UNARY_OP&&a.value.type===g.NUMBER&&Number.isInteger(a.value.value))o=a.value.value;else if(a.type===g.MINUS_UNARY_OP&&a.value.type===g.NUMBER&&Number.isInteger(a.value.value))o=-a.value.value;else return this.parsingError(pe.StaticOffsetError,"Third argument to OFFSET is not a static number");const u=e[3];let l;if(u===void 0)l=1;else if(u.type===g.NUMBER){if(l=u.value,l<1)return this.parsingError(pe.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(l))return this.parsingError(pe.StaticOffsetError,"Fourth argument to OFFSET is not integer")}else return this.parsingError(pe.StaticOffsetError,"Fourth argument to OFFSET is not a static number");const c=e[4];let d;if(c===void 0)d=1;else if(c.type===g.NUMBER){if(d=c.value,d<1)return this.parsingError(pe.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(d))return this.parsingError(pe.StaticOffsetError,"Fifth argument to OFFSET is not integer")}else return this.parsingError(pe.StaticOffsetError,"Fifth argument to OFFSET is not a static number");const f=new ee(r.reference.col+o,r.reference.row+i,r.reference.type,(t=r.reference.sheet)!==null&&t!==void 0?t:void 0);let T=f.col,N=f.row;if((r.reference.type===Q.CELL_REFERENCE_RELATIVE||r.reference.type===Q.CELL_REFERENCE_ABSOLUTE_COL)&&(N=N+this.formulaAddress.row),(r.reference.type===Q.CELL_REFERENCE_RELATIVE||r.reference.type===Q.CELL_REFERENCE_ABSOLUTE_ROW)&&(T=T+this.formulaAddress.col),T<0||N<0)return xt(new p(m.REF,R.OutOfSheet));if(d===1&&l===1)return Bo(f);{const E=new ee(f.col+d-1,f.row+l-1,f.type,f.sheet),S=r.reference.sheet==null?tt.RELATIVE:tt.BOTH_ABSOLUTE;return ko(f,E,S)}}parsingError(e,t){return this.customParsingError=Do(e,t),Ki()}static rangeSheetReferenceType(e,t){return e===void 0?tt.RELATIVE:t===void 0?tt.START_ABSOLUTE:tt.BOTH_ABSOLUTE}}class Ys{constructor(e){this.lexerConfig=e,this.lexer=new Ke(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){const t=this.lexer.tokenize(e);let r=t.tokens;return r=this.trimTrailingWhitespaces(r),r=this.skipWhitespacesInsideRanges(r),r=this.skipWhitespacesBeforeArgSeparators(r),t.tokens=r,t}skipWhitespacesInsideRanges(e){return Ys.filterTokensByNeighbors(e,(t,r,n)=>(Z(t,ur)||Z(t,Vn))&&Z(r,this.lexerConfig.WhiteSpace)&&(Z(n,ur)||Z(n,Vn)))}skipWhitespacesBeforeArgSeparators(e){return Ys.filterTokensByNeighbors(e,(t,r,n)=>!Z(t,this.lexerConfig.ArgSeparator)&&Z(r,this.lexerConfig.WhiteSpace)&&Z(n,this.lexerConfig.ArgSeparator))}static filterTokensByNeighbors(e,t){if(e.length<3)return e;let r=0;const n=[e[r++]];for(;r<e.length-1;)t(e[r-1],e[r],e[r+1])||n.push(e[r]),++r;return n.push(e[r]),n}trimTrailingWhitespaces(e){return e.length>0&&Z(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class jh{constructor(e,t,r,n){this.config=e,this.lexerConfig=t,this.sheetMappingFn=r,this.namedExpressions=n}unparse(e,t){return"="+this.unparseAst(e,t)}unparseAst(e,t){var r,n;switch(e.type){case g.EMPTY:return z("",e.leadingWhitespace);case g.NUMBER:return z(qh(e.value,this.config.decimalSeparator),e.leadingWhitespace);case g.STRING:return z('"'+e.value+'"',e.leadingWhitespace);case g.FUNCTION_CALL:{const i=e.args.map(u=>u!==void 0?this.unparseAst(u,t):"").join(this.config.functionArgSeparator),o=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+i+z(")",e.internalWhitespace);return z(o,e.leadingWhitespace)}case g.NAMED_EXPRESSION:{const i=(r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))===null||r===void 0?void 0:r.displayName;return z(i||e.expressionName,e.leadingWhitespace)}case g.CELL_REFERENCE:{let i;return e.reference.sheet!==void 0?i=this.unparseSheetName(e.reference.sheet)+"!":i="",i+=(n=e.reference.unparse(t))!==null&&n!==void 0?n:this.config.translationPackage.getErrorTranslation(m.REF),z(i,e.leadingWhitespace)}case g.COLUMN_RANGE:case g.ROW_RANGE:case g.CELL_RANGE:return z(this.formatRange(e,t),e.leadingWhitespace);case g.PLUS_UNARY_OP:{const i=this.unparseAst(e.value,t);return z("+",e.leadingWhitespace)+i}case g.MINUS_UNARY_OP:{const i=this.unparseAst(e.value,t);return z("-",e.leadingWhitespace)+i}case g.PERCENT_OP:return this.unparseAst(e.value,t)+z("%",e.leadingWhitespace);case g.ERROR:{const i=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:m.ERROR);return z(i,e.leadingWhitespace)}case g.ERROR_WITH_RAW_INPUT:return z(e.rawInput,e.leadingWhitespace);case g.PARENTHESIS:{const a="("+this.unparseAst(e.expression,t)+z(")",e.internalWhitespace);return z(a,e.leadingWhitespace)}case g.ARRAY:{const i="{"+e.args.map(a=>a.map(o=>this.unparseAst(o,t)).join(this.config.arrayColumnSeparator)).join(this.config.arrayRowSeparator)+z("}",e.internalWhitespace);return z(i,e.leadingWhitespace)}default:{const i=this.unparseAst(e.left,t),a=this.unparseAst(e.right,t);return i+z(bh[e.type],e.leadingWhitespace)+a}}}unparseSheetName(e){const t=Xu(e,this.sheetMappingFn);if(t===void 0)throw new ae(e);return t}formatRange(e,t){let r="",n="";e.start.sheet!==void 0&&e.sheetReferenceType!==tt.RELATIVE&&(r=this.unparseSheetName(e.start.sheet)+"!"),e.end.sheet!==void 0&&e.sheetReferenceType===tt.BOTH_ABSOLUTE&&(n=this.unparseSheetName(e.end.sheet)+"!");const i=e.start.unparse(t),a=e.end.unparse(t);return i===void 0||a===void 0?this.config.translationPackage.getErrorTranslation(m.REF):`${r}${i}:${n}${a}`}}function qh(s,e){return s.toString().replace(".",e)}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class wn{constructor(e,t,r){this.config=e,this.functionRegistry=t,this.sheetMapping=r,this.statsCacheUsed=0,this.lexerConfig=ka(e),this.lexer=new Ys(this.lexerConfig),this.formulaParser=new tn(this.lexerConfig,this.sheetMapping),this.cache=new rE(this.functionRegistry)}parse(e,t){this.formulaAddress=t;const r=this.tokenizeFormula(e);if(r.errors.length>0){const d=r.errors.map(f=>({type:pe.LexingError,message:f.message}));return{ast:Ki(),errors:d,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}const n=this.computeHashFromTokens(r.tokens,t);let i=this.cache.get(n);if(i!==void 0)++this.statsCacheUsed;else{const d=this.bindWhitespacesToTokens(r.tokens),f=this.formulaParser.parseFromTokens(d,t);if(f.errors.length>0)return Object.assign(Object.assign({},f),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});i=this.cache.set(n,f.ast)}const{ast:a,hasVolatileFunction:o,hasStructuralChangeFunction:u}=i,l=this.convertReversedRangesToRegularRanges(a),c=gi(l,this.functionRegistry);return{ast:l,errors:[],hasVolatileFunction:o,hasStructuralChangeFunction:u,dependencies:c}}convertReversedRangesToRegularRanges(e){switch(e.type){case g.EMPTY:case g.NUMBER:case g.STRING:case g.ERROR:case g.ERROR_WITH_RAW_INPUT:case g.CELL_REFERENCE:case g.NAMED_EXPRESSION:return e;case g.CELL_RANGE:{const{start:t,end:r}=e,n=this.orderCellRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:n.start,end:n.end})}case g.COLUMN_RANGE:{const{start:t,end:r}=e,n=this.orderColumnRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:n.start,end:n.end})}case g.ROW_RANGE:{const{start:t,end:r}=e,n=this.orderRowRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:n.start,end:n.end})}case g.PERCENT_OP:case g.PLUS_UNARY_OP:case g.MINUS_UNARY_OP:{const t=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:t})}case g.CONCATENATE_OP:case g.EQUALS_OP:case g.NOT_EQUAL_OP:case g.LESS_THAN_OP:case g.GREATER_THAN_OP:case g.LESS_THAN_OR_EQUAL_OP:case g.GREATER_THAN_OR_EQUAL_OP:case g.MINUS_OP:case g.PLUS_OP:case g.TIMES_OP:case g.DIV_OP:case g.POWER_OP:{const t=this.convertReversedRangesToRegularRanges(e.left),r=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:t,right:r})}case g.PARENTHESIS:{const t=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:t})}case g.FUNCTION_CALL:{const t=e.args.map(r=>this.convertReversedRangesToRegularRanges(r));return Object.assign(Object.assign({},e),{args:t})}case g.ARRAY:{const t=e.args.map(r=>r.map(n=>this.convertReversedRangesToRegularRanges(n)));return Object.assign(Object.assign({},e),{args:t})}}}orderCellRangeEnds(e,t){const r=[e,t],[n,i]=r.map(c=>c.toColumnAddress()).sort(ke.compareByAbsoluteAddress(this.formulaAddress)),[a,o]=r.map(c=>c.toRowAddress()).sort(Ve.compareByAbsoluteAddress(this.formulaAddress)),[u,l]=r.map(c=>c.sheet).sort(wn.compareSheetIds.bind(this));return{start:ee.fromColAndRow(n,a,u),end:ee.fromColAndRow(i,o,l)}}orderColumnRangeEnds(e,t){const r=[e,t],[n,i]=r.sort(ke.compareByAbsoluteAddress(this.formulaAddress)),[a,o]=r.map(u=>u.sheet).sort(wn.compareSheetIds.bind(this));return{start:new ke(n.type,n.col,a),end:new ke(i.type,i.col,o)}}orderRowRangeEnds(e,t){const r=[e,t],[n,i]=r.sort(Ve.compareByAbsoluteAddress(this.formulaAddress)),[a,o]=r.map(u=>u.sheet).sort(wn.compareSheetIds.bind(this));return{start:new Ve(n.type,n.row,a),end:new Ve(i.type,i.row,o)}}static compareSheetIds(e,t){return e=e??1/0,t=t??1/0,e-t}fetchCachedResultForAst(e){const t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}fetchCachedResult(e){const t=this.cache.get(e);if(t===void 0)throw new Error("There is no AST with such key in the cache");{const{ast:r,hasVolatileFunction:n,hasStructuralChangeFunction:i,relativeDependencies:a}=t;return{ast:r,errors:[],hasVolatileFunction:n,hasStructuralChangeFunction:i,dependencies:a}}}computeHashFromTokens(e,t){var r;let n="",i=0;for(;i<e.length;){const a=e[i];if(Z(a,ur)){const o=Xr(this.sheetMapping,a.image,t);o===void 0?n=n.concat(a.image):n=n.concat(o.hash(!0))}else if(Z(a,Ba)){const o=a.image.toUpperCase().slice(0,-1),u=(r=this.lexerConfig.functionMapping[o])!==null&&r!==void 0?r:o;n=n.concat(u,"(")}else if(Z(a,Va)){const[o,u]=a.image.split(":"),l=Ls(this.sheetMapping,o,t),c=Ls(this.sheetMapping,u,t);l===void 0||c===void 0?n=n.concat("!REF"):n=n.concat(l.hash(!0),":",c.hash(!0))}else if(Z(a,Da)){const[o,u]=a.image.split(":"),l=Fs(this.sheetMapping,o,t),c=Fs(this.sheetMapping,u,t);l===void 0||c===void 0?n=n.concat("!REF"):n=n.concat(l.hash(!0),":",c.hash(!0))}else n=n.concat(a.image);i++}return n}rememberNewAst(e){const t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case g.EMPTY:return e.leadingWhitespace||"";case g.NUMBER:return z(qh(e.value,this.config.decimalSeparator),e.leadingWhitespace);case g.STRING:return z('"'+e.value+'"',e.leadingWhitespace);case g.NAMED_EXPRESSION:return z(e.expressionName,e.leadingWhitespace);case g.FUNCTION_CALL:{const t=e.args.map(n=>this.computeHashOfAstNode(n)).join(this.config.functionArgSeparator),r=e.procedureName+"("+t+z(")",e.internalWhitespace);return z(r,e.leadingWhitespace)}case g.CELL_REFERENCE:return z(e.reference.hash(!0),e.leadingWhitespace);case g.COLUMN_RANGE:case g.ROW_RANGE:case g.CELL_RANGE:{const t=e.start.hash(e.sheetReferenceType!==tt.RELATIVE),r=e.end.hash(e.sheetReferenceType===tt.BOTH_ABSOLUTE);return z(t+":"+r,e.leadingWhitespace)}case g.MINUS_UNARY_OP:return z("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case g.PLUS_UNARY_OP:return z("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case g.PERCENT_OP:return this.computeHashOfAstNode(e.value)+z("%",e.leadingWhitespace);case g.ERROR:{const t=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:m.ERROR);return z(t,e.leadingWhitespace)}case g.ERROR_WITH_RAW_INPUT:return z(e.rawInput,e.leadingWhitespace);case g.ARRAY:{const t=e.args.map(r=>r.map(n=>this.computeHashOfAstNode(n)).join(",")).join(";");return z("{"+t+z("}",e.internalWhitespace),e.leadingWhitespace)}case g.PARENTHESIS:{const r="("+this.computeHashOfAstNode(e.expression)+z(")",e.internalWhitespace);return z(r,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+z(bh[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){const t=[],r=e[0];Z(r,this.lexerConfig.WhiteSpace)||t.push(r);for(let n=1;n<e.length;++n){const i=e[n];if(Z(i,this.lexerConfig.WhiteSpace))continue;const a=e[n-1];Z(a,this.lexerConfig.WhiteSpace)&&(i.leadingWhitespace=a),t.push(i)}return t}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const Kr=(s,e,t,r)=>{switch(s.type){case g.EMPTY:case g.NUMBER:case g.STRING:case g.ERROR:return;case g.NAMED_EXPRESSION:{r&&t.push(new jt(s.expressionName));return}case g.CELL_REFERENCE:{r&&t.push(new Qh(s.reference));return}case g.CELL_RANGE:{r&&s.start.sheet===s.end.sheet&&t.push(new iE(s.start,s.end));return}case g.COLUMN_RANGE:{r&&s.start.sheet===s.end.sheet&&t.push(new aE(s.start,s.end));return}case g.ROW_RANGE:{r&&s.start.sheet===s.end.sheet&&t.push(new oE(s.start,s.end));return}case g.PERCENT_OP:case g.PLUS_UNARY_OP:case g.MINUS_UNARY_OP:{Kr(s.value,e,t,!0);return}case g.CONCATENATE_OP:case g.EQUALS_OP:case g.NOT_EQUAL_OP:case g.LESS_THAN_OP:case g.GREATER_THAN_OP:case g.LESS_THAN_OR_EQUAL_OP:case g.GREATER_THAN_OR_EQUAL_OP:case g.MINUS_OP:case g.PLUS_OP:case g.TIMES_OP:case g.DIV_OP:case g.POWER_OP:Kr(s.left,e,t,!0),Kr(s.right,e,t,!0);return;case g.PARENTHESIS:Kr(s.expression,e,t,r);return;case g.FUNCTION_CALL:{const n=!e.doesFunctionNeedArgumentToBeComputed(s.procedureName);s.args.forEach(i=>Kr(i,e,t,n));return}}},gi=(s,e)=>{const t=new Array;return Kr(s,e,t,!0),t};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Qh{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class iE{constructor(e,t){this.start=e,this.end=t}absolutize(e){return new F(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class aE{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleColumnAddress(e),r=this.end.toSimpleColumnAddress(e);return new qt(t.sheet,t.col,r.col)}}class oE{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleRowAddress(e),r=this.end.toSimpleRowAddress(e);return new Qt(t.sheet,t.row,r.row)}}class jt{constructor(e){this.name=e}absolutize(e){return this}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const Pt=(s,e)=>s.map(t=>t.absolutize(e)),uE=s=>s.filter(e=>e instanceof jt?!0:e instanceof F?!($e(e.start)||$e(e.end)):!$e(e));/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const B=Symbol("Empty value");function I(s){return s instanceof Wt?s.val:s}class Wt{constructor(e,t){this.val=e,this.format=t}fromNumber(e){return new this.constructor(e)}}function Ga(s,e){if(typeof s=="number")return e;{const t=s.fromNumber(e);return t.format=s.format,t}}class Ha extends Wt{getDetailedType(){return L.NUMBER_DATE}}class ea extends Wt{getDetailedType(){return L.NUMBER_CURRENCY}}class Wa extends Wt{getDetailedType(){return L.NUMBER_TIME}}class Ya extends Wt{getDetailedType(){return L.NUMBER_DATETIME}}class Cs extends Wt{getDetailedType(){return L.NUMBER_PERCENT}}function X(s){return typeof s=="number"||s instanceof Wt}var L;(function(s){s.NUMBER_RAW="NUMBER_RAW",s.NUMBER_DATE="NUMBER_DATE",s.NUMBER_TIME="NUMBER_TIME",s.NUMBER_DATETIME="NUMBER_DATETIME",s.NUMBER_CURRENCY="NUMBER_CURRENCY",s.NUMBER_PERCENT="NUMBER_PERCENT"})(L||(L={}));function hE(s){return s instanceof Wt?s.getDetailedType():L.NUMBER_RAW}function lE(s){if(s instanceof Wt)return s.format}function zs(s){return s instanceof Wt?{type:s.getDetailedType(),format:s.format}:{type:L.NUMBER_RAW}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class w{constructor(e,t,r,n){this._data=e,this.range=t,this.dependencyGraph=r,this._hasOnlyNumbers=n,this.size=e===void 0?new V(t.effectiveWidth(r),t.effectiveHeight(r)):new V(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,t,r){return new w(e,t,r,!0)}static onlyNumbers(e){return new w(e,void 0,void 0,!0)}static onlyValues(e){return new w(e,void 0,void 0,void 0)}static onlyRange(e,t){return new w(void 0,e,t,void 0)}static fromScalar(e){return new w([[e]],void 0,void 0,void 0)}isAdHoc(){return this.range===void 0}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();const e=[];for(let t=0;t<this._data.length;t++)for(let r=0;r<this._data[0].length;r++)e.push(this._data[t][r]);return e}*effectiveAddressesFromData(e){for(let t=0;t<this.data.length;++t){const r=this.data[t];for(let n=0;n<r.length;++n)yield O(e.sheet,e.col+n,e.row+t)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let t=0;t<this.size.height;++t)for(let r=0;r<this.size.width;++r)yield[this._data[t][r],O(e.sheet,e.col+r,e.row+t)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(this._hasOnlyNumbers===void 0){this._hasOnlyNumbers=!0;for(const e of this.data)for(const t of e)if(typeof t!="number")return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),(e=this._data)!==null&&e!==void 0?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){this._data===void 0&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,e=>{const t=this.dependencyGraph.getCellValue(e);return t instanceof w?(this._hasOnlyNumbers=!1,new p(m.VALUE,R.ScalarExpected)):(X(t)||(this._hasOnlyNumbers=!1),t)}))}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class lr{constructor(){this.changes=new Map}static empty(){return new lr}addAll(e){for(const t of e.changes.values())this.add(t.address,t);return this}addChange(e,t,r){this.addInterpreterValue(e,t,r)}exportChanges(e){let t=[];return this.changes.forEach(r=>{const n=e.exportChange(r);Array.isArray(n)?t=t.concat(n):t.push(n)}),t}getChanges(){return Array.from(this.changes.values())}isEmpty(){return this.changes.size===0}add(e,t){const r=t.value;if(r instanceof w)for(const n of r.effectiveAddressesFromData(e))this.changes.delete(_n(n));this.changes.set(_n(e),t)}addInterpreterValue(e,t,r){this.add(t,{address:t,value:e,oldValue:r})}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Xe{constructor(e,t,r){if(this.sheet=e,this.rowStart=t,this.rowEnd=r,t<0)throw Error("Starting row cant be less than 0");if(r<t)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,t,r){return new Xe(e,t,t+r-1)}static fromRowStartAndEnd(e,t,r){return new Xe(e,t,r)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.rowStart,e.rowStart),r=Math.min(this.rowEnd,e.rowEnd);return t>r?null:new Xe(this.sheet,t,r)}firstRow(){return new Xe(this.sheet,this.rowStart,this.rowStart)}}class rt{constructor(e,t,r){if(this.sheet=e,this.columnStart=t,this.columnEnd=r,t<0)throw Error("Starting column cant be less than 0");if(r<t)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,t,r){return new rt(e,t,t+r-1)}static fromColumnStartAndEnd(e,t,r){return new rt(e,t,r)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.columnStart,e.columnStart),r=Math.min(this.columnEnd,e.columnEnd);return t>r?null:new rt(this.sheet,t,r)}firstColumn(){return new rt(this.sheet,this.columnStart,this.columnStart)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var x;(function(s){s.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",s.PARSER="PARSER",s.GRAPH_BUILD="GRAPH_BUILD",s.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",s.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",s.TOP_SORT="TOP_SORT",s.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",s.EVALUATION="EVALUATION",s.VLOOKUP="VLOOKUP",s.TRANSFORM_ASTS="TRANSFORM_ASTS",s.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",s.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",s.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",s.ADJUSTING_RANGES="ADJUSTING_RANGES",s.ADJUSTING_GRAPH="ADJUSTING_GRAPH",s.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",s.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"})(x||(x={}));/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Zh{constructor(){this.stats=new Map([[x.CRITERION_FUNCTION_FULL_CACHE_USED,0],[x.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;const t=((e=this.stats.get(x.CRITERION_FUNCTION_FULL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(x.CRITERION_FUNCTION_FULL_CACHE_USED,t)}incrementCriterionFunctionPartialCacheUsed(){var e;const t=((e=this.stats.get(x.CRITERION_FUNCTION_PARTIAL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(x.CRITERION_FUNCTION_PARTIAL_CACHE_USED,t)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(x.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(x.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var t;const r=Date.now(),n=this.startTimes.get(e);if(n){let i=(t=this.stats.get(e))!==null&&t!==void 0?t:0;i+=r-n,this.stats.set(e,i),this.startTimes.delete(e)}else throw Error(`Statistics ${e} not started`)}measure(e,t){this.start(e);const r=t();return this.end(e),r}snapshot(){return new Map(this.stats)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class cE extends Zh{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ae extends Error{constructor(e){super(`There's no sheet with id = ${e}`)}}class Jh extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class Dn extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class Mr extends Error{constructor(){super("Sheet size limit exceeded")}}class vs extends Error{constructor(){super("This is not a formula")}}class el extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class Te extends Error{constructor(e){super(`Invalid arguments, expected ${e}`)}}class Bn extends Error{constructor(e,t){super(`Sheets ${e} and ${t} are not equal.`)}}class tl extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class rl extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class kn extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class nl extends Error{constructor(){super("There is no operation to undo")}}class sl extends Error{constructor(){super("There is no operation to redo")}}class il extends Error{constructor(){super("There is nothing to paste")}}function dE(s,e){switch(typeof e){case"function":case"symbol":return e.toString();case"bigint":return"BigInt("+e.toString()+")";default:return e instanceof RegExp?"RegExp("+e.toString()+")":e}}class al extends Error{constructor(e){super(`Unable to parse value: ${JSON.stringify(e,dE,4)}`)}}class $ extends Error{constructor(e,t){super(`Expected value of type: ${e} for config parameter: ${t}`)}}class pE extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class ol extends Error{constructor(e,t){super(`Config parameter ${e} should be at least ${t}`)}}class ul extends Error{constructor(e,t){super(`Config parameter ${e} should be at most ${t}`)}}class hl extends Error{constructor(e,t){super(`Expected one of ${e} for config parameter: ${t}`)}}class ll extends Error{constructor(){super("Computations are suspended")}}class jr extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class cl extends Error{constructor(e){super(`Cannot register translation for function with id: ${e}`)}}class ta extends Error{constructor(){super("Language not registered.")}}class dl extends Error{constructor(){super("Language already registered.")}}class dn extends Error{static functionNotDeclaredInPlugin(e,t){return new dn(`Function with id ${e} not declared in plugin ${t}`)}static functionMethodNotFound(e,t){return new dn(`Function method ${e} not found in plugin ${t}`)}}class wr extends Error{static cannotRegisterFunctionWithId(e){return new wr(`Cannot register function with id ${e}`)}static cannotUnregisterFunctionWithId(e){return new wr(`Cannot unregister function with id ${e}`)}static cannotUnregisterProtectedPlugin(){return new wr("Cannot unregister protected plugin")}}class rn extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class $s extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class za extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class fE extends Error{constructor(e,t){super(`Alias id ${e} in plugin ${t} already defined as a function or alias.`)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class mE{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new ae(e.sheet);return t.getCell(e)}fetchCell(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new ae(e.sheet);const r=t.getCell(e);if(!r)throw Error("Vertex for address missing in AddressMapping");return r}strategyFor(e){const t=this.mapping.get(e);if(t===void 0)throw new ae(e);return t}addSheet(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}autoAddSheet(e,t){const{height:r,width:n,fill:i}=t,a=this.policy.call(i);this.addSheet(e,new a(n,r))}getCellValue(e){const t=this.getCell(e);return t===void 0?B:t instanceof ge?t.getArrayCellValue(e):t.getCellValue()}getRawValue(e){const t=this.getCell(e);return t instanceof cr?t.getValues().rawValue:t instanceof ge?t.getArrayCellRawValue(e):null}setCell(e,t){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized");r.setCell(e,t)}moveCell(e,t){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized.");if(e.sheet!==t.sheet)throw Error("Cannot move cells between sheets.");if(r.has(t))throw new Error("Cannot move cell. Destination already occupied.");const n=r.getCell(e);if(n===void 0)throw new Error("Cannot move cell. No cell with such address.");this.setCell(t,n),this.removeCell(e)}removeCell(e){const t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}has(e){const t=this.mapping.get(e.sheet);return t===void 0?!1:t.has(e)}getHeight(e){const t=this.mapping.get(e);if(t===void 0)throw new ae(e);return t.getHeight()}getWidth(e){const t=this.mapping.get(e);if(!t)throw new ae(e);return t.getWidth()}addRows(e,t,r){const n=this.mapping.get(e);if(n===void 0)throw new ae(e);n.addRows(t,r)}removeRows(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new ae(e.sheet);t.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,t,r){const n=this.mapping.get(e);if(n===void 0)throw new ae(e);n.addColumns(t,r)}removeColumns(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new ae(e.sheet);t.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(const[e,t]of this.mapping.entries())yield*t.getEntries(e)}*sheetEntries(e){const t=this.mapping.get(e);if(t!==void 0)yield*t.getEntries(e);else throw new ae(e)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class gE{constructor(){this.arrayMapping=new Map}getArray(e){const t=this.getArrayByCorner(e.start);if(t?.getRange().sameAs(e))return t}getArrayByCorner(e){return this.arrayMapping.get(_n(e))}setArray(e,t){this.arrayMapping.set(_n(e.start),t)}removeArray(e){typeof e=="string"?this.arrayMapping.delete(e):this.arrayMapping.delete(_n(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(const[t,r]of this.arrayMapping.entries())r.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[t,r])}*arraysInCols(e){for(const[t,r]of this.arrayMapping.entries())r.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[t,r])}isFormulaArrayInRow(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetRows(e,t))return!0;return!1}isFormulaArrayInAllRows(e){let t=!0;for(const r of e.rows())this.isFormulaArrayInRow(e.sheet,r)||(t=!1);return t}isFormulaArrayInColumn(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetColumn(e,t))return!0;return!1}isFormulaArrayInAllColumns(e){let t=!0;for(const r of e.columns())this.isFormulaArrayInColumn(e.sheet,r)||(t=!1);return t}isFormulaArrayInRange(e){for(const t of this.arrayMapping.values())if(t.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const t of this.arrayMapping.values())if(t.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,t,r){this.updateArrayVerticesInSheet(e,(n,i)=>{const a=i.getRange();return t<=a.start.row?[a.shifted(0,r),i]:void 0})}moveArrayVerticesAfterColumnByColumns(e,t,r){this.updateArrayVerticesInSheet(e,(n,i)=>{const a=i.getRange();return t<=a.start.col?[a.shifted(r,0),i]:void 0})}updateArrayVerticesInSheet(e,t){const r=Array();for(const[n,i]of this.arrayMapping.entries()){if(i.sheet!==e)continue;const a=t(n,i);a!==void 0&&(this.removeArray(n),r.push(a))}r.forEach(([n,i])=>{this.setArray(n,i)})}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class An{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,t){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class pn{constructor(e){if(this.size=new V(e.length>0?e[0].length:0,e.length),this.array=e,this.size.width<=0||this.size.height<=0)throw Error("Incorrect array size")}static fromInterpreterValue(e){return e instanceof w?new pn(e.data):new pn([[e]])}simpleRangeValue(){return w.onlyValues(this.array)}addRows(e,t){this.array.splice(e,0,...this.nullArrays(t,this.width())),this.size.height+=t}addColumns(e,t){for(let r=0;r<this.height();r++)this.array[r].splice(e,0,...new Array(t).fill(B));this.size.width+=t}removeRows(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");const r=t-e+1;this.array.splice(e,r),this.size.height-=r}removeColumns(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");const r=t-e+1;for(const n of this.array)n.splice(e,r);this.size.width-=r}nullArrays(e,t){const r=[];for(let n=0;n<e;++n)r.push(new Array(t).fill(B));return r}get(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}set(e,t,r){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=r}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height||(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width))throw Error("Resizing to smaller array")}outOfBound(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}class Li{constructor(e,t){this.error=e,this.size=t}get(e,t){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class nt{constructor(e,t,r){this.formula=e,this.cellAddress=t,this.version=r}get width(){return 1}get height(){return 1}static fromAst(e,t,r,n){return r.isScalar()?new Vt(e,t,n):new ge(e,t,r,n)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){const[t,r,n]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=t,this.cellAddress=r,this.version=n}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class ge extends nt{constructor(e,t,r,n=0){super(e,t,n),r.isRef?this.array=new Li(new p(m.REF,R.NoSpaceForArrayResult),V.error()):this.array=new An(r)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof p)return this.setErrorValue(e),e;const t=pn.fromInterpreterValue(e);return t.resize(this.array.size),this.array=t,e}getCellValue(){if(this.array instanceof An)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof An))return this.array.simpleRangeValue()}getArrayCellValue(e){const t=e.col-this.cellAddress.col,r=e.row-this.cellAddress.row;try{return this.array.get(t,r)}catch{return new p(m.REF)}}getArrayCellRawValue(e){const t=this.getArrayCellValue(e);if(!(t instanceof p||t===B))return I(t)}setArrayCellValue(e,t){const r=e.col-this.cellAddress.col,n=e.row-this.cellAddress.row;this.array instanceof pn&&this.array.set(r,n,t)}setNoSpace(){return this.array=new Li(new p(m.SPILL,R.NoSpaceForArrayResult),V.error()),this.getCellValue()}getRange(){return F.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return F.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.row<=r&&t<this.cellAddress.row+this.height}spansThroughSheetColumn(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.col<=r&&t<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof An)}columnsFromArray(){return rt.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return Xe.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return Hn(this.cellAddress,e)}setErrorValue(e){this.array=new Li(e,this.array.size)}}class Vt extends nt{constructor(e,t,r){super(e,t,r)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(this.cachedCellValue!==void 0)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return this.cachedCellValue!==void 0}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Pe{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,t){this.functionCache.set(e,t)}getCriterionFunctionValue(e,t){var r;return(r=this.getCriterionFunctionValues(e).get(t))===null||r===void 0?void 0:r[0]}getCriterionFunctionValues(e){var t;return(t=this.criterionFunctionCache.get(e))!==null&&t!==void 0?t:new Map}setCriterionFunctionValues(e,t){this.criterionFunctionCache.set(e,t)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(e=>e.criterionFunctionCache.clear()),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const EE=(s,e,t,r,n)=>{if(e instanceof Pe){const o=e.range.intersectionWith(t);return o!==void 0?Array.from(o.addresses(n)):[]}let i,a;if(e instanceof nt)i=e.getFormula(r),a=e.getAddress(r);else return[];return gi(i,s).filter(o=>o instanceof Qh).map(o=>o.dependency.toSimpleCellAddress(a)).filter(o=>t.addressInRange(o))};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var Xt;(function(s){s[s.ON_STACK=0]="ON_STACK",s[s.PROCESSED=1]="PROCESSED",s[s.POPPED=2]="POPPED"})(Xt||(Xt={}));class RE{constructor(e=[],t=[]){this.nodesSparseArray=e,this.edgesSparseArray=t,this.entranceTime=[],this.low=[],this.parent=[],this.inSCC=[],this.nodeStatus=[],this.order=[],this.sccNonSingletons=[],this.timeCounter=0}getTopSortedWithSccSubgraphFrom(e,t,r){const n=e.reverse();return n.forEach(i=>this.runDFS(i)),this.postprocess(n,r,t)}getAdjacentNodeIds(e){return this.edgesSparseArray[e].filter(t=>t!==void 0&&this.nodesSparseArray[t])}runDFS(e){if(this.nodeStatus[e]!==void 0)return;this.nodeStatus[e]=Xt.ON_STACK;const t=[e],r=[];for(;t.length>0;){const n=t[t.length-1];switch(this.nodeStatus[n]){case Xt.ON_STACK:{this.handleOnStack(n,r,t);break}case Xt.PROCESSED:{this.handleProcessed(n,r,t);break}case Xt.POPPED:{t.pop();break}}}}handleOnStack(e,t,r){this.entranceTime[e]=this.timeCounter,this.low[e]=this.timeCounter,this.timeCounter++,t.push(e),this.getAdjacentNodeIds(e).forEach(n=>{this.entranceTime[n]===void 0&&(r.push(n),this.parent[n]=e,this.nodeStatus[n]=Xt.ON_STACK)}),this.nodeStatus[e]=Xt.PROCESSED}handleProcessed(e,t,r){let n=this.entranceTime[e];if(this.getAdjacentNodeIds(e).forEach(i=>{this.inSCC[i]||(n=this.parent[i]===e?Math.min(n,this.low[i]):Math.min(n,this.entranceTime[i]))}),this.low[e]=n,n===this.entranceTime[e]){const i=[];do i.push(t[t.length-1]),t.pop();while(i[i.length-1]!==e);i.forEach(a=>{this.inSCC[a]=!0}),this.order.push(...i),i.length>1&&i.forEach(a=>{this.sccNonSingletons[a]=!0})}r.pop(),this.nodeStatus[e]=Xt.POPPED}postprocess(e,t,r){const n=[];e.forEach(o=>{n[o]=!0});const i=[],a=[];return this.order.reverse(),this.order.forEach(o=>{const u=this.getAdjacentNodeIds(o);this.sccNonSingletons[o]||u.includes(o)?(a.push(this.nodesSparseArray[o]),t(this.nodesSparseArray[o]),u.forEach(l=>n[l]=!0)):(i.push(this.nodesSparseArray[o]),n[o]&&r(this.nodesSparseArray[o])&&u.forEach(l=>n[l]=!0))}),{sorted:i,cycled:a}}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class TE{constructor(e,t){this.rawValue=e,this.processFn=t,this.processedValue=null}getProcessedValue(){return this.processedValue===null&&(this.processedValue=this.processFn(this.rawValue)),this.processedValue}markAsModified(){this.processedValue=null}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class NE{constructor(e){this.dependencyQuery=e,this.nodesSparseArray=[],this.edgesSparseArray=[],this.nodesIds=new Map,this.dirtyAndVolatileNodeIds=new TE({dirty:[],volatile:[]},t=>this.processDirtyAndVolatileNodeIds(t)),this.infiniteRangeIds=new Set,this.changingWithStructureNodeIds=[],this.nextId=0}getNodes(){return this.nodesSparseArray.filter(e=>e!==void 0)}hasNode(e){return this.nodesIds.has(e)}existsEdge(e,t){const r=this.getNodeId(e),n=this.getNodeId(t);return r===void 0||n===void 0?!1:this.edgesSparseArray[r].includes(n)}adjacentNodes(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return new Set(this.edgesSparseArray[t].filter(r=>r!==void 0).map(r=>this.nodesSparseArray[r]))}adjacentNodesCount(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return this.fixEdgesArrayForNode(t).length}addNodeAndReturnId(e){const t=this.nodesIds.get(e);if(t!==void 0)return t;const r=this.nextId;return this.nextId++,this.nodesSparseArray[r]=e,this.edgesSparseArray[r]=[],this.nodesIds.set(e,r),r}addEdge(e,t){const r=this.getNodeIdIfNotNumber(e),n=this.getNodeIdIfNotNumber(t);if(r===void 0)throw this.missingNodeError(e);if(n===void 0)throw this.missingNodeError(t);this.edgesSparseArray[r].includes(n)||this.edgesSparseArray[r].push(n)}removeNode(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);this.edgesSparseArray[t].length>0&&(this.edgesSparseArray[t].forEach(n=>this.dirtyAndVolatileNodeIds.rawValue.dirty.push(n)),this.dirtyAndVolatileNodeIds.markAsModified());const r=this.removeDependencies(e);return delete this.nodesSparseArray[t],delete this.edgesSparseArray[t],this.infiniteRangeIds.delete(t),this.nodesIds.delete(e),r}removeEdge(e,t){const r=this.getNodeIdIfNotNumber(e),n=this.getNodeIdIfNotNumber(t);if(r===void 0)throw this.missingNodeError(e);if(n===void 0)throw this.missingNodeError(t);const i=this.edgesSparseArray[r].indexOf(n);if(i===-1)throw new Error("Edge does not exist");delete this.edgesSparseArray[r][i]}removeEdgeIfExists(e,t){const r=this.getNodeIdIfNotNumber(e),n=this.getNodeIdIfNotNumber(t);if(r===void 0||n===void 0)return;const i=this.edgesSparseArray[r].indexOf(n);i!==-1&&delete this.edgesSparseArray[r][i]}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(this.getNodes(),()=>!0,()=>{})}getTopSortedWithSccSubgraphFrom(e,t,r){const n=new RE(this.nodesSparseArray,this.edgesSparseArray),i=e.map(a=>this.getNodeId(a)).filter(a=>a!==void 0);return n.getTopSortedWithSccSubgraphFrom(i,t,r)}markNodeAsVolatile(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.volatile.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsDirty(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.dirty.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}getDirtyAndVolatileNodes(){return this.dirtyAndVolatileNodeIds.getProcessedValue()}clearDirtyNodes(){this.dirtyAndVolatileNodeIds.rawValue.dirty=[],this.dirtyAndVolatileNodeIds.markAsModified()}markNodeAsChangingWithStructure(e){const t=this.getNodeId(e);t!==void 0&&this.changingWithStructureNodeIds.push(t)}markChangingWithStructureNodesAsDirty(){this.changingWithStructureNodeIds.length<=0||(this.dirtyAndVolatileNodeIds.rawValue.dirty=[...this.dirtyAndVolatileNodeIds.rawValue.dirty,...this.changingWithStructureNodeIds],this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsInfiniteRange(e){const t=this.getNodeIdIfNotNumber(e);t!==void 0&&this.infiniteRangeIds.add(t)}getInfiniteRanges(){return[...this.infiniteRangeIds].map(e=>({node:this.nodesSparseArray[e],id:e}))}getNodeId(e){return this.nodesIds.get(e)}getNodeIdIfNotNumber(e){return typeof e=="number"?e:this.nodesIds.get(e)}fixEdgesArrayForNode(e){const t=this.edgesSparseArray[e];return this.edgesSparseArray[e]=t.filter(r=>r!==void 0&&this.nodesSparseArray[r]),this.edgesSparseArray[e]}removeDependencies(e){const t=this.dependencyQuery(e);return t.forEach(([r,n])=>{this.removeEdgeIfExists(n,e)}),t}processDirtyAndVolatileNodeIds({dirty:e,volatile:t}){return[...new Set([...e,...t])].map(r=>this.nodesSparseArray[r]).filter(r=>r!==void 0)}missingNodeError(e){return new Error(`Unknown node ${e}`)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class SE{constructor(){this.rangeMapping=new Map}getMappingSize(e){var t,r;return(r=(t=this.rangeMapping.get(e))===null||t===void 0?void 0:t.size)!==null&&r!==void 0?r:0}setRange(e){let t=this.rangeMapping.get(e.getStart().sheet);t===void 0&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));const r=Is(e.getStart(),e.getEnd());t.set(r,e)}removeRange(e){const t=e.getStart().sheet,r=this.rangeMapping.get(t);if(r===void 0)return;const n=Is(e.getStart(),e.getEnd());r.delete(n),r.size===0&&this.rangeMapping.delete(t)}getRange(e,t){const r=this.rangeMapping.get(e.sheet),n=Is(e,t);return r?.get(n)}fetchRange(e,t){const r=this.getRange(e,t);if(!r)throw Error("Range does not exist");return r}truncateRanges(e,t){const r=Array(),n=Array(),i=Array(),a=e.sheet;for(const[u,l]of this.entriesFromSheet(e.sheet)){const c=l.range;e.start<=t(l.range.end)&&(c.removeSpan(e),c.shouldBeRemoved()?(this.removeByKey(a,u),r.push(l)):n.push([u,l]),i.push(l))}const o=[];n.sort((u,l)=>yE(u[1],l[1],t));for(const[u,l]of n){const c=AE(l.range);if(c===u)continue;const d=this.getByKey(a,c);this.removeByKey(a,u),d!==void 0&&l!=d?o.push([d,l]):this.setRange(l)}return{verticesToRemove:r,verticesToMerge:o,verticesWithChangedSize:i}}moveAllRangesInSheetAfterRowByRows(e,t,r){return this.updateVerticesFromSheet(e,(n,i)=>t<=i.start.row?(i.range.shiftByRows(r),{changedSize:!1,vertex:i}):t>i.start.row&&t<=i.end.row?(i.range.expandByRows(r),{changedSize:!0,vertex:i}):void 0)}moveAllRangesInSheetAfterColumnByColumns(e,t,r){return this.updateVerticesFromSheet(e,(n,i)=>t<=i.start.col?(i.range.shiftByColumns(r),{changedSize:!1,vertex:i}):t>i.start.col&&t<=i.end.col?(i.range.expandByColumns(r),{changedSize:!0,vertex:i}):void 0)}moveRangesInsideSourceRange(e,t,r,n){this.updateVerticesFromSheet(e.sheet,(i,a)=>{if(e.containsRange(a.range))return a.range.shiftByColumns(t),a.range.shiftByRows(r),a.range.moveToSheet(n),{changedSize:!1,vertex:a}})}removeRangesInSheet(e){if(this.rangeMapping.has(e)){const t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}*rangesInSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.values())}*rangeVerticesContainedInRange(e){for(const t of this.rangesInSheet(e.sheet))e.containsRange(t.range)&&(yield t)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){const t=O(e.end.sheet,e.end.col,e.end.row-1),r=this.getRange(e.start,t);if(r!==void 0){const n=F.fromSimpleCellAddresses(O(e.start.sheet,e.start.col,e.end.row),e.end);return{smallerRangeVertex:r,restRange:n}}}return{restRange:e}}*entriesFromSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.entries())}removeByKey(e,t){this.rangeMapping.get(e).delete(t)}getByKey(e,t){var r;return(r=this.rangeMapping.get(e))===null||r===void 0?void 0:r.get(t)}updateVerticesFromSheet(e,t){const r=Array();for(const[n,i]of this.entriesFromSheet(e)){const a=t(n,i);a!==void 0&&(this.removeByKey(e,n),r.push(a))}return r.forEach(n=>{this.setRange(n.vertex)}),{verticesWithChangedSize:r.filter(n=>n.changedSize).map(n=>n.vertex)}}}function Is(s,e){return`${s.col},${s.row},${e.col},${e.row}`}function AE(s){return Is(s.start,s.end)}const yE=(s,e,t)=>{const r=t(s.range.start),n=t(s.range.start);if(r===n){const i=t(s.range.end),a=t(e.range.end);return i-a}else return r-n};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class CE{constructor(e,t,r){this.functions=e,this.errors=t,this.ui=r,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce((e,t)=>(e[this.functions[t]]=t,e),{})}buildErrorMapping(){return Object.keys(this.errors).reduce((e,t)=>(e[this.errors[t]]=t,e),{})}isFunctionTranslated(e){return this.functions[e]!==void 0}getFunctionTranslations(e){const t=[];for(const r of e)this.isFunctionTranslated(r)&&t.push(this.functions[r]);return t}getFunctionTranslation(e){const t=this.functions[e];if(t===void 0)throw new jr(`functions.${e}`);return t}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===m.LIC)return`#${m.LIC}!`;const t=this.errors[e];if(t===void 0)throw new jr(`errors.${e}`);return t}getUITranslation(e){const t=this.ui[e];if(t===void 0)throw new jr(`ui.${e}`);return t}checkUI(){for(const e of Object.values(Gn))if(!(e in this.ui))throw new jr(`ui.${e}`)}checkErrors(){for(const e of Object.values(m))if(!(e in this.errors)&&e!==m.LIC)throw new jr(`errors.${e}`)}checkFunctionTranslations(e){const t=new Set(Object.getOwnPropertyNames(e));for(const r of Object.getOwnPropertyNames(this._protectedTranslations))if(t.has(r))throw new cl(r)}}function vE(s){return new CE(Object.assign({},s.functions),Object.assign({},s.errors),Object.assign({},s.ui))}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var Gn;(function(s){s.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"})(Gn||(Gn={}));/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function qr(s){return s.toLowerCase()}class IE{constructor(e,t){this.id=e,this.displayName=t}get canonicalName(){return qr(this.displayName)}}class OE{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=t=>{const r=this.mappingFromCanonicalName.get(qr(t));if(r===void 0)throw new Jh(t);return r.id},this.get=t=>{var r;return(r=this.mappingFromCanonicalName.get(qr(t)))===null||r===void 0?void 0:r.id},this.fetchDisplayName=t=>this.fetchSheetById(t).displayName,this.sheetNamePrefix=e.getUITranslation(Gn.NEW_SHEET_PREFIX)}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){const t=qr(e);if(this.mappingFromCanonicalName.has(t))throw new Dn(e);this.lastSheetId++;const r=new IE(this.lastSheetId,e);return this.store(r),r.id}removeSheet(e){const t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}getDisplayName(e){var t;return(t=this.mappingFromId.get(e))===null||t===void 0?void 0:t.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(qr(e))}renameSheet(e,t){const r=this.fetchSheetById(e),n=r.displayName;if(n===t)return;const i=this.mappingFromCanonicalName.get(qr(t));if(i!==void 0&&i.id!==r.id)throw new Dn(t);const a=r.canonicalName;return this.mappingFromCanonicalName.delete(a),r.displayName=t,this.store(r),n}sheetNames(){return Array.from(this.mappingFromId.values()).map(e=>e.displayName)}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){const t=this.mappingFromId.get(e);if(t===void 0)throw new ae(e);return t}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class $a{constructor(e,t,r,n,i,a,o,u){this.addressMapping=e,this.rangeMapping=t,this.sheetMapping=r,this.arrayMapping=n,this.stats=i,this.lazilyTransformingAstService=a,this.functionRegistry=o,this.namedExpressions=u,this.changes=lr.empty(),this.dependencyQueryAddresses=l=>{if(l instanceof Pe)return this.rangeDependencyQuery(l).map(([c,d])=>c);{const c=this.formulaDependencyQuery(l);if(c!==void 0){const[d,f]=c;return f.map(T=>T instanceof jt?this.namedExpressions.namedExpressionOrPlaceholder(T.name,d.sheet).address:de(T)?T:na(T.start,T.end))}else return[]}},this.dependencyQueryVertices=l=>{if(l instanceof Pe)return this.rangeDependencyQuery(l);{const c=this.formulaDependencyQuery(l);if(c!==void 0){const[d,f]=c;return f.map(T=>{if(T instanceof F)return[T.start,this.rangeMapping.fetchRange(T.start,T.end)];if(T instanceof jt){const N=this.namedExpressions.namedExpressionOrPlaceholder(T.name,d.sheet);return[N.address,this.addressMapping.fetchCell(N.address)]}else return[T,this.addressMapping.fetchCell(T)]})}else return[]}},this.rangeDependencyQuery=l=>{const c=[],{smallerRangeVertex:d,restRange:f}=this.rangeMapping.findSmallerRange(l.range);let T;d!==void 0&&this.graph.adjacentNodes(d).has(l)?(T=f,c.push([new F(d.start,d.end),d])):T=l.range;for(const N of T.addresses(this)){const E=this.addressMapping.getCell(N);E!==void 0&&c.push([N,E])}return c},this.formulaDependencyQuery=l=>{let c,d;if(l instanceof nt)d=l.getAddress(this.lazilyTransformingAstService),c=l.getFormula(this.lazilyTransformingAstService);else return;const f=gi(c,this.functionRegistry);return[d,Pt(f,d)]},this.graph=new NE(this.dependencyQueryVertices)}static buildEmpty(e,t,r,n,i){return new $a(new mE(t.chooseAddressMappingPolicy),new SE,new OE(t.translationPackage),new gE,i,e,r,n)}setFormulaToCell(e,t,r,n,i,a){const o=nt.fromAst(t,e,n,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(o),this.processCellDependencies(r,o),this.graph.markNodeAsDirty(o),i&&this.markAsVolatile(o),a&&this.markAsDependentOnStructureChange(o),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,t){const r=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(r,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,t){const r=this.shrinkPossibleArrayAndGetCell(e);if(r instanceof ge&&this.arrayMapping.removeArray(r.getRange()),r instanceof cr)r.getValues().rawValue!==t.rawValue&&(r.setValues(t),this.graph.markNodeAsDirty(r));else{const n=new cr(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(r,n),this.addressMapping.setCell(e,n),this.graph.markNodeAsDirty(n)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){const t=this.shrinkPossibleArrayAndGetCell(e);if(t===void 0)return lr.empty();if(this.graph.adjacentNodes(t).size>0){const r=new or;this.exchangeGraphNode(t,r),this.graph.adjacentNodesCount(r)===0?(this.removeVertex(r),this.addressMapping.removeCell(e)):(this.graph.markNodeAsDirty(r),this.addressMapping.setCell(e,r))}else this.removeVertex(t),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}clearDirtyVertices(){this.graph.clearDirtyNodes()}verticesToRecompute(){return this.graph.getDirtyAndVolatileNodes()}processCellDependencies(e,t){const r=this.graph.getNodeId(t);e.forEach(n=>{if(n instanceof F){const i=n;let a=this.getRange(i.start,i.end);a===void 0&&(a=new Pe(i),this.rangeMapping.setRange(a)),this.graph.addNodeAndReturnId(a);const o=this.graph.getNodeId(a);i.isFinite()||this.graph.markNodeAsInfiniteRange(o);const{smallerRangeVertex:u,restRange:l}=this.rangeMapping.findSmallerRange(i);if(u!==void 0){if(this.graph.addEdge(u,o),a.bruteForce){a.bruteForce=!1;for(const d of i.addresses(this))this.graph.removeEdge(this.fetchCell(d),o)}}else a.bruteForce=!0;const c=this.arrayMapping.getArray(l);if(c!==void 0)this.graph.addEdge(c,o);else for(const d of l.addresses(this)){const{vertex:f,id:T}=this.fetchCellOrCreateEmpty(d);this.graph.addEdge(T??f,o)}this.graph.addEdge(o,r),i.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(a)}else if(n instanceof jt){const i=t.getAddress(this.lazilyTransformingAstService).sheet,{vertex:a,id:o}=this.fetchNamedExpressionVertex(n.name,i);this.graph.addEdge(o??a,r)}else{const{vertex:i,id:a}=this.fetchCellOrCreateEmpty(n);this.graph.addEdge(a??i,r)}})}fetchNamedExpressionVertex(e,t){const r=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(r.address)}exchangeNode(e,t){const r=this.fetchCellOrCreateEmpty(e).vertex,n=this.fetchCellOrCreateEmpty(t).vertex;this.addressMapping.removeCell(e),this.exchangeGraphNode(r,n)}fetchCellOrCreateEmpty(e){const t=this.addressMapping.getCell(e);if(t!==void 0)return{vertex:t,id:void 0};const r=new or,n=this.graph.addNodeAndReturnId(r);return this.addressMapping.setCell(e,r),{vertex:r,id:n}}removeRows(e){this.stats.measure(x.ADJUSTING_GRAPH,()=>{for(const[r,n]of this.addressMapping.entriesFromRowsSpan(e)){for(const i of this.graph.adjacentNodes(n))this.graph.markNodeAsDirty(i);if(n instanceof ge)if(n.isLeftCorner(r))this.shrinkArrayToCorner(n),this.arrayMapping.removeArray(n.getRange());else continue;this.removeVertex(n)}}),this.stats.measure(x.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeRows(e)});const t=this.stats.measure(x.ADJUSTING_RANGES,()=>{const r=this.truncateRanges(e,n=>n.row);return this.getArrayVerticesRelatedToRanges(r)});return this.stats.measure(x.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}removeSheet(e){this.clearSheet(e);for(const[t,r]of this.addressMapping.sheetEntries(e)){for(const n of this.graph.adjacentNodes(r))this.graph.markNodeAsDirty(n);this.removeVertex(r),this.addressMapping.removeCell(t)}this.stats.measure(x.ADJUSTING_RANGES,()=>{const t=this.rangeMapping.removeRangesInSheet(e);for(const r of t)this.removeVertex(r);this.stats.measure(x.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeSheet(e)})})}clearSheet(e){const t=new Set;for(const[r,n]of this.addressMapping.sheetEntries(e))n instanceof ge?t.add(n):this.setCellEmpty(r);for(const r of t.values())this.setArrayEmpty(r);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(x.ADJUSTING_GRAPH,()=>{for(const[r,n]of this.addressMapping.entriesFromColumnsSpan(e)){for(const i of this.graph.adjacentNodes(n))this.graph.markNodeAsDirty(i);if(n instanceof ge)if(n.isLeftCorner(r))this.shrinkArrayToCorner(n),this.arrayMapping.removeArray(n.getRange());else continue;this.removeVertex(n)}}),this.stats.measure(x.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeColumns(e)});const t=this.stats.measure(x.ADJUSTING_RANGES,()=>{const r=this.truncateRanges(e,n=>n.col);return this.getArrayVerticesRelatedToRanges(r)});return this.stats.measure(x.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns)),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(x.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)});const t=this.stats.measure(x.ADJUSTING_RANGES,()=>{const r=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(r.verticesWithChangedSize)});this.stats.measure(x.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)});for(const r of this.addressMapping.verticesFromRowsSpan(e))this.graph.markNodeAsDirty(r);return this.addStructuralNodesToChangeSet(),{affectedArrays:t}}addColumns(e){this.stats.measure(x.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)});const t=this.stats.measure(x.ADJUSTING_RANGES,()=>{const r=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(r.verticesWithChangedSize)});this.stats.measure(x.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns));for(const r of this.addressMapping.verticesFromColumnsSpan(e))this.graph.markNodeAsDirty(r);return this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}isThereSpaceForArray(e){const t=e.getRangeOrUndef();if(t===void 0)return!1;for(const r of t.addresses(this)){const n=this.addressMapping.getCell(r);if(n!==void 0&&!(n instanceof or)&&n!==e)return!1}return!0}moveCells(e,t,r,n){for(const i of e.addressesWithDirection(t,r,this)){const a=O(n,i.col+t,i.row+r);let o=this.addressMapping.getCell(i);const u=this.addressMapping.getCell(a);if(this.addressMapping.removeCell(i),o!==void 0){this.graph.markNodeAsDirty(o),this.addressMapping.setCell(a,o);let l;for(const c of this.graph.adjacentNodes(o))c instanceof Pe&&!e.containsRange(c.range)&&(l=l??this.fetchCellOrCreateEmpty(i).vertex,this.graph.addEdge(l,c),this.graph.removeEdge(o,c));l&&(this.graph.markNodeAsDirty(l),this.addressMapping.setCell(i,l))}if(u!==void 0){o===void 0&&this.addressMapping.removeCell(a);for(const l of this.graph.adjacentNodes(u))o=o??this.fetchCellOrCreateEmpty(a).vertex,this.graph.addEdge(o,l),this.graph.markNodeAsDirty(o);this.removeVertex(u)}}for(const i of this.rangeMapping.rangeVerticesContainedInRange(e))for(const a of this.graph.adjacentNodes(i))if(a instanceof Pe&&!e.containsRange(a.range)){this.graph.removeEdge(i,a);for(const o of i.range.addresses(this)){const{vertex:u,id:l}=this.fetchCellOrCreateEmpty(o);this.graph.addEdge(l??u,a),this.addressMapping.setCell(o,u),this.graph.markNodeAsDirty(u)}}this.rangeMapping.moveRangesInsideSourceRange(e,t,r,n)}setArrayEmpty(e){const t=F.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),r=this.graph.adjacentNodes(e);for(const n of t.addresses(this))this.addressMapping.removeCell(n);for(const n of r.values()){const i=EE(this.functionRegistry,n,e.getRange(),this.lazilyTransformingAstService,this);for(const a of i){const{vertex:o,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u??o,n)}i.length>0&&this.graph.markNodeAsDirty(n)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,t){this.graph.addNodeAndReturnId(t),this.addressMapping.setCell(e,t)}addArrayVertex(e,t){this.graph.addNodeAndReturnId(t),this.setAddressMappingForArrayVertex(t,e)}*arrayFormulaNodes(){for(const e of this.graph.getNodes())e instanceof ge&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){const t=this.addressMapping.getCellValue(e);return t instanceof w?new p(m.VALUE,R.ScalarExpected):t}existsEdge(e,t){return this.graph.existsEdge(e,t)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}getRange(e,t){return this.rangeMapping.getRange(e,t)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsVolatile(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.getNodes())e instanceof Vt&&e.ensureRecentData(this.lazilyTransformingAstService)}*rawValuesFromRange(e){for(const t of e.addresses(this)){const r=this.getScalarValue(t);r!==B&&(yield[I(r),t])}}computeListOfValuesInRange(e){const t=[];for(const r of e.addresses(this)){const n=this.getScalarValue(r);t.push(n)}return t}shrinkArrayToCorner(e){this.cleanAddressMappingUnderArray(e);for(const t of this.adjacentArrayVertices(e)){let r;t instanceof nt?r=this.formulaDirectDependenciesToArray(t,e):r=this.rangeDirectDependenciesToArray(t,e);let n=!1;for(const[i,a]of r)e.isLeftCorner(i)&&(n=!0),this.graph.addEdge(a,t),this.graph.markNodeAsDirty(a);n||this.graph.removeEdge(e,t)}this.graph.markNodeAsDirty(e)}isArrayInternalCell(e){const t=this.getCell(e);return t instanceof ge&&!t.isLeftCorner(e)}getAndClearContentChanges(){const e=this.changes;return this.changes=lr.empty(),e}getAdjacentNodesAddresses(e){const t=this.graph.adjacentNodes(e),r=[];return t.forEach(n=>{const i=n;i instanceof Pe?r.push(na(i.start,i.end)):r.push(i.getAddress(this.lazilyTransformingAstService))}),r}exchangeGraphNode(e,t){this.graph.addNodeAndReturnId(t);const r=this.graph.adjacentNodes(e);this.removeVertex(e),r.forEach(n=>{this.graph.hasNode(n)&&this.graph.addEdge(t,n)})}setArray(e,t){this.arrayMapping.setArray(e,t)}correctInfiniteRangesDependency(e){const t=this.graph.getInfiniteRanges().filter(({node:a})=>a.range.addressInRange(e));if(t.length<=0)return;const{vertex:r,id:n}=this.fetchCellOrCreateEmpty(e),i=n??this.graph.getNodeId(r);t.forEach(({id:a})=>{this.graph.addEdge(i,a)})}exchangeOrAddGraphNode(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNodeAndReturnId(t)}getArrayVerticesRelatedToRanges(e){const t=new Set;return e.forEach(r=>{this.graph.hasNode(r)&&this.graph.adjacentNodes(r).forEach(n=>{n instanceof ge&&t.add(n)})}),t}correctInfiniteRangesDependenciesByRangeVertex(e){this.graph.getInfiniteRanges().forEach(({id:t,node:r})=>{const n=e.range.intersectionWith(r.range);n!==void 0&&n.addresses(this).forEach(i=>{const{vertex:a,id:o}=this.fetchCellOrCreateEmpty(i);this.graph.addEdge(o??a,t)})})}cleanAddressMappingUnderArray(e){const t=e.getRange();for(const r of t.addresses(this)){const n=e.getArrayCellValue(r);this.getCell(r)===e?e.isLeftCorner(r)?this.changes.addChange(new p(m.REF),r,n):(this.addressMapping.removeCell(r),this.changes.addChange(B,r,n)):this.changes.addChange(B,r,n)}}*formulaDirectDependenciesToArray(e,t){var r;const[,n]=(r=this.formulaDependencyQuery(e))!==null&&r!==void 0?r:[];if(n!==void 0){for(const i of n)if(!(i instanceof jt||i instanceof F)&&t.getRange().addressInRange(i)){const a=this.fetchCellOrCreateEmpty(i).vertex;yield[i,a]}}}*rangeDirectDependenciesToArray(e,t){const{restRange:r}=this.rangeMapping.findSmallerRange(e.range);for(const n of r.addresses(this))if(t.getRange().addressInRange(n)){const i=this.fetchCellOrCreateEmpty(n).vertex;yield[n,i]}}*adjacentArrayVertices(e){const t=this.graph.adjacentNodes(e);for(const r of t)(r instanceof nt||r instanceof Pe)&&(yield r)}addStructuralNodesToChangeSet(){this.graph.markChangingWithStructureNodesAsDirty()}fixRangesWhenAddingRows(e,t,r){const n=Array.from(this.rangeMapping.rangesInSheet(e));for(const i of n)if(i.range.includesRow(t+r))if(i.bruteForce){const a=i.range.rangeWithSameWidth(t,r);for(const o of a.addresses(this)){const{vertex:u,id:l}=this.fetchCellOrCreateEmpty(o);this.graph.addEdge(l??u,i)}}else{let a=i,o=this.rangeMapping.findSmallerRange(a.range);if(o.smallerRangeVertex!==void 0)continue;for(;o.smallerRangeVertex===void 0;){const u=new Pe(F.spanFrom(a.range.start,a.range.width(),a.range.height()-1));this.rangeMapping.setRange(u),this.graph.addNodeAndReturnId(u);const l=new F(O(a.range.start.sheet,a.range.start.col,a.range.end.row),a.range.end);this.addAllFromRange(l,a),this.graph.addEdge(u,a),a=u,o=this.rangeMapping.findSmallerRange(a.range)}this.graph.addEdge(o.smallerRangeVertex,a),this.addAllFromRange(o.restRange,a),this.graph.removeEdge(o.smallerRangeVertex,i)}}addAllFromRange(e,t){for(const r of e.addresses(this)){const{vertex:n,id:i}=this.fetchCellOrCreateEmpty(r);this.graph.addEdge(i??n,t)}}fixRangesWhenAddingColumns(e,t,r){for(const n of this.rangeMapping.rangesInSheet(e))if(n.range.includesColumn(t+r)){let i;n.bruteForce?i=n.range.rangeWithSameHeight(t,r):i=F.spanFrom(O(e,t,n.range.end.row),r,1);for(const a of i.addresses(this)){const{vertex:o,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u??o,n)}}}exchangeOrAddFormulaVertex(e){const t=e.getAddress(this.lazilyTransformingAstService),r=F.spanFrom(t,e.width,e.height),n=this.shrinkPossibleArrayAndGetCell(t);if(e instanceof ge&&this.setArray(r,e),this.exchangeOrAddGraphNode(n,e),this.addressMapping.setCell(t,e),e instanceof ge){if(!this.isThereSpaceForArray(e))return;for(const i of r.addresses(this)){if(e.isLeftCorner(i))continue;const a=this.getCell(i);this.exchangeOrAddGraphNode(a,e)}}for(const i of r.addresses(this))this.addressMapping.setCell(i,e)}setAddressMappingForArrayVertex(e,t){if(this.addressMapping.setCell(t,e),!(e instanceof ge))return;const r=F.spanFromOrUndef(t,e.width,e.height);if(r!==void 0&&(this.setArray(r,e),!!this.isThereSpaceForArray(e)))for(const n of r.addresses(this))this.addressMapping.setCell(n,e)}truncateRanges(e,t){const{verticesToRemove:r,verticesToMerge:n,verticesWithChangedSize:i}=this.rangeMapping.truncateRanges(e,t);for(const[a,o]of n)this.mergeRangeVertices(a,o);for(const a of r)this.removeVertexAndCleanupDependencies(a);return i}fixArraysAfterAddingRow(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,r),!(t<=0))for(const[,n]of this.arrayMapping.arraysInRows(Xe.fromRowStartAndEnd(e,t-1,t-1))){const i=n.getRange();for(let a=i.start.col;a<=i.end.col;++a)for(let o=t;o<=i.end.row;++o){const u=O(e,a,o),l=O(e,a,o+r),c=n.getArrayCellValue(u);this.addressMapping.moveCell(l,u),this.changes.addChange(B,l,c)}}}fixArraysAfterRemovingRows(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-r),!(t<=0))for(const[,n]of this.arrayMapping.arraysInRows(Xe.fromRowStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(n))for(const i of n.getRange().addresses(this))this.addressMapping.setCell(i,n);else this.setNoSpaceIfArray(n)}fixArraysAfterAddingColumn(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,r),!(t<=0))for(const[,n]of this.arrayMapping.arraysInCols(rt.fromColumnStartAndEnd(e,t-1,t-1))){const i=n.getRange();for(let a=i.start.row;a<=i.end.row;++a)for(let o=t;o<=i.end.col;++o){const u=O(e,o,a),l=O(e,o+r,a),c=n.getArrayCellValue(u);this.addressMapping.moveCell(l,u),this.changes.addChange(B,l,c)}}}fixArraysAfterRemovingColumns(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-r),!(t<=0))for(const[,n]of this.arrayMapping.arraysInCols(rt.fromColumnStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(n))for(const i of n.getRange().addresses(this))this.addressMapping.setCell(i,n);else this.setNoSpaceIfArray(n)}shrinkPossibleArrayAndGetCell(e){const t=this.getCell(e);return t instanceof ge?(this.setNoSpaceIfArray(t),this.getCell(e)):t}setNoSpaceIfArray(e){e instanceof ge&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof Pe&&this.rangeMapping.removeRange(e)}mergeRangeVertices(e,t){const r=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.removeEdgeIfExists(e,t),r.forEach(n=>{this.graph.hasNode(n)&&this.graph.addEdge(e,n)})}removeVertexAndCleanupDependencies(e){const t=new Set(this.graph.removeNode(e));for(;t.size>0;){const r=t.values().next().value;t.delete(r);const[n,i]=r;this.graph.hasNode(i)&&this.graph.adjacentNodesCount(i)===0&&((i instanceof Pe||i instanceof or)&&this.graph.removeNode(i).forEach(a=>t.add(a)),i instanceof Pe?this.rangeMapping.removeRange(i):i instanceof or&&this.addressMapping.removeCell(n))}}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class or{constructor(){}getCellValue(){return B}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class cr{constructor(e,t){this.parsedValue=e,this.rawValue=t}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class on{constructor(e,t){this.errors=e,this.rawInput=t}getCellValue(){const e=this.errors.map(t=>t.message).find(t=>t);return p.parsingError(e)}getFormula(){return this.rawInput}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ME{constructor(e,t){this.width=e,this.height=t,this.mapping=new Map}getCell(e){var t;return(t=this.mapping.get(e.col))===null||t===void 0?void 0:t.get(e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let r=this.mapping.get(e.col);r||(r=new Map,this.mapping.set(e.col,r)),r.set(e.row,t)}has(e){var t;return!!(!((t=this.mapping.get(e.col))===null||t===void 0)&&t.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var t;(t=this.mapping.get(e.col))===null||t===void 0||t.delete(e.row)}addRows(e,t){this.mapping.forEach(r=>{const n=new Map;r.forEach((i,a)=>{a>=e&&(n.set(a+t,i),r.delete(a))}),n.forEach((i,a)=>{r.set(a,i)})}),this.height+=t}addColumns(e,t){const r=new Map;this.mapping.forEach((n,i)=>{i>=e&&(r.set(i+t,n),this.mapping.delete(i))}),r.forEach((n,i)=>{this.mapping.set(i,n)}),this.width+=t}removeRows(e){this.mapping.forEach(n=>{const i=new Map;n.forEach((a,o)=>{o>=e.rowStart&&(n.delete(o),o>e.rowEnd&&i.set(o-e.numberOfRows,a))}),i.forEach((a,o)=>{n.set(o,a)})});const t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}removeColumns(e){const t=new Map;this.mapping.forEach((i,a)=>{a>=e.columnStart&&(this.mapping.delete(a),a>e.columnEnd&&t.set(a-e.numberOfColumns,i))}),t.forEach((i,a)=>{this.mapping.set(a,i)});const r=Math.min(this.width-1,e.columnEnd),n=Math.max(0,r-e.columnStart+1);this.width=Math.max(0,this.width-n)}*getEntries(e){for(const[t,r]of this.mapping)for(const[n,i]of r)yield[O(e,t,n),i]}*verticesFromColumn(e){const t=this.mapping.get(e);if(t!==void 0)for(const[r,n]of t)yield n}*verticesFromRow(e){for(const t of this.mapping.values()){const r=t.get(e);r!==void 0&&(yield r)}}*verticesFromColumnsSpan(e){for(const t of e.columns()){const r=this.mapping.get(t);if(r!==void 0)for(const[n,i]of r)yield i}}*verticesFromRowsSpan(e){for(const t of this.mapping.values())for(const r of e.rows()){const n=t.get(r);n!==void 0&&(yield n)}}*entriesFromRowsSpan(e){for(const[t,r]of this.mapping.entries())for(const n of e.rows()){const i=r.get(n);i!==void 0&&(yield[O(e.sheet,t,n),i])}}*entriesFromColumnsSpan(e){for(const t of e.columns()){const r=this.mapping.get(t);if(r!==void 0)for(const[n,i]of r.entries())yield[O(e.sheet,t,n),i]}}*vertices(){for(const[e,t]of this.mapping)for(const[r,n]of t)n!==void 0&&(yield n)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class wE{constructor(e,t){this.width=e,this.height=t,this.mapping=new Array(t);for(let r=0;r<t;r++)this.mapping[r]=new Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}has(e){const t=this.mapping[e.row];return t?!!t[e.col]:!1}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){this.mapping[e.row]!==void 0&&delete this.mapping[e.row][e.col]}addRows(e,t){const r=[];for(let n=0;n<t;n++)r.push(new Array(this.width));this.mapping.splice(e,0,...r),this.height+=t}addColumns(e,t){for(let r=0;r<this.height;r++)this.mapping[r]!==void 0&&this.mapping[r].splice(e,0,...new Array(t));this.width+=t}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);const t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}removeColumns(e){for(let n=0;n<this.height;n++)this.mapping[n]!==void 0&&this.mapping[n].splice(e.columnStart,e.numberOfColumns);const t=Math.min(this.width-1,e.columnEnd),r=Math.max(0,t-e.columnStart+1);this.width=Math.max(0,this.width-r)}*getEntries(e){for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r){const n=this.getCellVertex(r,t);n&&(yield[O(e,r,t),n])}}*verticesFromColumn(e){for(let t=0;t<this.height;++t){const r=this.getCellVertex(e,t);r&&(yield r)}}*verticesFromRow(e){for(let t=0;t<this.width;++t){const r=this.getCellVertex(t,e);r&&(yield r)}}*verticesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let r=0;r<this.height;++r){const n=this.getCellVertex(t,r);n&&(yield n)}}*verticesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){const n=this.getCellVertex(t,r);n&&(yield n)}}*entriesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){const n=this.getCellVertex(t,r);n&&(yield[O(e.sheet,t,r),n])}}*entriesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let r=0;r<this.height;++r){const n=this.getCellVertex(t,r);n&&(yield[O(e.sheet,t,r),n])}}*vertices(){for(let e=0;e<this.height;++e)for(let t=0;t<this.width;++t){const r=this.getCellVertex(t,e);r&&(yield r)}}getCellVertex(e,t){var r;return(r=this.mapping[t])===null||r===void 0?void 0:r[e]}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var m;(function(s){s.DIV_BY_ZERO="DIV_BY_ZERO",s.NAME="NAME",s.VALUE="VALUE",s.NUM="NUM",s.NA="NA",s.CYCLE="CYCLE",s.REF="REF",s.SPILL="SPILL",s.LIC="LIC",s.ERROR="ERROR"})(m||(m={}));var We;(function(s){s.FORMULA="FORMULA",s.VALUE="VALUE",s.ARRAY="ARRAY",s.EMPTY="EMPTY",s.ARRAYFORMULA="ARRAYFORMULA"})(We||(We={}));const _E=(s,e)=>s instanceof ge?s.isLeftCorner(e)?We.ARRAYFORMULA:We.ARRAY:s instanceof Vt||s instanceof on?We.FORMULA:s instanceof cr?We.VALUE:We.EMPTY;var Xs;(function(s){s.EMPTY="EMPTY",s.NUMBER="NUMBER",s.STRING="STRING",s.BOOLEAN="BOOLEAN",s.ERROR="ERROR"})(Xs||(Xs={}));var ra;(function(s){s.NUMBER="NUMBER"})(ra||(ra={}));const It=Object.assign(Object.assign({},Xs),ra),LE=Object.assign(Object.assign({},Xs),L),Ho=s=>{switch(s){case It.EMPTY:return 0;case It.NUMBER:return 1;case It.STRING:return 2;case It.BOOLEAN:return 3;case It.ERROR:return 4}throw new Error("Cell value not computed")},Ks=s=>{if(s===B)return It.EMPTY;if(s instanceof p||s instanceof w)return It.ERROR;if(typeof s=="string")return It.STRING;if(X(s))return It.NUMBER;if(typeof s=="boolean")return It.BOOLEAN;throw new Error("Cell value not computed")},FE=s=>X(s)?hE(s):Ks(s),UE=s=>{if(X(s))return lE(s)};class p{constructor(e,t,r){this.type=e,this.message=t,this.root=r}static parsingError(e){return new p(m.ERROR,`${R.ParseError}${e?" "+e:""}`)}attachRootVertex(e){return this.root===void 0?new p(this.type,this.message,e):this}}const pl=(s,e)=>({sheet:s,row:e}),bE=s=>s.row<0,fl=(s,e)=>({sheet:s,col:e}),xE=s=>s.col<0,O=(s,e,t)=>({sheet:s,col:e,row:t}),$e=s=>s.col<0||s.row<0,PE=(s,e,t,r)=>O(e,s.col+t,s.row+r),_n=s=>`${s.sheet},${s.row},${s.col}`;function de(s){var e,t,r;return s&&(typeof s=="object"||typeof s=="function")&&typeof((e=s)===null||e===void 0?void 0:e.sheet)=="number"&&typeof((t=s)===null||t===void 0?void 0:t.col)=="number"&&typeof((r=s)===null||r===void 0?void 0:r.row)=="number"}const Mt=(s,e)=>{var t;return(t=s.sheet)!==null&&t!==void 0?t:e.sheet},Hn=(s,e)=>s.sheet===e.sheet&&s.col===e.col&&s.row===e.row;/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const VE="AbsoluteCellRange: Wrong range size";function et(s){if(s&&(typeof s=="object"||typeof s=="function")){const e=s;return"start"in e&&de(e.start)&&"end"in e&&de(e.end)}else return!1}const na=(s,e)=>({start:s,end:e});class F{constructor(e,t){if(e.sheet!==t.sheet)throw new Bn(e.sheet,t.sheet);this.start=O(e.sheet,e.col,e.row),this.end=O(t.sheet,t.col,t.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,t){if(e.sheet!==t.sheet)throw new Bn(e.sheet,t.sheet);const r=t.col-e.col,n=t.row-e.row;return Number.isFinite(n)&&Number.isFinite(r)?new F(e,t):Number.isFinite(n)?new Qt(e.sheet,e.row,t.row):new qt(e.sheet,e.col,t.col)}static fromAst(e,t){return e.type===g.CELL_RANGE?F.fromCellRange(e,t):e.type===g.COLUMN_RANGE?qt.fromColumnRange(e,t):Qt.fromRowRangeAst(e,t)}static fromAstOrUndef(e,t){try{return F.fromAst(e,t)}catch{return}}static fromCellRange(e,t){return new F(e.start.toSimpleCellAddress(t),e.end.toSimpleCellAddress(t))}static spanFrom(e,t,r){const n=F.spanFromOrUndef(e,t,r);if(n===void 0)throw new Error(VE);return n}static spanFromOrUndef(e,t,r){if(!Number.isFinite(t)&&Number.isFinite(r))return e.col!==0?void 0:new Qt(e.sheet,e.row,e.row+r-1);if(!Number.isFinite(r)&&Number.isFinite(t))return e.row!==0?void 0:new qt(e.sheet,e.col,e.col+t-1);if(Number.isFinite(r)&&Number.isFinite(t))return new F(e,O(e.sheet,e.col+t-1,e.row+r-1))}static fromCoordinates(e,t,r,n,i){return new F(O(e,t,r),O(e,n,i))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}addressInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}columnInRange(e){return this.sheet!==e.sheet?!1:this.start.col<=e.col&&this.end.col>=e.col}rowInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;const t=Math.max(this.start.row,e.start.row),r=Math.min(this.end.row,e.end.row),n=Math.max(this.start.col,e.start.col),i=Math.min(this.end.col,e.end.col);if(!(t>r||n>i))return new F(O(this.sheet,n,t),O(this.sheet,i,r))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,t){return F.spanFrom(O(this.sheet,this.start.col+e,this.start.row+t),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof Xe?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,t){return F.spanFrom(O(this.sheet,this.start.col,e),this.width(),t)}rangeWithSameHeight(e,t){return F.spanFrom(O(this.sheet,e,this.start.row),t,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){const e=[];for(let t=0;t<this.height();++t){e[t]=[];for(let r=0;r<this.width();++r){const n=O(this.sheet,this.start.col+r,this.start.row+t);e[t].push(n)}}return e}withStart(e){return new F(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return Hn(this.start,e.start)&&Hn(this.end,e.end)}addressesArrayMap(e,t){const r=[];let n=this.start.row;for(;n<=this.effectiveEndRow(e);){let i=this.start.col;const a=[];for(;i<=this.effectiveEndColumn(e);)a.push(t(O(this.start.sheet,i,n))),i++;r.push(a),n++}return r}addresses(e){const t=[];let r=this.start.row;const n=this.effectiveEndRow(e),i=this.effectiveEndColumn(e);for(;r<=n;){let a=this.start.col;for(;a<=i;)t.push(O(this.start.sheet,a,r)),a++;r++}return t}*addressesWithDirection(e,t,r){if(e>0)if(t>0){let n=this.effectiveEndRow(r);for(;n>=this.start.row;){let i=this.effectiveEndColumn(r);for(;i>=this.start.col;)yield O(this.start.sheet,i,n),i-=1;n-=1}}else{let n=this.start.row;for(;n<=this.effectiveEndRow(r);){let i=this.effectiveEndColumn(r);for(;i>=this.start.col;)yield O(this.start.sheet,i,n),i-=1;n+=1}}else if(t>0){let n=this.effectiveEndRow(r);for(;n>=this.start.row;){let i=this.start.col;for(;i<=this.effectiveEndColumn(r);)yield O(this.start.sheet,i,n),i+=1;n-=1}}else{let n=this.start.row;for(;n<=this.effectiveEndRow(r);){let i=this.start.col;for(;i<=this.effectiveEndColumn(r);)yield O(this.start.sheet,i,n),i+=1;n+=1}}}getAddress(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return O(this.start.sheet,this.start.col+e,this.start.row+t)}exceedsSheetSizeLimits(e,t){return this.end.col>=e||this.end.row>=t}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,t){if(!(e>this.end.row)){if(t<this.start.row){const r=t-e+1;return this.shiftByRows(-r)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}removeColumns(e,t){if(!(e>this.end.col)){if(t<this.start.col){const r=t-e+1;return this.shiftByColumns(-r)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}}class qt extends F{constructor(e,t,r){super(O(e,t,0),O(e,r,Number.POSITIVE_INFINITY))}static fromColumnRange(e,t){const r=e.start.toSimpleColumnAddress(t),n=e.end.toSimpleColumnAddress(t);if(r.sheet!==n.sheet)throw new Bn(r.sheet,n.sheet);return new qt(r.sheet,r.col,n.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,t){return new qt(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,t){return new qt(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,t){}}class Qt extends F{constructor(e,t,r){super(O(e,0,t),O(e,Number.POSITIVE_INFINITY,r))}static fromRowRangeAst(e,t){const r=e.start.toSimpleRowAddress(t),n=e.end.toSimpleRowAddress(t);if(r.sheet!==n.sheet)throw new Bn(r.sheet,n.sheet);return new Qt(r.sheet,r.row,n.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,t){return new Qt(this.sheet,this.start.row+t,this.end.row+t)}rangeWithSameWidth(e,t){return new Qt(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.row>=t}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,t){}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Bt{constructor(e,t,r){this.formulaAddress=e,this.arraysFlag=t,this.formulaVertex=r}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function DE(s){const e=s.caseSensitive?s.accentSensitive?"variant":"case":s.accentSensitive?"accent":"base",t=s.caseFirst,r=s.ignorePunctuation;return new Intl.Collator(s.localeLang,{sensitivity:e,caseFirst:t,ignorePunctuation:r})}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const BE="i",kE=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class GE{constructor(e,t,r){this.config=e,this.dateTimeHelper=t,this.numberLiteralsHelper=r,this.lt=(n,i)=>this.compare(n,i)<0,this.leq=(n,i)=>this.compare(n,i)<=0,this.gt=(n,i)=>this.compare(n,i)>0,this.geq=(n,i)=>this.compare(n,i)>=0,this.eq=(n,i)=>this.compare(n,i)===0,this.neq=(n,i)=>this.compare(n,i)!==0,this.pow=(n,i)=>Math.pow(I(n),I(i)),this.addWithEpsilonRaw=(n,i)=>{const a=n+i;return Math.abs(a)<this.actualEps*Math.abs(n)?0:a},this.addWithEpsilon=(n,i)=>{const a=zo(n,i);return this.ExtendedNumberFactory(this.addWithEpsilonRaw(I(n),I(i)),a)},this.unaryMinus=n=>Ga(n,-I(n)),this.unaryPlus=n=>n,this.unaryPercent=n=>new Cs(I(n)/100),this.concat=(n,i)=>n.concat(i),this.nonstrictadd=(n,i)=>n instanceof p?n:i instanceof p?i:typeof n=="number"?typeof i=="number"?this.addWithEpsilonRaw(n,i):n:typeof i=="number"?i:0,this.subtract=(n,i)=>{const a=zo(n,i),o=I(n),u=I(i);let l=o-u;return Math.abs(l)<this.actualEps*Math.abs(o)&&(l=0),this.ExtendedNumberFactory(l,a)},this.divide=(n,i)=>{const a=I(n),o=I(i);if(o===0)return new p(m.DIV_BY_ZERO);{const u=$o(n,i);return this.ExtendedNumberFactory(a/o,u)}},this.multiply=(n,i)=>{const a=$o(n,i);return this.ExtendedNumberFactory(I(n)*I(i),a)},this.manyToExactComplex=n=>{const i=[];for(const a of n){if(a instanceof p)return a;if(X(a)||typeof a=="string"){const o=this.coerceScalarToComplex(a);o instanceof p||i.push(o)}}return i},this.coerceNumbersExactRanges=n=>this.manyToNumbers(n,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=n=>this.manyToNumbers(n,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=n=>{const i=[];for(const a of n){if(a instanceof p)return a;X(a)&&i.push(I(a))}return i},this.manyToOnlyNumbersDropNulls=n=>{const i=[];for(const a of n){if(a instanceof p)return a;if(X(a))i.push(I(a));else if(a!==B)return new p(m.VALUE,R.NumberExpected)}return i},this.manyToCoercedNumbersDropNulls=n=>{const i=[];for(const a of n){if(a instanceof p)return a;if(a===B)continue;const o=this.coerceScalarToNumberOrError(a);X(o)&&i.push(I(o))}return i},this.collator=DE(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const t=this.buildRegex(e);return r=>typeof r=="string"&&t.test(this.normalizeString(r))}neqMatcherFunction(e){const t=this.buildRegex(e);return r=>typeof r!="string"||!t.test(this.normalizeString(r))}searchString(e,t){var r;const i=this.buildRegex(e,!1).exec(t);return(r=i?.index)!==null&&r!==void 0?r:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let t=0;t<e.length;t++){const r=e.charAt(t);if(Wn(r)||this.config.useRegularExpressions&&Yn(r))return!0}return!1}floatCmp(e,t){const r=I(e),n=I(t),i=1+this.actualEps;return n>=0&&r*i>=n&&r<=n*i||n<=0&&r*i<=n&&r>=n*i?0:r>n?1:-1}coerceScalarToNumberOrError(e){var t;return e instanceof p?e:(t=this.coerceToMaybeNumber(e))!==null&&t!==void 0?t:new p(m.VALUE,R.NumberCoercion)}coerceToMaybeNumber(e){var t;return(t=this.coerceNonDateScalarToMaybeNumber(e))!==null&&t!==void 0?t:typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===B)return 0;if(typeof e=="string"){if(e==="")return 0;const t=this.coerceStringToMaybePercentNumber(e);if(t!==void 0)return t;const r=this.coerceStringToMaybeCurrencyNumber(e);return r!==void 0?r:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}else return X(e)?e:typeof e=="boolean"?Number(e):void 0}coerceStringToMaybePercentNumber(e){const t=e.trim();if(t.endsWith("%")){const r=t.slice(0,t.length-1).trim(),n=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(n!==void 0)return new Cs(n/100)}}coerceStringToMaybeCurrencyNumber(e){const t=this.currencyMatcher(e.trim());if(t!==void 0){const[r,n]=t,i=this.numberLiteralsHelper.numericStringToMaybeNumber(n);if(i!==void 0)return new ea(i,r)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length).trim()];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length).trim()]}}coerceComplexExactRanges(e){const t=[];for(const n of e)if(n instanceof w)t.push(n);else if(n!==B){const i=this.coerceScalarToComplex(n);if(i instanceof p)return i;t.push(i)}const r=[];for(const n of t)if(n instanceof w){const i=this.manyToExactComplex(n.valuesFromTopLeftCorner());if(i instanceof p)return i;r.push(...i)}else r.push(n);return r}coerceScalarToComplex(e){return e instanceof p?e:e===B?[0,0]:X(e)?[I(e),0]:typeof e=="string"?this.coerceStringToComplex(e):new p(m.NUM,R.ComplexNumberExpected)}ExtendedNumberFactory(e,t){const{type:r,format:n}=t;switch(r){case L.NUMBER_RAW:return e;case L.NUMBER_CURRENCY:return new ea(e,n??this.config.currencySymbol[0]);case L.NUMBER_DATE:return new Ha(e,n);case L.NUMBER_DATETIME:return new Ya(e,n);case L.NUMBER_TIME:return new Wa(e,n);case L.NUMBER_PERCENT:return new Cs(e,n)}}buildRegex(e,t=!0){e=this.normalizeString(e);let r,n=this.config.useWildcards,i=this.config.useRegularExpressions;if(i)try{RegExp(e)}catch{i=!1,n=!1}return i?r=zE(e,this.config.caseSensitive):n?r=WE(e,this.config.caseSensitive):r=YE(e,this.config.caseSensitive),this.config.matchWholeCell&&t?RegExp("^("+r+")$"):RegExp(r)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=Tl(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,t){if(typeof e=="string"||typeof t=="string"){const r=typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):e,n=typeof t=="string"?this.dateTimeHelper.dateStringToDateNumber(t):t;if(X(r)&&X(n))return this.floatCmp(r,n)}return e===B?e=Wo(t):t===B&&(t=Wo(e)),typeof e=="string"&&typeof t=="string"?this.stringCmp(e,t):typeof e=="boolean"&&typeof t=="boolean"?Yo(sa(e),sa(t)):X(e)&&X(t)?this.floatCmp(e,t):e===B&&t===B?0:Yo(Ho(Ks(e)),Ho(Ks(t)))}stringCmp(e,t){return this.collator.compare(e,t)}manyToNumbers(e,t){const r=[];for(const i of e)if(i instanceof w)r.push(i);else{const a=I(this.coerceScalarToNumberOrError(i));if(a instanceof p)return a;r.push(a)}const n=[];for(const i of r)if(i instanceof w){const a=t(i.valuesFromTopLeftCorner());if(a instanceof p)return a;n.push(...a)}else n.push(i);return n}coerceStringToComplex(e){const t=kE.exec(e);if(t===null)return new p(m.NUM,R.ComplexNumberExpected);let r;if(t[6]!==void 0?r=t[1]==="-"?[0,-1]:[0,1]:r=this.parseComplexToken(t[1]+t[3],t[5]),r instanceof p||t[8]===void 0)return r;let n;return t[14]!==void 0?n=t[9]==="-"?[0,-1]:[0,1]:n=this.parseComplexToken(t[9]+t[11],t[13]),n instanceof p?n:t[5]!==""||t[13]===""?new p(m.NUM,R.ComplexNumberExpected):t[8]==="+"?[r[0]+n[0],r[1]+n[1]]:[r[0]-n[0],r[1]-n[1]]}parseComplexToken(e,t){const r=I(this.coerceNonDateScalarToMaybeNumber(e));return r===void 0?new p(m.NUM,R.ComplexNumberExpected):t===""?[r,0]:[0,r]}}function ce([s,e],t){if(!isFinite(s)||!isFinite(e))return new p(m.NUM,R.NaN);if(t=t??BE,e===0)return`${s}`;const r=`${e===-1||e===1?"":Math.abs(e)}${t}`;return s===0?`${e<0?"-":""}${r}`:`${s}${e<0?"-":"+"}${r}`}function ml(s){return s instanceof w?s:w.fromScalar(s)}function sa(s){return Number(s)}function Wo(s){return typeof s=="string"?"":X(s)?0:typeof s=="boolean"?!1:B}function gl(s){if(s instanceof p||typeof s=="boolean")return s;if(s===B)return!1;if(X(s))return I(s)!==0;{const e=s.toUpperCase();return e==="TRUE"?!0:e==="FALSE"||e===""?!1:void 0}}function ia(s){return s instanceof p||typeof s=="string"?s:s===B?"":X(s)?I(s).toString():s?"TRUE":"FALSE"}function ss(s){return s===B?0:s}function Yo(s,e){const t=I(s),r=I(e);return t>r?1:t<r?-1:0}function El(s){return isNaN(s)||s===1/0||s===-1/0}function Rl(s){return s===0?0:s}function Wn(s){return["*","?"].includes(s)}const HE=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function Yn(s){return HE.includes(s)}function WE(s,e){let t="";for(let r=0;r<s.length;r++){const n=s.charAt(r);if(n==="~"){if(r==s.length-1){t+="~";continue}const i=s.charAt(r+1);Wn(i)||Yn(i)?(t+="\\"+i,r++):(t+=i,r++)}else Wn(n)?t+="."+n:Yn(n)?t+="\\"+n:e?t+=n:t+=n.toLowerCase()}return t}function YE(s,e){let t="";for(let r=0;r<s.length;r++){const n=s.charAt(r);Wn(n)||Yn(n)?t+="\\"+n:e?t+=n:t+=n.toLowerCase()}return t}function zE(s,e){let t="";for(let r=0;r<s.length;r++){const n=s.charAt(r);Wn(n)||Yn(n)||e?t+=n:t+=n.toLowerCase()}return t}function zo(s,e){const{type:t,format:r}=zs(s),{type:n,format:i}=zs(e);if(t===L.NUMBER_RAW)return{type:n,format:i};if(n===L.NUMBER_RAW)return{type:t,format:r};if((t===L.NUMBER_DATETIME||t===L.NUMBER_DATE)&&(n===L.NUMBER_DATETIME||n===L.NUMBER_DATE))return{type:L.NUMBER_RAW};if(t===L.NUMBER_TIME){if(n===L.NUMBER_DATE)return{type:L.NUMBER_DATETIME,format:`${i} ${r}`};if(n===L.NUMBER_DATETIME)return{type:L.NUMBER_DATETIME,format:i}}if(n===L.NUMBER_TIME){if(t===L.NUMBER_DATE)return{type:L.NUMBER_DATETIME,format:`${r} ${i}`};if(t===L.NUMBER_DATETIME)return{type:L.NUMBER_DATETIME,format:r}}return{type:t,format:r}}function $o(s,e){let{type:t,format:r}=zs(s),{type:n,format:i}=zs(e);return t===L.NUMBER_PERCENT&&(t=L.NUMBER_RAW,r=void 0),n===L.NUMBER_PERCENT&&(n=L.NUMBER_RAW,i=void 0),t===L.NUMBER_RAW?{type:n,format:i}:n===L.NUMBER_RAW?{type:t,format:r}:{type:L.NUMBER_RAW}}function Ln(s){return Tl(s.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function Os(s,e){var t;if(s.isAdHoc())return(t=s.data[0])===null||t===void 0?void 0:t[0];const r=s.range;if(e.formulaAddress.sheet===r.sheet){if(r.width()===1){const n=e.formulaAddress.row-r.start.row;if(n>=0&&n<r.height())return s.data[n][0]}else if(r.height()===1){const n=e.formulaAddress.col-r.start.col;if(n>=0&&n<r.width())return s.data[0][n]}}}function Tl(s,e){return s.normalize(e.toUpperCase())}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var h;(function(s){s.STRING="STRING",s.NUMBER="NUMBER",s.BOOLEAN="BOOLEAN",s.SCALAR="SCALAR",s.NOERROR="NOERROR",s.RANGE="RANGE",s.INTEGER="INTEGER",s.COMPLEX="COMPLEX",s.ANY="ANY"})(h||(h={}));class P{constructor(e){this.coerceScalarToNumberOrError=t=>this.arithmeticHelper.coerceScalarToNumberOrError(t),this.runFunction=(t,r,n,i)=>{const a=this.evaluateArguments(t,r,n),o=a.map(([N,E])=>N),u=a.map(([N,E])=>E),l=this.buildMetadataForEachArgumentValue(o.length,n),c=r.arraysFlag&&!n.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(l,o.length))return new p(m.NA,R.WrongArgNumber);const[d,f]=c?this.calculateSizeOfVectorizedResultArray(o,l):[1,1];if(d===1&&f===1){const N=this.vectorizeAndBroadcastArgumentsIfNecessary(c,o,l,0,0);return this.calculateSingleCellOfResultArray(r,N,l,u,i,n.returnNumberType)}const T=[...Array(d).keys()].map(N=>[...Array(f).keys()].map(E=>{const S=this.vectorizeAndBroadcastArgumentsIfNecessary(c,o,l,N,E),A=this.calculateSingleCellOfResultArray(r,S,l,u,i,n.returnNumberType);if(A instanceof w)throw new Error("Function returning array cannot be vectorized.");return A}));return w.onlyValues(T)},this.runFunctionWithReferenceArgument=(t,r,n,i,a,o=()=>new p(m.NA,R.CellRefExpected))=>{if(t.length===0)return this.returnNumberWrapper(i(),n.returnNumberType);if(t.length>1)return new p(m.NA,R.WrongArgNumber);let u=t[0];for(;u.type===g.PARENTHESIS;)u=u.expression;let l;if(u.type===g.CELL_REFERENCE)l=u.reference.toSimpleCellAddress(r.formulaAddress);else if(u.type===g.CELL_RANGE||u.type===g.COLUMN_RANGE||u.type===g.ROW_RANGE)try{l=F.fromAst(u,r.formulaAddress).start}catch{return new p(m.REF,R.CellRefExpected)}return l!==void 0?this.returnNumberWrapper(a(l),n.returnNumberType):this.runFunction(t,r,n,o)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,t){return this.interpreter.evaluateAst(e,t)}arraySizeForAst(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}listOfScalarValues(e,t){const r=[];for(const n of e){const i=this.evaluateAst(n,t);if(i instanceof w)for(const a of i.valuesFromTopLeftCorner())r.push([a,!0]);else r.push([i,!1])}return r}coerceToType(e,t,r){let n;if(e instanceof w)switch(t.argumentType){case h.RANGE:case h.ANY:n=e;break;default:{const i=Os(e,r);if(i===void 0)return;e=i}}if(!(e instanceof w))switch(t.argumentType){case h.INTEGER:case h.NUMBER:const i=this.coerceScalarToNumberOrError(e);if(!X(i)){n=i;break}const a=I(i);if(t.maxValue!==void 0&&a>t.maxValue)return new p(m.NUM,R.ValueLarge);if(t.minValue!==void 0&&a<t.minValue)return new p(m.NUM,R.ValueSmall);if(t.lessThan!==void 0&&a>=t.lessThan)return new p(m.NUM,R.ValueLarge);if(t.greaterThan!==void 0&&a<=t.greaterThan)return new p(m.NUM,R.ValueSmall);if(t.argumentType===h.INTEGER&&!Number.isInteger(a))return new p(m.NUM,R.IntegerExpected);n=i;break;case h.STRING:n=ia(e);break;case h.BOOLEAN:n=gl(e);break;case h.SCALAR:case h.NOERROR:case h.ANY:n=e;break;case h.RANGE:if(e instanceof p)return e;n=ml(e);break;case h.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(I(e))}return t.passSubtype||n===void 0?n:I(n)}calculateSingleCellOfResultArray(e,t,r,n,i,a){const o=this.coerceArgumentsToRequiredTypes(e,t,r,n);if(o instanceof p)return o;const u=i(...o);return this.returnNumberWrapper(u,a)}coerceArgumentsToRequiredTypes(e,t,r,n){const i=[];for(let a=0;a<r.length;a++){const o=r[a],u=t[a]!==void 0?t[a]:o?.defaultValue;if(u===void 0){i.push(void 0);continue}const l=this.coerceToType(u,o,e);if(l===void 0&&!n[a])return new p(m.VALUE,R.WrongType);if(l instanceof p&&o.argumentType!==h.SCALAR)return l;i.push(l)}return i}vectorizeAndBroadcastArgumentsIfNecessary(e,t,r,n,i){return t.map((a,o)=>e&&this.isRangePassedAsAScalarArgument(a,r[o])?this.vectorizeAndBroadcastRangeArgument(a,n,i):a)}vectorizeAndBroadcastRangeArgument(e,t,r){var n;const i=e.height()===1?0:t,a=e.width()===1?0:r;return(n=e.data[i])===null||n===void 0?void 0:n[a]}evaluateArguments(e,t,r){return r.expandRanges?this.listOfScalarValues(e,t):e.map(n=>[this.evaluateAst(n,t),!1])}buildMetadataForEachArgumentValue(e,t){const r=t.parameters?[...t.parameters]:[];if(t.repeatLastArgs!==void 0&&Number.isInteger(t.repeatLastArgs)&&t.repeatLastArgs>0)for(;e>r.length;)r.push(...r.slice(r.length-t.repeatLastArgs));return r}isNumberOfArgumentValuesValid(e,t){return t>e.length?!1:t<e.length?e.slice(t).every(i=>i?.optionalArg||i?.defaultValue!==void 0):!0}calculateSizeOfVectorizedResultArray(e,t){const r=e.filter((a,o)=>this.isRangePassedAsAScalarArgument(a,t[o])),n=Math.max(1,...r.map(a=>a.height())),i=Math.max(1,...r.map(a=>a.width()));return[n,i]}isRangePassedAsAScalarArgument(e,t){return e==null||t==null?!1:e instanceof w&&![h.RANGE,h.ANY].includes(t.argumentType)}metadata(e){const t=this.constructor.implementedFunctions[e];if(t!==void 0)return t;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,t,r){return t!==void 0&&X(e)?this.arithmeticHelper.ExtendedNumberFactory(I(e),{type:t,format:r}):e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class V{constructor(e,t,r=!1){this.width=e,this.height=t,this.isRef=r}static error(){return new V(1,1,!0)}static scalar(){return new V(1,1,!1)}isScalar(){return this.width===1&&this.height===1||this.isRef}}function $E(s,e){return new V(Math.max(s.width,e.width),Math.max(s.height,e.height))}function XE(s){return new V(s.width,s.height)}class KE{constructor(e,t){this.config=e,this.functionRegistry=t}checkArraySize(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,t){switch(e.type){case g.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case g.COLUMN_RANGE:case g.ROW_RANGE:case g.CELL_RANGE:{const r=F.fromAstOrUndef(e,t.formulaAddress);return r===void 0?V.error():new V(r.width(),r.height(),!0)}case g.ARRAY:{const r=[],n=[];for(const o of e.args){const u=o.map(d=>this.checkArraySizeForAst(d,t)),l=Math.min(...u.map(d=>d.height)),c=u.reduce((d,f)=>d+f.width,0);r.push(l),n.push(c)}const i=r.reduce((o,u)=>o+u,0),a=Math.min(...n);return new V(a,i)}case g.STRING:case g.NUMBER:return V.scalar();case g.CELL_REFERENCE:return new V(1,1,!0);case g.DIV_OP:case g.CONCATENATE_OP:case g.EQUALS_OP:case g.GREATER_THAN_OP:case g.GREATER_THAN_OR_EQUAL_OP:case g.LESS_THAN_OP:case g.LESS_THAN_OR_EQUAL_OP:case g.MINUS_OP:case g.NOT_EQUAL_OP:case g.PLUS_OP:case g.POWER_OP:case g.TIMES_OP:{const r=this.checkArraySizeForAst(e.left,t),n=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(r.height>1||r.width>1||n.height>1||n.width>1)?V.error():$E(r,n)}case g.MINUS_UNARY_OP:case g.PLUS_UNARY_OP:case g.PERCENT_OP:{const r=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(r.height>1||r.width>1)?V.error():XE(r)}case g.PARENTHESIS:return this.checkArraySizeForAst(e.expression,t);case g.EMPTY:return V.error();default:return V.error()}}checkArraySizeForFunction(e,t){const r=this.functionRegistry.getArraySizeFunction(e.procedureName);if(r!==void 0)return r(e,t);const n=this.functionRegistry.getMetadata(e.procedureName);if(n===void 0||n.expandRanges||!t.arraysFlag||n.vectorizationForbidden||n.parameters===void 0)return new V(1,1);const i=e.args.map(l=>{var c;return this.checkArraySizeForAst(l,new Bt(t.formulaAddress,t.arraysFlag||((c=n?.enableArrayArithmeticForArguments)!==null&&c!==void 0?c:!1)))}),a=[...n.parameters];if(n.repeatLastArgs!==void 0&&a.length<i.length&&(i.length-a.length)%n.repeatLastArgs!==0)return V.error();for(;a.length<i.length;){if(n.repeatLastArgs===void 0)return V.error();a.push(...a.slice(a.length-n.repeatLastArgs))}let o=1,u=1;for(let l=0;l<i.length;l++)a[l].argumentType!==h.RANGE&&a[l].argumentType!==h.ANY&&(u=Math.max(u,i[l].height),o=Math.max(o,i[l].width));return new V(o,u)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Nl{constructor(e,t,r){var n;this.value=t,this.address=r,this.type=e.type,this.message=(n=e.message)!==null&&n!==void 0?n:""}toString(){return this.value}valueOf(){return this.value}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function K(s,e,t){if(typeof s>"u")return st.defaultConfig[t];if(typeof e=="string"){if(typeof s===e)return s;throw new $(e,t)}else{if(e.includes(s))return s;throw new hl(e.map(r=>`'${r}'`).join(" "),t)}}function Yr(s,e,t){if(s<t)throw new ol(e,t)}function jE(s,e,t){if(s>t)throw new ul(e,t)}function is(s,e,t,r){if(e(s))return s;if(typeof s>"u")return st.defaultConfig[r];throw new $(t,r)}function Xo(...s){const e=new Map;s.forEach(r=>{const n=e.get(r.value)||[];n.push(r.name),e.set(r.value,n)});const t=[];for(const r of e.values())r.length>1&&t.push(r);if(t.length>0){t.forEach(n=>n.sort());const r=t.map(n=>`[${n}]`).join("; ");throw new Error(`Config initialization failed. Parameters in conflict: ${r}`)}}function v(s,e,t){if(typeof s!==e)throw new $(e,t)}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const Xa=new RegExp("^ss(\\.(s+|0+))?$"),qE=new RegExp("^[0-9/.\\-: ]+[ap]?m?$"),QE=new RegExp("\\s+"),Sl=new RegExp("[ /.-]"),aa=":",Ko=1e3,ZE=Al(tR),JE=Al(rR);function eR(s,e,t){if(e===void 0&&t===void 0)return;let r=s.replace(QE," ").trim().toLowerCase();if(!nR(r))return;let n=r.substring(r.length-2);n==="am"||n==="pm"?r=r.substring(0,r.length-2).trim():(n=r.substring(r.length-1),n==="a"||n==="p"?r=r.substring(0,r.length-1).trim():n=void 0);const i=r.split(Sl);i.length>=2&&i[i.length-2].includes(aa)&&(i[i.length-2]=i[i.length-2]+"."+i[i.length-1],i.pop());const a=i[i.length-1].split(aa);if(n!==void 0&&a.push(n),i.length===1)return jo(a,t);if(a.length===1)return qo(i,e);const o=qo(i.slice(0,i.length-1),e),u=jo(a,t);if(o!==void 0)return u===void 0?void 0:Object.assign(Object.assign({},o),u)}function jo(s,e){var t,r,n;if(e===void 0)return;const{itemsCount:i,hourItem:a,minuteItem:o,secondItem:u}=ZE(e);let l;if(s[s.length-1]==="am"||s[s.length-1]==="a"?(l=!1,s.pop()):(s[s.length-1]==="pm"||s[s.length-1]==="p")&&(l=!0,s.pop()),s.length!==i)return;const c=Number((t=s[u])!==null&&t!==void 0?t:"0");if(!Number.isFinite(c))return;const d=Math.round(c*Ko)/Ko,f=Number((r=s[o])!==null&&r!==void 0?r:"0");if(!(Number.isFinite(f)&&Number.isInteger(f)))return;const T=Number((n=s[a])!==null&&n!==void 0?n:"0");return!(Number.isFinite(T)&&Number.isInteger(T))||l!==void 0&&(T<0||T>12)?void 0:{hours:l!==void 0?T%12+(l?12:0):T,minutes:f,seconds:d}}function qo(s,e){var t;if(e===void 0)return;const{itemsCount:r,dayItem:n,monthItem:i,shortYearItem:a,longYearItem:o}=JE(e);if(s.length!==r)return;const u=Number(s[n]);if(!(Number.isFinite(u)&&Number.isInteger(u)))return;const l=Number(s[i]);if(!(Number.isFinite(l)&&Number.isInteger(l))||s[o]&&s[a])return;const c=Number((t=s[o])!==null&&t!==void 0?t:s[a]);if(Number.isFinite(c)&&Number.isInteger(c)&&!(s[o]&&(c<1e3||c>9999))&&!(s[a]&&(c<0||c>99)))return{year:c,month:l,day:u}}function tR(s){const e=s.toLowerCase().trim(),r=(e.endsWith("am/pm")?e.substring(0,e.length-5):e.endsWith("a/p")?e.substring(0,s.length-3):e).trim().split(aa);return{itemsCount:r.length,hourItem:r.indexOf("hh"),minuteItem:r.indexOf("mm"),secondItem:r.findIndex(n=>Xa.test(n))}}function rR(s){const e=s.toLowerCase().trim().split(Sl);return{itemsCount:e.length,dayItem:e.indexOf("dd"),monthItem:e.indexOf("mm"),shortYearItem:e.indexOf("yy"),longYearItem:e.indexOf("yyyy")}}function nR(s){return qE.test(s)}function Al(s){const e={};return t=>{const r=e[t];if(r!==void 0)return r;const n=s(t);return e[t]=n,n}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const oa=[31,28,31,30,31,30,31,31,30,31,30,31],nn=[0,31,59,90,120,151,181,212,243,273,304,334],as=60,os=60,ua=24;function Fn(s){return s&&(typeof s=="object"||typeof s=="function")?"year"in s&&typeof s.year=="number"&&"month"in s&&typeof s.month=="number"&&"day"in s&&typeof s.day=="number":!1}function yl(s){return s&&(typeof s=="object"||typeof s=="function")?"hours"in s&&typeof s.hours=="number"&&"minutes"in s&&typeof s.minutes=="number"&&"seconds"in s&&typeof s.seconds=="number":!1}const sR={year:9999,month:12,day:31};class iR{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(sR),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){const{dateTime:t,dateFormat:r="",timeFormat:n=""}=this.parseDateTimeFromConfigFormats(e);if(t!==void 0)return yl(t)?Fn(t)?new Ya(hn(t)+this.dateToNumber(t),r+" "+n):new Wa(hn(t),n):Fn(t)?new Ha(this.dateToNumber(t),r):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1?!1:this.isLeapYear(e.year)&&e.month===2?e.day<=29:e.day<=oa[e.month-1]}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){const t=Math.floor(e)+this.minDateAbsoluteValue;let r=Math.floor(t/365.2425);this.dateToNumberFromZero({year:r+1,month:1,day:1})<=t?r++:this.dateToNumberFromZero({year:r-1,month:1,day:1})>t&&r--;const n=t-this.dateToNumberFromZero({year:r,month:1,day:1}),i=aR(n-(this.isLeapYear(r)&&n>=59?1:0)),a=n-nn[i]-(this.isLeapYear(r)&&i>1?1:0);return{year:r,month:i+1,day:a+1}}numberToSimpleDateTime(e){const t=un(e%1),r=Math.floor(t.hours/ua);t.hours=t.hours%ua;const n=this.numberToSimpleDate(Math.floor(e)+r);return Object.assign(Object.assign({},n),t)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,t){return this.isLeapYear(e)&&t===2?29:oa[t-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,t){return e.day===31&&(e.day=30),e.day===30&&t.day===31&&(t.day=30),e.month===2&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,t.month===2&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}yearLengthForBasis(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,t,r){const n=this.parseDateTime(e,t,r);if(!(Fn(n)&&(n.year>=0&&n.year<100&&(n.year<this.getNullYear()?n.year+=2e3:n.year+=1900),!this.isValidDate(n))))return n}parseDateTimeFromFormats(e,t,r){const n=t.length===0?[void 0]:t,i=r.length===0?[void 0]:r;for(const a of n)for(const o of i){const u=this.parseSingleFormat(e,a,o);if(u!==void 0)return{dateTime:u,timeFormat:o,dateFormat:a}}return{}}countLeapDays(e){return e.month>2||e.month===2&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+nn[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return e%4?!1:e%100?!0:e%400?e===1900&&this.config.leapYear1900:!0}}function aR(s){let e=0;return nn[e+6]<=s&&(e+=6),nn[e+3]<=s&&(e+=3),nn[e+2]<=s?e+=2:nn[e+1]<=s&&(e+=1),e}function Qo(s,e){const t=12*s.year+s.month-1+e;return{year:Math.floor(t/12),month:t%12+1,day:s.day}}function oR(s){return{year:s.year,month:s.month,day:Math.min(s.day,oa[s.month-1])}}function Fi(s){return Math.round(s*3600*24)/(3600*24)}function uR(s,e=1){return Math.round(s*e)/e}function un(s){const e=s*ua*os*as,t=uR(e%as,1e5)%as,r=(e-t)/as,n=Math.round(r%os)%os,i=(r-n)/os;return{hours:Math.round(i),minutes:n,seconds:t}}function hn(s){return((s.seconds/60+s.minutes)/60+s.hours)/24}function Zo(s){return{year:s.year,month:s.month,day:Math.min(30,s.day)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class hR{call(){return wE}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const Jo=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,eu=/(\\.|[#0]+(\.[#0]*)?)/g;var Dt;(function(s){s.FORMAT="FORMAT",s.FREE_TEXT="FREE_TEXT"})(Dt||(Dt={}));function us(s,e){return{type:s,value:e}}var js;(function(s){s.DATE="DATE",s.NUMBER="NUMBER",s.STRING="STRING"})(js||(js={}));function lR(s){Jo.lastIndex=0;const e=[];let t;do t=Jo.exec(s),t!==null&&e.push(t);while(t);return e}function cR(s){eu.lastIndex=0;const e=eu.exec(s);return e!==null?[e]:[]}function Cl(s,e){const t=[];let r=0;for(let i=0;i<s.length;++i){const a=s[i];if(a.index!==r){const o=e.substr(r,a.index-r);t.push(us(Dt.FREE_TEXT,o))}a[0].startsWith("\\")?t.push(us(Dt.FREE_TEXT,a[0])):t.push(us(Dt.FORMAT,a[0])),r=a.index+a[0].length}const n=s[s.length-1];if(n.index+n[0].length<e.length){const i=e.substr(n.index+n[0].length,e.length);t.push(us(Dt.FREE_TEXT,i))}return t}function vl(s){const e=lR(s);if(!e.every(t=>Il(t)))return{type:js.DATE,tokens:Cl(e,s)}}function dR(s){const e=cR(s);if(!e.every(t=>Il(t)))return{type:js.NUMBER,tokens:Cl(e,s)}}function Il(s){return s[0].startsWith("\\")}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function pR(s,e,t,r){const n=t.stringifyDateTime(r.numberToSimpleDateTime(s),e);if(n!==void 0)return n;const i=t.stringifyDuration(un(s),e);if(i!==void 0)return i;const a=dR(e);return a!==void 0?mR(a.tokens,s):e}function Ye(s,e){let t=`${s}`;for(;t.length<e;)t="0"+t;return t}function fR(s,e){let t=`${s}`;for(;t.length<e;)t=t+"0";return t}function tu(s,e){return s.split(e).length-1}function mR(s,e){let t="";for(let r=0;r<s.length;++r){const n=s[r];if(n.type===Dt.FREE_TEXT){t+=n.value;continue}const i=n.value.split("."),a=i[0],o=i[1]||"",u=i[1]?".":"",l=Number(e.toFixed(o.length)).toString().split(".");let c=l[0]||"",d=l[1]||"";if(a.length>c.length){const T=tu(a.substr(0,a.length-c.length),"0");c=Ye(c,T+c.length)}const f=tu(o.substr(d.length,o.length-d.length),"0");d=fR(d,f+d.length),t+=c+u+d}return t}function gR(s,e){const t=vl(e);if(t===void 0)return;const r=t.tokens;let n="";for(const i of r){if(i.type===Dt.FREE_TEXT){n+=i.value;continue}switch(i.value.toLowerCase()){case"h":case"hh":{n+=Ye(s.hours,i.value.length),s.hours=0;break}case"[hh]":{n+=Ye(s.hours,i.value.length-2),s.hours=0;break}case"m":case"mm":{n+=Ye(s.minutes,i.value.length),s.minutes=0;break}case"[mm]":{n+=Ye(s.minutes+60*s.hours,i.value.length-2),s.minutes=0,s.hours=0;break}case"s":case"ss":{n+=Ye(Math.floor(s.seconds),i.value.length);break}default:{if(Xa.test(i.value)){const a=Math.max(i.value.length-3,0);n+=`${s.seconds<10?"0":""}${Math.floor(s.seconds*Math.pow(10,a))/Math.pow(10,a)}`;continue}return}}}return n}function ER(s,e){const t=vl(e);if(t===void 0)return;const r=t.tokens;let n="",i=!1;const a=r.some(o=>o.type===Dt.FORMAT&&(o.value==="a/p"||o.value==="A/P"||o.value==="am/pm"||o.value==="AM/PM"));for(let o=0;o<r.length;o++){const u=r[o];if(u.type===Dt.FREE_TEXT){n+=u.value;continue}switch(u.value.toLowerCase()){case"h":case"hh":{i=!0,n+=Ye(a?(s.hours+11)%12+1:s.hours,u.value.length);break}case"d":case"dd":{n+=Ye(s.day,u.value.length);break}case"s":case"ss":{n+=Ye(Math.floor(s.seconds),u.value.length);break}case"m":case"mm":{o+1<r.length&&r[o+1].value.startsWith(":")&&(i=!0),i?n+=Ye(s.minutes,u.value.length):n+=Ye(s.month,u.value.length),i=!0;break}case"yy":{n+=Ye(s.year%100,u.value.length);break}case"yyyy":{n+=s.year;break}case"am/pm":case"a/p":{const[l,c]=u.value.split("/");n+=s.hours<12?l:c;break}default:{if(Xa.test(u.value)){const l=u.value.length-3;n+=`${s.seconds<10?"0":""}${Math.floor(s.seconds*Math.pow(10,l))/Math.pow(10,l)}`;continue}return}}}return n}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const ha="length",Un=s=>parseInt(s,16),ru=s=>parseInt(s,10),Ui=s=>(s+"").replace(/\-/g,""),qs=(s,e,t)=>s.substr(e,t),At=s=>s.codePointAt(0)-65;function RR(s){return Ui(s)[ha]===25?Un(qs(Ui(s),Un("12"),At("F")))/(Un(qs(Ui(s),At("C"),At("Y")>>4))||(~~![][ha]<<3)+1):0}function TR(s){if(s=(s+"").replace(/\-/g,""),s[ha]!==At("Z"))return!1;let e=0;return[[0,At("G")+1],[At("H"),At("H")-1],[At("G")+At("H"),At("G")]].reduce((t,[r,n],i)=>(t|=(ru(`${ru(Un(qs(s,e+r-(i===0?0:2),n+(i?2:0)))+(Un(qs(s,e+r+n,2))+[]).padStart(2,"0"))}`)%97||2)>>1,e+=2,t),At("A"))==="1">>1}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const NR={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:s})=>`The license key for HyperFormula expired on ${s}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let nu=!1;function SR(s){const e={template:"missing",vars:{}};if(s==="gpl-v3"||s==="internal-use-in-handsontable")e.template="valid";else if(typeof s=="string"&&TR(s)){const[t,r,n]="14/10/2025".split("/"),i=Math.floor(new Date(`${r}/${t}/${n}`).getTime()/864e5),a=RR(s);e.vars.keyValidityDate=AR(new Date((a+1)*864e5)),i>a?e.template="expired":e.template="valid"}else s!==""&&(e.template="invalid");return!nu&&e.template!=="valid"&&(console.warn(NR[e.template](e.vars)),nu=!0),e.template}function AR(s){const t=["January","February","March","April","May","June","July","August","September","October","November","December"][s.getMonth()],r=s.getDate(),n=s.getFullYear();return`${t} ${r}, ${n}`}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var se;(function(s){class e{constructor(u){this.value=u,this.value=Ga(this.value,Rl(I(this.value)))}}s.Number=e;class t{constructor(u){this.value=u}}s.String=t;class r{constructor(u){this.value=u}}s.Boolean=r;class n{static getSingletonInstance(){return n.instance||(n.instance=new n),n.instance}}s.Empty=n;class i{constructor(u){this.formula=u}}s.Formula=i;class a{constructor(u,l){this.value=new p(u,l)}}s.Error=a})(se||(se={}));function yR(s){return s.startsWith("=")}function CR(s){const e=s.toLowerCase();return e==="true"||e==="false"}function vR(s,e){const t=s.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(t)&&Object.prototype.hasOwnProperty.call(e,t)}class IR{constructor(e,t,r){this.config=e,this.dateHelper=t,this.numberLiteralsHelper=r}parse(e){if(e==null)return se.Empty.getSingletonInstance();if(typeof e=="number")return El(e)?new se.Error(m.NUM,R.ValueLarge):new se.Number(e);if(typeof e=="boolean")return new se.Boolean(e);if(e instanceof Date){const t=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}),r=hn({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3}),n=t+r;return n<0?new se.Error(m.NUM,R.DateBounds):n%1===0?new se.Number(new Ha(n,"Date()")):n<1?new se.Number(new Wa(n,"Date()")):new se.Number(new Ya(n,"Date()"))}else if(typeof e=="string"){if(CR(e))return new se.Boolean(e.toLowerCase()==="true");if(yR(e))return new se.Formula(e);if(vR(e,this.config.errorMapping))return new se.Error(this.config.errorMapping[e.toUpperCase()]);{let t=e.trim(),r=0,n;if(t.endsWith("%"))r=1,t=t.slice(0,t.length-1);else{const o=this.currencyMatcher(t);o!==void 0&&(r=2,[n,t]=o)}const i=this.numberLiteralsHelper.numericStringToMaybeNumber(t);if(i!==void 0){let o;return r===1?o=new Cs(i/100):r===2?o=new ea(i,n):o=i,new se.Number(o)}const a=this.dateHelper.dateStringToDateNumber(t);return a!==void 0?new se.Number(a):new se.String(e.startsWith("'")?e.slice(1):e)}}else throw new al(e)}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length)];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length)]}}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var vr;(function(s){s[s.COPY=0]="COPY",s[s.CUT=1]="CUT"})(vr||(vr={}));var Le;(function(s){s[s.VALUE=0]="VALUE",s[s.EMPTY=1]="EMPTY",s[s.FORMULA=2]="FORMULA",s[s.PARSING_ERROR=3]="PARSING_ERROR"})(Le||(Le={}));class su{constructor(e,t,r,n,i){this.sourceLeftCorner=e,this.width=t,this.height=r,this.type=n,this.content=i}*getContent(e){if(this.content!==void 0)for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r)yield[O(e.sheet,e.col+r,e.row+t),this.content[t][r]]}}class OR{constructor(e,t,r){this.dependencyGraph=t,this.operations=r,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,t,r){this.clipboard=new su(e,t,r,vr.CUT)}copy(e,t,r){const n=[];for(let i=0;i<r;++i){n[i]=[];for(let a=0;a<t;++a){const o=this.operations.getClipboardCell(O(e.sheet,e.col+a,e.row+i));n[i].push(o)}}this.clipboard=new su(e,t,r,vr.COPY,n)}abortCut(){this.clipboard&&this.clipboard.type===vr.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(this.clipboard===void 0)return;if($e(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new Te("a valid target address.");const t=F.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Mr;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new Error("It is not possible to paste onto an array")}isCutClipboard(){return this.clipboard!==void 0&&this.clipboard.type===vr.CUT}isCopyClipboard(){return this.clipboard!==void 0&&this.clipboard.type===vr.COPY}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Qs{constructor(e,t,r,n){this.displayName=e,this.address=t,this.added=r,this.options=n}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new Qs(this.displayName,this.address,this.added,this.options)}}class MR{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);return!(r&&r.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){const t=this.mapping.get(this.normalizeExpressionName(e));if(t&&t.added)return t}remove(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);r&&(r.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}normalizeExpressionName(e){return e.toLowerCase()}}class iu{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}isNameAvailable(e){const t=this.normalizeExpressionName(e);return!this.mapping.has(t)}remove(e){const t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}normalizeExpressionName(e){return e.toLowerCase()}}class Ur{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new MR,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,t){var r,n;return t===void 0?this.workbookStore.isNameAvailable(e):(n=(r=this.worksheetStore(t))===null||r===void 0?void 0:r.isNameAvailable(e))!==null&&n!==void 0?n:!0}namedExpressionInAddress(e){const t=this.addressCache.get(e);if(t&&t.added)return t}namedExpressionForScope(e,t){var r;return t===void 0?this.workbookStore.getExisting(e):(r=this.worksheetStore(t))===null||r===void 0?void 0:r.get(e)}nearestNamedExpression(e,t){var r,n;return(n=(r=this.worksheetStore(t))===null||r===void 0?void 0:r.get(e))!==null&&n!==void 0?n:this.workbookStore.getExisting(e)}isExpressionInScope(e,t){var r,n;return(n=(r=this.worksheetStore(t))===null||r===void 0?void 0:r.has(e))!==null&&n!==void 0?n:!1}isNameValid(e){const t=new RegExp(`^${Hu}$`),r=new RegExp(`^${Wu}$`),n=new RegExp(`^${Yu}$`);return t.test(e)||r.test(e)?!1:n.test(e)}addNamedExpression(e,t,r){const n=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);let i=n.get(e);return i!==void 0?(i.added=!0,i.displayName=e,i.options=r):(i=new Qs(e,this.nextAddress(),!0,r),n.add(i)),this.addressCache.set(i.address.row,i),i}restoreNamedExpression(e,t){const r=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,r.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,t){var r;return(r=this.worksheetStoreOrCreate(t).get(e))!==null&&r!==void 0?r:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let t=this.workbookStore.get(e);return t===void 0&&(t=new Qs(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}remove(e,t){let r;t===void 0?r=this.workbookStore:r=this.worksheetStore(t);const n=r?.get(e);if(r===void 0||n===void 0||!n.added)throw Error("Named expression does not exist");r.remove(e),r instanceof iu&&r.mapping.size===0&&this.worksheetStores.delete(t),this.addressCache.delete(n.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter(({scope:t})=>t===e).map(t=>t.expression.displayName)}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map(e=>e.expression.displayName)}getAllNamedExpressions(){const e=[];return this.workbookStore.getAllNamedExpressions().forEach(t=>{e.push({expression:t,scope:void 0})}),this.worksheetStores.forEach((t,r)=>{t.getAllNamedExpressions().forEach(n=>{e.push({expression:n,scope:r})})}),e}getAllNamedExpressionsForScope(e){var t,r;return e===void 0?this.workbookStore.getAllNamedExpressions():(r=(t=this.worksheetStores.get(e))===null||t===void 0?void 0:t.getAllNamedExpressions())!==null&&r!==void 0?r:[]}worksheetStoreOrCreate(e){let t=this.worksheetStores.get(e);return t||(t=new iu,this.worksheetStores.set(e,t)),t}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return O(Ur.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}Ur.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const ir=s=>{switch(s.type){case g.EMPTY:case g.NUMBER:case g.STRING:case g.ERROR:case g.ERROR_WITH_RAW_INPUT:return!1;case g.CELL_REFERENCE:return!s.reference.isAbsolute();case g.CELL_RANGE:case g.COLUMN_RANGE:case g.ROW_RANGE:return!s.start.isAbsolute();case g.NAMED_EXPRESSION:return!1;case g.PERCENT_OP:case g.PLUS_UNARY_OP:case g.MINUS_UNARY_OP:return ir(s.value);case g.CONCATENATE_OP:case g.EQUALS_OP:case g.NOT_EQUAL_OP:case g.LESS_THAN_OP:case g.GREATER_THAN_OP:case g.LESS_THAN_OR_EQUAL_OP:case g.GREATER_THAN_OR_EQUAL_OP:case g.MINUS_OP:case g.PLUS_OP:case g.TIMES_OP:case g.DIV_OP:case g.POWER_OP:return ir(s.left)||ir(s.right);case g.PARENTHESIS:return ir(s.expression);case g.FUNCTION_CALL:return s.args.some(e=>ir(e));case g.ARRAY:return s.args.some(e=>e.some(t=>ir(t)))}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Er{performEagerTransformations(e,t){for(const r of e.arrayFormulaNodes()){const[n,i]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService)),a=t.rememberNewAst(n);r.setFormula(a),r.setAddress(i)}}transformSingleAst(e,t){const r=this.transformAst(e,t),n=this.fixNodeAddress(t);return[r,n]}transformAst(e,t){switch(e.type){case g.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case g.CELL_RANGE:return this.transformCellRangeAst(e,t);case g.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case g.ROW_RANGE:return this.transformRowRangeAst(e,t);case g.EMPTY:case g.ERROR:case g.NUMBER:case g.NAMED_EXPRESSION:case g.ERROR_WITH_RAW_INPUT:case g.STRING:return e;case g.PERCENT_OP:case g.MINUS_UNARY_OP:case g.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case g.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(r=>this.transformAst(r,t))});case g.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case g.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(r=>r.map(n=>this.transformAst(n,t)))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}transformCellReferenceAst(e,t){const r=this.transformCellAddress(e.reference,t);return r instanceof ee?Object.assign(Object.assign({},e),{reference:r}):r===m.REF?xt(new p(m.REF)):e}transformCellRangeAst(e,t){const r=this.transformCellRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===m.REF?xt(new p(m.REF)):e}transformColumnRangeAst(e,t){const r=this.transformColumnRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===m.REF?xt(new p(m.REF)):e}transformRowRangeAst(e,t){const r=this.transformRowRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===m.REF?xt(new p(m.REF)):e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class wR extends Er{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){const r=Mt(e,t);if(r!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;const n=e.toSimpleColumnAddress(t);return r===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=n.col?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1:t.sheet===this.columnsSpan.sheet&&r!==this.columnsSpan.sheet?e.isColumnAbsolute()||t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?e.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){const n=this.transformCellAddress(e,r),i=this.transformCellAddress(t,r);return n===m.REF||i===m.REF?m.REF:n||i?[n||e,i||t]:!1}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class la extends Er{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}transformCellAddress(e,t){const r=Mt(e,t);if(r!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;const n=e.toSimpleRowAddress(t);return r===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=n.row?e.shiftedByRows(this.rowsSpan.numberOfRows):!1:t.sheet===this.rowsSpan.sheet&&r!==this.rowsSpan.sheet?e.isRowAbsolute()||t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?e.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(this.rowsSpan.numberOfRows):n.row<this.rowsSpan.rowStart?t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart?e.shiftedByRows(this.rowsSpan.numberOfRows):!1}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){const n=this.transformCellAddress(e,r),i=this.transformCellAddress(t,r);return n===m.REF||i===m.REF?m.REF:n||i?[n||e,i||t]:!1}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class _R extends Er{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return e.isInvalid(t)?m.REF:!1}transformCellRange(e,t,r){return e.isInvalid(r)||t.isInvalid(r)?m.REF:!1}transformColumnRange(e,t,r){return e.isInvalid(r)||t.isInvalid(r)?m.REF:!1}transformRowRange(e,t,r){return e.isInvalid(r)||t.isInvalid(r)?m.REF:!1}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class LR extends Er{constructor(e,t,r,n){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=n,this.dependentFormulaTransformer=new FR(e,t,r,n)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,t){return this.sourceRange.addressInRange(t)?[this.transformAst(e,t),this.fixNodeAddress(t)]:this.dependentFormulaTransformer.transformSingleAst(e,t)}fixNodeAddress(e){return O(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,t){return this.transformAddress(e,t)}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformAddress(e,t){const r=this.sourceRange;if(e instanceof ee){const n=e.toSimpleCellAddress(t);if(r.addressInRange(n))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,t,r){const n=this.sourceRange;if(e instanceof ee&&t instanceof ee){const i=e.toSimpleCellAddress(r),a=t.toSimpleCellAddress(r);if(n.addressInRange(i)&&n.addressInRange(a))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class FR extends Er{constructor(e,t,r,n){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=n}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.shouldMove(e,t)?e.moved(this.toSheet,this.toRight,this.toBottom):!1}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}shouldMove(e,t){return e instanceof ee?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof Ve?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}transformRange(e,t,r){const n=this.transformCellAddress(e,r),i=this.transformCellAddress(t,r);return n&&i?[n,i]:!1}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class UR extends Er{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){const r=Mt(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==r)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===r){const n=e.toSimpleColumnAddress(t);if(n.col<this.columnsSpan.columnStart)return!1;if(n.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==r){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===r)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{const n=e.toSimpleColumnAddress(t);if(n.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(n.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return m.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){const n=Mt(e,r);let i=e,a=t;if(this.columnsSpan.sheet===n){const l=e.toSimpleColumnAddress(r),c=t.toSimpleColumnAddress(r);if(this.columnsSpan.columnStart<=l.col&&this.columnsSpan.columnEnd>=c.col)return m.REF;l.col>=this.columnsSpan.columnStart&&l.col<=this.columnsSpan.columnEnd&&(i=e.shiftedByColumns(this.columnsSpan.columnEnd-l.col+1)),c.col>=this.columnsSpan.columnStart&&c.col<=this.columnsSpan.columnEnd&&(a=t.shiftedByColumns(-(c.col-this.columnsSpan.columnStart+1)))}const o=this.transformCellAddress(i,r),u=this.transformCellAddress(a,r);if(o===!1&&u===!1)return[i,a];if(o===m.REF||u===m.REF)throw Error("Cannot happen");return[o||i,u||a]}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ca extends Er{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,t){return e}transformCellAddress(e,t){const r=Mt(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==r)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===r){const n=e.toSimpleRowAddress(t);if(n.row<this.rowsSpan.rowStart)return!1;if(n.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==r){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===r)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{const n=e.toSimpleRowAddress(t);if(n.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(n.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return m.REF}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){const n=Mt(e,r);let i=e,a=t;if(this.rowsSpan.sheet===n){const l=e.toSimpleRowAddress(r),c=t.toSimpleRowAddress(r);if(this.rowsSpan.rowStart<=l.row&&this.rowsSpan.rowEnd>=c.row)return m.REF;l.row>=this.rowsSpan.rowStart&&l.row<=this.rowsSpan.rowEnd&&(i=e.shiftedByRows(this.rowsSpan.rowEnd-l.row+1)),c.row>=this.rowsSpan.rowStart&&c.row<=this.rowsSpan.rowEnd&&(a=t.shiftedByRows(-(c.row-this.rowsSpan.rowStart+1)))}const o=this.transformCellAddress(i,r),u=this.transformCellAddress(a,r);return o===!1&&u===!1?[i,a]:o===m.REF||u===m.REF?m.REF:[o||i,u||a]}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class bR extends Er{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,t){for(const r of e.arrayFormulaNodes()){const[n]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService));r.setFormula(n)}}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.transformAddress(e)}transformCellRange(e,t,r){return this.transformAddress(e)}transformColumnRange(e,t,r){return this.transformAddress(e)}transformRowRange(e,t,r){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet?m.REF:!1}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function Ol(s){if(!Array.isArray(s))throw new Te("an array of arrays.");for(let e=0;e<s.length;e++)if(!Array.isArray(s[e]))throw new Te("an array of arrays.")}function Zs(s){let e=0,t=0,r=0;for(let i=0;i<s.length;i++){let a=0;for(let o=0;o<s[i].length;o++){const u=s[i][o];u!=null&&(a=o+1,++r)}e=Math.max(e,a),a>0&&(t=i+1)}const n=e*t;return{height:t,width:e,fill:n===0?0:r/n}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Ml{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return Js(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>Xe.fromNumberOfRows(this.sheet,e[0],e[1]))}}class wl{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return ei(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>Xe.fromNumberOfRows(this.sheet,e[0],e[1]))}}class _l{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return ei(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>rt.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class Ll{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return Js(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>rt.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class xR{constructor(e,t,r,n,i,a,o,u,l){this.dependencyGraph=t,this.columnSearch=r,this.cellContentParser=n,this.parser=i,this.stats=a,this.lazilyTransformingAstService=o,this.namedExpressions=u,this.arraySizePredictor=l,this.changes=lr.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){const t=[];for(const r of e.rowsSpans()){const n=this.doRemoveRows(r);n&&t.push(n)}return t}addRows(e){for(const t of e.rowsSpans())this.doAddRows(t)}addColumns(e){for(const t of e.columnsSpans())this.doAddColumns(t)}removeColumns(e){const t=[];for(const r of e.columnsSpans()){const n=this.doRemoveColumns(r);n&&t.push(n)}return t}removeSheet(e){this.dependencyGraph.removeSheet(e);let t=0;this.stats.measure(x.TRANSFORM_ASTS,()=>{const n=new bR(e);n.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(n)}),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);const r=this.namedExpressions.getAllNamedExpressionsForScope(e).map(n=>this.removeNamedExpression(n.normalizeExpressionName(),e));return{version:t,scopedNamedExpressions:r}}removeSheetByName(e){const t=this.sheetMapping.fetch(e);return this.removeSheet(t)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){const t=this.sheetMapping.addSheet(e),r=[];return this.dependencyGraph.addressMapping.autoAddSheet(t,Zs(r)),this.sheetMapping.fetchDisplayName(t)}renameSheet(e,t){return this.sheetMapping.renameSheet(e,t)}moveRows(e,t,r,n){const i=Xe.fromNumberOfRows(e,n,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(i),n<t&&(t+=r);const a=O(e,0,t),o=O(e,0,n);this.moveCells(a,Number.POSITIVE_INFINITY,r,o);const u=Xe.fromNumberOfRows(e,t,r);return this.doRemoveRows(u),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,t,r,n){const i=rt.fromNumberOfColumns(e,n,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(i),n<t&&(t+=r);const a=O(e,t,0),o=O(e,n,0);this.moveCells(a,r,Number.POSITIVE_INFINITY,o);const u=rt.fromNumberOfColumns(e,t,r);return this.doRemoveColumns(u),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,t,r,n){this.ensureItIsPossibleToMoveCells(e,t,r,n);const i=F.spanFrom(e,t,r),a=F.spanFrom(n,t,r),o=n.col-e.col,u=n.row-e.row,l=n.sheet,c=this.getRangeClipboardCells(a),d=this.dependencyGraph.rawValuesFromRange(a);this.columnSearch.removeValues(d);const f=this.dependencyGraph.rawValuesFromRange(i);this.columnSearch.moveValues(f,o,u,l);let T=0;this.stats.measure(x.TRANSFORM_ASTS,()=>{const E=new LR(i,o,u,l);E.performEagerTransformations(this.dependencyGraph,this.parser),T=this.lazilyTransformingAstService.addTransformation(E)}),this.dependencyGraph.moveCells(i,o,u,l);const N=this.updateNamedExpressionsForMovedCells(e,t,r,n);return{version:T,overwrittenCellsData:c,addedGlobalNamedExpressions:N}}setRowOrder(e,t){const r=[];let n=[];for(const[i,a]of t)if(i!==a){const o=F.spanFrom({sheet:e,col:0,row:i},1/0,1),u=this.getRangeClipboardCells(o);n=n.concat(u),r.push(u.map(([{sheet:l,col:c},d])=>[{sheet:l,col:c,row:a},d]))}return r.forEach(i=>this.restoreClipboardCells(e,i.values())),n}setColumnOrder(e,t){const r=[];let n=[];for(const[i,a]of t)if(i!==a){const o=F.spanFrom({sheet:e,col:i,row:0},1,1/0),u=this.getRangeClipboardCells(o);n=n.concat(u),r.push(u.map(([{sheet:l,col:c,row:d},f])=>[{sheet:l,col:a,row:d},f]))}return r.forEach(i=>this.restoreClipboardCells(e,i.values())),n}addNamedExpression(e,t,r,n){const i=this.namedExpressions.addNamedExpression(e,r,n);this.storeNamedExpressionInCell(i.address,t),this.adjustNamedExpressionEdges(i,e,r)}restoreNamedExpression(e,t,r){const n=e.displayName;this.restoreCell(e.address,t);const i=this.namedExpressions.restoreNamedExpression(e,r);this.adjustNamedExpressionEdges(i,n,r)}changeNamedExpressionExpression(e,t,r,n){const i=this.namedExpressions.namedExpressionForScope(e,r);if(!i)throw new kn(e);const a=i.copy();i.options=n;const o=this.getClipboardCell(i.address);return this.storeNamedExpressionInCell(i.address,t),[a,o]}removeNamedExpression(e,t){const r=this.namedExpressions.namedExpressionForScope(e,t);if(!r)throw new kn(e);this.namedExpressions.remove(r.displayName,t);const n=this.getClipboardCell(r.address);if(t!==void 0){const i=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(r.address,i.address)}else this.dependencyGraph.setCellEmpty(r.address);return[r,n]}ensureItIsPossibleToMoveCells(e,t,r,n){if($e(e)||!(ti(t)&&ti(r)||PR(e,t,r))||$e(n)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(n.sheet))throw new Te("a valid range of cells to move.");const i=F.spanFrom(e,t,r),a=F.spanFrom(n,t,r);if(a.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Mr;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(i))throw new rn;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(a))throw new $s}restoreClipboardCells(e,t){const r=[];for(const[n,i]of t)if(this.restoreCell(n,i),i.type===Le.FORMULA){const{dependencies:a}=this.parser.fetchCachedResult(i.hash);r.push(...this.updateNamedExpressionsForTargetAddress(e,n,a))}return r}restoreCell(e,t){switch(t.type){case Le.VALUE:{this.setValueToCell(t,e);break}case Le.FORMULA:{this.setFormulaToCellFromCache(t.hash,e);break}case Le.EMPTY:{this.setCellEmpty(e);break}case Le.PARSING_ERROR:{this.setParsingErrorToCell(t.rawInput,t.errors,e);break}}}getOldContent(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof or)return[e,{type:Le.EMPTY}];if(t instanceof cr)return[e,Object.assign({type:Le.VALUE},t.getValues())];if(t instanceof nt)return[t.getAddress(this.lazilyTransformingAstService),{type:Le.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof on)return[e,{type:Le.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof or)return{type:Le.EMPTY};if(t instanceof cr)return Object.assign({type:Le.VALUE},t.getValues());if(t instanceof ge){const r=t.getArrayCellValue(e);return r===B?{type:Le.EMPTY}:{type:Le.VALUE,parsedValue:r,rawValue:t.getArrayCellRawValue(e)}}else{if(t instanceof Vt)return{type:Le.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof on)return{type:Le.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}}throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){const t=this.dependencyGraph.getSheetHeight(e),r=this.dependencyGraph.getSheetWidth(e),n=new Array(t);for(let i=0;i<t;i++){n[i]=new Array(r);for(let a=0;a<r;a++){const o=O(e,a,i);n[i][a]=this.getClipboardCell(o)}}return n}getRangeClipboardCells(e){const t=[];for(const r of e.addresses(this.dependencyGraph))t.push([r,this.getClipboardCell(r)]);return t}setCellContent(e,t){const r=this.cellContentParser.parse(t),n=this.getOldContent(e);if(r instanceof se.Formula){const i=this.parser.parse(r.formula,e),{ast:a,errors:o}=i;if(o.length>0)this.setParsingErrorToCell(r.formula,o,e);else try{const u=this.arraySizePredictor.checkArraySize(a,e);if(u.width<=0||u.height<=0)throw Error("Incorrect array size");this.setFormulaToCell(e,u,i)}catch(u){if(!u.message)throw u;const l={type:pe.InvalidRangeSize,message:"Invalid range size."};this.setParsingErrorToCell(r.formula,[l],e)}}else r instanceof se.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e);return n}setSheetContent(e,t){this.clearSheet(e);for(let r=0;r<t.length;r++)for(let n=0;n<t[r].length;n++){const i=O(e,n,r);this.setCellContent(i,t[r][n])}}setParsingErrorToCell(e,t,r){const n=this.dependencyGraph.getCellValue(r),i=new on(t,e),a=this.dependencyGraph.setParsingErrorToCell(r,i);this.columnSearch.remove(I(n),r),this.columnSearch.applyChanges(a.getChanges()),this.changes.addAll(a),this.changes.addChange(i.getCellValue(),r)}setFormulaToCell(e,t,{ast:r,hasVolatileFunction:n,hasStructuralChangeFunction:i,dependencies:a}){const o=this.dependencyGraph.getCellValue(e),u=this.dependencyGraph.setFormulaToCell(e,r,Pt(a,e),t,n,i);this.columnSearch.remove(I(o),e),this.columnSearch.applyChanges(u.getChanges()),this.changes.addAll(u)}setValueToCell(e,t){const r=this.dependencyGraph.getCellValue(t),n=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.change(I(r),I(e.parsedValue),t),this.columnSearch.applyChanges(n.getChanges().filter(i=>!Hn(i.address,t))),this.changes.addAll(n),this.changes.addChange(e.parsedValue,t)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;const t=this.dependencyGraph.getCellValue(e),r=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(I(t),e),this.columnSearch.applyChanges(r.getChanges()),this.changes.addAll(r),this.changes.addChange(B,e)}setFormulaToCellFromCache(e,t){const{ast:r,hasVolatileFunction:n,hasStructuralChangeFunction:i,dependencies:a}=this.parser.fetchCachedResult(e),o=Pt(a,t),[u]=new _R(t.sheet).transformSingleAst(r,t);this.parser.rememberNewAst(u);const l=uE(o),c=this.arraySizePredictor.checkArraySize(r,t);this.dependencyGraph.setFormulaToCell(t,u,l,c,n,i)}rowEffectivelyNotInSheet(e,t){const r=this.dependencyGraph.addressMapping.getHeight(t);return e>=r}getAndClearContentChanges(){const e=this.changes;return this.changes=lr.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const t=[];for(const[a]of this.dependencyGraph.entriesFromRowsSpan(e))t.push({address:a,cellType:this.getClipboardCell(a)});const{affectedArrays:r,contentChanges:n}=this.dependencyGraph.removeRows(e);this.columnSearch.applyChanges(n.getChanges());let i=0;return this.stats.measure(x.TRANSFORM_ASTS,()=>{const a=new ca(e);a.performEagerTransformations(this.dependencyGraph,this.parser),i=this.lazilyTransformingAstService.addTransformation(a)}),this.rewriteAffectedArrays(r),{version:i,removedCells:t,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const t=[];for(const[a]of this.dependencyGraph.entriesFromColumnsSpan(e))t.push({address:a,cellType:this.getClipboardCell(a)});const{affectedArrays:r,contentChanges:n}=this.dependencyGraph.removeColumns(e);this.columnSearch.applyChanges(n.getChanges()),this.columnSearch.removeColumns(e);let i=0;return this.stats.measure(x.TRANSFORM_ASTS,()=>{const a=new UR(e);a.performEagerTransformations(this.dependencyGraph,this.parser),i=this.lazilyTransformingAstService.addTransformation(a)}),this.rewriteAffectedArrays(r),{version:i,removedCells:t,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const{affectedArrays:t}=this.dependencyGraph.addRows(e);this.stats.measure(x.TRANSFORM_ASTS,()=>{const r=new la(e);r.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(r)}),this.rewriteAffectedArrays(t)}rewriteAffectedArrays(e){for(const t of e.values()){if(t.array.size.isRef)continue;const r=t.getFormula(this.lazilyTransformingAstService),n=t.getAddress(this.lazilyTransformingAstService),i=this.parser.computeHashFromAst(r);this.setFormulaToCellFromCache(i,n)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const{affectedArrays:t,contentChanges:r}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(r.getChanges()),this.stats.measure(x.TRANSFORM_ASTS,()=>{const n=new wR(e);n.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(n)}),this.rewriteAffectedArrays(t)}columnEffectivelyNotInSheet(e,t){const r=this.dependencyGraph.addressMapping.getWidth(t);return e>=r}adjustNamedExpressionEdges(e,t,r){if(r===void 0)return;const{vertex:n,id:i}=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),a=i??this.dependencyGraph.graph.getNodeId(n),o=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),{vertex:u,id:l}=this.dependencyGraph.fetchCellOrCreateEmpty(o.address),c=l??this.dependencyGraph.graph.getNodeId(u);for(const d of this.dependencyGraph.graph.adjacentNodes(u))if(d instanceof Vt&&d.getAddress(this.lazilyTransformingAstService).sheet===r){const f=d.getFormula(this.lazilyTransformingAstService),T=d.getAddress(this.lazilyTransformingAstService),{dependencies:N}=this.parser.fetchCachedResultForAst(f);for(const E of Pt(N,T))E instanceof jt&&E.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdgeIfExists(c,d),this.dependencyGraph.graph.addEdge(a,d))}}storeNamedExpressionInCell(e,t){const r=this.cellContentParser.parse(t);if(r instanceof se.Formula){const n=this.parser.parse(r.formula,O(-1,0,0));if(ir(n.ast))throw new za;const{ast:i,hasVolatileFunction:a,hasStructuralChangeFunction:o,dependencies:u}=n;this.dependencyGraph.setFormulaToCell(e,i,Pt(u,e),V.scalar(),a,o)}else r instanceof se.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e)}updateNamedExpressionsForMovedCells(e,t,r,n){if(e.sheet===n.sheet)return[];const i=[],a=F.spanFrom(n,t,r);for(const o of a.addresses(this.dependencyGraph)){const u=this.addressMapping.fetchCell(o);if(u instanceof Vt&&o.sheet!==e.sheet){const l=u.getFormula(this.lazilyTransformingAstService),{dependencies:c}=this.parser.fetchCachedResultForAst(l);i.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,o,c))}}return i}updateNamedExpressionsForTargetAddress(e,t,r){if(e===t.sheet)return[];const n=[],i=this.addressMapping.fetchCell(t);for(const a of Pt(r,t)){if(!(a instanceof jt))continue;const o=a.name,u=this.dependencyGraph.fetchNamedExpressionVertex(o,e).vertex,c=this.namedExpressions.isExpressionInScope(o,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(o,t.sheet).vertex:this.copyOrFetchGlobalNamedExpressionVertex(o,u,n);c!==u&&(this.dependencyGraph.graph.removeEdgeIfExists(u,i),this.dependencyGraph.graph.addEdge(c,i))}return n}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(Ur.SHEET_FOR_WORKBOOK_EXPRESSIONS,new ME(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,t,r){let n=this.namedExpressions.namedExpressionForScope(e);if(n===void 0)if(n=this.namedExpressions.addNamedExpression(e),r.push(n.normalizeExpressionName()),t instanceof Vt){const i=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),{ast:a,hasVolatileFunction:o,hasStructuralChangeFunction:u,dependencies:l}=i;this.dependencyGraph.setFormulaToCell(n.address,a,Pt(l,n.address),V.scalar(),o,u)}else t instanceof or?this.setCellEmpty(n.address):t instanceof cr&&this.setValueToCell(t.getValues(),n.address);return this.dependencyGraph.fetchCellOrCreateEmpty(n.address).vertex}}function Js(s){if(s.length<=1)return s;const e=[...s].sort(([n],[i])=>n-i),t=e.reduce((n,[i,a])=>{const o=n[n.length-1],u=o[0]+o[1];return i<=u?o[1]+=Math.max(0,a-(u-i)):n.push([i,a]),n},[e[0]]);let r=0;for(let n=0;n<t.length;++n)t[n][0]-=r,r+=t[n][1];return t}function ei(s){if(s.length<=1)return s;const e=[...s].sort(([n],[i])=>n-i),t=e.reduce((n,[i,a])=>{const o=n[n.length-1];return i===o[0]?o[1]=Math.max(o[1],a):n.push([i,a]),n},[e[0]]);let r=0;for(let n=0;n<t.length;++n)t[n][0]+=r,r+=t[n][1];return t}function ti(s){return Number.isInteger(s)&&s>0}function PR(s,e,t){return s.row===0&&ti(e)&&t===Number.POSITIVE_INFINITY||s.col===0&&ti(t)&&e===Number.POSITIVE_INFINITY}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Ne{}class VR extends Ne{constructor(e,t){super(),this.command=e,this.rowsRemovals=t}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class DR extends Ne{constructor(e,t,r,n,i,a,o){super(),this.sourceLeftCorner=e,this.width=t,this.height=r,this.destinationLeftCorner=n,this.overwrittenCellsData=i,this.addedGlobalNamedExpressions=a,this.version=o}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class BR extends Ne{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class kR extends Ne{constructor(e,t,r){super(),this.sheetId=e,this.rowMapping=t,this.oldContent=r}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class GR extends Ne{constructor(e,t,r){super(),this.sheetId=e,this.columnMapping=t,this.oldContent=r}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class HR extends Ne{constructor(e,t,r){super(),this.sheetId=e,this.oldSheetContent=t,this.newSheetContent=r}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class WR extends Ne{constructor(e,t,r,n,i){super(),this.sheet=e,this.startRow=t,this.numberOfRows=r,this.targetRow=n,this.version=i,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class YR extends Ne{constructor(e,t,r,n,i){super(),this.sheet=e,this.startColumn=t,this.numberOfColumns=r,this.targetColumn=n,this.version=i,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class zR extends Ne{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class $R extends Ne{constructor(e,t){super(),this.command=e,this.columnsRemovals=t}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class XR extends Ne{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class KR extends Ne{constructor(e,t,r,n,i){super(),this.sheetName=e,this.sheetId=t,this.oldSheetContent=r,this.scopedNamedExpressions=n,this.version=i}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class jR extends Ne{constructor(e,t,r){super(),this.sheetId=e,this.oldName=t,this.newName=r}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class qR extends Ne{constructor(e,t){super(),this.sheetId=e,this.oldSheetContent=t}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class QR extends Ne{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class ZR extends Ne{constructor(e,t,r,n){super(),this.targetLeftCorner=e,this.oldContent=t,this.newContent=r,this.addedGlobalNamedExpressions=n}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class JR extends Ne{constructor(e,t,r,n){super(),this.name=e,this.newContent=t,this.scope=r,this.options=n}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class eT extends Ne{constructor(e,t,r){super(),this.namedExpression=e,this.content=t,this.scope=r}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class tT extends Ne{constructor(e,t,r,n,i){super(),this.namedExpression=e,this.newContent=t,this.oldContent=r,this.scope=n,this.options=i}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class rT extends Ne{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}class nT{constructor(e,t){this.operations=t,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){this.batchUndoEntry!==void 0?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new rT}commitBatchMode(){if(this.batchUndoEntry===void 0)throw Error("Batch mode wasn't started");this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,t,r){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([t,r])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return this.undoStack.length===0}isRedoStackEmpty(){return this.redoStack.length===0}undo(){const e=this.undoStack.pop();if(!e)throw Error("Attempted to undo without operation on stack");this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const t of e.reversedOperations())this.undoEntry(t)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},rowsRemovals:r}=e;for(let n=r.length-1;n>=0;--n){const i=r[n];this.operations.addRows(new wl(t,[[i.rowFrom,i.rowCount]]));for(const{address:a,cellType:o}of i.removedCells)this.operations.restoreCell(a,o);this.restoreOldDataFromVersion(i.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},columnsRemovals:r}=e;for(let n=r.length-1;n>=0;--n){const i=r[n];this.operations.addColumns(new _l(t,[[i.columnFrom,i.columnCount]]));for(const{address:a,cellType:o}of i.removedCells)this.operations.restoreCell(a,o);this.restoreOldDataFromVersion(i.version-1)}}undoAddRows(e){const t=e.command.rowsSpans();for(let r=t.length-1;r>=0;--r){const n=t[r];this.operations.removeRows(new Ml(e.command.sheet,[[n.rowStart,n.numberOfRows]]))}}undoAddColumns(e){const t=e.command.columnsSpans();for(let r=t.length-1;r>=0;--r){const n=t[r];this.operations.removeColumns(new Ll(e.command.sheet,[[n.columnStart,n.numberOfColumns]]))}}undoSetCellContents(e){for(const t of e.cellContents){const r=t.address,[n,i]=t.oldContent;Hn(r,n)||this.operations.setCellEmpty(r),this.operations.restoreCell(n,i)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoMoveRows(e){const{sheet:t}=e;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){const{sheet:t}=e;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoAddSheet(e){const{sheetName:t}=e;this.operations.removeSheetByName(t)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();const{oldSheetContent:t,sheetId:r}=e;this.operations.addSheet(e.sheetName);for(let n=0;n<t.length;n++){const i=t[n];for(let a=0;a<i.length;a++){const o=i[a],u=O(r,a,n);this.operations.restoreCell(u,o)}}for(const[n,i]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(n,i,r);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){const{oldSheetContent:t,sheetId:r}=e;for(let n=0;n<t.length;n++){const i=t[n];for(let a=0;a<i.length;a++){const o=i[a],u=O(r,a,n);this.operations.restoreCell(u,o)}}}undoSetSheetContent(e){const{oldSheetContent:t,sheetId:r}=e;this.operations.clearSheet(r);for(let n=0;n<t.length;n++){const i=t[n];for(let a=0;a<i.length;a++){const o=i[a],u=O(r,a,n);this.operations.restoreCell(u,o)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){const e=this.redoStack.pop();if(!e)throw Error("Attempted to redo without operation on stack");this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const t of e.operations)this.redoEntry(t)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){const{targetLeftCorner:t,newContent:r}=e,n=r.length,i=r[0].length;for(let a=0;a<n;++a)for(let o=0;o<i;++o){const u=O(t.sheet,t.col+o,t.row+a);this.operations.restoreCell(u,r[a][o])}}redoSetCellContents(e){for(const t of e.cellContents)this.operations.setCellContent(t.address,t.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){const{sheetId:t,newSheetContent:r}=e;this.operations.setSheetContent(t,r)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(const[t,r]of e)this.operations.restoreCell(t,r)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){const t=this.oldData.get(e)||[];for(const r of t){const[n,i]=r;this.operations.setFormulaToCellFromCache(i,n)}}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class sT{constructor(e,t,r,n,i,a,o,u,l,c){this.operations=t,this.undoRedo=r,this.clipboardOperations=n,this.dependencyGraph=i,this.columnSearch=a,this.parser=o,this.cellContentParser=u,this.lazilyTransformingAstService=l,this.namedExpressions=c,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...t){const r=new wl(e,t);this.ensureItIsPossibleToAddRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(r),this.undoRedo.saveOperation(new BR(r))}removeRows(e,...t){const r=new Ml(e,t);this.ensureItIsPossibleToRemoveRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.removeRows(r);this.undoRedo.saveOperation(new VR(r,n))}addColumns(e,...t){const r=new _l(e,t);this.ensureItIsPossibleToAddColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(r),this.undoRedo.saveOperation(new zR(r))}removeColumns(e,...t){const r=new Ll(e,t);this.ensureItIsPossibleToRemoveColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.removeColumns(r);this.undoRedo.saveOperation(new $R(r,n))}moveCells(e,t,r,n){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const{version:i,overwrittenCellsData:a,addedGlobalNamedExpressions:o}=this.operations.moveCells(e,t,r,n);this.undoRedo.saveOperation(new DR(e,t,r,n,a,o,i))}moveRows(e,t,r,n){this.ensureItIsPossibleToMoveRows(e,t,r,n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.moveRows(e,t,r,n);this.undoRedo.saveOperation(new WR(e,t,r,n,i))}moveColumns(e,t,r,n){this.ensureItIsPossibleToMoveColumns(e,t,r,n),this.undoRedo.clearRedoStack();const i=this.operations.moveColumns(e,t,r,n);this.undoRedo.saveOperation(new YR(e,t,r,n,i))}cut(e,t,r){this.clipboardOperations.cut(e,t,r)}ensureItIsPossibleToCopy(e,t,r){if(!zr(t))throw new Te("width to be positive integer.");if(!zr(r))throw new Te("height to be positive integer.")}copy(e,t,r){this.ensureItIsPossibleToCopy(e,t,r),this.clipboardOperations.copy(e,t,r)}paste(e){const t=this.clipboardOperations.clipboard;if(t===void 0)throw new il;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);const r=F.spanFrom(e,t.width,t.height),n=this.operations.getRangeClipboardCells(r);this.undoRedo.clearRedoStack();const i=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new ZR(e,n,t.content,i))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return this.clipboardOperations.clipboard===void 0}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){e!==void 0&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();const t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new XR(t)),t}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.sheetMapping.fetchDisplayName(e),r=this.operations.getSheetClipboardCells(e),{version:n,scopedNamedExpressions:i}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new KR(t,e,r,i,n))}renameSheet(e,t){this.ensureItIsPossibleToRenameSheet(e,t);const r=this.operations.renameSheet(e,t);return r!==void 0&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new jR(e,r,t))),r}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new qR(e,t))}setCellContents(e,t){if(!(t instanceof Array))t=[[t]];else for(let n=0;n<t.length;n++)if(!(t[n]instanceof Array))throw new Te("an array of arrays or a raw cell value.");this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();const r=[];for(let n=0;n<t.length;n++)for(let i=0;i<t[n].length;i++){const a={sheet:e.sheet,row:e.row+n,col:e.col+i},o=t[n][i];this.clipboardOperations.abortCut();const u=this.operations.setCellContent(a,o);r.push({address:a,newContent:o,oldContent:u})}this.undoRedo.saveOperation(new QR(r))}setSheetContent(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),Ol(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new HR(e,r,t))}setRowOrder(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new kR(e,t,r))}validateSwapRowIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new ae(e);this.validateRowOrColumnMapping(e,t,"row")}testColumnOrderForArrays(e,t){for(const[r,n]of t)if(r!==n){const i=F.spanFrom({sheet:e,col:r,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(i))throw new rn}}setColumnOrder(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new GR(e,t,r))}validateSwapColumnIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new ae(e);this.validateRowOrColumnMapping(e,t,"column")}testRowOrderForArrays(e,t){for(const[r,n]of t)if(r!==n){const i=F.spanFrom({sheet:e,col:0,row:r},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(i))throw new rn}}mappingFromOrder(e,t,r){if(!this.sheetMapping.hasSheetWithId(e))throw new ae(e);const n=r==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==n)throw new Te(`number of ${r}s provided to be sheet ${r==="row"?"height":"width"}.`);const i=[];for(let a=0;a<n;a++)t[a]!==a&&i.push([a,t[a]]);return i}undo(){if(this.undoRedo.isUndoStackEmpty())throw new nl;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new sl;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,t,r,n){this.ensureItIsPossibleToAddNamedExpression(e,t,r),this.operations.addNamedExpression(e,t,r,n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new JR(e,t,r,n))}changeNamedExpressionExpression(e,t,r,n){this.ensureItIsPossibleToChangeNamedExpression(e,r,t);const[i,a]=this.operations.changeNamedExpressionExpression(e,r,t,n);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new tT(i,r,a,t,n))}removeNamedExpression(e,t){this.ensureScopeIdIsValid(t);const[r,n]=this.operations.removeNamedExpression(e,t);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new eT(r,n,t)),r}ensureItIsPossibleToAddNamedExpression(e,t,r){this.ensureScopeIdIsValid(r),this.ensureNamedExpressionNameIsValid(e,r),this.ensureNamedExpressionIsValid(t)}ensureItIsPossibleToChangeNamedExpression(e,t,r){if(this.ensureScopeIdIsValid(r),this.namedExpressions.namedExpressionForScope(e,r)===void 0)throw new kn(e);this.ensureNamedExpressionIsValid(t)}isItPossibleToRemoveNamedExpression(e,t){if(this.ensureScopeIdIsValid(t),this.namedExpressions.namedExpressionForScope(e,t)===void 0)throw new kn(e)}ensureItIsPossibleToAddRows(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new ae(e);const r=this.dependencyGraph.getSheetHeight(e),n=t.map(i=>i[1]).reduce((i,a)=>i+a,0);if(r+n>this.maxRows)throw new Mr;for(const[i,a]of t)if(!Nr(i)||!zr(a))throw new Te("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...t){for(const[r,n]of t){const i=r+n-1;if(!Nr(r)||!Nr(i))throw new Te("starting and ending row to be nonnegative.");if(i<r)throw new Te("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new ae(e)}}ensureItIsPossibleToAddColumns(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new ae(e);const r=this.dependencyGraph.getSheetWidth(e),n=t.map(i=>i[1]).reduce((i,a)=>i+a,0);if(r+n>this.maxColumns)throw new Mr;for(const[i,a]of t)if(!Nr(i)||!zr(a))throw new Te("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...t){for(const[r,n]of t){const i=r+n-1;if(!Nr(r)||!Nr(i))throw new Te("starting and ending column to be nonnegative.");if(i<r)throw new Te("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new ae(e)}}ensureItIsPossibleToMoveRows(e,t,r,n){this.ensureItIsPossibleToAddRows(e,[n,r]);const i=O(e,0,t),a=O(e,0,n);if(!this.sheetMapping.hasSheetWithId(e)||$e(i)||$e(a)||!zr(r)||n<=t+r&&n>=t)throw new Te("a valid range of rows to move.");const o=this.dependencyGraph.getSheetWidth(e),u=F.spanFrom(i,o,r);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(u))throw new rn;if(n>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(Xe.fromNumberOfRows(e,n-1,2)))throw new $s}ensureItIsPossibleToMoveColumns(e,t,r,n){this.ensureItIsPossibleToAddColumns(e,[n,r]);const i=O(e,t,0),a=O(e,n,0);if(!this.sheetMapping.hasSheetWithId(e)||$e(i)||$e(a)||!zr(r)||n<=t+r&&n>=t)throw new Te("a valid range of columns to move.");const o=this.dependencyGraph.getSheetHeight(e),u=F.spanFrom(i,r,o);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(u))throw new rn;if(n>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(rt.fromNumberOfColumns(e,n-1,2)))throw new $s}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new Dn(e)}ensureItIsPossibleToRenameSheet(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new ae(e);const r=this.sheetMapping.get(t);if(r!==void 0&&r!==e)throw new Dn(t)}ensureItIsPossibleToChangeContent(e){if($e(e))throw new el(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new ae(e.sheet)}ensureItIsPossibleToChangeCellContents(e,t){const r=Zs(t),n=F.spanFrom(e,r.width,r.height);this.ensureRangeInSizeLimits(n);for(const i of n.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(i)}ensureItIsPossibleToChangeSheetContents(e,t){const r=Zs(t),n=F.spanFrom(O(e,0,0),r.width,r.height);this.ensureRangeInSizeLimits(n)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Mr}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(e!==void 0&&!this.sheetMapping.hasSheetWithId(e))throw new ae(e)}validateRowOrColumnMapping(e,t,r){const n=r==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),i=t.map(([o,u])=>o).sort((o,u)=>o-u),a=t.map(([o,u])=>u).sort((o,u)=>o-u);for(let o=0;o<i.length;o++){if(!Nr(i[o])||i[o]>=n)throw new Te(`${r} numbers to be nonnegative integers and less than sheet ${r==="row"?"height":"width"}.`);if(i[o]===i[o+1])throw new Te(`source ${r} numbers to be unique.`);if(i[o]!==a[o])throw new Te(`target ${r} numbers to be permutation of source ${r} numbers.`)}}ensureNamedExpressionNameIsValid(e,t){if(!this.namedExpressions.isNameValid(e))throw new rl(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new tl(e)}ensureNamedExpressionIsValid(e){const t=this.cellContentParser.parse(e);if(t instanceof se.Formula){const r=this.parser.parse(t.formula,O(-1,0,0));if(ir(r.ast))throw new za}}}function zr(s){return Number.isInteger(s)&&s>0}function Nr(s){return Number.isInteger(s)&&s>=0}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class iT{constructor(e,t,r,n,i,a){this.config=e,this.stats=t,this.interpreter=r,this.lazilyTransformingAstService=n,this.dependencyGraph=i,this.columnSearch=a}run(){this.stats.start(x.TOP_SORT);const{sorted:e,cycled:t}=this.dependencyGraph.topSortWithScc();this.stats.end(x.TOP_SORT),this.stats.measure(x.EVALUATION,()=>{this.recomputeFormulas(t,e)})}partialRun(e){const t=lr.empty();return this.stats.measure(x.EVALUATION,()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,r=>{if(r instanceof nt){const n=r.isComputed()?r.getCellValue():void 0,i=this.recomputeFormulaVertexValue(r);if(i!==n){const a=r.getAddress(this.lazilyTransformingAstService);return t.addChange(i,a),this.columnSearch.change(I(n),I(i),a),!0}return!1}else return r instanceof Pe&&r.clearCache(),!0},r=>{if(r instanceof Pe)r.clearCache();else if(r instanceof nt){const n=r.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove(I(r.valueOrUndef()),n);const i=new p(m.CYCLE,void 0,r);r.setCellValue(i),t.addChange(i,n)}})}),t}runAndForget(e,t,r){const n=[];for(const a of Pt(r,t))if(a instanceof F){const o=a;if(this.dependencyGraph.getRange(o.start,o.end)===void 0){const u=new Pe(o);this.dependencyGraph.rangeMapping.setRange(u),n.push(u)}}const i=this.evaluateAstToCellValue(e,new Bt(t,this.config.useArrayArithmetic));return n.forEach(a=>{this.dependencyGraph.rangeMapping.removeRange(a)}),i}recomputeFormulas(e,t){e.forEach(r=>{r instanceof nt&&r.setCellValue(new p(m.CYCLE,void 0,r))}),t.forEach(r=>{if(r instanceof nt){const n=this.recomputeFormulaVertexValue(r),i=r.getAddress(this.lazilyTransformingAstService);this.columnSearch.add(I(n),i)}else r instanceof Pe&&r.clearCache()})}recomputeFormulaVertexValue(e){const t=e.getAddress(this.lazilyTransformingAstService);if(e instanceof ge&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{const r=e.getFormula(this.lazilyTransformingAstService),n=this.evaluateAstToCellValue(r,new Bt(t,this.config.useArrayArithmetic,e));return e.setCellValue(n)}}evaluateAstToCellValue(e,t){const r=this.interpreter.evaluateAst(e,t);return r instanceof w?r:r===B&&this.config.evaluateNullToZero?0:r}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class da{constructor(e,t){this.address=e,this.newValue=t}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class Fl{constructor(e,t){this.name=e,this.newValue=t}}class aT{constructor(e,t,r,n){this.config=e,this.namedExpressions=t,this.sheetIndexMapping=r,this.lazilyTransformingService=n}exportChange(e){const t=e.value,r=e.address;if(r.sheet===Ur.SHEET_FOR_WORKBOOK_EXPRESSIONS){const n=this.namedExpressions.namedExpressionInAddress(r.row);if(!n)throw new Error("Missing named expression");return new Fl(n.displayName,this.exportScalarOrRange(t))}else if(t instanceof w){const n=[];for(const[i,a]of t.entriesFromTopLeftCorner(r))n.push(new da(a,this.exportValue(i)));return n}else return new da(r,this.exportValue(t))}exportValue(e){return e instanceof w?this.detailedError(new p(m.VALUE,R.ScalarExpected)):this.config.smartRounding&&X(e)?this.cellValueRounding(I(e)):e instanceof p?this.detailedError(e):e===B?null:I(e)}exportScalarOrRange(e){return e instanceof w?e.rawData().map(t=>t.map(r=>this.exportValue(r))):this.exportValue(e)}detailedError(e){var t,r;let n;const i=(t=e.root)===null||t===void 0?void 0:t.getAddress(this.lazilyTransformingService);return i!==void 0&&(i.sheet===Ur.SHEET_FOR_WORKBOOK_EXPRESSIONS?n=(r=this.namedExpressions.namedExpressionInAddress(i.row))===null||r===void 0?void 0:r.displayName:n=Us(this.sheetIndexMapping,i,-1)),new Nl(e,this.config.translationPackage.getErrorTranslation(e.type),n)}cellValueRounding(e){if(e===0)return e;const t=Math.floor(Math.log10(Math.abs(e))),r=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*r)/r:Math.round(e*r)/r}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class oT{constructor(e,t,r,n,i,a){this.dependencyGraph=e,this.columnSearch=t,this.parser=r,this.cellContentParser=n,this.stats=i,this.arraySizePredictor=a,this.buildStrategy=new uT(e,t,r,i,n,a)}buildGraph(e,t){const r=t.measure(x.COLLECT_DEPENDENCIES,()=>this.buildStrategy.run(e));this.dependencyGraph.getAndClearContentChanges(),t.measure(x.PROCESS_DEPENDENCIES,()=>this.processDependencies(r))}processDependencies(e){e.forEach((t,r)=>{this.dependencyGraph.processCellDependencies(t,r)})}}class uT{constructor(e,t,r,n,i,a){this.dependencyGraph=e,this.columnIndex=t,this.parser=r,this.stats=n,this.cellContentParser=i,this.arraySizePredictor=a}run(e){const t=new Map;for(const r in e){const n=this.dependencyGraph.getSheetId(r),i=e[r];for(let a=0;a<i.length;++a){const o=i[a];for(let u=0;u<o.length;++u){const l=o[u],c=O(n,u,a),d=this.cellContentParser.parse(l);if(d instanceof se.Formula){const f=this.stats.measure(x.PARSER,()=>this.parser.parse(d.formula,c));if(f.errors.length>0){this.shrinkArrayIfNeeded(c);const T=new on(f.errors,d.formula);this.dependencyGraph.addVertex(c,T)}else{this.shrinkArrayIfNeeded(c);const T=this.arraySizePredictor.checkArraySize(f.ast,c);if(T.isScalar()){const N=new Vt(f.ast,c,0);t.set(N,Pt(f.dependencies,c)),this.dependencyGraph.addVertex(c,N),f.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(N),f.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(N)}else{const N=new ge(f.ast,c,new V(T.width,T.height));t.set(N,Pt(f.dependencies,c)),this.dependencyGraph.addArrayVertex(c,N)}}}else if(!(d instanceof se.Empty)){this.shrinkArrayIfNeeded(c);const f=new cr(d.value,l);this.columnIndex.add(I(d.value),c),this.dependencyGraph.addVertex(c,f)}}}}return t}shrinkArrayIfNeeded(e){const t=this.dependencyGraph.getCell(e);t instanceof ge&&this.dependencyGraph.shrinkArrayToCorner(t)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const hs=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class Ul extends P{version(e,t){return this.runFunction(e.args,t,this.metadata("VERSION"),()=>{const{licenseKeyValidityState:r,licenseKey:n}=this.config;let i;return hs.has(n)?i=hs.get(n):hs.has(r)?i=hs.get(r):r==="valid"&&(i=n.slice(-5)),`HyperFormula v${_e.version}, ${i}`})}}Ul.implementedFunctions={VERSION:{method:"version",parameters:[]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function bi(s,e){var t;let r=e.implementedFunctions[s];const n=(t=e.aliases)===null||t===void 0?void 0:t[s];if(n!==void 0){if(r!==void 0)throw new fE(s,e.name);r=e.implementedFunctions[n]}if(r===void 0)throw dn.functionNotDeclaredInPlugin(s,e.name);return r}class Ae{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=t=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(t),this.isFunctionVolatile=t=>this.volatileFunctions.has(t),this.isArrayFunction=t=>this.arrayFunctions.has(t),this.isFunctionDependentOnSheetStructureChange=t=>this.structuralChangeFunctions.has(t),e.functionPlugins.length>0){this.instancePlugins=new Map;for(const t of e.functionPlugins)Ae.loadPluginFunctions(t,this.instancePlugins)}else this.instancePlugins=new Map(Ae.plugins);for(const[t,r]of Ae.protectedFunctions())Ae.loadFunctionUnprotected(r,t,this.instancePlugins);for(const[t,r]of this.instancePlugins.entries())this.categorizeFunction(t,bi(t,r))}static registerFunctionPlugin(e,t){this.loadPluginFunctions(e,this.plugins),t!==void 0&&this.loadTranslations(t)}static registerFunction(e,t,r){this.loadPluginFunction(t,e,this.plugins),r!==void 0&&this.loadTranslations(r)}static unregisterFunction(e){if(this.functionIsProtected(e))throw wr.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const t of this.protectedPlugins())if(t===e)throw wr.cannotUnregisterProtectedPlugin();for(const[t,r]of this.plugins.entries())r===e&&this.plugins.delete(t)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){if(!this.functionIsProtected(e))return this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){const t=new Set(_e.getRegisteredLanguagesCodes());Object.keys(e).forEach(r=>{t.has(r)&&_e.getLanguage(r).extendFunctions(e[r])})}static loadPluginFunctions(e,t){Object.keys(e.implementedFunctions).forEach(r=>{this.loadPluginFunction(e,r,t)}),e.aliases!==void 0&&Object.keys(e.aliases).forEach(r=>{this.loadPluginFunction(e,r,t)})}static loadPluginFunction(e,t,r){if(this.functionIsProtected(t))throw wr.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,r)}static handleDeprecatedMetadata(e,t){t&&t.arrayFunction!==void 0&&(console.warn(`${e}: 'arrayFunction' parameter is deprecated since 3.1.0; Use 'enableArrayArithmeticForArguments' instead.`),t.enableArrayArithmeticForArguments=t.arrayFunction),t&&t.arraySizeMethod!==void 0&&(console.warn(`${e}: 'arraySizeMethod' parameter is deprecated since 3.1.0; Use 'sizeOfResultArrayMethod' instead.`),t.sizeOfResultArrayMethod=t.arraySizeMethod)}static loadFunctionUnprotected(e,t,r){const n=bi(t,e),i=n.method;if(this.handleDeprecatedMetadata(t,n),Object.prototype.hasOwnProperty.call(e.prototype,i))r.set(t,e);else throw dn.functionMethodNotFound(i,e.name)}static*protectedFunctions(){for(const[e,t]of this._protectedPlugins)t!==void 0&&(yield[e,t])}static*protectedPlugins(){for(const[,e]of this._protectedPlugins)e!==void 0&&(yield e)}initializePlugins(e){const t=[];for(const[r,n]of this.instancePlugins.entries()){let i=t.find(l=>l instanceof n);i===void 0&&(i=new n(e),t.push(i));const a=bi(r,n),o=a.method;this.functions.set(r,[o,i]);const u=a.sizeOfResultArrayMethod;u!==void 0&&this.arraySizeFunctions.set(r,[u,i])}}getFunctionPlugin(e){if(!Ae.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){const t=this.functions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[r,n]=t;return(i,a)=>n[r](i,a)}else return}getArraySizeFunction(e){const t=this.arraySizeFunctions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[r,n]=t;return(i,a)=>n[r](i,a)}else return}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){const e=new Set;for(const[t,r]of this.instancePlugins)Ae.functionIsProtected(t)||e.add(r);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.enableArrayArithmeticForArguments&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}Ae.plugins=new Map;Ae._protectedPlugins=new Map([["VERSION",Ul],["OFFSET",void 0]]);/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var Oe;(function(s){s.GREATER_THAN="GREATER_THAN",s.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",s.LESS_THAN="LESS_THAN",s.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",s.NOT_EQUAL="NOT_EQUAL",s.EQUAL="EQUAL"})(Oe||(Oe={}));const ls=(s,e)=>({operator:s,value:e});class hT{constructor(e){var t,r,n,i;this.trueString=(r=(t=e.translationPackage.getMaybeFunctionTranslation("TRUE"))===null||t===void 0?void 0:t.toLowerCase())!==null&&r!==void 0?r:"true",this.falseString=(i=(n=e.translationPackage.getMaybeFunctionTranslation("FALSE"))===null||n===void 0?void 0:n.toLowerCase())!==null&&i!==void 0?i:"false"}fromCellValue(e,t){if(typeof e!="string"&&typeof e!="boolean"&&typeof e!="number")return;const r=this.parseCriterion(e,t);if(r!==void 0)return{raw:e,lambda:dT(r,t)}}parseCriterion(e,t){if(typeof e=="number"||typeof e=="boolean")return ls(Oe.EQUAL,e);if(typeof e=="string"){const r=lT.exec(e);let n,i;r?(i=cT(r[1]),n=r[2]):(i=Oe.EQUAL,n=e);const a=t.coerceToMaybeNumber(n),o=n.toLowerCase()===this.trueString?!0:n.toLowerCase()===this.falseString?!1:void 0;if(i===void 0)return;if(n==="")return ls(i,null);if(a===void 0){if(i===Oe.EQUAL||i===Oe.NOT_EQUAL)return ls(i,o??n)}else return ls(i,I(a))}}}const lT=/([<>=]+)(.*)/;function cT(s){switch(s){case">":return Oe.GREATER_THAN;case">=":return Oe.GREATER_THAN_OR_EQUAL;case"<":return Oe.LESS_THAN;case"<=":return Oe.LESS_THAN_OR_EQUAL;case"<>":return Oe.NOT_EQUAL;case"=":return Oe.EQUAL;default:return}}const dT=(s,e)=>{switch(s.operator){case Oe.GREATER_THAN:return typeof s.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,s.value)>0:t=>!1;case Oe.GREATER_THAN_OR_EQUAL:return typeof s.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,s.value)>=0:t=>!1;case Oe.LESS_THAN:return typeof s.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,s.value)<0:t=>!1;case Oe.LESS_THAN_OR_EQUAL:return typeof s.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,s.value)<=0:t=>!1;case Oe.EQUAL:return typeof s.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,s.value)===0;if(typeof t=="string"){if(t==="")return!1;const r=e.coerceToMaybeNumber(t);return r===void 0?!1:e.floatCmp(r,s.value)===0}else return!1}:typeof s.value=="string"?e.eqMatcherFunction(s.value):typeof s.value=="boolean"?t=>typeof t=="boolean"&&t===s.value:t=>t===B;case Oe.NOT_EQUAL:return typeof s.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,s.value)!==0;if(typeof t=="string"){if(t==="")return!0;const r=e.coerceToMaybeNumber(t);return r===void 0?!0:e.floatCmp(r,s.value)!==0}else return!0}:typeof s.value=="string"?e.neqMatcherFunction(s.value):typeof s.value=="boolean"?t=>typeof t!="boolean"||t!==s.value:t=>t!==B}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class pT{constructor(e,t,r,n,i,a,o,u,l,c){this.config=e,this.dependencyGraph=t,this.columnSearch=r,this.stats=n,this.arithmeticHelper=i,this.functionRegistry=a,this.namedExpressions=o,this.serialization=u,this.arraySizePredictor=l,this.dateTimeHelper=c,this.equalOp=(d,f)=>ht(this.arithmeticHelper.eq,d,f),this.notEqualOp=(d,f)=>ht(this.arithmeticHelper.neq,d,f),this.greaterThanOp=(d,f)=>ht(this.arithmeticHelper.gt,d,f),this.lessThanOp=(d,f)=>ht(this.arithmeticHelper.lt,d,f),this.greaterThanOrEqualOp=(d,f)=>ht(this.arithmeticHelper.geq,d,f),this.lessThanOrEqualOp=(d,f)=>ht(this.arithmeticHelper.leq,d,f),this.concatOp=(d,f)=>ht(this.arithmeticHelper.concat,ia(d),ia(f)),this.plusOp=(d,f)=>ht(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(d),this.arithmeticHelper.coerceScalarToNumberOrError(f)),this.minusOp=(d,f)=>ht(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(d),this.arithmeticHelper.coerceScalarToNumberOrError(f)),this.timesOp=(d,f)=>ht(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(d),this.arithmeticHelper.coerceScalarToNumberOrError(f)),this.powerOp=(d,f)=>ht(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(d),this.arithmeticHelper.coerceScalarToNumberOrError(f)),this.divOp=(d,f)=>ht(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(d),this.arithmeticHelper.coerceScalarToNumberOrError(f)),this.unaryMinusOp=d=>au(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.percentOp=d=>au(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.unaryPlusOp=d=>this.arithmeticHelper.unaryPlus(d),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new hT(e)}evaluateAst(e,t){let r=this.evaluateAstWithoutPostprocessing(e,t);if(X(r)){if(El(I(r)))return new p(m.NUM,R.NaN);r=Ga(r,Rl(I(r)))}return r instanceof w&&r.height()===1&&r.width()===1&&([[r]]=r.data),fT(r,t.formulaVertex)}evaluateAstWithoutPostprocessing(e,t){switch(e.type){case g.EMPTY:return B;case g.CELL_REFERENCE:{const r=e.reference.toSimpleCellAddress(t.formulaAddress);return $e(r)?new p(m.REF,R.BadRef):this.dependencyGraph.getCellValue(r)}case g.NUMBER:case g.STRING:return e.value;case g.CONCATENATE_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.concatOp,r,n,t)}case g.EQUALS_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.equalOp,r,n,t)}case g.NOT_EQUAL_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.notEqualOp,r,n,t)}case g.GREATER_THAN_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOp,r,n,t)}case g.LESS_THAN_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOp,r,n,t)}case g.GREATER_THAN_OR_EQUAL_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,r,n,t)}case g.LESS_THAN_OR_EQUAL_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOrEqualOp,r,n,t)}case g.PLUS_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.plusOp,r,n,t)}case g.MINUS_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.minusOp,r,n,t)}case g.TIMES_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.timesOp,r,n,t)}case g.POWER_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.powerOp,r,n,t)}case g.DIV_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.divOp,r,n,t)}case g.PLUS_UNARY_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryPlusOp,r,t)}case g.MINUS_UNARY_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryMinusOp,r,t)}case g.PERCENT_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.percentOp,r,t)}case g.FUNCTION_CALL:{if(this.config.licenseKeyValidityState!=="valid"&&!Ae.functionIsProtected(e.procedureName))return new p(m.LIC,R.LicenseKey(this.config.licenseKeyValidityState));const r=this.functionRegistry.getFunction(e.procedureName);return r!==void 0?r(e,new Bt(t.formulaAddress,t.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),t.formulaVertex)):new p(m.NAME,R.FunctionName(e.procedureName))}case g.NAMED_EXPRESSION:{const r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.formulaAddress.sheet);return r?this.dependencyGraph.getCellValue(r.address):new p(m.NAME,R.NamedExpressionName(e.expressionName))}case g.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new p(m.REF,R.RangeManySheets);const r=F.fromCellRange(e,t.formulaAddress),n=this.dependencyGraph.getArray(r);if(n){const i=n.array;if(i instanceof An)throw new Error("Array should be already computed");if(i instanceof p)return i;if(i instanceof pn)return w.fromRange(i.raw(),r,this.dependencyGraph);throw new Error("Unknown array")}else return w.onlyRange(r,this.dependencyGraph)}case g.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new p(m.REF,R.RangeManySheets);const r=qt.fromColumnRange(e,t.formulaAddress);return w.onlyRange(r,this.dependencyGraph)}case g.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new p(m.REF,R.RangeManySheets);const r=Qt.fromRowRangeAst(e,t.formulaAddress);return w.onlyRange(r,this.dependencyGraph)}case g.PARENTHESIS:return this.evaluateAst(e.expression,t);case g.ARRAY:{let r;const n=[];for(const i of e.args){let a;const o=[];for(const l of i){const c=ml(this.evaluateAst(l,t)),d=c.height();if(a===void 0)a=d,o.push(...c.data);else if(a===d)for(let f=0;f<d;f++)o[f].push(...c.data[f]);else return new p(m.REF,R.SizeMismatch)}const u=o[0].length;if(r===void 0)r=u,n.push(...o);else if(r===u)n.push(...o);else return new p(m.REF,R.SizeMismatch)}return w.onlyValues(n)}case g.ERROR_WITH_RAW_INPUT:case g.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,t,r){var n;if(t instanceof w&&!r.arraysFlag&&(t=(n=Os(t,r))!==null&&n!==void 0?n:new p(m.VALUE,R.ScalarExpected)),t instanceof p)return t;if(t instanceof w){const i=t.data.map(a=>a.map(e));return w.onlyValues(i)}return e(t)}binaryRangeWrapper(e,t,r,n){var i,a;if(t instanceof w&&!n.arraysFlag&&(t=(i=Os(t,n))!==null&&i!==void 0?i:new p(m.VALUE,R.ScalarExpected)),t instanceof p)return t;if(r instanceof w&&!n.arraysFlag&&(r=(a=Os(r,n))!==null&&a!==void 0?a:new p(m.VALUE,R.ScalarExpected)),r instanceof p)return r;if(t instanceof w||r instanceof w){if(!(t instanceof w))if(r.isAdHoc()){const c=r.data;for(let d=0;d<c.length;d++)for(let f=0;f<c[0].length;f++)c[d][f]=e(t,c[d][f]);return w.onlyValues(c)}else t=w.fromScalar(t);if(!(r instanceof w))if(t.isAdHoc()){const c=t.data;for(let d=0;d<c.length;d++)for(let f=0;f<c[0].length;f++)c[d][f]=e(c[d][f],r);return w.onlyValues(c)}else r=w.fromScalar(r);if(t.width()===r.width()&&t.height()===r.height()){if(t.isAdHoc()){const c=t.data,d=r.data;for(let f=0;f<c.length;f++)for(let T=0;T<c[0].length;T++)c[f][T]=e(c[f][T],d[f][T]);return w.onlyValues(c)}if(r.isAdHoc()){const c=t.data,d=r.data;for(let f=0;f<c.length;f++)for(let T=0;T<c[0].length;T++)d[f][T]=e(c[f][T],d[f][T]);return w.onlyValues(d)}}const o=Math.max(t.width(),r.width()),u=Math.max(t.height(),r.height()),l=Array(u);for(let c=0;c<u;c++)l[c]=Array(o);for(let c=0;c<u;c++){const d=t.height()!==1?c:0,f=r.height()!==1?c:0;for(let T=0;T<o;T++){const N=t.width()!==1?T:0,E=r.width()!==1?T:0;d<t.height()&&f<r.height()&&N<t.width()&&E<r.width()?l[c][T]=e(t.data[d][N],r.data[f][E]):l[c][T]=new p(m.NA)}}return w.onlyValues(l)}return e(t,r)}}function au(s,e){return e instanceof p?e:s(e)}function ht(s,e,t){return e instanceof p?e:t instanceof p?t:s(e,t)}function fT(s,e){return s instanceof p&&e!==void 0?s.attachRootVertex(e):s}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class mT{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,t){this.transformations.forEach(r=>r.performEagerTransformations(e,t))}transformSingleAst(e,t){let[r,n]=[e,t];return this.transformations.forEach(i=>{[r,n]=i.transformSingleAst(r,n)}),[r,n]}isIrreversible(){return!0}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class gT{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return this.combinedTransformer!==void 0?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new mT(e)}commitCombinedMode(){if(this.combinedTransformer===void 0)throw Error("Combined mode wasn't started");return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,t,r){this.stats.start(x.TRANSFORM_ASTS_POSTPONED);for(let i=r;i<this.transformations.length;i++){const a=this.transformations[i];a.isIrreversible()&&(this.undoRedo.storeDataForVersion(i,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));const[o,u]=a.transformSingleAst(e,t);e=o,t=u}const n=this.parser.rememberNewAst(e);return this.stats.end(x.TRANSFORM_ASTS_POSTPONED),[n,t,this.transformations.length]}*getTransformationsFrom(e,t){for(let r=e;r<this.transformations.length;r++){const n=this.transformations[r];(!t||t(n))&&(yield n)}}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const Ut=-1;function ET(s,e,{searchCoordinate:t,orderingDirection:r,ifNoMatch:n},i){const a=e.start[t],o=t==="col"?e.effectiveEndColumn(i):e.effectiveEndRow(i),u=t==="col"?f=>I(i.getCellValue(O(e.sheet,f,e.start.row))):f=>I(i.getCellValue(O(e.sheet,e.start.col,f))),l=r==="asc"?(f,T)=>ri(f,T):(f,T)=>-ri(f,T),c=RT(f=>l(s,u(f))>=0,a,o),d=u(c);if(d===s)return c-a;if(n==="returnLowerBound"){if(c===Ut)return r==="asc"?Ut:0;if(typeof d!=typeof s)return Ut;if(r==="asc")return c-a;const f=c+1;return f<=o?f-a:Ut}if(n==="returnUpperBound"){if(c===Ut)return r==="asc"?0:Ut;if(typeof d!=typeof s)return Ut;if(r==="desc")return c-a;const f=c+1;return f<=o?f-a:Ut}return Ut}function RT(s,e,t){let r=e,n=t;for(;r<n;){const i=Math.ceil((r+n)/2);s(i)?r=i:n=i-1}return r===n&&s(r)?r:Ut}function ri(s,e){return typeof s==typeof e?s===B?0:s<e?-1:s>e?1:0:s===B?-1:e===B?1:e instanceof p||typeof s=="number"&&typeof e=="string"||typeof s=="number"&&typeof e=="boolean"?-1:typeof s=="string"&&typeof e=="number"?1:typeof s=="string"&&typeof e=="boolean"?-1:1}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const ou=-1;class bl{constructor(e){this.dependencyGraph=e}advancedFind(e,t,{returnOccurrence:r}={returnOccurrence:"first"}){const n=t.range,i=n===void 0?t.valuesFromTopLeftCorner():this.dependencyGraph.computeListOfValuesInRange(n),a=r==="first"?0:i.length-1,o=r==="first"?l=>l<i.length:l=>l>=0,u=r==="first"?l=>l+1:l=>l-1;for(let l=a;o(l);l=u(l))if(e(I(i[l])))return l;return ou}basicFind(e,t,r,{ordering:n,ifNoMatch:i,returnOccurrence:a}){const o=typeof e=="string"?Ln(e):e,u=t.range;return u===void 0?this.findNormalizedValue(o,t.valuesFromTopLeftCorner(),i,a):n==="none"?this.findNormalizedValue(o,this.dependencyGraph.computeListOfValuesInRange(u),i,a):ET(o,u,{searchCoordinate:r,orderingDirection:n,ifNoMatch:i},this.dependencyGraph)}findNormalizedValue(e,t,r="returnNotFound",n="first"){const i=t.map(I).map(f=>typeof f=="string"?Ln(f):f);if(r==="returnNotFound")return n==="first"?i.indexOf(e):i.lastIndexOf(e);const a=r==="returnLowerBound"?(f,T)=>ri(f,T):(f,T)=>-ri(f,T);let o=r==="returnLowerBound"?-1/0:1/0,u=ou;const l=n==="first"?0:i.length-1,c=n==="first"?f=>f<i.length:f=>f>=0,d=n==="first"?f=>f+1:f=>f-1;for(let f=l;c(f);f=d(f)){const T=i[f];if(T===e)return f;a(T,e)>0||a(o,T)<0&&(o=T,u=f)}return u}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class xl extends bl{constructor(e){super(e),this.dependencyGraph=e}add(e,t){}remove(e,t){}change(e,t,r){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,t,r,n){}removeValues(e){}find(e,t,r){return this.basicFind(e,t,"row",r)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Ir{constructor(e,t,r){this.dependencyGraph=e,this.config=t,this.stats=r,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new xl(e)}add(e,t){if(!(e===B||e instanceof p))if(e instanceof w)for(const[r,n]of e.entriesFromTopLeftCorner(t))this.addSingleCellValue(I(r),n);else this.addSingleCellValue(e,t)}remove(e,t){if(e!==void 0)if(e instanceof w)for(const[r,n]of e.entriesFromTopLeftCorner(t))this.removeSingleValue(I(r),n);else this.removeSingleValue(e,t)}change(e,t,r){e!==t&&(this.remove(e,r),this.add(t,r))}applyChanges(e){for(const t of e)t.oldValue!==void 0&&this.change(I(t.oldValue),I(t.value),t.address)}moveValues(e,t,r,n){for(const[i,a]of e){const o=PE(a,n,t,r);this.remove(i,a),this.add(i,o)}}removeValues(e){for(const[t,r]of e)this.remove(t,r)}find(e,t,{ordering:r,ifNoMatch:n,returnOccurrence:i}){i==null&&(i=r==="none"?"first":"last");const a=this.findUsingColumnIndex(e,t,i);return a!==void 0?a:this.binarySearchStrategy.find(e,t,{ordering:r,ifNoMatch:n,returnOccurrence:i})}findUsingColumnIndex(e,t,r){const n=t.range;if(n===void 0)return;this.ensureRecentData(n.sheet,n.start.col,e);const i=this.getColumnMap(n.sheet,n.start.col);if(!i)return-1;const a=typeof e=="string"?Ln(e):e,o=i.get(a);if(!o||!o.index||o.index.length===0)return;const u=Ir.findRowBelongingToRange(o,n,r);return u!==void 0?u-n.start.row:void 0}static findRowBelongingToRange(e,t,r){const n=t.start.row,i=t.end.row,a=r==="first"?Sr(n,e.index,"upperBound"):Sr(i,e.index,"lowerBound");if(a===-1)return;const o=e.index[a];return o>=n&&o<=i?o:void 0}advancedFind(e,t,r={returnOccurrence:"first"}){return this.binarySearchStrategy.advancedFind(e,t,r)}addColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,t){this.index.has(e)||this.index.set(e,[]);const r=this.index.get(e);let n=r[t];return n||(n=new Map,r[t]=n),n}getValueIndex(e,t,r){const n=this.getColumnMap(e,t);let i=this.getColumnMap(e,t).get(r);return i||(i={version:this.transformingService.version(),index:[]},n.set(r,i)),i}ensureRecentData(e,t,r){const n=this.getValueIndex(e,t,r),i=this.transformingService.version();if(n.version===i)return;const a=this.transformingService.getTransformationsFrom(n.version,o=>o.sheet===e&&(o instanceof la||o instanceof ca));for(const o of a)o instanceof la?this.addRows(t,o.rowsSpan,r):o instanceof ca&&this.removeRows(t,o.rowsSpan,r);n.version=i}addSingleCellValue(e,t){this.stats.measure(x.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e),typeof e=="string"&&(e=Ln(e));const r=this.getValueIndex(t.sheet,t.col,e);Ir.addValue(r,t.row)})}removeSingleValue(e,t){this.stats.measure(x.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e);const r=this.getColumnMap(t.sheet,t.col);typeof e=="string"&&(e=Ln(e));const n=r.get(e);if(!n)return;const i=Sr(t.row,n.index);i>-1&&n.index.splice(i,1),n.index.length===0&&r.delete(e),r.size===0&&delete this.index.get(t.sheet)[t.col]})}addRows(e,t,r){const n=this.getValueIndex(t.sheet,e,r);Ir.shiftRows(n,t.rowStart,t.numberOfRows)}removeRows(e,t,r){const n=this.getValueIndex(t.sheet,e,r);Ir.removeRowsFromValues(n,t),Ir.shiftRows(n,t.rowEnd+1,-t.numberOfRows)}static addValue(e,t){const r=Sr(t,e.index,"lowerBound");e.index[r]===t||e.index.splice(r+1,0,t)}static removeRowsFromValues(e,t){const r=Sr(t.rowStart,e.index,"upperBound"),n=Sr(t.rowEnd,e.index,"lowerBound");r>-1&&n>-1&&r<=n&&e.index[r]<=t.rowEnd&&e.index.splice(r,n-r+1)}static shiftRows(e,t,r){const n=Sr(t,e.index,"upperBound");if(n!==-1)for(let i=n;i<e.index.length;++i)e.index[i]+=r}}function Sr(s,e,t="upperBound"){let r=0,n=e.length-1;for(;r<=n;){const o=Math.floor((r+n)/2);if(s>e[o])r=o+1;else if(s<e[o])n=o-1;else return o}const i=t==="lowerBound"?n:r;return i>=0&&i<=e.length?i:-1}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function TT(s,e,t){return e.useColumnIndex?new Ir(s,e,t):new xl(s)}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class NT{constructor(e){this.config=e;const t=this.config.thousandSeparator==="."?`\\${this.config.thousandSeparator}`:this.config.thousandSeparator,r=this.config.decimalSeparator==="."?`\\${this.config.decimalSeparator}`:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${r}\\d+)|(\\d+(${t}\\d{3,})*(${r}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(`${t}`,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){const t=this.numericStringToNumber(e);return isNaN(t)?void 0:t}}numericStringToNumber(e){const t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Ka{constructor(e,t,r){this.dependencyGraph=e,this.unparser=t,this.exporter=r}getCellHyperlink(e){const t=this.dependencyGraph.getCell(e);if(t instanceof Vt){const r=t.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(r.procedureName==="HYPERLINK")return r.hyperlink}}getCellFormula(e,t){const r=this.dependencyGraph.getCell(e);if(r instanceof Vt){const n=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);return t=t??e,this.unparser.unparse(n,t)}else if(r instanceof ge){const n=r.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(n.row!==e.row||n.col!==e.col||n.sheet!==e.sheet)return;t=t??e;const i=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(i!==void 0)return this.unparser.unparse(i,t)}else if(r instanceof on)return r.getFormula()}getCellSerialized(e,t){var r;return(r=this.getCellFormula(e,t))!==null&&r!==void 0?r:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,t=>this.getCellValue(t))}getSheetFormulas(e){return this.genericSheetGetter(e,t=>this.getCellFormula(t))}genericSheetGetter(e,t){const r=this.dependencyGraph.getSheetHeight(e),n=this.dependencyGraph.getSheetWidth(e),i=new Array(r);for(let a=0;a<r;a++){i[a]=new Array(n);for(let o=0;o<n;o++){const u=O(e,o,a);i[a][o]=t(u)}for(let o=n-1;o>=0&&(i[a][o]===null||i[a][o]===void 0);o--)i[a].pop()}for(let a=r-1;a>=0&&i[a].length===0;a--)i.pop();return i}genericAllSheetsGetter(e){const t={};for(const r of this.dependencyGraph.sheetMapping.displayNames()){const n=this.dependencyGraph.sheetMapping.fetch(r);t[r]=e(n)}return t}getSheetSerialized(e){return this.genericSheetGetter(e,t=>this.getCellSerialized(t))}getAllSheetsValues(){return this.genericAllSheetsGetter(e=>this.getSheetValues(e))}getAllSheetsFormulas(){return this.genericAllSheetsGetter(e=>this.getSheetFormulas(e))}getAllSheetsSerialized(){return this.genericAllSheetsGetter(e=>this.getSheetSerialized(e))}getAllNamedExpressionsSerialized(){const e=[];let t=0;for(const r of this.dependencyGraph.sheetMapping.displayNames()){const n=this.dependencyGraph.sheetMapping.fetch(r);e[n]=t,t++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(r=>({name:r.expression.displayName,expression:this.getCellSerialized(r.expression.address),scope:r.scope!==void 0?e[r.scope]:void 0,options:r.expression.options}))}withNewConfig(e,t){const r=new jh(e,ka(e),this.dependencyGraph.sheetMapping.fetchDisplayName,t);return new Ka(this.dependencyGraph,r,this.exporter)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class cs{static buildFromSheets(e,t={},r=[]){const n=new st(t);return this.buildEngine(n,e,r)}static buildFromSheet(e,t={},r=[]){const n=new st(t),i=n.translationPackage.getUITranslation(Gn.NEW_SHEET_PREFIX)+"1";return this.buildEngine(n,{[i]:e},r)}static buildEmpty(e={},t=[]){return this.buildEngine(new st(e),{},t)}static rebuildWithConfig(e,t,r,n){return this.buildEngine(e,t,r,n)}static buildEngine(e,t={},r=[],n=e.useStats?new Zh:new cE){n.start(x.BUILD_ENGINE_TOTAL);const i=new Ur,a=new Ae(e),o=new gT(n),u=$a.buildEmpty(o,e,a,i,n),l=TT(u,e,n),c=u.sheetMapping,d=u.addressMapping;for(const q in t)if(Object.prototype.hasOwnProperty.call(t,q)){const Rt=t[q];Ol(Rt);const He=Zs(Rt);if(He.height>e.maxRows||He.width>e.maxColumns)throw new Mr;const Tt=c.addSheet(q);d.autoAddSheet(Tt,He)}const f=new wn(e,a,c.get);o.parser=f;const T=new jh(e,ka(e),c.fetchDisplayName,i),N=new iR(e),E=new NT(e),S=new GE(e,N,E),A=new IR(e,N,E),y=new KE(e,a),C=new xR(e,u,l,A,f,n,o,i,y),M=new nT(e,C);o.undoRedo=M;const re=new OR(e,u,C),J=new sT(e,C,M,re,u,l,f,A,o,i),j=new aT(e,i,c.fetchDisplayName,o),ue=new Ka(u,T,j),he=new pT(e,u,l,n,S,a,i,ue,y,N);n.measure(x.GRAPH_BUILD,()=>{new oT(u,l,f,A,n,y).buildGraph(t,n)}),r.forEach(q=>{J.ensureItIsPossibleToAddNamedExpression(q.name,q.expression,q.scope),J.operations.addNamedExpression(q.name,q.expression,q.scope,q.options)});const le=new iT(e,n,he,o,u,l);return le.run(),n.end(x.BUILD_ENGINE_TOTAL),{config:e,stats:n,dependencyGraph:u,columnSearch:l,parser:f,unparser:T,cellContentParser:A,evaluator:le,lazilyTransformingAstService:o,crudOperations:J,exporter:j,namedExpressions:i,serialization:ue,functionRegistry:a}}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function ST(s){for(const[e,t]of Object.entries(s))t instanceof Function?s[e]=AT(t):delete s[e]}function AT(s){return()=>{throw new Error(`The "${s}" method cannot be called because this HyperFormula instance has been destroyed`)}}var ds={exports:{}},uu;function yT(){if(uu)return ds.exports;uu=1;function s(){}return s.prototype={on:function(e,t,r){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:t,ctx:r}),this},once:function(e,t,r){var n=this;function i(){n.off(e,i),t.apply(r,arguments)}return i._=t,this.on(e,i,r)},emit:function(e){var t=[].slice.call(arguments,1),r=((this.e||(this.e={}))[e]||[]).slice(),n=0,i=r.length;for(n;n<i;n++)r[n].fn.apply(r[n].ctx,t);return this},off:function(e,t){var r=this.e||(this.e={}),n=r[e],i=[];if(n&&t)for(var a=0,o=n.length;a<o;a++)n[a].fn!==t&&n[a].fn._!==t&&i.push(n[a]);return i.length?r[e]=i:delete r[e],this}},ds.exports=s,ds.exports.TinyEmitter=s,ds.exports}var CT=yT();/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var bt;(function(s){s.SheetAdded="sheetAdded",s.SheetRemoved="sheetRemoved",s.SheetRenamed="sheetRenamed",s.NamedExpressionAdded="namedExpressionAdded",s.NamedExpressionRemoved="namedExpressionRemoved",s.ValuesUpdated="valuesUpdated",s.EvaluationSuspended="evaluationSuspended",s.EvaluationResumed="evaluationResumed"})(bt||(bt={}));class vT extends CT.TinyEmitter{emit(e,...t){return super.emit(e,...t),this}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class _e{constructor(e,t,r,n,i,a,o,u,l,c,d,f,T,N){this._config=e,this._stats=t,this._dependencyGraph=r,this._columnSearch=n,this._parser=i,this._unparser=a,this._cellContentParser=o,this._evaluator=u,this._lazilyTransformingAstService=l,this._crudOperations=c,this._exporter=d,this._namedExpressions=f,this._serialization=T,this._functionRegistry=N,this._emitter=new vT,this._evaluationSuspended=!1}static get defaultConfig(){return IT()}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,t={},r=[]){return this.buildFromEngineState(cs.buildFromSheet(e,t,r))}static buildFromSheets(e,t={},r=[]){return this.buildFromEngineState(cs.buildFromSheets(e,t,r))}static buildEmpty(e={},t=[]){return this.buildFromEngineState(cs.buildEmpty(e,t))}static getLanguage(e){v(e,"string","languageCode");const t=this.registeredLanguages.get(e);if(t===void 0)throw new ta;return t}static registerLanguage(e,t){if(v(e,"string","languageCode"),this.registeredLanguages.has(e))throw new dl;this.registeredLanguages.set(e,vE(t))}static unregisterLanguage(e){if(v(e,"string","languageCode"),this.registeredLanguages.has(e))this.registeredLanguages.delete(e);else throw new ta}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,t){Ae.registerFunctionPlugin(e,t)}static unregisterFunctionPlugin(e){Ae.unregisterFunctionPlugin(e)}static registerFunction(e,t,r){v(e,"string","functionId"),Ae.registerFunction(e,t,r)}static unregisterFunction(e){v(e,"string","functionId"),Ae.unregisterFunction(e)}static unregisterAllFunctions(){Ae.unregisterAll()}static getRegisteredFunctionNames(e){v(e,"string","code");const t=Ae.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}static getFunctionPlugin(e){return v(e,"string","functionId"),Ae.getFunctionPlugin(e)}static getAllFunctionPlugins(){return Ae.getPlugins()}static buildFromEngineState(e){return new _e(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!de(e))throw new $("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!de(e))throw new $("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellHyperlink(e){if(!de(e))throw new $("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellHyperlink(e)}getCellSerialized(e){if(!de(e))throw new $("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return v(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return v(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return v(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter(e=>this.getSheetDimensions(e))}getSheetDimensions(e){return v(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){Object.entries(e).every(([r,n])=>this._config[r]===n)||this.rebuildWithConfig(e)}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.rebuildWithConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let t;if(de(e))t=new F(e,e);else if(et(e))t=new F(e.start,e.end);else throw new $("SimpleCellAddress | SimpleCellRange","address");try{this._crudOperations.ensureRangeInSizeLimits(t);for(const r of t.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(r)}catch{return!1}return!0}setCellContents(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,t){return v(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,t){v(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch{return!1}}setRowOrder(e,t){v(e,"number","sheetId");const r=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,r)}isItPossibleToSetRowOrder(e,t){v(e,"number","sheetId");try{const r=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,r),this._crudOperations.testRowOrderForArrays(e,r),!0}catch{return!1}}swapColumnIndexes(e,t){return v(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,t){v(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch{return!1}}setColumnOrder(e,t){v(e,"number","sheetId");const r=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,r)}isItPossibleToSetColumnOrder(e,t){v(e,"number","sheetId");try{const r=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,r),this._crudOperations.testColumnOrderForArrays(e,r),!0}catch{return!1}}isItPossibleToAddRows(e,...t){v(e,"number","sheetId");const r=ei(t);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...r),!0}catch{return!1}}addRows(e,...t){return v(e,"number","sheetId"),this._crudOperations.addRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...t){v(e,"number","sheetId");const r=Js(t);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...r),!0}catch{return!1}}removeRows(e,...t){return v(e,"number","sheetId"),this._crudOperations.removeRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...t){v(e,"number","sheetId");const r=ei(t);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...r),!0}catch{return!1}}addColumns(e,...t){return v(e,"number","sheetId"),this._crudOperations.addColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...t){v(e,"number","sheetId");const r=Js(t);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...r),!0}catch{return!1}}removeColumns(e,...t){return v(e,"number","sheetId"),this._crudOperations.removeColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,t){if(!de(t))throw new $("SimpleCellAddress","destinationLeftCorner");if(!et(e))throw new $("SimpleCellRange","source");try{const r=new F(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(r.start,r.width(),r.height(),t),!0}catch{return!1}}moveCells(e,t){if(!de(t))throw new $("SimpleCellAddress","destinationLeftCorner");if(!et(e))throw new $("SimpleCellRange","source");const r=new F(e.start,e.end);return this._crudOperations.moveCells(r.start,r.width(),r.height(),t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,t,r,n){v(e,"number","sheetId"),v(t,"number","startRow"),v(r,"number","numberOfRows"),v(n,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,r,n),!0}catch{return!1}}moveRows(e,t,r,n){return v(e,"number","sheetId"),v(t,"number","startRow"),v(r,"number","numberOfRows"),v(n,"number","targetRow"),this._crudOperations.moveRows(e,t,r,n),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,t,r,n){v(e,"number","sheetId"),v(t,"number","startColumn"),v(r,"number","numberOfColumns"),v(n,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,r,n),!0}catch{return!1}}moveColumns(e,t,r,n){return v(e,"number","sheetId"),v(t,"number","startColumn"),v(r,"number","numberOfColumns"),v(n,"number","targetColumn"),this._crudOperations.moveColumns(e,t,r,n),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!et(e))throw new $("SimpleCellRange","source");const t=new F(e.start,e.end);return this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e)}cut(e){if(!et(e))throw new $("SimpleCellRange","source");const t=new F(e.start,e.end);return this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e)}paste(e){if(!de(e))throw new $("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!et(e))throw new $("SimpleCellRange","source");return new F(e.start,e.end).arrayOfAddressesInRange().map(r=>r.map(n=>this.getCellValue(n)))}getRangeFormulas(e){if(!et(e))throw new $("SimpleCellRange","source");return new F(e.start,e.end).arrayOfAddressesInRange().map(r=>r.map(n=>this.getCellFormula(n)))}getRangeSerialized(e){if(!et(e))throw new $("SimpleCellRange","source");return new F(e.start,e.end).arrayOfAddressesInRange().map(r=>r.map(n=>this.getCellSerialized(n)))}getFillRangeData(e,t,r=!1){if(!et(e))throw new $("SimpleCellRange","source");if(!et(t))throw new $("SimpleCellRange","target");const n=new F(e.start,e.end),i=new F(t.start,t.end);return this.ensureEvaluationIsNotSuspended(),i.arrayOfAddressesInRange().map(a=>a.map(o=>{const u=((o.row-(r?t:e).start.row)%n.height()+n.height())%n.height()+e.start.row,l=((o.col-(r?t:e).start.col)%n.width()+n.width())%n.width()+e.start.col;return this._serialization.getCellSerialized({row:u,col:l,sheet:n.sheet},o)}))}isItPossibleToAddSheet(e){v(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch{return!1}}addSheet(e){e!==void 0&&v(e,"string","sheetName");const t=this._crudOperations.addSheet(e);return this._emitter.emit(bt.SheetAdded,t),t}isItPossibleToRemoveSheet(e){v(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}removeSheet(e){v(e,"number","sheetId");const t=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);const r=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(bt.SheetRemoved,t,r),r}isItPossibleToClearSheet(e){v(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}clearSheet(e){return v(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,t){v(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch{return!1}}setSheetContent(e,t){return v(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,t){return v(e,"string","cellAddress"),v(t,"number","sheetId"),Hi(this.sheetMapping.get,e,t)}simpleCellRangeFromString(e,t){return v(e,"string","cellRange"),v(t,"number","sheetId"),hf(this.sheetMapping.get,e,t)}simpleCellAddressToString(e,t={}){if(!de(e))throw new $("SimpleCellAddress","cellAddress");const r=typeof t=="number"?t:t.includeSheetName?e.sheet+1:e.sheet;return Us(this.sheetMapping.fetchDisplayName,e,r)}simpleCellRangeToString(e,t={}){if(!et(e))throw new $("SimpleCellRange","cellRange");const r=typeof t=="number"?t:t.includeSheetName?e.start.sheet+e.end.sheet+1:e.start.sheet;return lf(this.sheetMapping.fetchDisplayName,e,r)}getCellDependents(e){let t;if(de(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(et(e))t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new $("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}getCellPrecedents(e){let t;if(de(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(et(e))t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new $("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.dependencyQueryAddresses(t)}getSheetName(e){return v(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return v(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return v(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!de(e))throw new $("SimpleCellAddress","cellAddress");const t=this.dependencyGraph.getCell(e);return _E(t,e)}doesCellHaveSimpleValue(e){if(!de(e))throw new $("SimpleCellAddress","cellAddress");return this.getCellType(e)===We.VALUE}doesCellHaveFormula(e){if(!de(e))throw new $("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===We.FORMULA||t===We.ARRAYFORMULA}isCellEmpty(e){if(!de(e))throw new $("SimpleCellAddress","cellAddress");return this.getCellType(e)===We.EMPTY}isCellPartOfArray(e){if(!de(e))throw new $("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===We.ARRAY||t===We.ARRAYFORMULA}getCellValueType(e){if(!de(e))throw new $("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return Ks(t)}getCellValueDetailedType(e){if(!de(e))throw new $("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return FE(t)}getCellValueFormat(e){if(!de(e))throw new $("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return UE(t)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,t){v(e,"number","sheetId"),v(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch{return!1}}renameSheet(e,t){v(e,"number","sheetId"),v(t,"string","newName");const r=this._crudOperations.renameSheet(e,t);r!==void 0&&this._emitter.emit(bt.SheetRenamed,r,t)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(t){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),t}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(bt.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(bt.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,t,r){v(e,"string","expressionName"),r!==void 0&&v(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,r),!0}catch{return!1}}addNamedExpression(e,t,r,n){v(e,"string","expressionName"),r!==void 0&&v(r,"number","scope"),this._crudOperations.addNamedExpression(e,t,r,n);const i=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(bt.NamedExpressionAdded,e,i),i}getNamedExpressionValue(e,t){v(e,"string","expressionName"),t!==void 0&&v(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);const r=this._namedExpressions.namedExpressionForScope(e,t);if(r)return this._serialization.getCellValue(r.address)}getNamedExpressionFormula(e,t){v(e,"string","expressionName"),t!==void 0&&v(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);const r=this._namedExpressions.namedExpressionForScope(e,t);if(r!==void 0)return this._serialization.getCellFormula(r.address)}getNamedExpression(e,t){v(e,"string","expressionName"),t!==void 0&&v(t,"number","scope");const r=this._namedExpressions.namedExpressionForScope(e,t);if(r===void 0)return;const n=this._serialization.getCellFormula(r.address);return{name:e,scope:t,expression:n,options:r.options}}isItPossibleToChangeNamedExpression(e,t,r){v(e,"string","expressionName"),r!==void 0&&v(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,r),!0}catch{return!1}}changeNamedExpression(e,t,r,n){return v(e,"string","expressionName"),r!==void 0&&v(r,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,r,t,n),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,t){v(e,"string","expressionName"),t!==void 0&&v(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch{return!1}}removeNamedExpression(e,t){v(e,"string","expressionName"),t!==void 0&&v(t,"number","scope");const r=this._crudOperations.removeNamedExpression(e,t);if(r){const n=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(bt.NamedExpressionRemoved,r.displayName,n),n}else return[]}listNamedExpressions(e){return e!==void 0&&v(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){v(e,"string","formulaString");const{ast:t,address:r}=this.extractTemporaryFormula(e);if(t===void 0)throw new vs;return this._unparser.unparse(t,r)}calculateFormula(e,t){v(e,"string","formulaString"),v(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);const{ast:r,address:n,dependencies:i}=this.extractTemporaryFormula(e,t);if(r===void 0)throw new vs;const a=this.evaluator.runAndForget(r,n,i);return this._exporter.exportScalarOrRange(a)}getNamedExpressionsFromFormula(e){v(e,"string","formulaString");const{ast:t,dependencies:r}=this.extractTemporaryFormula(e);if(t===void 0)throw new vs;const n=r.filter(a=>a instanceof jt).map(a=>a.name);return[...new Set(n)]}validateFormula(e){v(e,"string","formulaString");const{ast:t}=this.extractTemporaryFormula(e);return t!==void 0}getRegisteredFunctionNames(){return _e.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return v(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return v(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return v(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return v(e,"number","val"),un(e)}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}destroy(){ST(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new ll}extractTemporaryFormula(e,t=1){const r=this._cellContentParser.parse(e),n={sheet:t,col:0,row:0};if(!(r instanceof se.Formula))return{address:n,dependencies:[]};const{ast:i,errors:a,dependencies:o}=this._parser.parse(r.formula,n);return a.length>0?{address:n,dependencies:[]}:{ast:i,address:n,dependencies:o}}rebuildWithConfig(e){const t=this._config.mergeConfig(e),r=this._config.mergeConfig({language:e.language}),n=this._serialization.withNewConfig(r,this._namedExpressions).getAllSheetsSerialized(),i=this._serialization.getAllNamedExpressionsSerialized(),a=cs.rebuildWithConfig(t,n,i,this._stats);this._config=a.config,this._stats=a.stats,this._dependencyGraph=a.dependencyGraph,this._columnSearch=a.columnSearch,this._parser=a.parser,this._unparser=a.unparser,this._cellContentParser=a.cellContentParser,this._evaluator=a.evaluator,this._lazilyTransformingAstService=a.lazilyTransformingAstService,this._crudOperations=a.crudOperations,this._exporter=a.exporter,this._namedExpressions=a.namedExpressions,this._serialization=a.serialization,this._functionRegistry=a.functionRegistry}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{const e=this._crudOperations.getAndClearContentChanges(),t=this.dependencyGraph.verticesToRecompute();this.dependencyGraph.clearDirtyVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));const r=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(bt.ValuesUpdated,r),r}}}_e.version="3.1.0";_e.buildDate="14/10/2025 09:41:56";_e.releaseDate="14/10/2025";_e.languages={};_e.registeredLanguages=new Map;/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const hu=new WeakMap;class st{constructor(e={},t=!0){const{accentSensitive:r,caseSensitive:n,caseFirst:i,chooseAddressMappingPolicy:a,context:o,currencySymbol:u,dateFormats:l,decimalSeparator:c,evaluateNullToZero:d,functionArgSeparator:f,functionPlugins:T,ignorePunctuation:N,leapYear1900:E,localeLang:S,language:A,ignoreWhiteSpace:y,licenseKey:C,matchWholeCell:M,arrayColumnSeparator:re,arrayRowSeparator:J,maxRows:j,maxColumns:ue,nullYear:he,nullDate:le,parseDateTime:q,precisionEpsilon:Rt,precisionRounding:He,stringifyDateTime:Tt,stringifyDuration:Ze,smartRounding:rr,timeFormats:nr,thousandSeparator:Pr,useArrayArithmetic:Yt,useStats:Vr,undoLimit:Dr,useColumnIndex:gn,useRegularExpressions:Br,useWildcards:xe}=e;this.useArrayArithmetic=K(Yt,"boolean","useArrayArithmetic"),this.accentSensitive=K(r,"boolean","accentSensitive"),this.caseSensitive=K(n,"boolean","caseSensitive"),this.caseFirst=K(i,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=K(N,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=a??st.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...is(l,Array.isArray,"array","dateFormats")],this.timeFormats=[...is(nr,Array.isArray,"array","timeFormats")],this.functionArgSeparator=K(f,"string","functionArgSeparator"),this.decimalSeparator=K(c,[".",","],"decimalSeparator"),this.language=K(A,"string","language"),this.ignoreWhiteSpace=K(y,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=K(C,"string","licenseKey"),this.thousandSeparator=K(Pr,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=K(re,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=K(J,[";","|"],"arrayRowSeparator"),this.localeLang=K(S,"string","localeLang"),this.functionPlugins=[...T??st.defaultConfig.functionPlugins],this.smartRounding=K(rr,"boolean","smartRounding"),this.evaluateNullToZero=K(d,"boolean","evaluateNullToZero"),this.nullYear=K(he,"number","nullYear"),Yr(this.nullYear,"nullYear",0),jE(this.nullYear,"nullYear",100),this.precisionRounding=K(He,"number","precisionRounding"),Yr(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=K(Rt,"number","precisionEpsilon"),Yr(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=K(gn,"boolean","useColumnIndex"),this.useStats=K(Vr,"boolean","useStats"),this.parseDateTime=K(q,"function","parseDateTime"),this.stringifyDateTime=K(Tt,"function","stringifyDateTime"),this.stringifyDuration=K(Ze,"function","stringifyDuration"),this.translationPackage=_e.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=is(le,Fn,"IDate","nullDate"),this.leapYear1900=K(E,"boolean","leapYear1900"),this.undoLimit=K(Dr,"number","undoLimit"),this.useRegularExpressions=K(Br,"boolean","useRegularExpressions"),this.useWildcards=K(xe,"boolean","useWildcards"),this.matchWholeCell=K(M,"boolean","matchWholeCell"),Yr(this.undoLimit,"undoLimit",0),this.maxRows=K(j,"number","maxRows"),Yr(this.maxRows,"maxRows",1),this.maxColumns=K(ue,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(u),Yr(this.maxColumns,"maxColumns",1),this.context=o,hu.set(this,{licenseKeyValidityState:SR(this.licenseKey)}),Xo({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),Xo({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){const t=[...is(e,Array.isArray,"array","currencySymbol")];return t.forEach(r=>{if(typeof r!="string")throw new $("string[]","currencySymbol");if(r==="")throw new pE("currencySymbol")}),t}get licenseKeyValidityState(){return hu.get(this).licenseKeyValidityState}getConfig(){return Pl(this)}mergeConfig(e){const t=Object.assign({},this.getConfig(),e);return new st(t,!1)}static warnDeprecatedOptions(e){}static warnDeprecatedIfUsed(e,t,r,n){e!==void 0&&console.warn(n===void 0?`${t} option is deprecated since ${r}`:`${t} option is deprecated since ${r}, please use ${n}`)}}st.defaultConfig={accentSensitive:!1,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",context:void 0,chooseAddressMappingPolicy:new hR,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:eR,precisionEpsilon:1e-13,precisionRounding:10,smartRounding:!0,stringifyDateTime:ER,stringifyDuration:gR,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};function Pl(s){var e;const t={};for(const r in st.defaultConfig){const n=(e=s[r])!==null&&e!==void 0?e:st.defaultConfig[r];Array.isArray(n)?t[r]=[...n]:t[r]=n}return t}function IT(){return Pl({})}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const pa={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ADDRESS:"ADDRESS",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",HYPERLINK:"HYPERLINK",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",IFS:"IFS",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",XLOOKUP:"XLOOKUP",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var ar;(function(s){s[s.FullyAbsolute=1]="FullyAbsolute",s[s.RowAbsoluteColRelative=2]="RowAbsoluteColRelative",s[s.RowRelativeColAbsolute=3]="RowRelativeColAbsolute",s[s.FullyRelative=4]="FullyRelative"})(ar||(ar={}));class Vl extends P{verifyAddressArguments(e,t,r,n){if(n){if(e<1||t<1)return new p(m.VALUE,R.LessThanOne)}else if(ar.FullyAbsolute==r){if(e<1||t<1)return new p(m.VALUE,R.LessThanOne)}else if(ar.RowAbsoluteColRelative==r){if(e<1)return new p(m.VALUE,R.LessThanOne)}else if(ar.RowRelativeColAbsolute==r&&t<1)return new p(m.VALUE,R.LessThanOne)}address(e,t){return this.runFunction(e.args,t,this.metadata("ADDRESS"),(r,n,i,a,o)=>{const u=this.verifyAddressArguments(r,n,i,a);if(u!==void 0)return u;const l=ii(n-1);let c="";o!=null&&(c=`${o}!`);const d=n==0?"C":`C[${n}]`,f=r==0?"R":`R[${r}]`;return ar.FullyRelative==i?a?`${c}${l}${r}`:`${c}${f}${d}`:ar.RowRelativeColAbsolute==i?a?`${c}$${l}${r}`:`${c}${f}C${n}`:ar.RowAbsoluteColRelative==i?a?`${c}${l}$${r}`:`${c}R${r}${d}`:a?`${c}$${l}$${r}`:`${c}R${r}C${n}`})}}Vl.implementedFunctions={ADDRESS:{method:"address",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER,optionalArg:!0,defaultValue:1,minValue:1,maxValue:4},{argumentType:h.BOOLEAN,optionalArg:!0,defaultValue:!0},{argumentType:h.STRING,optionalArg:!0}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Dl extends P{arrayformula(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),r=>r)}arrayformulaArraySize(e,t){if(e.args.length!==1)return V.error();const r=this.metadata("ARRAYFORMULA");return e.args.map(i=>{var a;return this.arraySizeForAst(i,new Bt(t.formulaAddress,t.arraysFlag||((a=r?.enableArrayArithmeticForArguments)!==null&&a!==void 0?a:!1)))})[0]}arrayconstrain(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),(r,n,i)=>{n=Math.min(n,r.height()),i=Math.min(i,r.width());const a=r.data,o=[];for(let u=0;u<n;u++)o.push(a[u].slice(0,i));return w.onlyValues(o)})}arrayconstrainArraySize(e,t){if(e.args.length!==3)return V.error();const r=this.metadata("ARRAY_CONSTRAIN"),n=e.args.map(o=>{var u;return this.arraySizeForAst(o,new Bt(t.formulaAddress,t.arraysFlag||((u=r?.enableArrayArithmeticForArguments)!==null&&u!==void 0?u:!1)))});let{height:i,width:a}=n[0];return e.args[1].type===g.NUMBER&&(i=Math.min(i,e.args[1].value)),e.args[2].type===g.NUMBER&&(a=Math.min(a,e.args[2].value)),i<1||a<1||!Number.isInteger(i)||!Number.isInteger(a)?V.error():new V(a,i)}filter(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),(r,...n)=>{for(const o of n)if(r.width()!==o.width()||r.height()!==o.height())return new p(m.NA,R.EqualLength);if(r.width()>1&&r.height()>1)return new p(m.NA,R.WrongDimension);const i=r.data,a=[];for(let o=0;o<r.height();o++){const u=[];for(let l=0;l<r.width();l++){let c=!0;for(const d of n)if(gl(d.data[o][l])!==!0){c=!1;break}c&&u.push(i[o][l])}u.length>0&&a.push(u)}return a.length>0?w.onlyValues(a):new p(m.NA,R.EmptyRange)})}filterArraySize(e,t){if(e.args.length<=1)return V.error();const r=this.metadata("FILTER"),n=e.args.map(o=>{var u;return this.arraySizeForAst(o,new Bt(t.formulaAddress,t.arraysFlag||((u=r?.enableArrayArithmeticForArguments)!==null&&u!==void 0?u:!1)))}),i=Math.max(...n.map(o=>o.width)),a=Math.max(...n.map(o=>o.height));return new V(i,a)}}Dl.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",sizeOfResultArrayMethod:"arrayformulaArraySize",enableArrayArithmeticForArguments:!0,parameters:[{argumentType:h.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",sizeOfResultArrayMethod:"arrayconstrainArraySize",parameters:[{argumentType:h.RANGE},{argumentType:h.INTEGER,minValue:1},{argumentType:h.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",sizeOfResultArrayMethod:"filterArraySize",enableArrayArithmeticForArguments:!0,parameters:[{argumentType:h.RANGE},{argumentType:h.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Bl extends P{abs(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}Bl.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:h.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const OT=0xffffffffffff,lu=-53,cu=53;class kl extends P{bitlshift(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),Gl)}bitrshift(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),Hl)}}kl.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:h.INTEGER,minValue:0},{argumentType:h.INTEGER,minValue:lu,maxValue:cu}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:h.INTEGER,minValue:0},{argumentType:h.INTEGER,minValue:lu,maxValue:cu}]}};function Gl(s,e){return e<0?Hl(s,-e):Wl(s*Math.pow(2,e))}function Hl(s,e){return e<0?Gl(s,-e):Wl(Math.floor(s/Math.pow(2,e)))}function Wl(s){return s>OT?new p(m.NUM,R.BitshiftLong):s}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Yl extends P{bitand(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),(r,n)=>r&n)}bitor(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),(r,n)=>r|n)}bitxor(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),(r,n)=>r^n)}}Yl.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:h.INTEGER,minValue:0},{argumentType:h.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:h.INTEGER,minValue:0},{argumentType:h.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:h.INTEGER,minValue:0},{argumentType:h.INTEGER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class zl extends P{literalTrue(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),()=>!0)}literalFalse(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),()=>!1)}conditionalIf(e,t){return this.runFunction(e.args,t,this.metadata("IF"),(r,n,i)=>r?n:i)}ifs(e,t){return this.runFunction(e.args,t,this.metadata("IFS"),(...r)=>{for(let n=0;n<r.length;n+=2)if(r[n])return r[n+1];return new p(m.NA,R.NoConditionMet)})}and(e,t){return this.runFunction(e.args,t,this.metadata("AND"),(...r)=>r.filter(n=>n!==void 0).every(n=>!!n))}or(e,t){return this.runFunction(e.args,t,this.metadata("OR"),(...r)=>r.filter(n=>n!==void 0).some(n=>n))}not(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),r=>!r)}xor(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),(...r)=>{let n=0;return r.filter(i=>i!==void 0).forEach(i=>{i&&n++}),n%2===1})}switch(e,t){return this.runFunction(e.args,t,this.metadata("SWITCH"),(r,...n)=>{const i=n.length;let a=0;for(;a+1<i;a+=2)if(!(n[a]instanceof p)&&this.arithmeticHelper.eq(r,n[a]))return n[a+1];return a<i?n[a]:new p(m.NA,R.NoDefault)})}iferror(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),(r,n)=>r instanceof p?n:r)}ifna(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),(r,n)=>r instanceof p&&r.type===m.NA?n:r)}choose(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),(r,...n)=>r>n.length?new p(m.NUM,R.Selector):n[r-1])}}zl.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:h.BOOLEAN},{argumentType:h.SCALAR,passSubtype:!0},{argumentType:h.SCALAR,defaultValue:!1,passSubtype:!0}]},IFS:{method:"ifs",parameters:[{argumentType:h.BOOLEAN},{argumentType:h.SCALAR,passSubtype:!0}],repeatLastArgs:2},AND:{method:"and",parameters:[{argumentType:h.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:h.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:h.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:h.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:h.NOERROR},{argumentType:h.SCALAR,passSubtype:!0},{argumentType:h.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:h.SCALAR,passSubtype:!0},{argumentType:h.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:h.SCALAR,passSubtype:!0},{argumentType:h.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:h.INTEGER,minValue:1},{argumentType:h.SCALAR,passSubtype:!0}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class $l extends P{char(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),r=>r<1||r>=256?new p(m.VALUE,R.CharacterCodeBounds):String.fromCharCode(Math.trunc(r)))}unichar(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),r=>r<1||r>=1114112?new p(m.VALUE,R.CharacterCodeBounds):String.fromCodePoint(Math.trunc(r)))}}$l.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:h.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:h.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Xl extends P{code(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),r=>r.length===0?new p(m.VALUE,R.EmptyString):r.charCodeAt(0))}unicode(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),r=>{var n;return(n=r.codePointAt(0))!==null&&n!==void 0?n:new p(m.VALUE,R.EmptyString)})}}Xl.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:h.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:h.STRING}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Kl extends P{countblank(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),(...r)=>{let n=0;return r.forEach(i=>{i===B&&n++}),n})}}Kl.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:h.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class jl extends P{countunique(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),(...r)=>{const n=new Set,i=new Set;for(const a of r)a instanceof p?i.add(a.type):a!==""&&n.add(a);return n.size+i.size})}}jl.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:h.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ql extends P{constructor(){super(...arguments),this.isoweeknumCore=e=>{const t=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),r=this.dateTimeHelper.numberToSimpleDate(e),n=this.dateTimeHelper.dateToNumber({year:r.year,month:1,day:1}),i=this.dateTimeHelper.relativeNumberToAbsoluteNumber(n),a=i+((4-i)%7+7)%7,o=Math.floor((t-1)/7)-Math.floor((a-1)/7)+1;return o===0?this.isoweeknumCore(e-7)+1:o},this.days360Core=(e,t,r)=>{const n=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.numberToSimpleDate(t);let a,o;return r?(a=Zo(n),o=Zo(i)):[a,o]=this.dateTimeHelper.toBasisUS(n,i),360*(o.year-a.year)+30*(o.month-a.month)+o.day-a.day}}date(e,t){return this.runFunction(e.args,t,this.metadata("DATE"),(r,n,i)=>{const a=Math.trunc(i);let o=Math.trunc(n),u=Math.trunc(r);u<this.dateTimeHelper.getEpochYearZero()&&(u+=this.dateTimeHelper.getEpochYearZero());const l=Math.floor((o-1)/12);u+=l,o-=l*12;const c={year:u,month:o,day:1};if(this.dateTimeHelper.isValidDate(c)){let d=this.dateTimeHelper.dateToNumber(c)+(a-1);return d=this.dateTimeHelper.getWithinBounds(d),d===void 0?new p(m.NUM,R.DateBounds):d}return new p(m.VALUE,R.InvalidDate)})}time(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),(r,n,i)=>{const a=hn({hours:Math.trunc(r),minutes:Math.trunc(n),seconds:Math.trunc(i)});return a<0?new p(m.NUM,R.NegativeTime):a%1})}eomonth(e,t){return this.runFunction(e.args,t,this.metadata("EOMONTH"),(r,n)=>{const i=this.dateTimeHelper.numberToSimpleDate(r);let a=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth(Qo(i,n)));return a=this.dateTimeHelper.getWithinBounds(a),a===void 0?new p(m.NUM,R.DateBounds):a})}day(e,t){return this.runFunction(e.args,t,this.metadata("DAY"),r=>this.dateTimeHelper.numberToSimpleDate(r).day)}days(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),(r,n)=>Math.trunc(r)-Math.trunc(n))}month(e,t){return this.runFunction(e.args,t,this.metadata("MONTH"),r=>this.dateTimeHelper.numberToSimpleDate(r).month)}year(e,t){return this.runFunction(e.args,t,this.metadata("YEAR"),r=>this.dateTimeHelper.numberToSimpleDate(r).year)}hour(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),r=>un(Fi(r)%1).hours)}minute(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),r=>un(Fi(r)%1).minutes)}second(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),r=>un(Fi(r)%1).seconds)}text(e,t){return this.runFunction(e.args,t,this.metadata("TEXT"),(r,n)=>pR(r,n,this.config,this.dateTimeHelper))}weekday(e,t){return this.runFunction(e.args,t,this.metadata("WEEKDAY"),(r,n)=>{const i=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(r));if(n===3)return(i-1)%7;const a=fu.get(n);return a===void 0?new p(m.NUM,R.BadMode):(i-a)%7+1})}weeknum(e,t){return this.runFunction(e.args,t,this.metadata("WEEKNUM"),(r,n)=>{const i=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(r)),a=this.dateTimeHelper.numberToSimpleDate(r),o=this.dateTimeHelper.dateToNumber({year:a.year,month:1,day:1}),u=this.dateTimeHelper.relativeNumberToAbsoluteNumber(o);if(n===21)return this.isoweeknumCore(r);const l=fu.get(n);return l===void 0?new p(m.NUM,R.BadMode):Math.floor((i-l)/7)-Math.floor((u-l)/7)+1})}isoweeknum(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,t){return this.runFunction(e.args,t,this.metadata("DATEVALUE"),r=>{const{dateTime:n}=this.dateTimeHelper.parseDateTimeFromConfigFormats(r);return n===void 0?new p(m.VALUE,R.IncorrectDateTime):Fn(n)?(yl(n)?Math.trunc(hn(n)):0)+this.dateTimeHelper.dateToNumber(n):0})}timevalue(e,t){return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),r=>{const n=this.dateTimeHelper.dateStringToDateNumber(r);return n===void 0?new p(m.VALUE,R.IncorrectDateTime):I(n)%1})}now(e,t){return this.runFunction(e.args,t,this.metadata("NOW"),()=>{const r=new Date(Date.now());return hn({hours:r.getHours(),minutes:r.getMinutes(),seconds:r.getSeconds()})+this.dateTimeHelper.dateToNumber({year:r.getFullYear(),month:r.getMonth()+1,day:r.getDate()})})}today(e,t){return this.runFunction(e.args,t,this.metadata("TODAY"),()=>{const r=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:r.getFullYear(),month:r.getMonth()+1,day:r.getDate()})})}edate(e,t){return this.runFunction(e.args,t,this.metadata("EDATE"),(r,n)=>{const i=this.dateTimeHelper.numberToSimpleDate(r),a=oR(Qo(i,n));let o=this.dateTimeHelper.dateToNumber(a);return o=this.dateTimeHelper.getWithinBounds(o),o===void 0?new p(m.NUM,R.DateBounds):o})}datedif(e,t){return this.runFunction(e.args,t,this.metadata("DATEDIF"),(r,n,i)=>{if(r>n)return new p(m.NUM,R.StartEndDate);if(i==="D")return Math.floor(n)-Math.floor(r);const a=this.dateTimeHelper.numberToSimpleDate(r),o=this.dateTimeHelper.numberToSimpleDate(n);switch(i){case"M":return(o.year-a.year)*12+(o.month-a.month)-(o.day<a.day?1:0);case"YM":return(12+(o.month-a.month)-(o.day<a.day?1:0))%12;case"Y":return o.month>a.month||o.month===a.month&&o.day>=a.day?o.year-a.year:o.year-a.year-1;case"MD":if(o.day>=a.day)return o.day-a.day;{const u=o.month===1?12:o.month-1,l=o.month===1?o.year-1:o.year;return this.dateTimeHelper.daysInMonth(l,u)+o.day-a.day}case"YD":return o.month>a.month||o.month===a.month&&o.day>=a.day?Math.floor(n)-this.dateTimeHelper.dateToNumber({year:o.year,month:a.month,day:a.day}):Math.floor(n)-Math.floor(r)-365*(o.year-a.year-1)-this.dateTimeHelper.leapYearsCount(o.year-1)+this.dateTimeHelper.leapYearsCount(a.year);default:return new p(m.NUM,R.BadMode)}})}days360(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,t){return this.runFunction(e.args,t,this.metadata("YEARFRAC"),(r,n,i)=>{switch(r=Math.trunc(r),n=Math.trunc(n),r>n&&([r,n]=[n,r]),i){case 0:return this.days360Core(r,n,!1)/360;case 1:return(n-r)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(r),this.dateTimeHelper.numberToSimpleDate(n));case 2:return(n-r)/360;case 3:return(n-r)/365;case 4:return this.days360Core(r,n,!0)/360}throw new Error("Should not be reachable.")})}interval(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),r=>{r=Math.trunc(r);const n=r%60;r=Math.trunc(r/60);const i=r%60;r=Math.trunc(r/60);const a=r%24;r=Math.trunc(r/24);const o=r%30;r=Math.trunc(r/30);const u=r%12,l=Math.trunc(r/12);return"P"+(l>0?`${l}Y`:"")+(u>0?`${u}M`:"")+(o>0?`${o}D`:"")+"T"+(a>0?`${a}H`:"")+(i>0?`${i}M`:"")+(n>0?`${n}S`:"")})}networkdays(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),(r,n,i)=>this.networkdayscore(r,n,1,i))}networkdaysintl(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),(r,n,i,a)=>this.networkdayscore(r,n,i,a))}workday(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY"),(r,n,i)=>this.workdaycore(r,n,1,i))}workdayintl(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),(r,n,i,a)=>this.workdaycore(r,n,i,a))}networkdayscore(e,t,r,n){e=Math.trunc(e),t=Math.trunc(t);let i=1;e>t&&([e,t]=[t,e],i=-1);const a=pu(r);if(a instanceof p)return a;const o=this.simpleRangeToFilteredHolidays(a,n);return o instanceof p?o:i*this.countWorkdays(e,t,a,o)}workdaycore(e,t,r,n){e=Math.trunc(e),t=Math.trunc(t);const i=pu(r);if(i instanceof p)return i;const a=this.simpleRangeToFilteredHolidays(i,n);if(a instanceof p)return a;if(t>0){let o=1;for(;this.countWorkdays(e+1,e+o,i,a)<t;)o*=2;let u=1;for(;u+1<o;){const l=Math.trunc((u+o)/2);this.countWorkdays(e+1,e+l,i,a)<t?u=l:o=l}return e+o}else if(t<0){t*=-1;let o=1;for(;this.countWorkdays(e-o,e-1,i,a)<t;)o*=2;let u=1;for(;u+1<o;){const l=Math.trunc((u+o)/2);this.countWorkdays(e-l,e-1,i,a)<t?u=l:o=l}return e-o}else return e}countWorkdays(e,t,r,n){const i=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),a=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let o=0;for(let u=0;u<7;u++)r.charAt(u)==="0"&&(o+=Math.floor((i+6-u)/7),o-=Math.floor((a-1+6-u)/7));return o-=du(t+1,n)-du(e,n),o}simpleRangeToFilteredHolidays(e,t){var r;const n=(r=t?.valuesFromTopLeftCorner())!==null&&r!==void 0?r:[];for(const a of n)if(a instanceof p)return a;const i=[];for(const a of n)if(a!==B)if(X(a))i.push(Math.trunc(I(a)));else return new p(m.VALUE,R.WrongType);return[...new Set(i)].sort((a,o)=>a-o).filter(a=>{const u=(this.dateTimeHelper.relativeNumberToAbsoluteNumber(a)-1)%7;return e.charAt(u)==="0"})}}ql.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER}],returnNumberType:L.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER}],returnNumberType:L.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:h.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:h.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:h.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:h.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:h.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:h.NUMBER},{argumentType:h.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER}],returnNumberType:L.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:h.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:h.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:h.STRING}],returnNumberType:L.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:h.STRING}],returnNumberType:L.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:L.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:L.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER}],returnNumberType:L.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:0},{argumentType:h.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:0},{argumentType:h.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:0},{argumentType:h.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:h.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:0},{argumentType:h.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:0},{argumentType:h.NOERROR,defaultValue:1},{argumentType:h.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER},{argumentType:h.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER},{argumentType:h.NOERROR,defaultValue:1},{argumentType:h.RANGE,optionalArg:!0}]}};function du(s,e){if(e.length===0||s<=e[0])return 0;if(e[e.length-1]<s)return e.length;let t=0,r=e.length-1;for(;t+1<r;){const n=Math.floor((r+t)/2);e[n]>=s?r=n:t=n}return r}function pu(s){var e;return typeof s!="number"&&typeof s!="string"?new p(m.VALUE,R.WrongType):typeof s=="string"?s.length!==7||!/^(0|1)*$/.test(s)||s==="1111111"?new p(m.NUM,R.WeekendString):s:(e=MT.get(s))!==null&&e!==void 0?e:new p(m.NUM,R.BadMode)}const fu=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),MT=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Ql extends P{degrees(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),r=>r*(180/Math.PI))}}Ql.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:h.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Zl extends P{delta(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),(r,n)=>r===n?1:0)}}Zl.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,defaultValue:0}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Jl extends P{exp(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}Jl.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:h.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ec extends P{pmt(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),ja)}ipmt(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),fa)}ppmt(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),mu)}fv(e,t){return this.runFunction(e.args,t,this.metadata("FV"),ma)}cumipmt(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),(r,n,i,a,o,u)=>{if(a>o)return new p(m.NUM,R.EndStartPeriod);let l=0;for(let c=a;c<=o;c++)l+=fa(r,c,n,i,0,u);return l})}cumprinc(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),(r,n,i,a,o,u)=>{if(a>o)return new p(m.NUM,R.EndStartPeriod);let l=0;for(let c=a;c<=o;c++)l+=mu(r,c,n,i,0,u);return l})}db(e,t){return this.runFunction(e.args,t,this.metadata("DB"),(r,n,i,a,o)=>{if(o===12&&a>i||a>i+1)return new p(m.NUM,R.PeriodLong);if(n>=r)return 0;const u=Math.round((1-Math.pow(n/r,1/i))*1e3)/1e3,l=r*u*o/12;if(a===1)return l;let c=l;for(let d=0;d<a-2;d++)c+=(r-c)*u;return a===i+1?(r-c)*u*(12-o)/12:(r-c)*u})}ddb(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),(r,n,i,a,o)=>{if(a>i)return new p(m.NUM);let u=o/i,l;u>=1?(u=1,a===1?l=r:l=0):l=r*Math.pow(1-u,a-1);const c=r*Math.pow(1-u,a);return Math.max(l-Math.max(n,c),0)})}dollarde(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),(r,n)=>{if(n<1)return new p(m.DIV_BY_ZERO);for(n=Math.trunc(n);n>10;)n/=10;return Math.trunc(r)+(r-Math.trunc(r))*10/n})}dollarfr(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),(r,n)=>{if(n<1)return new p(m.DIV_BY_ZERO);for(n=Math.trunc(n);n>10;)n/=10;return Math.trunc(r)+(r-Math.trunc(r))*n/10})}effect(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),(r,n)=>(n=Math.trunc(n),Math.pow(1+r/n,n)-1))}ispmt(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),(r,n,i,a)=>i===0?new p(m.DIV_BY_ZERO):a*r*(n/i-1))}nominal(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),(r,n)=>(n=Math.trunc(n),(Math.pow(r+1,1/n)-1)*n))}nper(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),(r,n,i,a,o)=>r===0?n===0?new p(m.DIV_BY_ZERO):(-i-a)/n:(o&&(n*=1+r),Math.log((n-a*r)/(i*r+n))/Math.log(1+r)))}rate(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),(r,n,i,a,o,u)=>{if(u<=-1)return new p(m.VALUE);const l=1e-7,c=50;let d=u;o=o?1:0;for(let f=0;f<c;f++){if(d<=-1)return new p(m.NUM);let T;if(Math.abs(d)<l)T=i*(1+r*d)+n*(1+d*o)*r+a;else{const E=Math.pow(1+d,r);T=i*E+n*(1/d+o)*(E-1)+a}if(Math.abs(T)<l)return d;let N;if(Math.abs(d)<l)N=i*r+n*o*r;else{const E=Math.pow(1+d,r),S=r*Math.pow(1+d,r-1);N=i*S+n*(1/d+o)*S+n*(-1/(d*d))*(E-1)}d-=T/N}return new p(m.NUM)})}pv(e,t){return this.runFunction(e.args,t,this.metadata("PV"),(r,n,i,a,o)=>(o=o?1:0,r===-1?n===0?new p(m.NUM):new p(m.DIV_BY_ZERO):r===0?-i*n-a:((1-Math.pow(1+r,n))*i*(1+r*o)/r-a)/Math.pow(1+r,n)))}rri(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),(r,n,i)=>n===0||i<0&&n>0||i>0&&n<0?new p(m.NUM):Math.pow(i/n,1/r)-1)}sln(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),(r,n,i)=>i===0?new p(m.DIV_BY_ZERO):(r-n)/i)}syd(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),(r,n,i,a)=>a>i?new p(m.NUM):(r-n)*(i-a+1)*2/(i*(i+1)))}tbilleq(e,t){return this.runFunction(e.args,t,this.metadata("TBILLEQ"),(r,n,i)=>{if(r=Math.round(r),n=Math.round(n),r>=n)return new p(m.NUM);const a=this.dateTimeHelper.numberToSimpleDate(r),o=this.dateTimeHelper.numberToSimpleDate(n);if(o.year>a.year+1||o.year===a.year+1&&(o.month>a.month||o.month===a.month&&o.day>a.day))return new p(m.NUM);const u=360-i*(n-r);return u===0?0:u<0?new p(m.NUM):365*i/u})}tbillprice(e,t){return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),(r,n,i)=>{if(r=Math.round(r),n=Math.round(n),r>=n)return new p(m.NUM);const a=this.dateTimeHelper.numberToSimpleDate(r),o=this.dateTimeHelper.numberToSimpleDate(n);if(o.year>a.year+1||o.year===a.year+1&&(o.month>a.month||o.month===a.month&&o.day>a.day))return new p(m.NUM);const u=360-i*(n-r);return u===0?0:u<0?new p(m.NUM):100*(1-i*(n-r)/360)})}tbillyield(e,t){return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),(r,n,i)=>{if(r=Math.round(r),n=Math.round(n),r>=n)return new p(m.NUM);const a=this.dateTimeHelper.numberToSimpleDate(r),o=this.dateTimeHelper.numberToSimpleDate(n);return o.year>a.year+1||o.year===a.year+1&&(o.month>a.month||o.month===a.month&&o.day>a.day)?new p(m.NUM):(100-i)*360/(i*(n-r))})}fvschedule(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),(r,n)=>{const i=n.valuesFromTopLeftCorner();for(const a of i)if(a instanceof p)return a;for(const a of i)if(X(a))r*=1+I(a);else if(a!==B)return new p(m.VALUE,R.NumberExpected);return r})}npv(e,t){return this.runFunction(e.args,t,this.metadata("NPV"),(r,...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);return i instanceof p?i:xi(r,i)})}mirr(e,t){return this.runFunction(e.args,t,this.metadata("MIRR"),(r,n,i)=>{const a=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());if(a instanceof p)return a;let o=!1,u=!1;const l=[],c=[];for(const N of a)N>0?(o=!0,l.push(N),c.push(0)):N<0?(u=!0,c.push(N),l.push(0)):(c.push(0),l.push(0));if(!o||!u)return new p(m.DIV_BY_ZERO);const d=a.length,f=xi(i,l);if(f instanceof p)return f;const T=xi(n,c);return T instanceof p?T:Math.pow(-f*Math.pow(1+i,d)/T/(1+n),1/(d-1))-1})}pduration(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),(r,n,i)=>(Math.log(i)-Math.log(n))/Math.log(1+r))}xnpv(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),(r,n,i)=>{const a=n.valuesFromTopLeftCorner();for(const f of a)if(typeof f!="number")return new p(m.VALUE,R.NumberExpected);const o=a,u=i.valuesFromTopLeftCorner();for(const f of u)if(typeof f!="number")return new p(m.VALUE,R.NumberExpected);const l=u;if(l.length!==o.length)return new p(m.NUM,R.EqualLength);const c=l.length;let d=0;if(l[0]<0)return new p(m.NUM,R.ValueSmall);for(let f=0;f<c;f++){if(l[f]=Math.floor(l[f]),l[f]<l[0])return new p(m.NUM,R.ValueSmall);d+=o[f]/Math.pow(1+r,(l[f]-l[0])/365)}return d})}}ec.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER,defaultValue:0},{argumentType:h.NUMBER,defaultValue:0}],returnNumberType:L.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER,defaultValue:0},{argumentType:h.NUMBER,defaultValue:0}],returnNumberType:L.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER,defaultValue:0},{argumentType:h.NUMBER,defaultValue:0}],returnNumberType:L.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER,defaultValue:0},{argumentType:h.NUMBER,defaultValue:0}],returnNumberType:L.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.INTEGER,minValue:1},{argumentType:h.INTEGER,minValue:1},{argumentType:h.INTEGER,minValue:0,maxValue:1}],returnNumberType:L.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.INTEGER,minValue:1},{argumentType:h.INTEGER,minValue:1},{argumentType:h.INTEGER,minValue:0,maxValue:1}],returnNumberType:L.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:0},{argumentType:h.INTEGER,minValue:0},{argumentType:h.INTEGER,minValue:0},{argumentType:h.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:L.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:0},{argumentType:h.INTEGER,minValue:0},{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:L.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:1}],returnNumberType:L.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:1}],returnNumberType:L.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER,defaultValue:0},{argumentType:h.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER,defaultValue:0},{argumentType:h.NUMBER,defaultValue:0}],returnNumberType:L.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER,defaultValue:0},{argumentType:h.NUMBER,defaultValue:0},{argumentType:h.NUMBER,defaultValue:.1}],returnNumberType:L.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER},{argumentType:h.NUMBER}],returnNumberType:L.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER}],returnNumberType:L.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER,greaterThan:0}],returnNumberType:L.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,greaterThan:0}],returnNumberType:L.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,greaterThan:0}],returnNumberType:L.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,greaterThan:0}],returnNumberType:L.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:h.NUMBER},{argumentType:h.RANGE}],returnNumberType:L.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:h.NUMBER},{argumentType:h.ANY}],repeatLastArgs:1,returnNumberType:L.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:h.RANGE},{argumentType:h.NUMBER},{argumentType:h.NUMBER}],returnNumberType:L.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:h.NUMBER,greaterThan:-1},{argumentType:h.RANGE},{argumentType:h.RANGE}]}};function ja(s,e,t,r,n){if(s===0)return(-t-r)/e;{const i=Math.pow(1+s,e);return(r*s+t*s*i)*(n?1/(1+s):1)/(1-i)}}function fa(s,e,t,r,n,i){const a=ja(s,t,r,n,i);return e===1?s*(i?0:-r):s*(i?ma(s,e-2,a,r,i)-a:ma(s,e-1,a,r,i))}function ma(s,e,t,r,n){if(s===0)return-r-t*e;{const i=Math.pow(1+s,e);return t*(n?1+s:1)*(1-i)/s-r*i}}function mu(s,e,t,r,n,i){return ja(s,t,r,n,i)-fa(s,e,t,r,n,i)}function xi(s,e){let t=0;for(let r=e.length-1;r>=0;r--){if(t+=e[r],s===-1){if(t===0)continue;return new p(m.DIV_BY_ZERO)}t/=1+s}return t}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class tc extends P{formulatext(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),()=>new p(m.NA,R.WrongArgNumber),r=>{var n;return(n=this.serialization.getCellFormula(r))!==null&&n!==void 0?n:new p(m.NA,R.Formula)})}}tc.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:h.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class rc extends P{hyperlink(e,t){return this.runFunction(e.args,t,this.metadata("HYPERLINK"),(r,n)=>(e.hyperlink=r,n??r))}}rc.implementedFunctions={HYPERLINK:{method:"hyperlink",parameters:[{argumentType:h.STRING},{argumentType:h.STRING,optionalArg:!0}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class nc extends P{isbinary(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),r=>/^[01]{1,10}$/.test(r))}iserr(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),r=>r instanceof p&&r.type!==m.NA)}iserror(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),r=>r instanceof p)}isformula(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),()=>new p(m.NA,R.WrongArgNumber),r=>this.dependencyGraph.addressMapping.getCell(r)instanceof nt)}isblank(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),r=>r===B)}isna(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),r=>r instanceof p&&r.type==m.NA)}isnumber(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),X)}islogical(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),r=>typeof r=="boolean")}isref(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),r=>r instanceof p&&(r.type==m.REF||r.type==m.CYCLE))}istext(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),r=>typeof r=="string")}isnontext(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),r=>typeof r!="string")}column(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),()=>t.formulaAddress.col+1,r=>r.col+1)}columns(e,t){if(e.args.length!==1)return new p(m.NA,R.WrongArgNumber);if(e.args.some(n=>n.type===g.EMPTY))return new p(m.NUM,R.EmptyArg);let r=e.args[0];for(;r.type===g.PARENTHESIS;)r=r.expression;if(r.type===g.CELL_RANGE||r.type===g.COLUMN_RANGE)return r.end.col-r.start.col+1;if(r.type===g.CELL_REFERENCE)return 1;if(r.type===g.ROW_RANGE)return this.config.maxColumns;{const n=this.evaluateAst(r,t);return n instanceof w?n.width():n instanceof p?n:1}}row(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),()=>t.formulaAddress.row+1,r=>r.row+1)}rows(e,t){if(e.args.length!==1)return new p(m.NA,R.WrongArgNumber);if(e.args.some(n=>n.type===g.EMPTY))return new p(m.NUM,R.EmptyArg);let r=e.args[0];for(;r.type===g.PARENTHESIS;)r=r.expression;if(r.type===g.CELL_RANGE||r.type===g.ROW_RANGE)return r.end.row-r.start.row+1;if(r.type===g.CELL_REFERENCE)return 1;if(r.type===g.COLUMN_RANGE)return this.config.maxRows;{const n=this.evaluateAst(r,t);return n instanceof w?n.height():n instanceof p?n:1}}index(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),(r,n,i)=>{var a,o,u,l,c,d;return i<1||n<1?new p(m.VALUE,R.LessThanOne):i>r.width()||n>r.height()?new p(m.NUM,R.ValueLarge):(d=(u=(o=(a=r?.data)===null||a===void 0?void 0:a[n-1])===null||o===void 0?void 0:o[i-1])!==null&&u!==void 0?u:(c=(l=r?.data)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c[0])!==null&&d!==void 0?d:new p(m.VALUE,R.CellRangeExpected)})}na(e,t){return new p(m.NA)}sheet(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),()=>t.formulaAddress.sheet+1,r=>r.sheet+1,r=>{const n=this.dependencyGraph.sheetMapping.get(r);return n!==void 0?n+1:new p(m.NA,R.SheetRef)})}sheets(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),()=>this.dependencyGraph.sheetMapping.numberOfSheets(),()=>1,()=>new p(m.VALUE,R.CellRefExpected))}}nc.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:h.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:h.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:h.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:h.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:h.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:h.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:h.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:h.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:h.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:h.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:h.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:h.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:h.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:h.RANGE},{argumentType:h.NUMBER},{argumentType:h.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:h.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:h.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:h.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:h.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class sc extends P{iseven(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),r=>r%2===0)}}sc.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:h.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ic extends P{isodd(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),r=>r%2===1)}}ic.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:h.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ac extends P{log10(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}log(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),(r,n)=>Math.log(r)/Math.log(n))}ln(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}ac.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:h.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:h.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const ga=parseFloat(Math.PI.toFixed(14));class oc extends P{pi(e,t){return this.runFunction(e.args,t,this.metadata("PI"),()=>ga)}sqrtpi(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),r=>Math.sqrt(ga*r))}}oc.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:h.NUMBER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function gu(s,e){return new V(e.width,s.height)}function Pi(s,e,t){return new V(1+(s.width-e)/t,1+(s.height-e)/t)}class uc extends P{mmult(e,t){return this.runFunction(e.args,t,this.metadata("MMULT"),(r,n)=>{if(!r.hasOnlyNumbers()||!n.hasOnlyNumbers())return new p(m.VALUE,R.NumberRange);if(n.height()!==r.width())return new p(m.VALUE,R.ArrayDimensions);const i=gu(r.size,n.size),a=this.createKernel(function(o,u,l){let c=0;for(let d=0;d<l;++d)c+=o[this.thread.y][d]*u[d][this.thread.x];return c},i)(r.rawNumbers(),n.rawNumbers(),r.width());return w.onlyNumbers(a)})}mmultArraySize(e,t){if(e.args.length!==2)return V.error();const r=this.metadata("MMULT"),n=e.args.map(o=>{var u;return this.arraySizeForAst(o,new Bt(t.formulaAddress,t.arraysFlag||((u=r?.enableArrayArithmeticForArguments)!==null&&u!==void 0?u:!1)))}),[i,a]=n;return gu(i,a)}maxpool(e,t){return this.runFunction(e.args,t,this.metadata("MAXPOOL"),(r,n,i=n)=>{if(!r.hasOnlyNumbers())return new p(m.VALUE,R.NumberRange);const a=Pi(r.size,n,i),o=this.createKernel(function(u,l,c){const d=this.thread.x*c,f=this.thread.y*c;let T=u[f][d];for(let N=0;N<l;N++)for(let E=0;E<l;E++)T=Math.max(T,u[f+N][d+E]);return T},a)(r.rawNumbers(),n,i);return w.onlyNumbers(o)})}medianpool(e,t){return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),(r,n,i=n)=>{if(!r.hasOnlyNumbers())return new p(m.VALUE,R.NumberRange);const a=Pi(r.size,n,i),o=this.createKernel(function(u,l,c){const d=this.thread.x*c,f=this.thread.y*c;let T=u[f][d];for(let C=0;C<l;C++)for(let M=0;M<l;M++)T=Math.max(T,u[f+C][d+M]);let N=u[f][d];for(let C=0;C<l;C++)for(let M=0;M<l;M++)N=Math.min(N,u[f+C][d+M]);const E=l*l;let S=N,A=T,y=42;for(let C=0;C<32;C++){const M=(S+A)/2;let re=0;for(let J=0;J<l;J++)for(let j=0;j<l;j++)u[f+J][d+j]>M&&re++;if(l%2===0)if(re===E/2){y=M;break}else re>E/2?S=M:A=M;else if(re===(E-1)/2){y=M;break}else re>(E-1)/2?S=M:A=M}return y},a)(r.rawNumbers(),n,i);return w.onlyNumbers(o)})}maxpoolArraySize(e,t){if(e.args.length<2||e.args.length>3)return V.error();const r=this.metadata("MAXPOOL"),i=e.args.map(l=>{var c;return this.arraySizeForAst(l,new Bt(t.formulaAddress,t.arraysFlag||((c=r?.enableArrayArithmeticForArguments)!==null&&c!==void 0?c:!1)))})[0],a=e.args[1];let o;a.type===g.NUMBER?o=a.value:o=1;let u=o;if(e.args.length===3){const l=e.args[2];l.type===g.NUMBER?u=l.value:u=1}return o>i.width||o>i.height||u>o||(i.width-o)%u!==0||(i.height-o)%u!==0?V.error():Pi(i,o,u)}medianpoolArraySize(e,t){return this.maxpoolArraySize(e,t)}transpose(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),r=>{const n=r.rawData(),i=r.size,a=[];for(let o=0;o<i.width;++o){a[o]=[];for(let u=0;u<i.height;++u)a[o][u]=n[u][o]}return w.onlyValues(a)})}transposeArraySize(e,t){if(e.args.length!==1)return V.error();const r=this.metadata("TRANSPOSE"),n=e.args.map(a=>{var o;return this.arraySizeForAst(a,new Bt(t.formulaAddress,t.arraysFlag||((o=r?.enableArrayArithmeticForArguments)!==null&&o!==void 0?o:!1)))}),[i]=n;return new V(i.height,i.width)}createKernel(e,t){return function(...r){const n=[];for(let i=0;i<t.height;++i){n.push([]);for(let a=0;a<t.width;++a)n[i][a]=e.apply({thread:{x:a,y:i}},r)}return n}}}uc.implementedFunctions={MMULT:{method:"mmult",sizeOfResultArrayMethod:"mmultArraySize",parameters:[{argumentType:h.RANGE},{argumentType:h.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",sizeOfResultArrayMethod:"transposeArraySize",parameters:[{argumentType:h.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",sizeOfResultArrayMethod:"maxpoolArraySize",parameters:[{argumentType:h.RANGE},{argumentType:h.NUMBER},{argumentType:h.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",sizeOfResultArrayMethod:"medianpoolArraySize",parameters:[{argumentType:h.RANGE},{argumentType:h.NUMBER},{argumentType:h.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class hc extends P{median(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),(...r)=>{const n=this.arithmeticHelper.coerceNumbersExactRanges(r);return n instanceof p?n:n.length===0?new p(m.NUM,R.OneValue):(n.sort((i,a)=>i-a),n.length%2===0?(n[n.length/2-1]+n[n.length/2])/2:n[Math.floor(n.length/2)])})}large(e,t){return this.runFunction(e.args,t,this.metadata("LARGE"),(r,n)=>{const i=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());return i instanceof p?i:(i.sort((a,o)=>a-o),n=Math.trunc(n),n>i.length?new p(m.NUM,R.ValueLarge):i[i.length-n])})}small(e,t){return this.runFunction(e.args,t,this.metadata("SMALL"),(r,n)=>{const i=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());return i instanceof p?i:(i.sort((a,o)=>a-o),n=Math.trunc(n),n>i.length?new p(m.NUM,R.ValueLarge):i[n-1])})}}hc.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:h.RANGE},{argumentType:h.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:h.RANGE},{argumentType:h.NUMBER,minValue:1}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class lc extends P{mod(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),(r,n)=>n===0?new p(m.DIV_BY_ZERO):r%n)}}lc.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function ps(s){return X(s)&&!Number.isFinite(I(s))?0:s}class vt{constructor(e,t,r){this.sumsq=e,this.sum=t,this.count=r}static single(e){return new vt(e*e,e,1)}compose(e){return new vt(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}varSValue(){if(this.count>1)return(this.sumsq-this.sum*this.sum/this.count)/(this.count-1)}varPValue(){if(this.count>0)return(this.sumsq-this.sum*this.sum/this.count)/this.count}}vt.empty=new vt(0,0,0);class qa extends P{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,t)=>this.arithmeticHelper.addWithEpsilonRaw(e,t)}sum(e,t){return this.doSum(e.args,t)}sumsq(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,r=>Math.pow(I(r),2),$r)}max(e,t){return this.doMax(e.args,t)}maxa(e,t){const r=this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",(n,i)=>Math.max(n,i),I,fs);return ps(r)}min(e,t){return this.doMin(e.args,t)}mina(e,t){const r=this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",(n,i)=>Math.min(n,i),I,fs);return ps(r)}count(e,t){return this.doCount(e.args,t)}counta(e,t){return this.doCounta(e.args,t)}average(e,t){return this.doAverage(e.args,t)}averagea(e,t){var r;const n=this.reduce(e.args,t,vt.empty,"_AGGREGATE_A",(i,a)=>i.compose(a),i=>vt.single(I(i)),fs);return n instanceof p?n:(r=n.averageValue())!==null&&r!==void 0?r:new p(m.DIV_BY_ZERO)}vars(e,t){return this.doVarS(e.args,t)}varp(e,t){return this.doVarP(e.args,t)}vara(e,t){var r;const n=this.reduceAggregateA(e.args,t);return n instanceof p?n:(r=n.varSValue())!==null&&r!==void 0?r:new p(m.DIV_BY_ZERO)}varpa(e,t){var r;const n=this.reduceAggregateA(e.args,t);return n instanceof p?n:(r=n.varPValue())!==null&&r!==void 0?r:new p(m.DIV_BY_ZERO)}stdevs(e,t){return this.doStdevS(e.args,t)}stdevp(e,t){return this.doStdevP(e.args,t)}stdeva(e,t){const r=this.reduceAggregateA(e.args,t);if(r instanceof p)return r;{const n=r.varSValue();return n===void 0?new p(m.DIV_BY_ZERO):Math.sqrt(n)}}stdevpa(e,t){const r=this.reduceAggregateA(e.args,t);if(r instanceof p)return r;{const n=r.varPValue();return n===void 0?new p(m.DIV_BY_ZERO):Math.sqrt(n)}}product(e,t){return this.doProduct(e.args,t)}subtotal(e,t){if(e.args.length<2)return new p(m.NA,R.WrongArgNumber);const r=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:h.NUMBER},t),n=e.args.slice(1);switch(r){case 1:case 101:return this.doAverage(n,t);case 2:case 102:return this.doCount(n,t);case 3:case 103:return this.doCounta(n,t);case 4:case 104:return this.doMax(n,t);case 5:case 105:return this.doMin(n,t);case 6:case 106:return this.doProduct(n,t);case 7:case 107:return this.doStdevS(n,t);case 8:case 108:return this.doStdevP(n,t);case 9:case 109:return this.doSum(n,t);case 10:case 110:return this.doVarS(n,t);case 11:case 111:return this.doVarP(n,t);default:return new p(m.VALUE,R.BadMode)}}reduceAggregate(e,t){return this.reduce(e,t,vt.empty,"_AGGREGATE",(r,n)=>r.compose(n),r=>vt.single(I(r)),$r)}reduceAggregateA(e,t){return this.reduce(e,t,vt.empty,"_AGGREGATE_A",(r,n)=>r.compose(n),r=>vt.single(I(r)),fs)}doAverage(e,t){var r;const n=this.reduceAggregate(e,t);return n instanceof p?n:(r=n.averageValue())!==null&&r!==void 0?r:new p(m.DIV_BY_ZERO)}doVarS(e,t){var r;const n=this.reduceAggregate(e,t);return n instanceof p?n:(r=n.varSValue())!==null&&r!==void 0?r:new p(m.DIV_BY_ZERO)}doVarP(e,t){var r;const n=this.reduceAggregate(e,t);return n instanceof p?n:(r=n.varPValue())!==null&&r!==void 0?r:new p(m.DIV_BY_ZERO)}doStdevS(e,t){const r=this.reduceAggregate(e,t);if(r instanceof p)return r;{const n=r.varSValue();return n===void 0?new p(m.DIV_BY_ZERO):Math.sqrt(n)}}doStdevP(e,t){const r=this.reduceAggregate(e,t);if(r instanceof p)return r;{const n=r.varPValue();return n===void 0?new p(m.DIV_BY_ZERO):Math.sqrt(n)}}doCount(e,t){return this.reduce(e,t,0,"COUNT",(r,n)=>r+n,I,r=>X(r)?1:0)}doCounta(e,t){return this.reduce(e,t,0,"COUNTA",(r,n)=>r+n,I,r=>r===B?0:1)}doMax(e,t){const r=this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",(n,i)=>Math.max(n,i),I,$r);return ps(r)}doMin(e,t){const r=this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",(n,i)=>Math.min(n,i),I,$r);return ps(r)}doSum(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,I,$r)}doProduct(e,t){return this.reduce(e,t,1,"PRODUCT",(r,n)=>r*n,I,$r)}reduce(e,t,r,n,i,a,o){return e.length<1?new p(m.NA,R.WrongArgNumber):e.reduce((u,l)=>{if(u instanceof p)return u;if(l.type===g.CELL_RANGE||l.type===g.COLUMN_RANGE||l.type===g.ROW_RANGE){const d=this.evaluateRange(l,t,r,n,i,a,o);return d instanceof p?d:i(d,u)}let c;if(c=this.evaluateAst(l,t),c instanceof w)return Array.from(c.valuesFromTopLeftCorner()).map(o).filter(f=>f!==void 0).map(f=>f instanceof p?f:a(f)).reduce((f,T)=>f instanceof p?f:T instanceof p?T:i(f,T),u);if(l.type===g.CELL_REFERENCE){if(c=o(c),c===void 0)return u}else if(c=this.coerceScalarToNumberOrError(c),c=o(c),c===void 0)return u;return c instanceof p?c:i(u,a(c))},r)}evaluateRange(e,t,r,n,i,a,o){let u;try{u=F.fromAst(e,t.formulaAddress)}catch(d){if(d instanceof Bn)return new p(m.REF,R.RangeManySheets);throw d}const l=this.dependencyGraph.getRange(u.start,u.end);if(l===void 0)throw new Error("Range does not exists in graph");let c=l.getFunctionValue(n);return c===void 0&&(c=this.getRangeValues(n,u,l,a,o).reduce((f,T)=>f instanceof p?f:T instanceof p?T:i(f,T),r),l.setFunctionValue(n,c)),c}getRangeValues(e,t,r,n,i){const a=[],{smallerRangeVertex:o,restRange:u}=this.dependencyGraph.rangeMapping.findSmallerRange(t);let l;if(o!==void 0&&this.dependencyGraph.existsEdge(o,r)){const c=o.getFunctionValue(e);if(c!==void 0)a.push(c);else for(const d of o.range.addresses(this.dependencyGraph)){const f=i(this.dependencyGraph.getScalarValue(d));f instanceof p?a.push(f):f!==void 0&&a.push(n(f))}l=u}else l=t;for(const c of l.addresses(this.dependencyGraph)){const d=i(this.dependencyGraph.getScalarValue(c));d instanceof p?a.push(d):d!==void 0&&a.push(n(d))}return a}}qa.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:h.NUMBER},{argumentType:h.ANY}],repeatLastArgs:1}};qa.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};function $r(s){if(X(s)||s instanceof p)return s}function fs(s){return typeof s=="boolean"?sa(s):X(s)||s instanceof p?s:typeof s=="string"?0:void 0}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class cc extends P{power(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}cc.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class dc extends P{radians(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),r=>r*(Math.PI/180))}}dc.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:h.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const Ie=10,pc=255,Eu=2,Ru=36,wT="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";class fc extends P{dec2bin(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),(r,n)=>zt(r,2,n))}dec2oct(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),(r,n)=>zt(r,8,n))}dec2hex(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),(r,n)=>zt(r,16,n))}bin2dec(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),r=>{const n=Lt(r,2,Ie);return n===void 0?new p(m.NUM,R.NotBinary):$t(n,2)})}bin2oct(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),(r,n)=>{const i=Lt(r,2,Ie);return i===void 0?new p(m.NUM,R.NotBinary):zt($t(i,2),8,n)})}bin2hex(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),(r,n)=>{const i=Lt(r,2,Ie);return i===void 0?new p(m.NUM,R.NotBinary):zt($t(i,2),16,n)})}oct2dec(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),r=>{const n=Lt(r,8,Ie);return n===void 0?new p(m.NUM,R.NotOctal):$t(n,8)})}oct2bin(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),(r,n)=>{const i=Lt(r,8,Ie);return i===void 0?new p(m.NUM,R.NotOctal):zt($t(i,8),2,n)})}oct2hex(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),(r,n)=>{const i=Lt(r,8,Ie);return i===void 0?new p(m.NUM,R.NotOctal):zt($t(i,8),16,n)})}hex2dec(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),r=>{const n=Lt(r,16,Ie);return n===void 0?new p(m.NUM,R.NotHex):$t(n,16)})}hex2bin(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),(r,n)=>{const i=Lt(r,16,Ie);return i===void 0?new p(m.NUM,R.NotHex):zt($t(i,16),2,n)})}hex2oct(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),(r,n)=>{const i=Lt(r,16,Ie);return i===void 0?new p(m.NUM,R.NotHex):zt($t(i,16),8,n)})}base(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),LT)}decimal(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),(r,n)=>{const i=Lt(r,n,pc);return i===void 0?new p(m.NUM,R.NotHex):parseInt(i,n)})}}fc.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:h.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:h.STRING},{argumentType:h.NUMBER,optionalArg:!0,minValue:0,maxValue:Ie}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:h.STRING},{argumentType:h.NUMBER,optionalArg:!0,minValue:0,maxValue:Ie}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:h.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:h.STRING},{argumentType:h.NUMBER,optionalArg:!0,minValue:0,maxValue:Ie}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:h.STRING},{argumentType:h.NUMBER,optionalArg:!0,minValue:0,maxValue:Ie}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:h.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:h.STRING},{argumentType:h.NUMBER,optionalArg:!0,minValue:0,maxValue:Ie}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:h.STRING},{argumentType:h.NUMBER,optionalArg:!0,minValue:0,maxValue:Ie}]},DECIMAL:{method:"decimal",parameters:[{argumentType:h.STRING},{argumentType:h.NUMBER,minValue:Eu,maxValue:Ru}]},BASE:{method:"base",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:Eu,maxValue:Ru},{argumentType:h.NUMBER,optionalArg:!0,minValue:0,maxValue:pc}]}};function Lt(s,e,t){const r=wT.substr(0,e),n=new RegExp(`^[${r}]+$`);if(!(s.length>t||!n.test(s)))return s}function zt(s,e,t){if(s>_T(e))return new p(m.NUM,R.ValueBaseLarge);if(s<mc(e))return new p(m.NUM,R.ValueBaseSmall);const r=gc(s,e);return t===void 0||s<0?r:r.length>t?new p(m.NUM,R.ValueBaseLong):Ye(r,t)}function mc(s){return-Math.pow(s,Ie)/2}function _T(s){return-mc(s)-1}function LT(s,e,t){const r=gc(s,e);return t!==void 0&&t>r.length?Ye(r,t):r}function gc(s,e){const t=s<0?Math.pow(e,Ie):0;return(s+t).toString(e).toUpperCase()}function $t(s,e){const t=parseInt(s,e),r=Math.pow(e,Ie);return t>=r/2?t-r:t}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Ec extends P{rand(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}randbetween(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),(r,n)=>n<r?new p(m.NUM,R.WrongOrder):(r=Math.ceil(r),n=Math.floor(n)+1,r===n&&(n+=1),r+Math.floor(Math.random()*(n-r))))}}Ec.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER}],isVolatile:!0}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function Tu(s){const e=Math.ceil(s);return e%2===1?e:e+1}function Nu(s){const e=Math.ceil(s);return e%2===0?e:e+1}class Qa extends P{roundup(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(r,n)=>{const i=Math.pow(10,n);return r<0?-Math.ceil(-r*i)/i:Math.ceil(r*i)/i})}rounddown(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(r,n)=>{const i=Math.pow(10,n);return r<0?-Math.floor(-r*i)/i:Math.floor(r*i)/i})}round(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),(r,n)=>{const i=Math.pow(10,n);return r<0?-Math.round(-r*i)/i:Math.round(r*i)/i})}intFunc(e,t){return this.runFunction(e.args,t,this.metadata("INT"),r=>r<0?-Math.floor(-r):Math.floor(r))}even(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),r=>r<0?-Nu(-r):Nu(r))}odd(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),r=>r<0?-Tu(-r):Tu(r))}ceilingmath(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),(r,n,i)=>n===0||r===0?0:(n=Math.abs(n),i===1&&r<0&&(n=-n),Math.ceil(r/n)*n))}ceiling(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),(r,n)=>r===0?0:n===0?new p(m.DIV_BY_ZERO):r>0&&n<0?new p(m.NUM,R.DistinctSigns):Math.ceil(r/n)*n)}ceilingprecise(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),(r,n)=>n===0||r===0?0:(n=Math.abs(n),Math.ceil(r/n)*n))}floormath(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),(r,n,i)=>n===0||r===0?0:(n=Math.abs(n),i===1&&r<0&&(n*=-1),Math.floor(r/n)*n))}floor(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),(r,n)=>r===0?0:n===0?new p(m.DIV_BY_ZERO):r>0&&n<0?new p(m.NUM,R.DistinctSigns):Math.floor(r/n)*n)}floorprecise(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),(r,n)=>n===0||r===0?0:(n=Math.abs(n),Math.floor(r/n)*n))}}Qa.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:h.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:h.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:h.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,defaultValue:1},{argumentType:h.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,defaultValue:1},{argumentType:h.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,defaultValue:1}]}};Qa.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Rc extends P{sqrt(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}Rc.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:h.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function*FT(){}function UT(s){const e=s[Symbol.iterator](),{done:t,value:r}=e.next();return t?{rest:FT()}:{value:r,rest:e}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const bT=(s,e,t)=>{if(t.end.row>t.start.row){const r=O(t.end.sheet,t.end.col,t.end.row-1),n=s.getRange(t.start,r);if(n!==void 0)return{smallerRangeVertex:n,restValuesRange:t.withStart(O(t.start.sheet,t.start.col,t.end.row)),restConditionRanges:e.map(i=>i.withStart(O(i.start.sheet,i.start.col,i.end.row)))}}return{restValuesRange:t,restConditionRanges:e}};class xT{constructor(e,t,r,n,i){this.interpreter=e,this.cacheKey=t,this.reduceInitialValue=r,this.composeFunction=n,this.mapFunction=i,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,t){for(const i of t)if(!i.conditionRange.sameDimensionsAs(e))return new p(m.VALUE,R.EqualLength);const r=this.tryToGetRangeVertexForRangeValue(e),n=t.map(i=>this.tryToGetRangeVertexForRangeValue(i.conditionRange));if(r&&n.every(i=>i!==void 0)){const i=t.map(u=>u.criterionPackage.raw).join(","),a=this.findAlreadyComputedValueInCache(r,this.cacheKey(t),i);if(a!==void 0)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),a;const o=this.buildNewCriterionCache(this.cacheKey(t),t.map(u=>u.conditionRange.range),e.range);return o.has(i)||o.set(i,[this.evaluateRangeValue(e,t),t.map(u=>u.criterionPackage.lambda)]),r.setCriterionFunctionValues(this.cacheKey(t),o),n.forEach(u=>{u!==void 0&&u.addDependentCacheRange(r)}),o.get(i)[0]}else return this.evaluateRangeValue(e,t)}tryToGetRangeVertexForRangeValue(e){const t=e.range;if(t!==void 0)return this.dependencyGraph.getRange(t.start,t.end)}reduceFunction(e){let t=this.reduceInitialValue;for(const r of e)t=this.composeFunction(t,r);return t}findAlreadyComputedValueInCache(e,t,r){return e.getCriterionFunctionValue(t,r)}evaluateRangeValue(e,t){const r=t.map(o=>o.criterionPackage.lambda),n=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),i=t.map(o=>o.conditionRange.iterateValuesFromTopLeftCorner()),a=Au(r,i,n);return this.reduceFunction(a)}buildNewCriterionCache(e,t,r){const n=this.dependencyGraph.getRange(r.start,r.end),{smallerRangeVertex:i,restConditionRanges:a,restValuesRange:o}=bT(this.dependencyGraph,t,r);let u;i!==void 0&&this.dependencyGraph.existsEdge(i,n)?u=i.getCriterionFunctionValues(e):u=new Map;const l=new Map;return u.forEach(([c,d],f)=>{const T=Au(d,a.map(E=>Su(this.dependencyGraph,E)),Array.from(Su(this.dependencyGraph,o)).map(this.mapFunction)[Symbol.iterator]()),N=this.composeFunction(c,this.reduceFunction(T));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),l.set(f,[N,d])}),l}}class PT{constructor(e,t){this.conditionRange=e,this.criterionPackage=t}}function*Su(s,e){for(const t of e.addresses(s))yield I(s.getScalarValue(t))}function*Au(s,e,t){for(const r of t){const n=e.map(a=>UT(a));if(!n.every(a=>Object.prototype.hasOwnProperty.call(a,"value")))return;const i=n.map(a=>I(a.value));VT(i,s).every(([a,o])=>o(a))&&(yield r),e=n.map(a=>a.rest)}}function VT(s,e){const t=[];for(let r=0;r<Math.min(s.length,e.length);r++)t.push([s[r],e[r]]);return t}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class dr{constructor(e,t){this.sum=e,this.count=t}static single(e){return new dr(e,1)}compose(e){return new dr(this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}}dr.empty=new dr(0,0);function DT(s){return e=>{const t=e.map(r=>`${r.conditionRange.range.sheet},${r.conditionRange.range.start.col},${r.conditionRange.range.start.row}`);return[s,...t].join(",")}}function yu(s){return X(s)&&!Number.isFinite(I(s))?0:s}function ms(s){if(s instanceof p)return s;if(X(s))return I(s)}class Tc extends P{sumif(e,t){const r="SUMIF",n=(i,a,o)=>this.computeConditionalAggregationFunction(o??i,[i,a],r,0,(u,l)=>this.arithmeticHelper.nonstrictadd(u,l),ms);return this.runFunction(e.args,t,this.metadata(r),n)}sumifs(e,t){const r="SUMIFS",n=(i,...a)=>this.computeConditionalAggregationFunction(i,a,r,0,(o,u)=>this.arithmeticHelper.nonstrictadd(o,u),ms);return this.runFunction(e.args,t,this.metadata(r),n)}averageif(e,t){const r="AVERAGEIF",n=(i,a,o)=>{const u=this.computeConditionalAggregationFunction(o??i,[i,a],r,dr.empty,(l,c)=>l.compose(c),l=>X(l)?dr.single(I(l)):dr.empty);return u instanceof p?u:u.averageValue()||new p(m.DIV_BY_ZERO)};return this.runFunction(e.args,t,this.metadata(r),n)}countif(e,t){const r="COUNTIF",n=(i,a)=>this.computeConditionalAggregationFunction(i,[i,a],r,0,(o,u)=>o+u,()=>1);return this.runFunction(e.args,t,this.metadata(r),n)}countifs(e,t){const r="COUNTIFS",n=(...i)=>this.computeConditionalAggregationFunction(i[0],i,r,0,(a,o)=>a+o,()=>1);return this.runFunction(e.args,t,this.metadata(r),n)}minifs(e,t){const r="MINIFS",n=(a,o)=>o===void 0||a===void 0?o===void 0?a:o:Math.min(a,o),i=(a,...o)=>{const u=this.computeConditionalAggregationFunction(a,o,r,Number.POSITIVE_INFINITY,n,ms);return yu(u)};return this.runFunction(e.args,t,this.metadata(r),i)}maxifs(e,t){const r="MAXIFS",n=(a,o)=>o===void 0||a===void 0?o===void 0?a:o:Math.max(a,o),i=(a,...o)=>{const u=this.computeConditionalAggregationFunction(a,o,r,Number.NEGATIVE_INFINITY,n,ms);return yu(u)};return this.runFunction(e.args,t,this.metadata(r),i)}computeConditionalAggregationFunction(e,t,r,n,i,a){const o=[];for(let u=0;u<t.length;u+=2){const l=t[u],c=this.interpreter.criterionBuilder.fromCellValue(t[u+1],this.arithmeticHelper);if(c===void 0)return new p(m.VALUE,R.BadCriterion);o.push(new PT(l,c))}return new xT(this.interpreter,DT(r),n,i,a).compute(e,o)}}Tc.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:h.RANGE},{argumentType:h.NOERROR},{argumentType:h.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:h.RANGE},{argumentType:h.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:h.RANGE},{argumentType:h.NOERROR},{argumentType:h.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:h.RANGE},{argumentType:h.RANGE},{argumentType:h.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:h.RANGE},{argumentType:h.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:h.RANGE},{argumentType:h.RANGE},{argumentType:h.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:h.RANGE},{argumentType:h.RANGE},{argumentType:h.NOERROR}],repeatLastArgs:2}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Nc extends P{sumproduct(e,t){return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),(...r)=>{const n=r[0].width(),i=r[0].height();for(const u of r)if(u.width()!==n||u.height()!==i)return new p(m.VALUE,R.EqualLength);let a=0;const o=r.map(u=>u.iterateValuesFromTopLeftCorner());for(let u=0;u<n*i;u++){let l=1;for(const c of o){const d=c.next().value;if(d instanceof p)return d;const f=this.coerceScalarToNumberOrError(d);X(f)?l*=I(f):l=0}a+=l}return a})}}Nc.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:h.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Sc extends P{concatenate(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),(...r)=>"".concat(...r))}split(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),(r,n)=>{const i=r.split(" ");return n>=i.length||n<0?new p(m.VALUE,R.IndexBounds):i[n]})}len(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),r=>r.length)}lower(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),r=>r.toLowerCase())}trim(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),r=>r.replace(/^ +/g,"").replace(/ +$/g,"").replace(/ +/g," "))}proper(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),r=>r.replace(new RegExp("\\p{L}+","gu"),n=>n.charAt(0).toUpperCase()+n.substring(1).toLowerCase()))}clean(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),r=>r.replace(/[\u0000-\u001F]/g,""))}exact(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),(r,n)=>r===n)}rept(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),(r,n)=>n<0?new p(m.VALUE,R.NegativeCount):r.repeat(n))}right(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),(r,n)=>n<0?new p(m.VALUE,R.NegativeLength):n===0?"":r.slice(-n))}left(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),(r,n)=>n<0?new p(m.VALUE,R.NegativeLength):r.slice(0,n))}mid(e,t){return this.runFunction(e.args,t,this.metadata("MID"),(r,n,i)=>n<1?new p(m.VALUE,R.LessThanOne):i<0?new p(m.VALUE,R.NegativeLength):r.substring(n-1,n+i-1))}replace(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),(r,n,i,a)=>n<1?new p(m.VALUE,R.LessThanOne):i<0?new p(m.VALUE,R.NegativeLength):r.substring(0,n-1)+a+r.substring(n+i-1))}search(e,t){return this.runFunction(e.args,t,this.metadata("SEARCH"),(r,n,i)=>{if(i<1||i>n.length)return new p(m.VALUE,R.LengthBounds);const a=r.toLowerCase(),o=n.substring(i-1).toLowerCase(),u=this.arithmeticHelper.requiresRegex(a)?this.arithmeticHelper.searchString(a,o):o.indexOf(a);return u>-1?u+i:new p(m.VALUE,R.PatternNotFound)})}substitute(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),(r,n,i,a)=>{const o=this.escapeRegExpSpecialCharacters(n),u=new RegExp(o,"g");if(a===void 0)return r.replace(u,i);if(a<1)return new p(m.VALUE,R.LessThanOne);let l,c=0;for(;(l=u.exec(r))!==null;)if(a===++c)return r.substring(0,l.index)+i+r.substring(u.lastIndex);return r})}find(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),(r,n,i)=>{if(i<1||i>n.length)return new p(m.VALUE,R.IndexBounds);const o=n.substring(i-1).indexOf(r)+i;return o>0?o:new p(m.VALUE,R.PatternNotFound)})}t(e,t){return this.runFunction(e.args,t,this.metadata("T"),r=>r instanceof p||typeof r=="string"?r:"")}upper(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),r=>r.toUpperCase())}escapeRegExpSpecialCharacters(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}Sc.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:h.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:h.STRING},{argumentType:h.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:h.STRING},{argumentType:h.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:h.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:h.STRING}]},MID:{method:"mid",parameters:[{argumentType:h.STRING},{argumentType:h.NUMBER},{argumentType:h.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:h.STRING}]},T:{method:"t",parameters:[{argumentType:h.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:h.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:h.STRING}]},REPT:{method:"rept",parameters:[{argumentType:h.STRING},{argumentType:h.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:h.STRING},{argumentType:h.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:h.STRING},{argumentType:h.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:h.STRING},{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:h.STRING},{argumentType:h.STRING},{argumentType:h.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:h.STRING},{argumentType:h.STRING},{argumentType:h.STRING},{argumentType:h.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:h.STRING},{argumentType:h.STRING},{argumentType:h.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:h.STRING}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Ac extends P{acos(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}asin(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}cos(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}sin(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}tan(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}atan(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}atan2(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),(r,n)=>r===0&&n===0?new p(m.DIV_BY_ZERO):Math.atan2(n,r))}cot(e,t){return this.runFunction(e.args,t,this.metadata("COT"),r=>r===0?new p(m.DIV_BY_ZERO):1/Math.tan(r))}acot(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),r=>r===0?ga/2:Math.atan(1/r))}sec(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),r=>1/Math.cos(r))}csc(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),r=>r===0?new p(m.DIV_BY_ZERO):1/Math.sin(r))}sinh(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}asinh(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}cosh(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}acosh(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}tanh(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}atanh(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}coth(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),r=>r===0?new p(m.DIV_BY_ZERO):1/Math.tanh(r))}acoth(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),r=>r===0?new p(m.NUM,R.NonZero):Math.atanh(1/r))}sech(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),r=>1/Math.cosh(r))}csch(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),r=>r===0?new p(m.DIV_BY_ZERO):1/Math.sinh(r))}}Ac.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:h.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:h.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:h.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:h.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:h.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:h.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:h.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:h.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:h.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:h.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:h.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:h.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:h.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:h.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:h.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:h.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:h.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:h.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:h.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:h.NUMBER}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class BT extends bl{constructor(e){super(e),this.dependencyGraph=e}find(e,t,r){return this.basicFind(e,t,"col",r)}}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class yc extends P{constructor(){super(...arguments),this.rowSearch=new BT(this.dependencyGraph)}vlookup(e,t){return this.runFunction(e.args,t,this.metadata("VLOOKUP"),(r,n,i,a)=>{const o=n.range;if(o===void 0)return new p(m.VALUE,R.WrongType);if(i<1)return new p(m.VALUE,R.LessThanOne);if(i>o.width())return new p(m.REF,R.IndexLarge);const u={ordering:a?"asc":"none",ifNoMatch:a?"returnLowerBound":"returnNotFound"};return this.doVlookup(ss(r),n,i-1,u)})}hlookup(e,t){return this.runFunction(e.args,t,this.metadata("HLOOKUP"),(r,n,i,a)=>{const o=n.range;if(o===void 0)return new p(m.VALUE,R.WrongType);if(i<1)return new p(m.VALUE,R.LessThanOne);if(i>o.height())return new p(m.REF,R.IndexLarge);const u={ordering:a?"asc":"none",ifNoMatch:a?"returnLowerBound":"returnNotFound"};return this.doHlookup(ss(r),n,i-1,u)})}xlookup(e,t){return this.runFunction(e.args,t,this.metadata("XLOOKUP"),(r,n,i,a,o,u)=>{if(![0,-1,1,2].includes(o))return new p(m.VALUE,R.BadMode);if(![1,-1,2,-2].includes(u))return new p(m.VALUE,R.BadMode);const l=n instanceof w?n:w.fromScalar(n),c=i instanceof w?i:w.fromScalar(i),d=o===2,f={ordering:u===2?"asc":u===-2?"desc":"none",returnOccurrence:u===-1?"last":"first",ifNoMatch:o===-1?"returnLowerBound":o===1?"returnUpperBound":"returnNotFound"};return this.doXlookup(ss(r),l,c,a,d,f)})}xlookupArraySize(e){var t,r;const n=(t=e?.args)===null||t===void 0?void 0:t[1],i=(r=e?.args)===null||r===void 0?void 0:r[2];if(n?.start==null||n?.end==null||i?.start==null||i?.end==null)return V.error();const a=n.end.row-n.start.row+1,o=n.end.col-n.start.col+1,u=i.end.row-i.start.row+1,l=i.end.col-i.start.col+1,c=o===1&&u===a;return!c&&!(a===1&&l===o)?V.error():c?new V(l,1):new V(1,u)}match(e,t){return this.runFunction(e.args,t,this.metadata("MATCH"),(r,n,i)=>this.doMatch(ss(r),n,i))}searchInRange(e,t,r,n,i){return r&&typeof e=="string"&&this.arithmeticHelper.requiresRegex(e)?i.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t,{returnOccurrence:n.returnOccurrence}):i.find(e,t,n)}doVlookup(e,t,r,n){this.dependencyGraph.stats.start(x.VLOOKUP);const i=t.range;let a;i===void 0?a=w.onlyValues(t.data.map(l=>[l[0]])):a=w.onlyRange(F.spanFrom(i.start,1,i.height()),this.dependencyGraph);const o=this.searchInRange(e,a,n.ordering==="none",n,this.columnSearch);if(this.dependencyGraph.stats.end(x.VLOOKUP),o===-1)return new p(m.NA,R.ValueNotFound);let u;if(i===void 0)u=t.data[o][r];else{const l=O(i.sheet,i.start.col+r,i.start.row+o);u=this.dependencyGraph.getCellValue(l)}return u instanceof w?new p(m.VALUE,R.WrongType):u}doHlookup(e,t,r,n){const i=t.range;let a;i===void 0?a=w.onlyValues([t.data[0]]):a=w.onlyRange(F.spanFrom(i.start,i.width(),1),this.dependencyGraph);const o=this.searchInRange(e,a,n.ordering==="none",n,this.rowSearch);if(o===-1)return new p(m.NA,R.ValueNotFound);let u;if(i===void 0)u=t.data[r][o];else{const l=O(i.sheet,i.start.col+o,i.start.row+r);u=this.dependencyGraph.getCellValue(l)}return u instanceof w?new p(m.VALUE,R.WrongType):u}doXlookup(e,t,r,n,i,a){const o=t.width()===1&&r.height()===t.height(),u=t.height()===1&&r.width()===t.width();if(!o&&!u)return new p(m.VALUE,R.WrongDimension);const l=o?this.columnSearch:this.rowSearch,c=this.searchInRange(e,t,i,a,l);if(c===-1)return n==m.NA?new p(m.NA,R.ValueNotFound):n;const d=o?[r.data[c]]:r.data.map(f=>[f[c]]);return w.onlyValues(d)}doMatch(e,t,r){if(![-1,0,1].includes(r))return new p(m.VALUE,R.BadMode);if(t.width()>1&&t.height()>1)return new p(m.NA);const n=t.width()===1?this.columnSearch:this.rowSearch,i=r===0?{ordering:"none",ifNoMatch:"returnNotFound"}:{ordering:r===-1?"desc":"asc",ifNoMatch:r===-1?"returnUpperBound":"returnLowerBound"},a=n.find(e,t,i);return a===-1?new p(m.NA,R.ValueNotFound):a+1}}yc.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:h.NOERROR},{argumentType:h.RANGE},{argumentType:h.NUMBER},{argumentType:h.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:h.NOERROR},{argumentType:h.RANGE},{argumentType:h.NUMBER},{argumentType:h.BOOLEAN,defaultValue:!0}]},XLOOKUP:{method:"xlookup",sizeOfResultArrayMethod:"xlookupArraySize",parameters:[{argumentType:h.NOERROR},{argumentType:h.RANGE},{argumentType:h.RANGE},{argumentType:h.SCALAR,optionalArg:!0,defaultValue:m.NA},{argumentType:h.NUMBER,optionalArg:!0,defaultValue:0},{argumentType:h.NUMBER,optionalArg:!0,defaultValue:1}]},MATCH:{method:"match",parameters:[{argumentType:h.NOERROR},{argumentType:h.RANGE},{argumentType:h.NUMBER,defaultValue:1}]}};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Cc extends P{roman(e,t){return this.runFunction(e.args,t,this.metadata("ROMAN"),(r,n)=>(r=Math.trunc(r),n===!1?n=4:n===!0&&(n=0),n=I(this.coerceScalarToNumberOrError(n)),n instanceof p?n:(n=Math.trunc(n),n<0?new p(m.VALUE,R.ValueSmall):n>4?new p(m.VALUE,R.ValueLarge):kT(r,n))))}arabic(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),r=>{r=r.trim().toUpperCase();let n=!1;if(r.startsWith("-")&&(r=r.slice(1),n=!0,r===""))return new p(m.VALUE,R.InvalidRoman);const i={input:r,acc:0};return Ft(i,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),Ft(i,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),Ft(i,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),Ft(i,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),Ft(i,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),Ft(i,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),Ft(i,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),Ft(i,{token:"IX",val:9}),Ft(i,{token:"V",val:5},{token:"IV",val:4}),Ft(i,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),i.input!==""?new p(m.VALUE,R.InvalidRoman):n?-i.acc:i.acc})}}Cc.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:h.NUMBER,minValue:1,lessThan:4e3},{argumentType:h.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:h.STRING}]}};function Ft(s,...e){for(const t of e)if(s.input.startsWith(t.token)){s.input=s.input.slice(t.token.length),s.acc+=t.val;break}}function kT(s,e){const t={val:s%1e3,acc:"M".repeat(Math.floor(s/1e3))};return e===4&&(me(t,"IM",999,1e3),me(t,"ID",499,500)),e>=3&&(me(t,"VM",995,1e3),me(t,"VD",495,500)),e>=2&&(me(t,"XM",990,1e3),me(t,"XD",490,500)),e>=1&&(me(t,"LM",950,1e3),me(t,"LD",450,500)),me(t,"CM",900,1e3),me(t,"CD",400,500),me(t,"D",500,900),t.acc+="C".repeat(Math.floor(t.val/100)),t.val%=100,e>=2&&(me(t,"IC",99,100),me(t,"IL",49,50)),e>=1&&(me(t,"VC",95,100),me(t,"VL",45,50)),me(t,"XC",90,100),me(t,"XL",40,50),me(t,"L",50,90),t.acc+="X".repeat(Math.floor(t.val/10)),t.val%=10,me(t,"IX",9,10),me(t,"IV",4,5),me(t,"V",5,9),t.acc+="I".repeat(t.val),t.acc}function me(s,e,t,r){s.val>=t&&s.val<r&&(s.val-=t,s.acc+=e)}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class vc extends P{add(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}vc.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:h.NUMBER,passSubtype:!0},{argumentType:h.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:h.STRING,passSubtype:!0},{argumentType:h.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:h.NUMBER,passSubtype:!0},{argumentType:h.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:h.NOERROR,passSubtype:!0},{argumentType:h.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:h.NOERROR,passSubtype:!0},{argumentType:h.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:h.NOERROR,passSubtype:!0},{argumentType:h.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:h.NOERROR,passSubtype:!0},{argumentType:h.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:h.NOERROR,passSubtype:!0},{argumentType:h.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:h.NUMBER,passSubtype:!0},{argumentType:h.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:h.NUMBER,passSubtype:!0},{argumentType:h.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:h.NOERROR,passSubtype:!0},{argumentType:h.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:h.NUMBER,passSubtype:!0},{argumentType:h.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:h.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:h.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:h.NUMBER,passSubtype:!0}]}};/**
 * @license
 bessel.js (C) 2013-present SheetJS -- http://sheetjs.com

 Apache License
 Version 2.0, January 2004
 http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

 "License" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 "Licensor" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 "Legal Entity" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 "control" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 "You" (or "Your") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 "Source" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 "Object" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 "Work" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 "Derivative Works" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 "Contribution" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, "submitted"
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as "Not a Contribution."

 "Contributor" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a "NOTICE" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
 or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
 negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets "{}"
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same "printed page" as the copyright notice for easier
 identification within third-party archives.

 Copyright (C) 2013-present   SheetJS LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 */var D=Math;function ie(s,e){for(var t=0,r=0;t<s.length;++t)r=e*r+s[t];return r}function Ic(s,e,t,r,n){if(e===0)return t;if(e===1)return r;for(var i=2/s,a=r,o=1;o<e;++o)a=r*o*i+n*t,t=r,r=a;return a}function Oc(s,e,t,r,n){return function(a,o){if(r){if(a===0)return r==1?-1/0:1/0;if(a<0)return NaN}if(o===0)return s(a);if(o===1)return e(a);if(o<0)return NaN;o|=0;var u=s(a),l=e(a);return Ic(a,o,u,l,n)}}var Ea=function(){var s=.636619772,e=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),t=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),n=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function i(d){var f=0,T=0,N=0,E=d*d;if(d<8)T=ie(e,E),N=ie(t,E),f=T/N;else{var S=d-.785398164;E=64/E,T=ie(r,E),N=ie(n,E),f=D.sqrt(s/d)*(D.cos(S)*T-D.sin(S)*N*8/d)}return f}var a=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),o=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),u=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),l=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function c(d){var f=0,T=0,N=0,E=d*d,S=D.abs(d)-2.356194491;return Math.abs(d)<8?(T=d*ie(a,E),N=ie(o,E),f=T/N):(E=64/E,T=ie(u,E),N=ie(l,E),f=D.sqrt(s/D.abs(d))*(D.cos(S)*T-D.sin(S)*N*8/D.abs(d)),d<0&&(f=-f)),f}return function d(f,T){if(T=Math.round(T),!isFinite(f))return isNaN(f)?f:0;if(T<0)return(T%2?-1:1)*d(f,-T);if(f<0)return(T%2?-1:1)*d(-f,T);if(T===0)return i(f);if(T===1)return c(f);if(f===0)return 0;var N=0;if(f>T)N=Ic(f,T,i(f),c(f),-1);else{for(var E=2*D.floor((T+D.floor(D.sqrt(40*T)))/2),S=!1,A=0,y=0,C=1,M=0,re=2/f,J=E;J>0;J--)M=J*re*C-A,A=C,C=M,D.abs(C)>1e10&&(C*=1e-10,A*=1e-10,N*=1e-10,y*=1e-10),S&&(y+=C),S=!S,J==T&&(N=A);y=2*y-C,N/=y}return N}}(),GT=function(){var s=.636619772,e=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),t=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),n=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function i(d){var f=0,T=0,N=0,E=d*d,S=d-.785398164;return d<8?(T=ie(e,E),N=ie(t,E),f=T/N+s*Ea(d,0)*D.log(d)):(E=64/E,T=ie(r,E),N=ie(n,E),f=D.sqrt(s/d)*(D.sin(S)*T+D.cos(S)*N*8/d)),f}var a=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),o=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),u=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),l=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function c(d){var f=0,T=0,N=0,E=d*d,S=d-2.356194491;return d<8?(T=d*ie(a,E),N=ie(o,E),f=T/N+s*(Ea(d,1)*D.log(d)-1/d)):(E=64/E,T=ie(u,E),N=ie(l,E),f=D.sqrt(s/d)*(D.sin(S)*T+D.cos(S)*N*8/d)),f}return Oc(i,c,"BESSELY",1,-1)}(),Ra=function(){var s=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),e=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function t(a){return a<=3.75?ie(s,a*a/(3.75*3.75)):D.exp(D.abs(a))/D.sqrt(D.abs(a))*ie(e,3.75/D.abs(a))}var r=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),n=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function i(a){return a<3.75?a*ie(r,a*a/(3.75*3.75)):(a<0?-1:1)*D.exp(D.abs(a))/D.sqrt(D.abs(a))*ie(n,3.75/D.abs(a))}return function a(o,u){if(u=Math.round(u),u===0)return t(o);if(u===1)return i(o);if(u<0)return NaN;if(D.abs(o)===0)return 0;if(o==1/0)return 1/0;var l=0,c,d=2/D.abs(o),f=0,T=1,N=0,E=2*D.round((u+D.round(D.sqrt(40*u)))/2);for(c=E;c>0;c--)N=c*d*T+f,f=T,T=N,D.abs(T)>1e10&&(T*=1e-10,f*=1e-10,l*=1e-10),c==u&&(l=f);return l*=a(o,0)/T,o<0&&u%2?-l:l}}(),HT=function(){var s=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),e=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function t(a){return a<=2?-D.log(a/2)*Ra(a,0)+ie(s,a*a/4):D.exp(-a)/D.sqrt(a)*ie(e,2/a)}var r=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),n=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function i(a){return a<=2?D.log(a/2)*Ra(a,1)+1/a*ie(r,a*a/4):D.exp(-a)/D.sqrt(a)*ie(n,2/a)}return Oc(t,i,"BESSELK",2,1)}();/**
 * @license
 Copyright (c) 2013 jStat

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */function ln(s){const e=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let t=e.length-1,r=!1,n=0,i=0,a,o,u,l;if(s===0)return 0;for(s<0&&(s=-s,r=!0),a=2/(2+s),o=4*a-2;t>0;t--)u=n,n=o*n-i+e[t],i=u;return l=a*Math.exp(-s*s+.5*(e[0]+o*n)-i),r?l-1:1-l}function Mc(s){return 1-ln(s)}function wc(s){let e=0,t,r,n,i;if(s>=2)return-100;if(s<=0)return 100;for(i=s<1?s:2-s,n=Math.sqrt(-2*Math.log(i/2)),t=-.70711*((2.30753+n*.27061)/(1+n*(.99229+n*.04481))-n);e<2;e++)r=Mc(t)-i,t+=r/(1.1283791670955126*Math.exp(-t*t)-t*r);return s<1?t:-t}const Cu={pdf:(s,e)=>s<0?0:e*Math.exp(-e*s),cdf:(s,e)=>s<0?0:1-Math.exp(-e*s)};function bn(s){const e=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],t=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let r=!1,n=0,i=0,a=0,o=s,u,l,c,d;if(s>171.6243769536076)return 1/0;if(o<=0)if(d=o%1,d)r=(o&1?-1:1)*Math.PI/Math.sin(Math.PI*d),o=1-o;else return 1/0;for(c=o,o<1?l=o++:l=(o-=n=(o|0)-1)-1,u=0;u<8;++u)a=(a+e[u])*l,i=i*l+t[u];if(d=a/i+1,c<o)d/=c;else if(c>o)for(u=0;u<n;++u)d*=o,o++;return r&&(d=r/d),d}const Vi={pdf:function(e,t,r){return e<0?0:e===0&&t===1?1/r:Math.exp((t-1)*Math.log(e)-e/r-Me(t)-t*Math.log(r))},cdf:function(e,t,r){return e<0?0:Za(t,e/r)},inv:function(s,e,t){return _c(s,e)*t}};function Me(s){let e=0;const t=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let r=1.000000000190015,n,i,a;for(a=(i=n=s)+5.5,a-=(n+.5)*Math.log(a);e<6;e++)r+=t[e]/++i;return Math.log(2.5066282746310007*r/n)-a}function Za(s,e){const t=Me(s);let r=s,n=1/s,i=n,a=e+1-s,o=1/1e-30,u=1/a,l=u,c=1;const d=-~(Math.log(s>=1?s:1/s)*8.5+s*.4+17);let f;if(e<0||s<=0)return NaN;if(e<s+1){for(;c<=d;c++)n+=i*=e/++r;return n*Math.exp(-e+s*Math.log(e)-t)}for(;c<=d;c++)f=-c*(c-s),a+=2,u=f*u+a,o=a+f/o,u=1/u,l*=u*o;return 1-l*Math.exp(-e+s*Math.log(e)-t)}function _c(s,e){let t=0;const r=e-1,n=1e-8,i=Me(e);let a,o,u,l,c,d,f;if(s>=1)return Math.max(100,e+100*Math.sqrt(e));if(s<=0)return 0;for(e>1?(d=Math.log(r),f=Math.exp(r*(d-1)-i),c=s<.5?s:1-s,u=Math.sqrt(-2*Math.log(c)),a=(2.30753+u*.27061)/(1+u*(.99229+u*.04481))-u,s<.5&&(a=-a),a=Math.max(.001,e*Math.pow(1-1/(9*e)-a/(3*Math.sqrt(e)),3))):(u=1-e*(.253+e*.12),s<u?a=Math.pow(s/u,1/e):a=1-Math.log(1-(s-u)/(1-u)));t<12;t++){if(a<=0)return 0;if(o=Za(e,a)-s,e>1?u=f*Math.exp(-(a-r)+r*(Math.log(a)-d)):u=Math.exp(-a+r*Math.log(a)-i),l=o/u,a-=u=l/(1-.5*Math.min(1,l*((e-1)/a-1))),a<=0&&(a=.5*(a+u)),Math.abs(u)<n*a)break}return a}const yt={pdf:function(e,t,r){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(e-t,2)/(2*r*r))},cdf:function(e,t,r){return .5*(1+ln((e-t)/Math.sqrt(2*r*r)))},inv:function(s,e,t){return-1.4142135623730951*t*wc(2*s)+e}},Di={pdf:function(e,t,r){return e>1||e<0?0:t==1&&r==1?1:t<512&&r<512?Math.pow(e,t-1)*Math.pow(1-e,r-1)/Ja(t,r):Math.exp((t-1)*Math.log(e)+(r-1)*Math.log(1-e)-Lc(t,r))},cdf:function(e,t,r){return e>1||e<0?+(e>1):Ei(e,t,r)},inv:function(e,t,r){return eo(e,t,r)}};function Ja(s,e){if(!(s<=0||e<=0))return s+e>170?Math.exp(Lc(s,e)):bn(s)*bn(e)/bn(s+e)}function Lc(s,e){return Me(s)+Me(e)-Me(s+e)}function eo(s,e,t){var r=1e-8,n=e-1,i=t-1,a=0,o,u,l,c,d,f,T,N,E,S,A;if(s<=0)return 0;if(s>=1)return 1;for(e>=1&&t>=1?(l=s<.5?s:1-s,c=Math.sqrt(-2*Math.log(l)),T=(2.30753+c*.27061)/(1+c*(.99229+c*.04481))-c,s<.5&&(T=-T),N=(T*T-3)/6,E=2/(1/(2*e-1)+1/(2*t-1)),S=T*Math.sqrt(N+E)/E-(1/(2*t-1)-1/(2*e-1))*(N+5/6-2/(3*E)),T=e/(e+t*Math.exp(2*S))):(o=Math.log(e/(e+t)),u=Math.log(t/(e+t)),c=Math.exp(e*o)/e,d=Math.exp(t*u)/t,S=c+d,s<c/S?T=Math.pow(e*S*s,1/e):T=1-Math.pow(t*S*(1-s),1/t)),A=-Me(e)-Me(t)+Me(e+t);a<10;a++){if(T===0||T===1)return T;if(f=Ei(T,e,t)-s,c=Math.exp(n*Math.log(T)+i*Math.log(1-T)+A),d=f/c,T-=c=d/(1-.5*Math.min(1,d*(n/T-i/(1-T)))),T<=0&&(T=.5*(T+c)),T>=1&&(T=.5*(T+c+1)),Math.abs(c)<r*T&&a>0)break}return T}function Ei(s,e,t){var r=s===0||s===1?0:Math.exp(Me(e+t)-Me(e)-Me(t)+e*Math.log(s)+t*Math.log(1-s));return s<0||s>1?!1:s<(e+1)/(e+t+2)?r*vu(s,e,t)/e:1-r*vu(1-s,t,e)/t}function vu(s,e,t){var r=1e-30,n=1,i=e+t,a=e+1,o=e-1,u=1,l=1-i*s/a,c,d,f,T;for(Math.abs(l)<r&&(l=r),l=1/l,T=l;n<=100&&(c=2*n,d=n*(t-n)*s/((o+c)*(e+c)),l=1+d*l,Math.abs(l)<r&&(l=r),u=1+d/u,Math.abs(u)<r&&(u=r),l=1/l,T*=l*u,d=-(e+n)*(i+n)*s/((e+c)*(a+c)),l=1+d*l,Math.abs(l)<r&&(l=r),u=1+d/u,Math.abs(u)<r&&(u=r),l=1/l,f=l*u,T*=f,!(Math.abs(f-1)<3e-7));n++);return T}const Ms={pdf:function(s,e,t){return t===0||t===1?e*t===s?1:0:Fc(e,s)*Math.pow(t,s)*Math.pow(1-t,e-s)},cdf:function(s,e,t){var r,n=1e-10;if(s<0)return 0;if(s>=e)return 1;if(t<0||t>1||e<=0)return NaN;s=Math.floor(s);var i=t,a=s+1,o=e-s,u=a+o,l=Math.exp(Me(u)-Me(o)-Me(a)+a*Math.log(i)+o*Math.log(1-i));return i<(a+1)/(u+2)?r=l*Iu(i,a,o,n):r=1-l*Iu(1-i,o,a,n),Math.round((1-r)*(1/n))/(1/n)}};function Iu(s,e,t,r){for(var n=0,i=1,a=1,o=1,u=0,l=0,c;Math.abs((a-l)/a)>r;)l=a,c=-(e+u)*(e+t+u)*s/(e+2*u)/(e+2*u+1),n=a+c*n,i=o+c*i,u=u+1,c=u*(t-u)*s/(e+2*u-1)/(e+2*u),a=n+c*a,o=i+c*o,n=n/o,i=i/o,a=a/o,o=1;return a/e}function Fc(s,e){return s>170||e>170?Math.exp(WT(s,e)):ws(s)/ws(e)/ws(s-e)}function WT(s,e){return Bi(s)-Bi(e)-Bi(s-e)}function Bi(s){return s<0?NaN:Me(s+1)}function ws(s){return s<0?NaN:bn(s+1)}const Qr={pdf:function(e,t){return e<0?0:e===0&&t===2?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-Me(t/2))},cdf:function(e,t){return e<0?0:Za(t/2,e/2)},inv:function(s,e){return 2*_c(s,.5*e)}},Zr={pdf:function(e,t,r){var n,i,a;return e<0?0:t<=2?e===0&&t<2?1/0:e===0&&t===2?1:1/Ja(t/2,r/2)*Math.pow(t/r,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/r*e,-(t+r)/2):(n=t*e/(r+e*t),i=r/(r+e*t),a=t*i/2,a*Ms.pdf((t-2)/2,(t+r-2)/2,n))},cdf:function(e,t,r){return e<0?0:Ei(t*e/(t*e+r),t/2,r/2)},inv:function(e,t,r){return r/(t*(1/eo(e,t/2,r/2)-1))}},Ou={pdf:function(e,t,r){return e<0||t<0||r<0?0:r/t*Math.pow(e/t,r-1)*Math.exp(-Math.pow(e/t,r))},cdf:function(e,t,r){return e<0?0:1-Math.exp(-Math.pow(e/t,r))}},Ta={pdf:function(e,t){return t<0||e%1!==0||e<0?0:Math.pow(t,e)*Math.exp(-t)/ws(e)},cdf:function(e,t){var r=0;if(e<0)return 0;for(var n=0;r<=e;r++)n+=Ta.pdf(r,t);return n}},Kt={pdf:function(e,t,r,n){if(e<0||e<r-(t-n))return 0;if(e>n||e>r)return 0;if(r*2>t)return n*2>t?Kt.pdf(t-r-n+e,t,t-r,t-n):Kt.pdf(n-e,t,t-r,n);if(n*2>t)return Kt.pdf(r-e,t,r,t-n);if(r<n)return Kt.pdf(e,t,n,r);for(var i=1,a=0,o=0;o<e;o++){for(;i>1&&a<n;)i*=1-r/(t-a),a++;i*=(n-o)*(r-o)/((o+1)*(t-r-n+o+1))}for(;a<n;a++)i*=1-r/(t-a);return Math.min(1,Math.max(0,i))},cdf:function s(e,t,r,n){if(e<0||e<r-(t-n))return 0;if(e>=n||e>=r)return 1;if(r*2>t)return n*2>t?s(t-r-n+e,t,t-r,t-n):1-Kt.cdf(n-e-1,t,t-r,n);if(n*2>t)return 1-Kt.cdf(r-e-1,t,r,t-n);if(r<n)return Kt.cdf(e,t,n,r);for(var i=1,a=1,o=0,u=0;u<e;u++){for(;i>1&&o<n;){var l=1-r/(t-o);a*=l,i*=l,o++}a*=(n-u)*(r-u)/((u+1)*(t-r-n+u+1)),i+=a}for(;o<n;o++)i*=1-r/(t-o);return Math.min(1,Math.max(0,i))}},ct={pdf:function(e,t){return t=t>1e100?1e100:t,1/(Math.sqrt(t)*Ja(.5,t/2))*Math.pow(1+e*e/t,-((t+1)/2))},cdf:function(e,t){var r=t/2;return Ei((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),r,r)},inv:function(s,e){var t=eo(2*Math.min(s,1-s),.5*e,.5);return t=Math.sqrt(e*(1-t)/t),s>.5?t:-t}},ki={pdf:function(e,t,r){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(Math.log(e)-t,2)/(2*r*r))},cdf:function(e,t,r){return e<0?0:.5+.5*ln((Math.log(e)-t)/Math.sqrt(2*r*r))},inv:function(s,e,t){return Math.exp(-1.4142135623730951*t*wc(2*s)+e)}},Na={pdf:function(e,t,r){return e!==e>>>0?!1:e<0?0:Fc(e+t-1,t-1)*Math.pow(1-r,e)*Math.pow(r,t)},cdf:function(e,t,r){var n=0,i=0;if(e<0)return 0;for(;i<=e;i++)n+=Na.pdf(i,t,r);return n}};function Uc(s){for(var e=0,t=s.length;--t>=0;)e+=s[t];return e}function lt(s){return Uc(s)/s.length}function Cr(s){for(var e=lt(s),t=0,r=s.length,n;--r>=0;)n=s[r]-e,t+=n*n;return t}function yn(s,e){return Cr(s)/(s.length-(e?1:0))}function hr(s,e){return Math.sqrt(yn(s,e))}function YT(){var s=[].slice.call(arguments),e=new Array(2),t;return s.length===4?t=Math.abs(yt.inv(s[1]/2,0,1)*s[2]/Math.sqrt(s[3])):t=Math.abs(yt.inv(s[1]/2,0,1)*hr(s[2])/Math.sqrt(s[2].length)),e[0]=s[0]-t,e[1]=s[0]+t,e}function zT(){var s=[].slice.call(arguments),e=new Array(2),t;return s.length===4?t=Math.abs(ct.inv(s[1]/2,s[3]-1)*s[2]/Math.sqrt(s[3])):t=Math.abs(ct.inv(s[1]/2,s[2].length-1)*hr(s[2],!0)/Math.sqrt(s[2].length)),e[0]=s[0]-t,e[1]=s[0]+t,e}function $T(s){for(var e=1,t=s.length;--t>=0;)e*=s[t];return e}function XT(s){return Math.pow($T(s),1/s.length)}function Cn(s,e){var t=lt(s),r=lt(e),n=s.length,i=new Array(n),a;for(a=0;a<n;a++)i[a]=(s[a]-t)*(e[a]-r);return Uc(i)/(n-1)}function Mu(s,e){return Cn(s,e)/hr(s,1)/hr(e,1)}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class to extends P{erf(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),(r,n)=>n===void 0?ln(r):ln(n)-ln(r))}erfc(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),Mc)}expondist(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),(r,n,i)=>i?Cu.cdf(r,n):Cu.pdf(r,n))}fisher(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),r=>Math.log((1+r)/(1-r))/2)}fisherinv(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),r=>1-2/(Math.exp(2*r)+1))}gamma(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),bn)}gammadist(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),(r,n,i,a)=>a?Vi.cdf(r,n,i):Vi.pdf(r,n,i))}gammaln(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),Me)}gammainv(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),Vi.inv)}gauss(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),r=>yt.cdf(r,0,1)-.5)}betadist(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),(r,n,i,a,o,u)=>r<=o?new p(m.NUM,R.ValueSmall):r>=u?new p(m.NUM,R.ValueLarge):(r=(r-o)/(u-o),a?Di.cdf(r,n,i):Di.pdf(r,n,i)))}betainv(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),(r,n,i,a,o)=>a>=o?new p(m.NUM,R.WrongOrder):Di.inv(r,n,i)*(o-a)+a)}binomialdist(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),(r,n,i,a)=>r>n?new p(m.NUM,R.WrongOrder):(r=Math.trunc(r),n=Math.trunc(n),a?Ms.cdf(r,n,i):Ms.pdf(r,n,i)))}binomialinv(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),(r,n,i)=>{r=Math.trunc(r);let a=-1,o=r;for(;o>a+1;){const u=Math.trunc((a+o)/2);Ms.cdf(u,r,n)>=i?o=u:a=u}return o})}besselifn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),(r,n)=>Ra(r,Math.trunc(n)))}besseljfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),(r,n)=>Ea(r,Math.trunc(n)))}besselkfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),(r,n)=>HT(r,Math.trunc(n)))}besselyfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),(r,n)=>GT(r,Math.trunc(n)))}chisqdist(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),(r,n,i)=>(n=Math.trunc(n),i?Qr.cdf(r,n):Qr.pdf(r,n)))}chisqdistrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),(r,n)=>1-Qr.cdf(r,Math.trunc(n)))}chisqinv(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),(r,n)=>Qr.inv(r,Math.trunc(n)))}chisqinvrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),(r,n)=>Qr.inv(1-r,Math.trunc(n)))}fdist(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),(r,n,i,a)=>(n=Math.trunc(n),i=Math.trunc(i),a?Zr.cdf(r,n,i):Zr.pdf(r,n,i)))}fdistrt(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),(r,n,i)=>1-Zr.cdf(r,Math.trunc(n),Math.trunc(i)))}finv(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),(r,n,i)=>Zr.inv(r,Math.trunc(n),Math.trunc(i)))}finvrt(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),(r,n,i)=>Zr.inv(1-r,Math.trunc(n),Math.trunc(i)))}weibulldist(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),(r,n,i,a)=>a?Ou.cdf(r,i,n):Ou.pdf(r,i,n))}poissondist(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),(r,n,i)=>(r=Math.trunc(r),i?Ta.cdf(r,n):Ta.pdf(r,n)))}hypgeomdist(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),(r,n,i,a,o)=>r>n||r>i||n>a||i>a?new p(m.NUM,R.ValueLarge):r+a<i+n?new p(m.NUM,R.ValueLarge):(r=Math.trunc(r),n=Math.trunc(n),i=Math.trunc(i),a=Math.trunc(a),o?Kt.cdf(r,a,i,n):Kt.pdf(r,a,i,n)))}tdist(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),(r,n,i)=>(n=Math.trunc(n),i?ct.cdf(r,n):ct.pdf(r,n)))}tdist2t(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),(r,n)=>(1-ct.cdf(r,Math.trunc(n)))*2)}tdistrt(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),(r,n)=>1-ct.cdf(r,Math.trunc(n)))}tdistold(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),(r,n,i)=>i*(1-ct.cdf(r,Math.trunc(n))))}tinv(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),(r,n)=>ct.inv(r,Math.trunc(n)))}tinv2t(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),(r,n)=>ct.inv(1-r/2,Math.trunc(n)))}lognormdist(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),(r,n,i,a)=>a?ki.cdf(r,n,i):ki.pdf(r,n,i))}lognorminv(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),(r,n,i)=>ki.inv(r,n,i))}normdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),(r,n,i,a)=>a?yt.cdf(r,n,i):yt.pdf(r,n,i))}norminv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),(r,n,i)=>yt.inv(r,n,i))}normsdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),(r,n)=>n?yt.cdf(r,0,1):yt.pdf(r,0,1))}normsinv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),r=>yt.inv(r,0,1))}phi(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),r=>yt.pdf(r,0,1))}negbinomdist(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),(r,n,i,a)=>(r=Math.trunc(r),n=Math.trunc(n),a?Na.cdf(r,n,i):Na.pdf(r,n,i)))}confidencenorm(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),(r,n,i)=>YT(1,r,n,Math.trunc(i))[1]-1)}confidencet(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),(r,n,i)=>(i=Math.trunc(i),i===1?new p(m.DIV_BY_ZERO):zT(1,r,n,i)[1]-1))}standardize(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),(r,n,i)=>(r-n)/i)}}to.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:h.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:h.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:h.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:h.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:h.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:h.NUMBER,minValue:0,lessThan:1},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:h.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.BOOLEAN},{argumentType:h.NUMBER,defaultValue:0},{argumentType:h.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:h.NUMBER,greaterThan:0,maxValue:1},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER,defaultValue:0},{argumentType:h.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:0,maxValue:1},{argumentType:h.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:0,maxValue:1},{argumentType:h.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,minValue:1,maxValue:1e10},{argumentType:h.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:h.NUMBER,minValue:0,maxValue:1},{argumentType:h.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:h.NUMBER,minValue:0,maxValue:1},{argumentType:h.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:1},{argumentType:h.NUMBER,minValue:1},{argumentType:h.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:1},{argumentType:h.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:h.NUMBER,minValue:0,maxValue:1},{argumentType:h.NUMBER,minValue:1},{argumentType:h.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:h.NUMBER,minValue:0,maxValue:1},{argumentType:h.NUMBER,minValue:1},{argumentType:h.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:0},{argumentType:h.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,minValue:1},{argumentType:h.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:1},{argumentType:h.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:h.NUMBER,greaterThan:0,lessThan:1},{argumentType:h.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:h.NUMBER,greaterThan:0,maxValue:1},{argumentType:h.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:h.NUMBER,greaterThan:0,lessThan:1},{argumentType:h.NUMBER},{argumentType:h.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:h.NUMBER,greaterThan:0,lessThan:1},{argumentType:h.NUMBER},{argumentType:h.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:h.NUMBER},{argumentType:h.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:h.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:h.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:1},{argumentType:h.NUMBER,minValue:0,maxValue:1},{argumentType:h.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:h.NUMBER,greaterThan:0,lessThan:1},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:h.NUMBER,greaterThan:0,lessThan:1},{argumentType:h.NUMBER,greaterThan:0},{argumentType:h.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER,greaterThan:0}]}};to.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class bc extends P{fact(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),r=>{r=Math.trunc(r);let n=1;for(let i=1;i<=r;i++)n*=i;return n})}factdouble(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),r=>{r=Math.trunc(r);let n=1;for(let i=r;i>=1;i-=2)n*=i;return n})}combin(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),(r,n)=>n>r?new p(m.NUM,R.WrongOrder):(r=Math.trunc(r),n=Math.trunc(n),wu(r,n)))}combina(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),(r,n)=>(r=Math.trunc(r),n=Math.trunc(n),r+n-1>=1030?new p(m.NUM,R.ValueLarge):r===0&&n===0?1:wu(r+n-1,n)))}gcd(e,t){return this.runFunction(e.args,t,this.metadata("GCD"),(...r)=>{const n=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(r);if(n instanceof p)return n;let i=0;for(const a of n){if(a<0)return new p(m.NUM,R.ValueSmall);i=xc(i,Math.trunc(a))}return i>Number.MAX_SAFE_INTEGER?new p(m.NUM,R.ValueLarge):i})}lcm(e,t){return this.runFunction(e.args,t,this.metadata("LCM"),(...r)=>{const n=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(r);if(n instanceof p)return n;let i=1;for(const a of n){if(a<0)return new p(m.NUM,R.ValueSmall);i=KT(i,Math.trunc(a))}return i>Number.MAX_SAFE_INTEGER?new p(m.NUM,R.ValueLarge):i})}mround(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),(r,n)=>n===0?0:r>0&&n<0||r<0&&n>0?new p(m.NUM,R.DistinctSigns):Math.round(r/n)*n)}multinomial(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),(...r)=>{let n=0,i=1;for(let a of r){if(a<0)return new p(m.NUM,R.ValueSmall);a=Math.trunc(a);for(let o=1;o<=a;o++)i*=(n+o)/o;n+=a}return Math.round(i)})}quotient(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),(r,n)=>n===0?new p(m.DIV_BY_ZERO):Math.trunc(r/n))}seriessum(e,t){return this.runFunction(e.args,t,this.metadata("SERIESSUM"),(r,n,i,a)=>{const o=this.arithmeticHelper.manyToOnlyNumbersDropNulls(a.valuesFromTopLeftCorner());if(o instanceof p)return o;let u=0;o.reverse();for(const l of o)u*=Math.pow(r,i),u+=l;return u*Math.pow(r,n)})}sign(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),r=>r>0?1:r<0?-1:0)}sumx2my2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),(r,n)=>{const i=r.valuesFromTopLeftCorner(),a=n.valuesFromTopLeftCorner();if(i.length!==a.length)return new p(m.NA,R.EqualLength);const o=i.length;let u=0;for(let l=0;l<o;l++){const c=i[l],d=a[l];if(c instanceof p)return c;if(d instanceof p)return d;typeof c=="number"&&typeof d=="number"&&(u+=Math.pow(c,2)-Math.pow(d,2))}return u})}sumx2py2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),(r,n)=>{const i=r.valuesFromTopLeftCorner(),a=n.valuesFromTopLeftCorner();if(i.length!==a.length)return new p(m.NA,R.EqualLength);const o=i.length;let u=0;for(let l=0;l<o;l++){const c=i[l],d=a[l];if(c instanceof p)return c;if(d instanceof p)return d;typeof c=="number"&&typeof d=="number"&&(u+=Math.pow(c,2)+Math.pow(d,2))}return u})}sumxmy2(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),(r,n)=>{const i=r.valuesFromTopLeftCorner(),a=n.valuesFromTopLeftCorner();if(i.length!==a.length)return new p(m.NA,R.EqualLength);const o=i.length;let u=0;for(let l=0;l<o;l++){const c=i[l],d=a[l];if(c instanceof p)return c;if(d instanceof p)return d;typeof c=="number"&&typeof d=="number"&&(u+=Math.pow(c-d,2))}return u})}}bc.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:h.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:h.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:h.NUMBER,minValue:0,lessThan:1030},{argumentType:h.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:h.NUMBER,minValue:0},{argumentType:h.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:h.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:h.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:h.RANGE},{argumentType:h.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:h.RANGE},{argumentType:h.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:h.RANGE},{argumentType:h.RANGE}]}};function wu(s,e){2*e>s&&(e=s-e);let t=1;for(let r=1;r<=e;r++)t*=(s-e+r)/r;return Math.round(t)}function xc(s,e){for(s<e&&([s,e]=[e,s]);e>0;)[s,e]=[e,s%e];return s}function KT(s,e){return s===0||e===0?0:s*(e/xc(s,e))}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Pc extends P{complex(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),(r,n,i)=>i!=="i"&&i!=="j"?new p(m.VALUE,R.ShouldBeIorJ):ce([r,n],i))}imabs(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),Bc)}imaginary(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),([r,n])=>n)}imreal(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),([r,n])=>r)}imargument(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),([r,n])=>r===0&&n===0?new p(m.DIV_BY_ZERO):Math.atan2(n,r))}imconjugate(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),([r,n])=>ce([r,-n]))}imcos(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),r=>ce(gs(r)))}imcosh(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),r=>ce(_u(r)))}imcot(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),r=>ce(Ar(gs(r),Es(r))))}imcsc(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),r=>ce(Ar([1,0],Es(r))))}imcsch(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),r=>ce(Ar([1,0],Lu(r))))}imsec(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),r=>ce(Ar([1,0],gs(r))))}imsech(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),r=>ce(Ar([1,0],_u(r))))}imsin(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),r=>ce(Es(r)))}imsinh(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),r=>ce(Lu(r)))}imtan(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),r=>ce(Ar(Es(r),gs(r))))}imdiv(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),(r,n)=>ce(Ar(r,n)))}improduct(e,t){return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),(...r)=>{const n=this.arithmeticHelper.coerceComplexExactRanges(r);if(n instanceof p)return n;let i=[1,0];for(const a of n)i=Vc(i,a);return ce(i)})}imsum(e,t){return this.runFunction(e.args,t,this.metadata("IMSUM"),(...r)=>{const n=this.arithmeticHelper.coerceComplexExactRanges(r);if(n instanceof p)return n;let i=[0,0];for(const a of n)i=jT(i,a);return ce(i)})}imsub(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),(r,n)=>ce(qT(r,n)))}imexp(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),r=>ce(Dc(r)))}imln(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),r=>ce(_s(r)))}imlog10(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),r=>{const[n,i]=_s(r),a=Math.log(10);return ce([n/a,i/a])})}imlog2(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),r=>{const[n,i]=_s(r),a=Math.log(2);return ce([n/a,i/a])})}impower(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),(r,n)=>ce(Fu(r,n)))}imsqrt(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),r=>ce(Fu(r,.5)))}}Pc.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:h.NUMBER},{argumentType:h.NUMBER},{argumentType:h.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:h.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:h.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:h.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:h.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:h.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:h.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:h.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:h.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:h.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:h.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:h.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:h.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:h.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:h.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:h.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:h.COMPLEX},{argumentType:h.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:h.COMPLEX},{argumentType:h.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:h.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:h.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:h.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:h.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:h.COMPLEX},{argumentType:h.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:h.COMPLEX}]}};function jT([s,e],[t,r]){return[s+t,e+r]}function qT([s,e],[t,r]){return[s-t,e-r]}function Vc([s,e],[t,r]){return[s*t-e*r,s*r+t*e]}function Ar([s,e],[t,r]){const n=Math.pow(t,2)+Math.pow(r,2),[i,a]=Vc([s,e],[t,-r]);return[i/n,a/n]}function gs([s,e]){return[Math.cos(s)*Math.cosh(e),-Math.sin(s)*Math.sinh(e)]}function _u([s,e]){return[Math.cosh(s)*Math.cos(e),Math.sinh(s)*Math.sin(e)]}function Es([s,e]){return[Math.sin(s)*Math.cosh(e),Math.cos(s)*Math.sinh(e)]}function Lu([s,e]){return[Math.sinh(s)*Math.cos(e),Math.cosh(s)*Math.sin(e)]}function Dc([s,e]){return[Math.exp(s)*Math.cos(e),Math.exp(s)*Math.sin(e)]}function Bc([s,e]){return Math.sqrt(s*s+e*e)}function _s([s,e]){return[Math.log(Bc([s,e])),Math.atan2(e,s)]}function Fu(s,e){const[t,r]=_s(s);return Dc([e*t,e*r])}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ro extends P{avedev(e,t){return this.runFunction(e.args,t,this.metadata("AVEDEV"),(...r)=>{const n=this.arithmeticHelper.coerceNumbersExactRanges(r);if(n instanceof p)return n;if(n.length===0)return new p(m.DIV_BY_ZERO);const i=lt(n);return n.reduce((a,o)=>a+Math.abs(o-i),0)/n.length})}devsq(e,t){return this.runFunction(e.args,t,this.metadata("DEVSQ"),(...r)=>{const n=this.arithmeticHelper.coerceNumbersExactRanges(r);return n instanceof p?n:n.length===0?0:Cr(n)})}geomean(e,t){return this.runFunction(e.args,t,this.metadata("GEOMEAN"),(...r)=>{const n=this.arithmeticHelper.coerceNumbersExactRanges(r);if(n instanceof p)return n;if(n.length===0)return new p(m.NUM,R.OneValue);for(const i of n)if(i<=0)return new p(m.NUM,R.ValueSmall);return XT(n)})}harmean(e,t){return this.runFunction(e.args,t,this.metadata("HARMEAN"),(...r)=>{const n=this.arithmeticHelper.coerceNumbersExactRanges(r);if(n instanceof p)return n;if(n.length===0)return new p(m.NUM,R.OneValue);for(const i of n)if(i<=0)return new p(m.NUM,R.ValueSmall);return n.length/n.reduce((i,a)=>i+1/a,0)})}correl(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),(r,n)=>{if(r.numberOfElements()!==n.numberOfElements())return new p(m.NA,R.EqualLength);const i=yr(r,n);return i instanceof p?i:i[0].length<=1?new p(m.DIV_BY_ZERO,R.TwoValues):Mu(i[0],i[1])})}rsq(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),(r,n)=>{if(r.numberOfElements()!==n.numberOfElements())return new p(m.NA,R.EqualLength);const i=yr(r,n);return i instanceof p?i:i[0].length<=1?new p(m.DIV_BY_ZERO,R.TwoValues):Math.pow(Mu(i[0],i[1]),2)})}covariancep(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),(r,n)=>{if(r.numberOfElements()!==n.numberOfElements())return new p(m.NA,R.EqualLength);const i=yr(r,n);if(i instanceof p)return i;const a=i[0].length;return a<1?new p(m.DIV_BY_ZERO,R.OneValue):a===1?0:Cn(i[0],i[1])*(a-1)/a})}covariances(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),(r,n)=>{if(r.numberOfElements()!==n.numberOfElements())return new p(m.NA,R.EqualLength);const i=yr(r,n);return i instanceof p?i:i[0].length<=1?new p(m.DIV_BY_ZERO,R.TwoValues):Cn(i[0],i[1])})}ztest(e,t){return this.runFunction(e.args,t,this.metadata("Z.TEST"),(r,n,i)=>{const a=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());if(a instanceof p)return a;const o=a.length;if(i===void 0){if(o<2)return new p(m.DIV_BY_ZERO,R.TwoValues);i=hr(a,!0)}return o<1?new p(m.NA,R.OneValue):i===0?new p(m.DIV_BY_ZERO):1-yt.cdf((lt(a)-n)/(i/Math.sqrt(o)),0,1)})}ftest(e,t){return this.runFunction(e.args,t,this.metadata("F.TEST"),(r,n)=>{const i=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner()),a=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());if(i instanceof p)return i;if(a instanceof p)return a;if(i.length<=1||a.length<=1)return new p(m.DIV_BY_ZERO);const o=yn(i,!0),u=yn(a,!0);if(o===0||u===0)return new p(m.DIV_BY_ZERO);const l=o/u,c=Zr.cdf(l,i.length-1,a.length-1);return 2*Math.min(c,1-c)})}steyx(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),(r,n)=>{if(r.numberOfElements()!==n.numberOfElements())return new p(m.NA,R.EqualLength);const i=yr(r,n);if(i instanceof p)return i;const a=i[0].length;return a<=2?new p(m.DIV_BY_ZERO,R.ThreeValues):Math.sqrt((Cr(i[0])-Math.pow(Cn(i[0],i[1])*(a-1),2)/Cr(i[1]))/(a-2))})}slope(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),(r,n)=>{if(r.numberOfElements()!==n.numberOfElements())return new p(m.NA,R.EqualLength);const i=yr(r,n);if(i instanceof p)return i;const a=i[0].length;return a<=1?new p(m.DIV_BY_ZERO,R.TwoValues):Cn(i[0],i[1])*(a-1)/Cr(i[1])})}chisqtest(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),(r,n)=>{const i=r.height(),a=r.width();if(n.height()!==i||n.width()!==a)return new p(m.NA,R.EqualLength);const o=yr(r,n);if(o instanceof p)return o;if(o[0].length<=1)return new p(m.DIV_BY_ZERO,R.TwoValues);let u=0;for(let l=0;l<o[0].length;l++){if(o[1][l]===0)return new p(m.DIV_BY_ZERO);u+=Math.pow(o[0][l]-o[1][l],2)/o[1][l]}return u<0?new p(m.NUM,R.NaN):1-Qr.cdf(u,i>1&&a>1?(i-1)*(a-1):i*a-1)})}ttest(e,t){return this.runFunction(e.args,t,this.metadata("T.TEST"),(r,n,i,a)=>{const o=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner()),u=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());if(o instanceof p)return o;if(u instanceof p)return u;const l=o.length,c=u.length;if(a===1){if(c!==l)return new p(m.NA,R.EqualLength);if(l<=1)return new p(m.DIV_BY_ZERO,R.TwoValues);const d=Array(l);for(let N=0;N<l;N++)d[N]=o[N]-u[N];const f=hr(d,!0);if(f===0)return new p(m.DIV_BY_ZERO);const T=Math.abs(Math.sqrt(l)*lt(d)/f);return i*(1-ct.cdf(T,l-1))}else if(a===2){if(l<=1||c<=1)return new p(m.DIV_BY_ZERO,R.TwoValues);const d=(Cr(o)+Cr(u))/(l+c-2);if(d===0)return new p(m.DIV_BY_ZERO);const f=Math.abs((lt(o)-lt(u))/Math.sqrt(d*(1/l+1/c)));return i*(1-ct.cdf(f,l+c-2))}else{if(l<=1||c<=1)return new p(m.DIV_BY_ZERO,R.TwoValues);const d=yn(o,!0),f=yn(u,!0);if(d===0&&f===0)return new p(m.DIV_BY_ZERO);const T=Math.abs((lt(o)-lt(u))/Math.sqrt(d/l+f/c)),N=Math.pow(d/l+f/c,2)/(Math.pow(d/l,2)/(l-1)+Math.pow(f/c,2)/(c-1));return i*(1-ct.cdf(T,N))}})}skew(e,t){return this.runFunction(e.args,t,this.metadata("SKEW"),(...r)=>{const n=this.arithmeticHelper.coerceNumbersExactRanges(r);if(n instanceof p)return n;const i=n.length;if(i<3)return new p(m.DIV_BY_ZERO,R.ThreeValues);const a=lt(n),o=hr(n,!0);return o===0?new p(m.DIV_BY_ZERO):n.reduce((u,l)=>u+Math.pow((l-a)/o,3),0)*i/(i-1)/(i-2)})}skewp(e,t){return this.runFunction(e.args,t,this.metadata("SKEW.P"),(...r)=>{const n=this.arithmeticHelper.coerceNumbersExactRanges(r);if(n instanceof p)return n;const i=n.length;if(i<3)return new p(m.DIV_BY_ZERO,R.ThreeValues);const a=lt(n),o=hr(n,!1);return o===0?new p(m.DIV_BY_ZERO):n.reduce((u,l)=>u+Math.pow((l-a)/o,3),0)/i})}}ro.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:h.RANGE},{argumentType:h.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:h.RANGE},{argumentType:h.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:h.RANGE},{argumentType:h.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:h.RANGE},{argumentType:h.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:h.RANGE},{argumentType:h.NUMBER},{argumentType:h.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:h.RANGE},{argumentType:h.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:h.RANGE},{argumentType:h.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:h.RANGE},{argumentType:h.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:h.RANGE},{argumentType:h.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:h.RANGE},{argumentType:h.RANGE},{argumentType:h.INTEGER,minValue:1,maxValue:2},{argumentType:h.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:h.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:h.ANY}],repeatLastArgs:1}};ro.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};function yr(s,e){const t=s.iterateValuesFromTopLeftCorner(),r=e.iterateValuesFromTopLeftCorner();let n,i;const a=[],o=[];for(;n=t.next(),i=r.next(),!n.done&&!i.done;){const u=n.value,l=i.value;if(u instanceof p)return u;if(l instanceof p)return l;X(u)&&X(l)&&(a.push(I(u)),o.push(I(l)))}return[a,o]}/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const Uu=Object.freeze(Object.defineProperty({__proto__:null,AbsPlugin:Bl,AddressPlugin:Vl,ArrayPlugin:Dl,BitShiftPlugin:kl,BitwiseLogicOperationsPlugin:Yl,BooleanPlugin:zl,CharPlugin:$l,CodePlugin:Xl,ComplexPlugin:Pc,ConditionalAggregationPlugin:Tc,CountBlankPlugin:Kl,CountUniquePlugin:jl,DateTimePlugin:ql,DegreesPlugin:Ql,DeltaPlugin:Zl,ExpPlugin:Jl,FinancialPlugin:ec,FormulaTextPlugin:tc,HyperlinkPlugin:rc,InformationPlugin:nc,IsEvenPlugin:sc,IsOddPlugin:ic,LogarithmPlugin:ac,LookupPlugin:yc,MathConstantsPlugin:oc,MathPlugin:bc,MatrixPlugin:uc,MedianPlugin:hc,ModuloPlugin:lc,NumericAggregationPlugin:qa,PowerPlugin:cc,RadiansPlugin:dc,RadixConversionPlugin:fc,RandomPlugin:Ec,RomanPlugin:Cc,RoundingPlugin:Qa,SimpleArithmerticPlugin:vc,SqrtPlugin:Rc,StatisticalAggregationPlugin:ro,StatisticalPlugin:to,SumprodPlugin:Nc,TextPlugin:Sc,TrigonometryPlugin:Ac},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class G extends _e{}G.HyperFormula=_e;G.ErrorType=m;G.CellError=p;G.CellType=We;G.CellValueType=It;G.CellValueDetailedType=LE;G.DetailedCellError=Nl;G.ExportedCellChange=da;G.ExportedNamedExpressionChange=Fl;G.ConfigValueTooBigError=ul;G.ConfigValueTooSmallError=ol;G.EvaluationSuspendedError=ll;G.ExpectedOneOfValuesError=hl;G.ExpectedValueOfTypeError=$;G.ArraySize=V;G.SimpleRangeValue=w;G.EmptyValue=B;G.FunctionPlugin=P;G.FunctionArgumentType=h;G.FunctionPluginValidationError=dn;G.InvalidAddressError=el;G.InvalidArgumentsError=Te;G.LanguageNotRegisteredError=ta;G.LanguageAlreadyRegisteredError=dl;G.MissingTranslationError=jr;G.NamedExpressionDoesNotExistError=kn;G.NamedExpressionNameIsAlreadyTakenError=tl;G.NamedExpressionNameIsInvalidError=rl;G.NoOperationToRedoError=sl;G.NoOperationToUndoError=nl;G.NoRelativeAddressesAllowedError=za;G.NoSheetWithIdError=ae;G.NoSheetWithNameError=Jh;G.NotAFormulaError=vs;G.NothingToPasteError=il;G.ProtectedFunctionTranslationError=cl;G.SheetNameAlreadyTakenError=Dn;G.SheetSizeLimitExceededError=Mr;G.SourceLocationHasArrayError=rn;G.TargetLocationHasArrayError=$s;G.UnableToParseError=al;const QT=st.defaultConfig.language;_e.registerLanguage(QT,pa);_e.languages[pa.langCode]=pa;for(const s of Object.getOwnPropertyNames(Uu))s.startsWith("_")||_e.registerFunctionPlugin(Uu[s]);const ZT=(s,e,t,r,n,i,a)=>{a.originalRenderer?a.originalRenderer.apply(void 0,[s,e,t,r,n,i,a]):k.renderers.TextRenderer.apply(void 0,[s,e,t,r,n,i,a]);const o=s.getSettings().search,u=a.theme,l=a.isFirstColumn;e.style.backgroundColor="",e.style.color="",o&&i&&String(i).toLowerCase().includes(o.toLowerCase())?(e.style.backgroundColor=u==="dark"?"#facc15":"yellow",e.style.color="black"):(l?e.style.backgroundColor=u==="dark"?"#4b5563":"#e0e0e0":t%2===0?e.style.backgroundColor=u==="dark"?"#101010":"#ffffff":e.style.backgroundColor=u==="dark"?"#000000":"#f8f8f8",e.style.color="")};bp(Zp);bu();const JT={previousMonth:"이전 달",nextMonth:"다음 달",months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],weekdays:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],weekdaysShort:["일","월","화","수","목","금","토"],firstDay:0,format:"YYYY-MM-DD",toString(s,e){const t=s.getDate(),r=s.getMonth()+1;return`${s.getFullYear()}-${r.toString().padStart(2,"0")}-${t.toString().padStart(2,"0")}`},parse(s,e){const t=s.split("-");return new Date(t[0],t[1]-1,t[2])}},eN=({hotRef:s,search:e,columns:t,rowData:r,afterSelection:n,handleAfterColumnResize:i})=>{const{theme:a}=Gi(),o=[],u=ve.useMemo(()=>{const f=[];return t.forEach((T,N)=>{T.select&&o.push({value:N,text:T.title,label:T.title}),f.push({...T,title:T.title})}),f},[t]),l=ve.useRef(null);ve.useEffect(()=>{l.current||(l.current=_e.buildEmpty({licenseKey:"gpl-v3"}))},[]);const c=ve.useMemo(()=>u.map(f=>{const{readOnly:T,...N}=f;let E={...N,theme:a};return f.type==="numeric"?E={...E,type:"numeric",numericFormat:{pattern:"0,0"},originalRenderer:k.renderers.NumericRenderer}:f.type==="date"?E={...E,type:"date",dateFormat:"YYYY-MM-DD",correctFormat:!0,editorOptions:{i18n:JT},originalRenderer:k.renderers.DateRenderer}:f.type==="checkbox"?E={...E,type:"checkbox",className:"htCenter",originalRenderer:k.renderers.CheckboxRenderer}:E.originalRenderer=k.renderers.TextRenderer,{...E,renderer:ZT}}),[u,a]),d=a==="dark"?"ht-theme-main-dark-auto":"ht-theme-main";return l.current===null?H.jsx(Kp,{}):H.jsx("div",{className:"w-full",children:H.jsx(Up,{className:"no-scrollbar no-scrollbar-x no-scrollbar-y",ref:s,data:r,themeName:d,rowHeaders:!0,language:"ko-KR",colHeaders:t.map(f=>f.title),autoWrapRow:!0,height:"auto",contextMenu:!0,search:e,observeChanges:!0,columnSorting:!0,afterSelection:n,formulas:{engine:l.current},columns:c,manualColumnResize:!0,afterColumnResize:i,colWidths:t.map(f=>f.width),filters:!0,licenseKey:"non-commercial-and-evaluation"})})},mN=({detailData:s})=>{const{user:e}=xp(),{ui:t}=Gi(),{t:r}=ku(),{sheetId:n}=Pp(),[i,a]=ve.useState([]),o=ve.useRef(null);ve.useRef(null);const u=ve.useRef(null),l=ve.useRef(null),[c,d]=ve.useState(),{height:f,width:T}=Vp(),[N,E]=ve.useState(""),[S,A]=ve.useState({isOpen:!1}),[y,C]=ve.useState({show:!1,message:""}),[M,re]=ve.useState(""),[J,j]=ve.useState(!1),[ue,he]=ve.useState(""),{theme:le}=Gi(),{register:q,reset:Rt,control:He,setValue:Tt,getValues:Ze,formState:{errors:rr}}=Dp({mode:"submit "}),nr=async()=>{if(!n)return;const Y=`memo_sheet_data/${e?.uid}/${n}/data`,Se=Hp(Yp(zp,Y),Wp(i.length>0?i[0].data:"title"));$p(Se,ut=>{if(!ut.exists()){d([]);return}const Je=ut.val(),St=[];for(let Tr in Je){const kr=Je[Tr];St.push(kr)}d(St)})};function Pr(){const Y=s?.scrollY?s.scrollY:0;window.scrollTo({top:Y})}ve.useEffect(()=>{n&&e&&(io(`memo_sheet/${e?.uid}/${n}/columns`).then(Y=>{a(Y||[{title:"title",data:"title",type:"text"}]),q("filterField1")}),io(`memo_sheet_data/${e?.uid}/${n}/memo`).then(Y=>{re(Y||"")}),Pr())},[n,e]),ve.useEffect(()=>{n&&i.length>0&&nr()},[n,i]);const Yt=async()=>{o.current.hotInstance.getPlugin("exportFile").downloadFile("csv",{filename:`sheet_${n}`,mimeType:"text/csv",bom:!1,columnDelimiter:",",rowDelimiter:`\r
`})};async function Vr(){const Y=o.current?.hotInstance;if(!Y)return;let Se;l.current!==null&&l.current>=0?(Se=l.current+1,Y.alter("insert_row_below",l.current,1)):(Se=0,Y.alter("insert_row_above",0,1)),Y.selectCell(Se,0)}const Dr=async()=>{Hr(`memo_sheet_data/${e?.uid}/${n}/memo`,ue),re(ue),j(!1)},gn=()=>{he(M),j(!0)},Br=Y=>(Hr(`memo_sheet_data/${e?.uid}/${n}/data`,Y),Hr(`memo_sheet/${e?.uid}/${n}/createdAt`,Date.now()),Hr(`memo_sheet/${e?.uid}/${n}/count`,Y.length),Y),xe=async(Y=!0)=>{const Se=o.current?.hotInstance;if(!Se)return;const ut=Se.getSourceData();ut.forEach((Je,St)=>{Je.id=St}),await Br(ut),Y&&(C({show:!0,message:r("save_completed")}),setTimeout(()=>{C({show:!1,message:""})},2e3))},Qn=Y=>{l.current=Y},Zn=async(Y,Se,ut)=>{xe(!1);const Je=o.current?.hotInstance;if(!Je)return;const St=i.map((Tr,kr)=>({...Tr,width:Je.getColWidth(kr)}));a(St),Hr(`memo_sheet/${e?.uid}/${n}/columns`,St)},Ri=async()=>{const Y=o.current.hotInstance;if(Y&&l.current!==null){const Se=l.current,Je=Y.getSourceDataAtRow(Se).id;A({isOpen:!0,title:r("delete_confirm_title"),message:r("delete_confirm_message_simple"),color:"warning",onConfirm:()=>{Hr(`memo_sheet_data/${e?.uid}/${n}/data/${Je}`,null)},onClose:()=>A({isOpen:!1})})}};if(e===void 0)return H.jsx("div",{className:"flex flex-col items-center justify-center h-full w-full mt-50",children:H.jsx(Ni,{children:r("login_required")})});const Nt=()=>{const Y=u.current.value;E(Y);const Se=o.current?.hotInstance;Se&&Se.render()},Rr=Y=>{Y.key==="Enter"&&(Y.preventDefault(),Nt())};return H.jsxs("div",{className:"pt-5 relative",children:[H.jsx(Bp,{children:y.show&&H.jsx(kp.div,{initial:{y:"-100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"-100%",opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"fixed top-50 left-1/2 -translate-x-1/2 z-[2000] p-3 rounded-lg shadow-lg bg-green-500 text-white font-semibold",children:y.message})}),H.jsx(Xp,{...S}),H.jsx("div",{className:"mb-4",children:J?H.jsxs("div",{className:`${Jn.card} p-4`,children:[H.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[H.jsxs("div",{children:[H.jsx(Ni,{children:r("input")}),H.jsx("textarea",{className:"w-full h-64 p-2 border rounded dark:bg-gray-700 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500",value:ue,onChange:Y=>he(Y.target.value),autoFocus:!0})]}),H.jsxs("div",{children:[H.jsx(Ni,{children:r("preview")}),H.jsx("div",{className:"prose dark:prose-invert max-w-none p-2 border rounded h-64 overflow-y-auto dark:bg-gray-700 dark:border-gray-600",children:H.jsx(ao,{children:ue})})]})]}),H.jsxs("div",{className:"mt-2 flex justify-end gap-2",children:[H.jsx(Jr,{variant:"outlined",color:Jn.button.indigo,size:"sm",onClick:()=>j(!1),children:r("cancel")}),H.jsx(Jr,{color:Jn.button.indigo,onClick:Dr,children:r("save")})]})]}):H.jsx("div",{className:`${Jn.card} p-4 min-h-[4rem] cursor-pointer prose dark:prose-invert max-w-none`,onDoubleClick:gn,children:M?H.jsx(ao,{children:M}):H.jsx("p",{className:"text-gray-400",children:r("double_click_to_edit_memo")})})}),H.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 pb-2",children:[H.jsx(Gp,{inputRef:u,onKeyDown:Rr,onSearch:Nt}),H.jsx(Jp,{ui:t,onInsert:Vr,onDelete:Ri,onCsvSave:Yt,onSaveAll:xe})]}),H.jsx(eN,{hotRef:o,search:N,columns:i,rowData:c,afterSelection:Qn,handleAfterColumnResize:Zn})]})};export{mN as MemoSheetGrid,mN as default};
