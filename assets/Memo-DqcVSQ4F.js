const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MemoMain-D1Tkj7hZ.js","assets/index-CSxN88q8.js","assets/index-D9k6uszX.css","assets/AniButton-CEmxmDMi.js","assets/Button-D9x8S5SG.js"])))=>i.map(i=>d[i]);
import{a4 as T,a5 as je,a6 as Re,a7 as Ne,a8 as Oe,a9 as _e,aa as Fe,ab as Pe,ac as Me,ad as Ae,ae as qe,af as Ee,ag as ke,r as d,ah as Ve,ai as O,aj as Le,ak as ce,al as Ye,q as Ge,k as Ke,o as Xe,n as Y,t as G,am as Je,A as oe,C as re,j as r,i as B,an as Ue,T as De,ao as Ze,ap as Qe,aq as et,ar as tt,as as nt,at as st,z as ot,D as rt,J as it,K as at,x as lt,au as ct,U as ut,m as ue,av as dt,F as ft,H as mt,S as gt,W as ht,N as xt,aw as pt,ax as vt,O as $e,P as yt,ay as wt,E as St,az as bt,R as jt,V as de,y as ee,Y as Mt,Z as Et,$ as kt,a3 as Lt,a0 as Dt,a1 as $t,a2 as fe}from"./index-CSxN88q8.js";import{C as It,L as Tt}from"./CommonLayout-XfrX-3Qe.js";import{M as Bt,a as Ct}from"./MemoMoveModal-cX2SYkkq.js";import{u as Ht,S as Wt}from"./useTreeData-CecosACU.js";import{H as Ie,f as me,a as ge,b as zt,e as Rt,d as Nt,g as Ot}from"./fireDetail-Cz8wRFK3.js";import{F as _t}from"./Favorite-B9JSrcgQ.js";import{A}from"./AniButton-CEmxmDMi.js";import{c as Ft}from"./CodeText-vi4p4ybQ.js";import"./Button-D9x8S5SG.js";import"./Collapse-WwaRZ4eJ.js";import"./TextField-B8qLMNQk.js";import"./SinyDate-CUVXaF9o.js";import"./InputAdornment-xg2Naupg.js";import"./Popper-C4Mc3eSo.js";import"./Chip-C84Arf_l.js";import"./index.esm-CWLThzN6.js";import"./datetime-BDx6lZXm.js";function Te(e,t){let o;const n=()=>{const{currentTime:s}=t,a=(s===null?0:s.value)/100;o!==a&&e(a),o=a};return T.update(n,!0),()=>je(n)}const q=new WeakMap;let S;function Pt(e,t){if(t){const{inlineSize:o,blockSize:n}=t[0];return{width:o,height:n}}else return e instanceof SVGElement&&"getBBox"in e?e.getBBox():{width:e.offsetWidth,height:e.offsetHeight}}function At({target:e,contentRect:t,borderBoxSize:o}){var n;(n=q.get(e))===null||n===void 0||n.forEach(s=>{s({target:e,contentSize:t,get size(){return Pt(e,o)}})})}function qt(e){e.forEach(At)}function Vt(){typeof ResizeObserver>"u"||(S=new ResizeObserver(qt))}function Yt(e,t){S||Vt();const o=Re(e);return o.forEach(n=>{let s=q.get(n);s||(s=new Set,q.set(n,s)),s.add(t),S?.observe(n)}),()=>{o.forEach(n=>{const s=q.get(n);s?.delete(t),s?.size||S?.unobserve(n)})}}const V=new Set;let _;function Gt(){_=()=>{const e={width:window.innerWidth,height:window.innerHeight},t={target:window,size:e,contentSize:e};V.forEach(o=>o(t))},window.addEventListener("resize",_)}function Kt(e){return V.add(e),_||Gt(),()=>{V.delete(e),!V.size&&_&&(_=void 0)}}function Xt(e,t){return typeof e=="function"?Kt(e):Yt(e,t)}const Jt=50,he=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),Ut=()=>({time:0,x:he(),y:he()}),Zt={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function xe(e,t,o,n){const s=o[t],{length:i,position:a}=Zt[t],c=s.current,f=o.time;s.current=e[`scroll${a}`],s.scrollLength=e[`scroll${i}`]-e[`client${i}`],s.offset.length=0,s.offset[0]=0,s.offset[1]=s.scrollLength,s.progress=Ne(0,s.scrollLength,s.current);const l=n-f;s.velocity=l>Jt?0:Oe(s.current-c,l)}function Qt(e,t,o){xe(e,"x",t,o),xe(e,"y",t,o),t.time=o}function en(e,t){const o={x:0,y:0};let n=e;for(;n&&n!==t;)if(n instanceof HTMLElement)o.x+=n.offsetLeft,o.y+=n.offsetTop,n=n.offsetParent;else if(n.tagName==="svg"){const s=n.getBoundingClientRect();n=n.parentElement;const i=n.getBoundingClientRect();o.x+=s.left-i.left,o.y+=s.top-i.top}else if(n instanceof SVGGraphicsElement){const{x:s,y:i}=n.getBBox();o.x+=s,o.y+=i;let a=null,c=n.parentNode;for(;!a;)c.tagName==="svg"&&(a=c),c=n.parentNode;n=a}else break;return o}const se={start:0,center:.5,end:1};function pe(e,t,o=0){let n=0;if(e in se&&(e=se[e]),typeof e=="string"){const s=parseFloat(e);e.endsWith("px")?n=s:e.endsWith("%")?e=s/100:e.endsWith("vw")?n=s/100*document.documentElement.clientWidth:e.endsWith("vh")?n=s/100*document.documentElement.clientHeight:e=s}return typeof e=="number"&&(n=t*e),o+n}const tn=[0,0];function nn(e,t,o,n){let s=Array.isArray(e)?e:tn,i=0,a=0;return typeof e=="number"?s=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?s=e.split(" "):s=[e,se[e]?e:"0"]),i=pe(s[0],o,n),a=pe(s[1],t),i-a}const sn={All:[[0,0],[1,1]]},on={x:0,y:0};function rn(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function an(e,t,o){const{offset:n=sn.All}=o,{target:s=e,axis:i="y"}=o,a=i==="y"?"height":"width",c=s!==e?en(s,e):on,f=s===e?{width:e.scrollWidth,height:e.scrollHeight}:rn(s),l={width:e.clientWidth,height:e.clientHeight};t[i].offset.length=0;let x=!t[i].interpolate;const b=n.length;for(let p=0;p<b;p++){const v=nn(n[p],l[a],f[a],c[i]);!x&&v!==t[i].interpolatorOffsets[p]&&(x=!0),t[i].offset[p]=v}x&&(t[i].interpolate=_e(t[i].offset,Fe(n),{clamp:!1}),t[i].interpolatorOffsets=[...t[i].offset]),t[i].progress=Pe(0,1,t[i].interpolate(t[i].current))}function ln(e,t=e,o){if(o.x.targetOffset=0,o.y.targetOffset=0,t!==e){let n=t;for(;n&&n!==e;)o.x.targetOffset+=n.offsetLeft,o.y.targetOffset+=n.offsetTop,n=n.offsetParent}o.x.targetLength=t===e?t.scrollWidth:t.clientWidth,o.y.targetLength=t===e?t.scrollHeight:t.clientHeight,o.x.containerLength=e.clientWidth,o.y.containerLength=e.clientHeight}function cn(e,t,o,n={}){return{measure:()=>ln(e,n.target,o),update:s=>{Qt(e,o,s),(n.offset||n.target)&&an(e,o,n)},notify:()=>t(o)}}const R=new WeakMap,ve=new WeakMap,te=new WeakMap,ye=e=>e===document.documentElement?window:e;function ie(e,{container:t=document.documentElement,...o}={}){let n=te.get(t);n||(n=new Set,te.set(t,n));const s=Ut(),i=cn(t,e,s,o);if(n.add(i),!R.has(t)){const c=()=>{for(const p of n)p.measure()},f=()=>{for(const p of n)p.update(Me.timestamp)},l=()=>{for(const p of n)p.notify()},x=()=>{T.read(c,!1,!0),T.read(f,!1,!0),T.update(l,!1,!0)};R.set(t,x);const b=ye(t);window.addEventListener("resize",x,{passive:!0}),t!==document.documentElement&&ve.set(t,Xt(t,x)),b.addEventListener("scroll",x,{passive:!0})}const a=R.get(t);return T.read(a,!1,!0),()=>{var c;je(a);const f=te.get(t);if(!f||(f.delete(i),f.size))return;const l=R.get(t);R.delete(t),l&&(ye(t).removeEventListener("scroll",l),(c=ve.get(t))===null||c===void 0||c(),window.removeEventListener("resize",l))}}function un({source:e,container:t,axis:o="y"}){e&&(t=e);const n={value:0},s=ie(i=>{n.value=i[o].progress*100},{container:t,axis:o});return{currentTime:n,cancel:s}}const ne=new Map;function Be({source:e,container:t=document.documentElement,axis:o="y"}={}){e&&(t=e),ne.has(t)||ne.set(t,{});const n=ne.get(t);return n[o]||(n[o]=qe()?new ScrollTimeline({source:t,axis:o}):un({source:t,axis:o})),n[o]}function dn(e){return e.length===2}function Ce(e){return e&&(e.target||e.offset)}function fn(e,t){return dn(e)||Ce(t)?ie(o=>{e(o[t.axis].progress,o)},t):Te(e,Be(t))}function mn(e,t){if(e.flatten(),Ce(t))return e.pause(),ie(o=>{e.time=e.duration*o[t.axis].progress},t);{const o=Be(t);return e.attachTimeline?e.attachTimeline(o,n=>(n.pause(),Te(s=>{n.time=n.duration*s},o))):Ae}}function gn(e,{axis:t="y",...o}={}){const n={axis:t,...o};return typeof e=="function"?fn(e,n):mn(e,n)}function we(e,t){Ve(!!(!t||t.current))}const hn=()=>({scrollX:O(0),scrollY:O(0),scrollXProgress:O(0),scrollYProgress:O(0)});function xn({container:e,target:t,layoutEffect:o=!0,...n}={}){const s=Ee(hn);return(o?ke:d.useEffect)(()=>(we("target",t),we("container",e),gn((a,{x:c,y:f})=>{s.scrollX.set(c.current),s.scrollXProgress.set(c.progress),s.scrollY.set(f.current),s.scrollYProgress.set(f.progress)},{...n,container:e?.current||void 0,target:t?.current||void 0})),[e,t,JSON.stringify(n.offset)]),s}function pn(e){const t=Ee(()=>O(e)),{isStatic:o}=d.useContext(Le);if(o){const[,n]=d.useState(e);d.useEffect(()=>t.on("change",n),[])}return t}function Se(e){return typeof e=="number"?e:parseFloat(e)}function vn(e,t={}){const{isStatic:o}=d.useContext(Le),n=d.useRef(null),s=pn(ce(e)?Se(e.get()):e),i=d.useRef(s.get()),a=d.useRef(()=>{}),c=()=>{const l=n.current;l&&l.time===0&&l.sample(Me.delta),f(),n.current=Ye({keyframes:[s.get(),i.current],velocity:s.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:a.current})},f=()=>{n.current&&n.current.stop()};return d.useInsertionEffect(()=>s.attach((l,x)=>o?x(l):(i.current=l,a.current=x,T.update(c),s.get()),f),[JSON.stringify(t)]),ke(()=>{if(ce(e))return e.on("change",l=>s.set(Se(l)))},[s]),s}const yn=e=>{const[t,o]=d.useState([]),n=()=>{const s=Ge(Y(G,`memo_txt/${e}`),Xe("bookmark"),Ke("Y"));Je(s,i=>{if(!i.exists())return;const a=i.val(),c=[];for(let f in a){const l=a[f];l.key=f,c.push(l)}c.sort((f,l)=>f.title>l.title?1:-1),o(c)})};return d.useEffect(()=>{n()},[e]),t};function wn(e){const{user:t}=oe(),o=re(),n=yn(t?.uid);return t===void 0?r.jsx(r.Fragment,{}):r.jsxs(B,{sx:{display:"flex",alignItems:"center",flexDirection:"column",width:"100%"},children:[r.jsx(Ue,{}),r.jsx(De,{children:"BookMark"}),n&&n.map((s,i)=>r.jsx("div",{children:r.jsx(Ze,{component:"button",variant:"body",onClick:()=>{e.onSelected(s.key),o(`/memo/${s.key}`)},children:r.jsx(Qe,{variant:"body1",children:s.title})})},i))]})}var N={},be;function Sn(){if(be)return N;be=1;var e=et();Object.defineProperty(N,"__esModule",{value:!0}),N.default=void 0;var t=e(tt()),o=nt();return N.default=(0,t.default)((0,o.jsx)("path",{d:"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3m-4.4 15.55-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05"}),"FavoriteBorder"),N}var bn=Sn();const jn=st(bn),Mn=e=>r.jsxs(B,{sx:{flexGrow:1,my:2,width:"100%",display:"grid",gridTemplateColumns:"64px 64px  64px  64px ",flexDirection:"row",alignItems:"center",alignContent:"center",justifyContent:"center",textAlign:"center",whiteSpace:"nowrap"},children:[r.jsx(A,{type:"button",size:"small",variant:"outlined",color:"success",onClick:e.onEdit,children:"수정"}),r.jsx(A,{type:"button",size:"small",variant:"outlined",onClick:e.onNewMemo,children:"새글"}),r.jsx(A,{type:"button",size:"small",variant:"outlined",color:"warning",onClick:e.onMove,children:"이동"}),r.jsx(A,{type:"button",size:"small",variant:"outlined",color:"error",onClick:e.onDelete,children:"삭제"})]}),En=e=>{const{title:t,gbn:o,date:n,text:s,image:i,setFireId:a,bookmark:c,setBookmark:f,isLoading:l,onReload:x}=ot(),{scrollYProgress:b}=xn(),p=vn(b,{stiffness:100,damping:30,restDelta:.001}),[v,w]=d.useState(!1),[F,C]=d.useState(!1),j=re(),M=d.useRef(),P=d.useRef();P.current=e.searchWord;const{memoId:g}=rt(),m=it()?.state?.fullIndex,{user:u}=oe(),{settings:k,saveSettings:E}=at(),K=()=>{M.current=!1,l===!1&&w(!0)},X=()=>{M.current=!0,l===!1&&w(!0)},H=async()=>{console.log("handleDelete.memoId=",g);const h=`memo_txt/${u.uid}/${g}`,y=await Nt(h,`memo/${u.uid}`);if(console.log("handleDelete.result=",y),y===void 0){alert("삭제에 실패했습니다.[code:d02]");return}j("/memo")},L=()=>{window.confirm(`하위 자료가 있는 경우 같이 삭제됩니다.
삭제하시겠습니까?`)&&H()},W=()=>{w(!1)},J=()=>{C(!0)},D=()=>{const h=c==="Y"?"N":"Y";f(h),pt(u.uid,g,h)},U=async h=>{console.log("onMoveSubmit.memoId",g),console.log("onMoveSubmit.moveId",h);try{const y=`memo_txt/${u.uid}/${g}`,$=`memo/${u.uid}`,z=await Rt(y,$,g,h);console.log("onMoveSubmit.result=",z)}catch(y){console.log("catch",y)}finally{C(!1)}},Z=async(h,y)=>{const $=`memo_txt/${u.uid}/`,z=`memo/${u.uid}/`,I=await me(void 0,$,z,m,h);console.log("onNewSubmit.newKey=",I,", homeId=",g);const Q=await ge("home_txt","home",I,y);console.log("onNewSubmit.imageResult",Q),I!==void 0&&j(`/memo/${I}`),M.current=!1,w(!1),x()},He=async(h,y,$)=>{const z=`memo_txt/${u.uid}`,I=`memo/${u.uid}`,Q=await zt(z,I,g,y);console.log("onPostSubmit.imageDelete",Q),await me(g,`memo_txt/${u.uid}/`,`memo/${u.uid}/`,m,h),console.log("onPostSubmit.files=",$);const ze=await ge(`memo_txt/${u.uid}`,`memo/${u.uid}`,g,$);if(console.log("onNewSubmit.imageResult",ze),console.log("onPostSubmit.fullIndex",m),m===void 0){const le=await vt(u.uid,`${g}/fullIndex`);le!==void 0&&$e(Y(G,`memo/${u.uid}/${le}/title`),h.edTitle)}M.current=!1,w(!1),x()};d.useEffect(()=>{if(t.current!==void 0){const h=document.querySelector("title");h.innerHTML=`${lt.templateName} :: ${t.current}`}},[t.current]),d.useEffect(()=>{u!==void 0&&g!==void 0&&(E({...k,nodeId:g}),m!==void 0&&ct(u.uid,g,m),a(`memo_txt/${u.uid}/${g}`,`memo/${u.uid}/${g}`,P.current)),w(!1)},[g,u]);function We(){document.querySelectorAll("pre").forEach(h=>{h.innerHTML=Ft(h.innerHTML)})}return d.useEffect(()=>{s!==null&&(We(),console.log("useEffect.detailText=",s))},[s]),g===""||u===void 0?r.jsx(r.Fragment,{}):r.jsxs(ut.Fragment,{children:[r.jsx(ue.div,{className:"progress-bar",style:{scaleX:p}}),r.jsxs(De,{style:{display:"flex",flexDirection:"row",alignItems:"center",alignContent:"center",justifyContent:"space-between"},children:[r.jsx("div",{}),r.jsx("div",{children:t.current}),r.jsx(ue.div,{whileHover:{scale:1.1},whileTap:{scale:.8},initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},transition:{duration:.5,ease:[0,.71,.2,1.01],scale:{type:"spring",damping:2,stiffness:100,restDelta:.001}},children:r.jsx(dt,{"aria-label":"bookmark",onClick:D,children:c==="Y"?r.jsx(_t,{sx:{color:"red"}}):r.jsx(jn,{})})})]}),r.jsxs(ft,{className:"container",sx:{p:0,width:"100%"},children:[!v&&r.jsx(Mn,{onEdit:K,onNewMemo:X,onMove:J,onDelete:L,onBookmark:D,bookmark:c}),v&&r.jsx(Ie,{newMode:M.current,onPostSubmit:He,onNewSubmit:Z,onCancel:W,title:t.current,gbn:o.current,date:n.current,content:s,imageList:i}),r.jsxs(B,{sx:{my:2},children:[r.jsx(mt,{show:!v,text:s}),!v&&r.jsx(gt,{imageList:i,show:!v}),l&&r.jsx(B,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:r.jsx(ht,{sx:{mt:5}})})]}),r.jsx(Bt,{userId:u.uid,open:F,data:e.data,onClose:()=>C(!1),onPost:U})]}),r.jsx(xt,{})]})},kn=220,qn=()=>{const e=re(),{user:t}=oe(),[o,n]=d.useState(!1),s=d.useRef(),[i,a,c]=Ht(""),[f,l]=d.useState(""),x=d.useRef();d.useEffect(()=>{t!==void 0&&a(`memo/${t.uid}`)},[t]);const b=(m,u)=>{x.current=u,l(m),e(`/memo/${m}`,{state:{fullIndex:u}})},p=()=>{if(console.log("onNewMemoBtn.fullIndex",x),t===void 0){alert("로그인 후 이용 가능합니다.");return}n(!0)},v=m=>{console.log("onSearchDataBtn=",m),m!==""?(a(`memo_txt/${t.uid}`),c(m)):(c(void 0),a(`memo/${t.uid}`)),s.current=m},w=()=>{n(!1)},F=async(m,u)=>{const k=`memo_txt/${t.uid}/`;for(let H=0;H<u.length;H++){const L=u[H].object,W=Ot(L.name);console.log("onNewSubmit.file.name",L.name,"ext=",W);const J={ext:W,name:L.name,use:"Y"},D=Mt(Et(Y(G),k+"image")).key;console.log("onNewSubmit.image.newKey",D),$e(Y(G,k+`image/${D}`),J);const U=await kt(Lt,`memo/${t.uid}/${f}/${D}.${W}`),Z=await Dt(U,L);console.log("onNewSubmit.uploadBytes",Z)}const E=$t(k),K={title:m.edTitle,date:m.edDate,gbn:m.edGbn,memo:m.content,fullIndex:E,up:E,bookmark:"N"};fe(`${k}${E}`,K);const X={gbn:"",property:"m",title:m.edTitle,up:E};fe(`memo/${t.uid}/${E}`,X),n(!1)},C=m=>{console.log("onSelected=",m),l(m)},{height:j,width:M}=yt(),P=r.jsxs(B,{sx:{minHeight:110,flexGrow:1,minWidth:100,maxHeight:j},children:[r.jsx(Tt,{}),r.jsx(Ct,{onNewMemoBtn:p,onSearchDataBtn:v}),r.jsx(B,{sx:{flexGrow:1,minWidth:100,minHeight:110,maxHeight:j-220,height:j-220},children:r.jsx(d.Suspense,{fallback:r.jsx(ee,{}),children:r.jsx(Wt,{data:i,onDetail:b,maxHeight:j-150})})})]}),g=d.lazy(async()=>await wt(()=>import("./MemoMain-D1Tkj7hZ.js"),__vite__mapDeps([0,1,2,3,4]))),ae=t&&t.uid===St?r.jsx(bt,{to:"/homemng",children:" 홈페이지 관리"}):"";return r.jsx(d.Suspense,{fallback:r.jsx(ee,{}),children:r.jsxs(It,{title:"메모장",drawerWidth:kn,width:M,sideContents:P,children:[!o&&r.jsx(d.Suspense,{fallback:r.jsx(ee,{}),children:r.jsxs(jt,{children:[r.jsx(de,{path:"/:memoId",element:r.jsx(En,{searchWord:s.current,data:i})}),r.jsx(de,{path:"*",element:r.jsx(g,{searchWord:s.current,data:i,onNewMemoBtn:p,title:"메모장 홈"})})]})}),o&&r.jsx(Ie,{show:o,newMode:o.current,onPostSubmit:F,onNewSubmit:F,onCancel:w,title:"",content:"",imageList:[]}),r.jsx(wn,{onSelected:C}),ae]})})};export{qn as default};
