const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomeChartForm-D2xM7G9T.js","assets/index-Dlo5qAfl.js","assets/index-CCDqu87I.css","assets/fireMemoDetail-DupTvcft.js","assets/SinyDate-B2UnZu6-.js","assets/Grid-BZTQCb5O.js","assets/index-CTtl7xg0.js","assets/TextField-BJwzc22I.js","assets/InputAdornment-BKz_AKED.js","assets/Popper-BgVt-nsZ.js","assets/Button-FMDonRCy.js","assets/Chip-BYp4Kq0g.js","assets/index.esm-CVkuEgIk.js","assets/TwTitleItem-BNWZ9GOM.js","assets/HomeChartSemiDonut-C-TMZc-Z.js","assets/HomeChartForm-DlNaLvKe.css","assets/MUIMemoMain-DVRZ1qcl.js"])))=>i.map(i=>d[i]);
import{bJ as $e,cE as Le,cF as Fe,be as Oe,e as ae,G as ce,r as p,j as s,k as B,q as it,c8 as at,o as ct,a as dt,f as ut,S as ft,c7 as mt,af as de,ab as E,aG as gt,ag as _e,ad as Ae,ac as Ve,aO as Be,aj as He,a3 as Q,ai as Ke,an as Ue,au as se,a9 as J,Y as xt,a7 as pt,al as ht,B as $,l as he,cO as bt,D as Y,E as We,w as Ne,bd as vt,a4 as Nt,N as It,I as yt,K as St,bf as Ce,cW as xe,H as ze,_ as qe,cX as Ct,s as Ye,cf as jt,cg as wt,M as le,x as kt,ch as Tt,ci as Et,n as Dt,v as re}from"./index-Dlo5qAfl.js";import{T as Rt,u as Ge,a as Je,F as Mt,d as Pt,f as $t,D as Lt,l as Ft,I as Ot,e as je,b as we,c as _t,g as At,H as Vt}from"./HomeChartForm-D2xM7G9T.js";import{a as Bt}from"./TwTitleItem-BNWZ9GOM.js";import{A as V}from"./AniButton-i7AtPWGD.js";import{C as Qe}from"./Collapse-DxEwLU7o.js";import{S as Ht}from"./SinyImageList-nRMRVb2p.js";import{H as Xe}from"./HtmlCode-rMC-Snn1.js";import{c as Kt}from"./CodeText-CcKt_NMF.js";import{s as Ze}from"./commonUtil-D6sNiGcV.js";import{u as Ut}from"./useWindowDimensions-DIlp-qYM.js";import{D as Wt}from"./datetime-BDx6lZXm.js";import{u as zt}from"./index.esm-CVkuEgIk.js";import{S as qt}from"./SinyDate-B2UnZu6-.js";import{S as Yt}from"./SinySelect-luaIh2Vz.js";import{T as ie}from"./TwBadge-ebvrhaJy.js";import{T as Gt}from"./TwCheckbox-Dlrwv6U0.js";import{T as Jt}from"./TwTextArea-DaBplPdm.js";import{T as Qt}from"./TextField-BJwzc22I.js";import{f as Xt}from"./fireMemoDetail-DupTvcft.js";import{g as Zt}from"./memoFun-DpPhML4t.js";import"./HomeChartSemiDonut-C-TMZc-Z.js";import"./Button-FMDonRCy.js";import"./ImageListItem-CwrH3-4m.js";/* empty css                 */import"./copy-L5q-H5_2.js";import"./ComponentCard-D48S9Twc.js";import"./TwRadio-DOQD7TFc.js";import"./toPropertyKey-DCwh5dYN.js";import"./Grid-BZTQCb5O.js";import"./index-CTtl7xg0.js";import"./InputAdornment-BKz_AKED.js";import"./Popper-BgVt-nsZ.js";import"./Chip-BYp4Kq0g.js";var z={},ke;function eo(){if(ke)return z;ke=1;var e=$e();Object.defineProperty(z,"__esModule",{value:!0}),z.default=void 0;var t=e(Le()),o=Fe();return z.default=(0,t.default)((0,o.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"ChevronRight"),z}var to=eo();const oo=Oe(to);var q={},Te;function no(){if(Te)return q;Te=1;var e=$e();Object.defineProperty(q,"__esModule",{value:!0}),q.default=void 0;var t=e(Le()),o=Fe();return q.default=(0,t.default)((0,o.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore"),q}var so=no();const lo=Oe(so);function ro({onSelected:e}){const{user:t}=ae(),o=ce(),[n,r]=p.useState(),[m,x]=p.useState(),i=async d=>{const a=[],g=it(dt(ut,`memo_tree/${d}`),ct("bm"),at("Y")),c=await ft(g);if(!c.exists())return console.log("getBookmark.getFireData.null"),null;const v=c.val();for(let u in v){const l=v[u];l.id=u,l.key=u,l.text=l.title,a.push(l)}a.sort((u,l)=>u.title>l.title?1:-1),r([...a])};return p.useEffect(()=>{t!==void 0&&t!=null&&i(t?.uid)},[t]),p.useEffect(()=>{const d=async(a,g)=>{const c=[...g];if(g)for(const v of g){let u=v;for(;u.parent!==void 0&&u.parent!=="root";){const l=u.parent;u=await mt(`memo_tree/${a}/${l}`);const f={id:u.key,text:u.title,droppable:!1,parent:u.parent};c.filter(b=>b.id===f.id).length===0&&c.push(f)}}for(const v of c){const u=v.id;v.cnt=c.filter(l=>l.parent===u).length}x(c)};n&&n.length>0&&d(t?.uid,n)},[n]),t===null?s.jsx(s.Fragment,{}):s.jsxs("div",{className:"tail-bookmark justify-items-center flex items-center flex-col w-full",children:[s.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),s.jsx(Bt,{children:"주요 목록"}),s.jsx("div",{className:`tail-bookmark 
        grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-1 
        justify-items-center 
        w-full`,children:n&&n.map((d,a)=>s.jsx("div",{children:s.jsx("button",{className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 cursor-pointer",onClick:()=>{e(d.key),o(`/m/${d.key}`)},children:s.jsx("span",{className:"text-base",children:d.title})})},a))}),s.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600 my-3"}),s.jsx(p.Suspense,{fallback:s.jsx(B,{}),children:s.jsx(Rt,{initTreeData:m,uid:t?.uid})})]})}const io=["element"];function ao(e,t){for(let o=0;o<e.length;o+=1)if(t(e[o]))return o;return-1}function co(e,t){let o=0,n=e.length-1;for(;o<=n;){const r=Math.floor((o+n)/2);if(e[r].element===t)return r;e[r].element.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING?n=r-1:o=r+1}return o}const et=p.createContext({});function uo(e){const t=p.useRef(null);return p.useEffect(()=>{t.current=e},[e]),t.current}const Ee=()=>{};function fo(e){const[,t]=p.useState(),{registerDescendant:o=Ee,unregisterDescendant:n=Ee,descendants:r=[],parentId:m=null}=p.useContext(et),x=ao(r,a=>a.element===e.element),i=uo(r),d=r.some((a,g)=>i&&i[g]&&i[g].element!==a.element);return gt(()=>{if(e.element)return o(E({},e,{index:x})),()=>{n(e.element)};t({})},[o,n,x,d,e]),{parentId:m,index:x}}function tt(e){const{children:t,id:o}=e,[n,r]=p.useState([]),m=p.useCallback(d=>{let{element:a}=d,g=de(d,io);r(c=>{if(c.length===0)return[E({},g,{element:a,index:0})];const v=co(c,a);let u;if(c[v]&&c[v].element===a)u=c;else{const l=E({},g,{element:a,index:v});u=c.slice(),u.splice(v,0,l)}return u.forEach((l,f)=>{l.index=f}),u})},[]),x=p.useCallback(d=>{r(a=>a.filter(g=>d!==g.element))},[]),i=p.useMemo(()=>({descendants:n,registerDescendant:m,unregisterDescendant:x,parentId:o}),[n,m,x,o]);return s.jsx(et.Provider,{value:i,children:t})}const ot={instance:null,multiSelect:!1,disabledItemsFocusable:!1,treeId:void 0,icons:{defaultCollapseIcon:null,defaultExpandIcon:null,defaultParentIcon:null,defaultEndIcon:null}},nt=p.createContext(ot),st=()=>p.useContext(nt);function mo(e){const{instance:t,multiSelect:o}=st(),n=t?t.isNodeExpandable(e):!1,r=t?t.isNodeExpanded(e):!1,m=t?t.isNodeFocused(e):!1,x=t?t.isNodeSelected(e):!1,i=t?t.isNodeDisabled(e):!1;return{disabled:i,expanded:r,selected:x,focused:m,handleExpansion:c=>{if(t&&!i){m||t.focusNode(c,e);const v=o&&(c.shiftKey||c.ctrlKey||c.metaKey);n&&!(v&&t.isNodeExpanded(e))&&t.toggleNodeExpansion(c,e)}},handleSelection:c=>{t&&!i&&(m||t.focusNode(c,e),o&&(c.shiftKey||c.ctrlKey||c.metaKey)?c.shiftKey?t.selectRange(c,{end:e}):t.selectNode(c,e,!0):t.selectNode(c,e))},preventSelection:c=>{(c.shiftKey||c.ctrlKey||c.metaKey||i)&&c.preventDefault()}}}const go=["classes","className","displayIcon","expansionIcon","icon","label","nodeId","onClick","onMouseDown"],lt=p.forwardRef(function(t,o){const{classes:n,className:r,displayIcon:m,expansionIcon:x,icon:i,label:d,nodeId:a,onClick:g,onMouseDown:c}=t,v=de(t,go),{disabled:u,expanded:l,selected:f,focused:h,handleExpansion:b,handleSelection:N,preventSelection:I}=mo(a),C=i||x||m,S=k=>{I(k),c&&c(k)},w=k=>{b(k),N(k),g&&g(k)};return s.jsxs("div",E({},v,{className:_e(r,n.root,l&&n.expanded,f&&n.selected,h&&n.focused,u&&n.disabled),onClick:w,onMouseDown:S,ref:o,children:[s.jsx("div",{className:n.iconContainer,children:C}),s.jsx("div",{className:n.label,children:d})]}))});function xo(e){return Ve("MuiTreeItem",e)}const D=Ae("MuiTreeItem",["root","group","content","expanded","selected","focused","disabled","iconContainer","label"]),po=["children","className","collapseIcon","ContentComponent","ContentProps","endIcon","expandIcon","disabled","icon","id","label","nodeId","onClick","onMouseDown","TransitionComponent","TransitionProps"],ho=e=>{const{classes:t}=e;return Ke({root:["root"],content:["content"],expanded:["expanded"],selected:["selected"],focused:["focused"],disabled:["disabled"],iconContainer:["iconContainer"],label:["label"],group:["group"]},xo,t)},bo=Q("li",{name:"MuiTreeItem",slot:"Root",overridesResolver:(e,t)=>t.root})({listStyle:"none",margin:0,padding:0,outline:0}),vo=Q(lt,{name:"MuiTreeItem",slot:"Content",overridesResolver:(e,t)=>[t.content,t.iconContainer&&{[`& .${D.iconContainer}`]:t.iconContainer},t.label&&{[`& .${D.label}`]:t.label}]})(({theme:e})=>({padding:"0 8px",width:"100%",boxSizing:"border-box",display:"flex",alignItems:"center",cursor:"pointer",WebkitTapHighlightColor:"transparent","&:hover":{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${D.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity,backgroundColor:"transparent"},[`&.${D.focused}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${D.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:se(e.palette.primary.main,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:se(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:se(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${D.focused}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:se(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`& .${D.iconContainer}`]:{marginRight:4,width:15,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},[`& .${D.label}`]:E({paddingLeft:4,width:"100%",boxSizing:"border-box",minWidth:0,position:"relative"},e.typography.body1)})),No=Q(Qe,{name:"MuiTreeItem",slot:"Group",overridesResolver:(e,t)=>t.group})({margin:0,padding:0,marginLeft:17}),Io=p.forwardRef(function(t,o){const n=Be({props:t,name:"MuiTreeItem"}),{children:r,className:m,collapseIcon:x,ContentComponent:i=lt,ContentProps:d,endIcon:a,expandIcon:g,disabled:c,icon:v,id:u,label:l,nodeId:f,onClick:h,onMouseDown:b,TransitionComponent:N=Qe,TransitionProps:I}=n,C=de(n,po),{icons:S,multiSelect:w,disabledItemsFocusable:k,treeId:M,instance:T}=st();let P;u!=null?P=u:M&&f&&(P=`${M}-${f}`);const[X,ue]=p.useState(null),Z=p.useRef(null),fe=He(ue,o),me=p.useMemo(()=>({element:X,id:f}),[f,X]),{index:K,parentId:ee}=fo(me),F=!!(Array.isArray(r)?r.length:r),O=T?T.isNodeExpanded(f):!1,te=T?T.isNodeFocused(f):!1,U=T?T.isNodeSelected(f):!1,L=T?T.isNodeDisabled(f):!1,y=E({},n,{expanded:O,focused:te,selected:U,disabled:L}),j=ho(y);let _,W;F&&(O?W=x||S.defaultCollapseIcon:W=g||S.defaultExpandIcon),F?_=S.defaultParentIcon:_=a||S.defaultEndIcon,p.useEffect(()=>{if(T&&K!==-1)return T.updateNode({id:f,idAttribute:P,index:K,parentId:ee,expandable:F,disabled:c}),()=>T.removeNode(f)},[T,ee,K,f,F,c,P]),p.useEffect(()=>{if(T&&l){var R,ne;return T.mapFirstChar(f,((R=(ne=Z.current)==null?void 0:ne.textContent)!=null?R:"").substring(0,1).toLowerCase())}},[T,f,l]);let A;w?A=U:U&&(A=!0);function oe(R){if(R.target===R.currentTarget){let ge;typeof R.target.getRootNode=="function"?ge=R.target.getRootNode():ge=Ue(R.target),ge.getElementById(M).focus({preventScroll:!0})}const ne=!k&&L;T&&!te&&R.currentTarget===R.target&&!ne&&T.focusNode(R,f)}return s.jsxs(bo,E({className:_e(j.root,m),role:"treeitem","aria-expanded":F?O:void 0,"aria-selected":A,"aria-disabled":L||void 0,id:P,tabIndex:-1},C,{ownerState:y,onFocus:oe,ref:fe,children:[s.jsx(vo,E({as:i,ref:Z,classes:{root:j.content,expanded:j.expanded,selected:j.selected,focused:j.focused,disabled:j.disabled,iconContainer:j.iconContainer,label:j.label},label:l,nodeId:f,onClick:h,onMouseDown:b,icon:v,expansionIcon:W,displayIcon:_,ownerState:y},d)),r&&s.jsx(tt,{id:f,children:s.jsx(No,E({as:N,unmountOnExit:!0,className:j.group,in:O,component:"ul",role:"group"},I,{children:r}))})]}))});function yo(e){return Ve("MuiTreeView",e)}Ae("MuiTreeView",["root"]);const So=(e,t)=>{const o=p.useRef({}),[n,r]=p.useState(()=>{const x={};return e.forEach(i=>{i.models&&Object.entries(i.models).forEach(([d,a])=>{o.current[d]={controlledProp:a.controlledProp,defaultProp:a.defaultProp,isControlled:t[a.controlledProp]!==void 0},x[d]=t[a.defaultProp]})}),x});return Object.fromEntries(Object.entries(o.current).map(([x,i])=>{const d=i.isControlled?t[i.controlledProp]:n[x];return[x,{value:d,setValue:a=>{i.isControlled||r(g=>E({},g,{[x]:a}))}}]}))};class Co{constructor(){this.maxListeners=20,this.warnOnce=!1,this.events={}}on(t,o,n={}){let r=this.events[t];r||(r={highPriority:new Map,regular:new Map},this.events[t]=r),n.isFirst?r.highPriority.set(o,!0):r.regular.set(o,!0)}removeListener(t,o){this.events[t]&&(this.events[t].regular.delete(o),this.events[t].highPriority.delete(o))}removeAllListeners(){this.events={}}emit(t,...o){const n=this.events[t];if(!n)return;const r=Array.from(n.highPriority.keys()),m=Array.from(n.regular.keys());for(let x=r.length-1;x>=0;x-=1){const i=r[x];n.highPriority.has(i)&&i.apply(this,o)}for(let x=0;x<m.length;x+=1){const i=m[x];n.regular.has(i)&&i.apply(this,o)}}once(t,o){const n=this;this.on(t,function r(...m){n.removeListener(t,r),o.apply(n,m)})}}const pe=(e,t)=>{const o=e.getNode(t),n=e.getNavigableChildrenIds(o.parentId),r=n.indexOf(t);if(r===0)return o.parentId;let m=n[r-1];for(;e.isNodeExpanded(m)&&e.getNavigableChildrenIds(m).length>0;)m=e.getNavigableChildrenIds(m).pop();return m},G=(e,t)=>{if(e.isNodeExpanded(t)&&e.getNavigableChildrenIds(t).length>0)return e.getNavigableChildrenIds(t)[0];let o=e.getNode(t);for(;o!=null;){const n=e.getNavigableChildrenIds(o.parentId),r=n[n.indexOf(o.id)+1];if(r)return r;o=e.getNode(o.parentId)}return null},be=e=>{let t=e.getNavigableChildrenIds(null).pop();for(;e.isNodeExpanded(t);)t=e.getNavigableChildrenIds(t).pop();return t},ve=e=>e.getNavigableChildrenIds(null)[0],H=(e,t)=>{Object.assign(e,t)},jo=e=>e.isPropagationStopped!==void 0,wo=({instance:e})=>{const[t]=p.useState(()=>new Co),o=p.useCallback((...r)=>{const[m,x,i={}]=r;i.defaultMuiPrevented=!1,!(jo(i)&&i.isPropagationStopped())&&t.emit(m,x,i)},[t]),n=p.useCallback((r,m)=>(t.on(r,m),()=>{t.removeListener(r,m)}),[t]);H(e,{$$publishEvent:o,$$subscribeEvent:n})},ko=[wo],To=e=>{const t=[...ko,...e.plugins],o=t.reduce((l,f)=>f.getDefaultizedParams?f.getDefaultizedParams(l):l,e),n=So(t,o),m=p.useRef({}).current,x=p.useRef(null),i=He(x,e.rootRef),[d,a]=p.useState(()=>{const l={};return t.forEach(f=>{f.getInitialState&&Object.assign(l,f.getInitialState(o))}),l}),g=[];let c=ot;const v=l=>{const f=l({instance:m,params:o,state:d,setState:a,rootRef:x,models:n})||{};f.getRootProps&&g.push(f.getRootProps),f.contextValue&&(c=f.contextValue)};return t.forEach(v),{getRootProps:(l={})=>{const f=E({role:"tree",tabIndex:0},l,{ref:i});return g.forEach(h=>{Object.assign(f,h(l))}),f},rootRef:i,contextValue:c}};function Eo(e){const{value:t,children:o}=e;return s.jsx(nt.Provider,{value:t,children:s.jsx(tt,{children:o})})}const Do=(e,t,o)=>{e.$$publishEvent(t,o)},Ro=({instance:e,params:t})=>{const o=p.useRef({}),n=p.useCallback(a=>o.current[a],[]),r=p.useCallback(a=>{o.current[a.id]=a},[]),m=p.useCallback(a=>{const g=E({},o.current);delete g[a],o.current=g,Do(e,"removeNode",{id:a})},[e]),x=p.useCallback(a=>{if(a==null)return!1;let g=e.getNode(a);if(!g)return!1;if(g.disabled)return!0;for(;g.parentId!=null;)if(g=e.getNode(g.parentId),g.disabled)return!0;return!1},[e]),i=J(a=>Object.values(o.current).filter(g=>g.parentId===a).sort((g,c)=>g.index-c.index).map(g=>g.id));H(e,{getNode:n,updateNode:r,removeNode:m,getChildrenIds:i,getNavigableChildrenIds:a=>{let g=e.getChildrenIds(a);return t.disabledItemsFocusable||(g=g.filter(c=>!e.isNodeDisabled(c))),g},isNodeDisabled:x})},Ie=({instance:e,params:t,models:o})=>{const n=p.useCallback(i=>Array.isArray(o.expanded.value)?o.expanded.value.indexOf(i)!==-1:!1,[o.expanded.value]),r=p.useCallback(i=>{var d;return!!((d=e.getNode(i))!=null&&d.expandable)},[e]),m=J((i,d)=>{if(d==null)return;let a;o.expanded.value.indexOf(d)!==-1?a=o.expanded.value.filter(g=>g!==d):a=[d].concat(o.expanded.value),t.onNodeToggle&&t.onNodeToggle(i,a),o.expanded.setValue(a)});H(e,{isNodeExpanded:n,isNodeExpandable:r,toggleNodeExpansion:m,expandAllSiblings:(i,d)=>{const a=e.getNode(d),c=e.getChildrenIds(a.parentId).filter(u=>e.isNodeExpandable(u)&&!e.isNodeExpanded(u)),v=o.expanded.value.concat(c);c.length>0&&(o.expanded.setValue(v),t.onNodeToggle&&t.onNodeToggle(i,v))}})};Ie.models={expanded:{controlledProp:"expanded",defaultProp:"defaultExpanded"}};const Mo=[];Ie.getDefaultizedParams=e=>{var t;return E({},e,{defaultExpanded:(t=e.defaultExpanded)!=null?t:Mo})};const Po=(e,t,o)=>{if(t===o)return[t,o];const n=e.getNode(t),r=e.getNode(o);if(n.parentId===r.id||r.parentId===n.id)return r.parentId===n.id?[n.id,r.id]:[r.id,n.id];const m=[n.id],x=[r.id];let i=n.parentId,d=r.parentId,a=x.indexOf(i)!==-1,g=m.indexOf(d)!==-1,c=!0,v=!0;for(;!g&&!a;)c&&(m.push(i),a=x.indexOf(i)!==-1,c=i!==null,!a&&c&&(i=e.getNode(i).parentId)),v&&!a&&(x.push(d),g=m.indexOf(d)!==-1,v=d!==null,!g&&v&&(d=e.getNode(d).parentId));const u=a?i:d,l=e.getChildrenIds(u),f=m[m.indexOf(u)-1],h=x[x.indexOf(u)-1];return l.indexOf(f)<l.indexOf(h)?[t,o]:[o,t]},ye=({instance:e,params:t,models:o})=>{const n=p.useRef(null),r=p.useRef(!1),m=p.useRef([]),x=l=>Array.isArray(o.selected.value)?o.selected.value.indexOf(l)!==-1:o.selected.value===l,i=(l,f,h=!1)=>{if(!t.disableSelection){if(h){if(Array.isArray(o.selected.value)){let b;o.selected.value.indexOf(f)!==-1?b=o.selected.value.filter(N=>N!==f):b=[f].concat(o.selected.value),t.onNodeSelect&&t.onNodeSelect(l,b),o.selected.setValue(b)}}else{const b=t.multiSelect?[f]:f;t.onNodeSelect&&t.onNodeSelect(l,b),o.selected.setValue(b)}n.current=f,r.current=!1,m.current=[]}},d=(l,f)=>{const[h,b]=Po(e,l,f),N=[h];let I=h;for(;I!==b;)I=G(e,I),N.push(I);return N},a=(l,f)=>{let h=o.selected.value.slice();const{start:b,next:N,current:I}=f;!N||!I||(m.current.indexOf(I)===-1&&(m.current=[]),r.current?m.current.indexOf(N)!==-1?(h=h.filter(C=>C===b||C!==I),m.current=m.current.filter(C=>C===b||C!==I)):(h.push(N),m.current.push(N)):(h.push(N),m.current.push(I,N)),t.onNodeSelect&&t.onNodeSelect(l,h),o.selected.setValue(h))},g=(l,f)=>{let h=o.selected.value.slice();const{start:b,end:N}=f;r.current&&(h=h.filter(S=>m.current.indexOf(S)===-1));let I=d(b,N);I=I.filter(S=>!e.isNodeDisabled(S)),m.current=I;let C=h.concat(I);C=C.filter((S,w)=>C.indexOf(S)===w),t.onNodeSelect&&t.onNodeSelect(l,C),o.selected.setValue(C)};return H(e,{isNodeSelected:x,selectNode:i,selectRange:(l,f,h=!1)=>{if(t.disableSelection)return;const{start:b=n.current,end:N,current:I}=f;h?a(l,{start:b,next:N,current:I}):b!=null&&N!=null&&g(l,{start:b,end:N}),r.current=!0},rangeSelectToLast:(l,f)=>{n.current||(n.current=f);const h=r.current?n.current:f;e.selectRange(l,{start:h,end:be(e)})},rangeSelectToFirst:(l,f)=>{n.current||(n.current=f);const h=r.current?n.current:f;e.selectRange(l,{start:h,end:ve(e)})}}),{getRootProps:()=>({"aria-multiselectable":t.multiSelect})}};ye.models={selected:{controlledProp:"selected",defaultProp:"defaultSelected"}};const $o=[];ye.getDefaultizedParams=e=>{var t,o,n;return E({},e,{disableSelection:(t=e.disableSelection)!=null?t:!1,multiSelect:(o=e.multiSelect)!=null?o:!1,defaultSelected:(n=e.defaultSelected)!=null?n:e.multiSelect?$o:null})};const De=1e3;class Lo{constructor(t=De){this.timeouts=new Map,this.cleanupTimeout=De,this.cleanupTimeout=t}register(t,o,n){this.timeouts||(this.timeouts=new Map);const r=setTimeout(()=>{typeof o=="function"&&o(),this.timeouts.delete(n.cleanupToken)},this.cleanupTimeout);this.timeouts.set(n.cleanupToken,r)}unregister(t){const o=this.timeouts.get(t.cleanupToken);o&&(this.timeouts.delete(t.cleanupToken),clearTimeout(o))}reset(){this.timeouts&&(this.timeouts.forEach((t,o)=>{this.unregister({cleanupToken:o})}),this.timeouts=void 0)}}class Fo{constructor(){this.registry=new FinalizationRegistry(t=>{typeof t=="function"&&t()})}register(t,o,n){this.registry.register(t,o,n)}unregister(t){this.registry.unregister(t)}reset(){}}class Oo{}function _o(e){let t=0;return function(n,r,m){e.registry===null&&(e.registry=typeof FinalizationRegistry<"u"?new Fo:new Lo);const[x]=p.useState(new Oo),i=p.useRef(null),d=p.useRef();d.current=m;const a=p.useRef(null);if(!i.current&&d.current){const g=(c,v)=>{if(!v.defaultMuiPrevented){var u;(u=d.current)==null||u.call(d,c,v)}};i.current=n.$$subscribeEvent(r,g),t+=1,a.current={cleanupToken:t},e.registry.register(x,()=>{var c;(c=i.current)==null||c.call(i),i.current=null,a.current=null},a.current)}else!d.current&&i.current&&(i.current(),i.current=null,a.current&&(e.registry.unregister(a.current),a.current=null));p.useEffect(()=>{if(!i.current&&d.current){const g=(c,v)=>{if(!v.defaultMuiPrevented){var u;(u=d.current)==null||u.call(d,c,v)}};i.current=n.$$subscribeEvent(r,g)}return a.current&&e.registry&&(e.registry.unregister(a.current),a.current=null),()=>{var g;(g=i.current)==null||g.call(i),i.current=null}},[n,r])}}const Ao={registry:null},Vo=_o(Ao),Se=({instance:e,params:t,state:o,setState:n,models:r,rootRef:m})=>{const x=J(u=>{const l=typeof u=="function"?u(o.focusedNodeId):u;n(f=>E({},f,{focusedNodeId:l}))}),i=p.useCallback(u=>o.focusedNodeId===u,[o.focusedNodeId]),d=J((u,l)=>{l&&(x(l),t.onNodeFocus&&t.onNodeFocus(u,l))});H(e,{isNodeFocused:i,focusNode:d}),Vo(e,"removeNode",({id:u})=>{x(l=>l===u&&m.current===Ue(m.current).activeElement?e.getChildrenIds(null)[0]:l)});const a=u=>l=>{var f;if((f=u.onFocus)==null||f.call(u,l),l.target===l.currentTarget){const h=N=>{const I=e.getNode(N);return I&&(I.parentId==null||e.isNodeExpanded(I.parentId))};let b;Array.isArray(r.selected.value)?b=r.selected.value.find(h):r.selected.value!=null&&h(r.selected.value)&&(b=r.selected.value),b==null&&(b=e.getNavigableChildrenIds(null)[0]),e.focusNode(l,b)}},g=u=>l=>{var f;(f=u.onBlur)==null||f.call(u,l),x(null)},c=e.getNode(o.focusedNodeId),v=c?c.idAttribute:null;return{getRootProps:u=>({onFocus:a(u),onBlur:g(u),"aria-activedescendant":v??void 0})}};Se.getInitialState=()=>({focusedNodeId:null});Se.getDefaultizedParams=e=>{var t;return E({},e,{disabledItemsFocusable:(t=e.disabledItemsFocusable)!=null?t:!1})};function Bo(e){return e&&e.length===1&&e.match(/\S/)}function Re(e,t,o){for(let n=t;n<e.length;n+=1)if(o===e[n])return n;return-1}const Ho=({instance:e,params:t,state:o})=>{const r=xt().direction==="rtl",m=p.useRef({}),x=J((u,l)=>(m.current[u]=l,()=>{const f=E({},m.current);delete f[u],m.current=f}));H(e,{mapFirstChar:x});const i=u=>(o.focusedNodeId!=null&&e.isNodeExpandable(o.focusedNodeId)&&(e.isNodeExpanded(o.focusedNodeId)?e.focusNode(u,G(e,o.focusedNodeId)):e.isNodeDisabled(o.focusedNodeId)||e.toggleNodeExpansion(u,o.focusedNodeId)),!0),d=u=>{if(o.focusedNodeId==null)return!1;if(e.isNodeExpanded(o.focusedNodeId)&&!e.isNodeDisabled(o.focusedNodeId))return e.toggleNodeExpansion(u,o.focusedNodeId),!0;const l=e.getNode(o.focusedNodeId).parentId;return l?(e.focusNode(u,l),!0):!1},a=(u,l,f)=>{let h,b;const N=f.toLowerCase(),I=[],C=[];Object.keys(m.current).forEach(S=>{const w=e.getNode(S),k=w.parentId?e.isNodeExpanded(w.parentId):!0,M=t.disabledItemsFocusable?!1:e.isNodeDisabled(S);k&&!M&&(I.push(S),C.push(m.current[S]))}),h=I.indexOf(l)+1,h>=I.length&&(h=0),b=Re(C,h,N),b===-1&&(b=Re(C,0,N)),b>-1&&e.focusNode(u,I[b])},g=(u,l)=>{e.isNodeDisabled(G(e,l))||e.selectRange(u,{end:G(e,l),current:l},!0)},c=(u,l)=>{e.isNodeDisabled(pe(e,l))||e.selectRange(u,{end:pe(e,l),current:l},!0)},v=u=>l=>{var f;(f=u.onKeyDown)==null||f.call(u,l);let h=!1;const b=l.key;if(l.altKey||l.currentTarget!==l.target||o.focusedNodeId==null)return;const N=l.ctrlKey||l.metaKey;switch(b){case" ":!t.disableSelection&&!e.isNodeDisabled(o.focusedNodeId)&&(h=!0,t.multiSelect&&l.shiftKey?e.selectRange(l,{end:o.focusedNodeId}):t.multiSelect?e.selectNode(l,o.focusedNodeId,!0):e.selectNode(l,o.focusedNodeId)),l.stopPropagation();break;case"Enter":e.isNodeDisabled(o.focusedNodeId)||(e.isNodeExpandable(o.focusedNodeId)?(e.toggleNodeExpansion(l,o.focusedNodeId),h=!0):t.disableSelection||(h=!0,t.multiSelect?e.selectNode(l,o.focusedNodeId,!0):e.selectNode(l,o.focusedNodeId))),l.stopPropagation();break;case"ArrowDown":t.multiSelect&&l.shiftKey&&!t.disableSelection&&g(l,o.focusedNodeId),e.focusNode(l,G(e,o.focusedNodeId)),h=!0;break;case"ArrowUp":t.multiSelect&&l.shiftKey&&!t.disableSelection&&c(l,o.focusedNodeId),e.focusNode(l,pe(e,o.focusedNodeId)),h=!0;break;case"ArrowRight":r?h=d(l):h=i(l);break;case"ArrowLeft":r?h=i(l):h=d(l);break;case"Home":t.multiSelect&&N&&l.shiftKey&&!t.disableSelection&&!e.isNodeDisabled(o.focusedNodeId)&&e.rangeSelectToFirst(l,o.focusedNodeId),e.focusNode(l,ve(e)),h=!0;break;case"End":t.multiSelect&&N&&l.shiftKey&&!t.disableSelection&&!e.isNodeDisabled(o.focusedNodeId)&&e.rangeSelectToLast(l,o.focusedNodeId),e.focusNode(l,be(e)),h=!0;break;default:b==="*"?(e.expandAllSiblings(l,o.focusedNodeId),h=!0):t.multiSelect&&N&&b.toLowerCase()==="a"&&!t.disableSelection?(e.selectRange(l,{start:ve(e),end:be(e)}),h=!0):!N&&!l.shiftKey&&Bo(b)&&(a(l,o.focusedNodeId,b),h=!0)}h&&(l.preventDefault(),l.stopPropagation())};return{getRootProps:u=>({onKeyDown:v(u)})}},Ko=({instance:e,params:t})=>{const o=pt(t.id);return{getRootProps:()=>({id:o}),contextValue:{treeId:o,instance:e,multiSelect:t.multiSelect,disabledItemsFocusable:t.disabledItemsFocusable,icons:{defaultCollapseIcon:t.defaultCollapseIcon,defaultEndIcon:t.defaultEndIcon,defaultExpandIcon:t.defaultExpandIcon,defaultParentIcon:t.defaultParentIcon}}}},Uo=[Ro,Ie,ye,Se,Ho,Ko],Wo=["disabledItemsFocusable","expanded","defaultExpanded","onNodeToggle","onNodeFocus","disableSelection","defaultSelected","selected","multiSelect","onNodeSelect","id","defaultCollapseIcon","defaultEndIcon","defaultExpandIcon","defaultParentIcon","children"],zo=e=>{const{classes:t}=e;return Ke({root:["root"]},yo,t)},Me=Q("ul",{name:"MuiTreeView",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:0,margin:0,listStyle:"none",outline:0}),qo=p.forwardRef(function(t,o){const n=Be({props:t,name:"MuiTreeView"}),r=n,m=n,{disabledItemsFocusable:x,expanded:i,defaultExpanded:d,onNodeToggle:a,onNodeFocus:g,disableSelection:c,defaultSelected:v,selected:u,multiSelect:l,onNodeSelect:f,id:h,defaultCollapseIcon:b,defaultEndIcon:N,defaultExpandIcon:I,defaultParentIcon:C,children:S}=m,w=de(m,Wo),{getRootProps:k,contextValue:M}=To({disabledItemsFocusable:x,expanded:i,defaultExpanded:d,onNodeToggle:a,onNodeFocus:g,disableSelection:c,defaultSelected:v,selected:u,multiSelect:l,onNodeSelect:f,id:h,defaultCollapseIcon:b,defaultEndIcon:N,defaultExpandIcon:I,defaultParentIcon:C,plugins:Uo,rootRef:o}),T=zo(n),P=ht({elementType:Me,externalSlotProps:{},externalForwardedProps:w,className:T.root,getSlotProps:k,ownerState:r});return s.jsx(Eo,{value:M,children:s.jsx(Me,E({},P,{children:S}))})}),Yo=Q(Io)(({theme:e})=>({color:e.palette.text.secondary,[`& .${D.content}`]:{color:e.palette.text.secondary,borderTopRightRadius:e.spacing(2),borderBottomRightRadius:e.spacing(2),paddingRight:e.spacing(1),fontWeight:e.typography.fontWeightMedium,"&.MuiTreeItem-content":{paddingLeft:"3px",paddingRight:"3px"},".MuiTreeItem-label":{paddingLeft:"0px"},".MuiTreeItem-iconContainer":{marginRight:"0px"},"&.Mui-expanded":{fontWeight:e.typography.fontWeightRegular},"&:hover":{backgroundColor:e.palette.action.hover},"&.Mui-selected":{backgroundColor:"rgba(145, 85, 253, 0.16)",color:"var(--tree-view-color)"},"&.Mui-focused, &.Mui-selected, &.Mui-selected.Mui-focused":{backgroundColor:"rgba(145, 85, 253, 0.16)",color:"var(--tree-view-color)"},[`& .${D.label}`]:{fontWeight:"inherit",color:"inherit"}},[`& .${D.group}`]:{marginLeft:0,[`& .${D.content}`]:{paddingLeft:e.spacing(1)}}})),Go=p.forwardRef(function(t,o){const{labelIcon:n,labelInfo:r,labelText:m,pl:x,...i}=t;return s.jsx(Yo,{label:s.jsxs($,{sx:{display:"flex",alignItems:"center",p:.5,pr:2,pl:{pl:x}},children:[s.jsx($,{component:n,color:"inherit",sx:{mr:1,pl:{pl:x}}}),s.jsx(he,{sx:{fontWeight:"inherit",flexGrow:1},component:"div",children:m}),s.jsx(he,{variant:"caption",color:"inherit",children:r})]}),...i,ref:o})}),rt=e=>{const{id:t,fullIndex:o,title:n,sub:r}=e.item;if(t===void 0)return console.log("SubTreeItem.item.undefined=",e.item),s.jsx(s.Fragment,{});const m=r&&Object.values(r).length>0?Object.values(r).length+"":"";return s.jsx(Go,{onClick:()=>e.onDetail(t,o),nodeId:t,labelText:n,labelInfo:m,pl:e.pl,children:r!=null?Object.values(r).sort((x,i)=>x.title>i.title?1:-1).map((x,i)=>s.jsx("div",{style:{paddingLeft:e.pl+5},children:s.jsx(rt,{onDetail:e.onDetail,item:x,pl:e.pl+5})},i+"")):""})};function Jo(e){const[t,o]=p.useState([]),[n,r]=p.useState([]),m=(d,a)=>{e.onDetail(d,a)};p.useEffect(()=>{if(e.expandIndex!==void 0){let d=e.expandIndex.split("/");d=d.filter(a=>a!=="sub"),e.expandIndex.indexOf("undefined")<0&&(o(d),r(d[d.length-1]))}},[e.expandIndex]);const x=(d,a)=>{},i=(d,a)=>{o(a)};return s.jsx($,{sx:{minHeight:180,flexGrow:1,display:"flex",flexDirection:"column",height:e.maxHeight,overflow:"hidden",overflowY:"auto",width:"100%"},children:s.jsx(qo,{"aria-label":"icon expansion",defaultCollapseIcon:s.jsx(lo,{}),defaultExpandIcon:s.jsx(oo,{}),expanded:t,onNodeSelect:x,selected:n,onNodeToggle:i,sx:{flexGrow:1,overflow:"hidden",overflowY:"auto"},children:e.data&&e.data.map((d,a)=>s.jsx(rt,{onDetail:m,item:d,parentIndex:a+1,pl:5},a+1))})})}const Qo={position:"absolute",top:"50%",left:"50%",display:"flex",flexDirection:"column",alignItems:"center",transform:"translate(-50%, -50%)",width:250,maxHeight:"400px",bgcolor:"background.paper",border:"1px solid #000",boxShadow:24,boxSizing:"border-box",p:4},Xo=e=>s.jsxs($,{sx:{my:2,mt:3,display:"flex"},children:[s.jsx(V,{type:"submit",variant:"outlined",color:"success",onClick:e.onPost,children:"확인"}),s.jsx(V,{type:"button",variant:"outlined",onClick:e.onClose,children:"취소"})]}),Zo=e=>{const[t,o]=p.useState(e.open),[n,r]=p.useState(),m=()=>{o(!1),r(void 0),e.onClose()};p.useEffect(()=>{o(e.open)},[e.open]);const x=d=>{r(d)},i=()=>{if(n===void 0){alert("이동할 메모장을 선택해 주세요");return}e.onPost(n)};return s.jsx("div",{children:s.jsx(bt,{open:t,onClose:m,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:s.jsxs($,{sx:Qo,children:[s.jsx(he,{id:"modal-modal-title",variant:"h6",component:"h2",children:"이동할 메모장 선택"}),s.jsx(Y,{}),s.jsx($,{sx:{width:"100%",minHeight:110,maxHeight:200,flexGrow:1,minWidth:100,overflow:"hidden"},children:s.jsx(Jo,{data:e.data,onDetail:x,maxHeight:200})}),s.jsx(Xo,{onPost:i,onClose:m})]})})})},en=e=>s.jsxs($,{sx:{flexGrow:1,my:2,width:"100%",display:"grid",gridTemplateColumns:"64px 64px  64px  64px ",flexDirection:"row",alignItems:"center",alignContent:"center",justifyContent:"center",textAlign:"center",whiteSpace:"nowrap"},children:[s.jsx(V,{type:"button",size:"small",variant:"outlined",color:"success",onClick:e.onEdit,children:"수정"}),s.jsx(V,{type:"button",size:"small",variant:"outlined",onClick:e.onNewMemo,children:"새글"}),e.rootDb==="memo"?s.jsx(V,{type:"button",size:"small",variant:"outlined",color:"warning",onClick:e.onMove,children:"이동"}):"",s.jsx(V,{type:"button",size:"small",variant:"outlined",color:"error",onClick:e.onDelete,children:"삭제"})]}),tn=e=>{const{rootDb:t,isLoading:o,memoDetailData:n}=e;console.log("MemoDetail.memoDetailData.title=",n?.title,", bookmark=",n?.bookmark);const{scrollYProgress:r}=Ge(),m=Je(r,{stiffness:100,damping:30,restDelta:.001}),[x,i]=p.useState(!1),d=ce(),a=p.useRef();a.current=e.searchWord;const{memoId:g}=We(),v=Ne()?.state?.fullIndex,{user:u}=ae(),l=()=>{const S=`/${t}/edit/${g}`;d(S,{state:{fullIndex:v}})},f=()=>{const S=`/${t}/insert/${g}`;d(S,{state:{fullIndex:v}})},h=async()=>{const S=t==="memo"?`${t}_txt/${u.uid}/${g}`:`${t}_txt/${g}`,w=t==="memo"?`${t}/${u.uid}`:t;if(await $t(S,w)===void 0){alert("삭제에 실패했습니다.[code:d02]");return}e.onTreeUpdate(),d(`/${t}`)},b=()=>{window.confirm(`하위 자료가 있는 경우 같이 삭제됩니다.
삭제하시겠습니까?`)&&h()},N=()=>{i(!0)},I=()=>{e.onBookmark()},C=async S=>{try{const w=t==="memo"?`${t}_txt/${u.uid}`:`${t}_txt`,k=t==="memo"?`memo/${u.uid}`:t,M=await Pt(w,k,g,S);e.onTreeUpdate()}catch(w){console.log("catch",w)}finally{i(!1)}};return p.useEffect(()=>{n&&n.title!==void 0&&Ze({title:n.title,description:n.title});function S(){window.scrollTo({top:0}),n&&n.html!=="N"&&document.querySelectorAll("pre").forEach(w=>{w.innerHTML=Kt(w.innerHTML)})}n&&n.memo!==null&&S()},[n]),o?s.jsx(B,{}):g===""||u===void 0?s.jsx(s.Fragment,{}):s.jsxs("div",{children:[s.jsx(vt.div,{className:"progress-bar",style:{scaleX:m}}),s.jsxs("div",{className:`grid grid-cols-3 
				items-center w-full 
				dark:bg-stone-950 rounded-md shadow-sm 
				dark:shadow-stone-800 shadow-stone-900`,children:[s.jsx("div",{}),s.jsx("div",{className:"flex justify-center",children:n&&n.title}),s.jsxs("div",{className:"text-right justify-end mr-3.5",children:[s.jsx(Nt,{"aria-label":"bookmark",onClick:I,children:n&&n.bookmark==="Y"?s.jsx(It,{sx:{color:"red"}}):s.jsx(Mt,{})}),s.jsx("div",{className:"text-right mb-3 text-sm text-red-400",children:e.pathNm})]})]}),s.jsxs("div",{className:"w-full p-0 m-0",children:[s.jsx(en,{rootDb:t,onEdit:l,onNewMemo:f,onMove:N,onDelete:b,onBookmark:I,bookmark:n&&n.bookmark}),s.jsxs($,{sx:{my:2},children:[n&&n.html==="N"?s.jsx(Xe,{postData:n&&n.memo}):n&&n.html!=="N"&&n.memo&&s.jsx(yt,{text:n.memo}),s.jsx(Ht,{imageList:n&&n.image}),!n&&s.jsx($,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:s.jsx(St,{sx:{mt:5}})})]}),s.jsx(Zo,{userId:u?.uid,open:x,data:e.data,onClose:()=>i(!1),onPost:C})]})]})},on=({onSubmit:e,onCancel:t,isSubmitting:o,newMode:n})=>s.jsxs("div",{className:"flex justify-end mb-1.5 gap-1",children:[s.jsxs(Ce,{variant:"outlined",color:"success",disabled:o,onClick:r=>{r.preventDefault(),e(r)},children:[n?"새글":""," 저장"]}),s.jsx(Ce,{variant:"outlined",color:"error",onClick:t,children:"취소"})]}),nn=p.lazy(()=>qe(()=>import("./HomeChartForm-D2xM7G9T.js").then(e=>e.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])));Ft.Quill.register("modules/imageDrop",Ot);ze.configure({languages:["javascript","ruby","python","java","cpp","kotlin","sql"]});const sn={syntax:{highlight:e=>ze.highlightAuto(e).value},toolbar:[[{header:"1"},{header:"2"},{header:"3"},{font:[]}],[{size:[]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","image","video"],["clean"],["code-block"]],imageDrop:!0,clipboard:{matchVisual:!1}},ln=["header","font","size","bold","italic","underline","strike","blockquote","list","bullet","indent","link","image","video","clean","code-block","code-custom"],rn=e=>{const[t,o]=p.useState(e.imageList),[n,r]=p.useState(e.htmlCheck==="Y"),[m,x]=p.useState(e.newMode?"":e.content),i=p.useRef(),d=p.useRef(),a=p.useRef(null),g=p.useRef(null),c=e.newMode,v=p.useRef([]),{height:u}=Ut(),l=Wt.now().setZone("Asia/Seoul").toFormat("yyyy-MM-dd"),f={edTitle:c?"":e.title,edGbn:e.gbn?e.gbn:"etc",edDate:c?l:e.date,content:c?"":e.content,memoTxt:c?"":e.content,htmlCheck:e.htmlCheck},{register:h,handleSubmit:b,trigger:N,control:I,setValue:C,getValues:S,watch:w,formState:{errors:k,isSubmitting:M}}=zt({mode:"onChange",defaultValues:f});p.useEffect(()=>{h("edDate",{required:!0,minLength:10}),h("edGbn",{required:!0}),h("htmlCheck"),h("memoTxt")},[]),p.useEffect(()=>{v.current=[],i.current=e.content,d.current=!1},[e.content]);const T=async y=>{c?await e.onNewSubmit(y,v.current):await e.onPostSubmit(y,t,v.current)},P=()=>{b(T)()},X=y=>{console.log("onDelete.imageList=",y),o(y)},ue=y=>{let j=i.current;y.ext==="jpg"?j+=`<img src='${y.url}'/>`:y.ext==="mp4"&&(j+=`<video preload="auto" controls="" src='${y.url}'></video>`),i.current=j},Z=y=>{i.current=y},fe=y=>{console.log("handleFileUpload",y),v.current=y};function me(y){i.current=y,C("content",y),N("content")}function K(y){console.log("handleChangeDate=",y);let j=xe(y);j.format("YYYY-MM-DD HH:mm:ss"),console.log("handleChangeDate.dayjs=",j.format("YYYY-MM-DD HH:mm:ss")),C("edDate",j.format("YYYY-MM-DD")),N("edDate")}const ee=y=>{console.log("onChecked=",y),C("htmlCheck",y?"Y":"N"),r(y)},F=w("content"),O=[{value:"",text:"None"},{value:"react",text:"React"},{value:"css",text:"CSS"},{value:"android",text:"Android"},{value:"java",text:"JAVA"},{value:"image",text:"그림 / 사진"},{value:"etc",text:"기타"},{value:"mui",text:"MUI"}],te=["React","JavaScript","Bash","Java","Kotlin","CSS","C++","C#","Command","Script","Python","Ruby","Go","Swift","Rust"],U=y=>{const j=a.current;if(j){const _=j.selectionStart,W=j.selectionEnd,A=m.slice(0,_),oe=m.slice(W);x(A+y+oe),C("memoTxt",A+y+oe),setTimeout(()=>{j.selectionStart=j.selectionEnd=_+y.length,j.focus()},0)}},L=y=>{U(y)};return s.jsx("div",{className:"my-2 mb-[50px], w-full",children:s.jsxs("form",{onSubmit:b(T),style:{width:"100%",minHeight:"300px",maxHeight:{height:u},display:"flex",flexDirection:"column"},children:[s.jsx(on,{onSubmit:y=>P(),onCancel:e.onCancel,isSubmitting:M,newMode:c}),s.jsx(Lt,{control:I,onDelete:X,onInsert:ue,setContent:Z,onFileUpload:fe,imageList:e.imageList}),s.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[s.jsx(Qt,{...h("edTitle",{required:"해당 필드는 필수입니다.",minLength:{value:1,message:"1글자 이상 입력해주세요."}}),fullWidth:!0,label:"제목",placeholder:"제목",variant:"filled",size:"small",error:!!k.edTitle}),s.jsx(Yt,{id:"edGbn",name:"edGbn",label:"구분",mdSize:6,control:I,defaultValue:S("edGbn"),selectList:O,error:!!k.edGbn,onChange:y=>{y.preventDefault();const j=y.target.value;console.log("edGbn=",S("edGbn")),C("edGbn",j)}}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(qt,{id:"edDate",label:"일자",mdSize:6,value:xe(S("edDate")),...h("edDate"),defaultValue:xe(S("edDate")),onChange:K}),s.jsx(Gt,{id:"html",checked:n,onChange:ee,label:"HTML사용"})]})]}),s.jsx(Y,{}),s.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[s.jsx("div",{className:"max-h-130 overflow-y-scroll",children:s.jsx(Xe,{postData:m})}),s.jsxs("div",{children:[s.jsx(Jt,{ref:a,className:"",value:m,onChange:y=>{C("memoTxt",y),x(y)},rows:22}),s.jsx(Y,{}),s.jsxs("div",{className:"grid grid-cols-4 gap-2 xsm:grid-cols-5 sm:grid-cols-7 md:grid-cols-7 lg:grid-cols-8",children:[s.jsx(ie,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L("<box></box>"),children:"<Box>"}),s.jsx(ie,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L("</code>"),children:"</code>"}),te.map((y,j)=>s.jsx(ie,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L("<code>"+y+"</code>"),children:y},j)),s.jsx(ie,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L('<a href="" target="_blank"></a>'),children:"Link"})]}),s.jsx(Y,{})]})]}),s.jsx(p.Suspense,{fallback:s.jsx("div",{children:"Loading editor..."}),children:s.jsx(nn,{ref:g,fullWidth:!0,theme:"snow",id:"content",name:"content",type:"div",value:F,style:{minWidth:"400px",border:"1px solid primary.main",minHeight:"200px",height:"400px",maxHeight:"450px"},modules:sn,formats:ln,onChange:me})}),s.jsx(Y,{})]})})},Pe=e=>{const{rootDb:t,isLoading:o,memoDetailData:n}=e,{scrollYProgress:r}=Ge();Je(r,{stiffness:100,damping:30,restDelta:.001});const m=ce(),x=p.useRef(),i=p.useRef();i.current=e.searchWord;const{memoId:d}=We(),a=Ne(),g=n?.fullIndex,{user:c}=ae();x.current=a.pathname.split("/")[2]==="insert",console.log("MemoDetailEdit.memoDetailData=",n?.title),console.log("MemoDetailEdit.newMode=",x.current);const v=()=>{const f=`/${t}/${d==="insert"?"":d}`;m(f,{state:{fullIndex:g}})},u=async(f,h)=>{console.log("onNewSubmit.values",f),console.log("onNewSubmit.fullIndex",g);const b=t==="memo"?`${t}_txt/${c.uid}/`:`${t}_txt/`,N=t==="memo"?`${t}/${c.uid}/`:`${t}/`;console.log("onNewSubmit.txtLocate",b),console.log("onNewSubmit.locate",N);const I=await je(void 0,b,N,g,f);if(await we(`${t}_txt`,t,I,h),I!==void 0){const C=`/${t}/${I}`;m(C,{state:{reflash:!0}})}},l=async(f,h,b)=>{const N=t==="memo"?`${t}_txt/${c.uid}`:`${t}_txt`,I=t==="memo"?`${t}/${c.uid}`:t;await _t(N,I,d,h),console.log("onPostSubmit.values",f);const C=await je(x.current?void 0:d,`${N}/`,`${I}/`,g,f);console.log("onPostSubmit.newKey=",C),console.log("onPostSubmit.files=",b);const S=await we(`${N}/`,`${I}/`,d,b);if(console.log("onNewSubmit.imageResult",S),console.log("onPostSubmit.fullIndex",g),t==="memo"&&g===void 0){const k=await Ct(c.uid,`${d}/fullIndex`);console.log("onPostSubmit.fullPath",k),k!==void 0&&Ye(`memo/${c.uid}/${k}/title`,f.edTitle)}x.current=!1;const w=`/${t}/${d}`;m(w,{state:{fullIndex:g,reflash:!0}})};return p.useEffect(()=>{n&&n.title!==void 0&&Ze({title:n.title,description:n.title});function f(){document.querySelectorAll("pre").forEach((h,b)=>{})}n&&n.memo!==null&&f()},[n]),d===""||c===void 0?s.jsx(s.Fragment,{}):(console.log("MemoDetailEdit.isLoading=",o),n===void 0||o?s.jsx(B,{}):s.jsx(s.Fragment,{children:s.jsx("div",{className:"w-full p-0 m-0",children:x.current===!1&&n&&(n.title===void 0||n.title===""||n.title===null)?s.jsx(B,{}):s.jsx(rn,{newMode:x.current,onPostSubmit:l,onNewSubmit:u,onCancel:v,title:n?.title,gbn:n?.gbn,date:n?.date,htmlCheck:n?.html?n?.html:"Y",content:n?.memo,imageList:n?.image})})}))},an=p.lazy(async()=>await qe(()=>import("./MUIMemoMain-DVRZ1qcl.js"),__vite__mapDeps([16,1,2,10]))),Hn=({rootDb:e})=>{const t=ce(),{user:o}=ae(),n=p.useRef(),r=p.useRef(!0),m=p.useRef(),[x,i]=p.useState(),d=p.useRef(!1),a=Ne(),g=p.useRef(!1);g.current=a?.state?.reflash===!0;const c=jt({queryKey:["treeMemo",o?.uid,n.current],queryFn:()=>At(e,o?.uid,n.current)});c.data!==void 0&&c.data!==""&&!d.current&&(d.current=!0);const v=()=>{const b=x;b&&(b.bookmark=b.bookmark==="Y"?"N":"Y");const N=e==="memo"?`memo_tree/${o.uid}/${m.current}/bm`:`home_txt/${m.current}/bookmark`;Ye(N,x.bookmark),i({...x,bookmark:b.bookmark})};p.useEffect(()=>{o!==void 0&&o!=null&&c.refetch()},[o]),p.useEffect(()=>{const b=async C=>{if(C!==""&&o){const S=await Xt(e,o?.uid,C,n.current);e==="memo"&&(S.path=Zt(c.data,C)),S.code==="404"&&(S.title="No title"),r.current=!1,i(S===void 0?{}:S)}else i({})},N=a.pathname.split("/"),I=N.length>2?N[N.length-1]:"";r.current=!0,m.current=I,b(I)},[a.pathname,o,g.current]),p.useEffect(()=>{o!==void 0&&o!=null&&c.refetch()},[g.current]);const u=b=>{d.current=!1,b!==void 0&&(n.current=b),c.refetch()},l=b=>{b.id!==m.current&&(r.current=!0,t(`/${e==="memo"?"m":e}/${b.id}`))},f=()=>{if(o==null){alert("로그인 후 이용 가능합니다.");return}const b=`/${e==="memo"?"m":e}/insert/insert`;t(b)},h=b=>{};return wt,e==="memo"||le,e==="memo"&&o?.uid===kt&&le,le,le,o!==null&&Tt,d.current&&c.isFetched?(Et,c.data,o?.uid,m.current):o===null?s.Fragment:B,s.jsxs(s.Fragment,{children:[s.jsx(p.Suspense,{fallback:s.jsx(B,{}),children:s.jsxs(Dt,{children:[s.jsx(re,{path:"/edit/:memoId",element:s.jsx(Pe,{rootDb:e,isLoading:r.current,searchWord:n.current,memoDetailData:x})}),s.jsx(re,{path:"/insert/:memoId",element:s.jsx(Pe,{rootDb:e,isLoading:r.current,searchWord:n.current,memoDetailData:x})}),s.jsx(re,{path:"/:memoId",element:s.jsx(tn,{rootDb:e,isLoading:r.current,searchWord:n.current,memoDetailData:x,onTreeUpdate:u,onBookmark:v,data:c.data})}),s.jsx(re,{path:"*",element:s.jsx(an,{searchWord:n.current,data:c.data,onNewMemoBtn:f,title:e==="memo"?"메모장":"홈페이지관리",rootDb:e})})]})}),e==="memo"?s.jsx(ro,{onSelected:h}):null,m.current===""?s.jsx(Vt,{data:c.data}):null]})};export{Hn as default};
