const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MemoSheetGrid-A9MHwHnC.js","assets/index-DvCfMAy7.js","assets/router-v4BRDFYV.js","assets/vendor-CCYiWZgt.js","assets/index-Dov5qmly.css","assets/App-D_yiCkAU.js","assets/App-C0oX4rhs.css","assets/MemoDetailEdit-LcN0rfoC.js","assets/HtmlBadge-8DuOyKW2.js","assets/TwCheckbox-CC8--8t2.js","assets/TwTextArea-ZdOnoBxc.js","assets/IpInfo-BnsfxJx0.js","assets/angle-right-BCeYVboh.js","assets/MemoDetailEdit-CXguKeju.css","assets/MemoDetailUtil-DNsnGUHp.js"])))=>i.map(i=>d[i]);
import{j as t,_ as oe}from"./index-DvCfMAy7.js";import{aI as nt,aJ as rt,aK as U,aL as ge,aM as Pe,aN as Ve,aO as ot,aP as lt,aQ as it,aR as ct,aS as dt,aT as ut,aU as Fe,aV as mt,aW as ht,aX as ve,aY as Z,aZ as Ye,a_ as Ne,a$ as Xe,b0 as ue,b1 as ye,a1 as ft,a3 as pt,a9 as xt,b2 as gt,a6 as vt,b as W,b3 as le,ay as ie,i as Y,c as Q,e as _,b4 as yt,b5 as Ce,q as x,b6 as bt,b7 as Ge,aC as he,b8 as wt,ad as Ke,b9 as jt,h as D,ba as kt,bb as Nt,bc as Ct,bd as St,be as Lt,bf as Tt,bg as Se,bh as Mt,bi as Et,O as $t,bj as fe,p as T,m as pe,bk as zt,K as Le,X as Te,H as _t,ae as Ot,af as Bt,bl as It,bm as Rt,bn as At,bo as Dt,bp as Wt,bq as Ue,br as Ht,bs as Pt,bt as Vt,bu as Ft,bv as Yt,bw as Me,bx as Xt,by as Gt,bz as Kt,bA as Ut,bB as Jt,bC as qt,bD as Zt,bE as Qt}from"./App-D_yiCkAU.js";import{r as c,a as ce,c as es,u as de,N as Ee,R as ee,e as ts,f as G}from"./router-v4BRDFYV.js";import{I as ss}from"./IpInfo-BnsfxJx0.js";import{S as Je,a as as,b as ns}from"./angle-right-BCeYVboh.js";const ae=new WeakMap;let ne;const qe=(e,a,s)=>(n,r)=>r&&r[0]?r[0][e+"Size"]:rt(n)&&"getBBox"in n?n.getBBox()[a]:n[s],rs=qe("inline","width","offsetWidth"),os=qe("block","height","offsetHeight");function ls({target:e,borderBoxSize:a}){ae.get(e)?.forEach(s=>{s(e,{get width(){return rs(e,a)},get height(){return os(e,a)}})})}function is(e){e.forEach(ls)}function cs(){typeof ResizeObserver>"u"||(ne=new ResizeObserver(is))}function ds(e,a){ne||cs();const s=nt(e);return s.forEach(n=>{let r=ae.get(n);r||(r=new Set,ae.set(n,r)),r.add(a),ne?.observe(n)}),()=>{s.forEach(n=>{const r=ae.get(n);r?.delete(a),r?.size||ne?.unobserve(n)})}}const re=new Set;let K;function us(){K=()=>{const e={get width(){return window.innerWidth},get height(){return window.innerHeight}};re.forEach(a=>a(e))},window.addEventListener("resize",K)}function ms(e){return re.add(e),K||us(),()=>{re.delete(e),!re.size&&typeof K=="function"&&(window.removeEventListener("resize",K),K=void 0)}}function hs(e,a){return typeof e=="function"?ms(e):ds(e,a)}function Ze(e,a){let s;const n=()=>{const{currentTime:r}=a,o=(r===null?0:r.value)/100;s!==o&&e(o),s=o};return U.preUpdate(n,!0),()=>ge(n)}function fs(...e){const a=!Array.isArray(e[0]),s=a?0:-1,n=e[0+s],r=e[1+s],l=e[2+s],o=e[3+s],i=Pe(r,l,o);return a?i(n):i}function ps(e,a,s){const n=e.get();let r=null,l=n,o;const i=typeof n=="string"?n.replace(/[\d.-]/g,""):void 0,h=()=>{r&&(r.stop(),r=null)},m=()=>{h(),r=new ot({keyframes:[ze(e.get()),ze(l)],velocity:e.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...s,onUpdate:o})};if(e.attach((d,f)=>{l=d,o=p=>f($e(p,i)),U.postRender(m)},h),Ve(a)){const d=a.on("change",p=>e.set($e(p,i))),f=e.on("destroy",d);return()=>{d(),f()}}return h}function $e(e,a){return a?e+a:e}function ze(e){return typeof e=="number"?e:parseFloat(e)}const xs=50,_e=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),gs=()=>({time:0,x:_e(),y:_e()}),vs={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function Oe(e,a,s,n){const r=s[a],{length:l,position:o}=vs[a],i=r.current,h=s.time;r.current=e[`scroll${o}`],r.scrollLength=e[`scroll${l}`]-e[`client${l}`],r.offset.length=0,r.offset[0]=0,r.offset[1]=r.scrollLength,r.progress=lt(0,r.scrollLength,r.current);const m=n-h;r.velocity=m>xs?0:it(r.current-i,m)}function ys(e,a,s){Oe(e,"x",a,s),Oe(e,"y",a,s),a.time=s}function bs(e,a){const s={x:0,y:0};let n=e;for(;n&&n!==a;)if(ct(n))s.x+=n.offsetLeft,s.y+=n.offsetTop,n=n.offsetParent;else if(n.tagName==="svg"){const r=n.getBoundingClientRect();n=n.parentElement;const l=n.getBoundingClientRect();s.x+=r.left-l.left,s.y+=r.top-l.top}else if(n instanceof SVGGraphicsElement){const{x:r,y:l}=n.getBBox();s.x+=r,s.y+=l;let o=null,i=n.parentNode;for(;!o;)i.tagName==="svg"&&(o=i),i=n.parentNode;n=o}else break;return s}const xe={start:0,center:.5,end:1};function Be(e,a,s=0){let n=0;if(e in xe&&(e=xe[e]),typeof e=="string"){const r=parseFloat(e);e.endsWith("px")?n=r:e.endsWith("%")?e=r/100:e.endsWith("vw")?n=r/100*document.documentElement.clientWidth:e.endsWith("vh")?n=r/100*document.documentElement.clientHeight:e=r}return typeof e=="number"&&(n=a*e),s+n}const ws=[0,0];function js(e,a,s,n){let r=Array.isArray(e)?e:ws,l=0,o=0;return typeof e=="number"?r=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?r=e.split(" "):r=[e,xe[e]?e:"0"]),l=Be(r[0],s,n),o=Be(r[1],a),l-o}const ks={All:[[0,0],[1,1]]},Ns={x:0,y:0};function Cs(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function Ss(e,a,s){const{offset:n=ks.All}=s,{target:r=e,axis:l="y"}=s,o=l==="y"?"height":"width",i=r!==e?bs(r,e):Ns,h=r===e?{width:e.scrollWidth,height:e.scrollHeight}:Cs(r),m={width:e.clientWidth,height:e.clientHeight};a[l].offset.length=0;let d=!a[l].interpolate;const f=n.length;for(let p=0;p<f;p++){const w=js(n[p],m[o],h[o],i[l]);!d&&w!==a[l].interpolatorOffsets[p]&&(d=!0),a[l].offset[p]=w}d&&(a[l].interpolate=Pe(a[l].offset,dt(n),{clamp:!1}),a[l].interpolatorOffsets=[...a[l].offset]),a[l].progress=ut(0,1,a[l].interpolate(a[l].current))}function Ls(e,a=e,s){if(s.x.targetOffset=0,s.y.targetOffset=0,a!==e){let n=a;for(;n&&n!==e;)s.x.targetOffset+=n.offsetLeft,s.y.targetOffset+=n.offsetTop,n=n.offsetParent}s.x.targetLength=a===e?a.scrollWidth:a.clientWidth,s.y.targetLength=a===e?a.scrollHeight:a.clientHeight,s.x.containerLength=e.clientWidth,s.y.containerLength=e.clientHeight}function Ts(e,a,s,n={}){return{measure:r=>{Ls(e,n.target,s),ys(e,s,r),(n.offset||n.target)&&Ss(e,s,n)},notify:()=>a(s)}}const q=new WeakMap,Ie=new WeakMap,me=new WeakMap,Re=e=>e===document.scrollingElement?window:e;function Qe(e,{container:a=document.scrollingElement,...s}={}){if(!a)return Fe;let n=me.get(a);n||(n=new Set,me.set(a,n));const r=gs(),l=Ts(a,e,r,s);if(n.add(l),!q.has(a)){const i=()=>{for(const f of n)f.measure(mt.timestamp);U.preUpdate(h)},h=()=>{for(const f of n)f.notify()},m=()=>U.read(i);q.set(a,m);const d=Re(a);window.addEventListener("resize",m,{passive:!0}),a!==document.documentElement&&Ie.set(a,hs(a,m)),d.addEventListener("scroll",m,{passive:!0}),m()}const o=q.get(a);return U.read(o,!1,!0),()=>{ge(o);const i=me.get(a);if(!i||(i.delete(l),i.size))return;const h=q.get(a);q.delete(a),h&&(Re(a).removeEventListener("scroll",h),Ie.get(a)?.(),window.removeEventListener("resize",h))}}const Ae=new Map;function Ms(e){const a={value:0},s=Qe(n=>{a.value=n[e.axis].progress*100},e);return{currentTime:a,cancel:s}}function et({source:e,container:a,...s}){const{axis:n}=s;e&&(a=e);const r=Ae.get(a)??new Map;Ae.set(a,r);const l=s.target??"self",o=r.get(l)??{},i=n+(s.offset??[]).join(",");return o[i]||(o[i]=!s.target&&ht()?new ScrollTimeline({source:a,axis:n}):Ms({container:a,...s})),o[i]}function Es(e,a){const s=et(a);return e.attachTimeline({timeline:a.target?void 0:s,observe:n=>(n.pause(),Ze(r=>{n.time=n.iterationDuration*r},s))})}function $s(e){return e.length===2}function zs(e,a){return $s(e)?Qe(s=>{e(s[a.axis].progress,s)},a):Ze(e,et(a))}function _s(e,{axis:a="y",container:s=document.scrollingElement,...n}={}){if(!s)return Fe;const r={axis:a,container:s,...n};return typeof e=="function"?zs(e,r):Es(e,r)}const Os=()=>({scrollX:Z(0),scrollY:Z(0),scrollXProgress:Z(0),scrollYProgress:Z(0)}),se=e=>e?!e.current:!1;function Bs({container:e,target:a,...s}={}){const n=ve(Os),r=c.useRef(null),l=c.useRef(!1),o=c.useCallback(()=>(r.current=_s((i,{x:h,y:m})=>{n.scrollX.set(h.current),n.scrollXProgress.set(h.progress),n.scrollY.set(m.current),n.scrollYProgress.set(m.progress)},{...s,container:e?.current||void 0,target:a?.current||void 0}),()=>{r.current?.()}),[e,a,JSON.stringify(s.offset)]);return Ye(()=>{if(l.current=!1,se(e)||se(a)){l.current=!0;return}else return o()},[o]),c.useEffect(()=>{if(l.current)return Ne(!se(e)),Ne(!se(a)),o()},[o]),n}function tt(e){const a=ve(()=>Z(e)),{isStatic:s}=c.useContext(Xe);if(s){const[,n]=c.useState(e);c.useEffect(()=>a.on("change",n),[])}return a}function st(e,a){const s=tt(a()),n=()=>s.set(a());return n(),Ye(()=>{const r=()=>U.preRender(n,!1,!0),l=e.map(o=>o.on("change",r));return()=>{l.forEach(o=>o()),ge(n)}}),s}function Is(e){ue.current=[],e();const a=st(ue.current,e);return ue.current=void 0,a}function Rs(e,a,s,n){if(typeof e=="function")return Is(e);const r=fs(a,s,n);return Array.isArray(e)?De(e,r):De([e],([l])=>r(l))}function De(e,a){const s=ve(()=>[]);return st(e,()=>{s.length=0;const n=e.length;for(let r=0;r<n;r++)s[r]=e[r].get();return a(s)})}function As(e,a={}){const{isStatic:s}=c.useContext(Xe),n=()=>Ve(e)?e.get():e;if(s)return Rs(n);const r=tt(n());return c.useInsertionEffect(()=>ps(r,e,a),[r,JSON.stringify(a)]),r}const Ds=({className:e})=>t.jsx("svg",{className:e,fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",clipRule:"evenodd"})}),Ws=({className:e})=>t.jsx("svg",{className:e,fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});async function Hs(e,a,s=""){if(a==null||a==="")return"";if(e==="home"){const m=await ye("home/tree");if(m!=null)try{return JSON.parse(m)}catch(d){console.error("Error parsing JSON data:",d)}}const n=e==="home"?"home_txt":s===""?`${e}_tree/${a}`:`${e}_txt/${a}`,r=ft(pt(xt,n)),l=await gt(r);if(!l.exists()||!l.exists())return null;const o=l.val(),i=[{text:"1.React",id:"react",key:"react",parent:"root"},{text:"2.CSS",id:"css",key:"css",parent:"root"},{text:"3.Android",id:"android",key:"android",parent:"root"},{text:"4.Java",id:"java",key:"java",parent:"root"},{text:"5.이미지",id:"image",key:"image",parent:"root"},{text:"6.Etc",id:"etc",key:"etc",parent:"root"}],h=[];e==="home"&&h.push(...i);for(const m in o){const d=o[m];d.id=m;const f={id:m,key:m,text:d.title,parent:e==="home"?d.gbn:d.parent};e==="memo"?(f.icon=d.bm==="Y"?t.jsx(Ds,{className:"w-4 h-4 text-red-500"}):d.icon==="Y"?t.jsx(Ws,{className:"w-4 h-4 text-green-500"}):null,f.droppable=!0):f.droppable=!1,!((s===""||s===void 0||s===null)&&(f.parent===void 0||f.parent===null||f.parent===""))&&(e==="home"||s===""||s===void 0||s===null?h.push(f):(d.id=m,(d.memo+"").toLowerCase().indexOf(s.toLowerCase())>-1&&(f.parent="root",f.droppable=!1,h.push(f))))}return h.sort((m,d)=>m.title>d.title?1:-1),e==="home"&&vt("home/tree",JSON.stringify(h)),h}const Ps=({isOpen:e,onClose:a,data:s})=>{const{t:n}=W();if(!e||!s)return null;const{label:r,value:l,items:o}=s;return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",onClick:a,children:t.jsxs("div",{className:"bg-white dark:bg-zinc-800 rounded-lg shadow-xl w-11/12 md:w-1/2 lg:w-1/3 max-h-[80vh] flex flex-col",onClick:i=>i.stopPropagation(),children:[t.jsxs("div",{className:"flex justify-between items-center border-b p-4 dark:border-zinc-600",children:[t.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:r}),t.jsx("button",{onClick:a,className:"text-gray-400 hover:bg-gray-200 dark:hover:bg-zinc-700 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center",children:t.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),t.jsxs("div",{className:"p-4 overflow-y-auto",children:[t.jsxs("p",{className:"text-base leading-relaxed text-gray-600 dark:text-gray-300 mb-4",children:[n("count","개수"),": ",t.jsx("span",{className:"font-bold",children:l.toLocaleString()})]}),t.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:n("main_list","주요 목록")}),t.jsx("ul",{className:"list-disc list-inside bg-gray-50 dark:bg-zinc-700 p-3 rounded-md",children:o&&o.length>0?o.map((i,h)=>t.jsx("li",{className:"text-gray-700 dark:text-gray-300",children:i.text},h)):t.jsx("li",{className:"text-gray-500",children:n("no_results","결과 없음")})})]})]})})};function Vs({series:e,labels:a,onDataPointClick:s}){const[n,r]=c.useState({labels:[],colors:le,dataLabels:{style:{colors:["#333"]}},responsive:[{breakpoint:480,options:{chart:{width:"100%"},legend:{position:"bottom"}}}]});return c.useEffect(()=>{r(l=>({...l,labels:a}))},[a]),t.jsx("div",{className:"bg-amber-50 dark:bg-gray-900 shadow-md rounded-sm",children:e&&e.length>0?t.jsx(ie,{type:"donut",series:e,options:n}):t.jsx("div",{className:"text-center text-gray-500",children:"표시할 데이터가 없습니다."})})}function Fs({series:e,labels:a,onDataPointClick:s}){const[n,r]=c.useState({chart:{type:"radar",toolbar:{show:!1},events:{dataPointSelection:(l,o,i)=>{s&&s(i.dataPointIndex)}}},colors:le,plotOptions:{radar:{polygons:{distributed:!0}}},dataLabels:{enabled:!1},xaxis:{categories:[]},legend:{show:!0},tooltip:{theme:"dark",style:{fontSize:"12px"},y:{formatter:l=>l.toLocaleString()}}});return c.useEffect(()=>{r(l=>({...l,xaxis:{...l.xaxis,categories:a}}))},[a]),t.jsx("div",{className:"bg-white dark:bg-black shadow-md rounded-sm w-full h-full",children:e&&e.length>0&&e[0].data.length>0?t.jsx(ie,{type:"radar",series:e,options:n}):t.jsx("div",{className:"text-center text-gray-500 py-10",children:"표시할 데이터가 없습니다."})})}function Ys({series:e,labels:a,onDataPointClick:s}){const[n,r]=c.useState({labels:[],chart:{events:{dataPointSelection:(l,o,i)=>{s&&s(i.dataPointIndex)}}},colors:le,plotOptions:{pie:{startAngle:-90,endAngle:90,offsetY:10}},grid:{padding:{bottom:-80}},dataLabels:{style:{colors:["#333"]}},responsive:[{breakpoint:480,options:{chart:{width:"100%"},legend:{position:"bottom"}}}],tooltip:{theme:"dark",style:{fontSize:"12px"},y:{formatter:l=>l.toLocaleString()}},legend:{show:!0}});return c.useEffect(()=>{r(l=>({...l,labels:a}))},[a]),t.jsx("div",{className:"bg-amber-50 dark:bg-gray-900 shadow-md rounded-sm p-2",children:e&&e.length>0&&t.jsx(ie,{type:"donut",series:e,options:n})})}function Xs({series:e,labels:a,showDownload:s=!0,onDataPointClick:n}){const[r,l]=c.useState({chart:{type:"bar",toolbar:{tools:{download:s}},events:{dataPointSelection:(o,i,h)=>{n&&n(h.dataPointIndex)}}},colors:le,plotOptions:{bar:{borderRadius:4,horizontal:!1,distributed:!0}},dataLabels:{enabled:!1},xaxis:{categories:[]},legend:{show:!1},tooltip:{theme:"dark",style:{fontSize:"12px"},y:{formatter:o=>o.toLocaleString()}}});return c.useEffect(()=>{l(o=>({...o,xaxis:{...o.xaxis,categories:a}}))},[a]),t.jsx("div",{className:"bg-white dark:bg-black shadow-md rounded-sm w-full p-2",children:e&&e.length>0&&e[0].data&&e[0].data.length>0?t.jsx(ie,{type:"bar",series:e,options:r,height:"350"}):t.jsx("div",{className:"text-center text-gray-500 py-10",children:"표시할 데이터가 없습니다."})})}const Gs=({rootDb:e})=>{const{user:a}=Y(),{t:s}=W(),n=Q(),r=_(y=>{try{return yt(e)(y)}catch(M){return console.warn("HomeChartForm selector error:",M),{labels:[],series:[],status:"idle",error:null}}}),[l,o]=c.useState(!0),[i,h]=c.useState("donut"),[m,d]=c.useState(!1),[f,p]=c.useState(null),[w,E]=c.useState([]),[$,C]=c.useState([]),[N,H]=c.useState({labels:[],series:[]}),S=["#6366f1","#3b82f6","#22c55e","#ef4444","#f97316","#eab308","#8b5cf6","#d946ef","#14b8a6","#a855f7"],O=[{value:"donut",label:s("donut_chart","도넛 차트")},{value:"bar",label:s("bar_chart","수평 막대 차트")},{value:"radar",label:s("radar_chart","레이더 차트")},{value:"verticalBar",label:s("vertical_bar_chart","수직 막대 차트")},{value:"semiDonut",label:s("semi_donut_chart","반원 도넛 차트")}],P=c.useCallback(y=>{let M=[];if(E(y||[]),y&&y.length>0){const V=y.filter(j=>j.parent==="root").sort((j,B)=>j.text.localeCompare(B.text)),F=(j,B)=>{const I=B.filter(z=>z.parent===j);let R=I.length;for(const z of I)R+=F(z.id,B);return R};M=V.map(j=>({node:j,count:F(j.id,y)})).filter(j=>j.count>=10);const te=M.map(j=>j.node.text),J=M.map(j=>j.count),X={labels:te,series:J};C(M),H(X),n(Ce({rootDb:e,data:X}))}else H({labels:[],series:[]}),n(Ce({rootDb:e,data:{labels:[],series:[]}}));o(!1)},[e,n]),u=c.useCallback(async()=>{o(!0);const y=await Hs(e==="sheet"?"memo":e,a?.uid);P(y)},[e,a?.uid,P]);c.useEffect(()=>{a?.uid&&(r?.labels&&Array.isArray(r.labels)&&r.labels.length>0?(H(r),o(!1)):u())},[e,a?.uid,r?.labels?.length,u]);const b=y=>{if(y<0||y>=$.length)return;const M=$[y].node,V=M.text,F=(j,B)=>{const I=B.filter(z=>z.parent===j);let R=[...I];return I.forEach(z=>{R=[...R,...F(z.id,B)]}),R},J=F(M.id,w).length,X=w.filter(j=>j.parent===M.id);p({label:V,value:J,items:X}),d(!0)},g=()=>t.jsx("div",{className:"w-full h-full flex justify-center items-center p-4",children:t.jsxs("div",{className:"w-full h-full bg-gray-200 dark:bg-zinc-800 rounded-md animate-pulse relative overflow-hidden",children:[t.jsx("div",{className:"absolute top-1/4 left-1/4 w-1/2 h-1/2 bg-gray-300 dark:bg-zinc-700 rounded-full opacity-50"}),t.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-1/3 h-1/3 bg-gray-300 dark:bg-zinc-700 rounded-lg opacity-50"})]})}),k=()=>{u()},L=t.jsxs("div",{className:`HomeChartForm ${x.between}`,children:[t.jsx("div",{children:s("count_stats")}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("select",{value:i,onChange:y=>h(y.target.value),className:"rounded-md border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-200 focus:ring-indigo-500 focus:border-indigo-500 text-sm","aria-label":s("select_chart_type","차트 종류 선택"),children:O.map(y=>t.jsx("option",{value:y.value,children:y.label},y.value))}),t.jsx("button",{onClick:k,className:"rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ","aria-label":s("reload_chart"),children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h5M20 20v-5h-5M4 4l1.5 1.5A9 9 0 0121.5 12M20 20l-1.5-1.5A9 9 0 012.5 12"})})})]})]});return t.jsxs("div",{className:`w-full justify-center ${x.card} `,children:[t.jsx("div",{className:"flex pl-6 py-4",children:t.jsx(bt,{title:L})}),l?t.jsx(g,{}):t.jsxs("div",{className:"w-full justify-center items-center",children:[i==="donut"&&t.jsx(Vs,{series:N.series,labels:N.labels,colors:S,onDataPointClick:b}),i==="bar"&&t.jsx(Ge,{series:[{name:s("count"),data:N.series}],labels:N.labels,colors:S,onDataPointClick:b}),i==="radar"&&t.jsx(Fs,{series:[{name:s("count"),data:N.series}],labels:N.labels,colors:S,onDataPointClick:b}),i==="verticalBar"&&t.jsx(Xs,{series:[{name:s("count"),data:N.series}],labels:N.labels,colors:S,onDataPointClick:b}),i==="semiDonut"&&t.jsx(Ys,{series:N.series,labels:N.labels,colors:S,onDataPointClick:b})]}),t.jsx(Ps,{isOpen:m,onClose:()=>d(!1),data:f})]})},Ks=()=>{const[e,a]=c.useState({labels:[],series:[]}),[s,n]=c.useState(null),[r,l]=c.useState({isOpen:!1}),{t:o}=W();return c.useEffect(()=>{(async()=>{const h=await ye("home_cnt");if(h){n(h);const d=Object.keys(h).sort().reverse().slice(0,10),f=d.map(w=>w.split("-").slice(1).join("-")),p=d.map(w=>Object.keys(h[w]).length);a({labels:f,series:p})}})()},[]),t.jsxs("div",{className:`w-full justify-center ${x.card} `,children:[t.jsx("div",{className:"flex pl-6 py-4",children:o("visitors.count")}),t.jsx(Ge,{series:[{name:o("count"),data:e.series}],labels:e.labels,showDownload:!1,onDataPointSelection:(i,h,m)=>{const d=m.dataPointIndex;if(s&&d>-1){const p=Object.keys(s).sort().reverse()[d],w=s[p],E=Object.keys(w).join("<br/>");console.log("filteredNodes=",E),l({isOpen:!0,title:`${p} ${o("visitors.count")}`,message:E,onClose:()=>l({isOpen:!1})})}}}),t.jsx(he,{...r})]})},Us=({item:e})=>{const{user:a}=Y(),s=ce();return t.jsx("div",{onClick:()=>s(`/m/${e.key}`),className:`${x.roundedXl} border border-gray-200 
      bg-white dark:border-gray-800 dark:bg-white/[0.03] 
      overflow-hidden cursor-pointer hover:shadow-md transition-shadow h-full flex flex-col`,children:t.jsx("div",{className:"px-4 py-3",children:t.jsx("h3",{className:"text-base font-medium text-gray-800 dark:text-white/90 truncate",children:e.title})})})};function Js(){const{user:e}=Y(),{t:a}=W(),s=Q(),{items:n,status:r}=_(i=>i.bookmark),l=r==="loading";c.useEffect(()=>{e&&s(wt(e.uid))},[e,s]);const o="grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4";return e===null?t.jsx(t.Fragment,{}):t.jsx(Ke,{title:a("main_list"),children:t.jsx("div",{className:"p-2",children:l?t.jsx(jt,{}):t.jsx("div",{className:`grid ${o} gap-3`,children:n?.map(i=>t.jsx(Us,{item:i},i.id))})})})}const qs=({rootDb:e})=>{const{user:a}=Y(),{t:s}=W(),n=s(e==="memo"?"appMemo":"home_mng"),r=t.jsx("div",{className:`displayTitle text-center  ${x.text3Xl} ${x.textIndigo}`,children:n});return t.jsx(t.Fragment,{children:t.jsx(Ke,{title:r,className:"MemoMain mt-3 mb-5",children:t.jsxs("div",{className:"grid gird-cols-1 md:grid-cols-5 items-center gap-3",children:[a===null?t.jsx("p",{className:`${x.textRed500} ${x.textLgFontSemiboldLeft} ${x.mdColSpan3}`,children:s("login_used")}):t.jsx("p",{className:`${x.textGray600DarkZinc400} text-left ${x.mdColSpan3}`,dangerouslySetInnerHTML:{__html:s("memo_main_guide").replace(`
`,"<br/>")}}),t.jsx("div",{className:`w-full ${x.flexCenter} md:col-span-2`,children:t.jsx(ss,{})})]})})})},We=e=>{const{t:a}=W(),s=async()=>{try{await kt.purge(),alert("Redux 상태가 초기화되었습니다.")}catch(n){console.error("Redux 상태 초기화 실패:",n),alert("상태 초기화 중 오류가 발생했습니다.")}};return t.jsxs("div",{className:"mx-auto grid w-full max-w-lg grid-cols-6 items-center justify-center gap-2 px-4 py-2 text-center",children:[e.master&&t.jsx(D,{size:"sm",variant:"outlined",color:"brand",onClick:e.onUtil,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l-.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),t.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("util")})]})}),t.jsx(D,{size:"sm",variant:"outlined",color:"brand",onClick:e.onEdit,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),t.jsx("path",{d:"m15 5 4 4"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("edit")})]})}),t.jsx(D,{size:"sm",variant:"outlined",color:"brand",onClick:e.onNewMemo,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M5 12h14"}),t.jsx("path",{d:"M12 5v14"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("new")})]})}),t.jsx(D,{size:"sm",variant:"outlined",color:"error",onClick:e.onDelete,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M3 6h18"}),t.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),t.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("delete")})]})}),e.onCopy&&t.jsx(D,{size:"sm",variant:"outlined",color:"secondary",onClick:e.onCopy,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:t.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("public")})]})}),e.master&&t.jsx(D,{size:"sm",variant:"outlined",color:"danger",onClick:s,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("polyline",{points:"23 4 23 10 17 10"}),t.jsx("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("reset")})]})})]})},Zs=Lt("memo/deleteMemo",async({rootDb:e,userId:a,memoId:s},{rejectWithValue:n})=>{try{const r=e==="memo"?`${e}_txt/${a}/${s}`:`${e}_txt/${s}`,l=e==="memo"?`${e}_tree/${a}/${s}`:`${e}/${s}`;return await Mt(r,l),{memoId:s}}catch(r){return console.error("삭제 중 오류 발생:",r),n(r.message)}});function Qs(e,a,s,n){const r=Q(),l=_(m=>Nt(m,s)),o=_(m=>Ct(m,s)),i=o==="loading";return c.useEffect(()=>{a?.uid&&s&&s!=="insert"&&o!=="succeeded"&&r(St({rootDb:e,userId:a.uid,memoId:s}))},[r,e,a?.uid,s,o]),{memoDetailData:l||{},isLoading:i,onBookmark:()=>{if(!l)return;const m=l.bookmark==="Y"?"N":"Y";r(Tt({rootDb:e,userId:a.uid,memoId:s,newBookmarkState:m})).unwrap().then(()=>{m==="Y"?(r({type:"bookmark/addBookmarkItem",payload:{...l,id:s,key:s,text:l.title}}),r(Se({id:s,bookmark:"Y"}))):(r({type:"bookmark/removeBookmarkItem",payload:s}),r(Se({id:s,bookmark:"N"})))})}}}const ea=({rootDb:e,searchWord:a})=>{const{user:s}=Y(),{memoId:n}=es(),r=Q(),l=_(v=>v?.tabs?.activeTab||null),{memoDetailData:o,isLoading:i,onBookmark:h}=Qs(e,s,n),[m,d]=c.useState(!1),{alertInfo:f,setAlertInfo:p,resetAlertInfo:w}=Et(),[E,$]=c.useState(!1),[C,N]=c.useState(""),[H,S]=c.useState(!1),[O,P]=c.useState(""),[u,b]=c.useState(!1),{t:g}=W(),{scrollYProgress:k}=Bs(),L=As(k,{stiffness:100,damping:30,restDelta:.001}),y=ce(),V=de()?.state?.fullIndex,F=_(v=>v.treeData.data),te=async()=>{if(!s||!n||e!=="memo"){p({isOpen:!0,title:g("error"),message:"Only private memos can be copied.",color:"error",onConfirm:w,onClose:w});return}try{await r(Wt({userId:s.uid,memoId:n,memoDetailData:o})).unwrap(),p({isOpen:!0,title:g("complete"),message:g("copy_completed"),color:"success",onConfirm:w,onClose:w})}catch(v){console.error("Copy failed:",v);const A=`${g("copy_failed")} ${v?`: ${v}`:""}`;p({isOpen:!0,title:g("error"),message:A,color:"error",onConfirm:w,onClose:w})}},J=()=>{r(At({rootDb:e,memoId:n,newMemoContent:C})).unwrap().then(()=>{$(!1)}).catch(v=>{console.error("메모 저장 중 오류 발생:",v)})},X=()=>{N(o?.memo||""),$(!0)},j=()=>{P(o?.title||""),S(!0)},B=v=>{P(v.target.value)},I=()=>{r(It({rootDb:e,userId:s.uid,memoId:n,newTitle:O})).unwrap().then(()=>{S(!1),r({type:"tabs/updateTabTitle",payload:{id:n,title:O}}),r({type:"bookmark/updateBookmarkTitle",payload:{id:n,title:O}}),r(Rt({id:n,newTitle:O}))}).catch(v=>{console.error("제목 업데이트 중 오류 발생:",v),S(!1)})},R=v=>{v.key==="Enter"?I():v.key==="Escape"&&S(!1)},z=()=>{const v=`/${e==="memo"?"m":e}/edit/${n}`;y(v,{state:{fullIndex:V}})},be=()=>{const v=`/${e==="memo"?"m":e}/util/${n}`;y(v,{state:{fullIndex:V}})},we=()=>{const v=`/${e==="memo"?"m":e}/insert/${n}`;y(v,{state:{fullIndex:V}})},je=()=>{d(!0)},ke=()=>{te()},at=async()=>{d(!1);try{r({type:"tabs/setDeleteId",payload:n}),r({type:"tabs/removeTab",payload:n}),y(`/${e==="memo"?"m":e}`),await r(Zs({rootDb:e,userId:s.uid,memoId:n})).unwrap(),e==="memo"&&await r(Dt({userId:s.uid,nodeId:n,currentTreeData:F})).unwrap()}catch(v){console.error("삭제 중 오류 발생:",v)}};return c.useEffect(()=>{function v(){const A=o.scrollY?o.scrollY:0;window.scrollTo({top:A})}o&&o.memo!==null&&(v(),o.image&&o.image.map((A,ca)=>A),$t({title:o.title,description:""}))},[o]),n===""||s===void 0?null:i||l!=n?t.jsx(fe,{}):o?t.jsxs("div",{className:"MemoDetail py-4 relative rounded-t-lg",children:[t.jsx(T.div,{className:`progress-bar sticky ${u?"top-28":"top-16"} z-10`,style:{scaleX:L}}),t.jsxs("div",{className:"MemoDetail_body overflow-hidden ",children:[t.jsxs("div",{className:`sticky top-0 z-20 ${x.card} backdrop-blur-sm`,children:[t.jsxs("div",{className:"p-3 sm:p-4",children:[t.jsxs("div",{className:x.between,children:[t.jsxs("p",{className:`${x.truncate} ${x.textXs} ${x.textGray500DarkZinc400}`,children:[t.jsx(Ee,{to:e==="memo"?"/m":"/home",className:"hover:!text-gray-900 dark:hover:!text-white",children:e==="memo"?"MEMO":"HOME"}),o?.path?.map((v,A)=>o.path.length===A+1?` > ${v?.title}`:t.jsxs(ee.Fragment,{children:[" "," > ",t.jsx(Ee,{to:e==="memo"?`/m/${v.id}`:`/home/${v.id}`,className:"hover:!text-gray-900 dark:hover:!text-white",children:v?.title})]},A))]}),t.jsx(T.button,{whileTap:{scale:.8},className:`${x.flexShrink0} ${x.roundedFull} p-2 ${x.buttonHoverGrayLight}`,"aria-label":g("bookmark"),onClick:h,children:o?.bookmark==="Y"?t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`${x.h5W5} ${x.textRed500}`,fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}):t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`${x.h5W5} ${x.textGray500}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})})]}),H?t.jsx("input",{type:"text",value:O,onChange:B,onKeyDown:R,onBlur:I,className:`w-full bg-transparent border-b-2 border-blue-500 focus:outline-none 
													${x.heading2XlBoldSm3Xl} ${x.textGray900}`,autoFocus:!0}):t.jsx("div",{onDoubleClick:j,className:`MemoDetail_Title text-left ${x.heading2XlBoldSm3Xl} ${x.textGray900} cursor-pointer`,children:o?.title}),t.jsx("button",{onClick:()=>b(!u),className:`${x.floatingActionButton} absolute top-11 sm:top-14 right-2 sm:right-3`,children:t.jsx(T.div,{animate:{rotate:u?135:0},children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})})]}),t.jsx(T.div,{initial:!1,animate:{height:u?"auto":0,opacity:u?1:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:t.jsx("div",{className:"border-t border-gray-200 bg-gray-50 dark:border-zinc-800 dark:bg-zinc-900/50",children:t.jsx(We,{master:s?.uid===pe,rootDb:e,onEdit:z,onUtil:be,onNewMemo:we,onDelete:je,onCopy:e==="memo"?ke:null})})})]}),o&&o.html==="sheet"&&t.jsx(zt,{rootDb:e,detailData:o}),t.jsxs("div",{className:`MemoDetail_Content ${o?.memo?.length>0?`${x.card} my-4 p-2 sm:p-4`:"p-1"}`,onDoubleClick:X,children:[E?t.jsxs("div",{className:`${x.card} p-4`,children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Le,{children:g("input")}),t.jsx("textarea",{className:"w-full min-h-[100px] p-2 border rounded dark:bg-gray-700 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500",value:C,rows:`${C.split(/\r\n|\r|\n/g).length}`,onChange:v=>N(v.target.value),autoFocus:!0})]}),t.jsxs("div",{children:[t.jsx(Le,{children:g("preview")}),t.jsx("div",{className:"prose dark:prose-invert max-w-none p-2 border rounded min-h-[100px] overflow-y-auto dark:bg-gray-700 dark:border-gray-600",children:t.jsx(Te,{postData:C,highlightWord:""})})]})]}),t.jsxs("div",{className:"mt-2 flex justify-end gap-2",children:[t.jsx(D,{variant:"outlined",color:x.button.indigo,size:"sm",onClick:()=>$(!1),children:g("cancel")}),t.jsx(D,{color:x.button.indigo,onClick:J,children:g("save")})]})]}):o&&o.html!=="sheet"?o?.html==="N"?t.jsx(Te,{postData:o?.memo,highlightWord:a}):o?.html!=="N"&&o?.memo&&t.jsx(_t,{text:o.memo}):"",t.jsx(Ot,{imageList:o?.image}),!o&&t.jsx("div",{className:"flex justify-center py-12",children:t.jsx("div",{className:`${x.flexCenter} py-12`})})]})]}),t.jsx(Bt,{rootDb:e,memoId:n,enableEdit:!0}),t.jsx(T.div,{initial:!1,animate:{height:u?"auto":0,opacity:u?1:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:t.jsx("div",{className:`${x.line}`,children:t.jsx(We,{master:s?.uid===pe,rootDb:e,onEdit:z,onUtil:be,onNewMemo:we,onDelete:je,onCopy:e==="memo"?ke:null})})}),t.jsx(he,{isOpen:m,size:"sm",color:"warning",title:g("delete_confirm_title"),message:g("delete_confirm_message"),onClose:()=>d(!1),onConfirm:at}),t.jsx(he,{...f})]}):t.jsx("div",{children:"데이터가 없습니다."})},ta=ee.lazy(()=>oe(()=>import("./MemoSheetGrid-A9MHwHnC.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),He=ee.lazy(()=>oe(()=>import("./MemoDetailEdit-LcN0rfoC.js"),__vite__mapDeps([7,1,2,3,4,5,6,8,9,10,11,12,13]))),sa=ee.lazy(()=>oe(()=>import("./MemoDetailUtil-DNsnGUHp.js"),__vite__mapDeps([14,1,2,3,4,5,6,10,8,11,12]))),aa=ee.lazy(()=>oe(()=>import("./App-D_yiCkAU.js").then(e=>e.c1),__vite__mapDeps([5,1,2,3,4,6]))),na=({rootDb:e,user:a,memoId:s,isLoading:n,onBookmark:r,handleCloseTab:l})=>{const o=de();return t.jsx(c.Suspense,{fallback:t.jsx(fe,{}),children:t.jsx(Ue,{children:t.jsxs(ts,{location:o,children:[t.jsx(G,{path:"todo",element:t.jsx(T.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(aa,{})})}),t.jsx(G,{path:"sheet/:sheetId?",element:t.jsx(T.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(ta,{})})}),t.jsx(G,{path:"edit/:memoId",element:t.jsx(T.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(He,{rootDb:e,isLoading:n})})}),t.jsx(G,{path:"insert/:memoId",element:t.jsx(T.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(He,{rootDb:e,isLoading:n})})}),t.jsx(G,{path:"util/:memoId",element:t.jsx(T.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(sa,{rootDb:e,isLoading:n})})}),t.jsx(G,{path:":memoId",element:t.jsx(T.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:n?t.jsx(fe,{}):t.jsx(ea,{rootDb:e,onBookmark:r,onDeleteTab:()=>{l&&l(null,{id:s})}})})})]},o.pathname)})})},ra=e=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...e,children:t.jsx("path",{fillRule:"evenodd",d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zM6 20V4h7v5h5v11H6zM8 12h3v3H8v-3zm0 4h3v3H8v-3zm4-4h3v3h-3v-3zm0 4h3v3h-3v-3z",clipRule:"evenodd"})}),oa=({tabInfo:e,handleCloseTab:a,isActive:s,onClickTab:n})=>{const{t:r}=W(),{user:l}=Y(),{attributes:o,listeners:i,setNodeRef:h,transform:m,transition:d,isDragging:f}=Ht({id:e.id}),p={transform:Pt.Transform?.toString(m),transition:d,zIndex:f?1:"auto"};return t.jsxs("div",{ref:h,style:p,...o,...i,"data-tab-id":e.id,onClick:n,title:e.title,className:`SortableTab group relative flex flex-shrink-0 items-center pl-3 pr-2 py-1.5 text-sm rounded-t-md transition-colors duration-200 min-w-28 max-w-48 border-b-2 cursor-pointer
				${s?"bg-gray-200 dark:bg-zinc-700 border-blue-500 text-gray-800 dark:text-gray-100":"border-transparent text-secondary hover:bg-gray-200/70 dark:hover:bg-zinc-700/70"}
				${f?"opacity-50 shadow-lg":""}`,children:[e.rootDb==="memo"?t.jsx(Vt,{className:`w-5 h-5 mr-1 flex-shrink-0 transition-transform duration-200 ${s?"scale-110":""}`,fill:"currentColor"}):e.rootDb==="sheet"?t.jsx(ra,{className:`w-5 h-5 mr-1 flex-shrink-0 transition-transform duration-200 ${s?"scale-110":""}`}):null,t.jsx("span",{className:"truncate pr-1",style:{fontFamily:"sans-serif"},children:e.title||r("loading")}),t.jsx("button",{onClick:w=>{w.preventDefault(),w.stopPropagation(),a(e.id)},className:`ml-auto flex-shrink-0 p-1 rounded-full transition-opacity duration-200 opacity-0 group-hover:opacity-100
					text-gray-500 dark:text-gray-400 
					hover:bg-gray-300/50 dark:hover:bg-gray-600/50 hover:text-gray-700 dark:hover:text-white
				`,children:t.jsx(Je,{className:"w-3 h-3"})})]})},la=c.memo(({rootDb:e,user:a})=>{const s=c.useRef(null),[n,r]=c.useState({left:!1,right:!1}),[l,o]=c.useState(!0),i=c.useRef(0),h=ce(),m=de(),d=m.pathname.split("/").pop(),f=Q(),p=_(u=>u?.tabs?.tabs||[]),w=_(u=>u?.tabs?.activeTab||null),E=_(u=>u?.tabs?.deleteId||null),$=c.useRef(null);c.useEffect(()=>{if((async()=>{if(E!==d&&d&&d!=="insert"&&m.pathname!=="/m"&&m.pathname!=="/home")if(p.some(g=>g.id===d))w!==d&&p.some(g=>g.id===d)&&$.current===null&&f(Me(d));else{let g="Loading...";try{let k;if(e==="sheet"?k=`memo_sheet/${a?.uid}/${d}/title`:e==="memo"?k=`${e}_txt/${a?.uid}/${d}/title`:e==="home"&&(k=`${e}_txt/${d}/title`),k){const L=await ye(k);L&&(g=L)}}catch(k){console.error("Error fetching tab title:",k)}f(Zt({id:d,path:m.pathname,rootDb:e,title:g}))}})(),$.current=null,E){const b=setTimeout(()=>{f(Ft())},500);return()=>clearTimeout(b)}},[d,m.pathname,e,w,a?.uid,E,p,f]);const C=c.useCallback(()=>{const u=s.current;if(u){const b=u.scrollWidth>u.clientWidth,g=u.scrollLeft===0,k=u.scrollLeft+u.clientWidth>=u.scrollWidth-1;r(L=>{const y={left:b&&!g,right:b&&!k};return L.left===y.left&&L.right===y.right?L:y})}},[]);c.useEffect(()=>{const u=()=>{const b=window.pageYOffset||document.documentElement.scrollTop;b>i.current?o(!1):o(!0),i.current=b<=0?0:b};return window.addEventListener("scroll",u),()=>{window.removeEventListener("scroll",u)}},[]);const N=u=>{s.current?.scrollBy({left:u==="left"?-200:200,behavior:"smooth"})},H=c.useCallback(u=>{const b=p.findIndex(g=>g.id===u);if(b!==-1&&(f(Yt(u)),f({type:"tabs/setDeleteId",payload:u}),w===u))if(p.length>1){const g=b>0?b-1:0,k=p[g===b?g+1:g];h(k.path)}else h(e==="memo"?"/m":"/home")},[p,w,f,h,e]),S=c.useCallback(u=>{const b=u.split("/").pop();$.current=b,f(Me(b)),requestAnimationFrame(()=>{h(u)})},[f,h]),O=c.useCallback(()=>{f(Xt())},[f]),P=c.useCallback(u=>{const{active:b,over:g}=u;if(g&&b.id!==g.id){const k=p.findIndex(y=>y.id===b.id),L=p.findIndex(y=>y.id===g.id);f(Gt(Kt(p,k,L)))}},[p,f]);return c.useEffect(()=>{C();const u=s.current;return u?.addEventListener("scroll",C),window.addEventListener("resize",C),()=>{u?.removeEventListener("scroll",C),window.removeEventListener("resize",C)}},[C,p.length]),t.jsx("div",{className:`MemoTabs sticky ${l?"top-18":"top-1"} z-1000 rounded-t-md bg-gray-50/70 dark:bg-zinc-800/70 backdrop-blur-sm shadow-sm`,children:t.jsxs("div",{className:"relative flex items-center justify-between ",children:[n.left&&t.jsx("button",{onClick:()=>N("left"),className:"absolute left-0 z-10 p-1 border border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 bg-white dark:bg-zinc-900 dark:hover:!text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full group",children:t.jsx(as,{className:"w-5 h-5 fill-current"})}),t.jsx(Ut,{id:"memo-tabs",onDragEnd:P,children:t.jsx("div",{ref:s,className:"MemoTabs relative flex items-center overflow-x-scroll scrollbar-hide whitespace-nowrap",children:t.jsx(Jt,{items:p.map(u=>u.id),strategy:qt,children:t.jsx(Ue,{children:p.map(u=>t.jsx(T.div,{layout:!0,initial:{opacity:0,scale:.8},transition:{type:"spring",stiffness:350,damping:30},animate:{opacity:1,scale:1},exit:{opacity:0,width:0,paddingLeft:0,paddingRight:0,transition:{duration:.3}},children:t.jsx(oa,{tabInfo:u,onClickTab:()=>S(u.path),handleCloseTab:H,isActive:u.id===w})},u.id))})})})}),t.jsxs("div",{className:"flex items-center",children:[n.right&&t.jsx("button",{onClick:()=>N("right"),className:"z-10 p-1 border border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 bg-white dark:bg-zinc-900 dark:hover:!text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full group",children:t.jsx(ns,{className:"w-5 h-5 fill-current"})}),p.length>0&&t.jsx("button",{onClick:O,className:"ml-2 mr-2 p-1.5 text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md",title:"Close all tabs",children:t.jsx(Je,{className:"w-4 h-4"})})]})]})})}),ia=()=>{ce();const{user:e}=Y(),a=_(Qt),s=de(),{rootDb:n,memoId:r}=c.useMemo(()=>{const l=s.pathname,o=l.startsWith("/m/sheet")?"sheet":l.startsWith("/m")?"memo":l.startsWith("/home")?"home":l.startsWith("/bible")?"bible":"default",i=l.split("/").pop()||"";return{rootDb:o,memoId:i}},[s.pathname]);return t.jsxs(t.Fragment,{children:[a&&t.jsx(la,{rootDb:n,user:e}),t.jsx(na,{rootDb:n,user:e,memoId:r}),s.pathname==="/m"&&t.jsx(qs,{rootDb:n}),(n==="memo"||n==="sheet")&&t.jsx(Js,{}),(s.pathname==="/m"||s.pathname==="/home")&&e?.uid===pe&&t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-5",children:[t.jsx(Ks,{}),t.jsx(Gs,{rootDb:n})]})]})},pa=Object.freeze(Object.defineProperty({__proto__:null,default:ia},Symbol.toStringTag,{value:"Module"}));export{pa as M,As as a,Qs as b,Bs as u};
