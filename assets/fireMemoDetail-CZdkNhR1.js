import{c4 as l,c5 as m,c6 as y,I as d,c7 as w,c8 as $,c9 as h,ca as v,cb as p,cc as F}from"./index-DJXDEmOP.js";function x(s){var n=s.length,a=s.lastIndexOf("."),t=s.substring(a+1,n).toLowerCase();return t}function R(s){var n=s.indexOf("."),a=s.substring(0,n);return a}const O=async(s,n,a)=>{const t={};t.ext=x(a),t.name=a,t.key=R(a);try{const r=`memo/${s}`,o=l(m,`${r}/${a}`),e=await y(o);t.url=e,d(`memo_txt/${s}/${n}/image/${t.key}`,t)}catch{}return t},L=async(s,n,a,t)=>{const r="memo/I3cTgdCxwjhBBno4mtZYvnODPJu1";let o=new Array;for(let e in a){const i=a[e];try{if(i.key=e,i.url===void 0||i.url===""){const u=l(m,`${r}/${e}.${i.ext}`),c=await y(u);i.url=c,d(`${s}/image/${e}/url`,c)}}catch{}o.push(i)}return o},P=async(s,n,a,t)=>{x(t.name);let r=l(m,`${s}/${t.name}`);try{const e=await $(r);r=l(m,`${s}/${a}${t.name}`)}catch(e){if(e.code!=="storage/object-not-found")throw console.error("setFileUpload: 파일 확인 중 오류:",e),e}return await h(r,t)},T=async(s,n,a,t)=>{const r={success:!0,key:a,message:"파일명이 성공적으로 변경되었습니다."};try{const o=l(m,s+n+"."+t);let e=l(m,s+a+"."+t);const i=await v(o);let u=0;for(;;)try{const g=await $(e);u++;const f=a+u;r.key=f,e=l(m,s+f+"."+t)}catch{break}await h(e,i),await w(o);const c=await y(e);return r.url=c,r}catch(o){return console.error("renameFile: 파일명 변경 중 오류:",o),{success:!1,message:"파일명 변경 실패"}}},U=async(s,n,a)=>{try{const t=l(m,`${s}/${a.key}.${a.ext}`);w(t).then(()=>{}).catch(r=>{})}catch{}},B=async(s="")=>{try{const n=l(m,s),a=await p(n),t=[];for(let r=0;r<a.items.length&&r<10;r++){const o=a.items[r];try{t.push(o._location.path_.replace("memo/I3cTgdCxwjhBBno4mtZYvnODPJu1/",""))}catch(e){console.error("파일 정보 조회 실패:",itemRef.name,e)}}return console.error("getStorageFileList10.fileList=",t),t}catch(n){return console.error("Storage 파일 목록 조회 실패:",n),{files:[],folders:[],success:!1,error:n.message}}},C=async(s="")=>{try{const n=l(m,s),a=await p(n),t=[];for(const o of a.items)try{const e=await $(o),i=await y(o);t.push({name:o.name,fullPath:o.fullPath,size:e.size,contentType:e.contentType,timeCreated:e.timeCreated,updated:e.updated,downloadURL:i})}catch(e){console.error("파일 정보 조회 실패:",o.name,e)}const r=a.prefixes.map(o=>({name:o.name,fullPath:o.fullPath,type:"folder"}));return{files:t,folders:r,success:!0}}catch(n){return console.error("Storage 파일 목록 조회 실패:",n),{files:[],folders:[],success:!1,error:n.message}}},D=async(s,n,a,t)=>{let r="",o="",e={};console.log("fireMemoDetail.memoId=",s,a),((c,g,f)=>{if(c==="sheet")return;o=c==="memo"?`${c}/${g}/${f}`:`${c}/${f}`,r=c==="memo"?`${c}_txt/${g}/${f}`:`${c}_txt/${f}`})(s,n,a);async function u(){if(r===void 0)return"";if(e=await F(r),e===void 0){e={code:"404",msg:"No data available"};return}if(e?.fullIndex,e.image!==void 0&&e.image!==null){const c=await L(r,o,e.image);e.image=c,(e.imageOK===void 0||e.imageOK==="N")&&(c&&c.map(g=>{g.ext==="jpg"&&(e.memo=e.memo+`<img src='${g.url}'>`)}),d(`${r}/imageOK`,"Y"),d(`${r}/memo`,e.memo))}if(e.html!=="N"&&t!==void 0&&t!==""){const c=new RegExp(t,"gi"),g=e.memo.replace(c,`<span class='lightext'>${t}</span>`);e.memo=g}}return await u(),e};export{P as a,R as b,O as c,T as d,C as e,D as f,x as g,B as h,U as s};
