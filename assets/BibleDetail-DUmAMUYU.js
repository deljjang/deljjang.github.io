import{j as t,k as C,r as x,h as H,i as P,c as G,u as Y,x as q,T as J,B as g,H as M}from"./index-C4z9J2Ef.js";import{F as U}from"./Favorite-BbAIilx7.js";import{u as V,B as W}from"./BibleBookmarkText-CzznoBmC.js";import{a as z,T as K}from"./LinkItem-DL7pXYMS.js";import{b as O}from"./bibleJson-DmvV-gyR.js";import{b as F}from"./bibleTxt-CDg_iih8.js";import{C as Q}from"./Container-DY130CHK.js";import{C as X}from"./CircularProgress-DCWyGW4B.js";import{G as m}from"./Grid-D_Th5BJz.js";import{B as D}from"./Button-xxZ7_Yo2.js";import{T as v}from"./Typography-DXs1x-fk.js";import"./createSvgIcon-rvHYLL0Q.js";import"./useControlled-BnGaZIwz.js";import"./ownerWindow-DvT1GKkC.js";import"./isMuiElement-BY2WwkrE.js";import"./useQuery-DG7oi9TD.js";import"./useBaseQuery-B9YwAEs5.js";import"./Divider-Bu7aYtBY.js";import"./dividerClasses-msxjNmdb.js";import"./styled-vX66gXit.js";import"./useTheme-CB43N2Tl.js";function y({children:e,type:o}){switch(o){case"rotate":return t.jsx(C.div,{initial:{scale:0},animate:{rotate:180,scale:1},transition:{type:"spring",stiffness:260,damping:20,duration:2},children:e});case"slide":case"scale":default:return t.jsx(C.div,{whileHover:{scale:1},whileTap:{scale:.9},children:e})}}y.defaultProps={type:"scale"};const Z=e=>{const o=new Array;if(e.data===void 0||e.data===null)return;const u=e.bibleId.split("_");for(let n=1;n<=e.data.cd3;n++){const c={nm:`${e.data.nm2}${n}장`,key:e.data.key};o.push(c)}return u&&u.length===3?t.jsxs(v,{variant:"h6",sx:{display:"flex",alignItems:"center",flexDirection:"column",mb:4},children:[e.nm," ",u[2]," 장"]}):t.jsxs(t.Fragment,{children:[t.jsx(v,{variant:"h6",sx:{display:"flex",alignItems:"center",flexDirection:"column",mb:4},children:e.nm}),t.jsx(m,{container:!0,spacing:2,columns:{xs:4,sm:6,md:10,lg:12},children:o.map((n,c)=>t.jsx(m,{item:!0,xs:1,md:1,children:t.jsx(z,{to:`/bible/${n.key}_${c+1}`,children:n.nm})},c))})]})},tt=e=>{const o=e.dataText;if(e.data===void 0||e.data===null||o==null)return;const u=e.bibleId.split("_");return e.bibleId&&u.length!==3?t.jsx(t.Fragment,{}):t.jsxs(t.Fragment,{children:[t.jsx(v,{variant:"h6",sx:{display:"flex",alignItems:"center",flexDirection:"column",mb:4},children:e.nm}),o.map((n,c)=>{let f="text.primary";e.cd4+""===n.cd4&&(f="warning.main");const i=e.bookmark?.data?.filter(s=>s.cd1===n.cd1&&s.cd2===n.cd2&&s.cd3===n.cd3&&s.cd4===n.cd4&&s.bookmark==="Y");return i&&i.length>0&&(n.bookmark="Y"),t.jsxs(m,{container:!0,spacing:2,columns:{xs:5,sm:6,md:10,lg:12},id:`id_${c+1}`,children:[t.jsx(m,{item:!0,xs:1,md:1,children:t.jsxs(g,{sx:{color:f,display:"flex"},children:[t.jsx(K,{sx:{alignItems:"center",textAlign:"top"},onClick:()=>e.onBookmark(n),children:n.nm}),i&&i.length>0&&t.jsx(U,{sx:{color:"red"}})]})}),t.jsx(m,{item:!0,xs:4,sm:5,md:9,lg:11,children:t.jsx(g,{sx:{color:f},children:t.jsx(M,{text:n.text})})})]},c)})]})},yt=()=>{const[e,o]=x.useState(null),[u,n]=x.useState(!0),{query:c,setBibleBookmark:f}=V(),i=x.useRef(),{bibleId:s}=H(),B=P(),[T,I]=x.useState(!1),[_,$]=x.useState(!1),{user:E}=G(),j=B?.state?.word,b=B?.state?.cd4,A=Y();x.useEffect(()=>{if(s!==void 0){(async()=>{const a=await L(s,j);o(a),n(!1)})(),I(!1),$(!0);const r=s.split("_");if(r.length===3){const a=i.current.cd3;I(Number(r[2])!==1),$(r[2]<a)}}},[s,j]),x.useEffect(()=>{b!==void 0&&setTimeout(()=>{N("","id_"+b)},1500)},[e,b]);const N=(l,r)=>{const a=document.getElementById(r);a&&a.scrollIntoView({block:"center",behavior:"smooth"})},S=l=>{E!==void 0&&f(l)},L=async(l,r)=>{if(l===""||l===void 0)return"";const a=l.split("_");if(a.length<1)return;i.current=O[a[0]][a[1]];const p=new Array;if(a.length===3){for(let h in F){if(!h.includes(l+"_"))continue;let d=F[h];d.id=h;let k=d.txt;if(r!==void 0){const R=new RegExp(r,"gi");k=k.replace(R,`<span class='lightext'>${r}</span>`)}d.nm=`${i.current.nm2}${a[2]}:${d.cd4}`,d.text=k,p.push(d)}return p.sort((h,d)=>h.cd4-d.cd4),p}};if(s==="")return t.jsx(t.Fragment,{});const w=l=>{let r=s.split("_");r[2]=Number(r[2])+l,A(`/bible/${r[0]}_${r[1]}_${r[2]}`)};return t.jsxs(q.Fragment,{children:[t.jsx("div",{id:"back-to-top-anchor"}),t.jsx(W,{}),t.jsx(J,{children:i.current!==null&&i.current!==void 0&&i.current.nm!==null?i.current.nm:""}),t.jsx(Z,{data:i.current,bibleId:s}),t.jsx(tt,{dataText:e,data:i.current,searchWord:j,bibleId:s,cd4:b,bookmark:c,onBookmark:S}),t.jsxs(Q,{sx:{p:0},children:[u&&t.jsx(g,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:t.jsx(X,{sx:{mt:5}})}),s&&s.split("_").length===3?t.jsx(g,{sx:{display:"flex",justifyContent:"space-between",mt:5},children:t.jsxs(m,{container:!0,spacing:1,children:[T?t.jsx(m,{item:!0,xs:_?6:12,children:t.jsx(y,{children:t.jsx(D,{type:"button",variant:"outlined",onClick:()=>w(-1),fullWidth:!0,children:"< 이전"})})}):"",_?t.jsx(m,{item:!0,xs:T?6:12,children:t.jsx(y,{children:t.jsx(D,{type:"button",variant:"outlined",onClick:()=>w(1),fullWidth:!0,children:"다음 >"})})}):""]})}):""]})]})};export{yt as BibleDetail,yt as default};
