import{r as f,z as S,A as R,c as G,u as H,j as t,L as P,T as Y,B as g,H as q}from"./index-Dt7VXYqf.js";import{F as z}from"./Favorite-CtOIUa-q.js";import{u as J,B as M}from"./BibleBookmarkText-BFn7QO_h.js";import{A as w}from"./AniButton-DWb6-Xm_.js";import{T as U}from"./LinkItem-DBZ7wTYg.js";import{T as V}from"./TwLinkItem-Dr2ZPTFJ.js";import{b as W}from"./bibleJson-BDv-vx3j.js";import{b as C}from"./bibleTxt-CDg_iih8.js";import{C as K}from"./Container-CqPrq-mM.js";import{C as O}from"./CircularProgress-R-5QKs_l.js";import{G as u}from"./Grid-CxfOxZJO.js";import{T as v}from"./Typography-oI_uAwM7.js";import"./createSvgIcon-D5vtuee9.js";import"./useControlled-o3FGf_TX.js";import"./ownerWindow-DvT1GKkC.js";import"./isMuiElement-C0hwO7KM.js";import"./useQuery-Br4dqMRy.js";import"./useBaseQuery-CpVwMbNe.js";import"./fireDatabase-CmU9MiSV.js";import"./Divider-DDEBS_qS.js";import"./dividerClasses-hl_ORNYY.js";import"./Button-BsNt_rqT.js";import"./styled-BO1vEgvD.js";import"./useTheme-miK55Se-.js";const Q=e=>{const l=new Array;if(e.data===void 0||e.data===null)return;const x=e.bibleId.split("_");for(let n=1;n<=e.data.cd3;n++){const c={nm:`${e.data.nm2}${n}장`,key:e.data.id+"_"+n};l.push(c)}return x&&x.length===3?t.jsxs(v,{variant:"h6",sx:{display:"flex",alignItems:"center",flexDirection:"column",mb:4},children:[e.nm," ",x[2]," 장"]}):t.jsxs(t.Fragment,{children:[t.jsx(v,{variant:"h6",sx:{display:"flex",alignItems:"center",flexDirection:"column",mb:4},children:e.nm}),t.jsx(u,{container:!0,spacing:2,columns:{xs:4,sm:6,md:10,lg:12},children:l.map((n,c)=>t.jsx(u,{item:!0,xs:1,md:1,children:t.jsx(V,{to:`/bible/${n.key}`,children:n.nm})},c))})]})},X=e=>{const l=e.dataText;if(e.data===void 0||e.data===null||l==null)return;const x=e.bibleId.split("_");return e.bibleId&&x.length!==3?t.jsx(t.Fragment,{}):t.jsxs(t.Fragment,{children:[t.jsx(v,{variant:"h6",sx:{display:"flex",alignItems:"center",flexDirection:"column",mb:4},children:e.nm}),l.map((n,c)=>{let b="text.primary";e.cd4+""===n.cd4&&(b="warning.main");const i=e.bookmark?.data?.filter(r=>r.cd1===n.cd1&&r.cd2===n.cd2&&r.cd3===n.cd3&&r.cd4===n.cd4&&r.bookmark==="Y");return i&&i.length>0&&(n.bookmark="Y"),t.jsxs(u,{container:!0,spacing:2,columns:{xs:5,sm:6,md:10,lg:12},id:`id_${c+1}`,children:[t.jsx(u,{item:!0,xs:1,md:1,children:t.jsxs(g,{sx:{color:b,display:"flex"},children:[t.jsx(U,{sx:{alignItems:"center",textAlign:"top"},onClick:()=>e.onBookmark(n),children:n.nm}),i&&i.length>0&&t.jsx(z,{sx:{color:"red"}})]})}),t.jsx(u,{item:!0,xs:4,sm:5,md:9,lg:11,children:t.jsx(g,{sx:{color:b},children:t.jsx(q,{text:n.text})})})]},c)})]})},yt=()=>{const[e,l]=f.useState(null),[x,n]=f.useState(!0),{query:c,setBibleBookmark:b}=J(),i=f.useRef(),{bibleId:r}=S(),B=R(),[y,T]=f.useState(!1),[I,_]=f.useState(!1),{user:F}=G(),j=B?.state?.word,h=B?.state?.cd4,A=H();f.useEffect(()=>{if(r!==void 0){(async()=>{const o=await L(r,j);l(o),n(!1)})(),T(!1),_(!0);const s=r.split("_");if(i.current&&s.length===3){const o=i.current.cd3;T(Number(s[2])!==1),_(s[2]<o)}}},[r,j]),f.useEffect(()=>{h!==void 0&&setTimeout(()=>{D("","id_"+h)},1500)},[e,h]);const D=(a,s)=>{const o=document.getElementById(s);o&&o.scrollIntoView({block:"center",behavior:"smooth"})},E=a=>{F!==void 0&&b(a)},L=async(a,s)=>{if(a===""||a===void 0)return"";const o=a.split("_");if(o.length<1)return;o.length>1&&W.map(m=>{m.id===o[0]+"_"+o[1]&&(i.current=m)});const p=new Array;if(o.length===3){for(let m in C){if(!m.includes(a+"_"))continue;let d=C[m];d.id=m;let k=d.txt;if(s!==void 0){const N=new RegExp(s,"gi");k=k.replace(N,`<span class='lightext'>${s}</span>`)}d.nm=`${i.current.nm2}${o[2]}:${d.cd4}`,d.text=k,p.push(d)}return p.sort((m,d)=>m.cd4-d.cd4),p}};if(r==="")return t.jsx(t.Fragment,{});const $=a=>{let s=r.split("_");s[2]=Number(s[2])+a,A(`/bible/${s[0]}_${s[1]}_${s[2]}`)};return t.jsxs(P.Fragment,{children:[t.jsx("div",{id:"back-to-top-anchor"}),t.jsx(M,{}),t.jsx(Y,{children:i.current!==null&&i.current!==void 0&&i.current.nm!==null?i.current.text:""}),t.jsx(Q,{data:i.current,bibleId:r}),t.jsx(X,{dataText:e,data:i.current,searchWord:j,bibleId:r,cd4:h,bookmark:c,onBookmark:E}),t.jsxs(K,{sx:{p:0},children:[x&&t.jsx(g,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:t.jsx(O,{sx:{mt:5}})}),r&&r.split("_").length===3?t.jsx(g,{sx:{display:"flex",justifyContent:"space-between",mt:5},children:t.jsxs(u,{container:!0,spacing:1,children:[y?t.jsx(u,{item:!0,xs:I?6:12,children:t.jsx(w,{type:"button",variant:"outlined",onClick:()=>$(-1),fullWidth:!0,children:"< 이전"})}):"",I?t.jsx(u,{item:!0,xs:y?6:12,children:t.jsx(w,{type:"button",variant:"outlined",onClick:()=>$(1),fullWidth:!0,children:"다음 >"})}):""]})}):""]})]})};export{yt as BibleDetail,yt as default};
