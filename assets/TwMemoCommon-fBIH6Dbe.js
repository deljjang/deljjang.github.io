const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-6LGfH82g.js","assets/index-Bse8XJw1.js","assets/index-By5zFqvY.css","assets/createSvgIcon-D_MJLEx7.js","assets/useControlled-DiwIA-82.js","assets/ownerWindow-DvT1GKkC.js","assets/isMuiElement-Dj_zBdqh.js","assets/fireDatabase-6aiysaR4.js","assets/fireStorage-DDE40fK-.js","assets/SinyDate-R0Laqfo2.js","assets/Grid-DAThskgT.js","assets/useTheme-CSU-3HLE.js","assets/index-BUEZ8Kgu.js","assets/index-Chjiymov.js","assets/Menu-nL5avtPe.js","assets/useSlotProps-v2C01vEh.js","assets/resolveComponentProps-DM8GC4wS.js","assets/utils-DmsROQlF.js","assets/IconButton-BNmOT1Tj.js","assets/TextField-k_7AM5n-.js","assets/InputAdornment-d_J6iu4p.js","assets/Popper-C7dkNnjT.js","assets/Button-Dasu853v.js","assets/Chip-wSlPSg7N.js","assets/index.esm-VU_QWZZw.js","assets/TwButton-BoCC_HrI.js","assets/Loading-dl17W_U7.js","assets/Container-ItCYytj1.js","assets/styled-DvhlsTD4.js","assets/CircularProgress-C9CnYnFd.js","assets/Divider-djqUIpVg.js","assets/dividerClasses-DNtBPneo.js","assets/index-Cmdt2tIm.css","assets/TwMemoMain-Dczg78ZY.js","assets/IpInfo-BAQc45lY.js"])))=>i.map(i=>d[i]);
import{r as c,j as e,l as ke,b1 as We,u as z,c as V,T as qe,q as be,e as Oe,o as ze,a as we,f as ye,g as Ce,i as ue,k as se,v as Ne,H as Je,n as $e,t as Se,_ as Te,h as Ve,L as X,w as Ge,x as Ke,R as Qe,y as J}from"./index-Bse8XJw1.js";import{u as Ze}from"./useSuspenseQuery-C1vfb9R7.js";import{L as B}from"./Loading-dl17W_U7.js";import{T as Xe}from"./Footer-Bxwbe5a4.js";import{T as et,u as ge,a as he,F as tt,b as st,D as Le,l as ot,I as nt,s as ee,d as te,e as De}from"./index-6LGfH82g.js";import{g as Re,s as E}from"./fireDatabase-6aiysaR4.js";import{D as Ie,g as Ee,S as Fe,T as Pe,H as xe}from"./HtmlCode-6mhaeZVV.js";import{E as rt,C as at}from"./ExpandMore-DDmZR7Xu.js";import{F as Be}from"./Favorite-Be-769lb.js";import{S as lt}from"./SinyImageList-CIjBE0dt.js";import{c as it}from"./CodeText-mQxE1nhx.js";import{s as fe}from"./commonUtil-Edv4ygmI.js";import{T as R}from"./TwButton-BoCC_HrI.js";import{C as ct}from"./CircularProgress-C9CnYnFd.js";import{D as dt}from"./datetime-BDx6lZXm.js";import{u as _e}from"./index.esm-VU_QWZZw.js";import{T as I}from"./TwBadge-BvVq4sAS.js";import"./SinyDate-R0Laqfo2.js";import{T as q}from"./TwInput-CAYModWX.js";import{T as Me}from"./TwSelect-xXqu2Gat.js";import{T as Ue}from"./TwDatePicker-DPw8T-n0.js";import{d as O,e as Ae,f as mt,h as ut}from"./fireStorage-DDE40fK-.js";import{f as gt}from"./fireMemoDetail-CoMuMqaF.js";import{S as ht}from"./check-circle-Lfyy2btR.js";import"./useBaseQuery-CD-7AdO7.js";import"./Container-ItCYytj1.js";import"./styled-DvhlsTD4.js";import"./Divider-djqUIpVg.js";import"./dividerClasses-DNtBPneo.js";import"./Link-DHKcVhX4.js";import"./createSvgIcon-D_MJLEx7.js";import"./useControlled-DiwIA-82.js";import"./ownerWindow-DvT1GKkC.js";import"./isMuiElement-Dj_zBdqh.js";import"./IconButton-BNmOT1Tj.js";import"./copy-Dg5XxE3s.js";import"./toPropertyKey-DCwh5dYN.js";import"./index-Chjiymov.js";import"./ImageListItem-jjRCMLrW.js";import"./Grid-DAThskgT.js";import"./useTheme-CSU-3HLE.js";import"./index-BUEZ8Kgu.js";import"./Menu-nL5avtPe.js";import"./useSlotProps-v2C01vEh.js";import"./resolveComponentProps-DM8GC4wS.js";import"./utils-DmsROQlF.js";import"./TextField-k_7AM5n-.js";import"./InputAdornment-d_J6iu4p.js";import"./Popper-C7dkNnjT.js";import"./Button-Dasu853v.js";import"./Chip-wSlPSg7N.js";const xt=o=>c.createElement("svg",{viewBox:"0 0 24 24",width:"1em",height:"1em",...o},c.createElement("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z",fill:"currentColor"})),ft=o=>c.createElement("svg",{viewBox:"0 0 24 24",fill:"none",width:"1em",height:"1em",xmlns:"http://www.w3.org/2000/svg",...o},c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z",fill:"currentColor"})),pt=o=>e.jsx(ke.div,{whileHover:{scale:1.05},whileTap:{scale:.9},children:e.jsx(We,{to:o.to,className:"text-inherit no-underline cursor-pointer",...o,children:e.jsx(et,{children:o.children})})});function vt({initTreeData:o}){const[s,i]=c.useState(),t=j=>i(j),f=z();if(c.useEffect(()=>{i(o)},[o]),s==null||s.length===0)return e.jsx(B,{});const b=j=>{console.log("node",j),f(`/m/${j.id}`)};return e.jsx(Ie,{backend:Fe,options:Ee(),children:e.jsx(Pe,{tree:s,rootId:"root",onDrop:t,render:(j,{depth:h,isOpen:l,onToggle:g})=>e.jsxs("div",{className:"w-60 flex items-center justify-between hover:bg-gray-300 dark:hover:bg-gray-700 rounded-sm ",style:{paddingLeft:h*20+(j.cnt===0?5:0)},children:[e.jsxs("div",{className:"flex items-center",children:[j.cnt>0&&e.jsx("div",{onClick:g,children:l?e.jsx(rt,{}):e.jsx(at,{})}),e.jsx("div",{className:"cursor-pointer",onClick:()=>b(j),children:j.text})]}),j.cnt>0&&e.jsxs("div",{className:"text-gray-500 text-sm",children:["(",j.cnt,")"]})]})})})}function jt(o){const{user:s}=V(),i=z(),[t,f]=c.useState(),[b,j]=c.useState(),h=async l=>{const g=[],d=be(we(ye,`memo_tree/${l}`),ze("bm"),Oe("Y")),p=await Ce(d);if(!p.exists()){console.log("getFireData.null");return}const C=p.val();for(let $ in C){const v=C[$];v.id=$,v.key=$,v.text=v.title,g.push(v)}g.sort(($,v)=>$.title>v.title?1:-1),f([...g])};return c.useEffect(()=>{s!==void 0&&s!=null&&h(s?.uid)},[s]),c.useEffect(()=>{const l=async(g,d)=>{const p=[...d];if(d)for(const C of d){let $=C;for(;$.parent!=="root";){$.parent,$=await Re(`memo_tree/${g}/${$.parent}`);const v={id:$.key,text:$.title,droppable:!1,parent:$.parent};p.filter(w=>w.id===v.id).length===0&&p.push(v)}}for(const C of p){const $=C.id;C.cnt=p.filter(v=>v.parent===$).length}j(p)};t&&t.length>0&&l(s?.uid,t)},[t]),s===void 0?e.jsx(e.Fragment,{}):e.jsxs("div",{className:"tail-bookmark justify-items-center flex items-center flex-col w-full",children:[e.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),e.jsx(qe,{children:"BookMark"}),e.jsx("div",{className:`tail-bookmark 
        grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-1 
        justify-items-center 
        w-full`,children:t&&t.map((l,g)=>e.jsx("div",{children:e.jsx("button",{className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 cursor-pointer",onClick:()=>{o.onSelected(l.key),i(`/m/${l.key}`)},children:e.jsx("span",{className:"text-base",children:l.title})})},g))}),e.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),e.jsx(c.Suspense,{fallback:e.jsx(B,{}),children:e.jsx(vt,{initTreeData:b,uid:s?.uid})})]})}const kt=o=>e.jsxs("div",{className:"flex-grow my-4 w-full grid grid-cols-3 gap-1 items-center content-center justify-center text-center whitespace-nowrap",style:{gridTemplateColumns:`70px 70px 70px ${o.master?"70px":""}`},children:[o.master&&e.jsx(R,{size:"sm",variant:"outlined",color:"success",onClick:o.onUtil,children:"유틸"}),e.jsx(R,{size:"sm",variant:"outlined",color:"success",onClick:o.onEdit,children:"수정"}),e.jsx(R,{size:"sm",variant:"outlined",color:"warning",onClick:o.onNewMemo,children:"새글"}),e.jsx(R,{size:"sm",variant:"outlined",color:"error",onClick:o.onDelete,children:"삭제"})]}),bt=o=>{const{rootDb:s,isLoading:i,memoDetailData:t,onBookmark:f,onTreeUpdate:b,searchWord:j}=o,{scrollYProgress:h}=ge(),l=he(h,{stiffness:100,damping:30,restDelta:.001}),g=z(),{memoId:d}=ue(),C=se()?.state?.fullIndex,{user:$}=V(),v=()=>{const u=`/${s==="memo"?"m":s}/edit/${d}`;g(u,{state:{fullIndex:C}})},m=()=>{const u=`/${s==="memo"?"m":s}/util/${d}`;g(u,{state:{fullIndex:C}})},w=()=>{const u=`/${s==="memo"?"m":s}/insert/${d}`;g(u,{state:{fullIndex:C}})},a=async()=>{const u=s==="memo"?`${s}_txt/${$.uid}/${d}`:`${s}_txt/${d}`,y=s==="memo"?`${s}_tree/${$.uid}/${d}`:`${s}/${d}`;await st(u,y)!==void 0&&(b(),g(`/${s==="memo"?"m":s}`))},k=()=>{window.confirm(`하위 자료가 있는 경우 같이 삭제됩니다.
삭제하시겠습니까?`)&&a()};return c.useEffect(()=>{t&&t.title!==void 0&&fe({title:t.title,description:t.title});function u(){window.scrollTo({top:0}),t&&t.html!=="N"&&document.querySelectorAll("pre").forEach(y=>{y.innerHTML=it(y.innerHTML)})}t&&t.memo!==null&&(u(),t.image&&t.image.map((y,T)=>(console.log("image."+T+"=",y.key),y)))},[t]),i?e.jsx(B,{}):d===""||$===void 0?e.jsx(e.Fragment,{}):e.jsxs("div",{children:[e.jsx(ke.div,{className:"progress-bar",style:{scaleX:l}}),e.jsxs("div",{className:`grid grid-cols-3 
				items-center w-full 
				dark:bg-stone-950 rounded-md shadow-sm 
				dark:shadow-stone-800 shadow-stone-900`,children:[e.jsx("div",{}),e.jsx("div",{className:"flex justify-center",children:t&&t.title}),e.jsxs("div",{className:"text-right justify-end mr-3.5",children:[e.jsx("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors","aria-label":"bookmark",onClick:f,children:t&&t.bookmark==="Y"?e.jsx(Be,{className:"text-red-500"}):e.jsx(tt,{className:"text-gray-600 dark:text-gray-400"})}),e.jsx("div",{className:"text-right mb-3 text-sm text-red-400",children:t?.path&&t?.path.map((u,y)=>y===0?u?.text:` > ${u?.text}`)})]})]}),e.jsxs("div",{className:"w-full p-0 m-0",children:[e.jsx(kt,{master:$?.uid===Ne,rootDb:s,onEdit:v,onUtil:m,onNewMemo:w,onDelete:k,bookmark:t&&t.bookmark}),e.jsxs("div",{className:"my-4",children:[t&&t.html==="N"?e.jsx(xe,{postData:t&&t.memo,highlightWord:j}):t&&t.html!=="N"&&t.memo&&e.jsx(Je,{text:t.memo}),e.jsx(lt,{imageList:t&&t.image}),!t&&e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("div",{className:"mt-12",children:e.jsx(ct,{})})})]})]})]})},Ye=({onSubmit:o,onCancel:s,isSubmitting:i,newMode:t=!1})=>e.jsxs("div",{className:"flex justify-end mb-1.5 gap-1",children:[e.jsxs(R,{variant:"outlined",color:"success",disabled:i,onClick:f=>{f.preventDefault(),o(f)},children:[t?"새글":""," 저장"]}),e.jsx(R,{variant:"outlined",color:"error",onClick:f=>{f.preventDefault(),s()},children:"취소"})]}),ve=({label:o,checked:s,id:i,onChange:t,className:f="",disabled:b=!1})=>e.jsxs("label",{className:`flex items-center space-x-3 group cursor-pointer ${b?"cursor-not-allowed opacity-60":""}`,children:[e.jsxs("div",{className:"relative w-5 h-5",children:[e.jsx("input",{id:i,type:"checkbox",className:`w-5 h-5 appearance-none cursor-pointer dark:border-gray-700 border border-gray-300 checked:border-transparent rounded-md checked:bg-brand-500 disabled:opacity-60 
          ${f}`,checked:s,onChange:j=>t(j.target.checked),disabled:b}),s&&e.jsx("svg",{className:"absolute transform -translate-x-1/2 -translate-y-1/2 pointer-events-none top-1/2 left-1/2",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",children:e.jsx("path",{d:"M11.6666 3.5L5.24992 9.91667L2.33325 7",stroke:"white",strokeWidth:"1.94437",strokeLinecap:"round",strokeLinejoin:"round"})}),b&&e.jsx("svg",{className:"absolute transform -translate-x-1/2 -translate-y-1/2 pointer-events-none top-1/2 left-1/2",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",children:e.jsx("path",{d:"M11.6666 3.5L5.24992 9.91667L2.33325 7",stroke:"#E4E7EC",strokeWidth:"2.33333",strokeLinecap:"round",strokeLinejoin:"round"})})]}),o&&e.jsx("span",{className:"text-sm font-medium text-gray-800 dark:text-gray-200",children:o})]}),He=c.forwardRef((o,s)=>{const{placeholder:i="Enter your message",rows:t=3,value:f="",onChange:b,className:j="",disabled:h=!1,error:l=!1,hint:g=""}=o,d=C=>{b&&b(C.target.value)};let p=`w-full rounded-lg border px-4 text-sm shadow-theme-xs focus:outline-hidden ${j} `;return h?p+=" bg-gray-100 opacity-50 text-gray-500 border-gray-300 cursor-not-allowed opacity40 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-700":l?p+=" bg-transparent  border-gray-300 focus:border-error-300 focus:ring-3 focus:ring-error-500/10 dark:border-gray-700 dark:bg-zinc-950 dark:text-white/90 dark:focus:border-error-800":p+=" bg-transparent text-gray-900 dark:text-gray-300 text-gray-900 border-gray-300 focus:border-brand-300 focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-zinc-950 dark:text-white/90 dark:focus:border-brand-800",e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{ref:s,placeholder:i,rows:t,value:f,onChange:d,disabled:h,className:p}),g&&e.jsx("p",{className:`mt-2 text-sm ${l?"text-error-500":"text-gray-500 dark:text-gray-400"}`,children:g})]})}),wt=c.lazy(()=>Te(()=>import("./index-6LGfH82g.js").then(o=>o.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32])));ot.Quill.register("modules/imageDrop",nt);Se.configure({languages:["javascript","ruby","python","java","cpp","kotlin","sql"]});const yt={syntax:{highlight:o=>Se.highlightAuto(o).value},toolbar:[[{header:"1"},{header:"2"},{header:"3"},{font:[]}],[{size:[]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","image","video"],["clean"],["code-block"]],imageDrop:!0,clipboard:{matchVisual:!1}},Ct=["header","font","size","bold","italic","underline","strike","blockquote","list","bullet","indent","link","image","video","clean","code-block","code-custom"],Nt=o=>{const[s,i]=c.useState(o.imageList),[t,f]=c.useState(o.htmlCheck==="Y"),[b,j]=c.useState(o.iconCheck==="Y"),[h,l]=c.useState(o.newMode?"":o.content),[g,d]=c.useState(),p=c.useRef(),C=c.useRef(),$=c.useRef(null);c.useRef(null);const v=c.useRef(null),m=o.newMode,w=c.useRef([]),{height:a}=$e(),k=dt.now().setZone("Asia/Seoul").toFormat("yyyy-MM-dd"),u={edTitle:m?"":o.title,edGbn:o.gbn?o.gbn:"etc",edDate:m?k:o.date,content:m?"":o.content,memoTxt:m?"":o.content,htmlCheck:o.htmlCheck,iconCheck:o.iconCheck},{register:y,handleSubmit:T,trigger:F,control:D,setValue:P,getValues:Y,watch:oe,formState:{errors:pe,isSubmitting:ne}}=_e({mode:"onChange",defaultValues:u});c.useEffect(()=>{y("edDate"),y("edGbn",{required:!0}),y("htmlCheck"),y("iconCheck"),y("memoTxt")},[]),c.useEffect(()=>{w.current=[],p.current=o.content,C.current=!1},[o.content]);const G=async r=>{m?await o.onNewSubmit(r,w.current):await o.onPostSubmit(r,s,w.current)},re=()=>{T(G)()},ae=r=>{console.log("onDelete.imageList=",r),i(r)},le=r=>{console.log("onInsert.file",r);let N=p.current;r.ext==="jpg"||r.ext==="png"?(N+=`<img src='${r.url}'/>`,x(`<img src='${r.url}'/>
`)):r.ext==="mp4"?(N+=`<video preload="auto" controls="" src='${r.url}'></video>`,x(`<video preload="auto" controls="" src='${r.url}'></video>`)):(N+=`<a src='${r.url}'>${r.name}}</a>`,x(`다운로드
<a href="${r.url}" target="_blank">${r.name}</a>
`)),p.current=N},_=r=>o.onRename(r,Y("edTitle")),A=r=>{p.current=r},ie=r=>{console.log("handleFileUpload",r),w.current=r};function ce(r){p.current=r,P("content",r),F("content")}const K=(r,N)=>{console.log(`onChecked.e.${r}=`,N),P(r,N?"Y":"N"),console.log(`onChecked.v.${r}=`,Y(r)),r==="htmlCheck"?f(N):j(N)},de=oe("content"),me=[{value:"none",label:"None"},{value:"react",label:"React"},{value:"css",label:"CSS"},{value:"android",label:"Android"},{value:"java",label:"JAVA"},{value:"image",label:"그림 / 사진"},{value:"etc",label:"기타"},{value:"mui",label:"MUI"}],n=["React","JavaScript","Bash","Html","CSS","SQL","Java","Kotlin","C++","C#","Command","Script","Python","Ruby","Go","Swift","Rust"],x=r=>{const N=$.current;if(N){const W=N.selectionStart,U=N.selectionEnd,H=h.slice(0,W),Q=h.slice(U);l(H+r+Q),P("memoTxt",H+r+Q),setTimeout(()=>{N.selectionStart=N.selectionEnd=W+r.length,N.focus()},0)}},S=r=>{x(r)},L=r=>r?/\.(jpg|jpeg|png|gif|bmp|webp|svg)/i.test(r)||r.includes("image")||r.includes("img"):!1,M=r=>new Promise((N,W)=>{const U=new Image;U.crossOrigin="anonymous",U.onload=()=>{const H=document.createElement("canvas"),Q=H.getContext("2d");H.width=U.width,H.height=U.height,Q.drawImage(U,0,0);try{const Z=H.toDataURL("image/png");console.log("convertImageToBase64.base64=",Z.substring(0,30)+"..."),N(Z)}catch(Z){W(Z)}},U.onerror=()=>{W(new Error("Failed to load image"))},U.src=r});return e.jsx("div",{className:"my-2 mb-[50px], w-full",children:e.jsxs("form",{onSubmit:T(G),style:{width:"100%",minHeight:"300px",maxHeight:{height:a},display:"flex",flexDirection:"column"},children:[e.jsxs("div",{className:"flex justify-end mb-1.5 gap-1",children:[e.jsx(ve,{id:"htmlCheck",checked:t,onChange:r=>K("htmlCheck",r),label:"HTML사용"}),e.jsx(ve,{id:"iconCheck",checked:b,onChange:r=>K("iconCheck",r),label:"Icon"}),e.jsx(Ye,{onSubmit:r=>re(),onCancel:o.onCancel,isSubmitting:ne,newMode:m})]}),e.jsx(Le,{control:D,onDelete:ae,onInsert:le,onRename:_,setContent:A,onFileUpload:ie,imageList:o.imageList}),e.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[e.jsx("div",{className:"w-full",children:e.jsx(q,{name:"edTitle",placeholder:"제목",control:D,rules:{required:"해당 필드는 필수입니다.",minLength:{value:2,message:"2글자 이상 입력해주세요."}},onChange:r=>{r.preventDefault(),P("edTitle",r.target.value)}})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Me,{name:"edGbn",label:"구분",control:D,rules:{required:!0},placeholder:"-- 구분 --",options:me,className:"",allClassName:"max-w-40",onChange:r=>{r.preventDefault();const N=r.target.value;console.log("edGbn=",Y("edGbn")),P("edGbn",N)}}),e.jsx(Ue,{id:"edDate",name:"edDate",placeholder:"Select a date",control:D,onChange:(r,N)=>{console.log({dates:r,currentDateString:N}),P("edDate",N)}})]}),e.jsx("div",{className:"flex gap-2"})]}),e.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600 my-4"}),e.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[e.jsx("div",{className:"max-h-100 overflow-y-scroll",children:e.jsx(xe,{postData:h})}),e.jsxs("div",{children:[e.jsx(He,{ref:$,className:"",value:h,onChange:r=>{P("memoTxt",r),l(r)},rows:20}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 xsm:grid-cols-5 sm:grid-cols-7 md:grid-cols-7 lg:grid-cols-8",children:[e.jsx(I,{className:"cursor-pointer",variant:"light",color:"success",onClick:()=>S(`<box>
</box>`),children:"<Box>"}),e.jsx(I,{className:"cursor-pointer",variant:"light",color:"success",onClick:()=>S('<a href="/data/memo/" target="_blank"></a>'),children:"Link"}),e.jsx(I,{className:"cursor-pointer",variant:"light",color:"success",onClick:()=>S('<img src="/data/memo/"></img>'),children:"img"}),e.jsx(I,{className:"cursor-pointer",variant:"light",color:"success",onClick:()=>S('<video preload="auto" controls="" src="/memo/" style="width: 100%; height: 100%;"></video>'),children:"Video"}),e.jsx(I,{className:"cursor-pointer",variant:"light",color:"success",onClick:()=>S('<hr style="width=100%"/>'),children:"line"}),n.map((r,N)=>e.jsx(I,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>S("<code>"+r+`
</code>`),children:r},N))]})]}),Y("edUrl")&&L(Y("edUrl"))&&e.jsx("div",{className:"mt-2 p-2 border border-gray-300 dark:border-gray-600 rounded",children:e.jsx("img",{src:g,alt:"Preview",className:"max-w-full h-auto max-h-48 object-contain",onLoad:async r=>{try{const N=await M(g);P("edUrl2",N)}catch(N){console.error("Base64 conversion failed:",N)}},onError:r=>{r.target.style.display="none"}})})]}),t&&e.jsx(c.Suspense,{fallback:e.jsx("div",{children:"Loading editor..."}),children:e.jsx(wt,{ref:v,fullWidth:!0,theme:"snow",id:"content",name:"content",type:"div",value:de,style:{minWidth:"400px",border:"1px solid primary.main",minHeight:"200px",height:"400px",maxHeight:"450px"},modules:yt,formats:Ct,onChange:ce})}),e.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600 my-4"})]})})},je=o=>{const{rootDb:s,isLoading:i,memoDetailData:t}=o,{scrollYProgress:f}=ge();he(f,{stiffness:100,damping:30,restDelta:.001});const b=z(),j=c.useRef(),h=c.useRef();h.current=o.searchWord;const{memoId:l}=ue(),g=se(),{user:d}=V();j.current=g.pathname.split("/")[2]==="insert",console.log("memoDetailData=",t);const p=()=>{const a=`/${s==="memo"?"m":s}/${l==="insert"?"":l}`;b(a)},C=async a=>{await O(d.uid,l,a)},$=async a=>{if(console.log("onFilePathList.fileNm=",a),a.length>0)for(let k=0;k<a.length;k++){const u=a[k];console.log("onFilePathList.file=",u);try{const y=await O(d.uid,l,u);console.log("onFilePathList.path=",y)}catch{console.log("onFilePathList.error=",u)}}else await O(d.uid,l,a)},v=async(a,k)=>{console.log("onNewSubmit.values",a);const u=await ee({rootDb:s,uid:d.uid,newData:j.current,key:l==="insert"?"root":l,values:a});if(await te(`${s}_txt`,s,u,k),u!==void 0){const y=`/${s==="memo"?"m":s}/${u}`;b(y,{state:{reflash:!0}})}},m=async(a,k)=>{const u=s==="memo"?`${s}/${d.uid}/`:`${s}/`,y=await Ae(u,a.key,k,a.ext);if(y.success){const T=s==="memo"?`${s}_txt/${d.uid}/${l}/image/`:`${s}_txt/${l}/image/`;return E(T+a.key,null),a.key=y.key,a.url=y.url,a.name=y.key+"."+a.ext,E(T+y.key,a),console.log("onRename.file",a),a}},w=async(a,k,u)=>{const y=s==="memo"?`${s}_txt/${d.uid}/`:`${s}_txt/`;s==="memo"?`${s}${d.uid}`:`${s}`,await De(y,s==="memo"?`${s}/${d.uid}/`:`${s}/`,l,k),console.log("onPostSubmit.values",a);const T=await ee({rootDb:s,uid:d.uid,newData:j.current,key:l==="insert"?"root":l,values:a});console.log("onPostSubmit.newKey=",T),console.log("onPostSubmit.files=",u);const F=await te(`${y}`,s==="memo"?`${s}/${d.uid}/`:`${s}/`,l,u);console.log("onNewSubmit.imageResult",F),s==="memo"&&E(`memo_tree/${d.uid}/${l}/title`,a.edTitle),j.current=!1;const D=`/${s==="memo"?"m":s}/${l}`;s==="home"&&E("home/tree",null),b(D,{state:{reflash:!0}})};return c.useEffect(()=>{t&&t.title!==void 0&&fe({title:t.title,description:t.title});function a(){document.querySelectorAll("pre").forEach((k,u)=>{})}t&&t.memo!==null&&a()},[t]),l===""||d===void 0?e.jsx(e.Fragment,{}):(console.log("isLoading=",i),t===void 0||i?e.jsx(B,{}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"w-full p-0 m-0",children:j.current===!1&&t&&(t.title===void 0||t.title===""||t.title===null)?e.jsx(B,{}):e.jsx(Nt,{newMode:j.current,onPostSubmit:w,onNewSubmit:v,onCancel:p,onRename:m,onFilePath:C,onFilePathList:$,title:t?.title,gbn:t?.gbn,date:t?.date,htmlCheck:t?.html?t?.html==="Y"?"Y":"N":"Y",iconCheck:!t?.icon==="Y"?"Y":"N",content:t?.memo,imageList:t?.image})})}))};function $t({initTreeData:o,userId:s,memoId:i,onClick:t}){const[f,b]=c.useState(o),{isMoble:j,height:h,width:l}=Ve(),g=c.useRef(),d=c.useRef(),p=(v,m)=>{if(m.dragSource.id!==void 0&&m.dropTargetId!==void 0){const w=`memo_tree/${s}/${m.dragSource.id}/parent`;E(w,m.dropTargetId)}b(v)};c.useEffect(()=>{(()=>{for(const m of o){const w=m.id;m.cnt=o.filter(a=>a.parent===w).length}b(o)})()},[o]);const C=(v,m)=>{const w=[],a=k=>{const u=m.find(y=>y.id===k);if(!u)return!1;if(u.parent&&u.parent!=="root"){if(a(u.parent))return w.push(u.parent),!0}else return!0;return!1};return a(v)?w.reverse():[]},$=v=>{if(!f||!v||!d.current)return;const m=C(v,f);m.length>0&&setTimeout(()=>{d.current.open(m)},500)};return c.useEffect(()=>{g.current===void 0&&i!==void 0&&(g.current=i,$(i))},[f]),f==null||f===""?e.jsx(B,{}):e.jsx(Ie,{backend:Fe,options:Ee(),children:e.jsx("div",{className:"overflow-y-auto",style:{height:h-220-(j?56:0)+(l>1024?60:0),width:"100%"},children:e.jsx(Pe,{ref:d,tree:f,rootId:"root",onDrop:p,render:(v,{depth:m,isOpen:w,onToggle:a,isDragging:k,isDropTarget:u})=>e.jsxs("div",{className:`w-62 flex items-center rounded-sm
              text-gray-500 dark:text-gray-400 cursor-pointer select-none min-h-8 py-1 ml-1 ${k?"opacity-50":""} ${u?"bg-blue-200 dark:bg-blue-800":"hover:bg-gray-300 dark:hover:bg-gray-700"} 
              ${g.current===v.id?"bg-gray-200 dark:bg-gray-800 rounded-r-lg border-l-4 border-blue-500":""}
              `,style:{paddingLeft:m*20+(v.cnt===0?5:0)-(g.current===v.id?4:0)},children:[e.jsx("div",{className:"min-w-0",children:v.cnt>0&&e.jsx("div",{className:"hover:bg-white dark:hover:bg-gray-950 rounded-full",onClick:a,children:w?e.jsx(xt,{className:"size-6"}):e.jsx(ft,{className:"size-6"})})}),e.jsxs("div",{className:"flex items-center flex-1 min-w-0 justify-between",onClick:()=>{g.current=v.id,t(v)},children:[e.jsxs("div",{className:"flex truncate pr-2",children:[v.icon,v.text]}),v.cnt>0&&e.jsxs("div",{className:"text-gray-500 text-sm",children:["(",v.cnt,")"]})]})]})})})})}const St=o=>{const s=c.useRef(null);function i(){o.onSearchDataBtn(s.current.value)}function t(){return o.onNewMemoBtn(),!1}function f(b){b.which===13&&i()}return e.jsxs(e.Fragment,{children:[e.jsx(q,{id:"edSearch",type:"edSearch",name:"edSearch",inputRef:s,placeholder:"Enter Search...",fullWidth:!0,sx:{pt:0,pl:2,pr:2,pb:1},onKeyDownCapture:f}),e.jsxs("div",{className:"flex justify-center",children:[e.jsx(R,{variant:"outlined",color:"success",className:"m-1 p-1",onClick:t,children:"새글"}),e.jsx(R,{variant:"outlined",color:"brand",className:"m-1 p-1",onClick:i,children:"조회"})]})]})};async function Tt(o,s,i=""){if(s==null||s==="")return"";if(o==="home"){const g=await Re("home/tree");if(g!=null)try{return JSON.parse(g)}catch(d){console.error("Error parsing JSON data:",d)}}const t=o==="home"?"home_txt":i===""?`${o}_tree/${s}`:`${o}_txt/${s}`,f=be(we(ye,t)),b=await Ce(f);if(!b.exists())return console.log("getTreeData.null"),null;if(!b.exists())return console.log("getTreeData.exists"),null;const j=b.val(),h=[{text:"1.React",id:"react",key:"react",parent:"root"},{text:"2.CSS",id:"css",key:"css",parent:"root"},{text:"3.Android",id:"android",key:"android",parent:"root"},{text:"4.Java",id:"java",key:"java",parent:"root"},{text:"5.이미지",id:"image",key:"image",parent:"root"},{text:"6.Etc",id:"etc",key:"etc",parent:"root"}],l=[];o==="home"&&l.push(...h);for(const g in j){const d=j[g];d.id=g;const p={id:g,key:g,text:d.title,parent:o==="home"?d.gbn:d.parent};o==="memo"?(p.icon=d.bm==="Y"?e.jsx(Be,{className:"text-red-500"}):d.icon==="Y"?e.jsx(ht,{}):null,p.droppable=!0):p.droppable=!1,!((i===""||i===void 0||i===null)&&(p.parent===void 0||p.parent===null||p.parent===""))&&(o==="home"||i===""||i===void 0||i===null?l.push(p):(d.id=g,(d.memo+"").toLowerCase().indexOf(i.toLowerCase())>-1&&(p.parent="root",p.droppable=!1,l.push(p))))}return l.sort((g,d)=>g.title>d.title?1:-1),o==="home"&&E("home/tree",JSON.stringify(l)),l}const Lt=o=>{const[s,i]=c.useState(o.imageList),[t,f]=c.useState(o.content),[b,j]=c.useState(),h=c.useRef(),l=c.useRef(),g=c.useRef(null),d=c.useRef([]),{height:p}=$e(),C={edTitle:o.title,edGbn:o.gbn?o.gbn:"etc",edDate:o.date,content:o.content,memoTxt:o.content,htmlCheck:"N",iconCheck:"N"},{register:$,handleSubmit:v,trigger:m,control:w,setValue:a,getValues:k,watch:u,formState:{errors:y,isSubmitting:T}}=_e({mode:"onChange",defaultValues:C});c.useEffect(()=>{$("edDate"),$("memoTxt")},[]),c.useEffect(()=>{d.current=[],h.current=o.content,l.current=!1},[o.content]);const F=async n=>{await o.onPostSubmit(n,s,d.current)},D=()=>{v(F)()},P=n=>{console.log("onDelete.imageList=",n),i(n)},Y=n=>{console.log("onInsert.file",n);let x=h.current;n.ext==="jpg"||n.ext==="png"?(x+=`<img src='${n.url}'/>`,_(`<img src='${n.url}'/>
`)):n.ext==="mp4"?(x+=`<video preload="auto" controls="" src='${n.url}'></video>`,_(`<video preload="auto" controls="" src='${n.url}'></video>`)):(x+=`<a src='${n.url}'>${n.name}}</a>`,_(`다운로드
<a href="${n.url}" target="_blank">${n.name}</a>
`)),h.current=x},oe=n=>o.onRename(n,k("edTitle")),pe=n=>{h.current=n},ne=n=>{console.log("handleFileUpload",n),d.current=n};function G(n){_(`<img src='${n}'/>`)}function re(){console.log("HtmlEditor.imageList=",s);let n="";s&&s.length>0&&s.map((x,S)=>{n+=`<img src="/data/memo/${x.key}.${x.ext}" style="width: 50px;"/>
`}),n!==""&&_(n)}const ae=[{value:"none",label:"None"},{value:"react",label:"React"},{value:"css",label:"CSS"},{value:"android",label:"Android"},{value:"java",label:"JAVA"},{value:"image",label:"그림 / 사진"},{value:"etc",label:"기타"},{value:"mui",label:"MUI"}],le=["React","JavaScript","Bash","Html","CSS","SQL","Java","Kotlin","C++","C#","Command","Script","Python","Ruby","Go","Swift","Rust"],_=n=>{const x=g.current;if(x){const S=x.selectionStart,L=x.selectionEnd,M=t.slice(0,S),r=t.slice(L);f(M+n+r),a("memoTxt",M+n+r),setTimeout(()=>{x.selectionStart=x.selectionEnd=S+n.length,x.focus()},100)}},A=n=>{_(n)},ie=n=>n?/\.(jpg|jpeg|png|gif|bmp|webp|svg)/i.test(n)||n.includes("image")||n.includes("img"):!1,ce=async()=>{const n=await mt("memo/I3cTgdCxwjhBBno4mtZYvnODPJu1");console.log("onAllFile.result=",n)},K=async()=>{const n=await ut("memo/I3cTgdCxwjhBBno4mtZYvnODPJu1");console.log("onAllFile10.result=",n);let x="";n.map(S=>{x+=S+`
`}),_(x)},de=async()=>{const n=k("edFilePath");if(n===""){const x=[];let S=g.current.value;S=S.replace(/<img src="\/data\/memo\//g,""),S=S.replace(/ style="width: 50px;"/g,""),S=S.replace(/"\/>/g,""),S=S.replace(/ /g,""),S.split(`
`).forEach(async L=>{L.indexOf(".")>0&&(x.push(L),console.log(L))}),x.length>0&&(console.log(x),await o.onFilePathList(x))}else await o.onFilePath(n)},me=n=>new Promise((x,S)=>{const L=new Image;L.crossOrigin="anonymous",L.onload=()=>{const M=document.createElement("canvas"),r=M.getContext("2d");M.width=L.width,M.height=L.height,r.drawImage(L,0,0);try{const N=M.toDataURL("image/png");console.log("convertImageToBase64.base64=",N.substring(0,30)+"..."),x(N)}catch(N){S(N)}},L.onerror=()=>{S(new Error("Failed to load image"))},L.src=n});return e.jsx("div",{className:"my-2 mb-[50px], w-full",children:e.jsxs("form",{onSubmit:v(F),style:{width:"100%",minHeight:"300px",maxHeight:{height:p},display:"flex",flexDirection:"column"},children:[e.jsx(Ye,{onSubmit:n=>D(),onCancel:o.onCancel,isSubmitting:T}),e.jsx(Le,{control:w,onDelete:P,onInsert:Y,onRename:oe,setContent:pe,onFileUpload:ne,imageList:o.imageList}),e.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[e.jsx("div",{className:"w-full",children:e.jsx(q,{name:"edTitle",placeholder:"제목",control:w,rules:{required:"해당 필드는 필수입니다.",minLength:{value:2,message:"2글자 이상 입력해주세요."}},onChange:n=>{n.preventDefault(),a("edTitle",n.target.value)}})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Me,{name:"edGbn",label:"구분",control:w,rules:{required:!0},placeholder:"-- 구분 --",options:ae,className:"",allClassName:"max-w-40",onChange:n=>{n.preventDefault();const x=n.target.value;console.log("edGbn=",k("edGbn")),a("edGbn",x)}}),e.jsx(Ue,{id:"edDate",name:"edDate",placeholder:"Select a date",control:w,onChange:(n,x)=>{console.log({dates:n,currentDateString:x}),a("edDate",x)}})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{name:"edUrl",placeholder:"Base64로 만들 URL",control:w,allClassName:"w-full",onChange:n=>{n.preventDefault();const x=n.target.value;console.log("edUrl=",x),a("edUrl",x),j(x)}}),e.jsx(R,{variant:"outlined",color:"success",onClick:n=>{n.preventDefault(),G(k("edUrl2"))},children:"적용"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{name:"edUrl2",placeholder:"Base64 이미지 데이터",allClassName:"w-full",variant:"filled",size:"small",value:k("edUrl2")||""}),e.jsx(R,{variant:"outlined",color:"success",onClick:n=>{n.preventDefault(),re()},children:"첨부추가"})]}),e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx(q,{name:"edFilePath",placeholder:"이미지리스트에 추가할 파일명",allClassName:"w-full",control:w,onChange:n=>{n.preventDefault();const x=n.target.value;a("edFilePath",x)}}),e.jsx(R,{variant:"outlined",color:"success",onClick:n=>{n.preventDefault(),de()},children:"파일경로"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{variant:"outlined",color:"success",onClick:n=>{n.preventDefault(),ce()},children:"전체파일"}),e.jsx(R,{variant:"outlined",color:"success",onClick:n=>{n.preventDefault(),K()},children:"전체파일10"})]})]}),e.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600 my-4"}),e.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[e.jsx("div",{children:e.jsx("div",{className:"max-h-100 overflow-y-scroll",children:e.jsx(xe,{postData:t})})}),e.jsxs("div",{children:[e.jsx(He,{ref:g,className:"",value:t,onChange:n=>{a("memoTxt",n),f(n)},rows:20}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 xsm:grid-cols-5 sm:grid-cols-7 md:grid-cols-7 lg:grid-cols-8",children:[e.jsx(I,{className:"cursor-pointer",variant:"light",color:"success",onClick:()=>A(`<box>
</box>`),children:"<Box>"}),e.jsx(I,{className:"cursor-pointer",variant:"light",color:"success",onClick:()=>A('<a href="/data/memo/" target="_blank"></a>'),children:"Link"}),e.jsx(I,{className:"cursor-pointer",variant:"light",color:"success",onClick:()=>A('<img src="/data/memo/"></img>'),children:"img"}),e.jsx(I,{className:"cursor-pointer",variant:"light",color:"success",onClick:()=>A('<video preload="auto" controls="" src="/memo/" style="width: 100%; height: 100%;"></video>'),children:"Video"}),e.jsx(I,{className:"cursor-pointer",variant:"light",color:"success",onClick:()=>A('<hr style="width=100%"/>'),children:"line"}),le.map((n,x)=>e.jsx(I,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>A("<code>"+n+`
</code>`),children:n},x))]})]}),k("edUrl")&&ie(k("edUrl"))&&e.jsx("div",{className:"mt-2 p-2 border border-gray-300 dark:border-gray-600 rounded",children:e.jsx("img",{src:b,alt:"Preview",className:"max-w-full h-auto max-h-48 object-contain",onLoad:async n=>{try{const x=await me(b);a("edUrl2",x)}catch(x){console.error("Base64 conversion failed:",x)}},onError:n=>{n.target.style.display="none"}})})]}),e.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600 my-4"})]})})},Dt=o=>{const{rootDb:s,isLoading:i,memoDetailData:t}=o,{scrollYProgress:f}=ge();he(f,{stiffness:100,damping:30,restDelta:.001});const b=z(),j=c.useRef();j.current=o.searchWord;const{memoId:h}=ue();se();const{user:l}=V();console.log("memoDetailData=",t);const g=()=>{const m=`/${s==="memo"?"m":s}/${h==="insert"?"":h}`;b(m)},d=async m=>{await O(l.uid,h,m)},p=async m=>{if(console.log("onFilePathList.fileNm=",m),m.length>0)for(let w=0;w<m.length;w++){const a=m[w];console.log("onFilePathList.file=",a);try{const k=await O(l.uid,h,a);console.log("onFilePathList.path=",k)}catch{console.log("onFilePathList.error=",a)}}else await O(l.uid,h,m)},C=async(m,w)=>{console.log("onNewSubmit.values",m);const a=await ee({rootDb:s,uid:l.uid,newData:!1,key:h,values:m});if(await te(`${s}_txt`,s,a,w),a!==void 0){const k=`/${s==="memo"?"m":s}/${a}`;b(k,{state:{reflash:!0}})}},$=async(m,w)=>{const a=s==="memo"?`${s}/${l.uid}/`:`${s}/`,k=await Ae(a,m.key,w,m.ext);if(k.success){const u=s==="memo"?`${s}_txt/${l.uid}/${h}/image/`:`${s}_txt/${h}/image/`;return E(u+m.key,null),m.key=k.key,m.url=k.url,m.name=k.key+"."+m.ext,E(u+k.key,m),console.log("onRename.file",m),m}},v=async(m,w,a)=>{const k=s==="memo"?`${s}_txt/${l.uid}/`:`${s}_txt/`;s==="memo"?`${s}${l.uid}`:`${s}`,await De(k,s==="memo"?`${s}/${l.uid}/`:`${s}/`,h,w),console.log("onPostSubmit.values",m);const u=await ee({rootDb:s,uid:l.uid,newData:!1,key:h==="insert"?"root":h,values:m});console.log("onPostSubmit.newKey=",u),console.log("onPostSubmit.files=",a);const y=await te(`${k}`,s==="memo"?`${s}/${l.uid}/`:`${s}/`,h,a);console.log("onNewSubmit.imageResult",y),s==="memo"&&E(`memo_tree/${l.uid}/${h}/title`,m.edTitle);const T=`/${s==="memo"?"m":s}/${h}`;s==="home"&&E("home/tree",null),b(T,{state:{reflash:!0}})};return c.useEffect(()=>{t&&t.title!==void 0&&fe({title:t.title,description:t.title});function m(){document.querySelectorAll("pre").forEach((w,a)=>{})}t&&t.memo!==null&&m()},[t]),h===""||l===void 0?e.jsx(e.Fragment,{}):(console.log("isLoading=",i),t===void 0||i?e.jsx(B,{}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"w-full p-0 m-0",children:t&&(t.title===void 0||t.title===""||t.title===null)?e.jsx(B,{}):e.jsx(Lt,{onPostSubmit:v,onNewSubmit:C,onCancel:g,onRename:$,onFilePath:d,onFilePathList:p,title:t?.title,gbn:t?.gbn,date:t?.date,htmlCheck:t?.html?t?.html==="Y"?"Y":"N":"Y",iconCheck:!t?.icon==="Y"?"Y":"N",content:t?.memo,imageList:t?.image})})}))},Rt=c.lazy(async()=>await Te(()=>import("./TwMemoMain-Dczg78ZY.js"),__vite__mapDeps([33,1,2,25,34]))),Ds=({rootDb:o})=>{const s=z(),{user:i}=V(),t=c.useRef(),f=c.useRef(!0),b=c.useRef(),j=c.useRef(),[h,l]=c.useState(),g=c.useRef(!1),d=se(),p=c.useRef(!1);p.current=d?.state?.reflash===!0;const C=Ze({queryKey:["twTreeData",i?.uid,t.current],queryFn:()=>Tt(o,i?.uid,t.current)});C.data!==void 0&&C.data!==""&&!g.current&&(g.current=!0);const $=()=>{const u=h;u&&(u.bookmark=u.bookmark==="Y"?"N":"Y");const y=`memo_tree/${i.uid}/${j.current}/bm`;E(y,h.bookmark),l({...h,bookmark:u.bookmark})};c.useEffect(()=>{i!==void 0&&i!=null&&C.refetch()},[i]),c.useEffect(()=>{const u=async F=>{if(F!==""&&i){const D=await gt(o,i?.uid,F,t.current);o==="memo"&&(D.path=It(C.data,F)),D.code==="404"&&(D.title="No title"),f.current=!1,l(D===void 0?{}:D)}},y=d.pathname.split("/"),T=y.length>2?y[y.length-1]:"";f.current=!0,u(T),j.current=T},[d.pathname,i,p.current]),c.useEffect(()=>{console.log("useEffect.reflash=",p.current),i!==void 0&&i!=null&&C.refetch()},[p.current]);const v=u=>{g.current=!1,u!==void 0&&(t.current=u),C.refetch()},m=u=>{u.id!==j.current&&(f.current=!0,s(`/${o==="memo"?"m":o}/${u.id}`))},w=()=>{if(i==null){alert("로그인 후 이용 가능합니다.");return}const u=`/${o==="memo"?"m":o}/insert/insert`;s(u)},a=u=>{},k=e.jsxs("div",{className:"w-[270px]",children:[e.jsx("div",{className:"mt-3",children:e.jsx(pt,{to:"/m",children:o==="memo"?"메모장":"홈페이지관리"})}),e.jsxs("div",{className:"flex gap-7 justify-center",children:[o==="memo"?"":e.jsx(X,{to:"/m",children:"메모"}),o==="memo"&&i?.uid==="I3cTgdCxwjhBBno4mtZYvnODPJu1"?e.jsx(X,{to:"/home",children:"홈관리"}):null,e.jsx(X,{to:"/todo",children:"TODO"}),e.jsx(X,{to:"/tw",children:"Sheet"})]}),e.jsx(St,{onNewMemoBtn:w,onSearchDataBtn:v}),g.current&&C.isFetched?e.jsx($t,{expandIndex:b.current,initTreeData:C.data,userId:i?.uid,memoId:j.current,onClick:m}):i===void 0?e.jsx(e.Fragment,{}):e.jsx(B,{})]});return i&&i.uid===Ne&&Ge,e.jsxs(Ke,{sideType:"memo",title:o==="memo"?"메모장":"홈페이지관리",sideContents:k,children:[e.jsx(c.Suspense,{fallback:e.jsx(B,{}),children:e.jsxs(Qe,{children:[e.jsx(J,{path:"/edit/:memoId",element:e.jsx(je,{rootDb:o,isLoading:f.current,searchWord:t.current,memoDetailData:h})}),e.jsx(J,{path:"/insert/:memoId",element:e.jsx(je,{rootDb:o,isLoading:f.current,searchWord:t.current,memoDetailData:h})}),e.jsx(J,{path:"/util/:memoId",element:e.jsx(Dt,{rootDb:o,isLoading:f.current,searchWord:t.current,memoDetailData:h})}),e.jsx(J,{path:"/:memoId",element:e.jsx(bt,{rootDb:o,isLoading:f.current,searchWord:t.current,memoDetailData:h,onTreeUpdate:v,onBookmark:$,data:C.data})}),e.jsx(J,{path:"*",element:e.jsx(Rt,{searchWord:t.current,data:C.data,onNewMemoBtn:w,title:o==="memo"?"메모장 홈":"홈페이지관리 홈"})})]})}),o==="memo"?e.jsx(jt,{onSelected:a}):"",e.jsx(Xe,{})]})},It=(o,s)=>{let i=[],t=s;if(!o)return i;const f=o.find(b=>b.id===t);for(i.unshift(f),t=f?.parent;t!=null&&t!==""&&t!=="root";){const b=o.find(j=>j.id===t);t=b?.parent,i.unshift(b)}return i};export{Ds as default};
