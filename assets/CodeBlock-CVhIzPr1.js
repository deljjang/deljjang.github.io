import{j as n}from"./index-BUTaIAh4.js";import{r as o}from"./router-BlMcuVHC.js";import{i as w,j as C,t as N,bu as b,bv as B,bq as D}from"./App-CdriGxVX.js";import"./vendor-CCYiWZgt.js";const z=({id:g,block:e,styleClasses:v,isCodeEditing:a,setIsCodeEditing:d,readOnly:L=!1,rootDb:f,memoId:p})=>{const{t:x}=w(),m=C(),{user:r}=N(),[s,u]=o.useState(e.content),[i,l]=o.useState(e.highlightLine||""),c=b(s,500),h=b(i,500),j=o.useRef(!0);o.useEffect(()=>{a||(e.content!==s&&u(e.content),(e.highlightLine||"")!==i&&l(e.highlightLine||""))},[e.content,e.highlightLine,a]),o.useEffect(()=>{if(j.current){j.current=!1;return}const t={};c!==e.content&&(t.content=c),h!==(e.highlightLine||"")&&(t.highlightLine=h),Object.keys(t).length>0&&r?.uid&&m(B({rootDb:f,userId:r.uid,memoId:p,blockId:g,propsToUpdate:t}))},[c,h,e,g,m,p,f,r?.uid]);const y=t=>{t.key==="Escape"&&(d(!1),u(e.content),l(e.highlightLine||""))};return n.jsx(n.Fragment,{children:a&&!L?n.jsxs("div",{className:"CodeBlock w-full relative",children:[n.jsx("textarea",{value:s,onChange:t=>u(t.target.value),onKeyDown:y,autoFocus:!0,rows:`${s.split(/\r\n|\r|\n/g).length+1}`,className:`CodeBlock_textarea ${v.code} w-full min-h-[100px] focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-b-none`}),n.jsx("input",{type:"text",value:i,onChange:t=>l(t.target.value),onKeyDown:y,placeholder:x("highlight_lines_placeholder","e.g., 1,3-5"),className:"CodeBlock_input w-full p-2 text-sm bg-gray-100 dark:bg-zinc-800 border-t border-gray-300 dark:border-zinc-600 focus:outline-none rounded-b-md"}),n.jsx("div",{className:"absolute top-2 right-2 px-3 py-1 ",children:n.jsx("button",{onClick:()=>d(!1),className:"px-3 py-1 text-xs font-semibold text-white bg-blue-500 rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",children:x("done")})})]}):n.jsx(D,{language:e.language||"javascript",postData:s,highlightLine:i})})};export{z as CodeBlock};
