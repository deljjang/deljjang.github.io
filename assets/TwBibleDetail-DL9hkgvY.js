import{j as t,O as C,N as S,I as L,M as D,r as x,E as R,w as J,e as M,G as P,K as Y,J as q}from"./index-CWXZ9Iq7.js";import{A as w}from"./AniButton-Da5aXNPU.js";import{b as y}from"./bibleTxt-CDg_iih8.js";import{u as G,B as H}from"./BibleBookmarkText-Cb8neJrM.js";import{T as K}from"./TwTitleItem-DohviPhG.js";import"./Button-BeXkAMi8.js";import"./Grid-Bx-A-J7h.js";const O=e=>{const i=e.dataText;if(e.data===void 0||e.data===null||i==null)return;const m=e.bibleId.split("_");return e.bibleId&&m.length!==3?t.jsx(t.Fragment,{}):t.jsxs(t.Fragment,{children:[t.jsx("h6",{className:"flex flex-col items-center mb-8 text-xl",children:e.nm}),i.map((s,o)=>{let f="text.primary";e.cd4+""===s.cd4&&(f="warning.main");const a=e.bookmark?.data?.filter(n=>n.cd1===s.cd1&&n.cd2===s.cd2&&n.cd3===s.cd3&&n.cd4===s.cd4&&n.bookmark==="Y");return a&&a.length>0&&(s.bookmark="Y"),t.jsxs("div",{className:"grid grid-cols-5 sm:grid-cols-6 md:grid-cols-10 lg:grid-cols-12 gap-4",id:`id_${o+1}`,children:[t.jsx("div",{className:"col-span-1",children:t.jsxs("div",{className:`flex ${f}`,children:[t.jsx(C,{className:"items-center text-top",onClick:()=>e.onBookmark(s),children:s.nm}),a&&a.length>0&&t.jsx(S,{className:"text-red-500"})]})}),t.jsx("div",{className:`col-span-4 sm:col-span-5 md:col-span-9 lg:col-span-11 ${f}`,children:t.jsx(L,{text:s.text})})]},o)})]})},U=e=>{const i=new Array;if(e.data===void 0||e.data===null)return;const m=e.bibleId.split("_");for(let s=1;s<=e.data.cd3;s++){const o={nm:`${e.data.nm2}${s}장`,key:e.data.id+"_"+s};i.push(o)}return m&&m.length===3?t.jsxs("h6",{className:"flex flex-col items-center text-xl",children:[e.nm," ",m[2]," 장"]}):t.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-6 md:grid-cols-10 lg:grid-cols-12 gap-4",children:i.map((s,o)=>t.jsx("div",{className:"col-span-1",children:t.jsx(D,{to:`/bible/${s.key}`,children:s.nm})},o))})},et=()=>{const[e,i]=x.useState(null),[m,s]=x.useState(!0),{query:o,setBibleBookmark:f}=G(),a=x.useRef(),{bibleId:n}=R(),v=J(),[k,N]=x.useState(!1),[T,p]=x.useState(!1),{user:_}=M(),g=v?.state?.word,b=v?.state?.cd4,$=P();x.useEffect(()=>{if(n!==void 0){(async()=>{const r=await F(n,g);i(r),s(!1)})(),N(!1),p(!0);const l=n.split("_");if(a.current&&l.length===3){const r=a.current.cd3;N(Number(l[2])!==1),p(l[2]<r)}}},[n,g]),x.useEffect(()=>{b!==void 0&&setTimeout(()=>{I("","id_"+b)},1500)},[e,b]);const I=(c,l)=>{const r=document.getElementById(l);r&&r.scrollIntoView({block:"center",behavior:"smooth"})},E=c=>{_!==void 0&&f(c)},F=async(c,l)=>{if(c===""||c===void 0)return"";const r=c.split("_");if(r.length<1)return;r.length>1&&q.map(d=>{d.id===r[0]+"_"+r[1]&&(a.current=d)});const h=new Array;if(r.length===3){for(let d in y){if(!d.includes(c+"_"))continue;let u=y[d];u.id=d;let j=u.txt;if(l!==void 0){const A=new RegExp(l,"gi");j=j.replace(A,`<span class='lightext'>${l}</span>`)}u.nm=`${a.current.nm2}${r[2]}:${u.cd4}`,u.text=j,h.push(u)}return h.sort((d,u)=>d.cd4-u.cd4),h}};if(n==="")return t.jsx(t.Fragment,{});const B=c=>{let l=n.split("_");l[2]=Number(l[2])+c,$(`/bible/${l[0]}_${l[1]}_${l[2]}`)};return t.jsxs(t.Fragment,{children:[t.jsx("div",{id:"back-to-top-anchor"}),t.jsx(H,{}),t.jsx(K,{children:a.current!==null&&a.current!==void 0&&a.current.nm!==null?a.current.text:""}),t.jsx(U,{data:a.current,bibleId:n}),t.jsx(O,{dataText:e,data:a.current,searchWord:g,bibleId:n,cd4:b,bookmark:o,onBookmark:E}),t.jsxs("div",{className:"p-0",children:[m&&t.jsx("div",{className:"flex flex-col items-center",children:t.jsx(Y,{className:"mt-10"})}),n&&n.split("_").length===3?t.jsx("div",{className:"flex justify-between mt-10",children:t.jsxs("div",{className:"grid grid-cols-12 gap-2 w-full",children:[k?t.jsx("div",{className:T?"col-span-6":"col-span-12",children:t.jsx(w,{type:"button",variant:"outlined",onClick:()=>B(-1),fullWidth:!0,children:"< 이전"})}):"",T?t.jsx("div",{className:k?"col-span-6":"col-span-12",children:t.jsx(w,{type:"button",variant:"outlined",onClick:()=>B(1),fullWidth:!0,children:"다음 >"})}):""]})}):""]})]})};export{et as TwBibleDetail,et as default};
