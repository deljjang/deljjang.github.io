const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MUITodo-CBgMvIby.js","assets/index-Bq2okyO2.js","assets/index-CNTHOsEM.css","assets/MuiCard-By9KEL6Y.js","assets/Card-K2jXKaXs.js","assets/CardContent--Of9WwZz.js","assets/Loading-B2jgiSoZ.js","assets/Container-CEuUXhjH.js","assets/styled-DCHl2VxL.js","assets/CircularProgress-DE_ns1Ov.js","assets/Tabs-DAF-S-cN.js","assets/useTheme-CX-Cb1hk.js","assets/useControlled-D1xcdFA9.js","assets/KeyboardArrowRight-BoTtocXG.js","assets/Menu-DY6WpP5T.js","assets/resolveComponentProps-B8WY-0yn.js","assets/commonUtil-BuOP-BrX.js","assets/SinyDate-CHZdUciK.js","assets/createSvgIcon-CBn5T6Tm.js","assets/isMuiElement-Bvb7Om-V.js","assets/Grid-WFSBEAVW.js","assets/index-BmhRCdrV.js","assets/Typography-BfnFn_Qs.js","assets/IconButton-DHhRMkHw.js","assets/TextField-8vjJMIN2.js","assets/InputAdornment-KSIxnVbO.js","assets/Popper-BW2t4pNd.js","assets/Button-DCoXIv0f.js","assets/Chip-DFsKd4ZK.js","assets/datetime-BDx6lZXm.js","assets/index.esm-Dv4f8xaF.js","assets/AniButton-BSbJmPQ5.js","assets/SinyItem-Dg0N63ZY.js","assets/Divider-CoH0J48V.js","assets/dividerClasses-KAVeIEaH.js","assets/registry-2SgsyguN.js","assets/registry-BWaeylsj.css","assets/useWindowDimensions-bUsLyrm4.js","assets/SinySelect-DgQqzdpo.js","assets/MenuItem-CbRtxLuG.js","assets/handson-DQLp9RnM.css"])))=>i.map(i=>d[i]);
import{j as t,B as ae,r as g,a as ie,q as ce,o as de,b,f as I,c as ue,p as N,d as H,e as me,u as ge,g as K,h as F,T as fe,L as U,i as he,R as xe,_ as pe}from"./index-Bq2okyO2.js";import{T as S}from"./TwLabel-67sX6rJe.js";import{H as ye,r as De}from"./registry-2SgsyguN.js";import{D as je}from"./datetime-BDx6lZXm.js";import{u as we}from"./index.esm-Dv4f8xaF.js";/* empty css                */import{s as u}from"./fireDatabase-CYS3RlZB.js";import{n as ve}from"./commonUtil-BuOP-BrX.js";import{u as Te}from"./useWindowDimensions-bUsLyrm4.js";import{T as Ce}from"./TwDatePicker-BXgrhvrE.js";import{T as z}from"./TwInput-C6zKzPJT.js";import{T as be}from"./TwSelect-2-7eLP7d.js";import{A as j}from"./AniButton-BSbJmPQ5.js";import{T as Ie,F as Fe}from"./Footer-Lko9pIeR.js";import{D as Se,B as Re}from"./MainLayout-BSIXNAd2.js";import{C as ke}from"./Container-CEuUXhjH.js";import"./Button-DCoXIv0f.js";import"./LinkItem-DmovyF0G.js";import"./Typography-BfnFn_Qs.js";import"./TwLinkItem-B8UrJan3.js";import"./Divider-CoH0J48V.js";import"./dividerClasses-KAVeIEaH.js";import"./Link-DErjXeoJ.js";import"./createSvgIcon-CBn5T6Tm.js";import"./useControlled-D1xcdFA9.js";import"./isMuiElement-Bvb7Om-V.js";import"./IconButton-DHhRMkHw.js";import"./Menu-DY6WpP5T.js";import"./resolveComponentProps-B8WY-0yn.js";import"./useTheme-CX-Cb1hk.js";import"./MenuItem-CbRtxLuG.js";import"./Toolbar-CEQS9i2S.js";import"./styled-DCHl2VxL.js";const Pe=n=>t.jsxs(ae,{sx:{flexGrow:1,my:2,display:"flex",justifyContent:"flex-end",whiteSpace:"nowrap",pt:"0px"},children:[t.jsx(j,{type:"button",size:"small",variant:"outlined",color:"warning",onClick:n.onInsert,children:"입력"}),t.jsx(j,{type:"button",size:"small",variant:"outlined",color:"error",onClick:n.onDelete,children:"삭제"}),t.jsx(j,{type:"button",size:"small",variant:"outlined",color:"success",onClick:n.onReload,children:"리로드"}),t.jsx(j,{type:"button",size:"small",variant:"outlined",onClick:n.onCsvSave,children:"csv저장"})]});De();const $e=n=>{const{userId:d,baseUrl:D}=n,f=g.useRef(null),p=g.useRef(null),[R,M]=g.useState(),[V,k]=g.useState(0),{height:P}=Te(),$=je.now().setZone("Asia/Seoul").toFormat("yyyy-MM-dd"),W={edTitle:"",edDate:$},{register:w,handleSubmit:A,trigger:O,reset:q,control:v,setValue:T,getValues:y,formState:{errors:h}}=we({mode:"submit ",defaultValues:W}),{theme:Y}=ie(),G=Y==="dark"?"ht-theme-main-dark-auto":"ht-theme-main",Z=async e=>{console.log("onFunPost.data",e.id,e);const o=`${D}/${d}/`;if(e.id===void 0){const s=N(H(b(I),o)).key;console.log("onSubmit.newKey",s),e.id=s}return u(o+e.id+"/title",e.title),u(o+e.id+"/date",e.date),u(o+e.id+"/t1",e.t1),u(o+e.id+"/t2",e.t2),u(o+e.id+"/ing","1"),e},J=async()=>{const e=`${D}/${d}/`,o=ce(b(I,e),de("title"));ue(o,s=>{if(!s.exists())return;const a=s.val(),i=[];for(let r in a){const l=a[r];l.id=r,l.sort=`${l.ing}_${l.date}_${l.title}`,i.push(l)}const x=i.sort((r,l)=>r.sort>l.sort?1:-1).filter(r=>r.ing==="1"),c=i.sort((r,l)=>r.sort>l.sort?-1:1).filter(r=>r.ing==="2");M([...x,...c]),k(i.length)})};g.useEffect(()=>{w("edDate",{required:!0,minLength:10}),w("filterField1"),T("columns1",n.selectDefault),w("edTitle",{required:"해당 필드는 필수입니다.",minLength:{value:1,message:"1글자 이상 입력해주세요."}})},[]),g.useEffect(()=>{d!==void 0&&J()},[d]);const Q=async()=>{L()},X=async()=>{f.current.hotInstance.getPlugin("exportFile").downloadFile("csv",{filename:n.csvFileName,mimeType:"text/csv",bom:!1,columnDelimiter:",",rowDelimiter:`\r
`})},B=[],E={indicators:!0},_=[];n.columns.map((e,o)=>{e.select&&B.push({value:o,text:e.title,label:e.title}),e.hidden===!0&&_.push(o)}),E.columns=_;const L=()=>{try{const e=f.current?.hotInstance,o=e?.getPlugin("filters");if(o){const s=y("columns1");console.log("onKeyUp.columns1=",s,"text=",y("filterField1")),n.columns.forEach((x,c)=>{o?.removeConditions(c)}),o?.addCondition(Number(s),"contains",[y("filterField1")]),o?.filter(),e?.render(),console.log("filtersPlugin=",o),console.log("hotRef=",f.current);const i=e.getData().length;k(i)}}catch(e){console.error("Error:",e),console.error("Error:",e.message)}};async function ee(){console.log("onInputBtn.errors=",h),console.log("onInputBtn.edDate=",y("edDate")),console.log("onInputBtn.edTitle=",y("edTitle")),A(te)()}function te(e,o){console.log("onSubmit.data=",e),console.log("onSubmit.e=",o),console.log("onSubmit.errors=",h);const s=`${n.baseUrl}/${d}/`,a=N(H(b(I),s)).key;console.log("onSubmit.newKey",e.newKey),u(s+a+"/title",e.edTitle),u(s+a+"/date",e.edDate),u(s+a+"/ing","1"),q({edTitle:"",edDate:$})}const oe=async(e,o)=>{if(console.log("afterChange.change=",e,", source=",o),console.log("afterChange.change.length=",e?.length),e!==null){const s=f.current?.hotInstance;if(s?.getPlugin("filters")){const i=s.getData(),x=[];e.forEach((c,r)=>{const l={};console.log("afterChange.index1=",r,", item1=",c[0]),n.columns.forEach((m,re)=>{console.log("afterChange.filteredData=",i[c[0]],m),l[m.data]=i[c[0]][re]}),console.log("afterChange.tmp=",l),x.push(l)}),console.log("afterChange.saveData=",x),x.forEach(async(c,r)=>{console.log("afterChange.item=",c);const l=await Z(c);console.log("afterChange.result=",r,", result=",l),R.map(m=>{(m.id===void 0||m.id===null)&&(console.log("afterChange.rowData1=",m),m.id=l?.id,console.log("afterChange.rowData2=",m))})}),s.render()}}},ne=async()=>{const e=f.current.hotInstance;if(console.log("onDelete:",e),e&&p.current!==null){if(e?.getPlugin("filters")){const s=e.getData();console.log("onDelete.filteredData=",s[p.current]);const a=s[p.current][n.keyId];console.log("onDelete.deleteId=",a),window.confirm("삭제하시겠습니까?")&&u(`${n.baseUrl}/${d}/${a}`,null)}e.alter("remove_row",p.current,1)}},C=e=>{const o=e.target.value;console.log("onChange.target=",e.target.value),T(e.target.name,o)};function se(e,o){console.log("handleChangeDate.dates=",e,"currentDateString=",o),T("edDate",o),O("edDate")}const le=h?.edTitle?t.jsx("div",{className:"sm:grid-cols-12 md:grid-cols-12 lg:grid-cols-12 xl:grid-cols-12",children:t.jsx("p",{className:"error",children:h.edTitle?.message})}):"";return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[t.jsx(be,{id:"columns1",name:"columns1",placeholder:"조회 컬럼",control:v,className:"dark:bg-dark-900",defaultValue:n.selectDefault?n.selectDefault:"1",options:B,error:!!h.columns1,onChange:C}),t.jsx(z,{name:"filterField1",control:v,label:"조회",placeholder:"조회 입력",variant:"filled",margin:"none",onKeyUp:L,onChange:C}),t.jsx(Ce,{control:v,id:"edDate",name:"edDate",label:"등록일자",placeholder:"일자 입력",onChange:se}),t.jsxs("div",{children:[t.jsx(S,{htmlFor:"edTitle",children:"등록제목"}),t.jsx(z,{name:"edTitle",label:"제목",placeholder:"제목 입력",variant:"filled",onChange:C,style:{},error:!!h.edTitle})]})]}),le,t.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[t.jsx(S,{textAlign:"left",children:"건수 : "+ve(V)}),t.jsx(Pe,{onInsert:ee,onDelete:ne,onReload:Q,onCsvSave:X})]}),t.jsx("div",{style:{maxHeight:`${P}- 200`,overflow:"auto"},children:t.jsx(ye,{ref:f,data:R,themeName:G,rowHeaders:!0,colHeaders:!0,autoWrapRow:!0,height:P-200,width:"auto",contextMenu:!0,observeChanges:!0,columnSorting:!0,afterChange:oe,afterSelection:e=>{p.current=e},licenseKey:"non-commercial-and-evaluation",columns:n.columns,cells:(e,o)=>n.columns[o].readOnly===!0?{readOnly:!0}:{},colWidths:n.colWidths,manualColumnResize:!0,filters:!0,stretchH:"last",hiddenColumns:E})})]})},Be=()=>{const{user:n}=me(),d=[{title:"일자",data:"date",type:"date",dateFormat:"YYYY-MM-DD",correctFormat:!0,readOnly:!1,select:!0},{title:"제목",type:"text",data:"title",select:!0},{title:"1",type:"text",data:"t1",select:!1},{title:"2",type:"text",data:"t2",select:!1},{title:"정렬",type:"text",data:"sort",select:!1,hidden:!0},{title:"진행중",type:"text",data:"ing",select:!1,hidden:!0},{title:"ID",type:"text",data:"id",readOnly:!0,select:!1,hidden:!0}],D=[130,500,100,100,100];return!n||n?.uid===void 0?t.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",marginTop:"50px",marginBottom:"100px"},children:t.jsx(S,{children:"로그인을 해야 이용 가능합니다."})}):(console.log("TwTodo.user.uid=",n?.uid),t.jsxs(t.Fragment,{children:[t.jsx($e,{csvFileName:"exported_todo",baseUrl:"todo",columns:d,colWidths:D,selectDefault:"1",keyId:d.length-1,userId:n?.uid}),t.jsx(Ie,{})]}))},Ee=xe.lazy(()=>pe(()=>import("./MUITodo-CBgMvIby.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40]))),ft=()=>{const{ui:n}=ge();return console.log("Todo.ui=",n),n==="tailwind"?t.jsx(g.Suspense,{fallback:t.jsx(U,{}),children:t.jsx(K,{children:t.jsx(F,{element:t.jsx(fe,{sideType:"tail",hovered:!1}),children:t.jsx(F,{path:"/*",element:t.jsx(Be,{})})})})}):t.jsxs(t.Fragment,{children:[t.jsx(Se,{}),t.jsxs(ke,{id:"wrap",maxWidth:"xl",sx:{mt:3},children:[t.jsx(Re,{title:he,enable:!0}),t.jsx(g.Suspense,{fallback:t.jsx(U,{}),children:t.jsx(K,{children:t.jsx(F,{path:"/",element:t.jsx(Ee,{})})})})]}),t.jsx("div",{className:"pb-10 xsm:pb-0",children:t.jsx(Fe,{})})]})};export{ft as Todo,ft as default};
