const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MUITodo-BFuhmXno.js","assets/index-CJrggStm.js","assets/index-Md3EU3K3.css","assets/MuiCard-BZkCKFdP.js","assets/Card-B3ldzxIn.js","assets/CardContent-DQmG00tl.js","assets/Tabs-DJMFT8Jt.js","assets/KeyboardArrowRight-DFPg8uzf.js","assets/SinySelect-CC0zCXwd.js","assets/Grid-Bh89rGOr.js","assets/index-BCqxH397.js","assets/TextField-DtQA9E8_.js","assets/InputAdornment-DvmcGe2-.js","assets/Popper-Byllt1AY.js","assets/Button-Cf3dF736.js","assets/Chip-BINJJOUf.js","assets/datetime-BDx6lZXm.js","assets/index.esm-5hWjpj7j.js","assets/AniButton-BU8UzGDR.js","assets/SinyItem-bNaCEz6k.js","assets/registry-ByHoBBPi.js","assets/registry-BWaeylsj.css","assets/useWindowDimensions-DrhsGLu1.js","assets/TwLabel-D1unnW49.js","assets/TwDatePicker-DLJKy47H.js","assets/TwSelect-Dk8h0QAx.js","assets/handson-DQLp9RnM.css"])))=>i.map(i=>d[i]);
import{q as A,o as B,r as p,f as C,a as K,p as U,c as W,s as d,j as s,B as ae,b as f,u as ie,T as M,n as ce,d as de,e as ue,L as O,R as me,_ as fe}from"./index-CJrggStm.js";import{T as k}from"./TwLabel-D1unnW49.js";import{H as ge,r as he}from"./registry-ByHoBBPi.js";import{D as xe}from"./datetime-BDx6lZXm.js";import{u as ye}from"./index.esm-5hWjpj7j.js";/* empty css                */import{u as we}from"./useWindowDimensions-DrhsGLu1.js";import{T as De}from"./TwDatePicker-DLJKy47H.js";import{T as je}from"./TwSelect-Dk8h0QAx.js";import{A as T}from"./AniButton-BU8UzGDR.js";const be=[130,500,100,100,100],V=[{title:"일자",data:"date",type:"date",dateFormat:"YYYY-MM-DD",correctFormat:!0,readOnly:!1,select:!0},{title:"제목",type:"text",data:"title",select:!0},{title:"1",type:"text",data:"t1",select:!1},{title:"2",type:"text",data:"t2",select:!1},{title:"정렬",type:"text",data:"sort",select:!1,hidden:!0},{title:"진행중",type:"text",data:"ing",select:!1,hidden:!0},{title:"ID",type:"text",data:"id",readOnly:!0,select:!1,hidden:!0}],Le=async(e,c,g)=>{console.log("onFunPost.data",e.id,e);const n=`${c}/${g}/`;if(e.id===void 0){const u=U(W(p(C),n)).key;console.log("onSubmit.newKey",u),e.id=u}return d(n+e.id+"/title",e.title),d(n+e.id+"/date",e.date),d(n+e.id+"/t1",e.t1),d(n+e.id+"/t2",e.t2),d(n+e.id+"/ing","1"),e},Me=async(e,c)=>{const g=`${e}/${c}/`,n=A(p(C,g),B("title"));let u=[];return K(n,w=>{if(!w.exists())return;const D=w.val(),x=[];for(let l in D){const r=D[l];r.id=l,r.sort=`${r.ing}_${r.date}_${r.title}`,x.push(r)}const y=x.sort((l,r)=>l.sort>r.sort?1:-1).filter(l=>l.ing==="1"),j=x.sort((l,r)=>l.sort>r.sort?-1:1).filter(l=>l.ing==="2");u=[...y,...j]}),u},ve=e=>s.jsxs(ae,{sx:{flexGrow:1,my:2,display:"flex",justifyContent:"flex-end",whiteSpace:"nowrap",pt:"0px"},children:[s.jsx(T,{type:"button",size:"small",variant:"outlined",color:"warning",onClick:e.onInsert,children:"입력"}),s.jsx(T,{type:"button",size:"small",variant:"outlined",color:"error",onClick:e.onDelete,children:"삭제"}),s.jsx(T,{type:"button",size:"small",variant:"outlined",color:"success",onClick:e.onReload,children:"리로드"}),s.jsx(T,{type:"button",size:"small",variant:"outlined",onClick:e.onCsvSave,children:"csv저장"})]});he();const Te=e=>{const{userId:c,baseUrl:g}=e,n=f.useRef(null),u=f.useRef(null),[w,D]=f.useState([]),[x,y]=f.useState(0),{height:j}=we(),l=xe.now().setZone("Asia/Seoul").toFormat("yyyy-MM-dd"),r={edTitle:"",edDate:l},{register:I,handleSubmit:H,trigger:q,control:S,setValue:$,getValues:_,reset:Y,formState:{errors:b}}=ye({mode:"submit ",defaultValues:r}),{theme:G}=ie(),Z=G==="dark"?"ht-theme-main-dark-auto":"ht-theme-main";f.useEffect(()=>{I("edDate",{required:!0,minLength:10}),I("filterField1"),$("columns1",e.selectDefault),I("edTitle",{required:"해당 필드는 필수입니다.",minLength:{value:1,message:"1글자 이상 입력해주세요."}})},[]),f.useEffect(()=>{if(!c)return;const t=A(p(C,`${g}/${c}`),B("date")),o=K(t,a=>{const i=a.val(),m=i?Object.keys(i).map(h=>({id:h,...i[h]})):[];m.sort((h,v)=>h.date>v.date?-1:1),D(m),y(m.length)});return()=>o()},[c,g]);const J=async()=>{L()},Q=async()=>{n.current.hotInstance.getPlugin("exportFile").downloadFile("csv",{filename:e.csvFileName,mimeType:"text/csv",bom:!1,columnDelimiter:",",rowDelimiter:`\r
`})},P=[],N={indicators:!0},E=[];e.columns.map((t,o)=>{t.select&&P.push({value:o,text:t.title,label:t.title}),t.hidden===!0&&E.push(o)}),N.columns=E;const L=()=>{try{const t=n.current?.hotInstance,o=t?.getPlugin("filters");if(o){const a=_("columns1");e.columns.forEach((h,v)=>{o?.removeConditions(v)}),o?.addCondition(Number(a),"contains",[_("filterField1")]),o?.filter(),t?.render();const m=t.getData().length;y(m)}}catch(t){console.error("Error:",t),console.error("Error:",t.message)}};async function X(){H(ee)()}function ee(t,o){const a=`${e.baseUrl}/${c}/`,i=U(W(p(C),a)).key;console.log("onSubmit.newKey",t.newKey),d(a+i+"/title",t.edTitle),d(a+i+"/date",t.edDate),d(a+i+"/ing","1"),Y({edTitle:"",edDate:l})}const te=async(t,o)=>{if(o==="loadData"||!t)return;const a=n.current?.hotInstance;a&&t.forEach(async i=>{const[m,h,v,le]=i,R=a.getSourceDataAtRow(m);if(R&&R.id){const re=`${g}/${c}/${R.id}/${h}`;await d(re,le)}})},se=async()=>{const t=n.current.hotInstance;if(console.log("onDelete:",t),t&&u.current!==null&&t?.getPlugin("filters")){const i=t.getData()[u.current][e.keyId];window.confirm("삭제하시겠습니까?")&&d(`${e.baseUrl}/${c}/${i}`,null)}},F=t=>{$(t.target.name,t.target.value)};function oe(t,o){$("edDate",o),q("edDate")}const ne=b?.edTitle?s.jsx("div",{className:"sm:grid-cols-12 md:grid-cols-12 lg:grid-cols-12 xl:grid-cols-12",children:s.jsx("p",{className:"error",children:b.edTitle?.message})}):"";return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[s.jsx(je,{id:"columns1",name:"columns1",placeholder:"조회 컬럼",control:S,className:"dark:bg-dark-900",defaultValue:e.selectDefault?e.selectDefault:"1",options:P,error:!!b.columns1,onChange:F}),s.jsx(M,{name:"filterField1",control:S,label:"조회",placeholder:"조회 입력",variant:"filled",margin:"none",onKeyUp:L,onChange:F}),s.jsx(De,{control:S,id:"edDate",name:"edDate",label:"등록일자",placeholder:"일자 입력",onChange:oe}),s.jsxs("div",{children:[s.jsx(k,{htmlFor:"edTitle",children:"등록제목"}),s.jsx(M,{name:"edTitle",label:"제목",placeholder:"제목 입력",variant:"filled",onChange:F,error:!!b.edTitle})]})]}),ne,s.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[s.jsx(k,{textAlign:"left",children:"건수 : "+ce(x)}),s.jsx(ve,{onInsert:X,onDelete:se,onReload:J,onCsvSave:Q})]}),s.jsx("div",{style:{maxHeight:`${j}- 200`,overflow:"auto"},children:s.jsx(ge,{ref:n,data:w,className:Z,rowHeaders:!0,colHeaders:!0,autoWrapRow:!0,height:j-200,width:"auto",contextMenu:!0,observeChanges:!0,columnSorting:!0,afterChange:te,afterSelection:t=>{u.current=t},afterFilter:()=>{y(n.current?.hotInstance.countRows()||0)},licenseKey:"non-commercial-and-evaluation",columns:e.columns,cells:(t,o)=>e.columns[o].readOnly===!0?{readOnly:!0}:{},colWidths:e.colWidths,manualColumnResize:!0,filters:!0,dropdownMenu:!0,stretchH:"last",hiddenColumns:N})})]})},pe=()=>{const{user:e}=de();return!e||e?.uid===void 0?s.jsx("div",{className:"flex flex-col items-center w-full mt-[50px] mb-[100px]",children:s.jsx(k,{children:"로그인을 해야 이용 가능합니다."})}):(console.log("TwTodo.user.uid=",e?.uid),s.jsx(s.Fragment,{children:s.jsx(Te,{csvFileName:"exported_todo",baseUrl:"todo",columns:V,colWidths:be,selectDefault:"1",keyId:V.length-1,userId:e?.uid})}))},Ce=me.lazy(()=>fe(()=>import("./MUITodo-BFuhmXno.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]))),z=()=>{const{ui:e}=ue();return console.log("Todo.ui=",e),e==="tailwind"?s.jsx(f.Suspense,{fallback:s.jsx(O,{}),children:s.jsx(pe,{})}):s.jsx(f.Suspense,{fallback:s.jsx(O,{}),children:s.jsx(Ce,{})})},Oe=Object.freeze(Object.defineProperty({__proto__:null,Todo:z,default:z},Symbol.toStringTag,{value:"Module"}));export{Oe as T,V as a,Me as g,Le as o,be as t};
