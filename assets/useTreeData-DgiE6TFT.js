import{u as f,Q as p,d}from"./useBaseQuery-CBtuKhA5.js";import{r as i,a0 as y,a2 as b,E as g,F as h,bq as m}from"./index-BYAZQ8R2.js";function x(t,r){return f({...t,enabled:!0,suspense:!0,throwOnError:d,placeholderData:void 0},p)}async function v(t,r=""){if(console.log("getTreeMemoData.userId=",t,", word=",r),console.log("getTreeMemoData.userId=",t,", word=",r),t==null||t==="")return"";const u=r===""?`memo/${t}`:`memo_txt/${t}`;console.log("getTreeMemoData.word=",r,", param=",u);const e=y(g(h,u),b("title")),o=await m(e);if(!o.exists()){console.log("getFireText.null");return}if(!o.exists())return;const l=o.val();console.log("useTreeData.data=",l);const a=[];for(let n in l){const s=l[n];s.up===void 0?(s.id=n,s.fullIndex=n):(s.id=s.up,s.fullIndex=s.up),r===""||r===void 0?(s.sub!==null&&(s.children=c(s,s.up)),a.push(s)):(s.id=n,(s.memo+"").toLowerCase().indexOf(r.toLowerCase())>-1&&a.push(s))}return a.sort((n,s)=>n.title>s.title?1:-1),a}function c(t,r){const u=[];if(t===void 0||t.sub===void 0)return u;for(let e in t.sub){let o=t.sub[e];o.id=e,o.key=e}return Object.values(t.sub).sort((e,o)=>o.title-e.title).map(e=>{e.id=e.key,e.fullIndex=r+"/sub/"+e.key,e.sub!==null&&(e.children=c(e,e.fullIndex)),u.push(e)}),u}const q=t=>{const[r,u]=i.useState(t),[e,o]=i.useState([]),[l,a]=i.useState();return i.useEffect(()=>{if(r!==""){console.log("param=",r);const n=x({queryKey:["treeMemo",r],queryFn:()=>v(r)});console.log("tQuery=",n),o(n.data)}},[r,l]),[e,u,a]};export{q as a,v as g,x as u};
