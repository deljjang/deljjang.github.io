const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MemoSheetGrid-KJiFAHZH.js","assets/index-B6VPhsle.js","assets/index-NPgMvJuh.css","assets/MemoDetailEdit-C3CcVyAt.js","assets/useMemoMutation-B57Bbffh.js","assets/TwCheckbox-DT1ES-9B.js","assets/TwTextArea-B8Fi89ac.js","assets/angle-right-CgU3gK_f.js","assets/MemoDetailEdit-DAKl4fNk.css","assets/MemoDetailUtil-C6Mx36vr.js"])))=>i.map(i=>d[i]);
import{aR as mt,aS as ht,aT as F,aU as ce,aV as Re,aW as We,aX as ft,aY as pt,aZ as gt,a_ as xt,a$ as yt,b0 as vt,b1 as Fe,b2 as wt,b3 as jt,b4 as de,b5 as V,r as m,b6 as Ae,b7 as je,b8 as He,b9 as ne,ad as Ve,ae as Pe,v as J,w as Z,t as C,ba as bt,bb as kt,bc as Ct,bd as $t,be as _,e as z,j as s,i as L,bf as Nt,h as D,g as St,a as ee,k as O,s as ue,bg as Y,V as Tt,l as E,p as x,bh as ae,R as P,m as oe,bi as Et,O as be,a1 as ke,H as Mt,am as Lt,bj as _t,aK as ie,bk as Ie,ai as zt,aj as R,bl as Ce,_ as te,bm as Ot,bn as Bt,f as Ke,bo as Rt,bp as Wt,bq as Ft,br as At,bs as Ht,a4 as me,J as Q,bt as Vt,bu as Pt,bv as It,bw as Kt,al as he,bx as Yt,a9 as Ye,by as qt,aa as Gt,x as qe,bz as Ge,bA as Xe,aF as fe,bB as Xt,bC as Ut,bD as Qt,bE as Jt,bF as Zt,bG as Dt}from"./index-B6VPhsle.js";import{S as Ue,a as es,b as ts}from"./angle-right-CgU3gK_f.js";const G=new WeakMap;let X;const Qe=(e,t,r)=>(a,n)=>n&&n[0]?n[0][e+"Size"]:ht(a)&&"getBBox"in a?a.getBBox()[t]:a[r],ss=Qe("inline","width","offsetWidth"),ns=Qe("block","height","offsetHeight");function rs({target:e,borderBoxSize:t}){G.get(e)?.forEach(r=>{r(e,{get width(){return ss(e,t)},get height(){return ns(e,t)}})})}function as(e){e.forEach(rs)}function os(){typeof ResizeObserver>"u"||(X=new ResizeObserver(as))}function is(e,t){X||os();const r=mt(e);return r.forEach(a=>{let n=G.get(a);n||(n=new Set,G.set(a,n)),n.add(t),X?.observe(a)}),()=>{r.forEach(a=>{const n=G.get(a);n?.delete(t),n?.size||X?.unobserve(a)})}}const U=new Set;let W;function ls(){W=()=>{const e={get width(){return window.innerWidth},get height(){return window.innerHeight}};U.forEach(t=>t(e))},window.addEventListener("resize",W)}function cs(e){return U.add(e),W||ls(),()=>{U.delete(e),!U.size&&typeof W=="function"&&(window.removeEventListener("resize",W),W=void 0)}}function ds(e,t){return typeof e=="function"?cs(e):is(e,t)}function Je(e,t){let r;const a=()=>{const{currentTime:n}=t,i=(n===null?0:n.value)/100;r!==i&&e(i),r=i};return F.preUpdate(a,!0),()=>ce(a)}function us(...e){const t=!Array.isArray(e[0]),r=t?0:-1,a=e[0+r],n=e[1+r],o=e[2+r],i=e[3+r],l=Re(n,o,i);return t?l(a):l}function ms(e,t,r){const a=e.get();let n=null,o=a,i;const l=typeof a=="string"?a.replace(/[\d.-]/g,""):void 0,c=()=>{n&&(n.stop(),n=null)},d=()=>{c(),n=new ft({keyframes:[Ne(e.get()),Ne(o)],velocity:e.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...r,onUpdate:i})};if(e.attach((u,f)=>{o=u,i=y=>f($e(y,l)),F.postRender(d)},c),We(t)){const u=t.on("change",y=>e.set($e(y,l))),f=e.on("destroy",u);return()=>{u(),f()}}return c}function $e(e,t){return t?e+t:e}function Ne(e){return typeof e=="number"?e:parseFloat(e)}const hs=50,Se=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),fs=()=>({time:0,x:Se(),y:Se()}),ps={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function Te(e,t,r,a){const n=r[t],{length:o,position:i}=ps[t],l=n.current,c=r.time;n.current=e[`scroll${i}`],n.scrollLength=e[`scroll${o}`]-e[`client${o}`],n.offset.length=0,n.offset[0]=0,n.offset[1]=n.scrollLength,n.progress=pt(0,n.scrollLength,n.current);const d=a-c;n.velocity=d>hs?0:gt(n.current-l,d)}function gs(e,t,r){Te(e,"x",t,r),Te(e,"y",t,r),t.time=r}function xs(e,t){const r={x:0,y:0};let a=e;for(;a&&a!==t;)if(xt(a))r.x+=a.offsetLeft,r.y+=a.offsetTop,a=a.offsetParent;else if(a.tagName==="svg"){const n=a.getBoundingClientRect();a=a.parentElement;const o=a.getBoundingClientRect();r.x+=n.left-o.left,r.y+=n.top-o.top}else if(a instanceof SVGGraphicsElement){const{x:n,y:o}=a.getBBox();r.x+=n,r.y+=o;let i=null,l=a.parentNode;for(;!i;)l.tagName==="svg"&&(i=l),l=a.parentNode;a=i}else break;return r}const le={start:0,center:.5,end:1};function Ee(e,t,r=0){let a=0;if(e in le&&(e=le[e]),typeof e=="string"){const n=parseFloat(e);e.endsWith("px")?a=n:e.endsWith("%")?e=n/100:e.endsWith("vw")?a=n/100*document.documentElement.clientWidth:e.endsWith("vh")?a=n/100*document.documentElement.clientHeight:e=n}return typeof e=="number"&&(a=t*e),r+a}const ys=[0,0];function vs(e,t,r,a){let n=Array.isArray(e)?e:ys,o=0,i=0;return typeof e=="number"?n=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?n=e.split(" "):n=[e,le[e]?e:"0"]),o=Ee(n[0],r,a),i=Ee(n[1],t),o-i}const ws={All:[[0,0],[1,1]]},js={x:0,y:0};function bs(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function ks(e,t,r){const{offset:a=ws.All}=r,{target:n=e,axis:o="y"}=r,i=o==="y"?"height":"width",l=n!==e?xs(n,e):js,c=n===e?{width:e.scrollWidth,height:e.scrollHeight}:bs(n),d={width:e.clientWidth,height:e.clientHeight};t[o].offset.length=0;let u=!t[o].interpolate;const f=a.length;for(let y=0;y<f;y++){const v=vs(a[y],d[i],c[i],l[o]);!u&&v!==t[o].interpolatorOffsets[y]&&(u=!0),t[o].offset[y]=v}u&&(t[o].interpolate=Re(t[o].offset,yt(a),{clamp:!1}),t[o].interpolatorOffsets=[...t[o].offset]),t[o].progress=vt(0,1,t[o].interpolate(t[o].current))}function Cs(e,t=e,r){if(r.x.targetOffset=0,r.y.targetOffset=0,t!==e){let a=t;for(;a&&a!==e;)r.x.targetOffset+=a.offsetLeft,r.y.targetOffset+=a.offsetTop,a=a.offsetParent}r.x.targetLength=t===e?t.scrollWidth:t.clientWidth,r.y.targetLength=t===e?t.scrollHeight:t.clientHeight,r.x.containerLength=e.clientWidth,r.y.containerLength=e.clientHeight}function $s(e,t,r,a={}){return{measure:n=>{Cs(e,a.target,r),gs(e,r,n),(a.offset||a.target)&&ks(e,r,a)},notify:()=>t(r)}}const H=new WeakMap,Me=new WeakMap,re=new WeakMap,Le=e=>e===document.scrollingElement?window:e;function Ze(e,{container:t=document.scrollingElement,...r}={}){if(!t)return Fe;let a=re.get(t);a||(a=new Set,re.set(t,a));const n=fs(),o=$s(t,e,n,r);if(a.add(o),!H.has(t)){const l=()=>{for(const f of a)f.measure(wt.timestamp);F.preUpdate(c)},c=()=>{for(const f of a)f.notify()},d=()=>F.read(l);H.set(t,d);const u=Le(t);window.addEventListener("resize",d,{passive:!0}),t!==document.documentElement&&Me.set(t,ds(t,d)),u.addEventListener("scroll",d,{passive:!0}),d()}const i=H.get(t);return F.read(i,!1,!0),()=>{ce(i);const l=re.get(t);if(!l||(l.delete(o),l.size))return;const c=H.get(t);H.delete(t),c&&(Le(t).removeEventListener("scroll",c),Me.get(t)?.(),window.removeEventListener("resize",c))}}const _e=new Map;function Ns(e){const t={value:0},r=Ze(a=>{t.value=a[e.axis].progress*100},e);return{currentTime:t,cancel:r}}function De({source:e,container:t,...r}){const{axis:a}=r;e&&(t=e);const n=_e.get(t)??new Map;_e.set(t,n);const o=r.target??"self",i=n.get(o)??{},l=a+(r.offset??[]).join(",");return i[l]||(i[l]=!r.target&&jt()?new ScrollTimeline({source:t,axis:a}):Ns({container:t,...r})),i[l]}function Ss(e,t){const r=De(t);return e.attachTimeline({timeline:t.target?void 0:r,observe:a=>(a.pause(),Je(n=>{a.time=a.iterationDuration*n},r))})}function Ts(e){return e.length===2}function Es(e,t){return Ts(e)?Ze(r=>{e(r[t.axis].progress,r)},t):Je(e,De(t))}function Ms(e,{axis:t="y",container:r=document.scrollingElement,...a}={}){if(!r)return Fe;const n={axis:t,container:r,...a};return typeof e=="function"?Es(e,n):Ss(e,n)}const Ls=()=>({scrollX:V(0),scrollY:V(0),scrollXProgress:V(0),scrollYProgress:V(0)}),q=e=>e?!e.current:!1;function _s({container:e,target:t,...r}={}){const a=de(Ls),n=m.useRef(null),o=m.useRef(!1),i=m.useCallback(()=>(n.current=Ms((l,{x:c,y:d})=>{a.scrollX.set(c.current),a.scrollXProgress.set(c.progress),a.scrollY.set(d.current),a.scrollYProgress.set(d.progress)},{...r,container:e?.current||void 0,target:t?.current||void 0}),()=>{n.current?.()}),[e,t,JSON.stringify(r.offset)]);return Ae(()=>{if(o.current=!1,q(e)||q(t)){o.current=!0;return}else return i()},[i]),m.useEffect(()=>{if(o.current)return je(!q(e)),je(!q(t)),i()},[i]),a}function et(e){const t=de(()=>V(e)),{isStatic:r}=m.useContext(He);if(r){const[,a]=m.useState(e);m.useEffect(()=>t.on("change",a),[])}return t}function tt(e,t){const r=et(t()),a=()=>r.set(t());return a(),Ae(()=>{const n=()=>F.preRender(a,!1,!0),o=e.map(i=>i.on("change",n));return()=>{o.forEach(i=>i()),ce(a)}}),r}function zs(e){ne.current=[],e();const t=tt(ne.current,e);return ne.current=void 0,t}function Os(e,t,r,a){if(typeof e=="function")return zs(e);const n=us(t,r,a);return Array.isArray(e)?ze(e,n):ze([e],([o])=>n(o))}function ze(e,t){const r=de(()=>[]);return tt(e,()=>{r.length=0;const a=e.length;for(let n=0;n<a;n++)r[n]=e[n].get();return t(r)})}function Bs(e,t={}){const{isStatic:r}=m.useContext(He),a=()=>We(e)?e.get():e;if(r)return Os(a);const n=et(a());return m.useInsertionEffect(()=>ms(n,e,t),[n,JSON.stringify(t)]),n}const Rs=async(e,t)=>(await _(e)===void 0||C(e,null),C(t,null),"OK"),cn=async({rootDb:e,uid:t,newData:r=!1,key:a,values:n})=>{const o=e==="memo"?`${e}_txt/${t}/`:`${e}_txt/`,i=e==="memo"?`${e}_tree/${t}/`:`${e}/`;let l=a;r&&(l=Ve(Pe(J(Z),i)).key),console.log("setFireDetailData.values=",n);const c=o+l;return C(c+"/title",n.edTitle),n.htmlCheck==="N"||n.htmlCheck==="sheet"?C(c+"/memo",n.memoTxt):C(c+"/memo",n.content),C(c+"/date",n.edDate),C(c+"/gbn",n.edGbn),C(c+"/html",n.htmlCheck),r&&e!=="home"&&(C(`${i}/${l}/key`,l),C(`${i}/${l}/parent`,a)),e!=="home"&&(C(`${i}${l}/title`,n.edTitle),C(`${i}${l}/icon`,n.iconCheck)),l},dn=async(e,t,r,a)=>{if(a!==void 0)for(let n=0;n<a.length;n++){const o=a[n];o.del==="Y"&&(C(`${e}/${r}/image/${o.key}`,null),bt(t,r,o))}},un=async(e,t,r,a)=>{for(let n=0;n<a.length;n++){const o=a[n].object,l={ext:kt(o.name),name:o.name,use:"Y",sever:""},c=Ve(Pe(J(Z),e+"/image")).key,d=await Ct(t,r,c,o);l.sever=$t(d.metadata.name);const u=`${e}${r}/image/${l.sever}`;C(u,l)}},Oe=e=>{const{t}=z();return s.jsxs("div",{className:"mx-auto grid w-full max-w-lg grid-cols-5 items-center justify-center gap-2 px-4 py-2 text-center",children:[e.master&&s.jsx(L,{size:"sm",variant:"outlined",color:"brand",onClick:e.onUtil,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l-.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),s.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("util")})]})}),s.jsx(L,{size:"sm",variant:"outlined",color:"brand",onClick:e.onEdit,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),s.jsx("path",{d:"m15 5 4 4"})]}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("edit")})]})}),s.jsx(L,{size:"sm",variant:"outlined",color:"brand",onClick:e.onNewMemo,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M5 12h14"}),s.jsx("path",{d:"M12 5v14"})]}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("new")})]})}),s.jsx(L,{size:"sm",variant:"outlined",color:"error",onClick:e.onDelete,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M3 6h18"}),s.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),s.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("delete")})]})}),e.onCopy&&s.jsx(L,{size:"sm",variant:"outlined",color:"secondary",onClick:e.onCopy,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:s.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("public")})]})})]})},Ws=({rootDb:e,memoDetailData:t,onBookmark:r,searchWord:a,onDeleteTab:n})=>{const[o,i]=m.useState(!1),{alertInfo:l,setAlertInfo:c,resetAlertInfo:d}=Nt(),[u,f]=m.useState(!1),[y,v]=m.useState(""),[b,k]=m.useState(!1),[p,g]=m.useState(""),[w,T]=m.useState(!1),{t:$}=z(),{scrollYProgress:M}=_s(),A=Bs(M,{stiffness:100,damping:30,restDelta:.001}),I=D(),{memoId:j}=St(),se=ee()?.state?.fullIndex,{user:S}=O(),B=ue(),st=Y({mutationFn:async()=>{const h=e==="memo"?`${e}_txt/${S.uid}/${j}`:`${e}_txt/${j}`,N=e==="memo"?`${e}_tree/${S.uid}/${j}`:`${e}/${j}`;return await Rs(h,N)},onSuccess:()=>{B.invalidateQueries({queryKey:["twTreeData",e]}),n&&n(j),I(`/${e==="memo"?"m":e}`)},onError:h=>{console.error("삭제 중 오류 발생:",h)}}),nt=Y({mutationFn:async()=>{if(!S||!j||e!=="memo")throw new Error("Only private memos can be copied.");`${S.uid}${j}`;const h=t;if(!h)throw new Error("Memo data not found.");const N=`home_txt/${j}`;await C(N,h);const K=`memo_tree/${S.uid}/${j}`,ut=`home/${j}`;await C(`${K}/public`,"Y"),await C(ut,{...h,key:j,text:h.title})},onSuccess:()=>{c({isOpen:!0,title:$("complete"),message:$("copy_completed"),color:"success",onConfirm:d,onClose:d}),B.invalidateQueries({queryKey:["memoDetail","home",S?.uid,j]})},onError:h=>{console.error("Copy failed:",h);const N=`${$("copy_failed")} ${h.message?`: ${h.message}`:""}`;c({isOpen:!0,title:$("error"),message:N,color:"error",onConfirm:d,onClose:d})}}),pe=Y({mutationFn:async h=>{const N=e==="memo"?`memo_txt/${S.uid}/${j}/title`:`home_txt/${j}/title`,K=e==="memo"?`memo_tree/${S.uid}/${j}/title`:`home/${j}/title`;return await C(N,h),await C(K,h),h},onSuccess:h=>{B.setQueryData(["memoDetail",e,S?.uid,j],N=>({...N,title:h})),B.invalidateQueries({queryKey:["twTreeData",e]}),B.invalidateQueries({queryKey:["tabTitle",e,S?.uid,j]}),k(!1)},onError:h=>{console.error("제목 업데이트 중 오류 발생:",h),k(!1)}}),rt=Y({mutationFn:async h=>{const N=e==="memo"?`memo_txt/${S.uid}/${j}/memo`:`home_txt/${j}/memo`;return await C(N,h),h},onSuccess:h=>{B.setQueryData(["memoDetail",e,S?.uid,j],N=>({...N,memo:h})),f(!1)},onError:h=>{console.error("메모 저장 중 오류 발생:",h)}}),at=()=>{rt.mutate(y)},ot=()=>{v(t?.memo||""),f(!0)},it=()=>{g(t?.title||""),k(!0)},lt=h=>{g(h.target.value)},ct=h=>{h.key==="Enter"?pe.mutate(p):h.key==="Escape"&&k(!1)},ge=()=>{const h=`/${e==="memo"?"m":e}/edit/${j}`;I(h,{state:{fullIndex:se}})},xe=()=>{const h=`/${e==="memo"?"m":e}/util/${j}`;I(h,{state:{fullIndex:se}})},ye=()=>{const h=`/${e==="memo"?"m":e}/insert/${j}`;I(h,{state:{fullIndex:se}})},ve=()=>{i(!0)},we=()=>{nt.mutate()},dt=()=>{i(!1),st.mutate()};return m.useEffect(()=>{function h(){const N=t.scrollY?t.scrollY:0;window.scrollTo({top:N})}t&&t.memo!==null&&(h(),t.image&&t.image.map((N,K)=>N),Tt({title:t.title,description:""}))},[t]),j===""||S===void 0?null:s.jsxs("div",{className:"MemoDetail py-4 relative rounded-t-lg",children:[s.jsx(E.div,{className:`progress-bar sticky ${w?"top-28":"top-16"} z-10`,style:{scaleX:A}}),s.jsxs("div",{className:"MemoDetail_body overflow-hidden ",children:[s.jsxs("div",{className:`sticky top-0 z-20 ${x.card} backdrop-blur-sm`,children:[s.jsxs("div",{className:"p-3 sm:p-4",children:[s.jsxs("div",{className:x.between,children:[s.jsxs("p",{className:`${x.truncate} ${x.textXs} ${x.textGray500DarkZinc400}`,children:[s.jsx(ae,{to:e==="memo"?"/m":"/hmoe",className:"dark:hover:!text-white hover:!text-gray-900",children:e==="memo"?"MEMO":"HOME"}),t?.path?.map((h,N)=>t.path.length===N+1?` > ${h?.title}`:s.jsxs(P.Fragment,{children:[" "," > ",s.jsx(ae,{to:e==="memo"?`/m/${h.id}`:`/home/${h.id}`,className:"dark:hover:!text-white hover:!text-gray-900",children:h?.title})]},N))]}),s.jsx(E.button,{whileTap:{scale:.8},className:`${x.flexShrink0} ${x.roundedFull} p-2 ${x.buttonHoverGrayLight}`,"aria-label":$("bookmark"),onClick:r,children:t?.bookmark==="Y"?s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`${x.h5W5} ${x.textRed500}`,fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}):s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`${x.h5W5} ${x.textGray500}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})})]}),b?s.jsx("input",{type:"text",value:p,onChange:lt,onKeyDown:ct,onBlur:()=>pe.mutate(p),className:`w-full bg-transparent border-b-2 border-blue-500 focus:outline-none 
													${x.heading2XlBoldSm3Xl} ${x.textGray900}`,autoFocus:!0}):s.jsx("div",{onDoubleClick:it,className:`MemoDetail_Title text-left ${x.heading2XlBoldSm3Xl} ${x.textGray900} cursor-pointer`,children:t?.title}),s.jsx("button",{onClick:()=>T(!w),className:`${x.floatingActionButton} absolute top-11 sm:top-14 right-2 sm:right-3`,children:s.jsx(E.div,{animate:{rotate:w?135:0},children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})})]}),s.jsx(E.div,{initial:!1,animate:{height:w?"auto":0,opacity:w?1:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:s.jsx("div",{className:"border-t border-gray-200 bg-gray-50 dark:border-zinc-800 dark:bg-zinc-900/50",children:s.jsx(Oe,{master:S?.uid===oe,rootDb:e,onEdit:ge,onUtil:xe,onNewMemo:ye,onDelete:ve,onCopy:e==="memo"?we:null})})})]}),t&&t.html==="sheet"&&s.jsx(Et,{rootDb:e,detailData:t}),s.jsxs("div",{className:`MemoDetail_Content ${t?.memo?.length>0?`${x.card} my-4 p-2 sm:p-4`:"p-1"}`,onDoubleClick:ot,children:[u?s.jsxs("div",{className:`${x.card} p-4`,children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(be,{children:$("input")}),s.jsx("textarea",{className:"w-full min-h-[100px] p-2 border rounded dark:bg-gray-700 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500",value:y,rows:`${y.split(/\r\n|\r|\n/g).length}`,onChange:h=>v(h.target.value),autoFocus:!0})]}),s.jsxs("div",{children:[s.jsx(be,{children:$("preview")}),s.jsx("div",{className:"prose dark:prose-invert max-w-none p-2 border rounded min-h-[100px] overflow-y-auto dark:bg-gray-700 dark:border-gray-600",children:s.jsx(ke,{postData:y,highlightWord:""})})]})]}),s.jsxs("div",{className:"mt-2 flex justify-end gap-2",children:[s.jsx(L,{variant:"outlined",color:x.button.indigo,size:"sm",onClick:()=>f(!1),children:$("cancel")}),s.jsx(L,{color:x.button.indigo,onClick:at,children:$("save")})]})]}):t&&t.html!=="sheet"?t?.html==="N"?s.jsx(ke,{postData:t?.memo,highlightWord:a}):t?.html!=="N"&&t?.memo&&s.jsx(Mt,{text:t.memo}):"",s.jsx(Lt,{imageList:t?.image}),!t&&s.jsx("div",{className:"flex justify-center py-12",children:s.jsx("div",{className:`${x.flexCenter} py-12`})})]})]}),s.jsx(_t,{rootDb:e,memoId:j,enableEdit:!0}),s.jsx(E.div,{initial:!1,animate:{height:w?"auto":0,opacity:w?1:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:s.jsx("div",{className:`${x.line}`,children:s.jsx(Oe,{master:S?.uid===oe,rootDb:e,onEdit:ge,onUtil:xe,onNewMemo:ye,onDelete:ve,onCopy:e==="memo"?we:null})})}),s.jsx(ie,{isOpen:o,size:"sm",color:"warning",title:$("delete_confirm_title"),message:$("delete_confirm_message"),onClose:()=>i(!1),onConfirm:dt}),s.jsx(ie,{...l})]})},Fs=P.lazy(()=>te(()=>import("./MemoSheetGrid-KJiFAHZH.js"),__vite__mapDeps([0,1,2]))),Be=P.lazy(()=>te(()=>import("./MemoDetailEdit-C3CcVyAt.js"),__vite__mapDeps([3,1,2,4,5,6,7,8]))),As=P.lazy(()=>te(()=>import("./MemoDetailUtil-C6Mx36vr.js"),__vite__mapDeps([9,1,2,6,4,7]))),Hs=P.lazy(()=>te(()=>import("./index-B6VPhsle.js").then(e=>e.b_),__vite__mapDeps([1,2]))),Vs=({rootDb:e,user:t,memoId:r,memoDetailData:a,isLoading:n,onBookmark:o,handleCloseTab:i})=>{const l=ee();return s.jsx(m.Suspense,{fallback:s.jsx(Ce,{}),children:s.jsx(Ie,{children:s.jsxs(zt,{location:l,children:[s.jsx(R,{path:"todo",element:s.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(Hs,{})})}),s.jsx(R,{path:"sheet/:sheetId?",element:s.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(Fs,{detailData:a})})}),s.jsx(R,{path:"edit/:memoId",element:s.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(Be,{rootDb:e,isLoading:n,memoDetailData:a})})}),s.jsx(R,{path:"insert/:memoId",element:s.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(Be,{rootDb:e,isLoading:n,memoDetailData:a})})}),s.jsx(R,{path:"util/:memoId",element:s.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(As,{rootDb:e,isLoading:n,memoDetailData:a})})}),s.jsx(R,{path:":memoId",element:s.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:n?s.jsx(Ce,{}):s.jsx(Ws,{rootDb:e,memoDetailData:a,onBookmark:o,onDeleteTab:()=>i(null,{id:r})})})})]},l.pathname)})})},Ps=e=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...e,children:s.jsx("path",{fillRule:"evenodd",d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zM6 20V4h7v5h5v11H6zM8 12h3v3H8v-3zm0 4h3v3H8v-3zm4-4h3v3h-3v-3zm0 4h3v3h-3v-3z",clipRule:"evenodd"})}),Is=({tabInfo:e,handleCloseTab:t,isActive:r})=>{const{t:a}=z(),{user:n}=O(),{attributes:o,listeners:i,setNodeRef:l,transform:c,transition:d,isDragging:u}=Ot({id:e.id}),f={transform:Bt.Transform?.toString(c),transition:d,zIndex:u?1:"auto"},{data:y}=Ke({queryKey:["tabTitle",e.rootDb,n?.uid,e.id],queryFn:async()=>e.rootDb==="sheet"?await _(`memo_sheet/${n?.uid}/${e.id}/title`):e.rootDb==="memo"?await _(`${e.rootDb}_txt/${n?.uid}/${e.id}/title`):e.rootDb==="home"?await _(`${e.rootDb}_txt/${e.id}/title`):e.title,enabled:!!n&&!!e.id,staleTime:1/0,placeholderData:e.title});return s.jsxs(ae,{ref:l,style:f,...o,...i,"data-tab-id":e.id,to:e.path,title:y,end:!0,className:({isActive:v})=>`SortableTab group relative flex flex-shrink-0 items-center pl-3 pr-2 py-1.5 text-sm rounded-t-md transition-colors duration-200 min-w-28 max-w-48 border-b-2
				${v?"bg-gray-200 dark:bg-zinc-700 border-blue-500 text-gray-800 dark:text-gray-100":"border-transparent text-secondary hover:bg-gray-200/70 dark:hover:bg-zinc-700/70"}
				${u?"opacity-50 shadow-lg":""}`,children:[e.rootDb==="memo"?s.jsx(Rt,{className:`w-5 h-5 mr-1 flex-shrink-0 transition-transform duration-200 ${r?"scale-110":""}`,fill:"currentColor"}):e.rootDb==="sheet"?s.jsx(Ps,{className:`w-5 h-5 mr-1 flex-shrink-0 transition-transform duration-200 ${r?"scale-110":""}`}):null,s.jsx("span",{className:"truncate pr-1",style:{fontFamily:"sans-serif"},children:y||a("loading")}),s.jsx("button",{onClick:v=>t(v,e),className:`ml-auto flex-shrink-0 p-1 rounded-full transition-opacity duration-200 opacity-0 group-hover:opacity-100
					text-gray-500 dark:text-gray-400 
					hover:bg-gray-300/50 dark:hover:bg-gray-600/50 hover:text-gray-700 dark:hover:text-white
				`,children:s.jsx(Ue,{className:"w-3 h-3"})})]})},Ks=({openTabs:e,setOpenTabs:t,handleCloseTab:r,handleCloseAllTabs:a,activeId:n})=>{const o=m.useRef(null),[i,l]=m.useState({left:!1,right:!1}),[c,d]=m.useState({left:0,width:0}),[u,f]=m.useState(!0),y=m.useRef(0),v=m.useCallback(()=>{const p=o.current;if(p){const g=p.scrollWidth>p.clientWidth,w=p.scrollLeft===0,T=p.scrollLeft+p.clientWidth>=p.scrollWidth-1;l($=>{const M={left:g&&!w,right:g&&!T};return $.left===M.left&&$.right===M.right?$:M})}},[]);m.useEffect(()=>{const p=()=>{const g=window.pageYOffset||document.documentElement.scrollTop;g>y.current?f(!1):f(!0),y.current=g<=0?0:g};return window.addEventListener("scroll",p),()=>{window.removeEventListener("scroll",p)}},[]);const b=p=>{o.current?.scrollBy({left:p==="left"?-200:200,behavior:"smooth"})},k=p=>{const{active:g,over:w}=p;console.log("active=",g,"over=",w),g.id!==w.id&&t(T=>{const $=T.findIndex(A=>A.id===g.id),M=T.findIndex(A=>A.id===w.id);return Ht(T,$,M)})};return m.useEffect(()=>{v();const p=o.current;return p?.addEventListener("scroll",v),window.addEventListener("resize",v),()=>{p?.removeEventListener("scroll",v),window.removeEventListener("resize",v)}},[e,v]),m.useEffect(()=>{const p=setTimeout(()=>{const g=o.current?.querySelector(`[data-tab-id="${n}"]`);if(g){const{offsetLeft:w,offsetWidth:T}=g;d({left:w,width:T})}},0);return()=>clearTimeout(p)},[n,e]),s.jsx("div",{className:`MemoTabs sticky ${u?"top-18":"top-1"} z-1000 rounded-t-md bg-gray-50/70 dark:bg-zinc-800/70 backdrop-blur-sm shadow-sm`,children:s.jsxs("div",{className:"relative flex items-center justify-between ",children:[i.left&&s.jsx("button",{onClick:()=>b("left"),className:"absolute left-0 z-10 p-1 border border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 bg-white dark:bg-zinc-900 dark:hover:!text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full group",children:s.jsx(es,{className:"w-5 h-5 fill-current"})}),s.jsx(Wt,{id:"memo-tabs",onDragEnd:k,children:s.jsx("div",{ref:o,className:"MemoTabs relative flex items-center overflow-x-scroll scrollbar-hide whitespace-nowrap",children:s.jsx(Ft,{items:e.map(p=>p.id),strategy:At,children:s.jsx(Ie,{children:e.map(p=>s.jsx(E.div,{layout:!0,initial:{opacity:0,scale:.8},transition:{type:"spring",stiffness:350,damping:30},animate:{opacity:1,scale:1},exit:{opacity:0,width:0,paddingLeft:0,paddingRight:0,transition:{duration:.3}},children:s.jsx(Is,{tabInfo:p,handleCloseTab:r,isActive:p.id===n})},p.id))})})})}),s.jsxs("div",{className:"flex items-center",children:[i.right&&s.jsx("button",{onClick:()=>b("right"),className:"z-10 p-1 border border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 bg-white dark:bg-zinc-900 dark:hover:!text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full group",children:s.jsx(ts,{className:"w-5 h-5 fill-current"})}),e.length>0&&s.jsx("button",{onClick:a,className:"ml-2 mr-2 p-1.5 text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md",title:"Close all tabs",children:s.jsx(Ue,{className:"w-4 h-4"})})]})]})})};function Ys(e,t,r,a){const n=me(),o=ue(),i=Q(Vt(r)),l=Q(Pt(r)),c=l==="loading";return m.useEffect(()=>{t?.uid&&r&&r!=="insert"&&l!=="succeeded"&&n(It({rootDb:e,userId:t.uid,memoId:r}))},[n,e,t?.uid,r,l]),{memoDetailData:i||{},isLoading:c,onBookmark:()=>{if(!i)return;const u=i.bookmark==="Y"?"N":"Y";n(Kt({rootDb:e,userId:t.uid,memoId:r,newBookmarkState:u})).unwrap().then(()=>{o.invalidateQueries({queryKey:["twTreeData",e],refetchType:"all"}),o.invalidateQueries({queryKey:["bookmarks",t?.uid],refetchType:"all"}),a(!0)})}}}function qs(e,t,r,a,n){const o=r?.uid,[i,l]=m.useState(()=>{try{const b=localStorage.getItem(`openTabs_${o}`);return b?JSON.parse(b):[]}catch(b){return console.error("Failed to parse openTabs from localStorage",b),[]}}),c=m.useRef(),d=ee(),u=D(),f=m.useCallback(async b=>{if(e&&a&&a!=="insert"&&d.pathname!=="/m"&&d.pathname!=="/home"){const k={id:a,path:d.pathname,icon:null,rootDb:t,title:b?.title};if(d.pathname.startsWith("/m/sheet/")){const p=await _(`memo_sheet/${r?.uid}/${a}/title`);k.title=p}else a==="sheet"&&(k.title="Main Sheet");!i.some(p=>p.id===k.id)&&c.current!==a?(c.current=a,l(p=>[...p,k])):(c.current="",l(p=>p.map(g=>g.id===k.id?{...g,title:k.title||g.title}:g)))}},[n,e]);m.useEffect(()=>{n&&f(n)},[n,e]),m.useEffect(()=>{if(o)try{localStorage.setItem(`openTabs_${o}`,JSON.stringify(i))}catch(b){console.error("Failed to save openTabs to localStorage",b)}},[i,o]);const y=m.useCallback((b,k)=>{b?.preventDefault(),b?.stopPropagation(),c.current="";const p=i.findIndex(w=>w.id===k.id),g=i.filter(w=>w.id!==k.id);if(l(g),d.pathname.includes(k.id)){const w=g.length>0?g[Math.max(0,p-1)].path:`/${t==="memo"||t==="sheet"?"m":t}`;u(w,{relative:"path"})}},[i,d.pathname,t,u]),v=m.useCallback(()=>{c.current="",l([]),u(`/${t==="memo"||t==="sheet"?"m":t}`)},[t,u]);return{openTabs:i,setOpenTabs:l,handleCloseTab:y,handleCloseAllTabs:v}}const Gs=({item:e})=>{const{user:t}=O(),r=D();return s.jsx("div",{onClick:()=>r(`/m/${e.key}`),className:`${x.roundedXl} border border-gray-200 
      bg-white dark:border-gray-800 dark:bg-white/[0.03] 
      overflow-hidden cursor-pointer hover:shadow-md transition-shadow h-full flex flex-col`,children:s.jsx("div",{className:"px-4 py-3",children:s.jsx("h3",{className:"text-base font-medium text-gray-800 dark:text-white/90 truncate",children:e.title})})})};function Xs(){const{user:e}=O(),{t}=z(),{data:r,isLoading:a}=Ke({queryKey:["bookmarks",e?.uid],queryFn:async()=>{const o=[],i=Ye(J(Z,`memo_tree/${e.uid}`),Gt("bm"),qt("Y")),l=await qe(i);if(!l.exists())return[];const c=l.val();for(let d in c){const u=c[d];u.id=d,u.key=d,u.text=u.title,o.push(u)}return o.sort((d,u)=>d.title>u.title?1:-1),o},enabled:!!e}),n="grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4";return e===null?s.jsx(s.Fragment,{}):s.jsx(he,{title:t("main_list"),children:s.jsx("div",{className:"p-2",children:a?s.jsx(Yt,{}):s.jsx("div",{className:`grid ${n} gap-3`,children:r?.map(o=>s.jsx(Gs,{item:o},o.id))})})})}const Us=()=>{const[e,t]=m.useState({labels:[],series:[]}),[r,a]=m.useState(null),[n,o]=m.useState({isOpen:!1}),{t:i}=z();return m.useEffect(()=>{(async()=>{const c=await _("home_cnt");if(c){a(c);const u=Object.keys(c).sort().reverse().slice(0,30),f=u.map(v=>v.split("-").slice(1).join("-")),y=u.map(v=>Object.keys(c[v]).length);t({labels:f,series:y})}})()},[]),s.jsxs(s.Fragment,{children:[s.jsx(ie,{...n}),s.jsx(he,{title:i("visitors.count"),className:"w-full justify-center mt-5",children:s.jsx(Ge,{series:[{name:i("count"),data:e.series}],labels:e.labels,showDownload:!1,onDataPointSelection:(l,c,d)=>{const u=d.dataPointIndex;if(r&&u>-1){const y=Object.keys(r).sort().reverse()[u],v=r[y],b=Object.keys(v).join("<br/>");o({isOpen:!0,title:`${y} ${i("visitors.count")}`,message:b,onClose:()=>o({isOpen:!1})})}}})})]})};function Qs({series:e,labels:t}){const[r,a]=m.useState({labels:[],colors:Xe,dataLabels:{style:{colors:["#333"]}},responsive:[{breakpoint:480,options:{chart:{width:"100%"},legend:{position:"bottom"}}}]});return m.useEffect(()=>{a(n=>({...n,labels:t}))},[t]),s.jsx("div",{className:"bg-amber-50 dark:bg-gray-900 shadow-md rounded-sm p-2",children:e&&e.length>0?s.jsx(fe,{type:"donut",series:e,options:r}):s.jsx("div",{className:"text-center text-gray-500 py-10",children:"표시할 데이터가 없습니다."})})}function Js({series:e,labels:t}){const[r,a]=m.useState({chart:{type:"radar"},colors:["#008FFB"],dataLabels:{enabled:!1},xaxis:{categories:[]},yaxis:{show:!1}});return m.useEffect(()=>{a(n=>({...n,xaxis:{...n.xaxis,categories:t}}))},[t]),s.jsx("div",{className:"bg-white dark:bg-black shadow-md rounded-sm p-2",children:e&&e.length>0&&e[0].data.length>0?s.jsx(fe,{type:"radar",series:e,options:r}):s.jsx("div",{className:"text-center text-gray-500 py-10",children:"표시할 데이터가 없습니다."})})}function Zs({series:e,labels:t}){const[r,a]=m.useState({labels:[],colors:Xe,plotOptions:{pie:{startAngle:-90,endAngle:90,offsetY:10}},grid:{padding:{bottom:-80}},dataLabels:{style:{colors:["#333"]}},responsive:[{breakpoint:480,options:{chart:{width:"100%"},legend:{position:"bottom"}}}]});return m.useEffect(()=>{a(n=>({...n,labels:t}))},[t]),s.jsx("div",{className:"bg-amber-50 dark:bg-gray-900 shadow-md rounded-sm p-2",children:e&&e.length>0&&s.jsx(fe,{type:"donut",series:e,options:r})})}const Ds=({className:e})=>s.jsx("svg",{className:e,fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",clipRule:"evenodd"})}),en=({className:e})=>s.jsx("svg",{className:e,fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});async function tn(e,t,r=""){if(t==null||t==="")return"";if(e==="home"){const d=await _("home/tree");if(d!=null)try{return JSON.parse(d)}catch(u){console.error("Error parsing JSON data:",u)}}const a=e==="home"?"home_txt":r===""?`${e}_tree/${t}`:`${e}_txt/${t}`,n=Ye(J(Z,a)),o=await qe(n);if(!o.exists()||!o.exists())return null;const i=o.val(),l=[{text:"1.React",id:"react",key:"react",parent:"root"},{text:"2.CSS",id:"css",key:"css",parent:"root"},{text:"3.Android",id:"android",key:"android",parent:"root"},{text:"4.Java",id:"java",key:"java",parent:"root"},{text:"5.이미지",id:"image",key:"image",parent:"root"},{text:"6.Etc",id:"etc",key:"etc",parent:"root"}],c=[];e==="home"&&c.push(...l);for(const d in i){const u=i[d];u.id=d;const f={id:d,key:d,text:u.title,parent:e==="home"?u.gbn:u.parent};e==="memo"?(f.icon=u.bm==="Y"?s.jsx(Ds,{className:"w-4 h-4 text-red-500"}):u.icon==="Y"?s.jsx(en,{className:"w-4 h-4 text-green-500"}):null,f.droppable=!0):f.droppable=!1,!((r===""||r===void 0||r===null)&&(f.parent===void 0||f.parent===null||f.parent===""))&&(e==="home"||r===""||r===void 0||r===null?c.push(f):(u.id=d,(u.memo+"").toLowerCase().indexOf(r.toLowerCase())>-1&&(f.parent="root",f.droppable=!1,c.push(f))))}return c.sort((d,u)=>d.title>u.title?1:-1),e==="home"&&C("home/tree",JSON.stringify(c)),c}const sn=({rootDb:e})=>{const{user:t}=O(),{t:r}=z(),a=me(),n=Q(Xt(e)),[o,i]=m.useState({labels:[],series:[]}),l=["#6366f1","#3b82f6","#22c55e","#ef4444","#f97316","#eab308","#8b5cf6","#d946ef","#14b8a6","#a855f7"],c=async()=>{const f=await tn(e==="sheet"?"memo":e,t?.uid);d(f)};m.useEffect(()=>{n&&n.labels&&n.labels.length>0?i(n):c()},[e,t,n,a]);const d=f=>{if(f&&f.length>0){const y=f.filter(g=>g.parent==="root").sort((g,w)=>g.text.localeCompare(w.text)),v=(g,w)=>{const T=w.filter(M=>M.parent===g);let $=T.length;for(const M of T)$+=v(M.id,w);return $},b=y.map(g=>g.text),k=y.map(g=>v(g.id,f)),p={labels:b,series:k};i(p),a(Qt({rootDb:e,data:p}))}},u=()=>{c()};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`HomeChartForm ${x.between} bg-[#f1f1f1] dark:bg-[#181818] p-2`,children:[s.jsx("div",{className:"px-6 py-5",children:s.jsx(Ut,{title:r("count_stats")})}),s.jsx("button",{onClick:u,className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors mr-2","aria-label":r("reload_chart"),children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h5M20 20v-5h-5M4 4l1.5 1.5A9 9 0 0121.5 12M20 20l-1.5-1.5A9 9 0 012.5 12"})})})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 w-full gap-2 justify-center",children:[s.jsx(Qs,{series:o.series,labels:o.labels,colors:l}),s.jsx(Ge,{series:[{name:r("count"),data:o.series}],labels:o.labels,colors:l}),s.jsx(Js,{series:[{name:r("count"),data:o.series}],labels:o.labels,colors:l}),s.jsx(Zs,{series:o.series,labels:o.labels,colors:l})]})]})},nn=({rootDb:e})=>{const{user:t}=O(),{t:r}=z(),a=r(e==="memo"?"appMemo":"home_mng"),n=s.jsx("div",{className:`displayTitle text-center  ${x.text3Xl} ${x.textIndigo}`,children:a});return s.jsx(s.Fragment,{children:s.jsx(he,{title:n,className:"MemoMain mt-3 mb-5",children:s.jsxs("div",{className:"grid gird-cols-1 md:grid-cols-5 items-center gap-3",children:[t===null?s.jsx("p",{className:`${x.textRed500} ${x.textLgFontSemiboldLeft} ${x.mdColSpan3}`,children:r("login_used")}):s.jsx("p",{className:`${x.textGray600DarkZinc400} text-left ${x.mdColSpan3}`,dangerouslySetInnerHTML:{__html:r("memo_main_guide").replace(`
`,"<br/>")}}),s.jsx("div",{className:`w-full ${x.flexCenter} md:col-span-2`,children:s.jsx(Jt,{})})]})})})},rn=()=>{const e=D(),{user:t}=O(),r=Q(Zt),a=me(),n=ee(),{rootDb:o,memoId:i}=m.useMemo(()=>{const g=n.pathname,w=g.startsWith("/m/sheet")?"sheet":g.startsWith("/m")?"memo":g.startsWith("/home")?"home":g.startsWith("/bible")?"bible":"default",T=g.split("/").pop()||"";return{rootDb:w,memoId:T}},[n.pathname]),l=n?.state?.reflash===!0,c=ue(),d=g=>{a(Dt(g))},{memoDetailData:u,isLoading:f,onBookmark:y}=Ys(o,t,i,d),{openTabs:v,setOpenTabs:b,handleCloseTab:k,handleCloseAllTabs:p}=qs(r,o,t,i,u);return m.useEffect(()=>{t?.uid&&l&&c.invalidateQueries({queryKey:["memoDetail",o,t?.uid,i]})},[l,n.pathname,c,o,t?.uid,i]),m.useEffect(()=>{t===null&&n.pathname!=="/m"&&e("/m")},[t]),s.jsxs(s.Fragment,{children:[r&&s.jsx(Ks,{openTabs:v,setOpenTabs:b,handleCloseTab:k,handleCloseAllTabs:p,activeId:i}),s.jsx(Vs,{rootDb:o,user:t,memoId:i,memoDetailData:u,isLoading:f,onBookmark:y,handleCloseTab:k}),n.pathname==="/m"&&s.jsx(nn,{rootDb:o}),(o==="memo"||o==="sheet")&&s.jsx(Xs,{}),n.pathname==="/m"&&t?.uid===oe&&s.jsxs(s.Fragment,{children:[s.jsx(Us,{}),s.jsx("div",{className:`mt-5 ${x.card}`,children:s.jsx(sn,{rootDb:o})})]})]})},mn=Object.freeze(Object.defineProperty({__proto__:null,default:rn},Symbol.toStringTag,{value:"Module"}));export{mn as M,Bs as a,un as b,dn as f,cn as s,_s as u};
