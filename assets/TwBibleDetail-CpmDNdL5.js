import{j as t,H as E,r as x,z as S,A as L,c as D,u as R}from"./index-Dt7VXYqf.js";import{A as w}from"./AniButton-DWb6-Xm_.js";import{b as H}from"./bibleJson-BDv-vx3j.js";import{b as y}from"./bibleTxt-CDg_iih8.js";import{u as P,B as Y}from"./BibleBookmarkText-BFn7QO_h.js";import{a as q,T as z}from"./TwLinkItem-Dr2ZPTFJ.js";import{F as J}from"./Favorite-CtOIUa-q.js";import{T as M}from"./TwTitleItem-Ch8H4LIM.js";import{C as U}from"./CircularProgress-R-5QKs_l.js";import"./Button-BsNt_rqT.js";import"./useQuery-Br4dqMRy.js";import"./useBaseQuery-CpVwMbNe.js";import"./fireDatabase-CmU9MiSV.js";import"./LinkItem-DBZ7wTYg.js";import"./Typography-oI_uAwM7.js";import"./Grid-CxfOxZJO.js";import"./useTheme-miK55Se-.js";import"./Divider-DDEBS_qS.js";import"./dividerClasses-hl_ORNYY.js";import"./createSvgIcon-D5vtuee9.js";import"./useControlled-o3FGf_TX.js";import"./ownerWindow-DvT1GKkC.js";import"./isMuiElement-C0hwO7KM.js";const V=e=>{const o=e.dataText;if(e.data===void 0||e.data===null||o==null)return;const u=e.bibleId.split("_");return e.bibleId&&u.length!==3?t.jsx(t.Fragment,{}):t.jsxs(t.Fragment,{children:[t.jsx("h6",{className:"flex flex-col items-center mb-8 text-xl",children:e.nm}),o.map((s,c)=>{let f="text.primary";e.cd4+""===s.cd4&&(f="warning.main");const r=e.bookmark?.data?.filter(n=>n.cd1===s.cd1&&n.cd2===s.cd2&&n.cd3===s.cd3&&n.cd4===s.cd4&&n.bookmark==="Y");return r&&r.length>0&&(s.bookmark="Y"),t.jsxs("div",{className:"grid grid-cols-5 sm:grid-cols-6 md:grid-cols-10 lg:grid-cols-12 gap-4",id:`id_${c+1}`,children:[t.jsx("div",{className:"col-span-1",children:t.jsxs("div",{className:`flex ${f}`,children:[t.jsx(q,{className:"items-center text-top",onClick:()=>e.onBookmark(s),children:s.nm}),r&&r.length>0&&t.jsx(J,{className:"text-red-500"})]})}),t.jsx("div",{className:`col-span-4 sm:col-span-5 md:col-span-9 lg:col-span-11 ${f}`,children:t.jsx(E,{text:s.text})})]},c)})]})},W=e=>{const o=new Array;if(e.data===void 0||e.data===null)return;const u=e.bibleId.split("_");for(let s=1;s<=e.data.cd3;s++){const c={nm:`${e.data.nm2}${s}장`,key:e.data.id+"_"+s};o.push(c)}return u&&u.length===3?t.jsxs("h6",{className:"flex flex-col items-center text-xl",children:[e.nm," ",u[2]," 장"]}):t.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-6 md:grid-cols-10 lg:grid-cols-12 gap-4",children:o.map((s,c)=>t.jsx("div",{className:"col-span-1",children:t.jsx(z,{to:`/bible/${s.key}`,children:s.nm})},c))})},ht=()=>{const[e,o]=x.useState(null),[u,s]=x.useState(!0),{query:c,setBibleBookmark:f}=P(),r=x.useRef(),{bibleId:n}=S(),j=L(),[v,k]=x.useState(!1),[T,N]=x.useState(!1),{user:_}=D(),g=j?.state?.word,b=j?.state?.cd4,$=R();x.useEffect(()=>{if(n!==void 0){(async()=>{const a=await A(n,g);o(a),s(!1)})(),k(!1),N(!0);const i=n.split("_");if(r.current&&i.length===3){const a=r.current.cd3;k(Number(i[2])!==1),N(i[2]<a)}}},[n,g]),x.useEffect(()=>{b!==void 0&&setTimeout(()=>{I("","id_"+b)},1500)},[e,b]);const I=(l,i)=>{const a=document.getElementById(i);a&&a.scrollIntoView({block:"center",behavior:"smooth"})},F=l=>{_!==void 0&&f(l)},A=async(l,i)=>{if(l===""||l===void 0)return"";const a=l.split("_");if(a.length<1)return;a.length>1&&H.map(d=>{d.id===a[0]+"_"+a[1]&&(r.current=d)});const h=new Array;if(a.length===3){for(let d in y){if(!d.includes(l+"_"))continue;let m=y[d];m.id=d;let p=m.txt;if(i!==void 0){const C=new RegExp(i,"gi");p=p.replace(C,`<span class='lightext'>${i}</span>`)}m.nm=`${r.current.nm2}${a[2]}:${m.cd4}`,m.text=p,h.push(m)}return h.sort((d,m)=>d.cd4-m.cd4),h}};if(n==="")return t.jsx(t.Fragment,{});const B=l=>{let i=n.split("_");i[2]=Number(i[2])+l,$(`/bible/${i[0]}_${i[1]}_${i[2]}`)};return t.jsxs(t.Fragment,{children:[t.jsx("div",{id:"back-to-top-anchor"}),t.jsx(Y,{}),t.jsx(M,{children:r.current!==null&&r.current!==void 0&&r.current.nm!==null?r.current.text:""}),t.jsx(W,{data:r.current,bibleId:n}),t.jsx(V,{dataText:e,data:r.current,searchWord:g,bibleId:n,cd4:b,bookmark:c,onBookmark:F}),t.jsxs("div",{className:"p-0",children:[u&&t.jsx("div",{className:"flex flex-col items-center",children:t.jsx(U,{className:"mt-10"})}),n&&n.split("_").length===3?t.jsx("div",{className:"flex justify-between mt-10",children:t.jsxs("div",{className:"grid grid-cols-12 gap-2 w-full",children:[v?t.jsx("div",{className:T?"col-span-6":"col-span-12",children:t.jsx(w,{type:"button",variant:"outlined",onClick:()=>B(-1),fullWidth:!0,children:"< 이전"})}):"",T?t.jsx("div",{className:v?"col-span-6":"col-span-12",children:t.jsx(w,{type:"button",variant:"outlined",onClick:()=>B(1),fullWidth:!0,children:"다음 >"})}):""]})}):""]})]})};export{ht as TwBibleDetail,ht as default};
