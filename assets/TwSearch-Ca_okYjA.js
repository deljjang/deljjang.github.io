import{j as s,l as u,a1 as j,bD as p,bI as b,bJ as w,r as o,w as D,ar as L,W as N,N as T,z as W,bK as M,a4 as R,a5 as C,a6 as E,a7 as I}from"./index-BIFOmCYg.js";import{u as _}from"./useQuery-XWBuhXMY.js";import{a as q,T as F}from"./TailList-DKxj7gnm.js";import B from"./TwDetail-DOWML1cw.js";import"./useBaseQuery-CpWENLrR.js";import"./ComponentCard-BPTAcyVr.js";const K=({uid:a,state:e})=>{const r=_({queryKey:["blogMainSearch",e&&e?.s?e.s:""],queryFn:()=>q(e?.s,a===j?j:"")});return r.isLoading?s.jsx(u,{}):r.error?s.jsxs("div",{children:["Error: ",r.error.message]}):s.jsx(F,{query:r,index:"1",s:e&&e?.s?e.s:"",sx:{mt:2}})},P=({uid:a,state:e})=>{const[r,c]=p(b),[i,n]=p(w);return o.useEffect(()=>{i!==e.s&&(c(d=>({...d,[e.s]:r[e.s]===void 0?1:r[e.s]+1})),n(e.s))},[e]),s.jsx(z,{title:"Search",className:"mt-6",children:s.jsx("div",{className:"mt-5"})})},z=({title:a,children:e,className:r=""})=>{const c=D(),i=L(b),n=[];for(const t in i)n.push(t);const d=t=>{c("/tw/search",{state:{s:t}})};return s.jsxs("div",{className:`rounded-2xl border border-gray-200 
      bg-white dark:border-gray-800 dark:bg-white/[0.03] 
      overflow-hidden w-full ${r}
      mb-5
      `,children:[s.jsx("div",{className:"flex flex-col px-4 py-2",children:s.jsx("h3",{className:"text-base font-medium text-gray-800 dark:text-white/90",children:a})}),s.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-5 lg:grid-cols-7 ga-1 p-2 sm:p-4 border-t bg-stone-100 dark:bg-stone-950 border-gray-100 dark:border-gray-800 ",children:[n.map((t,h)=>s.jsx("div",{children:s.jsx(N,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>d(t),children:t})},h)),s.jsx("div",{children:e})]})]})};function H(){const a=T(),e=a.state,{user:r}=W(),c=o.useRef(e.s),[i,n]=o.useState(),[d]=M(),t=d.get("g"),[h,y]=o.useState(),[S,x]=o.useState(!0),g=t==="h"?"home":"memo";return o.useEffect(()=>{const v=async f=>{if(f!==""){const k=await I(g,r?.uid,f,c.current);y(k),x(!1)}};x(!0);const m=a.pathname.split("/"),l=m.length>2?m[m.length-1]:"";n(l),l!=null&&l!=="search"&&v(l)},[a.pathname]),s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",alignContent:"center",justifyContent:"center"},children:[s.jsxs(o.Suspense,{fallback:s.jsx(u,{}),children:[s.jsx(R,{children:s.jsx(C,{path:"/:memoId",element:s.jsx(B,{rootDb:g,isLoading:S,memoDetailData:h})})}),i==="search"?s.jsx(P,{uid:r?.uid,state:e}):"",r===null?s.jsx(u,{}):i==="search"&&e.s!==""&&s.jsx(o.Suspense,{fallback:s.jsx(u,{}),children:s.jsx(K,{index:"1",uid:r?.uid,state:e})})]}),s.jsx(E,{})]})}export{H as default};
