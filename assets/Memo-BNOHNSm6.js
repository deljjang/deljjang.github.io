const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-C1Fml-Dc.js","assets/index-Dt7VXYqf.js","assets/index-Os9tcPi3.css","assets/createSvgIcon-D5vtuee9.js","assets/useControlled-o3FGf_TX.js","assets/ownerWindow-DvT1GKkC.js","assets/isMuiElement-C0hwO7KM.js","assets/fireDatabase-CmU9MiSV.js","assets/fireStorage-B5Zm1Bav.js","assets/SinyDate-B9WZGY-t.js","assets/Grid-CxfOxZJO.js","assets/useTheme-miK55Se-.js","assets/index-BgnsSn_e.js","assets/index-Chjiymov.js","assets/Typography-oI_uAwM7.js","assets/Menu-C_zwoptI.js","assets/useSlotProps-CZ3zVRPA.js","assets/resolveComponentProps-C6BSudbh.js","assets/IconButton-C7ytqYkH.js","assets/TextField-r7CYg_So.js","assets/InputAdornment-A6LD4lcJ.js","assets/Popper-J_tQrZ44.js","assets/Button-BsNt_rqT.js","assets/Chip-BLRdmlCB.js","assets/index.esm-ieXCo7to.js","assets/TwButton-Bj-P6Cxy.js","assets/Loading-CpBM_CSX.js","assets/Container-CqPrq-mM.js","assets/styled-BO1vEgvD.js","assets/CircularProgress-R-5QKs_l.js","assets/Divider-DDEBS_qS.js","assets/dividerClasses-hl_ORNYY.js","assets/index-Cmdt2tIm.css","assets/MemoMain-CapvOzSH.js"])))=>i.map(i=>d[i]);
import{r as x,q as $e,e as ct,o as dt,a as Pe,f as Le,b as ut,u as Q,j as s,c as ce,T as ft,g as mt,m as je,_ as de,d as D,h as gt,i as Fe,k as Oe,l as _e,n as Ae,p as Ve,s as K,t as Be,v as se,w as J,x as xt,y as pt,B as P,z as We,A as ve,C as ht,H as bt,D as vt,E as xe,F as He,G as Ke,I as Nt,J as It,R as yt,K as le}from"./index-Dt7VXYqf.js";import{u as St}from"./useSuspenseQuery-0-u_4249.js";import{L as W}from"./Loading-CpBM_CSX.js";import{D as Ct,g as jt,S as wt,T as Tt}from"./index-gMrfcm31.js";import{g as kt,a as Dt,s as Et,b as Rt,c as Mt}from"./fireDatabase-CmU9MiSV.js";import{E as Ne,C as Ie,u as Ue,a as ze,F as $t,f as Pt,b as Lt,D as Ft,l as Ot,I as _t,c as we,d as Te,e as At}from"./index-C1Fml-Dc.js";import{D as O}from"./Divider-DDEBS_qS.js";import{L as Vt}from"./Link-CjezWYVR.js";import{T as H}from"./Typography-oI_uAwM7.js";import{T as Bt}from"./TwInput-BX21Zj77.js";import{T as ae}from"./TwButton-Bj-P6Cxy.js";import{T as Wt}from"./Footer-Di-yvOHI.js";import{L as re,a as Ht}from"./LinkItem-DBZ7wTYg.js";import{u as Kt}from"./useSlotProps-CZ3zVRPA.js";import{o as Ge}from"./ownerWindow-DvT1GKkC.js";import{u as Ut}from"./useTheme-miK55Se-.js";import{C as Ye}from"./Collapse-rH2Fj94r.js";import{F as zt}from"./Favorite-CtOIUa-q.js";import{A as B}from"./AniButton-DWb6-Xm_.js";import{M as Gt}from"./Menu-C_zwoptI.js";import{S as Yt}from"./SinyImageList-CtfMQ9xy.js";import{H as qe}from"./HtmlCode-BCJmz1S-.js";import{c as qt}from"./CodeText-CfZCie4t.js";import{s as Je}from"./commonUtil-MYcD_x1O.js";import{I as Jt}from"./IconButton-C7ytqYkH.js";import{C as Qt}from"./CircularProgress-R-5QKs_l.js";import{D as Xt}from"./datetime-BDx6lZXm.js";import{u as Zt}from"./index.esm-ieXCo7to.js";import{S as eo}from"./SinyDate-B9WZGY-t.js";import{S as to}from"./SinySelect-BEfOH-zk.js";import{T as ie}from"./TwBadge-C1g0YivL.js";import{T as oo}from"./TwCheckbox-CNYHbHig.js";import{T as no}from"./TwTextArea-BREZSKcB.js";import{T as so}from"./TextField-r7CYg_So.js";import{f as lo}from"./fireMemoDetail-DqH7PJll.js";import"./useBaseQuery-CpVwMbNe.js";import"./Container-CqPrq-mM.js";import"./styled-BO1vEgvD.js";import"./createSvgIcon-D5vtuee9.js";import"./useControlled-o3FGf_TX.js";import"./isMuiElement-C0hwO7KM.js";import"./fireStorage-B5Zm1Bav.js";import"./dividerClasses-hl_ORNYY.js";import"./TwLinkItem-Dr2ZPTFJ.js";import"./resolveComponentProps-C6BSudbh.js";import"./Button-BsNt_rqT.js";import"./index-Chjiymov.js";import"./ImageListItem-BW1LUoz7.js";import"./copy-B1IZbYjx.js";import"./ComponentCard-sn_pQAOK.js";import"./TwRadio-jBxahmfJ.js";import"./toPropertyKey-DCwh5dYN.js";import"./Grid-CxfOxZJO.js";import"./index-BgnsSn_e.js";import"./InputAdornment-A6LD4lcJ.js";import"./Popper-J_tQrZ44.js";import"./Chip-BLRdmlCB.js";import"./MenuItem-DfmPHJYb.js";const ro=e=>{const[t,o]=x.useState([]),n=()=>{const l=$e(Pe(Le,`memo_txt/${e}`),dt("bookmark"),ct("Y"));ut(l,r=>{if(!r.exists())return;const f=r.val(),i=[];for(let u in f){const c=f[u];c.key=u,i.push(c)}i.sort((u,c)=>u.title>c.title?1:-1),o(i)})};return x.useEffect(()=>{n()},[e]),t};function io({initTreeData:e,uid:t}){const[o,n]=x.useState(),l=i=>n(i),r=Q();if(x.useEffect(()=>{(async()=>{const u=[];if(e)for(const c of e){const d=c.fullIndex.split("/");let m="root";if(d.length>1)for(let a=0;a<d.length;a++){const g=d[a];if(g!=="sub"&&d.length>a){const h=await kt(`memo_txt/${t}/${g}/title`),v={id:g,text:h,droppable:!1,parent:m};m=g,u.filter(N=>N.id===g).length===0&&u.push(v)}}const b={id:c.key,text:c.title,droppable:!1,parent:m};u.filter(a=>a.id===b.id).length===0&&u.push(b)}for(const c of u){const d=c.id;c.cnt=u.filter(m=>m.parent===d).length}n(u)})()},[e]),o==null||o.length===0)return s.jsx(W,{});const f=i=>{console.log("node",i),r(`/memo/${i.id}`)};return s.jsx(Ct,{backend:wt,options:jt(),children:s.jsx(Tt,{tree:o,rootId:"root",onDrop:l,render:(i,{depth:u,isOpen:c,onToggle:d})=>s.jsxs("div",{className:"w-60 flex items-center justify-between hover:bg-gray-300 dark:hover:bg-gray-700 rounded-sm ",style:{paddingLeft:u*20+(i.cnt===0?5:0)},children:[s.jsxs("div",{className:"flex items-center",children:[i.cnt>0&&s.jsx("div",{onClick:d,children:c?s.jsx(Ne,{}):s.jsx(Ie,{})}),s.jsx("div",{className:"cursor-pointer",onClick:()=>f(i),children:i.text})]}),i.cnt>0&&s.jsxs("div",{className:"text-gray-500 text-sm",children:["(",i.cnt,")"]})]})})})}function ao(e){const{user:t}=ce(),o=Q(),n=ro(t?.uid);return t===void 0?s.jsx(s.Fragment,{}):s.jsxs("div",{className:"tail-bookmark justify-items-center",sx:{display:"flex",alignItems:"center",flexDirection:"column",width:"100%"},children:[s.jsx(O,{}),s.jsx(ft,{children:"BookMark"}),s.jsx("div",{className:`tail-bookmark 
        grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-1 
        justify-items-center 
        w-full`,children:n&&n.map((l,r)=>s.jsx("div",{children:s.jsx(Vt,{component:"button",variant:"body",onClick:()=>{e.onSelected(l.key),o(`/memo/${l.key}`)},children:s.jsx(H,{variant:"body1",children:l.title})})},r))}),s.jsx(O,{}),s.jsx(io,{initTreeData:n,uid:t?.uid})]})}const co=e=>{const t=x.useRef(null);function o(){e.onSearchDataBtn(t.current.value)}function n(){return e.onNewMemoBtn(),!1}function l(r){r.which===13&&o()}return s.jsxs(s.Fragment,{children:[s.jsx(Bt,{id:"edSearch",type:"edSearch",name:"edSearch",inputRef:t,placeholder:"Enter Search...",fullWidth:!0,sx:{pt:0,pl:2,pr:2,pb:1},onKeyDownCapture:l}),s.jsxs("div",{className:"flex justify-center",children:[s.jsx(ae,{variant:"outlined",color:"success",className:"m-1 p-1",onClick:n,children:"새글"}),s.jsx(ae,{variant:"outlined",color:"brand",className:"m-1 p-1",onClick:o,children:"조회"})]})]})};async function uo(e,t,o=""){if(t==null||t==="")return"";let n=o===""?`${e}/${t}`:`${e}_txt/${t}`;e==="home"&&(n="home_txt");const l=$e(Pe(Le,n)),r=await mt(l);if(!r.exists())return console.log("getTreeData.null"),null;if(!r.exists())return console.log("getTreeData.exists"),null;const f=r.val(),i=[],u={};e==="home"&&(je.map(c=>{i.push({title:c.label,id:c.id,sub:[]})}),je.map(c=>{u[c.id]=[]}));for(const c in f){const d=f[c];d.up===void 0?(d.id=c,d.fullIndex=c):(d.id=d.up,d.fullIndex=d.up),e==="home"?d.gbn!==void 0&&u[d.gbn].push(d):o===""||o===void 0?(d.sub!==null&&(d.children=Qe(d,d.up)),i.push(d)):(d.id=c,(d.memo+"").toLowerCase().indexOf(o.toLowerCase())>-1&&i.push(d))}return e==="home"?Object.values(u).map((c,d)=>{c.sort((m,b)=>m.title>b.title?1:-1),i[d].sub=c}):i.sort((c,d)=>c.title>d.title?1:-1),i}function Qe(e,t,o,n){const l=[];if(console.log("dbChildren.data=",e.id,e.title,e),e===void 0||e.sub===void 0)return l;for(let r in e.sub){let f=e.sub[r];f.id=r,f.key=r}return Object.values(e.sub).sort((r,f)=>f.title-r.title).map(r=>{r.id=r.key,r.fullIndex=t+"/sub/"+r.key,r.sub!==null&&(r.children=Qe(r,r.fullIndex)),l.push(r)}),l}const fo=({className:e="",children:t})=>s.jsx("h4",{className:`mb-2 text-lg font-semibold text-center text-gray-800 dark:text-white/90 
      ${e}}
      `,children:t}),mo=["element"];function go(e,t){for(let o=0;o<e.length;o+=1)if(t(e[o]))return o;return-1}function xo(e,t){let o=0,n=e.length-1;for(;o<=n;){const l=Math.floor((o+n)/2);if(e[l].element===t)return l;e[l].element.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING?n=l-1:o=l+1}return o}const Xe=x.createContext({});function po(e){const t=x.useRef(null);return x.useEffect(()=>{t.current=e},[e]),t.current}const ke=()=>{};function ho(e){const[,t]=x.useState(),{registerDescendant:o=ke,unregisterDescendant:n=ke,descendants:l=[],parentId:r=null}=x.useContext(Xe),f=go(l,c=>c.element===e.element),i=po(l),u=l.some((c,d)=>i&&i[d]&&i[d].element!==c.element);return gt(()=>{if(e.element)return o(D({},e,{index:f})),()=>{n(e.element)};t({})},[o,n,f,u,e]),{parentId:r,index:f}}function Ze(e){const{children:t,id:o}=e,[n,l]=x.useState([]),r=x.useCallback(u=>{let{element:c}=u,d=de(u,mo);l(m=>{if(m.length===0)return[D({},d,{element:c,index:0})];const b=xo(m,c);let p;if(m[b]&&m[b].element===c)p=m;else{const a=D({},d,{element:c,index:b});p=m.slice(),p.splice(b,0,a)}return p.forEach((a,g)=>{a.index=g}),p})},[]),f=x.useCallback(u=>{l(c=>c.filter(d=>u!==d.element))},[]),i=x.useMemo(()=>({descendants:n,registerDescendant:r,unregisterDescendant:f,parentId:o}),[n,r,f,o]);return s.jsx(Xe.Provider,{value:i,children:t})}const et={instance:null,multiSelect:!1,disabledItemsFocusable:!1,treeId:void 0,icons:{defaultCollapseIcon:null,defaultExpandIcon:null,defaultParentIcon:null,defaultEndIcon:null}},tt=x.createContext(et),ot=()=>x.useContext(tt);function bo(e){const{instance:t,multiSelect:o}=ot(),n=t?t.isNodeExpandable(e):!1,l=t?t.isNodeExpanded(e):!1,r=t?t.isNodeFocused(e):!1,f=t?t.isNodeSelected(e):!1,i=t?t.isNodeDisabled(e):!1;return{disabled:i,expanded:l,selected:f,focused:r,handleExpansion:m=>{if(t&&!i){r||t.focusNode(m,e);const b=o&&(m.shiftKey||m.ctrlKey||m.metaKey);n&&!(b&&t.isNodeExpanded(e))&&t.toggleNodeExpansion(m,e)}},handleSelection:m=>{t&&!i&&(r||t.focusNode(m,e),o&&(m.shiftKey||m.ctrlKey||m.metaKey)?m.shiftKey?t.selectRange(m,{end:e}):t.selectNode(m,e,!0):t.selectNode(m,e))},preventSelection:m=>{(m.shiftKey||m.ctrlKey||m.metaKey||i)&&m.preventDefault()}}}const vo=["classes","className","displayIcon","expansionIcon","icon","label","nodeId","onClick","onMouseDown"],nt=x.forwardRef(function(t,o){const{classes:n,className:l,displayIcon:r,expansionIcon:f,icon:i,label:u,nodeId:c,onClick:d,onMouseDown:m}=t,b=de(t,vo),{disabled:p,expanded:a,selected:g,focused:h,handleExpansion:v,handleSelection:y,preventSelection:N}=bo(c),I=i||f||r,C=T=>{N(T),m&&m(T)},j=T=>{v(T),y(T),d&&d(T)};return s.jsxs("div",D({},b,{className:Fe(l,n.root,a&&n.expanded,g&&n.selected,h&&n.focused,p&&n.disabled),onClick:j,onMouseDown:C,ref:o,children:[s.jsx("div",{className:n.iconContainer,children:I}),s.jsx("div",{className:n.label,children:u})]}))});function No(e){return _e("MuiTreeItem",e)}const E=Oe("MuiTreeItem",["root","group","content","expanded","selected","focused","disabled","iconContainer","label"]),Io=["children","className","collapseIcon","ContentComponent","ContentProps","endIcon","expandIcon","disabled","icon","id","label","nodeId","onClick","onMouseDown","TransitionComponent","TransitionProps"],yo=e=>{const{classes:t}=e;return Be({root:["root"],content:["content"],expanded:["expanded"],selected:["selected"],focused:["focused"],disabled:["disabled"],iconContainer:["iconContainer"],label:["label"],group:["group"]},No,t)},So=K("li",{name:"MuiTreeItem",slot:"Root",overridesResolver:(e,t)=>t.root})({listStyle:"none",margin:0,padding:0,outline:0}),Co=K(nt,{name:"MuiTreeItem",slot:"Content",overridesResolver:(e,t)=>[t.content,t.iconContainer&&{[`& .${E.iconContainer}`]:t.iconContainer},t.label&&{[`& .${E.label}`]:t.label}]})(({theme:e})=>({padding:"0 8px",width:"100%",boxSizing:"border-box",display:"flex",alignItems:"center",cursor:"pointer",WebkitTapHighlightColor:"transparent","&:hover":{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${E.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity,backgroundColor:"transparent"},[`&.${E.focused}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${E.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:se(e.palette.primary.main,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:se(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:se(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${E.focused}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:se(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`& .${E.iconContainer}`]:{marginRight:4,width:15,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},[`& .${E.label}`]:D({paddingLeft:4,width:"100%",boxSizing:"border-box",minWidth:0,position:"relative"},e.typography.body1)})),jo=K(Ye,{name:"MuiTreeItem",slot:"Group",overridesResolver:(e,t)=>t.group})({margin:0,padding:0,marginLeft:17}),st=x.forwardRef(function(t,o){const n=Ae({props:t,name:"MuiTreeItem"}),{children:l,className:r,collapseIcon:f,ContentComponent:i=nt,ContentProps:u,endIcon:c,expandIcon:d,disabled:m,icon:b,id:p,label:a,nodeId:g,onClick:h,onMouseDown:v,TransitionComponent:y=Ye,TransitionProps:N}=n,I=de(n,Io),{icons:C,multiSelect:j,disabledItemsFocusable:T,treeId:R,instance:k}=ot();let M;p!=null?M=p:R&&g&&(M=`${R}-${g}`);const[X,ue]=x.useState(null),Z=x.useRef(null),fe=Ve(ue,o),me=x.useMemo(()=>({element:X,id:g}),[g,X]),{index:z,parentId:ee}=ho(me),F=!!(Array.isArray(l)?l.length:l),_=k?k.isNodeExpanded(g):!1,te=k?k.isNodeFocused(g):!1,G=k?k.isNodeSelected(g):!1,L=k?k.isNodeDisabled(g):!1,S=D({},n,{expanded:_,focused:te,selected:G,disabled:L}),w=yo(S);let A,Y;F&&(_?Y=f||C.defaultCollapseIcon:Y=d||C.defaultExpandIcon),F?A=C.defaultParentIcon:A=c||C.defaultEndIcon,x.useEffect(()=>{if(k&&z!==-1)return k.updateNode({id:g,idAttribute:M,index:z,parentId:ee,expandable:F,disabled:m}),()=>k.removeNode(g)},[k,ee,z,g,F,m,M]),x.useEffect(()=>{if(k&&a){var $,ne;return k.mapFirstChar(g,(($=(ne=Z.current)==null?void 0:ne.textContent)!=null?$:"").substring(0,1).toLowerCase())}},[k,g,a]);let V;j?V=G:G&&(V=!0);function oe($){if($.target===$.currentTarget){let ge;typeof $.target.getRootNode=="function"?ge=$.target.getRootNode():ge=Ge($.target),ge.getElementById(R).focus({preventScroll:!0})}const ne=!T&&L;k&&!te&&$.currentTarget===$.target&&!ne&&k.focusNode($,g)}return s.jsxs(So,D({className:Fe(w.root,r),role:"treeitem","aria-expanded":F?_:void 0,"aria-selected":V,"aria-disabled":L||void 0,id:M,tabIndex:-1},I,{ownerState:S,onFocus:oe,ref:fe,children:[s.jsx(Co,D({as:i,ref:Z,classes:{root:w.content,expanded:w.expanded,selected:w.selected,focused:w.focused,disabled:w.disabled,iconContainer:w.iconContainer,label:w.label},label:a,nodeId:g,onClick:h,onMouseDown:v,icon:b,expansionIcon:Y,displayIcon:A,ownerState:S},u)),l&&s.jsx(Ze,{id:g,children:s.jsx(jo,D({as:y,unmountOnExit:!0,className:w.group,in:_,component:"ul",role:"group"},N,{children:l}))})]}))});function wo(e){return _e("MuiTreeView",e)}Oe("MuiTreeView",["root"]);const To=(e,t)=>{const o=x.useRef({}),[n,l]=x.useState(()=>{const f={};return e.forEach(i=>{i.models&&Object.entries(i.models).forEach(([u,c])=>{o.current[u]={controlledProp:c.controlledProp,defaultProp:c.defaultProp,isControlled:t[c.controlledProp]!==void 0},f[u]=t[c.defaultProp]})}),f});return Object.fromEntries(Object.entries(o.current).map(([f,i])=>{const u=i.isControlled?t[i.controlledProp]:n[f];return[f,{value:u,setValue:c=>{i.isControlled||l(d=>D({},d,{[f]:c}))}}]}))};class ko{constructor(){this.maxListeners=20,this.warnOnce=!1,this.events={}}on(t,o,n={}){let l=this.events[t];l||(l={highPriority:new Map,regular:new Map},this.events[t]=l),n.isFirst?l.highPriority.set(o,!0):l.regular.set(o,!0)}removeListener(t,o){this.events[t]&&(this.events[t].regular.delete(o),this.events[t].highPriority.delete(o))}removeAllListeners(){this.events={}}emit(t,...o){const n=this.events[t];if(!n)return;const l=Array.from(n.highPriority.keys()),r=Array.from(n.regular.keys());for(let f=l.length-1;f>=0;f-=1){const i=l[f];n.highPriority.has(i)&&i.apply(this,o)}for(let f=0;f<r.length;f+=1){const i=r[f];n.regular.has(i)&&i.apply(this,o)}}once(t,o){const n=this;this.on(t,function l(...r){n.removeListener(t,l),o.apply(n,r)})}}const pe=(e,t)=>{const o=e.getNode(t),n=e.getNavigableChildrenIds(o.parentId),l=n.indexOf(t);if(l===0)return o.parentId;let r=n[l-1];for(;e.isNodeExpanded(r)&&e.getNavigableChildrenIds(r).length>0;)r=e.getNavigableChildrenIds(r).pop();return r},q=(e,t)=>{if(e.isNodeExpanded(t)&&e.getNavigableChildrenIds(t).length>0)return e.getNavigableChildrenIds(t)[0];let o=e.getNode(t);for(;o!=null;){const n=e.getNavigableChildrenIds(o.parentId),l=n[n.indexOf(o.id)+1];if(l)return l;o=e.getNode(o.parentId)}return null},he=e=>{let t=e.getNavigableChildrenIds(null).pop();for(;e.isNodeExpanded(t);)t=e.getNavigableChildrenIds(t).pop();return t},be=e=>e.getNavigableChildrenIds(null)[0],U=(e,t)=>{Object.assign(e,t)},Do=e=>e.isPropagationStopped!==void 0,Eo=({instance:e})=>{const[t]=x.useState(()=>new ko),o=x.useCallback((...l)=>{const[r,f,i={}]=l;i.defaultMuiPrevented=!1,!(Do(i)&&i.isPropagationStopped())&&t.emit(r,f,i)},[t]),n=x.useCallback((l,r)=>(t.on(l,r),()=>{t.removeListener(l,r)}),[t]);U(e,{$$publishEvent:o,$$subscribeEvent:n})},Ro=[Eo],Mo=e=>{const t=[...Ro,...e.plugins],o=t.reduce((a,g)=>g.getDefaultizedParams?g.getDefaultizedParams(a):a,e),n=To(t,o),r=x.useRef({}).current,f=x.useRef(null),i=Ve(f,e.rootRef),[u,c]=x.useState(()=>{const a={};return t.forEach(g=>{g.getInitialState&&Object.assign(a,g.getInitialState(o))}),a}),d=[];let m=et;const b=a=>{const g=a({instance:r,params:o,state:u,setState:c,rootRef:f,models:n})||{};g.getRootProps&&d.push(g.getRootProps),g.contextValue&&(m=g.contextValue)};return t.forEach(b),{getRootProps:(a={})=>{const g=D({role:"tree",tabIndex:0},a,{ref:i});return d.forEach(h=>{Object.assign(g,h(a))}),g},rootRef:i,contextValue:m}};function $o(e){const{value:t,children:o}=e;return s.jsx(tt.Provider,{value:t,children:s.jsx(Ze,{children:o})})}const Po=(e,t,o)=>{e.$$publishEvent(t,o)},Lo=({instance:e,params:t})=>{const o=x.useRef({}),n=x.useCallback(c=>o.current[c],[]),l=x.useCallback(c=>{o.current[c.id]=c},[]),r=x.useCallback(c=>{const d=D({},o.current);delete d[c],o.current=d,Po(e,"removeNode",{id:c})},[e]),f=x.useCallback(c=>{if(c==null)return!1;let d=e.getNode(c);if(!d)return!1;if(d.disabled)return!0;for(;d.parentId!=null;)if(d=e.getNode(d.parentId),d.disabled)return!0;return!1},[e]),i=J(c=>Object.values(o.current).filter(d=>d.parentId===c).sort((d,m)=>d.index-m.index).map(d=>d.id));U(e,{getNode:n,updateNode:l,removeNode:r,getChildrenIds:i,getNavigableChildrenIds:c=>{let d=e.getChildrenIds(c);return t.disabledItemsFocusable||(d=d.filter(m=>!e.isNodeDisabled(m))),d},isNodeDisabled:f})},ye=({instance:e,params:t,models:o})=>{const n=x.useCallback(i=>Array.isArray(o.expanded.value)?o.expanded.value.indexOf(i)!==-1:!1,[o.expanded.value]),l=x.useCallback(i=>{var u;return!!((u=e.getNode(i))!=null&&u.expandable)},[e]),r=J((i,u)=>{if(u==null)return;let c;o.expanded.value.indexOf(u)!==-1?c=o.expanded.value.filter(d=>d!==u):c=[u].concat(o.expanded.value),t.onNodeToggle&&t.onNodeToggle(i,c),o.expanded.setValue(c)});U(e,{isNodeExpanded:n,isNodeExpandable:l,toggleNodeExpansion:r,expandAllSiblings:(i,u)=>{const c=e.getNode(u),m=e.getChildrenIds(c.parentId).filter(p=>e.isNodeExpandable(p)&&!e.isNodeExpanded(p)),b=o.expanded.value.concat(m);m.length>0&&(o.expanded.setValue(b),t.onNodeToggle&&t.onNodeToggle(i,b))}})};ye.models={expanded:{controlledProp:"expanded",defaultProp:"defaultExpanded"}};const Fo=[];ye.getDefaultizedParams=e=>{var t;return D({},e,{defaultExpanded:(t=e.defaultExpanded)!=null?t:Fo})};const Oo=(e,t,o)=>{if(t===o)return[t,o];const n=e.getNode(t),l=e.getNode(o);if(n.parentId===l.id||l.parentId===n.id)return l.parentId===n.id?[n.id,l.id]:[l.id,n.id];const r=[n.id],f=[l.id];let i=n.parentId,u=l.parentId,c=f.indexOf(i)!==-1,d=r.indexOf(u)!==-1,m=!0,b=!0;for(;!d&&!c;)m&&(r.push(i),c=f.indexOf(i)!==-1,m=i!==null,!c&&m&&(i=e.getNode(i).parentId)),b&&!c&&(f.push(u),d=r.indexOf(u)!==-1,b=u!==null,!d&&b&&(u=e.getNode(u).parentId));const p=c?i:u,a=e.getChildrenIds(p),g=r[r.indexOf(p)-1],h=f[f.indexOf(p)-1];return a.indexOf(g)<a.indexOf(h)?[t,o]:[o,t]},Se=({instance:e,params:t,models:o})=>{const n=x.useRef(null),l=x.useRef(!1),r=x.useRef([]),f=a=>Array.isArray(o.selected.value)?o.selected.value.indexOf(a)!==-1:o.selected.value===a,i=(a,g,h=!1)=>{if(!t.disableSelection){if(h){if(Array.isArray(o.selected.value)){let v;o.selected.value.indexOf(g)!==-1?v=o.selected.value.filter(y=>y!==g):v=[g].concat(o.selected.value),t.onNodeSelect&&t.onNodeSelect(a,v),o.selected.setValue(v)}}else{const v=t.multiSelect?[g]:g;t.onNodeSelect&&t.onNodeSelect(a,v),o.selected.setValue(v)}n.current=g,l.current=!1,r.current=[]}},u=(a,g)=>{const[h,v]=Oo(e,a,g),y=[h];let N=h;for(;N!==v;)N=q(e,N),y.push(N);return y},c=(a,g)=>{let h=o.selected.value.slice();const{start:v,next:y,current:N}=g;!y||!N||(r.current.indexOf(N)===-1&&(r.current=[]),l.current?r.current.indexOf(y)!==-1?(h=h.filter(I=>I===v||I!==N),r.current=r.current.filter(I=>I===v||I!==N)):(h.push(y),r.current.push(y)):(h.push(y),r.current.push(N,y)),t.onNodeSelect&&t.onNodeSelect(a,h),o.selected.setValue(h))},d=(a,g)=>{let h=o.selected.value.slice();const{start:v,end:y}=g;l.current&&(h=h.filter(C=>r.current.indexOf(C)===-1));let N=u(v,y);N=N.filter(C=>!e.isNodeDisabled(C)),r.current=N;let I=h.concat(N);I=I.filter((C,j)=>I.indexOf(C)===j),t.onNodeSelect&&t.onNodeSelect(a,I),o.selected.setValue(I)};return U(e,{isNodeSelected:f,selectNode:i,selectRange:(a,g,h=!1)=>{if(t.disableSelection)return;const{start:v=n.current,end:y,current:N}=g;h?c(a,{start:v,next:y,current:N}):v!=null&&y!=null&&d(a,{start:v,end:y}),l.current=!0},rangeSelectToLast:(a,g)=>{n.current||(n.current=g);const h=l.current?n.current:g;e.selectRange(a,{start:h,end:he(e)})},rangeSelectToFirst:(a,g)=>{n.current||(n.current=g);const h=l.current?n.current:g;e.selectRange(a,{start:h,end:be(e)})}}),{getRootProps:()=>({"aria-multiselectable":t.multiSelect})}};Se.models={selected:{controlledProp:"selected",defaultProp:"defaultSelected"}};const _o=[];Se.getDefaultizedParams=e=>{var t,o,n;return D({},e,{disableSelection:(t=e.disableSelection)!=null?t:!1,multiSelect:(o=e.multiSelect)!=null?o:!1,defaultSelected:(n=e.defaultSelected)!=null?n:e.multiSelect?_o:null})};const De=1e3;class Ao{constructor(t=De){this.timeouts=new Map,this.cleanupTimeout=De,this.cleanupTimeout=t}register(t,o,n){this.timeouts||(this.timeouts=new Map);const l=setTimeout(()=>{typeof o=="function"&&o(),this.timeouts.delete(n.cleanupToken)},this.cleanupTimeout);this.timeouts.set(n.cleanupToken,l)}unregister(t){const o=this.timeouts.get(t.cleanupToken);o&&(this.timeouts.delete(t.cleanupToken),clearTimeout(o))}reset(){this.timeouts&&(this.timeouts.forEach((t,o)=>{this.unregister({cleanupToken:o})}),this.timeouts=void 0)}}class Vo{constructor(){this.registry=new FinalizationRegistry(t=>{typeof t=="function"&&t()})}register(t,o,n){this.registry.register(t,o,n)}unregister(t){this.registry.unregister(t)}reset(){}}class Bo{}function Wo(e){let t=0;return function(n,l,r){e.registry===null&&(e.registry=typeof FinalizationRegistry<"u"?new Vo:new Ao);const[f]=x.useState(new Bo),i=x.useRef(null),u=x.useRef();u.current=r;const c=x.useRef(null);if(!i.current&&u.current){const d=(m,b)=>{if(!b.defaultMuiPrevented){var p;(p=u.current)==null||p.call(u,m,b)}};i.current=n.$$subscribeEvent(l,d),t+=1,c.current={cleanupToken:t},e.registry.register(f,()=>{var m;(m=i.current)==null||m.call(i),i.current=null,c.current=null},c.current)}else!u.current&&i.current&&(i.current(),i.current=null,c.current&&(e.registry.unregister(c.current),c.current=null));x.useEffect(()=>{if(!i.current&&u.current){const d=(m,b)=>{if(!b.defaultMuiPrevented){var p;(p=u.current)==null||p.call(u,m,b)}};i.current=n.$$subscribeEvent(l,d)}return c.current&&e.registry&&(e.registry.unregister(c.current),c.current=null),()=>{var d;(d=i.current)==null||d.call(i),i.current=null}},[n,l])}}const Ho={registry:null},Ko=Wo(Ho),Ce=({instance:e,params:t,state:o,setState:n,models:l,rootRef:r})=>{const f=J(p=>{const a=typeof p=="function"?p(o.focusedNodeId):p;n(g=>D({},g,{focusedNodeId:a}))}),i=x.useCallback(p=>o.focusedNodeId===p,[o.focusedNodeId]),u=J((p,a)=>{a&&(f(a),t.onNodeFocus&&t.onNodeFocus(p,a))});U(e,{isNodeFocused:i,focusNode:u}),Ko(e,"removeNode",({id:p})=>{f(a=>a===p&&r.current===Ge(r.current).activeElement?e.getChildrenIds(null)[0]:a)});const c=p=>a=>{var g;if((g=p.onFocus)==null||g.call(p,a),a.target===a.currentTarget){const h=y=>{const N=e.getNode(y);return N&&(N.parentId==null||e.isNodeExpanded(N.parentId))};let v;Array.isArray(l.selected.value)?v=l.selected.value.find(h):l.selected.value!=null&&h(l.selected.value)&&(v=l.selected.value),v==null&&(v=e.getNavigableChildrenIds(null)[0]),e.focusNode(a,v)}},d=p=>a=>{var g;(g=p.onBlur)==null||g.call(p,a),f(null)},m=e.getNode(o.focusedNodeId),b=m?m.idAttribute:null;return{getRootProps:p=>({onFocus:c(p),onBlur:d(p),"aria-activedescendant":b??void 0})}};Ce.getInitialState=()=>({focusedNodeId:null});Ce.getDefaultizedParams=e=>{var t;return D({},e,{disabledItemsFocusable:(t=e.disabledItemsFocusable)!=null?t:!1})};function Uo(e){return e&&e.length===1&&e.match(/\S/)}function Ee(e,t,o){for(let n=t;n<e.length;n+=1)if(o===e[n])return n;return-1}const zo=({instance:e,params:t,state:o})=>{const l=Ut().direction==="rtl",r=x.useRef({}),f=J((p,a)=>(r.current[p]=a,()=>{const g=D({},r.current);delete g[p],r.current=g}));U(e,{mapFirstChar:f});const i=p=>(o.focusedNodeId!=null&&e.isNodeExpandable(o.focusedNodeId)&&(e.isNodeExpanded(o.focusedNodeId)?e.focusNode(p,q(e,o.focusedNodeId)):e.isNodeDisabled(o.focusedNodeId)||e.toggleNodeExpansion(p,o.focusedNodeId)),!0),u=p=>{if(o.focusedNodeId==null)return!1;if(e.isNodeExpanded(o.focusedNodeId)&&!e.isNodeDisabled(o.focusedNodeId))return e.toggleNodeExpansion(p,o.focusedNodeId),!0;const a=e.getNode(o.focusedNodeId).parentId;return a?(e.focusNode(p,a),!0):!1},c=(p,a,g)=>{let h,v;const y=g.toLowerCase(),N=[],I=[];Object.keys(r.current).forEach(C=>{const j=e.getNode(C),T=j.parentId?e.isNodeExpanded(j.parentId):!0,R=t.disabledItemsFocusable?!1:e.isNodeDisabled(C);T&&!R&&(N.push(C),I.push(r.current[C]))}),h=N.indexOf(a)+1,h>=N.length&&(h=0),v=Ee(I,h,y),v===-1&&(v=Ee(I,0,y)),v>-1&&e.focusNode(p,N[v])},d=(p,a)=>{e.isNodeDisabled(q(e,a))||e.selectRange(p,{end:q(e,a),current:a},!0)},m=(p,a)=>{e.isNodeDisabled(pe(e,a))||e.selectRange(p,{end:pe(e,a),current:a},!0)},b=p=>a=>{var g;(g=p.onKeyDown)==null||g.call(p,a);let h=!1;const v=a.key;if(a.altKey||a.currentTarget!==a.target||o.focusedNodeId==null)return;const y=a.ctrlKey||a.metaKey;switch(v){case" ":!t.disableSelection&&!e.isNodeDisabled(o.focusedNodeId)&&(h=!0,t.multiSelect&&a.shiftKey?e.selectRange(a,{end:o.focusedNodeId}):t.multiSelect?e.selectNode(a,o.focusedNodeId,!0):e.selectNode(a,o.focusedNodeId)),a.stopPropagation();break;case"Enter":e.isNodeDisabled(o.focusedNodeId)||(e.isNodeExpandable(o.focusedNodeId)?(e.toggleNodeExpansion(a,o.focusedNodeId),h=!0):t.disableSelection||(h=!0,t.multiSelect?e.selectNode(a,o.focusedNodeId,!0):e.selectNode(a,o.focusedNodeId))),a.stopPropagation();break;case"ArrowDown":t.multiSelect&&a.shiftKey&&!t.disableSelection&&d(a,o.focusedNodeId),e.focusNode(a,q(e,o.focusedNodeId)),h=!0;break;case"ArrowUp":t.multiSelect&&a.shiftKey&&!t.disableSelection&&m(a,o.focusedNodeId),e.focusNode(a,pe(e,o.focusedNodeId)),h=!0;break;case"ArrowRight":l?h=u(a):h=i(a);break;case"ArrowLeft":l?h=i(a):h=u(a);break;case"Home":t.multiSelect&&y&&a.shiftKey&&!t.disableSelection&&!e.isNodeDisabled(o.focusedNodeId)&&e.rangeSelectToFirst(a,o.focusedNodeId),e.focusNode(a,be(e)),h=!0;break;case"End":t.multiSelect&&y&&a.shiftKey&&!t.disableSelection&&!e.isNodeDisabled(o.focusedNodeId)&&e.rangeSelectToLast(a,o.focusedNodeId),e.focusNode(a,he(e)),h=!0;break;default:v==="*"?(e.expandAllSiblings(a,o.focusedNodeId),h=!0):t.multiSelect&&y&&v.toLowerCase()==="a"&&!t.disableSelection?(e.selectRange(a,{start:be(e),end:he(e)}),h=!0):!y&&!a.shiftKey&&Uo(v)&&(c(a,o.focusedNodeId,v),h=!0)}h&&(a.preventDefault(),a.stopPropagation())};return{getRootProps:p=>({onKeyDown:b(p)})}},Go=({instance:e,params:t})=>{const o=xt(t.id);return{getRootProps:()=>({id:o}),contextValue:{treeId:o,instance:e,multiSelect:t.multiSelect,disabledItemsFocusable:t.disabledItemsFocusable,icons:{defaultCollapseIcon:t.defaultCollapseIcon,defaultEndIcon:t.defaultEndIcon,defaultExpandIcon:t.defaultExpandIcon,defaultParentIcon:t.defaultParentIcon}}}},Yo=[Lo,ye,Se,Ce,zo,Go],qo=["disabledItemsFocusable","expanded","defaultExpanded","onNodeToggle","onNodeFocus","disableSelection","defaultSelected","selected","multiSelect","onNodeSelect","id","defaultCollapseIcon","defaultEndIcon","defaultExpandIcon","defaultParentIcon","children"],Jo=e=>{const{classes:t}=e;return Be({root:["root"]},wo,t)},Re=K("ul",{name:"MuiTreeView",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:0,margin:0,listStyle:"none",outline:0}),lt=x.forwardRef(function(t,o){const n=Ae({props:t,name:"MuiTreeView"}),l=n,r=n,{disabledItemsFocusable:f,expanded:i,defaultExpanded:u,onNodeToggle:c,onNodeFocus:d,disableSelection:m,defaultSelected:b,selected:p,multiSelect:a,onNodeSelect:g,id:h,defaultCollapseIcon:v,defaultEndIcon:y,defaultExpandIcon:N,defaultParentIcon:I,children:C}=r,j=de(r,qo),{getRootProps:T,contextValue:R}=Mo({disabledItemsFocusable:f,expanded:i,defaultExpanded:u,onNodeToggle:c,onNodeFocus:d,disableSelection:m,defaultSelected:b,selected:p,multiSelect:a,onNodeSelect:g,id:h,defaultCollapseIcon:v,defaultEndIcon:y,defaultExpandIcon:N,defaultParentIcon:I,plugins:Yo,rootRef:o}),k=Jo(n),M=Kt({elementType:Re,externalSlotProps:{},externalForwardedProps:j,className:k.root,getSlotProps:T,ownerState:l});return s.jsx($o,{value:R,children:s.jsx(Re,D({},M,{children:C}))})}),Qo=K(st)(({theme:e})=>({color:e.palette.text.secondary,[`& .${E.content}`]:{color:e.palette.text.secondary,borderTopRightRadius:e.spacing(2),borderBottomRightRadius:e.spacing(2),paddingRight:e.spacing(1),fontWeight:e.typography.fontWeightMedium,"&.MuiTreeItem-content":{paddingLeft:"3px",paddingRight:"3px"},".MuiTreeItem-label":{paddingLeft:"0px"},".MuiTreeItem-iconContainer":{marginRight:"0px"},"&.Mui-expanded":{fontWeight:e.typography.fontWeightRegular},"&:hover":{backgroundColor:e.palette.action.hover},"&.Mui-selected":{backgroundColor:"rgba(145, 85, 253, 0.16)",color:"var(--tree-view-color)"},"&.Mui-focused, &.Mui-selected, &.Mui-selected.Mui-focused":{backgroundColor:"rgba(145, 85, 253, 0.16)",color:"var(--tree-view-color)"},[`& .${E.label}`]:{fontWeight:"inherit",color:"inherit"}},[`& .${E.group}`]:{marginLeft:0,[`& .${E.content}`]:{paddingLeft:e.spacing(1)}}})),Xo=x.forwardRef(function(t,o){const{labelIcon:n,labelInfo:l,labelText:r,pl:f,...i}=t;return s.jsx(Qo,{label:s.jsxs(P,{sx:{display:"flex",alignItems:"center",p:.5,pr:2,pl:{pl:f}},children:[s.jsx(P,{component:n,color:"inherit",sx:{mr:1,pl:{pl:f}}}),s.jsx(H,{sx:{fontWeight:"inherit",flexGrow:1},component:"div",children:r}),s.jsx(H,{variant:"caption",color:"inherit",children:l})]}),...i,ref:o})}),rt=e=>{const{id:t,fullIndex:o,title:n,sub:l}=e.item;if(t===void 0)return console.log("SubTreeItem.item.undefined=",e.item),s.jsx(s.Fragment,{});const r=l&&Object.values(l).length>0?Object.values(l).length+"":"";return s.jsx(Xo,{onClick:()=>e.onDetail(t,o),nodeId:t,labelText:n,labelInfo:r,pl:e.pl,children:l!=null?Object.values(l).sort((f,i)=>f.title>i.title?1:-1).map((f,i)=>s.jsx("div",{style:{paddingLeft:e.pl+5},children:s.jsx(rt,{onDetail:e.onDetail,item:f,pl:e.pl+5})},i+"")):""})};function Zo(e){const[t,o]=x.useState([]),[n,l]=x.useState([]),{isMoble:r,height:f,width:i}=pt(),u=(m,b)=>{e.onDetail(m,b)};x.useEffect(()=>{if(e.expandIndex!==void 0){let m=e.expandIndex.split("/");m=m.filter(b=>b!=="sub"),e.expandIndex.indexOf("undefined")<0&&(o(m),l(m[m.length-1]))}},[e.expandIndex]);const c=(m,b)=>{},d=(m,b)=>{o(b)};return s.jsx("div",{style:{height:f-220-(r?56:0)+(i>1024?60:0),width:"100%",overflowY:"auto",overflowX:"hidden"},children:s.jsx(lt,{"aria-label":"icon expansion",defaultCollapseIcon:s.jsx(Ne,{}),defaultExpandIcon:s.jsx(Ie,{}),expanded:t,onNodeSelect:c,selected:n,onNodeToggle:d,sx:{flexGrow:1},children:e.data&&e.data.map((m,b)=>s.jsx(rt,{onDetail:u,item:m,parentIndex:b+1,pl:5},b+1))})})}const en=K(st)(({theme:e})=>({color:e.palette.text.secondary,[`& .${E.content}`]:{color:e.palette.text.secondary,borderTopRightRadius:e.spacing(2),borderBottomRightRadius:e.spacing(2),paddingRight:e.spacing(1),fontWeight:e.typography.fontWeightMedium,"&.MuiTreeItem-content":{paddingLeft:"3px",paddingRight:"3px"},".MuiTreeItem-label":{paddingLeft:"0px"},".MuiTreeItem-iconContainer":{marginRight:"0px"},"&.Mui-expanded":{fontWeight:e.typography.fontWeightRegular},"&:hover":{backgroundColor:e.palette.action.hover},"&.Mui-selected":{backgroundColor:"rgba(145, 85, 253, 0.16)",color:"var(--tree-view-color)"},"&.Mui-focused, &.Mui-selected, &.Mui-selected.Mui-focused":{backgroundColor:"rgba(145, 85, 253, 0.16)",color:"var(--tree-view-color)"},[`& .${E.label}`]:{fontWeight:"inherit",color:"inherit"}},[`& .${E.group}`]:{marginLeft:0,[`& .${E.content}`]:{paddingLeft:e.spacing(1)}}})),tn=x.forwardRef(function(t,o){const{labelIcon:n,labelInfo:l,labelText:r,pl:f,...i}=t;return s.jsx(en,{label:s.jsxs(P,{sx:{display:"flex",alignItems:"center",p:.5,pr:2,pl:{pl:f}},children:[s.jsx(P,{component:n,color:"inherit",sx:{mr:1,pl:{pl:f}}}),s.jsx(H,{sx:{fontWeight:"inherit",flexGrow:1},component:"div",children:r}),s.jsx(H,{variant:"caption",color:"inherit",children:l})]}),...i,ref:o})}),it=e=>{const{id:t,fullIndex:o,title:n,sub:l}=e.item;if(t===void 0)return console.log("SubTreeItem.item.undefined=",e.item),s.jsx(s.Fragment,{});const r=l&&Object.values(l).length>0?Object.values(l).length+"":"";return s.jsx(tn,{onClick:()=>e.onDetail(t,o),nodeId:t,labelText:n,labelInfo:r,pl:e.pl,children:l!=null?Object.values(l).sort((f,i)=>f.title>i.title?1:-1).map((f,i)=>s.jsx("div",{style:{paddingLeft:e.pl+5},children:s.jsx(it,{onDetail:e.onDetail,item:f,pl:e.pl+5})},i+"")):""})};function on(e){const[t,o]=x.useState([]),[n,l]=x.useState([]),r=(u,c)=>{e.onDetail(u,c)};x.useEffect(()=>{if(e.expandIndex!==void 0){let u=e.expandIndex.split("/");u=u.filter(c=>c!=="sub"),e.expandIndex.indexOf("undefined")<0&&(o(u),l(u[u.length-1]))}},[e.expandIndex]);const f=(u,c)=>{},i=(u,c)=>{o(c)};return s.jsx(P,{sx:{minHeight:180,flexGrow:1,display:"flex",flexDirection:"column",height:e.maxHeight,overflow:"hidden",overflowY:"auto",width:"100%"},children:s.jsx(lt,{"aria-label":"icon expansion",defaultCollapseIcon:s.jsx(Ne,{}),defaultExpandIcon:s.jsx(Ie,{}),expanded:t,onNodeSelect:f,selected:n,onNodeToggle:i,sx:{flexGrow:1,overflow:"hidden",overflowY:"auto"},children:e.data&&e.data.map((u,c)=>s.jsx(it,{onDetail:r,item:u,parentIndex:c+1,pl:5},c+1))})})}const nn={position:"absolute",top:"50%",left:"50%",display:"flex",flexDirection:"column",alignItems:"center",transform:"translate(-50%, -50%)",width:250,maxHeight:"400px",bgcolor:"background.paper",border:"1px solid #000",boxShadow:24,boxSizing:"border-box",p:4},sn=e=>s.jsxs(P,{sx:{my:2,mt:3,display:"flex"},children:[s.jsx(B,{type:"submit",variant:"outlined",color:"success",onClick:e.onPost,children:"확인"}),s.jsx(B,{type:"button",variant:"outlined",onClick:e.onClose,children:"취소"})]}),ln=e=>{const[t,o]=x.useState(e.open),[n,l]=x.useState(),r=()=>{o(!1),l(void 0),e.onClose()};x.useEffect(()=>{o(e.open)},[e.open]);const f=u=>{l(u)},i=()=>{if(n===void 0){alert("이동할 메모장을 선택해 주세요");return}e.onPost(n)};return s.jsx("div",{children:s.jsx(Gt,{open:t,onClose:r,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:s.jsxs(P,{sx:nn,children:[s.jsx(H,{id:"modal-modal-title",variant:"h6",component:"h2",children:"이동할 메모장 선택"}),s.jsx(O,{}),s.jsx(P,{sx:{width:"100%",minHeight:110,maxHeight:200,flexGrow:1,minWidth:100,overflow:"hidden"},children:s.jsx(on,{data:e.data,onDetail:f,maxHeight:200})}),s.jsx(sn,{onPost:i,onClose:r})]})})})},rn=e=>s.jsxs(P,{sx:{flexGrow:1,my:2,width:"100%",display:"grid",gridTemplateColumns:"64px 64px  64px  64px ",flexDirection:"row",alignItems:"center",alignContent:"center",justifyContent:"center",textAlign:"center",whiteSpace:"nowrap"},children:[s.jsx(B,{type:"button",size:"small",variant:"outlined",color:"success",onClick:e.onEdit,children:"수정"}),s.jsx(B,{type:"button",size:"small",variant:"outlined",onClick:e.onNewMemo,children:"새글"}),e.rootDb==="memo"?s.jsx(B,{type:"button",size:"small",variant:"outlined",color:"warning",onClick:e.onMove,children:"이동"}):"",s.jsx(B,{type:"button",size:"small",variant:"outlined",color:"error",onClick:e.onDelete,children:"삭제"})]}),an=e=>{const{rootDb:t,isLoading:o,memoDetailData:n}=e;console.log("MemoDetail.memoDetailData.title=",n?.title,", bookmark=",n?.bookmark);const{scrollYProgress:l}=Ue(),r=ze(l,{stiffness:100,damping:30,restDelta:.001}),[f,i]=x.useState(!1),u=Q(),c=x.useRef();c.current=e.searchWord;const{memoId:d}=We(),b=ve()?.state?.fullIndex,{user:p}=ce(),a=()=>{const C=`/${t}/edit/${d}`;u(C,{state:{fullIndex:b}})},g=()=>{const C=`/${t}/insert/${d}`;u(C,{state:{fullIndex:b}})},h=async()=>{const C=t==="memo"?`${t}_txt/${p.uid}/${d}`:`${t}_txt/${d}`,j=t==="memo"?`${t}/${p.uid}`:t;if(await Lt(C,j)===void 0){alert("삭제에 실패했습니다.[code:d02]");return}e.onTreeUpdate(),u(`/${t}`)},v=()=>{window.confirm(`하위 자료가 있는 경우 같이 삭제됩니다.
삭제하시겠습니까?`)&&h()},y=()=>{i(!0)},N=()=>{e.onBookmark()},I=async C=>{try{const j=t==="memo"?`${t}_txt/${p.uid}`:`${t}_txt`,T=t==="memo"?`memo/${p.uid}`:t,R=await Pt(j,T,d,C);e.onTreeUpdate()}catch(j){console.log("catch",j)}finally{i(!1)}};return x.useEffect(()=>{n&&n.title!==void 0&&Je({title:n.title,description:n.title});function C(){window.scrollTo({top:0}),n&&n.html!=="N"&&document.querySelectorAll("pre").forEach(j=>{j.innerHTML=qt(j.innerHTML)})}n&&n.memo!==null&&C()},[n]),o?s.jsx(W,{}):d===""||p===void 0?s.jsx(s.Fragment,{}):s.jsxs("div",{children:[s.jsx(ht.div,{className:"progress-bar",style:{scaleX:r}}),s.jsxs("div",{className:`grid grid-cols-3 
				items-center w-full 
				dark:bg-stone-950 rounded-md shadow-sm 
				dark:shadow-stone-800 shadow-stone-900`,children:[s.jsx("div",{}),s.jsx("div",{className:"flex justify-center",children:n&&n.title}),s.jsxs("div",{className:"text-right justify-end mr-3.5",children:[s.jsx(Jt,{"aria-label":"bookmark",onClick:N,children:n&&n.bookmark==="Y"?s.jsx(zt,{sx:{color:"red"}}):s.jsx($t,{})}),s.jsx("div",{className:"text-right mb-3 text-sm text-red-400",children:e.pathNm})]})]}),s.jsxs("div",{className:"w-full p-0 m-0",children:[s.jsx(rn,{rootDb:t,onEdit:a,onNewMemo:g,onMove:y,onDelete:v,onBookmark:N,bookmark:n&&n.bookmark}),s.jsxs(P,{sx:{my:2},children:[n&&n.html==="N"?s.jsx(qe,{postData:n&&n.memo}):n&&n.html!=="N"&&n.memo&&s.jsx(bt,{text:n.memo}),s.jsx(Yt,{imageList:n&&n.image}),!n&&s.jsx(P,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:s.jsx(Qt,{sx:{mt:5}})})]}),s.jsx(ln,{userId:p?.uid,open:f,data:e.data,onClose:()=>i(!1),onPost:I})]})]})},cn=({onSubmit:e,onCancel:t,isSubmitting:o,newMode:n})=>s.jsxs("div",{className:"flex justify-end mb-1.5 gap-1",children:[s.jsxs(ae,{variant:"outlined",color:"success",disabled:o,onClick:l=>{l.preventDefault(),e(l)},children:[n?"새글":""," 저장"]}),s.jsx(ae,{variant:"outlined",color:"error",onClick:t,children:"취소"})]}),dn=x.lazy(()=>Ke(()=>import("./index-C1Fml-Dc.js").then(e=>e.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32])));Ot.Quill.register("modules/imageDrop",_t);He.configure({languages:["javascript","ruby","python","java","cpp","kotlin","sql"]});const un={syntax:{highlight:e=>He.highlightAuto(e).value},toolbar:[[{header:"1"},{header:"2"},{header:"3"},{font:[]}],[{size:[]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","image","video"],["clean"],["code-block"]],imageDrop:!0,clipboard:{matchVisual:!1}},fn=["header","font","size","bold","italic","underline","strike","blockquote","list","bullet","indent","link","image","video","clean","code-block","code-custom"],mn=e=>{const[t,o]=x.useState(e.imageList),[n,l]=x.useState(e.htmlCheck==="Y"),[r,f]=x.useState(e.newMode?"":e.content),i=x.useRef(),u=x.useRef(),c=x.useRef(null),d=x.useRef(null),m=e.newMode,b=x.useRef([]),{height:p}=vt(),a=Xt.now().setZone("Asia/Seoul").toFormat("yyyy-MM-dd"),g={edTitle:m?"":e.title,edGbn:e.gbn?e.gbn:"etc",edDate:m?a:e.date,content:m?"":e.content,memoTxt:m?"":e.content,htmlCheck:e.htmlCheck},{register:h,handleSubmit:v,trigger:y,control:N,setValue:I,getValues:C,watch:j,formState:{errors:T,isSubmitting:R}}=Zt({mode:"onChange",defaultValues:g});x.useEffect(()=>{h("edDate",{required:!0,minLength:10}),h("edGbn",{required:!0}),h("htmlCheck"),h("memoTxt")},[]),x.useEffect(()=>{b.current=[],i.current=e.content,u.current=!1},[e.content]);const k=async S=>{m?await e.onNewSubmit(S,b.current):await e.onPostSubmit(S,t,b.current)},M=()=>{v(k)()},X=S=>{console.log("onDelete.imageList=",S),o(S)},ue=S=>{let w=i.current;S.ext==="jpg"?w+=`<img src='${S.url}'/>`:S.ext==="mp4"&&(w+=`<video preload="auto" controls="" src='${S.url}'></video>`),i.current=w},Z=S=>{i.current=S},fe=S=>{console.log("handleFileUpload",S),b.current=S};function me(S){i.current=S,I("content",S),y("content")}function z(S){console.log("handleChangeDate=",S);let w=xe(S);w.format("YYYY-MM-DD HH:mm:ss"),console.log("handleChangeDate.dayjs=",w.format("YYYY-MM-DD HH:mm:ss")),I("edDate",w.format("YYYY-MM-DD")),y("edDate")}const ee=S=>{console.log("onChecked=",S),I("htmlCheck",S?"Y":"N"),l(S)},F=j("content"),_=[{value:"",text:"None"},{value:"react",text:"React"},{value:"css",text:"CSS"},{value:"android",text:"Android"},{value:"java",text:"JAVA"},{value:"image",text:"그림 / 사진"},{value:"etc",text:"기타"},{value:"mui",text:"MUI"}],te=["React","JavaScript","Bash","Java","Kotlin","CSS","C++","C#","Command","Script","Python","Ruby","Go","Swift","Rust"],G=S=>{const w=c.current;if(w){const A=w.selectionStart,Y=w.selectionEnd,V=r.slice(0,A),oe=r.slice(Y);f(V+S+oe),I("memoTxt",V+S+oe),setTimeout(()=>{w.selectionStart=w.selectionEnd=A+S.length,w.focus()},0)}},L=S=>{G(S)};return s.jsx("div",{className:"my-2 mb-[50px], w-full",children:s.jsxs("form",{onSubmit:v(k),style:{width:"100%",minHeight:"300px",maxHeight:{height:p},display:"flex",flexDirection:"column"},children:[s.jsx(cn,{onSubmit:S=>M(),onCancel:e.onCancel,isSubmitting:R,newMode:m}),s.jsx(Ft,{control:N,onDelete:X,onInsert:ue,setContent:Z,onFileUpload:fe,imageList:e.imageList}),s.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[s.jsx(so,{...h("edTitle",{required:"해당 필드는 필수입니다.",minLength:{value:1,message:"1글자 이상 입력해주세요."}}),fullWidth:!0,label:"제목",placeholder:"제목",variant:"filled",size:"small",error:!!T.edTitle}),s.jsx(to,{id:"edGbn",name:"edGbn",label:"구분",mdSize:6,control:N,defaultValue:C("edGbn"),selectList:_,error:!!T.edGbn,onChange:S=>{S.preventDefault();const w=S.target.value;console.log("edGbn=",C("edGbn")),I("edGbn",w)}}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(eo,{id:"edDate",label:"일자",mdSize:6,value:xe(C("edDate")),...h("edDate"),defaultValue:xe(C("edDate")),onChange:z}),s.jsx(oo,{id:"html",checked:n,onChange:ee,label:"HTML사용"})]})]}),s.jsx(O,{}),s.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[s.jsx("div",{className:"max-h-130 overflow-y-scroll",children:s.jsx(qe,{postData:r})}),s.jsxs("div",{children:[s.jsx(no,{ref:c,className:"",value:r,onChange:S=>{I("memoTxt",S),f(S)},rows:22}),s.jsx(O,{}),s.jsxs("div",{className:"grid grid-cols-4 gap-2 xsm:grid-cols-5 sm:grid-cols-7 md:grid-cols-7 lg:grid-cols-8",children:[s.jsx(ie,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L("<box></box>"),children:"<Box>"}),s.jsx(ie,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L("</code>"),children:"</code>"}),te.map((S,w)=>s.jsx(ie,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L("<code>"+S+"</code>"),children:S},w)),s.jsx(ie,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L('<a href="" target="_blank"></a>'),children:"Link"})]}),s.jsx(O,{})]})]}),s.jsx(x.Suspense,{fallback:s.jsx("div",{children:"Loading editor..."}),children:s.jsx(dn,{ref:d,fullWidth:!0,theme:"snow",id:"content",name:"content",type:"div",value:F,style:{minWidth:"400px",border:"1px solid primary.main",minHeight:"200px",height:"400px",maxHeight:"450px"},modules:un,formats:fn,onChange:me})}),s.jsx(O,{})]})})},Me=e=>{const{rootDb:t,isLoading:o,memoDetailData:n}=e,{scrollYProgress:l}=Ue();ze(l,{stiffness:100,damping:30,restDelta:.001});const r=Q(),f=x.useRef(),i=x.useRef();i.current=e.searchWord;const{memoId:u}=We(),c=ve(),d=n?.fullIndex,{user:m}=ce();f.current=c.pathname.split("/")[2]==="insert",console.log("MemoDetailEdit.memoDetailData=",n?.title),console.log("MemoDetailEdit.newMode=",f.current);const b=()=>{const g=`/${t}/${u==="insert"?"":u}`;r(g,{state:{fullIndex:d}})},p=async(g,h)=>{console.log("onNewSubmit.values",g),console.log("onNewSubmit.fullIndex",d);const v=t==="memo"?`${t}_txt/${m.uid}/`:`${t}_txt/`,y=t==="memo"?`${t}/${m.uid}/`:`${t}/`;console.log("onNewSubmit.txtLocate",v),console.log("onNewSubmit.locate",y);const N=await we(void 0,v,y,d,g);if(await Te(`${t}_txt`,t,N,h),N!==void 0){const I=`/${t}/${N}`;r(I,{state:{reflash:!0}})}},a=async(g,h,v)=>{const y=t==="memo"?`${t}_txt/${m.uid}`:`${t}_txt`,N=t==="memo"?`${t}/${m.uid}`:t;await At(y,N,u,h),console.log("onPostSubmit.values",g);const I=await we(f.current?void 0:u,`${y}/`,`${N}/`,d,g);console.log("onPostSubmit.newKey=",I),console.log("onPostSubmit.files=",v);const C=await Te(`${y}/`,`${N}/`,u,v);if(console.log("onNewSubmit.imageResult",C),console.log("onPostSubmit.fullIndex",d),t==="memo"&&d===void 0){const T=await Dt(m.uid,`${u}/fullIndex`);console.log("onPostSubmit.fullPath",T),T!==void 0&&Et(`memo/${m.uid}/${T}/title`,g.edTitle)}f.current=!1;const j=`/${t}/${u}`;r(j,{state:{fullIndex:d,reflash:!0}})};return x.useEffect(()=>{n&&n.title!==void 0&&Je({title:n.title,description:n.title});function g(){document.querySelectorAll("pre").forEach((h,v)=>{})}n&&n.memo!==null&&g()},[n]),u===""||m===void 0?s.jsx(s.Fragment,{}):(console.log("MemoDetailEdit.isLoading=",o),n===void 0||o?s.jsx(W,{}):s.jsx(s.Fragment,{children:s.jsx("div",{className:"w-full p-0 m-0",children:f.current===!1&&n&&(n.title===void 0||n.title===""||n.title===null)?s.jsx(W,{}):s.jsx(mn,{newMode:f.current,onPostSubmit:a,onNewSubmit:p,onCancel:b,title:n?.title,gbn:n?.gbn,date:n?.date,htmlCheck:n?.html?n?.html:"Y",content:n?.memo,imageList:n?.image})})}))},gn=x.lazy(async()=>await Ke(()=>import("./MemoMain-CapvOzSH.js"),__vite__mapDeps([33,1,2,25]))),xn=({rootDb:e})=>{const t=Q(),{user:o}=ce(),n=x.useRef(),l=x.useRef(),r=x.useRef(!0),f=x.useRef(),i=x.useRef(),[u,c]=x.useState(),d=x.useRef(!1),m=ve(),b=x.useRef(!1);b.current=m?.state?.reflash===!0;const p=St({queryKey:["treeMemo",o?.uid,n.current],queryFn:()=>uo(e,o?.uid,n.current)});p.data!==void 0&&p.data!==""&&!d.current&&(d.current=!0);const a=()=>{const I=u;I&&(I.bookmark=I.bookmark==="Y"?"N":"Y"),Mt(o.uid,i.current,u.bookmark),c({...u,bookmark:I.bookmark})};x.useEffect(()=>{o!==void 0&&o!=null&&p.refetch()},[o]),x.useEffect(()=>{const I=async T=>{if(T!==""&&o){const R=await lo(e,o?.uid,T,n.current);{const k=at(p.data,{id:"",nm:""},T),M=k.id;l.current=k.nm,R.fullIndex=M,M!==f&&(f.current=M,Rt(o.uid,T,M))}R.bookmark===void 0&&(R.bookmark="N"),c(R),r.current=!1}},C=m.pathname.split("/"),j=C.length>2?C[C.length-1]:"";r.current=!0,I(j),i.current=j},[m.pathname,o]),x.useEffect(()=>{o!==void 0&&o!=null&&p.refetch()},[b.current]);const g=I=>{d.current=!1,I!==void 0&&(n.current=I),p.refetch()},h=(I,C)=>{if(I===i.current)return;r.current=!0;const j=`/${e}/${I}`;t(j,{state:{fullIndex:f.current}})},v=()=>{if(o==null){alert("로그인 후 이용 가능합니다.");return}const I=`/${e}/insert/insert`;t(I)},y=I=>{},N=s.jsxs("div",{className:"",children:[s.jsx(fo,{className:"mt-3 ",children:e==="memo"?"메모장":"홈페이지관리"}),s.jsxs("div",{className:"flex gap-7 justify-center",children:[s.jsx(re,{to:"/",children:"홈"}),e==="memo"?"":s.jsx(re,{to:"/memo",children:"메모"}),s.jsx(re,{to:"/todo",children:"TODO"}),s.jsx(re,{to:"/tw",children:"Sheet"})]}),s.jsx(co,{onNewMemoBtn:v,onSearchDataBtn:g}),d.current&&p.isFetched?s.jsx(Zo,{expandIndex:f.current,data:p.data,onDetail:h}):s.jsx(W,{})]});return o&&o.uid===Nt&&Ht,s.jsxs(It,{sideType:"memo",title:e==="memo"?"메모장":"홈페이지관리",sideContents:N,children:[s.jsx(x.Suspense,{fallback:s.jsx(W,{}),children:s.jsxs(yt,{children:[s.jsx(le,{path:"/edit/:memoId",element:s.jsx(Me,{rootDb:e,isLoading:r.current,searchWord:n.current,memoDetailData:u})}),s.jsx(le,{path:"/insert/:memoId",element:s.jsx(Me,{rootDb:e,isLoading:r.current,searchWord:n.current,memoDetailData:u})}),s.jsx(le,{path:"/:memoId",element:s.jsx(an,{rootDb:e,isLoading:r.current,searchWord:n.current,memoDetailData:u,onTreeUpdate:g,pathNm:l.current,onBookmark:a,data:p.data})}),s.jsx(le,{path:"*",element:s.jsx(gn,{searchWord:n.current,data:p.data,onNewMemoBtn:v,title:e==="memo"?"메모장 홈":"홈페이지관리 홈"})})]})}),e==="memo"?s.jsx(ao,{onSelected:y}):"",s.jsx(Wt,{})]})},at=(e,t,o)=>{let n={};if(e)for(let l=0;l<e.length;l++){const r=e[l];if(r.id===o)return n.id=t.id+r.id,n.nm=t.nm+r.title,n;if(r.sub!==null&&r.sub!==void 0){if(n.id=t.id+r.id+"/sub/",n.nm=t.nm+r.title+" > ",n=at(Object.values(r.sub),n,o),n.id&&n.id.endsWith(o))return n;n={}}}return n},Ns=()=>s.jsx(xn,{rootDb:"memo"});export{Ns as default};
