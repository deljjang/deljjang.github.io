import{j as n}from"./index-ButIsC44.js";import{r as s}from"./router-BlMcuVHC.js";import{i as v,j as C,t as D,bu as N,bq as B}from"./App-DRLuNdmp.js";import"./vendor-CCYiWZgt.js";const L=(o,e)=>{const[c,i]=s.useState(o);return s.useEffect(()=>{const u=setTimeout(()=>{i(o)},e);return()=>clearTimeout(u)},[o,e]),c},H=({id:o,block:e,styleClasses:c,isCodeEditing:i,setIsCodeEditing:u,readOnly:w=!1,rootDb:p,memoId:x})=>{const{t:m}=v(),j=C(),{user:l}=D(),[r,h]=s.useState(e.content),[a,g]=s.useState(e.highlightLine||""),d=L(r,500),f=L(a,500),b=s.useRef(!0);s.useEffect(()=>{i||(e.content!==r&&h(e.content),(e.highlightLine||"")!==a&&g(e.highlightLine||""))},[e.content,e.highlightLine,i]),s.useEffect(()=>{if(b.current){b.current=!1;return}const t={};d!==e.content&&(t.content=d),f!==(e.highlightLine||"")&&(t.highlightLine=f),Object.keys(t).length>0&&l?.uid&&j(N({rootDb:p,userId:l.uid,memoId:x,blockId:o,propsToUpdate:t}))},[d,f,e,o,j,x,p,l?.uid]);const y=t=>{t.key==="Escape"&&(u(!1),h(e.content),g(e.highlightLine||""))};return n.jsx(n.Fragment,{children:i&&!w?n.jsxs("div",{className:"CodeBlock w-full relative",children:[n.jsx("textarea",{value:r,onChange:t=>h(t.target.value),onKeyDown:y,autoFocus:!0,rows:`${r.split(/\r\n|\r|\n/g).length+1}`,className:`CodeBlock_textarea ${c.code} w-full min-h-[100px] focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-b-none`}),n.jsx("input",{type:"text",value:a,onChange:t=>g(t.target.value),onKeyDown:y,placeholder:m("highlight_lines_placeholder","e.g., 1,3-5"),className:"CodeBlock_input w-full p-2 text-sm bg-gray-100 dark:bg-zinc-800 border-t border-gray-300 dark:border-zinc-600 focus:outline-none rounded-b-md"}),n.jsx("div",{className:"absolute top-2 right-2 px-3 py-1 ",children:n.jsx("button",{onClick:()=>u(!1),className:"px-3 py-1 text-xs font-semibold text-white bg-blue-500 rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",children:m("done")})})]}):n.jsx(B,{language:e.language||"javascript",postData:r,highlightLine:a})})};export{H as CodeBlock};
