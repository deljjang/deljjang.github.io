import{j as e,p as N,T,F as H,H as L,e as M,r as u,g as O,a as X,k as U,h as z,q as G,i as S,_ as A}from"./index-DRYhf1EU.js";import{u as K,B as Q}from"./BibleBookmarkText-Bhg2WWbp.js";import{a as W}from"./BibleSkeleton-YheoThua.js";const Z=({dataText:l,searchWord:p,bookmark:f,...o})=>{if(l==null)return;const k=o.bibleId.split("_");return o.bibleId&&k.length<2?e.jsx(e.Fragment,{}):e.jsxs(e.Fragment,{children:[e.jsx("h6",{className:`flex flex-col items-center mb-8 ${N.textXl}`,children:o.nm}),l.map((r,c)=>{let d="text.primary";o.cd4+""===r.cd4&&(d="warning.main");const x=f?.filter(h=>h.id===r.id&&h.bookmark==="Y");return x&&x.length>0&&(r.bookmark="Y"),e.jsxs("div",{className:"grid grid-cols-5 sm:grid-cols-6 md:grid-cols-10 lg:grid-cols-12 gap-4",id:`id_${c+1}`,children:[e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:`flex items-center ${d}`,children:[e.jsx(T,{className:"items-center text-top cursor-pointer",onClick:()=>o.onBookmark(r),children:r.nm}),x&&x.length>0&&e.jsx(H,{className:"text-red-500 w-4 h-4"})]})}),e.jsxs("div",{className:`col-span-4 sm:col-span-5 md:col-span-9 lg:col-span-11 ${d}`,children:[e.jsx(L,{text:r.ko}),e.jsx("div",{className:"text-sm text-red-600 dark:text-gray-700",children:e.jsx(L,{text:r.en})})]})]},c)})]})},ee=({data:l,bibleId:p,isBottom:f=!1})=>{const o=new Array,{t:k}=M();if(l==null)return;const r=p.split("_");for(let c=1;c<=l.cd3;c++){const d={nm:`${l.nm2}${c}장`,key:l.id+"_"+c};o.push(d)}return r&&r.length===3&&!f?e.jsxs("h6",{className:`flex flex-col items-center ${N.textXl}`,children:[r[2],"장"]}):e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-6 md:grid-cols-10 lg:grid-cols-12 gap-4",children:o.map((c,d)=>e.jsx("div",{className:"col-span-1",children:e.jsx(T,{to:`/bible/${c.key}`,children:c.nm})},d))})},re=()=>{const[l,p]=u.useState(null),[f,o]=u.useState(null),[k,r]=u.useState(!0),{query:c,setBibleBookmark:d}=K(),x=c.data,{t:h,i18n:R}=M(),i=u.useRef(),{bibleId:a}=O(),B=X(),[w,y]=u.useState(!1),[I,E]=u.useState(!1),{user:V}=U(),_=B?.state?.word,v=B?.state?.cd4,P=z();u.useEffect(()=>{if(a!==void 0){(async()=>{const m=await q(a,_);p(m),r(!1)})(),y(!1),E(!0);const t=a.split("_");if(i.current&&t.length>=2){const m=i.current.cd3;y(Number(t[2])!==1),E(t[2]<m)}}},[a,_]),u.useEffect(()=>{v!==void 0&&setTimeout(()=>{J("","id_"+v)},1500)},[l,v]);const J=(s,t)=>{const m=document.getElementById(t);m&&m.scrollIntoView({block:"center",behavior:"smooth"})},Y=s=>{V!==void 0&&(d(s),s.bookmark=s.bookmark===void 0||s.bookmark==="N"?"Y":"N",o(s.id),setTimeout(()=>o(null),500))},q=async(s,t)=>{if(s===""||s===void 0)return"";R.language.split("-")[0];const D=(await A(()=>import("./bibleJson-mLacnG04.js"),[])).default,b=s.split("_"),F=(await A(()=>import("./bible-7rshX_PU.js"),[])).default;if(b.length<1)return;b.length>1&&D.map(g=>{g.id===b[0]+"_"+b[1]&&(i.current=g)});const $=new Array;if(b.length>1){const g=new RegExp(t,"gi");for(let j in F){let n=F[j];n.id.startsWith(`${s}_`)&&(t!==void 0&&t!==""&&t!==null&&(n.ko=n.ko.replace(g,`<span class='lightext'>${t}</span>`),n.en=n.en.replace(g,`<span class='lightext'>${t}</span>`)),n.nm=b.length===2?`${i.current.nm2}${n.cd3}:${n.cd4}`:`${i.current.nm2}${n.cd3}:${n.cd4}`,$.push(n))}return $.sort((j,n)=>j.cd3-n.cd3||j.cd4-n.cd4),$}};if(a==="")return e.jsx(e.Fragment,{});const C=s=>{let t=a.split("_");t[2]=Number(t[2])+s,P(`/bible/${t[0]}_${t[1]}_${t[2]}`)};return l===null?e.jsx(W,{}):e.jsxs("div",{className:`${N.card}`,children:[e.jsx("div",{id:"back-to-top-anchor"}),e.jsx(Q,{}),e.jsx("div",{className:"w-full items-center justify-center flex flex-col",children:e.jsx(T,{to:"/bible/"+i.current.id,children:e.jsx(G,{children:i.current!==null&&i.current!==void 0&&i.current.nm!==null?`${i.current.text} ${i.current.text_en}`:""})})}),e.jsx(ee,{data:i.current,bibleId:a}),e.jsx(Z,{dataText:l,data:i.current,searchWord:_,bibleId:a,cd4:v,bookmark:x,clickedVerseId:f,onBookmark:Y}),e.jsxs("div",{className:"p-0",children:[k&&e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("div",{className:"mt-10 w-8 h-8 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin"})}),a&&a.split("_").length===3?e.jsx("div",{className:`${N.between} mt-10`,children:e.jsxs("div",{className:"grid grid-cols-12 gap-2 w-full",children:[w?e.jsx("div",{className:I?"col-span-6":"col-span-12",children:e.jsx(S,{type:"button",variant:"outlined",onClick:()=>C(-1),fullWidth:!0,children:`< ${h("prev")}`})}):null,I?e.jsx("div",{className:w?"col-span-6":"col-span-12",children:e.jsx(S,{type:"button",variant:"outlined",onClick:()=>C(1),fullWidth:!0,children:`${h("next")} >`})}):""]})}):null]})]})};export{re as TwBibleDetail,re as default};
