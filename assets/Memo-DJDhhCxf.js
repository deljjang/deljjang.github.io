const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CmAQUu_o.js","assets/index-EsjifOpZ.js","assets/index-Bsp738v3.css","assets/SinySelect-DwmBJCmU.js","assets/Grid-Dj9cjDaU.js","assets/index-uPdfvAO1.js","assets/TextField-DTXAnxp0.js","assets/InputAdornment-_cKI5tYW.js","assets/Popper-B7qZXjyo.js","assets/Chip-CQDiZXlC.js","assets/index.esm-CyfSyXg0.js","assets/index-Cmdt2tIm.css","assets/MemoMain-DqWNtH3h.js","assets/TwButton-czAUWf_m.js"])))=>i.map(i=>d[i]);
import{r as m,q as te,t as Ne,v as Le,w as ne,x as oe,y as Re,z as F,j as e,p as E,D as Ee,A as Be,S as We,T as Fe,C as Pe,E as G,F as N,G as _e,J as Ye,K as B,M as He,o as Q,N as Oe,s as se,i as T,O as Ge,P as R,Q as ie,R as q,n as ae,m as Ae,U as qe,H as le,k as ze,V as Ve,W as Ke,X as re,Y as Ue,Z as Je,$ as A,a0 as _,a1 as ce,a2 as de,a3 as Qe,a4 as Xe,a5 as Y,a6 as Ze,a7 as et,a8 as tt,a9 as nt,aa as H,ab as ot,ac as st,ad as it,ae as at}from"./index-EsjifOpZ.js";import{u as lt}from"./useSuspenseQuery-D4mZiubr.js";import{E as z,C as V}from"./ExpandMore-yhIHGPlf.js";import{T as O}from"./TwButton-czAUWf_m.js";import{I as rt,T as ct}from"./TextField-DTXAnxp0.js";import{u as ue,a as me,F as dt,f as ut,b as mt,D as xt,l as ft,I as ht,c as X,d as Z,e as gt,T as bt}from"./index-CmAQUu_o.js";import{T as xe,a as fe,t as M}from"./TreeView-DElv-YVF.js";import{F as jt}from"./Favorite-B0q8qtRd.js";import{D as pt}from"./datetime-BDx6lZXm.js";import{u as vt}from"./index.esm-CyfSyXg0.js";import{S as kt,a as yt}from"./SinySelect-DwmBJCmU.js";import{C as wt}from"./Checkbox-DO_Ydwxy.js";import{T as It}from"./TextArea-CnzL39nF.js";import"./useBaseQuery-BSBzVg_c.js";import"./Collapse-D6MEA-D0.js";import"./Grid-Dj9cjDaU.js";import"./index-uPdfvAO1.js";import"./InputAdornment-_cKI5tYW.js";import"./Popper-B7qZXjyo.js";import"./Chip-CQDiZXlC.js";const Dt=t=>{const[o,i]=m.useState([]),n=()=>{const l=te(ne(oe,`memo_txt/${t}`),Le("bookmark"),Ne("Y"));Re(l,s=>{if(!s.exists())return;const u=s.val(),a=[];for(let r in u){const d=u[r];d.key=r,a.push(d)}a.sort((r,d)=>r.title>d.title?1:-1),i(a)})};return m.useEffect(()=>{n()},[t]),o};function St({initTreeData:t,uid:o}){const[i,n]=m.useState(),l=a=>n(a),s=F();if(m.useEffect(()=>{(async()=>{const r=[];if(t)for(const d of t){const c=d.fullIndex.split("/");let f="root";if(c.length>1)for(let D=0;D<c.length;D++){const b=c[D];if(b!=="sub"&&c.length>D){const k=await Pe(`memo_txt/${o}/${b}/title`),I={id:b,text:k,droppable:!1,parent:f};f=b,r.filter(y=>y.id===b).length===0&&r.push(I)}}const g={id:d.key,text:d.title,droppable:!1,parent:f};r.filter(D=>D.id===g.id).length===0&&r.push(g)}for(const d of r){const c=d.id;d.cnt=r.filter(f=>f.parent===c).length}n(r)})()},[t]),i==null||i.length===0)return e.jsx(E,{});const u=a=>{console.log("node",a),s(`/memo/${a.id}`)};return e.jsx(Ee,{backend:We,options:Be(),children:e.jsx(Fe,{tree:i,rootId:"root",onDrop:l,render:(a,{depth:r,isOpen:d,onToggle:c})=>e.jsxs("div",{className:"w-60 flex items-center justify-between hover:bg-gray-300 dark:hover:bg-gray-700 rounded-sm ",style:{paddingLeft:r*20+(a.cnt===0?5:0)},children:[e.jsxs("div",{className:"flex items-center",children:[a.cnt>0&&e.jsx("div",{onClick:c,children:d?e.jsx(z,{}):e.jsx(V,{})}),e.jsx("div",{className:"cursor-pointer",onClick:()=>u(a),children:a.text})]}),a.cnt>0&&e.jsxs("div",{className:"text-gray-500 text-sm",children:["(",a.cnt,")"]})]})})})}function Ct(t){const{user:o}=G(),i=F(),n=Dt(o?.uid);return o===void 0?e.jsx(e.Fragment,{}):e.jsxs("div",{className:"tail-bookmark justify-items-center",sx:{display:"flex",alignItems:"center",flexDirection:"column",width:"100%"},children:[e.jsx(N,{}),e.jsx(_e,{children:"BookMark"}),e.jsx("div",{className:`tail-bookmark 
        grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-1 
        justify-items-center 
        w-full`,children:n&&n.map((l,s)=>e.jsx("div",{children:e.jsx(Ye,{component:"button",variant:"body",onClick:()=>{t.onSelected(l.key),i(`/memo/${l.key}`)},children:e.jsx(B,{variant:"body1",children:l.title})})},s))}),e.jsx(N,{}),e.jsx(St,{initTreeData:n,uid:o?.uid})]})}const Tt=t=>{const o=m.useRef(null);function i(){t.onSearchDataBtn(o.current.value)}function n(){return t.onNewMemoBtn(),!1}function l(s){s.which===13&&i()}return e.jsxs(e.Fragment,{children:[e.jsx(rt,{id:"edSearch",type:"edSearch",name:"edSearch",inputRef:o,placeholder:"Enter Search...",fullWidth:!0,sx:{pt:0,pl:2,pr:2,pb:1},onKeyDownCapture:l}),e.jsxs("div",{className:"flex justify-center",children:[e.jsx(O,{variant:"outlined",color:"success",className:"m-1 p-1",onClick:n,children:"새글"}),e.jsx(O,{variant:"outlined",color:"brand",className:"m-1 p-1",onClick:i,children:"조회"})]})]})};async function Mt(t,o,i=""){if(o==null||o==="")return"";let n=i===""?`${t}/${o}`:`${t}_txt/${o}`;t==="home"&&(n="home_txt");const l=te(ne(oe,n)),s=await He(l);if(!s.exists())return console.log("getTreeData.null"),null;if(!s.exists())return console.log("getTreeData.exists"),null;const u=s.val(),a=[],r={};t==="home"&&(Q.map(d=>{a.push({title:d.label,id:d.id,sub:[]})}),Q.map(d=>{r[d.id]=[]}));for(const d in u){const c=u[d];c.up===void 0?(c.id=d,c.fullIndex=d):(c.id=c.up,c.fullIndex=c.up),t==="home"?c.gbn!==void 0&&r[c.gbn].push(c):i===""||i===void 0?(c.sub!==null&&(c.children=he(c,c.up)),a.push(c)):(c.id=d,(c.memo+"").toLowerCase().indexOf(i.toLowerCase())>-1&&a.push(c))}return t==="home"?Object.values(r).map((d,c)=>{d.sort((f,g)=>f.title>g.title?1:-1),a[c].sub=d}):a.sort((d,c)=>d.title>c.title?1:-1),a}function he(t,o,i,n){const l=[];if(console.log("dbChildren.data=",t.id,t.title,t),t===void 0||t.sub===void 0)return l;for(let s in t.sub){let u=t.sub[s];u.id=s,u.key=s}return Object.values(t.sub).sort((s,u)=>u.title-s.title).map(s=>{s.id=s.key,s.fullIndex=o+"/sub/"+s.key,s.sub!==null&&(s.children=he(s,s.fullIndex)),l.push(s)}),l}const $t=se(fe)(({theme:t})=>({color:t.palette.text.secondary,[`& .${M.content}`]:{color:t.palette.text.secondary,borderTopRightRadius:t.spacing(2),borderBottomRightRadius:t.spacing(2),paddingRight:t.spacing(1),fontWeight:t.typography.fontWeightMedium,"&.MuiTreeItem-content":{paddingLeft:"3px",paddingRight:"3px"},".MuiTreeItem-label":{paddingLeft:"0px"},".MuiTreeItem-iconContainer":{marginRight:"0px"},"&.Mui-expanded":{fontWeight:t.typography.fontWeightRegular},"&:hover":{backgroundColor:t.palette.action.hover},"&.Mui-selected":{backgroundColor:"rgba(145, 85, 253, 0.16)",color:"var(--tree-view-color)"},"&.Mui-focused, &.Mui-selected, &.Mui-selected.Mui-focused":{backgroundColor:"rgba(145, 85, 253, 0.16)",color:"var(--tree-view-color)"},[`& .${M.label}`]:{fontWeight:"inherit",color:"inherit"}},[`& .${M.group}`]:{marginLeft:0,[`& .${M.content}`]:{paddingLeft:t.spacing(1)}}})),Nt=m.forwardRef(function(o,i){const{labelIcon:n,labelInfo:l,labelText:s,pl:u,...a}=o;return e.jsx($t,{label:e.jsxs(T,{sx:{display:"flex",alignItems:"center",p:.5,pr:2,pl:{pl:u}},children:[e.jsx(T,{component:n,color:"inherit",sx:{mr:1,pl:{pl:u}}}),e.jsx(B,{sx:{fontWeight:"inherit",flexGrow:1},component:"div",children:s}),e.jsx(B,{variant:"caption",color:"inherit",children:l})]}),...a,ref:i})}),ge=t=>{const{id:o,fullIndex:i,title:n,sub:l}=t.item;if(o===void 0)return console.log("SubTreeItem.item.undefined=",t.item),e.jsx(e.Fragment,{});const s=l&&Object.values(l).length>0?Object.values(l).length+"":"";return e.jsx(Nt,{onClick:()=>t.onDetail(o,i),nodeId:o,labelText:n,labelInfo:s,pl:t.pl,children:l!=null?Object.values(l).sort((u,a)=>u.title>a.title?1:-1).map((u,a)=>e.jsx("div",{style:{paddingLeft:t.pl+5},children:e.jsx(ge,{onDetail:t.onDetail,item:u,pl:t.pl+5})},a+"")):""})};function Lt(t){const[o,i]=m.useState([]),[n,l]=m.useState([]),{isMoble:s,height:u,width:a}=Oe(),r=(f,g)=>{t.onDetail(f,g)};m.useEffect(()=>{if(t.expandIndex!==void 0){let f=t.expandIndex.split("/");f=f.filter(g=>g!=="sub"),t.expandIndex.indexOf("undefined")<0&&(i(f),l(f[f.length-1]))}},[t.expandIndex]);const d=(f,g)=>{},c=(f,g)=>{i(g)};return e.jsx("div",{style:{height:u-220-(s?56:0)+(a>1024?60:0),width:"100%",overflowY:"auto",overflowX:"hidden"},children:e.jsx(xe,{"aria-label":"icon expansion",defaultCollapseIcon:e.jsx(z,{}),defaultExpandIcon:e.jsx(V,{}),expanded:o,onNodeSelect:d,selected:n,onNodeToggle:c,sx:{flexGrow:1},children:t.data&&t.data.map((f,g)=>e.jsx(ge,{onDetail:r,item:f,parentIndex:g+1,pl:5},g+1))})})}const Rt=se(fe)(({theme:t})=>({color:t.palette.text.secondary,[`& .${M.content}`]:{color:t.palette.text.secondary,borderTopRightRadius:t.spacing(2),borderBottomRightRadius:t.spacing(2),paddingRight:t.spacing(1),fontWeight:t.typography.fontWeightMedium,"&.MuiTreeItem-content":{paddingLeft:"3px",paddingRight:"3px"},".MuiTreeItem-label":{paddingLeft:"0px"},".MuiTreeItem-iconContainer":{marginRight:"0px"},"&.Mui-expanded":{fontWeight:t.typography.fontWeightRegular},"&:hover":{backgroundColor:t.palette.action.hover},"&.Mui-selected":{backgroundColor:"rgba(145, 85, 253, 0.16)",color:"var(--tree-view-color)"},"&.Mui-focused, &.Mui-selected, &.Mui-selected.Mui-focused":{backgroundColor:"rgba(145, 85, 253, 0.16)",color:"var(--tree-view-color)"},[`& .${M.label}`]:{fontWeight:"inherit",color:"inherit"}},[`& .${M.group}`]:{marginLeft:0,[`& .${M.content}`]:{paddingLeft:t.spacing(1)}}})),Et=m.forwardRef(function(o,i){const{labelIcon:n,labelInfo:l,labelText:s,pl:u,...a}=o;return e.jsx(Rt,{label:e.jsxs(T,{sx:{display:"flex",alignItems:"center",p:.5,pr:2,pl:{pl:u}},children:[e.jsx(T,{component:n,color:"inherit",sx:{mr:1,pl:{pl:u}}}),e.jsx(B,{sx:{fontWeight:"inherit",flexGrow:1},component:"div",children:s}),e.jsx(B,{variant:"caption",color:"inherit",children:l})]}),...a,ref:i})}),be=t=>{const{id:o,fullIndex:i,title:n,sub:l}=t.item;if(o===void 0)return console.log("SubTreeItem.item.undefined=",t.item),e.jsx(e.Fragment,{});const s=l&&Object.values(l).length>0?Object.values(l).length+"":"";return e.jsx(Et,{onClick:()=>t.onDetail(o,i),nodeId:o,labelText:n,labelInfo:s,pl:t.pl,children:l!=null?Object.values(l).sort((u,a)=>u.title>a.title?1:-1).map((u,a)=>e.jsx("div",{style:{paddingLeft:t.pl+5},children:e.jsx(be,{onDetail:t.onDetail,item:u,pl:t.pl+5})},a+"")):""})};function Bt(t){const[o,i]=m.useState([]),[n,l]=m.useState([]),s=(r,d)=>{t.onDetail(r,d)};m.useEffect(()=>{if(t.expandIndex!==void 0){let r=t.expandIndex.split("/");r=r.filter(d=>d!=="sub"),t.expandIndex.indexOf("undefined")<0&&(i(r),l(r[r.length-1]))}},[t.expandIndex]);const u=(r,d)=>{},a=(r,d)=>{i(d)};return e.jsx(T,{sx:{minHeight:180,flexGrow:1,display:"flex",flexDirection:"column",height:t.maxHeight,overflow:"hidden",overflowY:"auto",width:"100%"},children:e.jsx(xe,{"aria-label":"icon expansion",defaultCollapseIcon:e.jsx(z,{}),defaultExpandIcon:e.jsx(V,{}),expanded:o,onNodeSelect:u,selected:n,onNodeToggle:a,sx:{flexGrow:1,overflow:"hidden",overflowY:"auto"},children:t.data&&t.data.map((r,d)=>e.jsx(be,{onDetail:s,item:r,parentIndex:d+1,pl:5},d+1))})})}const Wt={position:"absolute",top:"50%",left:"50%",display:"flex",flexDirection:"column",alignItems:"center",transform:"translate(-50%, -50%)",width:250,maxHeight:"400px",bgcolor:"background.paper",border:"1px solid #000",boxShadow:24,boxSizing:"border-box",p:4},Ft=t=>e.jsxs(T,{sx:{my:2,mt:3,display:"flex"},children:[e.jsx(R,{type:"submit",variant:"outlined",color:"success",onClick:t.onPost,children:"확인"}),e.jsx(R,{type:"button",variant:"outlined",onClick:t.onClose,children:"취소"})]}),Pt=t=>{const[o,i]=m.useState(t.open),[n,l]=m.useState(),s=()=>{i(!1),l(void 0),t.onClose()};m.useEffect(()=>{i(t.open)},[t.open]);const u=r=>{l(r)},a=()=>{if(n===void 0){alert("이동할 메모장을 선택해 주세요");return}t.onPost(n)};return e.jsx("div",{children:e.jsx(Ge,{open:o,onClose:s,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(T,{sx:Wt,children:[e.jsx(B,{id:"modal-modal-title",variant:"h6",component:"h2",children:"이동할 메모장 선택"}),e.jsx(N,{}),e.jsx(T,{sx:{width:"100%",minHeight:110,maxHeight:200,flexGrow:1,minWidth:100,overflow:"hidden"},children:e.jsx(Bt,{data:t.data,onDetail:u,maxHeight:200})}),e.jsx(Ft,{onPost:a,onClose:s})]})})})},_t=t=>e.jsxs(T,{sx:{flexGrow:1,my:2,width:"100%",display:"grid",gridTemplateColumns:"64px 64px  64px  64px ",flexDirection:"row",alignItems:"center",alignContent:"center",justifyContent:"center",textAlign:"center",whiteSpace:"nowrap"},children:[e.jsx(R,{type:"button",size:"small",variant:"outlined",color:"success",onClick:t.onEdit,children:"수정"}),e.jsx(R,{type:"button",size:"small",variant:"outlined",onClick:t.onNewMemo,children:"새글"}),t.rootDb==="memo"?e.jsx(R,{type:"button",size:"small",variant:"outlined",color:"warning",onClick:t.onMove,children:"이동"}):"",e.jsx(R,{type:"button",size:"small",variant:"outlined",color:"error",onClick:t.onDelete,children:"삭제"})]}),Yt=t=>{const{rootDb:o,isLoading:i,memoDetailData:n}=t;console.log("MemoDetail.memoDetailData.title=",n?.title,", bookmark=",n?.bookmark);const{scrollYProgress:l}=ue(),s=me(l,{stiffness:100,damping:30,restDelta:.001}),[u,a]=m.useState(!1),r=F(),d=m.useRef();d.current=t.searchWord;const{memoId:c}=ie(),g=q()?.state?.fullIndex,{user:j}=G(),D=()=>{const p=`/${o}/edit/${c}`;r(p,{state:{fullIndex:g}})},b=()=>{const p=`/${o}/insert/${c}`;r(p,{state:{fullIndex:g}})},k=async()=>{const p=o==="memo"?`${o}_txt/${j.uid}/${c}`:`${o}_txt/${c}`,w=o==="memo"?`${o}/${j.uid}`:o;if(await mt(p,w)===void 0){alert("삭제에 실패했습니다.[code:d02]");return}t.onTreeUpdate(),r(`/${o}`)},I=()=>{window.confirm(`하위 자료가 있는 경우 같이 삭제됩니다.
삭제하시겠습니까?`)&&k()},S=()=>{a(!0)},y=()=>{t.onBookmark()},h=async p=>{try{const w=o==="memo"?`${o}_txt/${j.uid}`:`${o}_txt`,C=o==="memo"?`memo/${j.uid}`:o,$=await ut(w,C,c,p);t.onTreeUpdate()}catch(w){console.log("catch",w)}finally{a(!1)}};return m.useEffect(()=>{n&&n.title!==void 0&&ae({title:n.title,description:n.title});function p(){window.scrollTo({top:0}),n&&n.html!=="N"&&document.querySelectorAll("pre").forEach(w=>{w.innerHTML=Ue(w.innerHTML)})}n&&n.memo!==null&&p()},[n]),i?e.jsx(E,{}):c===""||j===void 0?e.jsx(e.Fragment,{}):e.jsxs("div",{children:[e.jsx(Ae.div,{className:"progress-bar",style:{scaleX:s}}),e.jsxs("div",{className:`grid grid-cols-3 
				items-center w-full 
				dark:bg-stone-950 rounded-md shadow-sm 
				dark:shadow-stone-800 shadow-stone-900`,children:[e.jsx("div",{}),e.jsx("div",{className:"flex justify-center",children:n&&n.title}),e.jsxs("div",{className:"text-right justify-end mr-3.5",children:[e.jsx(qe,{"aria-label":"bookmark",onClick:y,children:n&&n.bookmark==="Y"?e.jsx(jt,{sx:{color:"red"}}):e.jsx(dt,{})}),e.jsx("div",{className:"text-right mb-3 text-sm text-red-400",children:t.pathNm})]})]}),e.jsxs("div",{className:"w-full p-0 m-0",children:[e.jsx(_t,{rootDb:o,onEdit:D,onNewMemo:b,onMove:S,onDelete:I,onBookmark:y,bookmark:n&&n.bookmark}),e.jsxs(T,{sx:{my:2},children:[n&&n.html==="N"?e.jsx(le,{postData:n&&n.memo}):n&&n.html!=="N"&&n.memo&&e.jsx(ze,{text:n.memo}),e.jsx(Ve,{imageList:n&&n.image}),!n&&e.jsx(T,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:e.jsx(Ke,{sx:{mt:5}})})]}),e.jsx(Pt,{userId:j?.uid,open:u,data:t.data,onClose:()=>a(!1),onPost:h})]}),e.jsx(re,{})]})},Ht=({onSubmit:t,onCancel:o,isSubmitting:i,newMode:n})=>e.jsxs("div",{className:"flex justify-end mb-1.5 gap-1",children:[e.jsxs(O,{variant:"outlined",color:"success",disabled:i,onClick:l=>{l.preventDefault(),t(l)},children:[n?"새글":""," 저장"]}),e.jsx(O,{variant:"outlined",color:"error",onClick:o,children:"취소"})]}),Ot=m.lazy(()=>de(()=>import("./index-CmAQUu_o.js").then(t=>t.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])));ft.Quill.register("modules/imageDrop",ht);ce.configure({languages:["javascript","ruby","python","java","cpp","kotlin","sql"]});const Gt={syntax:{highlight:t=>ce.highlightAuto(t).value},toolbar:[[{header:"1"},{header:"2"},{header:"3"},{font:[]}],[{size:[]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","image","video"],["clean"],["code-block"]],imageDrop:!0,clipboard:{matchVisual:!1}},At=["header","font","size","bold","italic","underline","strike","blockquote","list","bullet","indent","link","image","video","clean","code-block","code-custom"],qt=t=>{const[o,i]=m.useState(t.imageList),[n,l]=m.useState(t.htmlCheck==="Y"),[s,u]=m.useState(t.newMode?"":t.content),a=m.useRef(),r=m.useRef(),d=m.useRef(null),c=m.useRef(null),f=t.newMode,g=m.useRef([]),{height:j}=Je(),D=pt.now().setZone("Asia/Seoul").toFormat("yyyy-MM-dd"),b={edTitle:f?"":t.title,edGbn:t.gbn?t.gbn:"etc",edDate:f?D:t.date,content:f?"":t.content,memoTxt:f?"":t.content,htmlCheck:t.htmlCheck},{register:k,handleSubmit:I,trigger:S,control:y,setValue:h,getValues:p,watch:w,formState:{errors:C,isSubmitting:$}}=vt({mode:"onChange",defaultValues:b});m.useEffect(()=>{k("edDate",{required:!0,minLength:10}),k("edGbn",{required:!0}),k("htmlCheck"),k("memoTxt")},[]),m.useEffect(()=>{g.current=[],a.current=t.content,r.current=!1},[t.content]);const W=async x=>{f?await t.onNewSubmit(x,g.current):await t.onPostSubmit(x,o,g.current)},L=()=>{I(W)()},pe=x=>{console.log("onDelete.imageList=",x),i(x)},ve=x=>{let v=a.current;x.ext==="jpg"?v+=`<img src='${x.url}'/>`:x.ext==="mp4"&&(v+=`<video preload="auto" controls="" src='${x.url}'></video>`),a.current=v},ke=x=>{a.current=x},ye=x=>{console.log("handleFileUpload",x),g.current=x};function we(x){a.current=x,h("content",x),S("content")}function Ie(x){console.log("handleChangeDate=",x);let v=A(x);v.format("YYYY-MM-DD HH:mm:ss"),console.log("handleChangeDate.dayjs=",v.format("YYYY-MM-DD HH:mm:ss")),h("edDate",v.format("YYYY-MM-DD")),S("edDate")}const De=x=>{console.log("onChecked=",x),h("htmlCheck",x?"Y":"N"),l(x)},Se=w("content"),Ce=[{value:"",text:"None"},{value:"react",text:"React"},{value:"css",text:"CSS"},{value:"android",text:"Android"},{value:"java",text:"JAVA"},{value:"image",text:"그림 / 사진"},{value:"etc",text:"기타"},{value:"mui",text:"MUI"}],Te=["React","JavaScript","Bash","Java","Kotlin","CSS","C++","C#","Command","Script","Python","Ruby","Go","Swift","Rust"],Me=x=>{const v=d.current;if(v){const K=v.selectionStart,$e=v.selectionEnd,U=s.slice(0,K),J=s.slice($e);u(U+x+J),h("memoTxt",U+x+J),setTimeout(()=>{v.selectionStart=v.selectionEnd=K+x.length,v.focus()},0)}},P=x=>{Me(x)};return e.jsx("div",{className:"my-2 mb-[50px], w-full",children:e.jsxs("form",{onSubmit:I(W),style:{width:"100%",minHeight:"300px",maxHeight:{height:j},display:"flex",flexDirection:"column"},children:[e.jsx(Ht,{onSubmit:x=>L(),onCancel:t.onCancel,isSubmitting:$,newMode:f}),e.jsx(xt,{control:y,onDelete:pe,onInsert:ve,setContent:ke,onFileUpload:ye,imageList:t.imageList}),e.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[e.jsx(ct,{...k("edTitle",{required:"해당 필드는 필수입니다.",minLength:{value:1,message:"1글자 이상 입력해주세요."}}),fullWidth:!0,label:"제목",placeholder:"제목",variant:"filled",size:"small",error:!!C.edTitle}),e.jsx(kt,{id:"edGbn",name:"edGbn",label:"구분",mdSize:6,control:y,defaultValue:p("edGbn"),selectList:Ce,error:!!C.edGbn,onChange:x=>{x.preventDefault();const v=x.target.value;console.log("edGbn=",p("edGbn")),h("edGbn",v)}}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(yt,{id:"edDate",label:"일자",mdSize:6,value:A(p("edDate")),...k("edDate"),defaultValue:A(p("edDate")),onChange:Ie}),e.jsx(wt,{id:"html",checked:n,onChange:De,label:"HTML사용"})]})]}),e.jsx(N,{}),e.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[e.jsx("div",{className:"max-h-130 overflow-y-scroll",children:e.jsx(le,{postData:s})}),e.jsxs("div",{children:[e.jsx(It,{ref:d,className:"",value:s,onChange:x=>{h("memoTxt",x),u(x)},rows:22}),e.jsx(N,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 xsm:grid-cols-5 sm:grid-cols-7 md:grid-cols-7 lg:grid-cols-8",children:[e.jsx(_,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>P("<box></box>"),children:"<Box>"}),e.jsx(_,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>P("</code>"),children:"</code>"}),Te.map((x,v)=>e.jsx(_,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>P("<code>"+x+"</code>"),children:x},v)),e.jsx(_,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>P('<a href="" target="_blank"></a>'),children:"Link"})]}),e.jsx(N,{})]})]}),e.jsx(m.Suspense,{fallback:e.jsx("div",{children:"Loading editor..."}),children:e.jsx(Ot,{ref:c,fullWidth:!0,theme:"snow",id:"content",name:"content",type:"div",value:Se,style:{minWidth:"400px",border:"1px solid primary.main",minHeight:"200px",height:"400px",maxHeight:"450px"},modules:Gt,formats:At,onChange:we})}),e.jsx(N,{})]})})},ee=t=>{const{rootDb:o,isLoading:i,memoDetailData:n}=t,{scrollYProgress:l}=ue();me(l,{stiffness:100,damping:30,restDelta:.001});const s=F(),u=m.useRef(),a=m.useRef();a.current=t.searchWord;const{memoId:r}=ie(),d=q(),c=n?.fullIndex,{user:f}=G();u.current=d.pathname.split("/")[2]==="insert",console.log("MemoDetailEdit.memoDetailData=",n?.title),console.log("MemoDetailEdit.newMode=",u.current);const g=()=>{const b=`/${o}/${r==="insert"?"":r}`;s(b,{state:{fullIndex:c}})},j=async(b,k)=>{console.log("onNewSubmit.values",b),console.log("onNewSubmit.fullIndex",c);const I=o==="memo"?`${o}_txt/${f.uid}/`:`${o}_txt/`,S=o==="memo"?`${o}/${f.uid}/`:`${o}/`;console.log("onNewSubmit.txtLocate",I),console.log("onNewSubmit.locate",S);const y=await X(void 0,I,S,c,b);if(await Z(`${o}_txt`,o,y,k),y!==void 0){const h=`/${o}/${y}`;s(h,{state:{reflash:!0}})}},D=async(b,k,I)=>{const S=o==="memo"?`${o}_txt/${f.uid}`:`${o}_txt`,y=o==="memo"?`${o}/${f.uid}`:o;await gt(S,y,r,k),console.log("onPostSubmit.values",b);const h=await X(u.current?void 0:r,`${S}/`,`${y}/`,c,b);console.log("onPostSubmit.newKey=",h),console.log("onPostSubmit.files=",I);const p=await Z(`${S}/`,`${y}/`,r,I);if(console.log("onNewSubmit.imageResult",p),console.log("onPostSubmit.fullIndex",c),o==="memo"&&c===void 0){const C=await Qe(f.uid,`${r}/fullIndex`);console.log("onPostSubmit.fullPath",C),C!==void 0&&Xe(`memo/${f.uid}/${C}/title`,b.edTitle)}u.current=!1;const w=`/${o}/${r}`;s(w,{state:{fullIndex:c,reflash:!0}})};return m.useEffect(()=>{n&&n.title!==void 0&&ae({title:n.title,description:n.title});function b(){document.querySelectorAll("pre").forEach((k,I)=>{})}n&&n.memo!==null&&b()},[n]),r===""||f===void 0?e.jsx(e.Fragment,{}):(console.log("MemoDetailEdit.isLoading=",i),n===void 0||i?e.jsx(E,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full p-0 m-0",children:u.current===!1&&n&&(n.title===void 0||n.title===""||n.title===null)?e.jsx(E,{}):e.jsx(qt,{newMode:u.current,onPostSubmit:D,onNewSubmit:j,onCancel:g,title:n?.title,gbn:n?.gbn,date:n?.date,htmlCheck:n?.html?n?.html:"Y",content:n?.memo,imageList:n?.image})}),e.jsx(re,{})]}))},zt=m.lazy(async()=>await de(()=>import("./MemoMain-DqWNtH3h.js"),__vite__mapDeps([12,1,2,13]))),Vt=({rootDb:t})=>{const o=F(),{user:i}=G(),n=m.useRef(),l=m.useRef(),s=m.useRef(!0),u=m.useRef(),a=m.useRef(),[r,d]=m.useState(),c=m.useRef(!1),f=q(),g=m.useRef(!1);g.current=f?.state?.reflash===!0;const j=lt({queryKey:["treeMemo",i?.uid,n.current],queryFn:()=>Mt(t,i?.uid,n.current)});j.data!==void 0&&j.data!==""&&!c.current&&(c.current=!0);const D=()=>{const h=r;h&&(h.bookmark=h.bookmark==="Y"?"N":"Y"),at(i.uid,a.current,r.bookmark),d({...r,bookmark:h.bookmark})};m.useEffect(()=>{i!==void 0&&i!=null&&j.refetch()},[i]),m.useEffect(()=>{const h=async C=>{if(C!==""&&i){const $=await st(t,i?.uid,C,n.current);{const W=je(j.data,{id:"",nm:""},C),L=W.id;l.current=W.nm,$.fullIndex=L,L!==u&&(u.current=L,it(i.uid,C,L))}$.bookmark===void 0&&($.bookmark="N"),d($),s.current=!1}},p=f.pathname.split("/"),w=p.length>2?p[p.length-1]:"";s.current=!0,h(w),a.current=w},[f.pathname,i]),m.useEffect(()=>{i!==void 0&&i!=null&&j.refetch()},[g.current]);const b=h=>{c.current=!1,h!==void 0&&(n.current=h),j.refetch()},k=(h,p)=>{if(h===a.current)return;s.current=!0;const w=`/${t}/${h}`;o(w,{state:{fullIndex:u.current}})},I=()=>{if(i==null){alert("로그인 후 이용 가능합니다.");return}const h=`/${t}/insert/insert`;o(h)},S=h=>{},y=e.jsxs("div",{className:"",children:[e.jsx(bt,{className:"mt-3 ",children:t==="memo"?"메모장":"홈페이지관리"}),e.jsxs("div",{className:"flex gap-7 justify-center",children:[e.jsx(Y,{to:"/",children:"홈"}),t==="memo"?"":e.jsx(Y,{to:"/memo",children:"메모"}),e.jsx(Y,{to:"/todo",children:"TODO"}),e.jsx(Y,{to:"/tw",children:"Sheet"})]}),e.jsx(Tt,{onNewMemoBtn:I,onSearchDataBtn:b}),c.current&&j.isFetched?e.jsx(Lt,{expandIndex:u.current,data:j.data,onDetail:k}):e.jsx(E,{})]});return i&&i.uid===Ze&&et,e.jsxs(tt,{sideType:"memo",title:t==="memo"?"메모장":"홈페이지관리",sideContents:y,children:[e.jsx(m.Suspense,{fallback:e.jsx(E,{}),children:e.jsxs(nt,{children:[e.jsx(H,{path:"/edit/:memoId",element:e.jsx(ee,{rootDb:t,isLoading:s.current,searchWord:n.current,memoDetailData:r})}),e.jsx(H,{path:"/insert/:memoId",element:e.jsx(ee,{rootDb:t,isLoading:s.current,searchWord:n.current,memoDetailData:r})}),e.jsx(H,{path:"/:memoId",element:e.jsx(Yt,{rootDb:t,isLoading:s.current,searchWord:n.current,memoDetailData:r,onTreeUpdate:b,pathNm:l.current,onBookmark:D,data:j.data})}),e.jsx(H,{path:"*",element:e.jsx(zt,{searchWord:n.current,data:j.data,onNewMemoBtn:I,title:t==="memo"?"메모장 홈":"홈페이지관리 홈"})})]})}),t==="memo"?e.jsx(Ct,{onSelected:S}):"",e.jsx(ot,{})]})},je=(t,o,i)=>{let n={};if(t)for(let l=0;l<t.length;l++){const s=t[l];if(s.id===i)return n.id=o.id+s.id,n.nm=o.nm+s.title,n;if(s.sub!==null&&s.sub!==void 0){if(n.id=o.id+s.id+"/sub/",n.nm=o.nm+s.title+" > ",n=je(Object.values(s.sub),n,i),n.id&&n.id.endsWith(i))return n;n={}}}return n},hn=()=>e.jsx(Vt,{rootDb:"memo"});export{hn as default};
