const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MemoSheetGrid-DnU3JKjx.js","assets/index-CuczKQYl.js","assets/router-v4BRDFYV.js","assets/vendor-CCYiWZgt.js","assets/index-DvXk6bfL.css","assets/App-unannH-H.js","assets/App-B2l0q4wA.css","assets/MemoDetailEdit-DdAj4F6K.js","assets/HtmlBadge-DRNDIpVT.js","assets/TwCheckbox-DZSX0sJP.js","assets/TwTextArea-CSktGS6Z.js","assets/IpInfo-C0QmTlfM.js","assets/angle-right-BCeYVboh.js","assets/MemoDetailEdit-CXguKeju.css","assets/MemoDetailUtil-DD4e2NAP.js"])))=>i.map(i=>d[i]);
import{j as t,_ as le}from"./index-CuczKQYl.js";import{aJ as nt,aK as rt,aL as K,aM as ge,aN as Ve,aO as Fe,aP as ot,aQ as lt,aR as it,aS as ct,aT as dt,aU as ut,aV as Ye,aW as mt,aX as ht,aY as ve,aZ as Z,a_ as Xe,a$ as Ce,b0 as Ge,b1 as ue,b2 as ye,a2 as ft,a4 as xt,a5 as pt,b3 as gt,a8 as vt,b as W,b4 as ie,az as ce,j as U,e as Q,f as _,b5 as yt,b6 as Se,r as p,b7 as bt,b8 as Ke,aD as fe,b9 as jt,ba as wt,ae as kt,i as D,bb as Nt,bc as Ct,bd as St,be as Lt,bf as Mt,bg as Tt,bh as Le,bi as Et,bj as $t,P as zt,bk as xe,q as M,m as oe,bl as _t,M as Me,Y as Te,H as Ot,af as Bt,ag as It,bm as Rt,bn as At,bo as Dt,bp as Wt,bq as Ht,br as Ue,bs as Pt,bt as Vt,bu as Ft,bv as Yt,bw as Xt,bx as Ee,by as Gt,bz as Kt,bA as Ut,bB as Jt,bC as qt,bD as Zt,bE as Qt,bF as es}from"./App-unannH-H.js";import{r as c,a as be,c as ts,u as de,N as $e,R as ee,e as ss,f as X}from"./router-v4BRDFYV.js";import{I as as}from"./IpInfo-C0QmTlfM.js";import{S as Je,a as ns,b as rs}from"./angle-right-BCeYVboh.js";const ae=new WeakMap;let ne;const qe=(e,a,s)=>(n,r)=>r&&r[0]?r[0][e+"Size"]:rt(n)&&"getBBox"in n?n.getBBox()[a]:n[s],os=qe("inline","width","offsetWidth"),ls=qe("block","height","offsetHeight");function is({target:e,borderBoxSize:a}){ae.get(e)?.forEach(s=>{s(e,{get width(){return os(e,a)},get height(){return ls(e,a)}})})}function cs(e){e.forEach(is)}function ds(){typeof ResizeObserver>"u"||(ne=new ResizeObserver(cs))}function us(e,a){ne||ds();const s=nt(e);return s.forEach(n=>{let r=ae.get(n);r||(r=new Set,ae.set(n,r)),r.add(a),ne?.observe(n)}),()=>{s.forEach(n=>{const r=ae.get(n);r?.delete(a),r?.size||ne?.unobserve(n)})}}const re=new Set;let G;function ms(){G=()=>{const e={get width(){return window.innerWidth},get height(){return window.innerHeight}};re.forEach(a=>a(e))},window.addEventListener("resize",G)}function hs(e){return re.add(e),G||ms(),()=>{re.delete(e),!re.size&&typeof G=="function"&&(window.removeEventListener("resize",G),G=void 0)}}function fs(e,a){return typeof e=="function"?hs(e):us(e,a)}function Ze(e,a){let s;const n=()=>{const{currentTime:r}=a,o=(r===null?0:r.value)/100;s!==o&&e(o),s=o};return K.preUpdate(n,!0),()=>ge(n)}function xs(...e){const a=!Array.isArray(e[0]),s=a?0:-1,n=e[0+s],r=e[1+s],l=e[2+s],o=e[3+s],i=Ve(r,l,o);return a?i(n):i}function ps(e,a,s){const n=e.get();let r=null,l=n,o;const i=typeof n=="string"?n.replace(/[\d.-]/g,""):void 0,h=()=>{r&&(r.stop(),r=null)},d=()=>{h(),r=new ot({keyframes:[_e(e.get()),_e(l)],velocity:e.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...s,onUpdate:o})};if(e.attach((u,f)=>{l=u,o=x=>f(ze(x,i)),K.postRender(d)},h),Fe(a)){const u=a.on("change",x=>e.set(ze(x,i))),f=e.on("destroy",u);return()=>{u(),f()}}return h}function ze(e,a){return a?e+a:e}function _e(e){return typeof e=="number"?e:parseFloat(e)}const gs=50,Oe=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),vs=()=>({time:0,x:Oe(),y:Oe()}),ys={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function Be(e,a,s,n){const r=s[a],{length:l,position:o}=ys[a],i=r.current,h=s.time;r.current=e[`scroll${o}`],r.scrollLength=e[`scroll${l}`]-e[`client${l}`],r.offset.length=0,r.offset[0]=0,r.offset[1]=r.scrollLength,r.progress=lt(0,r.scrollLength,r.current);const d=n-h;r.velocity=d>gs?0:it(r.current-i,d)}function bs(e,a,s){Be(e,"x",a,s),Be(e,"y",a,s),a.time=s}function js(e,a){const s={x:0,y:0};let n=e;for(;n&&n!==a;)if(ct(n))s.x+=n.offsetLeft,s.y+=n.offsetTop,n=n.offsetParent;else if(n.tagName==="svg"){const r=n.getBoundingClientRect();n=n.parentElement;const l=n.getBoundingClientRect();s.x+=r.left-l.left,s.y+=r.top-l.top}else if(n instanceof SVGGraphicsElement){const{x:r,y:l}=n.getBBox();s.x+=r,s.y+=l;let o=null,i=n.parentNode;for(;!o;)i.tagName==="svg"&&(o=i),i=n.parentNode;n=o}else break;return s}const pe={start:0,center:.5,end:1};function Ie(e,a,s=0){let n=0;if(e in pe&&(e=pe[e]),typeof e=="string"){const r=parseFloat(e);e.endsWith("px")?n=r:e.endsWith("%")?e=r/100:e.endsWith("vw")?n=r/100*document.documentElement.clientWidth:e.endsWith("vh")?n=r/100*document.documentElement.clientHeight:e=r}return typeof e=="number"&&(n=a*e),s+n}const ws=[0,0];function ks(e,a,s,n){let r=Array.isArray(e)?e:ws,l=0,o=0;return typeof e=="number"?r=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?r=e.split(" "):r=[e,pe[e]?e:"0"]),l=Ie(r[0],s,n),o=Ie(r[1],a),l-o}const Ns={All:[[0,0],[1,1]]},Cs={x:0,y:0};function Ss(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function Ls(e,a,s){const{offset:n=Ns.All}=s,{target:r=e,axis:l="y"}=s,o=l==="y"?"height":"width",i=r!==e?js(r,e):Cs,h=r===e?{width:e.scrollWidth,height:e.scrollHeight}:Ss(r),d={width:e.clientWidth,height:e.clientHeight};a[l].offset.length=0;let u=!a[l].interpolate;const f=n.length;for(let x=0;x<f;x++){const j=ks(n[x],d[o],h[o],i[l]);!u&&j!==a[l].interpolatorOffsets[x]&&(u=!0),a[l].offset[x]=j}u&&(a[l].interpolate=Ve(a[l].offset,dt(n),{clamp:!1}),a[l].interpolatorOffsets=[...a[l].offset]),a[l].progress=ut(0,1,a[l].interpolate(a[l].current))}function Ms(e,a=e,s){if(s.x.targetOffset=0,s.y.targetOffset=0,a!==e){let n=a;for(;n&&n!==e;)s.x.targetOffset+=n.offsetLeft,s.y.targetOffset+=n.offsetTop,n=n.offsetParent}s.x.targetLength=a===e?a.scrollWidth:a.clientWidth,s.y.targetLength=a===e?a.scrollHeight:a.clientHeight,s.x.containerLength=e.clientWidth,s.y.containerLength=e.clientHeight}function Ts(e,a,s,n={}){return{measure:r=>{Ms(e,n.target,s),bs(e,s,r),(n.offset||n.target)&&Ls(e,s,n)},notify:()=>a(s)}}const q=new WeakMap,Re=new WeakMap,me=new WeakMap,Ae=e=>e===document.scrollingElement?window:e;function Qe(e,{container:a=document.scrollingElement,...s}={}){if(!a)return Ye;let n=me.get(a);n||(n=new Set,me.set(a,n));const r=vs(),l=Ts(a,e,r,s);if(n.add(l),!q.has(a)){const i=()=>{for(const f of n)f.measure(mt.timestamp);K.preUpdate(h)},h=()=>{for(const f of n)f.notify()},d=()=>K.read(i);q.set(a,d);const u=Ae(a);window.addEventListener("resize",d,{passive:!0}),a!==document.documentElement&&Re.set(a,fs(a,d)),u.addEventListener("scroll",d,{passive:!0}),d()}const o=q.get(a);return K.read(o,!1,!0),()=>{ge(o);const i=me.get(a);if(!i||(i.delete(l),i.size))return;const h=q.get(a);q.delete(a),h&&(Ae(a).removeEventListener("scroll",h),Re.get(a)?.(),window.removeEventListener("resize",h))}}const De=new Map;function Es(e){const a={value:0},s=Qe(n=>{a.value=n[e.axis].progress*100},e);return{currentTime:a,cancel:s}}function et({source:e,container:a,...s}){const{axis:n}=s;e&&(a=e);const r=De.get(a)??new Map;De.set(a,r);const l=s.target??"self",o=r.get(l)??{},i=n+(s.offset??[]).join(",");return o[i]||(o[i]=!s.target&&ht()?new ScrollTimeline({source:a,axis:n}):Es({container:a,...s})),o[i]}function $s(e,a){const s=et(a);return e.attachTimeline({timeline:a.target?void 0:s,observe:n=>(n.pause(),Ze(r=>{n.time=n.iterationDuration*r},s))})}function zs(e){return e.length===2}function _s(e,a){return zs(e)?Qe(s=>{e(s[a.axis].progress,s)},a):Ze(e,et(a))}function Os(e,{axis:a="y",container:s=document.scrollingElement,...n}={}){if(!s)return Ye;const r={axis:a,container:s,...n};return typeof e=="function"?_s(e,r):$s(e,r)}const Bs=()=>({scrollX:Z(0),scrollY:Z(0),scrollXProgress:Z(0),scrollYProgress:Z(0)}),se=e=>e?!e.current:!1;function Is({container:e,target:a,...s}={}){const n=ve(Bs),r=c.useRef(null),l=c.useRef(!1),o=c.useCallback(()=>(r.current=Os((i,{x:h,y:d})=>{n.scrollX.set(h.current),n.scrollXProgress.set(h.progress),n.scrollY.set(d.current),n.scrollYProgress.set(d.progress)},{...s,container:e?.current||void 0,target:a?.current||void 0}),()=>{r.current?.()}),[e,a,JSON.stringify(s.offset)]);return Xe(()=>{if(l.current=!1,se(e)||se(a)){l.current=!0;return}else return o()},[o]),c.useEffect(()=>{if(l.current)return Ce(!se(e)),Ce(!se(a)),o()},[o]),n}function tt(e){const a=ve(()=>Z(e)),{isStatic:s}=c.useContext(Ge);if(s){const[,n]=c.useState(e);c.useEffect(()=>a.on("change",n),[])}return a}function st(e,a){const s=tt(a()),n=()=>s.set(a());return n(),Xe(()=>{const r=()=>K.preRender(n,!1,!0),l=e.map(o=>o.on("change",r));return()=>{l.forEach(o=>o()),ge(n)}}),s}function Rs(e){ue.current=[],e();const a=st(ue.current,e);return ue.current=void 0,a}function As(e,a,s,n){if(typeof e=="function")return Rs(e);const r=xs(a,s,n);return Array.isArray(e)?We(e,r):We([e],([l])=>r(l))}function We(e,a){const s=ve(()=>[]);return st(e,()=>{s.length=0;const n=e.length;for(let r=0;r<n;r++)s[r]=e[r].get();return a(s)})}function Ds(e,a={}){const{isStatic:s}=c.useContext(Ge),n=()=>Fe(e)?e.get():e;if(s)return As(n);const r=tt(n());return c.useInsertionEffect(()=>ps(r,e,a),[r,JSON.stringify(a)]),r}const Ws=({className:e})=>t.jsx("svg",{className:e,fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",clipRule:"evenodd"})}),Hs=({className:e})=>t.jsx("svg",{className:e,fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});async function Ps(e,a,s=""){if(a==null||a==="")return"";if(e==="home"){const d=await ye("home/tree");if(d!=null)try{return JSON.parse(d)}catch(u){console.error("Error parsing JSON data:",u)}}const n=e==="home"?"home_txt":s===""?`${e}_tree/${a}`:`${e}_txt/${a}`,r=ft(xt(pt,n)),l=await gt(r);if(!l.exists()||!l.exists())return null;const o=l.val(),i=[{text:"1.React",id:"react",key:"react",parent:"root"},{text:"2.CSS",id:"css",key:"css",parent:"root"},{text:"3.Android",id:"android",key:"android",parent:"root"},{text:"4.Java",id:"java",key:"java",parent:"root"},{text:"5.이미지",id:"image",key:"image",parent:"root"},{text:"6.Etc",id:"etc",key:"etc",parent:"root"}],h=[];e==="home"&&h.push(...i);for(const d in o){const u=o[d];u.id=d;const f={id:d,key:d,text:u.title,parent:e==="home"?u.gbn:u.parent};e==="memo"?(f.icon=u.bm==="Y"?t.jsx(Ws,{className:"w-4 h-4 text-red-500"}):u.icon==="Y"?t.jsx(Hs,{className:"w-4 h-4 text-green-500"}):null,f.droppable=!0):f.droppable=!1,!((s===""||s===void 0||s===null)&&(f.parent===void 0||f.parent===null||f.parent===""))&&(e==="home"||s===""||s===void 0||s===null?h.push(f):(u.id=d,(u.memo+"").toLowerCase().indexOf(s.toLowerCase())>-1&&(f.parent="root",f.droppable=!1,h.push(f))))}return h.sort((d,u)=>d.title>u.title?1:-1),e==="home"&&vt("home/tree",JSON.stringify(h)),h}const Vs=({isOpen:e,onClose:a,data:s})=>{const{t:n}=W();if(!e||!s)return null;const{label:r,value:l,items:o}=s;return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",onClick:a,children:t.jsxs("div",{className:"bg-white dark:bg-zinc-800 rounded-lg shadow-xl w-11/12 md:w-1/2 lg:w-1/3 max-h-[80vh] flex flex-col",onClick:i=>i.stopPropagation(),children:[t.jsxs("div",{className:"flex justify-between items-center border-b p-4 dark:border-zinc-600",children:[t.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:r}),t.jsx("button",{onClick:a,className:"text-gray-400 hover:bg-gray-200 dark:hover:bg-zinc-700 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center",children:t.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),t.jsxs("div",{className:"p-4 overflow-y-auto",children:[t.jsxs("p",{className:"text-base leading-relaxed text-gray-600 dark:text-gray-300 mb-4",children:[n("count","개수"),": ",t.jsx("span",{className:"font-bold",children:l.toLocaleString()})]}),t.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:n("main_list","주요 목록")}),t.jsx("ul",{className:"list-disc list-inside bg-gray-50 dark:bg-zinc-700 p-3 rounded-md",children:o&&o.length>0?o.map((i,h)=>t.jsx("li",{className:"text-gray-700 dark:text-gray-300",children:i.text},h)):t.jsx("li",{className:"text-gray-500",children:n("no_results","결과 없음")})})]})]})})};function Fs({series:e,labels:a,onDataPointClick:s}){const[n,r]=c.useState({labels:[],colors:ie,dataLabels:{style:{colors:["#333"]}},responsive:[{breakpoint:480,options:{chart:{width:"100%"},legend:{position:"bottom"}}}]});return c.useEffect(()=>{r(l=>({...l,labels:a}))},[a]),t.jsx("div",{className:"bg-amber-50 dark:bg-gray-900 shadow-md rounded-sm",children:e&&e.length>0?t.jsx(ce,{type:"donut",series:e,options:n}):t.jsx("div",{className:"text-center text-gray-500",children:"표시할 데이터가 없습니다."})})}function Ys({series:e,labels:a,onDataPointClick:s}){const[n,r]=c.useState({chart:{type:"radar",toolbar:{show:!1},events:{dataPointSelection:(l,o,i)=>{s&&s(i.dataPointIndex)}}},colors:ie,plotOptions:{radar:{polygons:{distributed:!0}}},dataLabels:{enabled:!1},xaxis:{categories:[]},legend:{show:!0},tooltip:{theme:"dark",style:{fontSize:"12px"},y:{formatter:l=>l.toLocaleString()}}});return c.useEffect(()=>{r(l=>({...l,xaxis:{...l.xaxis,categories:a}}))},[a]),t.jsx("div",{className:"bg-white dark:bg-black shadow-md rounded-sm w-full h-full",children:e&&e.length>0&&e[0].data.length>0?t.jsx(ce,{type:"radar",series:e,options:n}):t.jsx("div",{className:"text-center text-gray-500 py-10",children:"표시할 데이터가 없습니다."})})}function Xs({series:e,labels:a,onDataPointClick:s}){const[n,r]=c.useState({labels:[],chart:{events:{dataPointSelection:(l,o,i)=>{s&&s(i.dataPointIndex)}}},colors:ie,plotOptions:{pie:{startAngle:-90,endAngle:90,offsetY:10}},grid:{padding:{bottom:-80}},dataLabels:{style:{colors:["#333"]}},responsive:[{breakpoint:480,options:{chart:{width:"100%"},legend:{position:"bottom"}}}],tooltip:{theme:"dark",style:{fontSize:"12px"},y:{formatter:l=>l.toLocaleString()}},legend:{show:!0}});return c.useEffect(()=>{r(l=>({...l,labels:a}))},[a]),t.jsx("div",{className:"bg-amber-50 dark:bg-gray-900 shadow-md rounded-sm p-2",children:e&&e.length>0&&t.jsx(ce,{type:"donut",series:e,options:n})})}function Gs({series:e,labels:a,showDownload:s=!0,onDataPointClick:n}){const[r,l]=c.useState({chart:{type:"bar",toolbar:{tools:{download:s}},events:{dataPointSelection:(o,i,h)=>{n&&n(h.dataPointIndex)}}},colors:ie,plotOptions:{bar:{borderRadius:4,horizontal:!1,distributed:!0}},dataLabels:{enabled:!1},xaxis:{categories:[]},legend:{show:!1},tooltip:{theme:"dark",style:{fontSize:"12px"},y:{formatter:o=>o.toLocaleString()}}});return c.useEffect(()=>{l(o=>({...o,xaxis:{...o.xaxis,categories:a}}))},[a]),t.jsx("div",{className:"bg-white dark:bg-black shadow-md rounded-sm w-full p-2",children:e&&e.length>0&&e[0].data&&e[0].data.length>0?t.jsx(ce,{type:"bar",series:e,options:r,height:"350"}):t.jsx("div",{className:"text-center text-gray-500 py-10",children:"표시할 데이터가 없습니다."})})}const Ks=({rootDb:e})=>{const{user:a}=U(),{t:s}=W(),n=Q(),r=_(y=>{try{return yt(e)(y)}catch(T){return console.warn("HomeChartForm selector error:",T),{labels:[],series:[],status:"idle",error:null}}}),[l,o]=c.useState(!0),[i,h]=c.useState("donut"),[d,u]=c.useState(!1),[f,x]=c.useState(null),[j,E]=c.useState([]),[$,C]=c.useState([]),[N,H]=c.useState({labels:[],series:[]}),S=["#6366f1","#3b82f6","#22c55e","#ef4444","#f97316","#eab308","#8b5cf6","#d946ef","#14b8a6","#a855f7"],O=[{value:"donut",label:s("donut_chart","도넛 차트")},{value:"bar",label:s("bar_chart","수평 막대 차트")},{value:"radar",label:s("radar_chart","레이더 차트")},{value:"verticalBar",label:s("vertical_bar_chart","수직 막대 차트")},{value:"semiDonut",label:s("semi_donut_chart","반원 도넛 차트")}],P=c.useCallback(y=>{let T=[];if(E(y||[]),y&&y.length>0){const V=y.filter(w=>w.parent==="root").sort((w,B)=>w.text.localeCompare(B.text)),F=(w,B)=>{const I=B.filter(z=>z.parent===w);let R=I.length;for(const z of I)R+=F(z.id,B);return R};T=V.map(w=>({node:w,count:F(w.id,y)})).filter(w=>w.count>=10);const te=T.map(w=>w.node.text),J=T.map(w=>w.count),Y={labels:te,series:J};C(T),H(Y),n(Se({rootDb:e,data:Y}))}else H({labels:[],series:[]}),n(Se({rootDb:e,data:{labels:[],series:[]}}));o(!1)},[e,n]),m=c.useCallback(async()=>{o(!0);const y=await Ps(e==="sheet"?"memo":e,a?.uid);P(y)},[e,a?.uid,P]);c.useEffect(()=>{a?.uid&&(r?.labels&&Array.isArray(r.labels)&&r.labels.length>0?(H(r),o(!1)):m())},[e,a?.uid,r?.labels?.length,m]);const b=y=>{if(y<0||y>=$.length)return;const T=$[y].node,V=T.text,F=(w,B)=>{const I=B.filter(z=>z.parent===w);let R=[...I];return I.forEach(z=>{R=[...R,...F(z.id,B)]}),R},J=F(T.id,j).length,Y=j.filter(w=>w.parent===T.id);x({label:V,value:J,items:Y}),u(!0)},g=()=>t.jsx("div",{className:"w-full h-full flex justify-center items-center p-4",children:t.jsxs("div",{className:"w-full h-full bg-gray-200 dark:bg-zinc-800 rounded-md animate-pulse relative overflow-hidden",children:[t.jsx("div",{className:"absolute top-1/4 left-1/4 w-1/2 h-1/2 bg-gray-300 dark:bg-zinc-700 rounded-full opacity-50"}),t.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-1/3 h-1/3 bg-gray-300 dark:bg-zinc-700 rounded-lg opacity-50"})]})}),k=()=>{m()},L=t.jsxs("div",{className:`HomeChartForm ${p.between}`,children:[t.jsx("div",{children:s("count_stats")}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("select",{value:i,onChange:y=>h(y.target.value),className:"rounded-md border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-200 focus:ring-indigo-500 focus:border-indigo-500 text-sm","aria-label":s("select_chart_type","차트 종류 선택"),children:O.map(y=>t.jsx("option",{value:y.value,children:y.label},y.value))}),t.jsx("button",{onClick:k,className:"rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ","aria-label":s("reload_chart"),children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h5M20 20v-5h-5M4 4l1.5 1.5A9 9 0 0121.5 12M20 20l-1.5-1.5A9 9 0 012.5 12"})})})]})]});return t.jsxs("div",{className:`w-full justify-center ${p.card} `,children:[t.jsx("div",{className:"flex pl-6 py-4",children:t.jsx(bt,{title:L})}),l?t.jsx(g,{}):t.jsxs("div",{className:"w-full justify-center items-center",children:[i==="donut"&&t.jsx(Fs,{series:N.series,labels:N.labels,colors:S,onDataPointClick:b}),i==="bar"&&t.jsx(Ke,{series:[{name:s("count"),data:N.series}],labels:N.labels,colors:S,onDataPointClick:b}),i==="radar"&&t.jsx(Ys,{series:[{name:s("count"),data:N.series}],labels:N.labels,colors:S,onDataPointClick:b}),i==="verticalBar"&&t.jsx(Gs,{series:[{name:s("count"),data:N.series}],labels:N.labels,colors:S,onDataPointClick:b}),i==="semiDonut"&&t.jsx(Xs,{series:N.series,labels:N.labels,colors:S,onDataPointClick:b})]}),t.jsx(Vs,{isOpen:d,onClose:()=>u(!1),data:f})]})},Us=()=>{const[e,a]=c.useState({labels:[],series:[]}),[s,n]=c.useState(null),[r,l]=c.useState({isOpen:!1}),{t:o}=W();return c.useEffect(()=>{(async()=>{const h=await ye("home_cnt");if(h){n(h);const u=Object.keys(h).sort().reverse().slice(0,10),f=u.map(j=>j.split("-").slice(1).join("-")),x=u.map(j=>Object.keys(h[j]).length);a({labels:f,series:x})}})()},[]),t.jsxs("div",{className:`w-full justify-center ${p.card} `,children:[t.jsx("div",{className:"flex pl-6 py-4",children:o("visitors.count")}),t.jsx(Ke,{series:[{name:o("count"),data:e.series}],labels:e.labels,showDownload:!1,onDataPointSelection:(i,h,d)=>{const u=d.dataPointIndex;if(s&&u>-1){const x=Object.keys(s).sort().reverse()[u],j=s[x],E=Object.keys(j).join("<br/>");console.log("filteredNodes=",E),l({isOpen:!0,title:`${x} ${o("visitors.count")}`,message:E,onClose:()=>l({isOpen:!1})})}}}),t.jsx(fe,{...r})]})};function he({type:e=""}){const{user:a}=U(),{t:s}=W(),n=Q(),r=be(),{items:l,status:o}=_(d=>d.bookmark),i=o==="loading";c.useEffect(()=>{a&&n(jt(a.uid))},[a,n]);const h="grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4";return a===null?t.jsx(t.Fragment,{}):t.jsxs("div",{className:`MemoBookMark ${p.card} gap-3`,children:[t.jsx("div",{className:"flex px-6 py-3 items-center justify-center ",children:t.jsx("h3",{className:"mb-2 font-semibold text-gray-900 dark:text-white",children:s("main_list")})}),t.jsx(t.Fragment,{children:i?t.jsx(wt,{}):t.jsx("div",{className:`${e==="grid"?h:""}`,children:l&&l.map((d,u)=>t.jsx("button",{className:"w-full truncate text-left text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",onClick:()=>{r(`/m/${d.key}`)},children:t.jsx("span",{className:"text-sm",children:d.title})},u))})})]})}const Js=({rootDb:e})=>{const{user:a}=U(),{t:s}=W(),n=s(e==="memo"?"appMemo":"home_mng"),r=t.jsx("div",{className:`displayTitle text-center  ${p.text3Xl} ${p.textIndigo}`,children:n});return t.jsx(t.Fragment,{children:t.jsx(kt,{title:r,className:"MemoMain mt-3 mb-5",children:t.jsxs("div",{className:"grid gird-cols-1 md:grid-cols-5 items-center gap-3",children:[a===null?t.jsx("p",{className:`${p.textRed500} ${p.textLgFontSemiboldLeft} ${p.mdColSpan3}`,children:s("login_used")}):t.jsx("p",{className:`${p.textGray600DarkZinc400} text-left ${p.mdColSpan3}`,dangerouslySetInnerHTML:{__html:s("memo_main_guide").replace(`
`,"<br/>")}}),t.jsx("div",{className:`w-full ${p.flexCenter} md:col-span-2`,children:t.jsx(as,{})})]})})})},He=e=>{const{t:a}=W(),s=async()=>{try{await Nt.purge(),alert("Redux 상태가 초기화되었습니다.")}catch(n){console.error("Redux 상태 초기화 실패:",n),alert("상태 초기화 중 오류가 발생했습니다.")}};return t.jsxs("div",{className:"mx-auto grid w-full max-w-lg grid-cols-6 items-center justify-center gap-2 px-4 py-2 text-center",children:[e.master&&t.jsx(D,{size:"sm",variant:"outlined",color:"brand",onClick:e.onUtil,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l-.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),t.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("util")})]})}),t.jsx(D,{size:"sm",variant:"outlined",color:"brand",onClick:e.onEdit,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),t.jsx("path",{d:"m15 5 4 4"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("edit")})]})}),t.jsx(D,{size:"sm",variant:"outlined",color:"brand",onClick:e.onNewMemo,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M5 12h14"}),t.jsx("path",{d:"M12 5v14"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("new")})]})}),t.jsx(D,{size:"sm",variant:"outlined",color:"error",onClick:e.onDelete,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M3 6h18"}),t.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),t.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("delete")})]})}),e.onCopy&&t.jsx(D,{size:"sm",variant:"outlined",color:"secondary",onClick:e.onCopy,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:t.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("public")})]})}),e.master&&t.jsx(D,{size:"sm",variant:"outlined",color:"danger",onClick:s,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("polyline",{points:"23 4 23 10 17 10"}),t.jsx("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("reset")})]})})]})},qs=Mt("memo/deleteMemo",async({rootDb:e,userId:a,memoId:s},{rejectWithValue:n})=>{try{const r=e==="memo"?`${e}_txt/${a}/${s}`:`${e}_txt/${s}`,l=e==="memo"?`${e}_tree/${a}/${s}`:`${e}/${s}`;return await Et(r,l),{memoId:s}}catch(r){return console.error("삭제 중 오류 발생:",r),n(r.message)}});function Zs(e,a,s,n){const r=Q(),l=_(d=>Ct(d,s)),o=_(d=>St(d,s)),i=o==="loading";return c.useEffect(()=>{a?.uid&&s&&s!=="insert"&&o!=="succeeded"&&r(Lt({rootDb:e,userId:a.uid,memoId:s}))},[r,e,a?.uid,s,o]),{memoDetailData:l||{},isLoading:i,onBookmark:()=>{if(!l)return;const d=l.bookmark==="Y"?"N":"Y";r(Tt({rootDb:e,userId:a.uid,memoId:s,newBookmarkState:d})).unwrap().then(()=>{d==="Y"?(r({type:"bookmark/addBookmarkItem",payload:{...l,id:s,key:s,text:l.title}}),r(Le({id:s,bookmark:"Y"}))):(r({type:"bookmark/removeBookmarkItem",payload:s}),r(Le({id:s,bookmark:"N"})))})}}}const Qs=({rootDb:e,searchWord:a})=>{const{user:s}=U(),{memoId:n}=ts(),r=Q(),l=_(v=>v?.tabs?.activeTab||null),{memoDetailData:o,isLoading:i,onBookmark:h}=Zs(e,s,n),[d,u]=c.useState(!1),{alertInfo:f,setAlertInfo:x,resetAlertInfo:j}=$t(),[E,$]=c.useState(!1),[C,N]=c.useState(""),[H,S]=c.useState(!1),[O,P]=c.useState(""),[m,b]=c.useState(!1),{t:g}=W(),{scrollYProgress:k}=Is(),L=Ds(k,{stiffness:100,damping:30,restDelta:.001}),y=be(),V=de()?.state?.fullIndex,F=_(v=>v.treeData.data),te=async()=>{if(!s||!n||e!=="memo"){x({isOpen:!0,title:g("error"),message:"Only private memos can be copied.",color:"error",onConfirm:j,onClose:j});return}try{await r(Ht({userId:s.uid,memoId:n,memoDetailData:o})).unwrap(),x({isOpen:!0,title:g("complete"),message:g("copy_completed"),color:"success",onConfirm:j,onClose:j})}catch(v){console.error("Copy failed:",v);const A=`${g("copy_failed")} ${v?`: ${v}`:""}`;x({isOpen:!0,title:g("error"),message:A,color:"error",onConfirm:j,onClose:j})}},J=()=>{r(Dt({rootDb:e,memoId:n,newMemoContent:C})).unwrap().then(()=>{$(!1)}).catch(v=>{console.error("메모 저장 중 오류 발생:",v)})},Y=()=>{N(o?.memo||""),$(!0)},w=()=>{P(o?.title||""),S(!0)},B=v=>{P(v.target.value)},I=()=>{r(Rt({rootDb:e,userId:s.uid,memoId:n,newTitle:O})).unwrap().then(()=>{S(!1),r({type:"tabs/updateTabTitle",payload:{id:n,title:O}}),r({type:"bookmark/updateBookmarkTitle",payload:{id:n,title:O}}),r(At({id:n,newTitle:O}))}).catch(v=>{console.error("제목 업데이트 중 오류 발생:",v),S(!1)})},R=v=>{v.key==="Enter"?I():v.key==="Escape"&&S(!1)},z=()=>{const v=`/${e==="memo"?"m":e}/edit/${n}`;y(v,{state:{fullIndex:V}})},je=()=>{const v=`/${e==="memo"?"m":e}/util/${n}`;y(v,{state:{fullIndex:V}})},we=()=>{const v=`/${e==="memo"?"m":e}/insert/${n}`;y(v,{state:{fullIndex:V}})},ke=()=>{u(!0)},Ne=()=>{te()},at=async()=>{u(!1);try{r({type:"tabs/setDeleteId",payload:n}),r({type:"tabs/removeTab",payload:n}),y(`/${e==="memo"?"m":e}`),await r(qs({rootDb:e,userId:s.uid,memoId:n})).unwrap(),e==="memo"&&await r(Wt({userId:s.uid,nodeId:n,currentTreeData:F})).unwrap()}catch(v){console.error("삭제 중 오류 발생:",v)}};return c.useEffect(()=>{function v(){const A=o.scrollY?o.scrollY:0;window.scrollTo({top:A})}o&&o.memo!==null&&(v(),o.image&&o.image.map((A,ia)=>A),zt({title:o.title,description:""}))},[o]),n===""||s===void 0?null:i||l!=n?t.jsx(xe,{}):o?t.jsxs("div",{className:"MemoDetail min-w-screen-sm pt-3 pb-0 relative rounded-t-lg",children:[t.jsx(M.div,{className:`progress-bar sticky ${m?"top-28":"top-16"} z-10`,style:{scaleX:L}}),t.jsxs("div",{className:"MemoDetail_body overflow-hidden ",children:[t.jsxs("div",{className:`sticky top-0 ${p.card} backdrop-blur-sm`,children:[t.jsxs("div",{className:"p-3 sm:p-4",children:[t.jsxs("div",{className:p.between,children:[t.jsxs("p",{className:`${p.truncate} ${p.textXs} ${p.textGray500DarkZinc400}`,children:[t.jsx($e,{to:e==="memo"?"/m":"/home",className:"hover:!text-gray-900 dark:hover:!text-white",children:e==="memo"?"MEMO":"HOME"}),o?.path?.map((v,A)=>o.path.length===A+1?` > ${v?.title}`:t.jsxs(ee.Fragment,{children:[" "," > ",t.jsx($e,{to:e==="memo"?`/m/${v.id}`:`/home/${v.id}`,className:"hover:!text-gray-900 dark:hover:!text-white",children:v?.title})]},A))]}),t.jsx(M.button,{whileTap:{scale:.8},className:`${p.flexShrink0} ${p.roundedFull} p-2 ${p.buttonHoverGrayLight}`,"aria-label":g("bookmark"),onClick:h,children:o?.bookmark==="Y"?t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`${p.h5W5} ${p.textRed500}`,fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}):t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`${p.h5W5} ${p.textGray500}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})})]}),H?t.jsx("input",{type:"text",value:O,onChange:B,onKeyDown:R,onBlur:I,className:`w-full bg-transparent border-b-2 border-blue-500 focus:outline-none 
													${p.heading2XlBoldSm3Xl} ${p.textGray900}`,autoFocus:!0}):t.jsx("div",{onDoubleClick:w,className:`MemoDetail_Title text-left ${p.heading2XlBoldSm3Xl} ${p.textGray900} cursor-pointer`,children:o?.title}),t.jsx("button",{onClick:()=>b(!m),className:`${p.floatingActionButton} absolute top-11 sm:top-14 right-2 sm:right-3`,children:t.jsx(M.div,{animate:{rotate:m?135:0},children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})})]}),t.jsx(M.div,{initial:!1,animate:{height:m?"auto":0,opacity:m?1:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:t.jsx("div",{className:"border-t border-gray-200 bg-gray-50 dark:border-zinc-800 dark:bg-zinc-900/50",children:t.jsx(He,{master:s?.uid===oe,rootDb:e,onEdit:z,onUtil:je,onNewMemo:we,onDelete:ke,onCopy:e==="memo"?Ne:null})})})]}),o&&o.html==="sheet"&&t.jsx(_t,{rootDb:e,detailData:o}),t.jsxs("div",{className:`MemoDetail_Content ${o?.memo?.length>0?`${p.card} my-4 p-2 sm:p-4`:"p-1"}`,onDoubleClick:Y,children:[E?t.jsxs("div",{className:`${p.card} p-4`,children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Me,{children:g("input")}),t.jsx("textarea",{className:"w-full min-h-[100px] p-2 border rounded dark:bg-gray-700 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500",value:C,rows:`${C.split(/\r\n|\r|\n/g).length}`,onChange:v=>N(v.target.value),autoFocus:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{children:g("preview")}),t.jsx("div",{className:"prose dark:prose-invert max-w-none p-2 border rounded min-h-[100px] overflow-y-auto dark:bg-gray-700 dark:border-gray-600",children:t.jsx(Te,{postData:C,highlightWord:""})})]})]}),t.jsxs("div",{className:"mt-2 flex justify-end gap-2",children:[t.jsx(D,{variant:"outlined",color:p.button.indigo,size:"sm",onClick:()=>$(!1),children:g("cancel")}),t.jsx(D,{color:p.button.indigo,onClick:J,children:g("save")})]})]}):o&&o.html!=="sheet"?o?.html==="N"?t.jsx(Te,{postData:o?.memo,highlightWord:a}):o?.html!=="N"&&o?.memo&&t.jsx(Ot,{text:o.memo}):"",t.jsx(Bt,{imageList:o?.image}),!o&&t.jsx("div",{className:"flex justify-center py-12",children:t.jsx("div",{className:`${p.flexCenter} py-12`})})]})]}),t.jsx(It,{rootDb:e,memoId:n,enableEdit:!0}),t.jsx(M.div,{initial:!1,animate:{height:m?"auto":0,opacity:m?1:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:t.jsx("div",{className:`${p.line}`,children:t.jsx(He,{master:s?.uid===oe,rootDb:e,onEdit:z,onUtil:je,onNewMemo:we,onDelete:ke,onCopy:e==="memo"?Ne:null})})}),t.jsx(fe,{isOpen:d,size:"sm",color:"warning",title:g("delete_confirm_title"),message:g("delete_confirm_message"),onClose:()=>u(!1),onConfirm:at}),t.jsx(fe,{...f})]}):t.jsx("div",{children:"데이터가 없습니다."})},ea=ee.lazy(()=>le(()=>import("./MemoSheetGrid-DnU3JKjx.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),Pe=ee.lazy(()=>le(()=>import("./MemoDetailEdit-DdAj4F6K.js"),__vite__mapDeps([7,1,2,3,4,5,6,8,9,10,11,12,13]))),ta=ee.lazy(()=>le(()=>import("./MemoDetailUtil-DD4e2NAP.js"),__vite__mapDeps([14,1,2,3,4,5,6,10,8,11,12]))),sa=ee.lazy(()=>le(()=>import("./App-unannH-H.js").then(e=>e.c4),__vite__mapDeps([5,1,2,3,4,6]))),aa=({rootDb:e,user:a,memoId:s,isLoading:n,onBookmark:r,handleCloseTab:l})=>{const o=de();return t.jsx(c.Suspense,{fallback:t.jsx(xe,{}),children:t.jsx(Ue,{children:t.jsxs(ss,{location:o,children:[t.jsx(X,{path:"todo",element:t.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(sa,{})})}),t.jsx(X,{path:"sheet/:sheetId?",element:t.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(ea,{})})}),t.jsx(X,{path:"edit/:memoId",element:t.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(Pe,{rootDb:e,isLoading:n})})}),t.jsx(X,{path:"insert/:memoId",element:t.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(Pe,{rootDb:e,isLoading:n})})}),t.jsx(X,{path:"util/:memoId",element:t.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(ta,{rootDb:e,isLoading:n})})}),t.jsx(X,{path:":memoId",element:t.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:n?t.jsx(xe,{}):t.jsx(Qs,{rootDb:e,onBookmark:r,onDeleteTab:()=>{l&&l(null,{id:s})}})})})]},o.pathname)})})},na=e=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...e,children:t.jsx("path",{fillRule:"evenodd",d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zM6 20V4h7v5h5v11H6zM8 12h3v3H8v-3zm0 4h3v3H8v-3zm4-4h3v3h-3v-3zm0 4h3v3h-3v-3z",clipRule:"evenodd"})}),ra=({tabInfo:e,handleCloseTab:a,isActive:s,onClickTab:n})=>{const{t:r}=W(),{user:l}=U(),{attributes:o,listeners:i,setNodeRef:h,transform:d,transition:u,isDragging:f}=Pt({id:e.id}),x={transform:Vt.Transform?.toString(d),transition:u,zIndex:f?1:"auto"};return t.jsxs("div",{ref:h,style:x,...o,...i,"data-tab-id":e.id,onClick:n,title:e.title,className:`SortableTab group relative flex flex-shrink-0 items-center pl-3 pr-2 py-1.5 text-sm rounded-t-md transition-colors duration-200 min-w-28 max-w-48 border-b-2 cursor-pointer
				${s?"bg-gray-200 dark:bg-zinc-700 border-blue-500 text-gray-800 dark:text-gray-100":"border-transparent text-secondary hover:bg-gray-200/70 dark:hover:bg-zinc-700/70"}
				${f?"opacity-50 shadow-lg":""}`,children:[e.rootDb==="memo"?t.jsx(Ft,{className:`w-5 h-5 mr-1 flex-shrink-0 transition-transform duration-200 ${s?"scale-110":""}`,fill:"currentColor"}):e.rootDb==="sheet"?t.jsx(na,{className:`w-5 h-5 mr-1 flex-shrink-0 transition-transform duration-200 ${s?"scale-110":""}`}):null,t.jsx("span",{className:"truncate pr-1",style:{fontFamily:"sans-serif"},children:e.title||r("loading")}),t.jsx("button",{onClick:j=>{j.preventDefault(),j.stopPropagation(),a(e.id)},className:`ml-auto flex-shrink-0 p-1 rounded-full transition-opacity duration-200 opacity-0 group-hover:opacity-100
					text-gray-500 dark:text-gray-400 
					hover:bg-gray-300/50 dark:hover:bg-gray-600/50 hover:text-gray-700 dark:hover:text-white
				`,children:t.jsx(Je,{className:"w-3 h-3"})})]})},oa=c.memo(({rootDb:e,user:a})=>{const s=c.useRef(null),[n,r]=c.useState({left:!1,right:!1}),[l,o]=c.useState(!0),i=c.useRef(0),h=be(),d=de(),u=d.pathname.split("/").pop(),f=Q(),x=_(m=>m?.tabs?.tabs||[]),j=_(m=>m?.tabs?.activeTab||null),E=_(m=>m?.tabs?.deleteId||null),$=c.useRef(null);c.useEffect(()=>{if((async()=>{if(E!==u&&u&&u!=="insert"&&d.pathname!=="/m"&&d.pathname!=="/home")if(x.some(g=>g.id===u))j!==u&&x.some(g=>g.id===u)&&$.current===null&&f(Ee(u));else{let g="Loading...";try{let k;if(e==="sheet"?k=`memo_sheet/${a?.uid}/${u}/title`:e==="memo"?k=`${e}_txt/${a?.uid}/${u}/title`:e==="home"&&(k=`${e}_txt/${u}/title`),k){const L=await ye(k);L&&(g=L)}}catch(k){console.error("Error fetching tab title:",k)}f(Qt({id:u,path:d.pathname,rootDb:e,title:g}))}})(),$.current=null,E){const b=setTimeout(()=>{f(Yt())},2e3);return()=>clearTimeout(b)}},[u,d.pathname,e,j,a?.uid,E,x,f]);const C=c.useCallback(()=>{const m=s.current;if(m){const b=m.scrollWidth>m.clientWidth,g=m.scrollLeft===0,k=m.scrollLeft+m.clientWidth>=m.scrollWidth-1;r(L=>{const y={left:b&&!g,right:b&&!k};return L.left===y.left&&L.right===y.right?L:y})}},[]);c.useEffect(()=>{const m=()=>{const b=window.pageYOffset||document.documentElement.scrollTop;b>i.current?o(!1):o(!0),i.current=b<=0?0:b};return window.addEventListener("scroll",m),()=>{window.removeEventListener("scroll",m)}},[]);const N=m=>{s.current?.scrollBy({left:m==="left"?-200:200,behavior:"smooth"})},H=c.useCallback(m=>{const b=x.findIndex(g=>g.id===m);if(b!==-1&&(f(Xt(m)),f({type:"tabs/setDeleteId",payload:m}),j===m))if(x.length>1){const g=b>0?b-1:0,k=x[g===b?g+1:g];h(k.path)}else h(e==="memo"?"/m":"/home")},[x,j,f,h,e]),S=c.useCallback(m=>{const b=m.split("/").pop();$.current=b,f(Ee(b)),requestAnimationFrame(()=>{h(m)})},[f,h]),O=c.useCallback(()=>{f(Gt())},[f]),P=c.useCallback(m=>{const{active:b,over:g}=m;if(g&&b.id!==g.id){const k=x.findIndex(y=>y.id===b.id),L=x.findIndex(y=>y.id===g.id);f(Kt(Ut(x,k,L)))}},[x,f]);return c.useEffect(()=>{C();const m=s.current;return m?.addEventListener("scroll",C),window.addEventListener("resize",C),()=>{m?.removeEventListener("scroll",C),window.removeEventListener("resize",C)}},[C,x.length]),t.jsx("div",{className:`MemoTabs sticky ${l?"top-18":"top-1"} z-1000 rounded-t-md bg-gray-50/70 dark:bg-zinc-800/70 backdrop-blur-sm shadow-sm`,children:t.jsxs("div",{className:"relative flex items-center justify-between ",children:[n.left&&t.jsx("button",{onClick:()=>N("left"),className:"absolute left-0 z-10 p-1 border border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 bg-white dark:bg-zinc-900 dark:hover:!text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full group",children:t.jsx(ns,{className:"w-5 h-5 fill-current"})}),t.jsx(Jt,{id:"memo-tabs",onDragEnd:P,children:t.jsx("div",{ref:s,className:"MemoTabs relative flex items-center overflow-x-scroll scrollbar-hide whitespace-nowrap",children:t.jsx(qt,{items:x.map(m=>m.id),strategy:Zt,children:t.jsx(Ue,{children:x.map(m=>t.jsx(M.div,{layout:!0,initial:{opacity:0,scale:.8},transition:{type:"spring",stiffness:350,damping:30},animate:{opacity:1,scale:1},exit:{opacity:0,width:0,paddingLeft:0,paddingRight:0,transition:{duration:.3}},children:t.jsx(ra,{tabInfo:m,onClickTab:()=>S(m.path),handleCloseTab:H,isActive:m.id===j})},m.id))})})})}),t.jsxs("div",{className:"flex items-center",children:[n.right&&t.jsx("button",{onClick:()=>N("right"),className:"z-10 p-1 border border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 bg-white dark:bg-zinc-900 dark:hover:!text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full group",children:t.jsx(rs,{className:"w-5 h-5 fill-current"})}),x.length>0&&t.jsx("button",{onClick:O,className:"ml-2 mr-2 p-1.5 text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md",title:"Close all tabs",children:t.jsx(Je,{className:"w-4 h-4"})})]})]})})}),la=()=>{const{user:e}=U(),a=_(es),s=de(),{rootDb:n,memoId:r}=c.useMemo(()=>{const l=s.pathname,o=l.startsWith("/m/sheet")?"sheet":l.startsWith("/m")?"memo":l.startsWith("/home")?"home":l.startsWith("/bible")?"bible":"default",i=l.split("/").pop()||"";return{rootDb:o,memoId:i}},[s.pathname]);return t.jsxs(t.Fragment,{children:[a&&t.jsx(oa,{rootDb:n,user:e}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("main",{className:"flex-1 max-w-screen-lg",children:[t.jsx(aa,{rootDb:n,user:e,memoId:r}),s.pathname==="/m"&&t.jsx(Js,{rootDb:n}),s.pathname.startsWith("/m/")&&e?.uid===oe&&t.jsx("div",{className:"block lg:hidden flex-1",children:t.jsx(he,{type:"grid"})}),(s.pathname==="/m"||s.pathname==="/home")&&e?.uid===oe&&t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-5",children:[t.jsx("div",{className:"block lg:hidden flex-1",children:t.jsx(he,{})}),t.jsx(Us,{}),t.jsx(Ks,{rootDb:n})]})]}),t.jsx("aside",{className:"hidden lg:block flex-1 min-w-45 max-w-64 pt-3",children:(n==="memo"||n==="sheet")&&t.jsx(he,{})})]})]})},fa=Object.freeze(Object.defineProperty({__proto__:null,default:la},Symbol.toStringTag,{value:"Module"}));export{fa as M,Ds as a,Zs as b,Is as u};
