import{c4 as l,c5 as m,c6 as y,I as d,c7 as w,c8 as $,c9 as h,ca as v,cb as p,cc as F}from"./index-C4YqBfyH.js";function x(r){var n=r.length,a=r.lastIndexOf("."),t=r.substring(a+1,n).toLowerCase();return t}function R(r){var n=r.indexOf("."),a=r.substring(0,n);return a}const O=async(r,n,a)=>{const t={};t.ext=x(a),t.name=a,t.key=R(a);try{const s=`memo/${r}`,o=l(m,`${s}/${a}`),e=await y(o);t.url=e,d(`memo_txt/${r}/${n}/image/${t.key}`,t)}catch{}return t},L=async(r,n,a,t)=>{const s="memo/I3cTgdCxwjhBBno4mtZYvnODPJu1";let o=new Array;for(let e in a){const i=a[e];try{if(i.key=e,i.url===void 0||i.url===""){const u=l(m,`${s}/${e}.${i.ext}`),c=await y(u);i.url=c,d(`${r}/image/${e}/url`,c)}}catch{}o.push(i)}return o},P=async(r,n,a,t)=>{x(t.name);let s=l(m,`${r}/${t.name}`);try{const e=await $(s);s=l(m,`${r}/${a}${t.name}`)}catch(e){if(e.code!=="storage/object-not-found")throw console.error("setFileUpload: 파일 확인 중 오류:",e),e}return await h(s,t)},T=async(r,n,a,t)=>{const s={success:!0,key:a,message:"파일명이 성공적으로 변경되었습니다."};try{const o=l(m,r+n+"."+t);let e=l(m,r+a+"."+t);const i=await v(o);let u=0;for(;;)try{const g=await $(e);u++;const f=a+u;s.key=f,e=l(m,r+f+"."+t)}catch{break}await h(e,i),await w(o);const c=await y(e);return s.url=c,s}catch(o){return console.error("renameFile: 파일명 변경 중 오류:",o),{success:!1,message:"파일명 변경 실패"}}},U=async(r,n,a)=>{try{const t=l(m,`${r}/${a.key}.${a.ext}`);w(t).then(()=>{}).catch(s=>{})}catch{}},b=async(r="")=>{try{const n=l(m,r),a=await p(n),t=[];for(let s=0;s<a.items.length&&s<10;s++){const o=a.items[s];try{t.push(o._location.path_.replace("memo/I3cTgdCxwjhBBno4mtZYvnODPJu1/",""))}catch(e){console.error("파일 정보 조회 실패:",itemRef.name,e)}}return console.error("getStorageFileList10.fileList=",t),t}catch(n){return console.error("Storage 파일 목록 조회 실패:",n),{files:[],folders:[],success:!1,error:n.message}}},B=async(r="")=>{try{const n=l(m,r),a=await p(n),t=[];for(const o of a.items)try{const e=await $(o),i=await y(o);t.push({name:o.name,fullPath:o.fullPath,size:e.size,contentType:e.contentType,timeCreated:e.timeCreated,updated:e.updated,downloadURL:i})}catch(e){console.error("파일 정보 조회 실패:",o.name,e)}const s=a.prefixes.map(o=>({name:o.name,fullPath:o.fullPath,type:"folder"}));return{files:t,folders:s,success:!0}}catch(n){return console.error("Storage 파일 목록 조회 실패:",n),{files:[],folders:[],success:!1,error:n.message}}},C=async(r,n,a,t)=>{let s="",o="",e={};((c,g,f)=>{if(c==="sheet")return;o=c==="memo"?`${c}/${g}/${f}`:`${c}/${f}`,s=c==="memo"?`${c}_txt/${g}/${f}`:`${c}_txt/${f}`})(r,n,a);async function u(){if(s===void 0)return"";if(e=await F(s),e===void 0){e={code:"404",msg:"No data available"};return}if(e?.fullIndex,e.image!==void 0&&e.image!==null){const c=await L(s,o,e.image);e.image=c,(e.imageOK===void 0||e.imageOK==="N")&&(c&&c.map(g=>{g.ext==="jpg"&&(e.memo=e.memo+`<img src='${g.url}'>`)}),d(`${s}/imageOK`,"Y"),d(`${s}/memo`,e.memo))}if(e.html!=="N"&&t!==void 0&&t!==""){const c=new RegExp(t,"gi"),g=e.memo.replace(c,`<span class='lightext'>${t}</span>`);e.memo=g}}return await u(),e};export{P as a,R as b,O as c,T as d,B as e,C as f,x as g,b as h,U as s};
