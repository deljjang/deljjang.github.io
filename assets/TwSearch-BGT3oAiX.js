import{j as s,p as u,a5 as j,bF as p,bK as b,bL as w,r as o,z as D,au as L,$ as T,R as N,E as M,bM as R,a8 as E,a9 as W,aa as C,ab as F}from"./index-CPCRhzRN.js";import{u as I}from"./useQuery-DyhI-G3p.js";import{a as _,T as q}from"./TailList-b-SFPYmI.js";import B from"./TwDetail-DwKWqk_A.js";import"./useBaseQuery-BQ11vBj6.js";import"./ComponentCard-DGiKyiPB.js";const K=({uid:r,state:e})=>{const a=I({queryKey:["blogMainSearch",e&&e?.s?e.s:""],queryFn:()=>_(e?.s,r===j?j:"")});return a.isLoading?s.jsx(u,{}):a.error?s.jsxs("div",{children:["Error: ",a.error.message]}):s.jsx(q,{query:a,index:"1",s:e&&e?.s?e.s:"",sx:{mt:2}})},P=({uid:r,state:e})=>{const[a,c]=p(b),[i,n]=p(w);return o.useEffect(()=>{i!==e.s&&(c(d=>({...d,[e.s]:a[e.s]===void 0?1:a[e.s]+1})),n(e.s))},[e]),s.jsx($,{title:"Search",className:"mt-6",children:s.jsx("div",{className:"mt-5"})})},$=({title:r,children:e,className:a=""})=>{const c=D(),i=L(b),n=[];for(const t in i)n.push(t);const d=t=>{c("/tw/search",{state:{s:t}})};return s.jsxs("div",{className:`rounded-2xl border border-gray-200 
      bg-white dark:border-gray-800 dark:bg-white/[0.03] 
      overflow-hidden w-full ${a}
      mb-5
      `,children:[s.jsx("div",{className:"flex flex-col px-4 py-2",children:s.jsx("h3",{className:"text-base font-medium text-gray-800 dark:text-white/90",children:r})}),s.jsxs("div",{className:"flex p-2 sm:p-4 border-t bg-stone-100 dark:bg-stone-950 border-gray-100 dark:border-gray-800 ",children:[n.map((t,h)=>s.jsx("div",{children:s.jsx(T,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>d(t),children:t})},h)),s.jsx("div",{children:e})]})]})};function J(){const r=N(),e=r.state,{user:a}=M(),c=o.useRef(e.s),[i,n]=o.useState(),[d]=R(),t=d.get("g"),[h,y]=o.useState(),[S,x]=o.useState(!0),f=t==="h"?"home":"memo";return o.useEffect(()=>{const v=async g=>{if(g!==""){const k=await F(f,a?.uid,g,c.current);y(k),x(!1)}};x(!0);const m=r.pathname.split("/"),l=m.length>2?m[m.length-1]:"";n(l),l!=null&&l!=="search"&&v(l)},[r.pathname]),s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",alignContent:"center",justifyContent:"center"},children:[s.jsxs(o.Suspense,{fallback:s.jsx(u,{}),children:[s.jsx(E,{children:s.jsx(W,{path:"/:memoId",element:s.jsx(B,{rootDb:f,isLoading:S,memoDetailData:h})})}),i==="search"?s.jsx(P,{uid:a?.uid,state:e}):"",a===null?s.jsx(u,{}):i==="search"&&e.s!==""&&s.jsx(o.Suspense,{fallback:s.jsx(u,{}),children:s.jsx(K,{index:"1",uid:a?.uid,state:e})})]}),s.jsx(C,{})]})}export{J as default};
