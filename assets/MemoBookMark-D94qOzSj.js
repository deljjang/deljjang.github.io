import{q as k,o as v,j as t,y as j,h as w,r as g,u as B,i as C,bm as N,dZ as $,bn as I,A as q,D as E,E as F,cc as T}from"./index-CyozgB4c.js";import{C as _}from"./ComponentCard-BAOFR-Dn.js";import"./SortableBlock-DEF6-R0G.js";import"./HtmlCode-BtDWfd9A.js";import"./copy-BQruaMNr.js";import"./TwRadio-Bm44JIYA.js";import"./TwBadge-BAlYFcoQ.js";import"./HtmlCode-CtS3f6An.js";import"./toPropertyKey-DCwh5dYN.js";const S=({item:r})=>{const{user:c}=k(),m=v();return console.log("BookmarkButton.item=",r),t.jsx("div",{onClick:()=>m(`/m/${r.key}`),className:`${j.roundedXl} border border-gray-200 
      bg-white dark:border-gray-800 dark:bg-white/[0.03] 
      overflow-hidden cursor-pointer hover:shadow-md transition-shadow h-full flex flex-col`,children:t.jsx("div",{className:"px-4 py-3",children:t.jsx("h3",{className:"text-base font-medium text-gray-800 dark:text-white/90 truncate",children:r.title})})})};function Y(){const{user:r}=k(),{t:c}=w(),[m,h]=g.useState(),{isExpanded:f}=B(),{data:n,isLoading:x}=C({queryKey:["bookmarks",r?.uid],queryFn:async()=>{const o=[],d=N(q(E,`memo_tree/${r.uid}`),I("bm"),$("Y")),i=await F(d);if(!i.exists())return[];const a=i.val();for(let s in a){const e=a[s];e.id=s,e.key=s,e.text=e.title,o.push(e)}return o.sort((s,e)=>s.title>e.title?1:-1),o},enabled:!!r});g.useEffect(()=>{const o=async(d,i)=>{const a=[...i];if(i)for(const s of i){let e=s;for(;e.parent!==void 0&&e.parent!=="root";){const l=e.parent;e=await T(`memo_tree/${d}/${l}`);const u={id:e.key,text:e.title,droppable:!1,parent:e.parent};a.filter(y=>y.id===u.id).length===0&&a.push(u)}}for(const s of a){const e=s.id;s.cnt=a.filter(l=>l.parent===e).length}h(a)};n&&n.length>0&&o(r?.uid,n)},[n,r?.uid]);const p=f?"grid-cols-2 sm:grid-cols-2 ":"grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-6",b=()=>t.jsx("div",{className:`grid ${p} gap-3 p-4`,children:[...Array(8)].map((o,d)=>t.jsx("div",{className:"h-10 bg-gray-200 dark:bg-zinc-800 rounded-md animate-shimmer relative overflow-hidden"},d))});return r===null?t.jsx(t.Fragment,{}):t.jsx(_,{title:c("main_list"),children:t.jsx("div",{className:"p-2",children:x?t.jsx(b,{}):t.jsx("div",{className:`grid ${p} gap-3`,children:n?.map(o=>t.jsx(S,{item:o},o.id))})})})}export{Y as MemoBookMark};
