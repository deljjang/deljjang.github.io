const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MemoSheet-CroenuqB.js","assets/index-CjFOdZ7J.js","assets/index-Bci3ZV-p.css","assets/TwToast-CEFsnSxW.js","assets/ComponentCard-D1jlqcCg.js","assets/NotionStyleEditor-Dr_q9T1l.js","assets/SortableBlock-BVKHG8zW.js","assets/HtmlCode-454GHr9J.js","assets/copy-DQONrJKc.js","assets/TwRadio-Dqawzoeu.js","assets/TwBadge-3VVq5W6n.js","assets/HtmlCode-sQPOFA-9.js","assets/HtmlCode-3_RXYstj.css","assets/toPropertyKey-DCwh5dYN.js","assets/MemoSheetGrid-TvJlYItt.js","assets/MemoDetailEdit-BMEszbE1.js","assets/useMemoMutation-B1dL7Pam.js","assets/Delete-1-eb3uG5.js","assets/Divider-DpBtcdnF.js","assets/TwCheckbox-DBNjTOvv.js","assets/TwTextArea-Cgo2cA6C.js","assets/SinySelect-CYEuvvlv.js","assets/Grid-CW8IWg24.js","assets/index-nHZTnyzM.js","assets/TextField-U3Fh33ol.js","assets/InputAdornment-CcRElFRM.js","assets/Popper-BbG7ea8r.js","assets/Button-JKGZlsYn.js","assets/Chip-BIzsCmHW.js","assets/HomeChartSemiDonut-BsVGkfaM.js","assets/Favorite-6lNncK4L.js","assets/angle-right-DzXZktVY.js","assets/SinyImageList-BK8CN1Rp.js","assets/ImageListItem-jsbXVyn4.js","assets/IpInfo-CJmPbX8D.js","assets/MemoDetailEdit-Cmdt2tIm.css","assets/MemoDetail-UhCuASow.css","assets/TwMemoDetailUtil-DHH86-Ni.js","assets/HomeChartVisitors-0MHorz8F.js","assets/MemoBookMark-GajUI3id.js","assets/folder-Xd1-v7EV.js"])))=>i.map(i=>d[i]);
import{e5 as B,e6 as he,e7 as Te,e8 as Ee,e9 as _e,ea as Le,eb as Me,ec as ze,ed as fe,ee as Oe,ef as He,eg as pe,eh as W,ei as xe,r as f,ej as Be,ek as ge,el as se,em as Re,cc as C,z as X,i as ve,en as ye,G as N,bm as We,A as Z,D,E as Fe,j as s,q as A,bi as we,eo as Ae,h as V,y as p,e0 as Ve,bp as je,bq as ke,a2 as P,o as ee,n as Pe,f as G,bf as S,ep as I,k as L,m as U,p as qe,bR as Ye,e3 as Ne,R as Ge,c as O,_ as H,eq as Ke,K as Qe,er as Ie,bV as Ue,es as Je}from"./index-CjFOdZ7J.js";import{f as Xe,s as Ze,g as De,e as et,h as tt,i as st,C as nt,b as at,j as rt,d as it}from"./SortableBlock-BVKHG8zW.js";import{H as lt,a as ot,b as ct}from"./HomeChartSemiDonut-BsVGkfaM.js";import{F as dt}from"./Favorite-6lNncK4L.js";import{a as ut,S as be,b as mt,c as ht}from"./angle-right-DzXZktVY.js";import{a as ft,C as pt}from"./ComponentCard-D1jlqcCg.js";import{H as xt}from"./HtmlCode-454GHr9J.js";import{S as gt}from"./SinyImageList-BK8CN1Rp.js";/* empty css                   */import{M as vt,N as yt,D as wt}from"./NotionStyleEditor-Dr_q9T1l.js";import{I as jt}from"./IpInfo-CJmPbX8D.js";function $e(e,t){let a;const r=()=>{const{currentTime:n}=t,c=(n===null?0:n.value)/100;a!==c&&e(c),a=c};return B.update(r,!0),()=>he(r)}const q=new WeakMap;let _;function kt(e,t){if(t){const{inlineSize:a,blockSize:r}=t[0];return{width:a,height:r}}else return e instanceof SVGElement&&"getBBox"in e?e.getBBox():{width:e.offsetWidth,height:e.offsetHeight}}function Nt({target:e,contentRect:t,borderBoxSize:a}){var r;(r=q.get(e))===null||r===void 0||r.forEach(n=>{n({target:e,contentSize:t,get size(){return kt(e,a)}})})}function bt(e){e.forEach(Nt)}function $t(){typeof ResizeObserver>"u"||(_=new ResizeObserver(bt))}function St(e,t){_||$t();const a=Te(e);return a.forEach(r=>{let n=q.get(r);n||(n=new Set,q.set(r,n)),n.add(t),_?.observe(r)}),()=>{a.forEach(r=>{const n=q.get(r);n?.delete(t),n?.size||_?.unobserve(r)})}}const Y=new Set;let F;function Ct(){F=()=>{const e={width:window.innerWidth,height:window.innerHeight},t={target:window,size:e,contentSize:e};Y.forEach(a=>a(t))},window.addEventListener("resize",F)}function Tt(e){return Y.add(e),F||Ct(),()=>{Y.delete(e),!Y.size&&F&&(F=void 0)}}function Et(e,t){return typeof e=="function"?Tt(e):St(e,t)}const _t=50,ne=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),Lt=()=>({time:0,x:ne(),y:ne()}),Mt={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function ae(e,t,a,r){const n=a[t],{length:i,position:c}=Mt[t],o=n.current,d=a.time;n.current=e[`scroll${c}`],n.scrollLength=e[`scroll${i}`]-e[`client${i}`],n.offset.length=0,n.offset[0]=0,n.offset[1]=n.scrollLength,n.progress=Ee(0,n.scrollLength,n.current);const l=r-d;n.velocity=l>_t?0:_e(n.current-o,l)}function zt(e,t,a){ae(e,"x",t,a),ae(e,"y",t,a),t.time=a}function Ot(e,t){const a={x:0,y:0};let r=e;for(;r&&r!==t;)if(r instanceof HTMLElement)a.x+=r.offsetLeft,a.y+=r.offsetTop,r=r.offsetParent;else if(r.tagName==="svg"){const n=r.getBoundingClientRect();r=r.parentElement;const i=r.getBoundingClientRect();a.x+=n.left-i.left,a.y+=n.top-i.top}else if(r instanceof SVGGraphicsElement){const{x:n,y:i}=r.getBBox();a.x+=n,a.y+=i;let c=null,o=r.parentNode;for(;!c;)o.tagName==="svg"&&(c=o),o=r.parentNode;r=c}else break;return a}const J={start:0,center:.5,end:1};function re(e,t,a=0){let r=0;if(e in J&&(e=J[e]),typeof e=="string"){const n=parseFloat(e);e.endsWith("px")?r=n:e.endsWith("%")?e=n/100:e.endsWith("vw")?r=n/100*document.documentElement.clientWidth:e.endsWith("vh")?r=n/100*document.documentElement.clientHeight:e=n}return typeof e=="number"&&(r=t*e),a+r}const Ht=[0,0];function Bt(e,t,a,r){let n=Array.isArray(e)?e:Ht,i=0,c=0;return typeof e=="number"?n=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?n=e.split(" "):n=[e,J[e]?e:"0"]),i=re(n[0],a,r),c=re(n[1],t),i-c}const Rt={All:[[0,0],[1,1]]},Wt={x:0,y:0};function Ft(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function At(e,t,a){const{offset:r=Rt.All}=a,{target:n=e,axis:i="y"}=a,c=i==="y"?"height":"width",o=n!==e?Ot(n,e):Wt,d=n===e?{width:e.scrollWidth,height:e.scrollHeight}:Ft(n),l={width:e.clientWidth,height:e.clientHeight};t[i].offset.length=0;let u=!t[i].interpolate;const h=r.length;for(let x=0;x<h;x++){const m=Bt(r[x],l[c],d[c],o[i]);!u&&m!==t[i].interpolatorOffsets[x]&&(u=!0),t[i].offset[x]=m}u&&(t[i].interpolate=Le(t[i].offset,Me(r),{clamp:!1}),t[i].interpolatorOffsets=[...t[i].offset]),t[i].progress=ze(0,1,t[i].interpolate(t[i].current))}function Vt(e,t=e,a){if(a.x.targetOffset=0,a.y.targetOffset=0,t!==e){let r=t;for(;r&&r!==e;)a.x.targetOffset+=r.offsetLeft,a.y.targetOffset+=r.offsetTop,r=r.offsetParent}a.x.targetLength=t===e?t.scrollWidth:t.clientWidth,a.y.targetLength=t===e?t.scrollHeight:t.clientHeight,a.x.containerLength=e.clientWidth,a.y.containerLength=e.clientHeight}function Pt(e,t,a,r={}){return{measure:()=>Vt(e,r.target,a),update:n=>{zt(e,a,n),(r.offset||r.target)&&At(e,a,r)},notify:()=>t(a)}}const R=new WeakMap,ie=new WeakMap,K=new WeakMap,le=e=>e===document.documentElement?window:e;function te(e,{container:t=document.documentElement,...a}={}){let r=K.get(t);r||(r=new Set,K.set(t,r));const n=Lt(),i=Pt(t,e,n,a);if(r.add(i),!R.has(t)){const o=()=>{for(const x of r)x.measure()},d=()=>{for(const x of r)x.update(fe.timestamp)},l=()=>{for(const x of r)x.notify()},u=()=>{B.read(o,!1,!0),B.read(d,!1,!0),B.update(l,!1,!0)};R.set(t,u);const h=le(t);window.addEventListener("resize",u,{passive:!0}),t!==document.documentElement&&ie.set(t,Et(t,u)),h.addEventListener("scroll",u,{passive:!0})}const c=R.get(t);return B.read(c,!1,!0),()=>{var o;he(c);const d=K.get(t);if(!d||(d.delete(i),d.size))return;const l=R.get(t);R.delete(t),l&&(le(t).removeEventListener("scroll",l),(o=ie.get(t))===null||o===void 0||o(),window.removeEventListener("resize",l))}}function qt({source:e,container:t,axis:a="y"}){e&&(t=e);const r={value:0},n=te(i=>{r.value=i[a].progress*100},{container:t,axis:a});return{currentTime:r,cancel:n}}const Q=new Map;function Se({source:e,container:t=document.documentElement,axis:a="y"}={}){e&&(t=e),Q.has(t)||Q.set(t,{});const r=Q.get(t);return r[a]||(r[a]=He()?new ScrollTimeline({source:t,axis:a}):qt({source:t,axis:a})),r[a]}function Yt(e){return e.length===2}function Ce(e){return e&&(e.target||e.offset)}function Gt(e,t){return Yt(e)||Ce(t)?te(a=>{e(a[t.axis].progress,a)},t):$e(e,Se(t))}function Kt(e,t){if(e.flatten(),Ce(t))return e.pause(),te(a=>{e.time=e.duration*a[t.axis].progress},t);{const a=Se(t);return e.attachTimeline?e.attachTimeline(a,r=>(r.pause(),$e(n=>{r.time=r.duration*n},a))):Oe}}function Qt(e,{axis:t="y",...a}={}){const r={axis:t,...a};return typeof e=="function"?Gt(e,r):Kt(e,r)}function oe(e,t){Be(!!(!t||t.current))}const It=()=>({scrollX:W(0),scrollY:W(0),scrollXProgress:W(0),scrollYProgress:W(0)});function Ut({container:e,target:t,layoutEffect:a=!0,...r}={}){const n=pe(It);return(a?xe:f.useEffect)(()=>(oe("target",t),oe("container",e),Qt((c,{x:o,y:d})=>{n.scrollX.set(o.current),n.scrollXProgress.set(o.progress),n.scrollY.set(d.current),n.scrollYProgress.set(d.progress)},{...r,container:e?.current||void 0,target:t?.current||void 0})),[e,t,JSON.stringify(r.offset)]),n}function Jt(e){const t=pe(()=>W(e)),{isStatic:a}=f.useContext(ge);if(a){const[,r]=f.useState(e);f.useEffect(()=>t.on("change",r),[])}return t}function ce(e){return typeof e=="number"?e:parseFloat(e)}function Xt(e,t={}){const{isStatic:a}=f.useContext(ge),r=f.useRef(null),n=Jt(se(e)?ce(e.get()):e),i=f.useRef(n.get()),c=f.useRef(()=>{}),o=()=>{const l=r.current;l&&l.time===0&&l.sample(fe.delta),d(),r.current=Re({keyframes:[n.get(),i.current],velocity:n.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:c.current})},d=()=>{r.current&&r.current.stop()};return f.useInsertionEffect(()=>n.attach((l,u)=>a?u(l):(i.current=l,c.current=u,B.update(o),n.get()),d),[JSON.stringify(t)]),xe(()=>{if(se(e))return e.on("change",l=>n.set(ce(l)))},[n]),n}const Zt=async(e,t)=>{const a=[];let r=t;if(!e||!r)return a;for(;r&&r!=="root";){const n=await C(`memo_tree/${e}/${r}`);if(!n)break;a.unshift({id:r,...n}),r=n.parent}return a};function Dt(e,t,a,r){const n=X(),{data:i,isLoading:c}=ve({queryKey:["memoDetail",e,t?.uid,a],queryFn:async()=>{if(!a||!t||a==="insert")return{};if(e==="memo"||e==="home"){const l=await Xe(e,t.uid,a);if(l&&e==="memo"){l.path=await Zt(t?.uid,a);const u=await C(`memo_tree/${t.uid}/${a}/bm`);l.bookmark=u==="Y"?"Y":"N"}return l||{}}else if(e==="sheet")return{title:await C(`memo_sheet/${t.uid}/${a}/title`)}},enabled:!!t&&!!a,staleTime:1e3*60*5}),{mutate:o}=ye({mutationFn:async l=>{const u=e==="memo"?`memo_tree/${t.uid}/${a}/bm`:`home_txt/${a}/bookmark`;await N(u,l)},onMutate:async l=>{await n.cancelQueries({queryKey:["memoDetail",e,t?.uid,a]});const u=n.getQueryData(["memoDetail",e,t?.uid,a]);return n.setQueryData(["memoDetail",e,t?.uid,a],h=>({...h,bookmark:l})),{previousMemoDetail:u}},onError:(l,u,h)=>{n.setQueryData(["memoDetail",e,t?.uid,a],h.previousMemoDetail)},onSettled:()=>{n.invalidateQueries({queryKey:["memoDetail",e,t?.uid,a],refetchType:"all"}),n.invalidateQueries({queryKey:["twTreeData",e],refetchType:"all"}),n.invalidateQueries({queryKey:["bookmarks",t?.uid],refetchType:"all"}),r(!0)}});return{memoDetailData:i,isLoading:c,onBookmark:()=>{if(!i)return;const l=i.bookmark==="Y"?"N":"Y";o(l)}}}async function es(e,t,a=""){if(t==null||t==="")return"";if(e==="home"){const l=await C("home/tree");if(l!=null)try{return JSON.parse(l)}catch(u){console.error("Error parsing JSON data:",u)}}const r=e==="home"?"home_txt":a===""?`${e}_tree/${t}`:`${e}_txt/${t}`,n=We(Z(D,r)),i=await Fe(n);if(!i.exists()||!i.exists())return null;const c=i.val(),o=[{text:"1.React",id:"react",key:"react",parent:"root"},{text:"2.CSS",id:"css",key:"css",parent:"root"},{text:"3.Android",id:"android",key:"android",parent:"root"},{text:"4.Java",id:"java",key:"java",parent:"root"},{text:"5.이미지",id:"image",key:"image",parent:"root"},{text:"6.Etc",id:"etc",key:"etc",parent:"root"}],d=[];e==="home"&&d.push(...o);for(const l in c){const u=c[l];u.id=l;const h={id:l,key:l,text:u.title,parent:e==="home"?u.gbn:u.parent};e==="memo"?(h.icon=u.bm==="Y"?s.jsx(dt,{className:"text-red-500"}):u.icon==="Y"?s.jsx(ut,{}):null,h.droppable=!0):h.droppable=!1,!((a===""||a===void 0||a===null)&&(h.parent===void 0||h.parent===null||h.parent===""))&&(e==="home"||a===""||a===void 0||a===null?d.push(h):(u.id=l,(u.memo+"").toLowerCase().indexOf(a.toLowerCase())>-1&&(h.parent="root",h.droppable=!1,d.push(h))))}return d.sort((l,u)=>l.title>u.title?1:-1),e==="home"&&N("home/tree",JSON.stringify(d)),d}const ts=({rootDb:e})=>{const{user:t}=A(),[a,r]=we(Ae(e)),{t:n}=V(),[i,c]=f.useState({labels:[],series:[]}),o=["#6366f1","#3b82f6","#22c55e","#ef4444","#f97316","#eab308","#8b5cf6","#d946ef","#14b8a6","#a855f7"],d=async()=>{const h=await es(e==="sheet"?"memo":e,t?.uid);l(h)};f.useEffect(()=>{a&&a.labels&&a.labels.length>0?c(a):d()},[e,t,a,r]);const l=h=>{if(h&&h.length>0){const x=h.filter(v=>v.parent==="root").sort((v,j)=>v.text.localeCompare(j.text)),m=(v,j)=>{const $=j.filter(T=>T.parent===v);let M=$.length;for(const T of $)M+=m(T.id,j);return M},y=x.map(v=>v.text),w=x.map(v=>m(v.id,h)),g={labels:y,series:w};c(g),r(g)}},u=()=>{d()};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`HomeChartForm ${p.between} bg-[#f1f1f1] dark:bg-[#181818] p-2`,children:[s.jsx("div",{className:"px-6 py-5",children:s.jsx(ft,{title:n("count_stats")})}),s.jsx("button",{onClick:u,className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors mr-2","aria-label":n("reload_chart"),children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h5M20 20v-5h-5M4 4l1.5 1.5A9 9 0 0121.5 12M20 20l-1.5-1.5A9 9 0 012.5 12"})})})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 w-full gap-2 justify-center",children:[s.jsx(lt,{series:i.series,labels:i.labels,colors:o}),s.jsx(Ve,{series:[{name:n("count"),data:i.series}],labels:i.labels,colors:o}),s.jsx(ot,{series:[{name:n("count"),data:i.series}],labels:i.labels,colors:o}),s.jsx(ct,{series:i.series,labels:i.labels,colors:o})]})]})},ss=async(e,t)=>(await C(e)===void 0||N(e,null),N(t,null),"OK"),Es=async({rootDb:e,uid:t,newData:a=!1,key:r,values:n})=>{const i=e==="memo"?`${e}_txt/${t}/`:`${e}_txt/`,c=e==="memo"?`${e}_tree/${t}/`:`${e}/`;let o=r;a&&(o=je(ke(Z(D),c)).key),console.log("setFireDetailData.values=",n);const d=i+o;return N(d+"/title",n.edTitle),n.htmlCheck==="N"||n.htmlCheck==="sheet"?N(d+"/memo",n.memoTxt):N(d+"/memo",n.content),N(d+"/date",n.edDate),N(d+"/gbn",n.edGbn),N(d+"/html",n.htmlCheck),a&&e!=="home"&&(N(`${c}/${o}/key`,o),N(`${c}/${o}/parent`,r)),e!=="home"&&(N(`${c}${o}/title`,n.edTitle),N(`${c}${o}/icon`,n.iconCheck)),o},_s=async(e,t,a,r)=>{if(r!==void 0)for(let n=0;n<r.length;n++){const i=r[n];i.del==="Y"&&(N(`${e}/${a}/image/${i.key}`,null),Ze(t,a,i))}},Ls=async(e,t,a,r)=>{for(let n=0;n<r.length;n++){const i=r[n].object,o={ext:De(i.name),name:i.name,use:"Y",sever:""},d=je(ke(Z(D),e+"/image")).key,l=await et(t,a,d,i);o.sever=tt(l.metadata.name);const u=`${e}${a}/image/${o.sever}`;N(u,o)}},de=e=>{const{t}=V();return s.jsxs("div",{className:"mx-auto grid w-full max-w-md grid-cols-4 items-center justify-center gap-2 px-4 py-2 text-center",children:[e.master&&s.jsx(P,{size:"sm",variant:"outlined",color:"brand",onClick:e.onUtil,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l-.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),s.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("util")})]})}),s.jsx(P,{size:"sm",variant:"outlined",color:"brand",onClick:e.onEdit,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),s.jsx("path",{d:"m15 5 4 4"})]}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("edit")})]})}),s.jsx(P,{size:"sm",variant:"outlined",color:"brand",onClick:e.onNewMemo,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M5 12h14"}),s.jsx("path",{d:"M12 5v14"})]}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("new")})]})}),s.jsx(P,{size:"sm",variant:"outlined",color:"error",onClick:e.onDelete,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M3 6h18"}),s.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),s.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("delete")})]})})]})},ns=({rootDb:e,memoDetailData:t,onBookmark:a,searchWord:r,onDeleteTab:n})=>{const[i,c]=f.useState(!1),[o,d]=f.useState(!1),{t:l}=V(),{scrollYProgress:u}=Ut(),h=Xt(u,{stiffness:100,damping:30,restDelta:.001}),x=ee(),{memoId:m}=Pe(),w=G()?.state?.fullIndex,{user:g}=A(),v=X(),j=ye({mutationFn:async()=>{const k=e==="memo"?`${e}_txt/${g.uid}/${m}`:`${e}_txt/${m}`,E=e==="memo"?`${e}_tree/${g.uid}/${m}`:`${e}/${m}`;return await ss(k,E)},onSuccess:()=>{v.invalidateQueries({queryKey:["twTreeData",e]}),n&&n(m),x(`/${e==="memo"?"m":e}`)},onError:k=>{console.error("삭제 중 오류 발생:",k)}}),$=()=>{const k=`/${e==="memo"?"m":e}/edit/${m}`;x(k,{state:{fullIndex:w}})},M=()=>{const k=`/${e==="memo"?"m":e}/util/${m}`;x(k,{state:{fullIndex:w}})},T=()=>{const k=`/${e==="memo"?"m":e}/insert/${m}`;x(k,{state:{fullIndex:w}})},b=()=>{c(!0)},z=()=>{c(!1),j.mutate()};return f.useEffect(()=>{function k(){const E=t.scrollY?t.scrollY:0;window.scrollTo({top:E})}t&&t.memo!==null&&(k(),t.image&&t.image.map((E,gs)=>E))},[t]),m===""||g===void 0?s.jsx(s.Fragment,{}):s.jsxs("div",{className:"MemoDetail py-2",children:[s.jsx(S.div,{className:"progress-bar",style:{scaleX:h}}),s.jsxs("div",{className:"overflow-hidden ",children:[s.jsxs("div",{className:"p-2 sm:p-4",children:[s.jsxs("div",{className:p.between,children:[s.jsxs("p",{className:`${p.truncate} ${p.textXs} ${p.textGray500DarkZinc400}`,children:[s.jsx(I,{to:e==="memo"?"/m":"/hmoe",className:`${p.navLinkHoverText}`,children:e==="memo"?"MEMO":"HOME"}),t?.path?.map((k,E)=>t.path.length===E+1?` > ${k?.title}`:s.jsxs(L.Fragment,{children:[" "," > ",s.jsx(I,{to:e==="memo"?`/m/${k.id}`:`/home/${k.id}`,className:`${p.navLinkHoverText}`,children:k?.title})]},E))]}),s.jsx(S.button,{whileTap:{scale:.8},className:`${p.flexShrink0} ${p.roundedFull} p-2 ${p.buttonHoverGrayLight}`,"aria-label":l("bookmark"),onClick:a,children:t?.bookmark==="Y"?s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`${p.h5W5} ${p.textRed500}`,fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}):s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`${p.h5W5} ${p.textGray500}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})})]}),s.jsx("button",{onClick:()=>d(!o),className:`text-left ${p.heading2XlBoldSm3Xl} ${p.textGray900}`,children:t?.title})]}),!o&&s.jsx("div",{className:`${p.line}`}),s.jsx(S.div,{initial:!1,animate:{height:o?"auto":0,opacity:o?1:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:s.jsx("div",{className:`${p.line}`,children:s.jsx(de,{master:g?.uid===U,rootDb:e,onEdit:$,onUtil:M,onNewMemo:T,onDelete:b})})}),t&&t.html==="sheet"&&s.jsx(vt,{rootDb:e,detailData:t}),s.jsxs("div",{className:`MemoDetail_Content ${t?.memo?.length>0?"p-2 sm:p-4":"p-1"}`,children:[t&&t.html!=="sheet"?t?.html==="N"?s.jsx(xt,{postData:t?.memo,highlightWord:r}):t?.html!=="N"&&t?.memo&&s.jsx(qe,{text:t.memo}):"",s.jsx(gt,{imageList:t?.image}),!t&&s.jsx("div",{className:"flex justify-center py-12",children:s.jsx("div",{className:`${p.flexCenter} py-12`})})]})]}),s.jsx(yt,{rootDb:e,memoId:m,readOnly:!1}),s.jsx(S.div,{initial:!1,animate:{height:o?"auto":0,opacity:o?1:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:s.jsx("div",{className:`${p.line}`,children:s.jsx(de,{master:g?.uid===U,rootDb:e,onEdit:$,onUtil:M,onNewMemo:T,onDelete:b})})}),s.jsx(Ye,{isOpen:i,size:"sm",color:"warning",title:l("delete_confirm_title"),message:l("delete_confirm_message"),onClose:()=>c(!1),onConfirm:z})]})},as=({rootDb:e})=>{const{user:t}=A(),{t:a}=V(),r=a(e==="memo"?"appMemo":"home_mng"),n=s.jsx("div",{className:"text-center",children:s.jsx("h1",{className:`text-3xl font-bold ${p.textIndigo}`,children:r})});return s.jsx(s.Fragment,{children:s.jsx(pt,{title:n,className:"my-5",children:s.jsxs("div",{className:"grid gird-cols-1 md:grid-cols-5 items-center gap-3",children:[t===null?s.jsx("p",{className:`${p.textRed500} ${p.textLgFontSemiboldLeft} ${p.mdColSpan3}`,children:a("login_used")}):s.jsx("p",{className:`${p.textGray600DarkZinc400} text-left ${p.mdColSpan3}`,dangerouslySetInnerHTML:{__html:a("memo_main_guide").replace(`
`,"<br/>")}}),s.jsx("div",{className:`w-full ${p.flexCenter} md:col-span-2`,children:s.jsx(jt,{})})]})})})},rs=L.lazy(()=>H(()=>import("./MemoSheet-CroenuqB.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),is=L.lazy(()=>H(()=>import("./MemoSheetGrid-TvJlYItt.js"),__vite__mapDeps([14,1,2,3,6,7,8,4,9,10,11,12,13]))),ue=L.lazy(()=>H(()=>import("./MemoDetailEdit-BMEszbE1.js"),__vite__mapDeps([15,1,2,16,17,18,10,19,20,7,8,4,9,11,12,13,21,22,23,24,25,26,27,28,6,29,30,31,32,33,5,34,35,36]))),ls=L.lazy(()=>H(()=>import("./TwMemoDetailUtil-DHH86-Ni.js"),__vite__mapDeps([37,1,2,20,6,7,8,4,9,10,11,12,13,16,17,18,29,30,31,32,33,5,34,36]))),os=L.lazy(()=>H(()=>import("./index-CjFOdZ7J.js").then(e=>e.eV),__vite__mapDeps([1,2]))),cs=L.lazy(()=>H(()=>import("./HomeChartVisitors-0MHorz8F.js"),__vite__mapDeps([38,1,2,4]))),ds=L.lazy(()=>H(()=>import("./MemoBookMark-GajUI3id.js"),__vite__mapDeps([39,1,2,4,40])).then(e=>({default:e.MemoBookMark}))),me=()=>s.jsxs("div",{className:`w-full ${p.card} relative overflow-hidden p-4`,children:[s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-6 bg-gray-300 dark:bg-zinc-700 rounded-md w-3/4"}),s.jsx("div",{className:"mt-4 h-4 bg-gray-300 dark:bg-zinc-700 rounded-md w-1/2"})]}),s.jsx("div",{className:`${p.line} my-4`}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-3 animate-pulse",children:[s.jsx("div",{className:"h-4 bg-gray-300 dark:bg-zinc-700 rounded w-full",style:{animationDelay:"0.1s"}}),s.jsx("div",{className:"h-4 bg-gray-300 dark:bg-zinc-700 rounded w-5/6",style:{animationDelay:"0.2s"}}),s.jsx("div",{className:"h-4 bg-gray-300 dark:bg-zinc-700 rounded w-full",style:{animationDelay:"0.3s"}})]}),s.jsx("br",{}),s.jsxs("div",{className:"space-y-3 animate-pulse",children:[s.jsx("div",{className:"h-4 bg-gray-300 dark:bg-zinc-700 rounded w-full",style:{animationDelay:"0.4s"}}),s.jsx("div",{className:"h-4 bg-gray-300 dark:bg-zinc-700 rounded w-4/6",style:{animationDelay:"0.5s"}})]}),s.jsx("div",{className:"space-y-3 animate-pulse pt-4",children:s.jsx("div",{className:"h-4 bg-gray-300 dark:bg-zinc-700 rounded w-full",style:{animationDelay:"0.6s"}})})]})]}),us=({rootDb:e,ui:t,user:a,memoId:r,memoDetailData:n,isLoading:i,onBookmark:c,handleCloseTab:o})=>{const d=G();return s.jsxs(f.Suspense,{fallback:s.jsx(me,{}),children:[s.jsx(Ne,{mode:"wait",children:s.jsxs(Ge,{location:d,children:[s.jsx(O,{path:"todo",element:s.jsx(S.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(os,{})})}),s.jsx(O,{path:"sheet/:sheetId?",element:s.jsx(S.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(is,{detailData:n})})}),s.jsx(O,{path:"edit/:memoId",element:s.jsx(S.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(ue,{rootDb:e,isLoading:i,memoDetailData:n,ui:t})})}),s.jsx(O,{path:"insert/:memoId",element:s.jsx(S.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(ue,{rootDb:e,isLoading:i,memoDetailData:n,ui:t})})}),s.jsx(O,{path:"util/:memoId",element:s.jsx(S.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(ls,{rootDb:e,isLoading:i,memoDetailData:n})})}),s.jsx(O,{path:":memoId",element:s.jsx(s.Fragment,{children:i?s.jsx(me,{}):s.jsx(ns,{rootDb:e,memoDetailData:n,onBookmark:c,onDeleteTab:()=>o(null,{id:r})})})}),s.jsx(O,{path:"*",element:s.jsx(S.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(as,{rootDb:e,ui:t})})})]},d.pathname)}),(e==="memo"||e==="sheet")&&a===null?null:s.jsx(rs,{}),(e==="memo"||e==="sheet")&&s.jsx(ds,{ui:t}),(r===""||r==="m")&&a?.uid===U&&s.jsxs(s.Fragment,{children:[s.jsx(cs,{}),s.jsx("div",{className:`mt-5 ${p.card}`,children:s.jsx(ts,{rootDb:e})})]})]})},ms=e=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...e,children:s.jsx("path",{fillRule:"evenodd",d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zM6 20V4h7v5h5v11H6zM8 12h3v3H8v-3zm0 4h3v3H8v-3zm4-4h3v3h-3v-3zm0 4h3v3h-3v-3z",clipRule:"evenodd"})}),hs=({tabInfo:e,handleCloseTab:t,isActive:a})=>{const{t:r}=V(),{user:n}=A(),{attributes:i,listeners:c,setNodeRef:o,transform:d,transition:l,isDragging:u}=st({id:e.id}),h={transform:nt.Transform?.toString(d),transition:l,zIndex:u?1:"auto"},{data:x}=ve({queryKey:["tabTitle",e.rootDb,n?.uid,e.id],queryFn:async()=>e.rootDb==="sheet"?await C(`memo_sheet/${n?.uid}/${e.id}/title`):e.rootDb==="memo"?await C(`${e.rootDb}_txt/${n?.uid}/${e.id}/title`):e.rootDb==="home"?await C(`${e.rootDb}_txt/${e.id}/title`):e.title,enabled:!!n&&!!e.id,staleTime:1/0,placeholderData:e.title});return s.jsxs(I,{ref:o,style:h,...i,...c,"data-tab-id":e.id,to:e.path,title:x,end:!0,className:({isActive:m})=>`group relative flex flex-shrink-0 items-center pl-3 pr-2 py-1.5 text-sm rounded-t-md transition-colors duration-200 min-w-28 max-w-48 border-b-2
				${m?"bg-gray-200 dark:bg-zinc-700 border-blue-500 text-gray-800 dark:text-gray-100":"border-transparent text-gray-500 dark:text-gray-400 hover:bg-gray-200/70 dark:hover:bg-zinc-700/70"}
				${u?"opacity-50 shadow-lg":""}`,children:[e.rootDb==="memo"?s.jsx(Ke,{className:`w-5 h-5 mr-1 flex-shrink-0 transition-transform duration-200 ${a?"scale-110":""}`,fill:"currentColor"}):e.rootDb==="sheet"?s.jsx(ms,{className:`w-5 h-5 mr-1 flex-shrink-0 transition-transform duration-200 ${a?"scale-110":""}`}):null,s.jsx("span",{className:"truncate pr-1",style:{fontFamily:"sans-serif"},children:x||r("loading")}),s.jsx("button",{onClick:m=>t(m,e),className:`ml-auto flex-shrink-0 p-1 rounded-full transition-opacity duration-200 opacity-0 group-hover:opacity-100
					text-gray-500 dark:text-gray-400 
					hover:bg-gray-300/50 dark:hover:bg-gray-600/50 hover:text-gray-700 dark:hover:text-white
				`,children:s.jsx(be,{className:"w-3 h-3"})})]})},fs=({openTabs:e,setOpenTabs:t,handleCloseTab:a,handleCloseAllTabs:r,activeId:n})=>{const i=f.useRef(null),[c,o]=f.useState({left:!1,right:!1}),[d,l]=f.useState({left:0,width:0}),u=f.useCallback(()=>{const m=i.current;if(m){const y=m.scrollWidth>m.clientWidth,w=m.scrollLeft===0,g=m.scrollLeft+m.clientWidth>=m.scrollWidth-1;o(v=>{const j={left:y&&!w,right:y&&!g};return v.left===j.left&&v.right===j.right?v:j})}},[]),h=m=>{i.current?.scrollBy({left:m==="left"?-200:200,behavior:"smooth"})},x=m=>{const{active:y,over:w}=m;console.log("active=",y,"over=",w),y.id!==w.id&&t(g=>{const v=g.findIndex($=>$.id===y.id),j=g.findIndex($=>$.id===w.id);return it(g,v,j)})};return f.useEffect(()=>{u();const m=i.current;return m?.addEventListener("scroll",u),window.addEventListener("resize",u),()=>{m?.removeEventListener("scroll",u),window.removeEventListener("resize",u)}},[e,u]),f.useEffect(()=>{const m=setTimeout(()=>{const y=i.current?.querySelector(`[data-tab-id="${n}"]`);if(y){const{offsetLeft:w,offsetWidth:g}=y;l({left:w,width:g})}},0);return()=>clearTimeout(m)},[n,e]),s.jsxs("div",{className:"relative flex items-center justify-between ",children:[c.left&&s.jsx("button",{onClick:()=>h("left"),className:"absolute left-0 z-10 p-1 border border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 bg-white dark:bg-zinc-900 dark:hover:!text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full group",children:s.jsx(mt,{className:"w-5 h-5 fill-current"})}),s.jsx(wt,{id:"memo-tabs",onDragEnd:x,children:s.jsx("div",{ref:i,className:"MemoTabs relative flex items-center overflow-x-scroll scrollbar-hide whitespace-nowrap",children:s.jsx(at,{items:e.map(m=>m.id),strategy:rt,children:s.jsx(Ne,{children:e.map(m=>s.jsx(S.div,{layout:!0,initial:{opacity:0,scale:.8},transition:{type:"spring",stiffness:350,damping:30},animate:{opacity:1,scale:1},exit:{opacity:0,width:0,paddingLeft:0,paddingRight:0,transition:{duration:.3}},children:s.jsx(hs,{tabInfo:m,handleCloseTab:a,isActive:m.id===n})},m.id))})})})}),s.jsxs("div",{className:"flex items-center",children:[c.right&&s.jsx("button",{onClick:()=>h("right"),className:"z-10 p-1 border border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 bg-white dark:bg-zinc-900 dark:hover:!text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full group",children:s.jsx(ht,{className:"w-5 h-5 fill-current"})}),e.length>0&&s.jsx("button",{onClick:r,className:"ml-2 mr-2 p-1.5 text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md",title:"Close all tabs",children:s.jsx(be,{className:"w-4 h-4"})})]})]})};function ps(e,t,a,r,n){const i=a?.uid,[c,o]=f.useState(()=>{try{const y=localStorage.getItem(`openTabs_${i}`);return y?JSON.parse(y):[]}catch(y){return console.error("Failed to parse openTabs from localStorage",y),[]}}),d=f.useRef(),l=G(),u=ee(),h=f.useCallback(async y=>{if(e&&r&&r!=="insert"&&l.pathname!=="/m"&&l.pathname!=="/home"){const w={id:r,path:l.pathname,icon:null,rootDb:t,title:y?.title};if(l.pathname.startsWith("/m/sheet/")){const g=await C(`memo_sheet/${a?.uid}/${r}/title`);w.title=g}else r==="sheet"&&(w.title="Main Sheet");!c.some(g=>g.id===w.id)&&d.current!==r?(d.current=r,o(g=>[...g,w])):(d.current="",o(g=>g.map(v=>v.id===w.id?{...v,title:w.title||v.title}:v)))}},[n,e]);f.useEffect(()=>{n&&h(n)},[n,e]),f.useEffect(()=>{if(i)try{localStorage.setItem(`openTabs_${i}`,JSON.stringify(c))}catch(y){console.error("Failed to save openTabs to localStorage",y)}},[c,i]);const x=f.useCallback((y,w)=>{y?.preventDefault(),y?.stopPropagation(),d.current="";const g=c.findIndex(j=>j.id===w.id),v=c.filter(j=>j.id!==w.id);if(o(v),l.pathname.includes(w.id)){const j=v.length>0?v[Math.max(0,g-1)].path:`/${t==="memo"||t==="sheet"?"m":t}`;u(j,{relative:"path"})}},[c,l.pathname,t,u]),m=f.useCallback(()=>{d.current="",o([]),u(`/${t==="memo"||t==="sheet"?"m":t}`)},[t,u]);return{openTabs:c,setOpenTabs:o,handleCloseTab:x,handleCloseAllTabs:m}}const xs=()=>{const e=ee(),{user:t}=A(),a=Qe(Ie),[r,n]=f.useState(!1),i=f.useRef(0),c=G(),{rootDb:o,memoId:d}=f.useMemo(()=>{const b=c.pathname,z=b.startsWith("/m/sheet")?"sheet":b.startsWith("/m")?"memo":b.startsWith("/home")?"home":b.startsWith("/bible")?"bible":"default",k=b.split("/").pop()||"";return{rootDb:z,memoId:k}},[c.pathname]),l=c?.state?.reflash===!0,u=X(),{ui:h}=Ue(),[x,m]=we(Je),{memoDetailData:y,isLoading:w,onBookmark:g}=Dt(o,t,d,m),{openTabs:v,setOpenTabs:j,handleCloseTab:$,handleCloseAllTabs:M}=ps(a,o,t,d,y);f.useEffect(()=>{l&&u.invalidateQueries({queryKey:["memoDetail",o,t?.uid,d]})},[l,c.pathname,u,o,t?.uid,d]);const T=f.useCallback(()=>{const b=window.pageYOffset||document.documentElement.scrollTop;n(b>i.current),i.current=b<=0?0:b},[]);return f.useEffect(()=>{const b=()=>{const z=window.pageYOffset||document.documentElement.scrollTop;z>i.current?n(!1):n(!0),i.current=z<=0?0:z};return window.addEventListener("scroll",b),()=>{window.removeEventListener("scroll",b)}},[T]),f.useEffect(()=>{t===null&&c.pathname!=="/m"&&e("/m")},[t]),s.jsxs(s.Fragment,{children:[a&&s.jsx("div",{className:`sticky ${r?"top-18":"top-1"} z-1000 rounded-t-md bg-gray-50/70 dark:bg-zinc-800/70 backdrop-blur-sm shadow-sm`,children:s.jsx(fs,{openTabs:v,setOpenTabs:j,handleCloseTab:$,handleCloseAllTabs:M,activeId:d})}),s.jsx(us,{rootDb:o,ui:h,user:t,memoId:d,memoDetailData:y,isLoading:w,onBookmark:g,handleCloseTab:$})]})},Ms=Object.freeze(Object.defineProperty({__proto__:null,default:xs},Symbol.toStringTag,{value:"Module"}));export{Ms as M,Xt as a,Ls as b,_s as f,Es as s,Ut as u};
