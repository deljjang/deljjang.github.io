import{z as v,C as y,r as i,D as _,J as H,A as N,K as P,M as C,j as e,E as R,T as B,F as G,i as A,y as g,N as K,O as q,n as z,t as J}from"./index-BTQulWNG.js";import{H as O,f,a as h,b as U}from"./fireDetail-Dh1lIWrw.js";import{c as X}from"./CodeText-6Y8HehdA.js";import"./SinyDate-Bhu6aSwD.js";import"./TextField-DJm2DItP.js";import"./InputAdornment-9Vtg9kB1.js";import"./Popper-D2gl7j1p.js";import"./Button-14YbiRkg.js";import"./Chip-Bl42g2WS.js";import"./AniButton-BrIreEWS.js";import"./index.esm-CCH_oCxu.js";import"./datetime-BDx6lZXm.js";const rt=()=>{const{title:r,gbn:p,date:b,text:a,image:m,setFireId:w,isLoading:j}=v(),s=y(),d=i.useRef(),{homeId:t}=_(),u=H()?.state?.fullIndex,{user:c}=N(),{settings:I,saveSettings:L}=P(),T=()=>{s(`/blog/${t}`)},$=async(o,l)=>{const n=await f(void 0,"home_txt/","home/",u,o);await h("home_txt","home",n,l),n!==void 0&&s(`/homemng/${n}`),d.current=!1,s(`/blog/${t}`)},E=async(o,l,x)=>{await U("home_txt","home",t,l),await f(t,"home_txt/","home/",`${o.edGbn}/sub/${t}`,o);const F=await h("home_txt","home",t,x);console.log("onPostSubmit.imageResult",F);const M=await q(z(J,`home/${o.edGbn}/title`),o.edGbn);console.log("onPostSubmit.setTitle=",M),s(`/blog/${t}`)};i.useEffect(()=>{L({...I,nodeId:t}),C(t,u),w(`home_txt/${t}`,`home/${t}`,"")},[t,c]);function S(){document.querySelectorAll("pre").forEach(o=>{o.innerHTML=X(o.innerHTML)})}return i.useEffect(()=>{a!==null&&S()},[a]),console.log("homeId=",t),console.log("detailTitle=",r.current),t===""||c===void 0||a===null?e.jsx(e.Fragment,{}):(c.uid!==R&&s("/"),console.log("image=",m),e.jsxs(e.Fragment,{children:[e.jsx(B,{children:r.current}),e.jsx(i.Suspense,{fallback:e.jsx(g,{}),children:e.jsxs(G,{className:"container",sx:{p:0,width:"100%"},children:[e.jsx(O,{newMode:d.current,onPostSubmit:E,onNewSubmit:$,onCancel:T,title:r.current,gbn:p.current,date:b.current,content:a,imageList:m}),e.jsx(A,{sx:{my:2,overflow:"hidden",overflowX:"auto"},children:j&&e.jsx(g,{})})]})}),e.jsx(K,{})]}))};export{rt as default};
