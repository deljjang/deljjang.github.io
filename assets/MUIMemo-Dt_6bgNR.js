const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomeChartForm-d-P6s9-t.js","assets/index-CWXZ9Iq7.js","assets/index-D5pUttOI.css","assets/fireMemoDetail-BduFqwbn.js","assets/SinyDate-CpWx5gc7.js","assets/Grid-Bx-A-J7h.js","assets/index-DuSkT2D9.js","assets/TextField-XAy3nOlk.js","assets/InputAdornment-CDjNKjRu.js","assets/Popper-CsuMSaOJ.js","assets/Button-BeXkAMi8.js","assets/Chip-Dj2J4FBL.js","assets/index.esm-DUnqmaXe.js","assets/TwTitleItem-DohviPhG.js","assets/HomeChartSemiDonut-DsEJtQFt.js","assets/HomeChartForm-DlNaLvKe.css","assets/MUIMemoMain-De08Mq0h.js"])))=>i.map(i=>d[i]);
import{bJ as Pe,cE as $e,cF as Le,be as Fe,e as ie,G as ae,r as p,j as l,k as G,q as rt,c8 as it,o as at,a as ct,f as dt,S as ut,c7 as ft,af as ce,ab as T,aG as mt,ag as _e,ad as Oe,ac as Ae,aO as Ve,aj as Be,a3 as Q,ai as He,an as Ke,au as se,a9 as J,Y as gt,a7 as xt,al as pt,B as $,l as pe,cO as ht,D as q,E as Ue,w as Ne,bd as bt,a4 as Nt,N as vt,I as It,K as yt,bf as Se,cW as ge,H as We,_ as ze,cX as St,s as qe,z as Ct,n as wt,v as le}from"./index-CWXZ9Iq7.js";import{T as kt,u as Ye,a as Ge,F as jt,d as Et,f as Tt,D as Dt,l as Rt,I as Mt,e as Ce,b as we,c as Pt,g as $t,H as Lt}from"./HomeChartForm-d-P6s9-t.js";import{a as Ft}from"./TwTitleItem-DohviPhG.js";import{A as V}from"./AniButton-Da5aXNPU.js";import{C as Je}from"./Collapse-DzNU7c_7.js";import{S as _t}from"./SinyImageList-BNGkuYN9.js";import{H as Qe}from"./HtmlCode-CDmNEW7V.js";import{c as Ot}from"./CodeText-BRVgeDAS.js";import{s as Xe}from"./commonUtil-B50YfFwa.js";import{u as At}from"./useWindowDimensions-CUP5TSpt.js";import{D as Vt}from"./datetime-BDx6lZXm.js";import{u as Bt}from"./index.esm-DUnqmaXe.js";import{S as Ht}from"./SinyDate-CpWx5gc7.js";import{S as Kt}from"./SinySelect-BVzqStIk.js";import{T as re}from"./TwBadge-D7d4nW_h.js";import{T as Ut}from"./TwCheckbox-C9vQDU0i.js";import{T as Wt}from"./TwTextArea-BF_wguLQ.js";import{T as zt}from"./TextField-XAy3nOlk.js";import{f as qt}from"./fireMemoDetail-BduFqwbn.js";import{a as Yt}from"./memoFun-Y--qyd20.js";import"./HomeChartSemiDonut-DsEJtQFt.js";import"./Button-BeXkAMi8.js";import"./ImageListItem-CyddnCPN.js";/* empty css                 */import"./copy-ClEKdPPf.js";import"./ComponentCard-BXZLOOkn.js";import"./TwRadio-D34cp2jy.js";import"./toPropertyKey-DCwh5dYN.js";import"./Grid-Bx-A-J7h.js";import"./index-DuSkT2D9.js";import"./InputAdornment-CDjNKjRu.js";import"./Popper-CsuMSaOJ.js";import"./Chip-Dj2J4FBL.js";var W={},ke;function Gt(){if(ke)return W;ke=1;var e=Pe();Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var t=e($e()),o=Le();return W.default=(0,t.default)((0,o.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"ChevronRight"),W}var Jt=Gt();const Qt=Fe(Jt);var z={},je;function Xt(){if(je)return z;je=1;var e=Pe();Object.defineProperty(z,"__esModule",{value:!0}),z.default=void 0;var t=e($e()),o=Le();return z.default=(0,t.default)((0,o.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore"),z}var Zt=Xt();const eo=Fe(Zt);function to({onSelected:e}){const{user:t}=ie(),o=ae(),[n,r]=p.useState(),[m,x]=p.useState(),i=async c=>{const a=[],g=rt(ct(dt,`memo_tree/${c}`),at("bm"),it("Y")),d=await ut(g);if(!d.exists())return console.log("getBookmark.getFireData.null"),null;const N=d.val();for(let u in N){const s=N[u];s.id=u,s.key=u,s.text=s.title,a.push(s)}a.sort((u,s)=>u.title>s.title?1:-1),r([...a])};return p.useEffect(()=>{t!==void 0&&t!=null&&i(t?.uid)},[t]),p.useEffect(()=>{const c=async(a,g)=>{const d=[...g];if(g)for(const N of g){let u=N;for(;u.parent!==void 0&&u.parent!=="root";){const s=u.parent;u=await ft(`memo_tree/${a}/${s}`);const f={id:u.key,text:u.title,droppable:!1,parent:u.parent};d.filter(b=>b.id===f.id).length===0&&d.push(f)}}for(const N of d){const u=N.id;N.cnt=d.filter(s=>s.parent===u).length}x(d)};n&&n.length>0&&c(t?.uid,n)},[n]),t===null?l.jsx(l.Fragment,{}):l.jsxs("div",{className:"tail-bookmark justify-items-center flex items-center flex-col w-full",children:[l.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),l.jsx(Ft,{children:"주요 목록"}),l.jsx("div",{className:`tail-bookmark 
        grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-1 
        justify-items-center 
        w-full`,children:n&&n.map((c,a)=>l.jsx("div",{children:l.jsx("button",{className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 cursor-pointer",onClick:()=>{e(c.key),o(`/m/${c.key}`)},children:l.jsx("span",{className:"text-base",children:c.title})})},a))}),l.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600 my-3"}),l.jsx(p.Suspense,{fallback:l.jsx(G,{}),children:l.jsx(kt,{initTreeData:m,uid:t?.uid})})]})}const oo=["element"];function no(e,t){for(let o=0;o<e.length;o+=1)if(t(e[o]))return o;return-1}function so(e,t){let o=0,n=e.length-1;for(;o<=n;){const r=Math.floor((o+n)/2);if(e[r].element===t)return r;e[r].element.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING?n=r-1:o=r+1}return o}const Ze=p.createContext({});function lo(e){const t=p.useRef(null);return p.useEffect(()=>{t.current=e},[e]),t.current}const Ee=()=>{};function ro(e){const[,t]=p.useState(),{registerDescendant:o=Ee,unregisterDescendant:n=Ee,descendants:r=[],parentId:m=null}=p.useContext(Ze),x=no(r,a=>a.element===e.element),i=lo(r),c=r.some((a,g)=>i&&i[g]&&i[g].element!==a.element);return mt(()=>{if(e.element)return o(T({},e,{index:x})),()=>{n(e.element)};t({})},[o,n,x,c,e]),{parentId:m,index:x}}function et(e){const{children:t,id:o}=e,[n,r]=p.useState([]),m=p.useCallback(c=>{let{element:a}=c,g=ce(c,oo);r(d=>{if(d.length===0)return[T({},g,{element:a,index:0})];const N=so(d,a);let u;if(d[N]&&d[N].element===a)u=d;else{const s=T({},g,{element:a,index:N});u=d.slice(),u.splice(N,0,s)}return u.forEach((s,f)=>{s.index=f}),u})},[]),x=p.useCallback(c=>{r(a=>a.filter(g=>c!==g.element))},[]),i=p.useMemo(()=>({descendants:n,registerDescendant:m,unregisterDescendant:x,parentId:o}),[n,m,x,o]);return l.jsx(Ze.Provider,{value:i,children:t})}const tt={instance:null,multiSelect:!1,disabledItemsFocusable:!1,treeId:void 0,icons:{defaultCollapseIcon:null,defaultExpandIcon:null,defaultParentIcon:null,defaultEndIcon:null}},ot=p.createContext(tt),nt=()=>p.useContext(ot);function io(e){const{instance:t,multiSelect:o}=nt(),n=t?t.isNodeExpandable(e):!1,r=t?t.isNodeExpanded(e):!1,m=t?t.isNodeFocused(e):!1,x=t?t.isNodeSelected(e):!1,i=t?t.isNodeDisabled(e):!1;return{disabled:i,expanded:r,selected:x,focused:m,handleExpansion:d=>{if(t&&!i){m||t.focusNode(d,e);const N=o&&(d.shiftKey||d.ctrlKey||d.metaKey);n&&!(N&&t.isNodeExpanded(e))&&t.toggleNodeExpansion(d,e)}},handleSelection:d=>{t&&!i&&(m||t.focusNode(d,e),o&&(d.shiftKey||d.ctrlKey||d.metaKey)?d.shiftKey?t.selectRange(d,{end:e}):t.selectNode(d,e,!0):t.selectNode(d,e))},preventSelection:d=>{(d.shiftKey||d.ctrlKey||d.metaKey||i)&&d.preventDefault()}}}const ao=["classes","className","displayIcon","expansionIcon","icon","label","nodeId","onClick","onMouseDown"],st=p.forwardRef(function(t,o){const{classes:n,className:r,displayIcon:m,expansionIcon:x,icon:i,label:c,nodeId:a,onClick:g,onMouseDown:d}=t,N=ce(t,ao),{disabled:u,expanded:s,selected:f,focused:h,handleExpansion:b,handleSelection:I,preventSelection:v}=io(a),S=i||x||m,C=j=>{v(j),d&&d(j)},k=j=>{b(j),I(j),g&&g(j)};return l.jsxs("div",T({},N,{className:_e(r,n.root,s&&n.expanded,f&&n.selected,h&&n.focused,u&&n.disabled),onClick:k,onMouseDown:C,ref:o,children:[l.jsx("div",{className:n.iconContainer,children:S}),l.jsx("div",{className:n.label,children:c})]}))});function co(e){return Ae("MuiTreeItem",e)}const D=Oe("MuiTreeItem",["root","group","content","expanded","selected","focused","disabled","iconContainer","label"]),uo=["children","className","collapseIcon","ContentComponent","ContentProps","endIcon","expandIcon","disabled","icon","id","label","nodeId","onClick","onMouseDown","TransitionComponent","TransitionProps"],fo=e=>{const{classes:t}=e;return He({root:["root"],content:["content"],expanded:["expanded"],selected:["selected"],focused:["focused"],disabled:["disabled"],iconContainer:["iconContainer"],label:["label"],group:["group"]},co,t)},mo=Q("li",{name:"MuiTreeItem",slot:"Root",overridesResolver:(e,t)=>t.root})({listStyle:"none",margin:0,padding:0,outline:0}),go=Q(st,{name:"MuiTreeItem",slot:"Content",overridesResolver:(e,t)=>[t.content,t.iconContainer&&{[`& .${D.iconContainer}`]:t.iconContainer},t.label&&{[`& .${D.label}`]:t.label}]})(({theme:e})=>({padding:"0 8px",width:"100%",boxSizing:"border-box",display:"flex",alignItems:"center",cursor:"pointer",WebkitTapHighlightColor:"transparent","&:hover":{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${D.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity,backgroundColor:"transparent"},[`&.${D.focused}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${D.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:se(e.palette.primary.main,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:se(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:se(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${D.focused}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:se(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`& .${D.iconContainer}`]:{marginRight:4,width:15,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},[`& .${D.label}`]:T({paddingLeft:4,width:"100%",boxSizing:"border-box",minWidth:0,position:"relative"},e.typography.body1)})),xo=Q(Je,{name:"MuiTreeItem",slot:"Group",overridesResolver:(e,t)=>t.group})({margin:0,padding:0,marginLeft:17}),po=p.forwardRef(function(t,o){const n=Ve({props:t,name:"MuiTreeItem"}),{children:r,className:m,collapseIcon:x,ContentComponent:i=st,ContentProps:c,endIcon:a,expandIcon:g,disabled:d,icon:N,id:u,label:s,nodeId:f,onClick:h,onMouseDown:b,TransitionComponent:I=Je,TransitionProps:v}=n,S=ce(n,uo),{icons:C,multiSelect:k,disabledItemsFocusable:j,treeId:M,instance:E}=nt();let P;u!=null?P=u:M&&f&&(P=`${M}-${f}`);const[X,de]=p.useState(null),Z=p.useRef(null),ue=Be(de,o),fe=p.useMemo(()=>({element:X,id:f}),[f,X]),{index:H,parentId:ee}=ro(fe),F=!!(Array.isArray(r)?r.length:r),_=E?E.isNodeExpanded(f):!1,te=E?E.isNodeFocused(f):!1,K=E?E.isNodeSelected(f):!1,L=E?E.isNodeDisabled(f):!1,y=T({},n,{expanded:_,focused:te,selected:K,disabled:L}),w=fo(y);let O,U;F&&(_?U=x||C.defaultCollapseIcon:U=g||C.defaultExpandIcon),F?O=C.defaultParentIcon:O=a||C.defaultEndIcon,p.useEffect(()=>{if(E&&H!==-1)return E.updateNode({id:f,idAttribute:P,index:H,parentId:ee,expandable:F,disabled:d}),()=>E.removeNode(f)},[E,ee,H,f,F,d,P]),p.useEffect(()=>{if(E&&s){var R,ne;return E.mapFirstChar(f,((R=(ne=Z.current)==null?void 0:ne.textContent)!=null?R:"").substring(0,1).toLowerCase())}},[E,f,s]);let A;k?A=K:K&&(A=!0);function oe(R){if(R.target===R.currentTarget){let me;typeof R.target.getRootNode=="function"?me=R.target.getRootNode():me=Ke(R.target),me.getElementById(M).focus({preventScroll:!0})}const ne=!j&&L;E&&!te&&R.currentTarget===R.target&&!ne&&E.focusNode(R,f)}return l.jsxs(mo,T({className:_e(w.root,m),role:"treeitem","aria-expanded":F?_:void 0,"aria-selected":A,"aria-disabled":L||void 0,id:P,tabIndex:-1},S,{ownerState:y,onFocus:oe,ref:ue,children:[l.jsx(go,T({as:i,ref:Z,classes:{root:w.content,expanded:w.expanded,selected:w.selected,focused:w.focused,disabled:w.disabled,iconContainer:w.iconContainer,label:w.label},label:s,nodeId:f,onClick:h,onMouseDown:b,icon:N,expansionIcon:U,displayIcon:O,ownerState:y},c)),r&&l.jsx(et,{id:f,children:l.jsx(xo,T({as:I,unmountOnExit:!0,className:w.group,in:_,component:"ul",role:"group"},v,{children:r}))})]}))});function ho(e){return Ae("MuiTreeView",e)}Oe("MuiTreeView",["root"]);const bo=(e,t)=>{const o=p.useRef({}),[n,r]=p.useState(()=>{const x={};return e.forEach(i=>{i.models&&Object.entries(i.models).forEach(([c,a])=>{o.current[c]={controlledProp:a.controlledProp,defaultProp:a.defaultProp,isControlled:t[a.controlledProp]!==void 0},x[c]=t[a.defaultProp]})}),x});return Object.fromEntries(Object.entries(o.current).map(([x,i])=>{const c=i.isControlled?t[i.controlledProp]:n[x];return[x,{value:c,setValue:a=>{i.isControlled||r(g=>T({},g,{[x]:a}))}}]}))};class No{constructor(){this.maxListeners=20,this.warnOnce=!1,this.events={}}on(t,o,n={}){let r=this.events[t];r||(r={highPriority:new Map,regular:new Map},this.events[t]=r),n.isFirst?r.highPriority.set(o,!0):r.regular.set(o,!0)}removeListener(t,o){this.events[t]&&(this.events[t].regular.delete(o),this.events[t].highPriority.delete(o))}removeAllListeners(){this.events={}}emit(t,...o){const n=this.events[t];if(!n)return;const r=Array.from(n.highPriority.keys()),m=Array.from(n.regular.keys());for(let x=r.length-1;x>=0;x-=1){const i=r[x];n.highPriority.has(i)&&i.apply(this,o)}for(let x=0;x<m.length;x+=1){const i=m[x];n.regular.has(i)&&i.apply(this,o)}}once(t,o){const n=this;this.on(t,function r(...m){n.removeListener(t,r),o.apply(n,m)})}}const xe=(e,t)=>{const o=e.getNode(t),n=e.getNavigableChildrenIds(o.parentId),r=n.indexOf(t);if(r===0)return o.parentId;let m=n[r-1];for(;e.isNodeExpanded(m)&&e.getNavigableChildrenIds(m).length>0;)m=e.getNavigableChildrenIds(m).pop();return m},Y=(e,t)=>{if(e.isNodeExpanded(t)&&e.getNavigableChildrenIds(t).length>0)return e.getNavigableChildrenIds(t)[0];let o=e.getNode(t);for(;o!=null;){const n=e.getNavigableChildrenIds(o.parentId),r=n[n.indexOf(o.id)+1];if(r)return r;o=e.getNode(o.parentId)}return null},he=e=>{let t=e.getNavigableChildrenIds(null).pop();for(;e.isNodeExpanded(t);)t=e.getNavigableChildrenIds(t).pop();return t},be=e=>e.getNavigableChildrenIds(null)[0],B=(e,t)=>{Object.assign(e,t)},vo=e=>e.isPropagationStopped!==void 0,Io=({instance:e})=>{const[t]=p.useState(()=>new No),o=p.useCallback((...r)=>{const[m,x,i={}]=r;i.defaultMuiPrevented=!1,!(vo(i)&&i.isPropagationStopped())&&t.emit(m,x,i)},[t]),n=p.useCallback((r,m)=>(t.on(r,m),()=>{t.removeListener(r,m)}),[t]);B(e,{$$publishEvent:o,$$subscribeEvent:n})},yo=[Io],So=e=>{const t=[...yo,...e.plugins],o=t.reduce((s,f)=>f.getDefaultizedParams?f.getDefaultizedParams(s):s,e),n=bo(t,o),m=p.useRef({}).current,x=p.useRef(null),i=Be(x,e.rootRef),[c,a]=p.useState(()=>{const s={};return t.forEach(f=>{f.getInitialState&&Object.assign(s,f.getInitialState(o))}),s}),g=[];let d=tt;const N=s=>{const f=s({instance:m,params:o,state:c,setState:a,rootRef:x,models:n})||{};f.getRootProps&&g.push(f.getRootProps),f.contextValue&&(d=f.contextValue)};return t.forEach(N),{getRootProps:(s={})=>{const f=T({role:"tree",tabIndex:0},s,{ref:i});return g.forEach(h=>{Object.assign(f,h(s))}),f},rootRef:i,contextValue:d}};function Co(e){const{value:t,children:o}=e;return l.jsx(ot.Provider,{value:t,children:l.jsx(et,{children:o})})}const wo=(e,t,o)=>{e.$$publishEvent(t,o)},ko=({instance:e,params:t})=>{const o=p.useRef({}),n=p.useCallback(a=>o.current[a],[]),r=p.useCallback(a=>{o.current[a.id]=a},[]),m=p.useCallback(a=>{const g=T({},o.current);delete g[a],o.current=g,wo(e,"removeNode",{id:a})},[e]),x=p.useCallback(a=>{if(a==null)return!1;let g=e.getNode(a);if(!g)return!1;if(g.disabled)return!0;for(;g.parentId!=null;)if(g=e.getNode(g.parentId),g.disabled)return!0;return!1},[e]),i=J(a=>Object.values(o.current).filter(g=>g.parentId===a).sort((g,d)=>g.index-d.index).map(g=>g.id));B(e,{getNode:n,updateNode:r,removeNode:m,getChildrenIds:i,getNavigableChildrenIds:a=>{let g=e.getChildrenIds(a);return t.disabledItemsFocusable||(g=g.filter(d=>!e.isNodeDisabled(d))),g},isNodeDisabled:x})},ve=({instance:e,params:t,models:o})=>{const n=p.useCallback(i=>Array.isArray(o.expanded.value)?o.expanded.value.indexOf(i)!==-1:!1,[o.expanded.value]),r=p.useCallback(i=>{var c;return!!((c=e.getNode(i))!=null&&c.expandable)},[e]),m=J((i,c)=>{if(c==null)return;let a;o.expanded.value.indexOf(c)!==-1?a=o.expanded.value.filter(g=>g!==c):a=[c].concat(o.expanded.value),t.onNodeToggle&&t.onNodeToggle(i,a),o.expanded.setValue(a)});B(e,{isNodeExpanded:n,isNodeExpandable:r,toggleNodeExpansion:m,expandAllSiblings:(i,c)=>{const a=e.getNode(c),d=e.getChildrenIds(a.parentId).filter(u=>e.isNodeExpandable(u)&&!e.isNodeExpanded(u)),N=o.expanded.value.concat(d);d.length>0&&(o.expanded.setValue(N),t.onNodeToggle&&t.onNodeToggle(i,N))}})};ve.models={expanded:{controlledProp:"expanded",defaultProp:"defaultExpanded"}};const jo=[];ve.getDefaultizedParams=e=>{var t;return T({},e,{defaultExpanded:(t=e.defaultExpanded)!=null?t:jo})};const Eo=(e,t,o)=>{if(t===o)return[t,o];const n=e.getNode(t),r=e.getNode(o);if(n.parentId===r.id||r.parentId===n.id)return r.parentId===n.id?[n.id,r.id]:[r.id,n.id];const m=[n.id],x=[r.id];let i=n.parentId,c=r.parentId,a=x.indexOf(i)!==-1,g=m.indexOf(c)!==-1,d=!0,N=!0;for(;!g&&!a;)d&&(m.push(i),a=x.indexOf(i)!==-1,d=i!==null,!a&&d&&(i=e.getNode(i).parentId)),N&&!a&&(x.push(c),g=m.indexOf(c)!==-1,N=c!==null,!g&&N&&(c=e.getNode(c).parentId));const u=a?i:c,s=e.getChildrenIds(u),f=m[m.indexOf(u)-1],h=x[x.indexOf(u)-1];return s.indexOf(f)<s.indexOf(h)?[t,o]:[o,t]},Ie=({instance:e,params:t,models:o})=>{const n=p.useRef(null),r=p.useRef(!1),m=p.useRef([]),x=s=>Array.isArray(o.selected.value)?o.selected.value.indexOf(s)!==-1:o.selected.value===s,i=(s,f,h=!1)=>{if(!t.disableSelection){if(h){if(Array.isArray(o.selected.value)){let b;o.selected.value.indexOf(f)!==-1?b=o.selected.value.filter(I=>I!==f):b=[f].concat(o.selected.value),t.onNodeSelect&&t.onNodeSelect(s,b),o.selected.setValue(b)}}else{const b=t.multiSelect?[f]:f;t.onNodeSelect&&t.onNodeSelect(s,b),o.selected.setValue(b)}n.current=f,r.current=!1,m.current=[]}},c=(s,f)=>{const[h,b]=Eo(e,s,f),I=[h];let v=h;for(;v!==b;)v=Y(e,v),I.push(v);return I},a=(s,f)=>{let h=o.selected.value.slice();const{start:b,next:I,current:v}=f;!I||!v||(m.current.indexOf(v)===-1&&(m.current=[]),r.current?m.current.indexOf(I)!==-1?(h=h.filter(S=>S===b||S!==v),m.current=m.current.filter(S=>S===b||S!==v)):(h.push(I),m.current.push(I)):(h.push(I),m.current.push(v,I)),t.onNodeSelect&&t.onNodeSelect(s,h),o.selected.setValue(h))},g=(s,f)=>{let h=o.selected.value.slice();const{start:b,end:I}=f;r.current&&(h=h.filter(C=>m.current.indexOf(C)===-1));let v=c(b,I);v=v.filter(C=>!e.isNodeDisabled(C)),m.current=v;let S=h.concat(v);S=S.filter((C,k)=>S.indexOf(C)===k),t.onNodeSelect&&t.onNodeSelect(s,S),o.selected.setValue(S)};return B(e,{isNodeSelected:x,selectNode:i,selectRange:(s,f,h=!1)=>{if(t.disableSelection)return;const{start:b=n.current,end:I,current:v}=f;h?a(s,{start:b,next:I,current:v}):b!=null&&I!=null&&g(s,{start:b,end:I}),r.current=!0},rangeSelectToLast:(s,f)=>{n.current||(n.current=f);const h=r.current?n.current:f;e.selectRange(s,{start:h,end:he(e)})},rangeSelectToFirst:(s,f)=>{n.current||(n.current=f);const h=r.current?n.current:f;e.selectRange(s,{start:h,end:be(e)})}}),{getRootProps:()=>({"aria-multiselectable":t.multiSelect})}};Ie.models={selected:{controlledProp:"selected",defaultProp:"defaultSelected"}};const To=[];Ie.getDefaultizedParams=e=>{var t,o,n;return T({},e,{disableSelection:(t=e.disableSelection)!=null?t:!1,multiSelect:(o=e.multiSelect)!=null?o:!1,defaultSelected:(n=e.defaultSelected)!=null?n:e.multiSelect?To:null})};const Te=1e3;class Do{constructor(t=Te){this.timeouts=new Map,this.cleanupTimeout=Te,this.cleanupTimeout=t}register(t,o,n){this.timeouts||(this.timeouts=new Map);const r=setTimeout(()=>{typeof o=="function"&&o(),this.timeouts.delete(n.cleanupToken)},this.cleanupTimeout);this.timeouts.set(n.cleanupToken,r)}unregister(t){const o=this.timeouts.get(t.cleanupToken);o&&(this.timeouts.delete(t.cleanupToken),clearTimeout(o))}reset(){this.timeouts&&(this.timeouts.forEach((t,o)=>{this.unregister({cleanupToken:o})}),this.timeouts=void 0)}}class Ro{constructor(){this.registry=new FinalizationRegistry(t=>{typeof t=="function"&&t()})}register(t,o,n){this.registry.register(t,o,n)}unregister(t){this.registry.unregister(t)}reset(){}}class Mo{}function Po(e){let t=0;return function(n,r,m){e.registry===null&&(e.registry=typeof FinalizationRegistry<"u"?new Ro:new Do);const[x]=p.useState(new Mo),i=p.useRef(null),c=p.useRef();c.current=m;const a=p.useRef(null);if(!i.current&&c.current){const g=(d,N)=>{if(!N.defaultMuiPrevented){var u;(u=c.current)==null||u.call(c,d,N)}};i.current=n.$$subscribeEvent(r,g),t+=1,a.current={cleanupToken:t},e.registry.register(x,()=>{var d;(d=i.current)==null||d.call(i),i.current=null,a.current=null},a.current)}else!c.current&&i.current&&(i.current(),i.current=null,a.current&&(e.registry.unregister(a.current),a.current=null));p.useEffect(()=>{if(!i.current&&c.current){const g=(d,N)=>{if(!N.defaultMuiPrevented){var u;(u=c.current)==null||u.call(c,d,N)}};i.current=n.$$subscribeEvent(r,g)}return a.current&&e.registry&&(e.registry.unregister(a.current),a.current=null),()=>{var g;(g=i.current)==null||g.call(i),i.current=null}},[n,r])}}const $o={registry:null},Lo=Po($o),ye=({instance:e,params:t,state:o,setState:n,models:r,rootRef:m})=>{const x=J(u=>{const s=typeof u=="function"?u(o.focusedNodeId):u;n(f=>T({},f,{focusedNodeId:s}))}),i=p.useCallback(u=>o.focusedNodeId===u,[o.focusedNodeId]),c=J((u,s)=>{s&&(x(s),t.onNodeFocus&&t.onNodeFocus(u,s))});B(e,{isNodeFocused:i,focusNode:c}),Lo(e,"removeNode",({id:u})=>{x(s=>s===u&&m.current===Ke(m.current).activeElement?e.getChildrenIds(null)[0]:s)});const a=u=>s=>{var f;if((f=u.onFocus)==null||f.call(u,s),s.target===s.currentTarget){const h=I=>{const v=e.getNode(I);return v&&(v.parentId==null||e.isNodeExpanded(v.parentId))};let b;Array.isArray(r.selected.value)?b=r.selected.value.find(h):r.selected.value!=null&&h(r.selected.value)&&(b=r.selected.value),b==null&&(b=e.getNavigableChildrenIds(null)[0]),e.focusNode(s,b)}},g=u=>s=>{var f;(f=u.onBlur)==null||f.call(u,s),x(null)},d=e.getNode(o.focusedNodeId),N=d?d.idAttribute:null;return{getRootProps:u=>({onFocus:a(u),onBlur:g(u),"aria-activedescendant":N??void 0})}};ye.getInitialState=()=>({focusedNodeId:null});ye.getDefaultizedParams=e=>{var t;return T({},e,{disabledItemsFocusable:(t=e.disabledItemsFocusable)!=null?t:!1})};function Fo(e){return e&&e.length===1&&e.match(/\S/)}function De(e,t,o){for(let n=t;n<e.length;n+=1)if(o===e[n])return n;return-1}const _o=({instance:e,params:t,state:o})=>{const r=gt().direction==="rtl",m=p.useRef({}),x=J((u,s)=>(m.current[u]=s,()=>{const f=T({},m.current);delete f[u],m.current=f}));B(e,{mapFirstChar:x});const i=u=>(o.focusedNodeId!=null&&e.isNodeExpandable(o.focusedNodeId)&&(e.isNodeExpanded(o.focusedNodeId)?e.focusNode(u,Y(e,o.focusedNodeId)):e.isNodeDisabled(o.focusedNodeId)||e.toggleNodeExpansion(u,o.focusedNodeId)),!0),c=u=>{if(o.focusedNodeId==null)return!1;if(e.isNodeExpanded(o.focusedNodeId)&&!e.isNodeDisabled(o.focusedNodeId))return e.toggleNodeExpansion(u,o.focusedNodeId),!0;const s=e.getNode(o.focusedNodeId).parentId;return s?(e.focusNode(u,s),!0):!1},a=(u,s,f)=>{let h,b;const I=f.toLowerCase(),v=[],S=[];Object.keys(m.current).forEach(C=>{const k=e.getNode(C),j=k.parentId?e.isNodeExpanded(k.parentId):!0,M=t.disabledItemsFocusable?!1:e.isNodeDisabled(C);j&&!M&&(v.push(C),S.push(m.current[C]))}),h=v.indexOf(s)+1,h>=v.length&&(h=0),b=De(S,h,I),b===-1&&(b=De(S,0,I)),b>-1&&e.focusNode(u,v[b])},g=(u,s)=>{e.isNodeDisabled(Y(e,s))||e.selectRange(u,{end:Y(e,s),current:s},!0)},d=(u,s)=>{e.isNodeDisabled(xe(e,s))||e.selectRange(u,{end:xe(e,s),current:s},!0)},N=u=>s=>{var f;(f=u.onKeyDown)==null||f.call(u,s);let h=!1;const b=s.key;if(s.altKey||s.currentTarget!==s.target||o.focusedNodeId==null)return;const I=s.ctrlKey||s.metaKey;switch(b){case" ":!t.disableSelection&&!e.isNodeDisabled(o.focusedNodeId)&&(h=!0,t.multiSelect&&s.shiftKey?e.selectRange(s,{end:o.focusedNodeId}):t.multiSelect?e.selectNode(s,o.focusedNodeId,!0):e.selectNode(s,o.focusedNodeId)),s.stopPropagation();break;case"Enter":e.isNodeDisabled(o.focusedNodeId)||(e.isNodeExpandable(o.focusedNodeId)?(e.toggleNodeExpansion(s,o.focusedNodeId),h=!0):t.disableSelection||(h=!0,t.multiSelect?e.selectNode(s,o.focusedNodeId,!0):e.selectNode(s,o.focusedNodeId))),s.stopPropagation();break;case"ArrowDown":t.multiSelect&&s.shiftKey&&!t.disableSelection&&g(s,o.focusedNodeId),e.focusNode(s,Y(e,o.focusedNodeId)),h=!0;break;case"ArrowUp":t.multiSelect&&s.shiftKey&&!t.disableSelection&&d(s,o.focusedNodeId),e.focusNode(s,xe(e,o.focusedNodeId)),h=!0;break;case"ArrowRight":r?h=c(s):h=i(s);break;case"ArrowLeft":r?h=i(s):h=c(s);break;case"Home":t.multiSelect&&I&&s.shiftKey&&!t.disableSelection&&!e.isNodeDisabled(o.focusedNodeId)&&e.rangeSelectToFirst(s,o.focusedNodeId),e.focusNode(s,be(e)),h=!0;break;case"End":t.multiSelect&&I&&s.shiftKey&&!t.disableSelection&&!e.isNodeDisabled(o.focusedNodeId)&&e.rangeSelectToLast(s,o.focusedNodeId),e.focusNode(s,he(e)),h=!0;break;default:b==="*"?(e.expandAllSiblings(s,o.focusedNodeId),h=!0):t.multiSelect&&I&&b.toLowerCase()==="a"&&!t.disableSelection?(e.selectRange(s,{start:be(e),end:he(e)}),h=!0):!I&&!s.shiftKey&&Fo(b)&&(a(s,o.focusedNodeId,b),h=!0)}h&&(s.preventDefault(),s.stopPropagation())};return{getRootProps:u=>({onKeyDown:N(u)})}},Oo=({instance:e,params:t})=>{const o=xt(t.id);return{getRootProps:()=>({id:o}),contextValue:{treeId:o,instance:e,multiSelect:t.multiSelect,disabledItemsFocusable:t.disabledItemsFocusable,icons:{defaultCollapseIcon:t.defaultCollapseIcon,defaultEndIcon:t.defaultEndIcon,defaultExpandIcon:t.defaultExpandIcon,defaultParentIcon:t.defaultParentIcon}}}},Ao=[ko,ve,Ie,ye,_o,Oo],Vo=["disabledItemsFocusable","expanded","defaultExpanded","onNodeToggle","onNodeFocus","disableSelection","defaultSelected","selected","multiSelect","onNodeSelect","id","defaultCollapseIcon","defaultEndIcon","defaultExpandIcon","defaultParentIcon","children"],Bo=e=>{const{classes:t}=e;return He({root:["root"]},ho,t)},Re=Q("ul",{name:"MuiTreeView",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:0,margin:0,listStyle:"none",outline:0}),Ho=p.forwardRef(function(t,o){const n=Ve({props:t,name:"MuiTreeView"}),r=n,m=n,{disabledItemsFocusable:x,expanded:i,defaultExpanded:c,onNodeToggle:a,onNodeFocus:g,disableSelection:d,defaultSelected:N,selected:u,multiSelect:s,onNodeSelect:f,id:h,defaultCollapseIcon:b,defaultEndIcon:I,defaultExpandIcon:v,defaultParentIcon:S,children:C}=m,k=ce(m,Vo),{getRootProps:j,contextValue:M}=So({disabledItemsFocusable:x,expanded:i,defaultExpanded:c,onNodeToggle:a,onNodeFocus:g,disableSelection:d,defaultSelected:N,selected:u,multiSelect:s,onNodeSelect:f,id:h,defaultCollapseIcon:b,defaultEndIcon:I,defaultExpandIcon:v,defaultParentIcon:S,plugins:Ao,rootRef:o}),E=Bo(n),P=pt({elementType:Re,externalSlotProps:{},externalForwardedProps:k,className:E.root,getSlotProps:j,ownerState:r});return l.jsx(Co,{value:M,children:l.jsx(Re,T({},P,{children:C}))})}),Ko=Q(po)(({theme:e})=>({color:e.palette.text.secondary,[`& .${D.content}`]:{color:e.palette.text.secondary,borderTopRightRadius:e.spacing(2),borderBottomRightRadius:e.spacing(2),paddingRight:e.spacing(1),fontWeight:e.typography.fontWeightMedium,"&.MuiTreeItem-content":{paddingLeft:"3px",paddingRight:"3px"},".MuiTreeItem-label":{paddingLeft:"0px"},".MuiTreeItem-iconContainer":{marginRight:"0px"},"&.Mui-expanded":{fontWeight:e.typography.fontWeightRegular},"&:hover":{backgroundColor:e.palette.action.hover},"&.Mui-selected":{backgroundColor:"rgba(145, 85, 253, 0.16)",color:"var(--tree-view-color)"},"&.Mui-focused, &.Mui-selected, &.Mui-selected.Mui-focused":{backgroundColor:"rgba(145, 85, 253, 0.16)",color:"var(--tree-view-color)"},[`& .${D.label}`]:{fontWeight:"inherit",color:"inherit"}},[`& .${D.group}`]:{marginLeft:0,[`& .${D.content}`]:{paddingLeft:e.spacing(1)}}})),Uo=p.forwardRef(function(t,o){const{labelIcon:n,labelInfo:r,labelText:m,pl:x,...i}=t;return l.jsx(Ko,{label:l.jsxs($,{sx:{display:"flex",alignItems:"center",p:.5,pr:2,pl:{pl:x}},children:[l.jsx($,{component:n,color:"inherit",sx:{mr:1,pl:{pl:x}}}),l.jsx(pe,{sx:{fontWeight:"inherit",flexGrow:1},component:"div",children:m}),l.jsx(pe,{variant:"caption",color:"inherit",children:r})]}),...i,ref:o})}),lt=e=>{const{id:t,fullIndex:o,title:n,sub:r}=e.item;if(t===void 0)return console.log("SubTreeItem.item.undefined=",e.item),l.jsx(l.Fragment,{});const m=r&&Object.values(r).length>0?Object.values(r).length+"":"";return l.jsx(Uo,{onClick:()=>e.onDetail(t,o),nodeId:t,labelText:n,labelInfo:m,pl:e.pl,children:r!=null?Object.values(r).sort((x,i)=>x.title>i.title?1:-1).map((x,i)=>l.jsx("div",{style:{paddingLeft:e.pl+5},children:l.jsx(lt,{onDetail:e.onDetail,item:x,pl:e.pl+5})},i+"")):""})};function Wo(e){const[t,o]=p.useState([]),[n,r]=p.useState([]),m=(c,a)=>{e.onDetail(c,a)};p.useEffect(()=>{if(e.expandIndex!==void 0){let c=e.expandIndex.split("/");c=c.filter(a=>a!=="sub"),e.expandIndex.indexOf("undefined")<0&&(o(c),r(c[c.length-1]))}},[e.expandIndex]);const x=(c,a)=>{},i=(c,a)=>{o(a)};return l.jsx($,{sx:{minHeight:180,flexGrow:1,display:"flex",flexDirection:"column",height:e.maxHeight,overflow:"hidden",overflowY:"auto",width:"100%"},children:l.jsx(Ho,{"aria-label":"icon expansion",defaultCollapseIcon:l.jsx(eo,{}),defaultExpandIcon:l.jsx(Qt,{}),expanded:t,onNodeSelect:x,selected:n,onNodeToggle:i,sx:{flexGrow:1,overflow:"hidden",overflowY:"auto"},children:e.data&&e.data.map((c,a)=>l.jsx(lt,{onDetail:m,item:c,parentIndex:a+1,pl:5},a+1))})})}const zo={position:"absolute",top:"50%",left:"50%",display:"flex",flexDirection:"column",alignItems:"center",transform:"translate(-50%, -50%)",width:250,maxHeight:"400px",bgcolor:"background.paper",border:"1px solid #000",boxShadow:24,boxSizing:"border-box",p:4},qo=e=>l.jsxs($,{sx:{my:2,mt:3,display:"flex"},children:[l.jsx(V,{type:"submit",variant:"outlined",color:"success",onClick:e.onPost,children:"확인"}),l.jsx(V,{type:"button",variant:"outlined",onClick:e.onClose,children:"취소"})]}),Yo=e=>{const[t,o]=p.useState(e.open),[n,r]=p.useState(),m=()=>{o(!1),r(void 0),e.onClose()};p.useEffect(()=>{o(e.open)},[e.open]);const x=c=>{r(c)},i=()=>{if(n===void 0){alert("이동할 메모장을 선택해 주세요");return}e.onPost(n)};return l.jsx("div",{children:l.jsx(ht,{open:t,onClose:m,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:l.jsxs($,{sx:zo,children:[l.jsx(pe,{id:"modal-modal-title",variant:"h6",component:"h2",children:"이동할 메모장 선택"}),l.jsx(q,{}),l.jsx($,{sx:{width:"100%",minHeight:110,maxHeight:200,flexGrow:1,minWidth:100,overflow:"hidden"},children:l.jsx(Wo,{data:e.data,onDetail:x,maxHeight:200})}),l.jsx(qo,{onPost:i,onClose:m})]})})})},Go=e=>l.jsxs($,{sx:{flexGrow:1,my:2,width:"100%",display:"grid",gridTemplateColumns:"64px 64px  64px  64px ",flexDirection:"row",alignItems:"center",alignContent:"center",justifyContent:"center",textAlign:"center",whiteSpace:"nowrap"},children:[l.jsx(V,{type:"button",size:"small",variant:"outlined",color:"success",onClick:e.onEdit,children:"수정"}),l.jsx(V,{type:"button",size:"small",variant:"outlined",onClick:e.onNewMemo,children:"새글"}),e.rootDb==="memo"?l.jsx(V,{type:"button",size:"small",variant:"outlined",color:"warning",onClick:e.onMove,children:"이동"}):"",l.jsx(V,{type:"button",size:"small",variant:"outlined",color:"error",onClick:e.onDelete,children:"삭제"})]}),Jo=e=>{const{rootDb:t,isLoading:o,memoDetailData:n}=e;console.log("MemoDetail.memoDetailData.title=",n?.title,", bookmark=",n?.bookmark);const{scrollYProgress:r}=Ye(),m=Ge(r,{stiffness:100,damping:30,restDelta:.001}),[x,i]=p.useState(!1),c=ae(),a=p.useRef();a.current=e.searchWord;const{memoId:g}=Ue(),N=Ne()?.state?.fullIndex,{user:u}=ie(),s=()=>{const C=`/${t}/edit/${g}`;c(C,{state:{fullIndex:N}})},f=()=>{const C=`/${t}/insert/${g}`;c(C,{state:{fullIndex:N}})},h=async()=>{const C=t==="memo"?`${t}_txt/${u.uid}/${g}`:`${t}_txt/${g}`,k=t==="memo"?`${t}/${u.uid}`:t;if(await Tt(C,k)===void 0){alert("삭제에 실패했습니다.[code:d02]");return}e.onTreeUpdate(),c(`/${t}`)},b=()=>{window.confirm(`하위 자료가 있는 경우 같이 삭제됩니다.
삭제하시겠습니까?`)&&h()},I=()=>{i(!0)},v=()=>{e.onBookmark()},S=async C=>{try{const k=t==="memo"?`${t}_txt/${u.uid}`:`${t}_txt`,j=t==="memo"?`memo/${u.uid}`:t,M=await Et(k,j,g,C);e.onTreeUpdate()}catch(k){console.log("catch",k)}finally{i(!1)}};return p.useEffect(()=>{n&&n.title!==void 0&&Xe({title:n.title,description:n.title});function C(){window.scrollTo({top:0}),n&&n.html!=="N"&&document.querySelectorAll("pre").forEach(k=>{k.innerHTML=Ot(k.innerHTML)})}n&&n.memo!==null&&C()},[n]),o?l.jsx(G,{}):g===""||u===void 0?l.jsx(l.Fragment,{}):l.jsxs("div",{children:[l.jsx(bt.div,{className:"progress-bar",style:{scaleX:m}}),l.jsxs("div",{className:`grid grid-cols-3 
				items-center w-full 
				dark:bg-stone-950 rounded-md shadow-sm 
				dark:shadow-stone-800 shadow-stone-900`,children:[l.jsx("div",{}),l.jsx("div",{className:"flex justify-center",children:n&&n.title}),l.jsxs("div",{className:"text-right justify-end mr-3.5",children:[l.jsx(Nt,{"aria-label":"bookmark",onClick:v,children:n&&n.bookmark==="Y"?l.jsx(vt,{sx:{color:"red"}}):l.jsx(jt,{})}),l.jsx("div",{className:"text-right mb-3 text-sm text-red-400",children:e.pathNm})]})]}),l.jsxs("div",{className:"w-full p-0 m-0",children:[l.jsx(Go,{rootDb:t,onEdit:s,onNewMemo:f,onMove:I,onDelete:b,onBookmark:v,bookmark:n&&n.bookmark}),l.jsxs($,{sx:{my:2},children:[n&&n.html==="N"?l.jsx(Qe,{postData:n&&n.memo}):n&&n.html!=="N"&&n.memo&&l.jsx(It,{text:n.memo}),l.jsx(_t,{imageList:n&&n.image}),!n&&l.jsx($,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:l.jsx(yt,{sx:{mt:5}})})]}),l.jsx(Yo,{userId:u?.uid,open:x,data:e.data,onClose:()=>i(!1),onPost:S})]})]})},Qo=({onSubmit:e,onCancel:t,isSubmitting:o,newMode:n})=>l.jsxs("div",{className:"flex justify-end mb-1.5 gap-1",children:[l.jsxs(Se,{variant:"outlined",color:"success",disabled:o,onClick:r=>{r.preventDefault(),e(r)},children:[n?"새글":""," 저장"]}),l.jsx(Se,{variant:"outlined",color:"error",onClick:t,children:"취소"})]}),Xo=p.lazy(()=>ze(()=>import("./HomeChartForm-d-P6s9-t.js").then(e=>e.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])));Rt.Quill.register("modules/imageDrop",Mt);We.configure({languages:["javascript","ruby","python","java","cpp","kotlin","sql"]});const Zo={syntax:{highlight:e=>We.highlightAuto(e).value},toolbar:[[{header:"1"},{header:"2"},{header:"3"},{font:[]}],[{size:[]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","image","video"],["clean"],["code-block"]],imageDrop:!0,clipboard:{matchVisual:!1}},en=["header","font","size","bold","italic","underline","strike","blockquote","list","bullet","indent","link","image","video","clean","code-block","code-custom"],tn=e=>{const[t,o]=p.useState(e.imageList),[n,r]=p.useState(e.htmlCheck==="Y"),[m,x]=p.useState(e.newMode?"":e.content),i=p.useRef(),c=p.useRef(),a=p.useRef(null),g=p.useRef(null),d=e.newMode,N=p.useRef([]),{height:u}=At(),s=Vt.now().setZone("Asia/Seoul").toFormat("yyyy-MM-dd"),f={edTitle:d?"":e.title,edGbn:e.gbn?e.gbn:"etc",edDate:d?s:e.date,content:d?"":e.content,memoTxt:d?"":e.content,htmlCheck:e.htmlCheck},{register:h,handleSubmit:b,trigger:I,control:v,setValue:S,getValues:C,watch:k,formState:{errors:j,isSubmitting:M}}=Bt({mode:"onChange",defaultValues:f});p.useEffect(()=>{h("edDate",{required:!0,minLength:10}),h("edGbn",{required:!0}),h("htmlCheck"),h("memoTxt")},[]),p.useEffect(()=>{N.current=[],i.current=e.content,c.current=!1},[e.content]);const E=async y=>{d?await e.onNewSubmit(y,N.current):await e.onPostSubmit(y,t,N.current)},P=()=>{b(E)()},X=y=>{console.log("onDelete.imageList=",y),o(y)},de=y=>{let w=i.current;y.ext==="jpg"?w+=`<img src='${y.url}'/>`:y.ext==="mp4"&&(w+=`<video preload="auto" controls="" src='${y.url}'></video>`),i.current=w},Z=y=>{i.current=y},ue=y=>{console.log("handleFileUpload",y),N.current=y};function fe(y){i.current=y,S("content",y),I("content")}function H(y){console.log("handleChangeDate=",y);let w=ge(y);w.format("YYYY-MM-DD HH:mm:ss"),console.log("handleChangeDate.dayjs=",w.format("YYYY-MM-DD HH:mm:ss")),S("edDate",w.format("YYYY-MM-DD")),I("edDate")}const ee=y=>{console.log("onChecked=",y),S("htmlCheck",y?"Y":"N"),r(y)},F=k("content"),_=[{value:"",text:"None"},{value:"react",text:"React"},{value:"css",text:"CSS"},{value:"android",text:"Android"},{value:"java",text:"JAVA"},{value:"image",text:"그림 / 사진"},{value:"etc",text:"기타"},{value:"mui",text:"MUI"}],te=["React","JavaScript","Bash","Java","Kotlin","CSS","C++","C#","Command","Script","Python","Ruby","Go","Swift","Rust"],K=y=>{const w=a.current;if(w){const O=w.selectionStart,U=w.selectionEnd,A=m.slice(0,O),oe=m.slice(U);x(A+y+oe),S("memoTxt",A+y+oe),setTimeout(()=>{w.selectionStart=w.selectionEnd=O+y.length,w.focus()},0)}},L=y=>{K(y)};return l.jsx("div",{className:"my-2 mb-[50px], w-full",children:l.jsxs("form",{onSubmit:b(E),style:{width:"100%",minHeight:"300px",maxHeight:{height:u},display:"flex",flexDirection:"column"},children:[l.jsx(Qo,{onSubmit:y=>P(),onCancel:e.onCancel,isSubmitting:M,newMode:d}),l.jsx(Dt,{control:v,onDelete:X,onInsert:de,setContent:Z,onFileUpload:ue,imageList:e.imageList}),l.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[l.jsx(zt,{...h("edTitle",{required:"해당 필드는 필수입니다.",minLength:{value:1,message:"1글자 이상 입력해주세요."}}),fullWidth:!0,label:"제목",placeholder:"제목",variant:"filled",size:"small",error:!!j.edTitle}),l.jsx(Kt,{id:"edGbn",name:"edGbn",label:"구분",mdSize:6,control:v,defaultValue:C("edGbn"),selectList:_,error:!!j.edGbn,onChange:y=>{y.preventDefault();const w=y.target.value;console.log("edGbn=",C("edGbn")),S("edGbn",w)}}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(Ht,{id:"edDate",label:"일자",mdSize:6,value:ge(C("edDate")),...h("edDate"),defaultValue:ge(C("edDate")),onChange:H}),l.jsx(Ut,{id:"html",checked:n,onChange:ee,label:"HTML사용"})]})]}),l.jsx(q,{}),l.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[l.jsx("div",{className:"max-h-130 overflow-y-scroll",children:l.jsx(Qe,{postData:m})}),l.jsxs("div",{children:[l.jsx(Wt,{ref:a,className:"",value:m,onChange:y=>{S("memoTxt",y),x(y)},rows:22}),l.jsx(q,{}),l.jsxs("div",{className:"grid grid-cols-4 gap-2 xsm:grid-cols-5 sm:grid-cols-7 md:grid-cols-7 lg:grid-cols-8",children:[l.jsx(re,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L("<box></box>"),children:"<Box>"}),l.jsx(re,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L("</code>"),children:"</code>"}),te.map((y,w)=>l.jsx(re,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L("<code>"+y+"</code>"),children:y},w)),l.jsx(re,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L('<a href="" target="_blank"></a>'),children:"Link"})]}),l.jsx(q,{})]})]}),l.jsx(p.Suspense,{fallback:l.jsx("div",{children:"Loading editor..."}),children:l.jsx(Xo,{ref:g,fullWidth:!0,theme:"snow",id:"content",name:"content",type:"div",value:F,style:{minWidth:"400px",border:"1px solid primary.main",minHeight:"200px",height:"400px",maxHeight:"450px"},modules:Zo,formats:en,onChange:fe})}),l.jsx(q,{})]})})},Me=e=>{const{rootDb:t,isLoading:o,memoDetailData:n}=e,{scrollYProgress:r}=Ye();Ge(r,{stiffness:100,damping:30,restDelta:.001});const m=ae(),x=p.useRef(),i=p.useRef();i.current=e.searchWord;const{memoId:c}=Ue(),a=Ne(),g=n?.fullIndex,{user:d}=ie();x.current=a.pathname.split("/")[2]==="insert",console.log("MemoDetailEdit.memoDetailData=",n?.title),console.log("MemoDetailEdit.newMode=",x.current);const N=()=>{const f=`/${t}/${c==="insert"?"":c}`;m(f,{state:{fullIndex:g}})},u=async(f,h)=>{console.log("onNewSubmit.values",f),console.log("onNewSubmit.fullIndex",g);const b=t==="memo"?`${t}_txt/${d.uid}/`:`${t}_txt/`,I=t==="memo"?`${t}/${d.uid}/`:`${t}/`;console.log("onNewSubmit.txtLocate",b),console.log("onNewSubmit.locate",I);const v=await Ce(void 0,b,I,g,f);if(await we(`${t}_txt`,t,v,h),v!==void 0){const S=`/${t}/${v}`;m(S,{state:{reflash:!0}})}},s=async(f,h,b)=>{const I=t==="memo"?`${t}_txt/${d.uid}`:`${t}_txt`,v=t==="memo"?`${t}/${d.uid}`:t;await Pt(I,v,c,h),console.log("onPostSubmit.values",f);const S=await Ce(x.current?void 0:c,`${I}/`,`${v}/`,g,f);console.log("onPostSubmit.newKey=",S),console.log("onPostSubmit.files=",b);const C=await we(`${I}/`,`${v}/`,c,b);if(console.log("onNewSubmit.imageResult",C),console.log("onPostSubmit.fullIndex",g),t==="memo"&&g===void 0){const j=await St(d.uid,`${c}/fullIndex`);console.log("onPostSubmit.fullPath",j),j!==void 0&&qe(`memo/${d.uid}/${j}/title`,f.edTitle)}x.current=!1;const k=`/${t}/${c}`;m(k,{state:{fullIndex:g,reflash:!0}})};return p.useEffect(()=>{n&&n.title!==void 0&&Xe({title:n.title,description:n.title});function f(){document.querySelectorAll("pre").forEach((h,b)=>{})}n&&n.memo!==null&&f()},[n]),c===""||d===void 0?l.jsx(l.Fragment,{}):(console.log("MemoDetailEdit.isLoading=",o),n===void 0||o?l.jsx(G,{}):l.jsx(l.Fragment,{children:l.jsx("div",{className:"w-full p-0 m-0",children:x.current===!1&&n&&(n.title===void 0||n.title===""||n.title===null)?l.jsx(G,{}):l.jsx(tn,{newMode:x.current,onPostSubmit:s,onNewSubmit:u,onCancel:N,title:n?.title,gbn:n?.gbn,date:n?.date,htmlCheck:n?.html?n?.html:"Y",content:n?.memo,imageList:n?.image})})}))},on=p.lazy(async()=>await ze(()=>import("./MUIMemoMain-De08Mq0h.js"),__vite__mapDeps([16,1,2,10]))),_n=({rootDb:e})=>{const t=ae(),{user:o}=ie(),n=p.useRef(),r=p.useRef(!0),m=p.useRef(),[x,i]=p.useState(),c=p.useRef(!1),a=Ne(),g=p.useRef(!1);g.current=a?.state?.reflash===!0;const d=Ct({queryKey:["treeMemo",o?.uid,n.current],queryFn:()=>$t(e,o?.uid,n.current)});d.data!==void 0&&d.data!==""&&!c.current&&(c.current=!0);const N=()=>{const h=x;h&&(h.bookmark=h.bookmark==="Y"?"N":"Y");const b=e==="memo"?`memo_tree/${o.uid}/${m.current}/bm`:`home_txt/${m.current}/bookmark`;qe(b,x.bookmark),i({...x,bookmark:h.bookmark})};p.useEffect(()=>{o!==void 0&&o!=null&&d.refetch()},[o]),p.useEffect(()=>{const h=async v=>{if(v!==""&&o){const S=await qt(e,o?.uid,v,n.current);e==="memo"&&(S.path=Yt(d.data,v)),S.code==="404"&&(S.title="No title"),r.current=!1,i(S===void 0?{}:S)}else i({})},b=a.pathname.split("/"),I=b.length>2?b[b.length-1]:"";r.current=!0,m.current=I,h(I)},[a.pathname,o,g.current]),p.useEffect(()=>{o!==void 0&&o!=null&&d.refetch()},[g.current]);const u=h=>{c.current=!1,h!==void 0&&(n.current=h),d.refetch()},s=()=>{if(o==null){alert("로그인 후 이용 가능합니다.");return}const h=`/${e==="memo"?"m":e}/insert/insert`;t(h)},f=h=>{};return l.jsxs(l.Fragment,{children:[l.jsx(p.Suspense,{fallback:l.jsx(G,{}),children:l.jsxs(wt,{children:[l.jsx(le,{path:"/edit/:memoId",element:l.jsx(Me,{rootDb:e,isLoading:r.current,searchWord:n.current,memoDetailData:x})}),l.jsx(le,{path:"/insert/:memoId",element:l.jsx(Me,{rootDb:e,isLoading:r.current,searchWord:n.current,memoDetailData:x})}),l.jsx(le,{path:"/:memoId",element:l.jsx(Jo,{rootDb:e,isLoading:r.current,searchWord:n.current,memoDetailData:x,onTreeUpdate:u,onBookmark:N,data:d.data})}),l.jsx(le,{path:"*",element:l.jsx(on,{searchWord:n.current,data:d.data,onNewMemoBtn:s,title:e==="memo"?"메모장":"홈페이지관리",rootDb:e})})]})}),e==="memo"?l.jsx(to,{onSelected:f}):null,m.current===""?l.jsx(Lt,{data:d.data}):null]})};export{_n as default};
