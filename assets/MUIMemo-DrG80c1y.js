const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomeChartForm-CrKT0MNu.js","assets/index-Bq2okyO2.js","assets/index-CNTHOsEM.css","assets/index-wES6wE32.js","assets/Loading-B2jgiSoZ.js","assets/Container-CEuUXhjH.js","assets/styled-DCHl2VxL.js","assets/CircularProgress-DE_ns1Ov.js","assets/right-BdMWXTWk.js","assets/DndProvider-BV4eX6zg.js","assets/createSvgIcon-CBn5T6Tm.js","assets/useControlled-D1xcdFA9.js","assets/isMuiElement-Bvb7Om-V.js","assets/fireDatabase-CYS3RlZB.js","assets/fireMemoDetail-ZMonhKoQ.js","assets/SinyDate-CHZdUciK.js","assets/Grid-WFSBEAVW.js","assets/useTheme-CX-Cb1hk.js","assets/index-BmhRCdrV.js","assets/Typography-BfnFn_Qs.js","assets/Menu-DY6WpP5T.js","assets/resolveComponentProps-B8WY-0yn.js","assets/IconButton-DHhRMkHw.js","assets/TextField-8vjJMIN2.js","assets/InputAdornment-KSIxnVbO.js","assets/Popper-BW2t4pNd.js","assets/Button-DCoXIv0f.js","assets/Chip-DFsKd4ZK.js","assets/index.esm-Dv4f8xaF.js","assets/TwButton-DnBv8mIC.js","assets/Divider-CoH0J48V.js","assets/dividerClasses-KAVeIEaH.js","assets/Favorite-DRhf5tyn.js","assets/check-circle-CRfLj93W.js","assets/TwTitleItem-CQU8MXJC.js","assets/HomeChartSemiDonut-BSoZRZ51.js","assets/HomeChartForm-DlNaLvKe.css","assets/MUIMemoMain-B1b7_Tw4.js"])))=>i.map(i=>d[i]);
import{b6 as Le,bd as Fe,aG as _e,e as ue,y as fe,r as p,j as r,q as at,bT as ct,o as dt,b as ut,f as ft,C as mt,Z as me,V as E,ad as gt,$ as Oe,X as Ae,W as Ve,ah as Be,a2 as He,N as Z,a1 as Ke,a6 as le,S as X,Q as pt,B as R,x as Ue,t as Ie,aF as xt,z as ht,cn as be,H as We,_ as ze,a_ as z,v as bt,T as vt,g as Nt,h as ie}from"./index-Bq2okyO2.js";import{u as yt}from"./useSuspenseQuery-BpwhCoLO.js";import{L as B}from"./Loading-B2jgiSoZ.js";import{g as It,a as St,s as qe}from"./fireDatabase-CYS3RlZB.js";import{a as Ct,u as Ye,b as Ge,F as jt,e as wt,f as Tt,D as kt,l as Et,I as Dt,h as we,c as Te,d as Rt,g as Mt,T as Pt,H as $t}from"./HomeChartForm-CrKT0MNu.js";import{F as Lt}from"./Footer-Lko9pIeR.js";import{a as Ft}from"./TwTitleItem-CQU8MXJC.js";import{F as _t}from"./Favorite-DRhf5tyn.js";import{A as V}from"./AniButton-BSbJmPQ5.js";import{r as Je}from"./createSvgIcon-CBn5T6Tm.js";import{u as Ot,d as At}from"./Menu-DY6WpP5T.js";import{o as Qe}from"./useControlled-D1xcdFA9.js";import{u as Vt}from"./useTheme-CX-Cb1hk.js";import{T as ce}from"./Typography-BfnFn_Qs.js";import{C as Xe}from"./Collapse-BW9QwwR5.js";import{D as J}from"./Divider-CoH0J48V.js";import{S as Bt}from"./SinyImageList-CFEByq8N.js";import{H as Ze}from"./HtmlCode-CcJgXMxz.js";import{c as Ht}from"./CodeText-fx9oxgjL.js";import{s as et}from"./commonUtil-BuOP-BrX.js";import{I as Kt}from"./IconButton-DHhRMkHw.js";import{C as Ut}from"./CircularProgress-DE_ns1Ov.js";import{u as Wt}from"./useWindowDimensions-bUsLyrm4.js";import{D as zt}from"./datetime-BDx6lZXm.js";import{u as qt}from"./index.esm-Dv4f8xaF.js";import{T as de}from"./TwButton-DnBv8mIC.js";import{S as Yt}from"./SinyDate-CHZdUciK.js";import{S as Gt}from"./SinySelect-DgQqzdpo.js";import{T as ae}from"./TwBadge-DboCGo9m.js";import{T as Jt}from"./TwCheckbox-BD-L7j_8.js";import{T as Qt}from"./TwTextArea-WjZYCG9m.js";import{T as Xt}from"./TextField-8vjJMIN2.js";import{T as Zt}from"./TwInput-C6zKzPJT.js";import{f as eo}from"./fireMemoDetail-ZMonhKoQ.js";import{g as to}from"./memoFun-DpPhML4t.js";import{L as q}from"./Link-DErjXeoJ.js";import"./useBaseQuery-BXiiY0J8.js";import"./Container-CEuUXhjH.js";import"./styled-DCHl2VxL.js";import"./index-wES6wE32.js";import"./right-BdMWXTWk.js";import"./DndProvider-BV4eX6zg.js";import"./check-circle-CRfLj93W.js";import"./HomeChartSemiDonut-BSoZRZ51.js";import"./LinkItem-DmovyF0G.js";import"./TwLinkItem-B8UrJan3.js";import"./Button-DCoXIv0f.js";import"./isMuiElement-Bvb7Om-V.js";import"./resolveComponentProps-B8WY-0yn.js";import"./dividerClasses-KAVeIEaH.js";import"./ImageListItem-DlZmjzGn.js";/* empty css                 */import"./copy-B2H1mvTf.js";import"./ComponentCard-BPcemxZ9.js";import"./TwRadio-DMUnqq83.js";import"./toPropertyKey-DCwh5dYN.js";import"./Grid-WFSBEAVW.js";import"./index-BmhRCdrV.js";import"./InputAdornment-KSIxnVbO.js";import"./Popper-BW2t4pNd.js";import"./Chip-DFsKd4ZK.js";import"./MenuItem-CbRtxLuG.js";var Y={},ke;function oo(){if(ke)return Y;ke=1;var e=Le();Object.defineProperty(Y,"__esModule",{value:!0}),Y.default=void 0;var t=e(Je()),o=Fe();return Y.default=(0,t.default)((0,o.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"ChevronRight"),Y}var no=oo();const ro=_e(no);var G={},Ee;function so(){if(Ee)return G;Ee=1;var e=Le();Object.defineProperty(G,"__esModule",{value:!0}),G.default=void 0;var t=e(Je()),o=Fe();return G.default=(0,t.default)((0,o.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore"),G}var lo=so();const io=_e(lo);function ao({onSelected:e}){const{user:t}=ue(),o=fe(),[n,l]=p.useState(),[c,x]=p.useState(),i=async u=>{const a=[],g=at(ut(ft,`memo_tree/${u}`),dt("bm"),ct("Y")),d=await mt(g);if(!d.exists())return console.log("getBookmark.getFireData.null"),null;const N=d.val();for(let f in N){const s=N[f];s.id=f,s.key=f,s.text=s.title,a.push(s)}a.sort((f,s)=>f.title>s.title?1:-1),l([...a])};return p.useEffect(()=>{t!==void 0&&t!=null&&i(t?.uid)},[t]),p.useEffect(()=>{const u=async(a,g)=>{const d=[...g];if(g)for(const N of g){let f=N;for(;f.parent!==void 0&&f.parent!=="root";){const s=f.parent;f=await It(`memo_tree/${a}/${s}`);const m={id:f.key,text:f.title,droppable:!1,parent:f.parent};d.filter(v=>v.id===m.id).length===0&&d.push(m)}}for(const N of d){const f=N.id;N.cnt=d.filter(s=>s.parent===f).length}x(d)};n&&n.length>0&&u(t?.uid,n)},[n]),t===null?r.jsx(r.Fragment,{}):r.jsxs("div",{className:"tail-bookmark justify-items-center flex items-center flex-col w-full",children:[r.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),r.jsx(Ft,{children:"주요 목록"}),r.jsx("div",{className:`tail-bookmark 
        grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-1 
        justify-items-center 
        w-full`,children:n&&n.map((u,a)=>r.jsx("div",{children:r.jsx("button",{className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 cursor-pointer",onClick:()=>{e(u.key),o(`/m/${u.key}`)},children:r.jsx("span",{className:"text-base",children:u.title})})},a))}),r.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600 my-3"}),r.jsx(p.Suspense,{fallback:r.jsx(B,{}),children:r.jsx(Ct,{initTreeData:c,uid:t?.uid})})]})}const co=["element"];function uo(e,t){for(let o=0;o<e.length;o+=1)if(t(e[o]))return o;return-1}function fo(e,t){let o=0,n=e.length-1;for(;o<=n;){const l=Math.floor((o+n)/2);if(e[l].element===t)return l;e[l].element.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING?n=l-1:o=l+1}return o}const tt=p.createContext({});function mo(e){const t=p.useRef(null);return p.useEffect(()=>{t.current=e},[e]),t.current}const De=()=>{};function go(e){const[,t]=p.useState(),{registerDescendant:o=De,unregisterDescendant:n=De,descendants:l=[],parentId:c=null}=p.useContext(tt),x=uo(l,a=>a.element===e.element),i=mo(l),u=l.some((a,g)=>i&&i[g]&&i[g].element!==a.element);return gt(()=>{if(e.element)return o(E({},e,{index:x})),()=>{n(e.element)};t({})},[o,n,x,u,e]),{parentId:c,index:x}}function ot(e){const{children:t,id:o}=e,[n,l]=p.useState([]),c=p.useCallback(u=>{let{element:a}=u,g=me(u,co);l(d=>{if(d.length===0)return[E({},g,{element:a,index:0})];const N=fo(d,a);let f;if(d[N]&&d[N].element===a)f=d;else{const s=E({},g,{element:a,index:N});f=d.slice(),f.splice(N,0,s)}return f.forEach((s,m)=>{s.index=m}),f})},[]),x=p.useCallback(u=>{l(a=>a.filter(g=>u!==g.element))},[]),i=p.useMemo(()=>({descendants:n,registerDescendant:c,unregisterDescendant:x,parentId:o}),[n,c,x,o]);return r.jsx(tt.Provider,{value:i,children:t})}const nt={instance:null,multiSelect:!1,disabledItemsFocusable:!1,treeId:void 0,icons:{defaultCollapseIcon:null,defaultExpandIcon:null,defaultParentIcon:null,defaultEndIcon:null}},rt=p.createContext(nt),st=()=>p.useContext(rt);function po(e){const{instance:t,multiSelect:o}=st(),n=t?t.isNodeExpandable(e):!1,l=t?t.isNodeExpanded(e):!1,c=t?t.isNodeFocused(e):!1,x=t?t.isNodeSelected(e):!1,i=t?t.isNodeDisabled(e):!1;return{disabled:i,expanded:l,selected:x,focused:c,handleExpansion:d=>{if(t&&!i){c||t.focusNode(d,e);const N=o&&(d.shiftKey||d.ctrlKey||d.metaKey);n&&!(N&&t.isNodeExpanded(e))&&t.toggleNodeExpansion(d,e)}},handleSelection:d=>{t&&!i&&(c||t.focusNode(d,e),o&&(d.shiftKey||d.ctrlKey||d.metaKey)?d.shiftKey?t.selectRange(d,{end:e}):t.selectNode(d,e,!0):t.selectNode(d,e))},preventSelection:d=>{(d.shiftKey||d.ctrlKey||d.metaKey||i)&&d.preventDefault()}}}const xo=["classes","className","displayIcon","expansionIcon","icon","label","nodeId","onClick","onMouseDown"],lt=p.forwardRef(function(t,o){const{classes:n,className:l,displayIcon:c,expansionIcon:x,icon:i,label:u,nodeId:a,onClick:g,onMouseDown:d}=t,N=me(t,xo),{disabled:f,expanded:s,selected:m,focused:h,handleExpansion:v,handleSelection:b,preventSelection:y}=po(a),C=i||x||c,S=T=>{y(T),d&&d(T)},j=T=>{v(T),b(T),g&&g(T)};return r.jsxs("div",E({},N,{className:Oe(l,n.root,s&&n.expanded,m&&n.selected,h&&n.focused,f&&n.disabled),onClick:j,onMouseDown:S,ref:o,children:[r.jsx("div",{className:n.iconContainer,children:C}),r.jsx("div",{className:n.label,children:u})]}))});function ho(e){return Ve("MuiTreeItem",e)}const D=Ae("MuiTreeItem",["root","group","content","expanded","selected","focused","disabled","iconContainer","label"]),bo=["children","className","collapseIcon","ContentComponent","ContentProps","endIcon","expandIcon","disabled","icon","id","label","nodeId","onClick","onMouseDown","TransitionComponent","TransitionProps"],vo=e=>{const{classes:t}=e;return Ke({root:["root"],content:["content"],expanded:["expanded"],selected:["selected"],focused:["focused"],disabled:["disabled"],iconContainer:["iconContainer"],label:["label"],group:["group"]},ho,t)},No=Z("li",{name:"MuiTreeItem",slot:"Root",overridesResolver:(e,t)=>t.root})({listStyle:"none",margin:0,padding:0,outline:0}),yo=Z(lt,{name:"MuiTreeItem",slot:"Content",overridesResolver:(e,t)=>[t.content,t.iconContainer&&{[`& .${D.iconContainer}`]:t.iconContainer},t.label&&{[`& .${D.label}`]:t.label}]})(({theme:e})=>({padding:"0 8px",width:"100%",boxSizing:"border-box",display:"flex",alignItems:"center",cursor:"pointer",WebkitTapHighlightColor:"transparent","&:hover":{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${D.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity,backgroundColor:"transparent"},[`&.${D.focused}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${D.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:le(e.palette.primary.main,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:le(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:le(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${D.focused}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:le(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`& .${D.iconContainer}`]:{marginRight:4,width:15,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},[`& .${D.label}`]:E({paddingLeft:4,width:"100%",boxSizing:"border-box",minWidth:0,position:"relative"},e.typography.body1)})),Io=Z(Xe,{name:"MuiTreeItem",slot:"Group",overridesResolver:(e,t)=>t.group})({margin:0,padding:0,marginLeft:17}),So=p.forwardRef(function(t,o){const n=Be({props:t,name:"MuiTreeItem"}),{children:l,className:c,collapseIcon:x,ContentComponent:i=lt,ContentProps:u,endIcon:a,expandIcon:g,disabled:d,icon:N,id:f,label:s,nodeId:m,onClick:h,onMouseDown:v,TransitionComponent:b=Xe,TransitionProps:y}=n,C=me(n,bo),{icons:S,multiSelect:j,disabledItemsFocusable:T,treeId:P,instance:k}=st();let $;f!=null?$=f:P&&m&&($=`${P}-${m}`);const[ee,ge]=p.useState(null),te=p.useRef(null),pe=He(ge,o),xe=p.useMemo(()=>({element:ee,id:m}),[m,ee]),{index:K,parentId:oe}=go(xe),F=!!(Array.isArray(l)?l.length:l),_=k?k.isNodeExpanded(m):!1,ne=k?k.isNodeFocused(m):!1,U=k?k.isNodeSelected(m):!1,L=k?k.isNodeDisabled(m):!1,I=E({},n,{expanded:_,focused:ne,selected:U,disabled:L}),w=vo(I);let O,W;F&&(_?W=x||S.defaultCollapseIcon:W=g||S.defaultExpandIcon),F?O=S.defaultParentIcon:O=a||S.defaultEndIcon,p.useEffect(()=>{if(k&&K!==-1)return k.updateNode({id:m,idAttribute:$,index:K,parentId:oe,expandable:F,disabled:d}),()=>k.removeNode(m)},[k,oe,K,m,F,d,$]),p.useEffect(()=>{if(k&&s){var M,se;return k.mapFirstChar(m,((M=(se=te.current)==null?void 0:se.textContent)!=null?M:"").substring(0,1).toLowerCase())}},[k,m,s]);let A;j?A=U:U&&(A=!0);function re(M){if(M.target===M.currentTarget){let he;typeof M.target.getRootNode=="function"?he=M.target.getRootNode():he=Qe(M.target),he.getElementById(P).focus({preventScroll:!0})}const se=!T&&L;k&&!ne&&M.currentTarget===M.target&&!se&&k.focusNode(M,m)}return r.jsxs(No,E({className:Oe(w.root,c),role:"treeitem","aria-expanded":F?_:void 0,"aria-selected":A,"aria-disabled":L||void 0,id:$,tabIndex:-1},C,{ownerState:I,onFocus:re,ref:pe,children:[r.jsx(yo,E({as:i,ref:te,classes:{root:w.content,expanded:w.expanded,selected:w.selected,focused:w.focused,disabled:w.disabled,iconContainer:w.iconContainer,label:w.label},label:s,nodeId:m,onClick:h,onMouseDown:v,icon:N,expansionIcon:W,displayIcon:O,ownerState:I},u)),l&&r.jsx(ot,{id:m,children:r.jsx(Io,E({as:b,unmountOnExit:!0,className:w.group,in:_,component:"ul",role:"group"},y,{children:l}))})]}))});function Co(e){return Ve("MuiTreeView",e)}Ae("MuiTreeView",["root"]);const jo=(e,t)=>{const o=p.useRef({}),[n,l]=p.useState(()=>{const x={};return e.forEach(i=>{i.models&&Object.entries(i.models).forEach(([u,a])=>{o.current[u]={controlledProp:a.controlledProp,defaultProp:a.defaultProp,isControlled:t[a.controlledProp]!==void 0},x[u]=t[a.defaultProp]})}),x});return Object.fromEntries(Object.entries(o.current).map(([x,i])=>{const u=i.isControlled?t[i.controlledProp]:n[x];return[x,{value:u,setValue:a=>{i.isControlled||l(g=>E({},g,{[x]:a}))}}]}))};class wo{constructor(){this.maxListeners=20,this.warnOnce=!1,this.events={}}on(t,o,n={}){let l=this.events[t];l||(l={highPriority:new Map,regular:new Map},this.events[t]=l),n.isFirst?l.highPriority.set(o,!0):l.regular.set(o,!0)}removeListener(t,o){this.events[t]&&(this.events[t].regular.delete(o),this.events[t].highPriority.delete(o))}removeAllListeners(){this.events={}}emit(t,...o){const n=this.events[t];if(!n)return;const l=Array.from(n.highPriority.keys()),c=Array.from(n.regular.keys());for(let x=l.length-1;x>=0;x-=1){const i=l[x];n.highPriority.has(i)&&i.apply(this,o)}for(let x=0;x<c.length;x+=1){const i=c[x];n.regular.has(i)&&i.apply(this,o)}}once(t,o){const n=this;this.on(t,function l(...c){n.removeListener(t,l),o.apply(n,c)})}}const ve=(e,t)=>{const o=e.getNode(t),n=e.getNavigableChildrenIds(o.parentId),l=n.indexOf(t);if(l===0)return o.parentId;let c=n[l-1];for(;e.isNodeExpanded(c)&&e.getNavigableChildrenIds(c).length>0;)c=e.getNavigableChildrenIds(c).pop();return c},Q=(e,t)=>{if(e.isNodeExpanded(t)&&e.getNavigableChildrenIds(t).length>0)return e.getNavigableChildrenIds(t)[0];let o=e.getNode(t);for(;o!=null;){const n=e.getNavigableChildrenIds(o.parentId),l=n[n.indexOf(o.id)+1];if(l)return l;o=e.getNode(o.parentId)}return null},Ne=e=>{let t=e.getNavigableChildrenIds(null).pop();for(;e.isNodeExpanded(t);)t=e.getNavigableChildrenIds(t).pop();return t},ye=e=>e.getNavigableChildrenIds(null)[0],H=(e,t)=>{Object.assign(e,t)},To=e=>e.isPropagationStopped!==void 0,ko=({instance:e})=>{const[t]=p.useState(()=>new wo),o=p.useCallback((...l)=>{const[c,x,i={}]=l;i.defaultMuiPrevented=!1,!(To(i)&&i.isPropagationStopped())&&t.emit(c,x,i)},[t]),n=p.useCallback((l,c)=>(t.on(l,c),()=>{t.removeListener(l,c)}),[t]);H(e,{$$publishEvent:o,$$subscribeEvent:n})},Eo=[ko],Do=e=>{const t=[...Eo,...e.plugins],o=t.reduce((s,m)=>m.getDefaultizedParams?m.getDefaultizedParams(s):s,e),n=jo(t,o),c=p.useRef({}).current,x=p.useRef(null),i=He(x,e.rootRef),[u,a]=p.useState(()=>{const s={};return t.forEach(m=>{m.getInitialState&&Object.assign(s,m.getInitialState(o))}),s}),g=[];let d=nt;const N=s=>{const m=s({instance:c,params:o,state:u,setState:a,rootRef:x,models:n})||{};m.getRootProps&&g.push(m.getRootProps),m.contextValue&&(d=m.contextValue)};return t.forEach(N),{getRootProps:(s={})=>{const m=E({role:"tree",tabIndex:0},s,{ref:i});return g.forEach(h=>{Object.assign(m,h(s))}),m},rootRef:i,contextValue:d}};function Ro(e){const{value:t,children:o}=e;return r.jsx(rt.Provider,{value:t,children:r.jsx(ot,{children:o})})}const Mo=(e,t,o)=>{e.$$publishEvent(t,o)},Po=({instance:e,params:t})=>{const o=p.useRef({}),n=p.useCallback(a=>o.current[a],[]),l=p.useCallback(a=>{o.current[a.id]=a},[]),c=p.useCallback(a=>{const g=E({},o.current);delete g[a],o.current=g,Mo(e,"removeNode",{id:a})},[e]),x=p.useCallback(a=>{if(a==null)return!1;let g=e.getNode(a);if(!g)return!1;if(g.disabled)return!0;for(;g.parentId!=null;)if(g=e.getNode(g.parentId),g.disabled)return!0;return!1},[e]),i=X(a=>Object.values(o.current).filter(g=>g.parentId===a).sort((g,d)=>g.index-d.index).map(g=>g.id));H(e,{getNode:n,updateNode:l,removeNode:c,getChildrenIds:i,getNavigableChildrenIds:a=>{let g=e.getChildrenIds(a);return t.disabledItemsFocusable||(g=g.filter(d=>!e.isNodeDisabled(d))),g},isNodeDisabled:x})},Se=({instance:e,params:t,models:o})=>{const n=p.useCallback(i=>Array.isArray(o.expanded.value)?o.expanded.value.indexOf(i)!==-1:!1,[o.expanded.value]),l=p.useCallback(i=>{var u;return!!((u=e.getNode(i))!=null&&u.expandable)},[e]),c=X((i,u)=>{if(u==null)return;let a;o.expanded.value.indexOf(u)!==-1?a=o.expanded.value.filter(g=>g!==u):a=[u].concat(o.expanded.value),t.onNodeToggle&&t.onNodeToggle(i,a),o.expanded.setValue(a)});H(e,{isNodeExpanded:n,isNodeExpandable:l,toggleNodeExpansion:c,expandAllSiblings:(i,u)=>{const a=e.getNode(u),d=e.getChildrenIds(a.parentId).filter(f=>e.isNodeExpandable(f)&&!e.isNodeExpanded(f)),N=o.expanded.value.concat(d);d.length>0&&(o.expanded.setValue(N),t.onNodeToggle&&t.onNodeToggle(i,N))}})};Se.models={expanded:{controlledProp:"expanded",defaultProp:"defaultExpanded"}};const $o=[];Se.getDefaultizedParams=e=>{var t;return E({},e,{defaultExpanded:(t=e.defaultExpanded)!=null?t:$o})};const Lo=(e,t,o)=>{if(t===o)return[t,o];const n=e.getNode(t),l=e.getNode(o);if(n.parentId===l.id||l.parentId===n.id)return l.parentId===n.id?[n.id,l.id]:[l.id,n.id];const c=[n.id],x=[l.id];let i=n.parentId,u=l.parentId,a=x.indexOf(i)!==-1,g=c.indexOf(u)!==-1,d=!0,N=!0;for(;!g&&!a;)d&&(c.push(i),a=x.indexOf(i)!==-1,d=i!==null,!a&&d&&(i=e.getNode(i).parentId)),N&&!a&&(x.push(u),g=c.indexOf(u)!==-1,N=u!==null,!g&&N&&(u=e.getNode(u).parentId));const f=a?i:u,s=e.getChildrenIds(f),m=c[c.indexOf(f)-1],h=x[x.indexOf(f)-1];return s.indexOf(m)<s.indexOf(h)?[t,o]:[o,t]},Ce=({instance:e,params:t,models:o})=>{const n=p.useRef(null),l=p.useRef(!1),c=p.useRef([]),x=s=>Array.isArray(o.selected.value)?o.selected.value.indexOf(s)!==-1:o.selected.value===s,i=(s,m,h=!1)=>{if(!t.disableSelection){if(h){if(Array.isArray(o.selected.value)){let v;o.selected.value.indexOf(m)!==-1?v=o.selected.value.filter(b=>b!==m):v=[m].concat(o.selected.value),t.onNodeSelect&&t.onNodeSelect(s,v),o.selected.setValue(v)}}else{const v=t.multiSelect?[m]:m;t.onNodeSelect&&t.onNodeSelect(s,v),o.selected.setValue(v)}n.current=m,l.current=!1,c.current=[]}},u=(s,m)=>{const[h,v]=Lo(e,s,m),b=[h];let y=h;for(;y!==v;)y=Q(e,y),b.push(y);return b},a=(s,m)=>{let h=o.selected.value.slice();const{start:v,next:b,current:y}=m;!b||!y||(c.current.indexOf(y)===-1&&(c.current=[]),l.current?c.current.indexOf(b)!==-1?(h=h.filter(C=>C===v||C!==y),c.current=c.current.filter(C=>C===v||C!==y)):(h.push(b),c.current.push(b)):(h.push(b),c.current.push(y,b)),t.onNodeSelect&&t.onNodeSelect(s,h),o.selected.setValue(h))},g=(s,m)=>{let h=o.selected.value.slice();const{start:v,end:b}=m;l.current&&(h=h.filter(S=>c.current.indexOf(S)===-1));let y=u(v,b);y=y.filter(S=>!e.isNodeDisabled(S)),c.current=y;let C=h.concat(y);C=C.filter((S,j)=>C.indexOf(S)===j),t.onNodeSelect&&t.onNodeSelect(s,C),o.selected.setValue(C)};return H(e,{isNodeSelected:x,selectNode:i,selectRange:(s,m,h=!1)=>{if(t.disableSelection)return;const{start:v=n.current,end:b,current:y}=m;h?a(s,{start:v,next:b,current:y}):v!=null&&b!=null&&g(s,{start:v,end:b}),l.current=!0},rangeSelectToLast:(s,m)=>{n.current||(n.current=m);const h=l.current?n.current:m;e.selectRange(s,{start:h,end:Ne(e)})},rangeSelectToFirst:(s,m)=>{n.current||(n.current=m);const h=l.current?n.current:m;e.selectRange(s,{start:h,end:ye(e)})}}),{getRootProps:()=>({"aria-multiselectable":t.multiSelect})}};Ce.models={selected:{controlledProp:"selected",defaultProp:"defaultSelected"}};const Fo=[];Ce.getDefaultizedParams=e=>{var t,o,n;return E({},e,{disableSelection:(t=e.disableSelection)!=null?t:!1,multiSelect:(o=e.multiSelect)!=null?o:!1,defaultSelected:(n=e.defaultSelected)!=null?n:e.multiSelect?Fo:null})};const Re=1e3;class _o{constructor(t=Re){this.timeouts=new Map,this.cleanupTimeout=Re,this.cleanupTimeout=t}register(t,o,n){this.timeouts||(this.timeouts=new Map);const l=setTimeout(()=>{typeof o=="function"&&o(),this.timeouts.delete(n.cleanupToken)},this.cleanupTimeout);this.timeouts.set(n.cleanupToken,l)}unregister(t){const o=this.timeouts.get(t.cleanupToken);o&&(this.timeouts.delete(t.cleanupToken),clearTimeout(o))}reset(){this.timeouts&&(this.timeouts.forEach((t,o)=>{this.unregister({cleanupToken:o})}),this.timeouts=void 0)}}class Oo{constructor(){this.registry=new FinalizationRegistry(t=>{typeof t=="function"&&t()})}register(t,o,n){this.registry.register(t,o,n)}unregister(t){this.registry.unregister(t)}reset(){}}class Ao{}function Vo(e){let t=0;return function(n,l,c){e.registry===null&&(e.registry=typeof FinalizationRegistry<"u"?new Oo:new _o);const[x]=p.useState(new Ao),i=p.useRef(null),u=p.useRef();u.current=c;const a=p.useRef(null);if(!i.current&&u.current){const g=(d,N)=>{if(!N.defaultMuiPrevented){var f;(f=u.current)==null||f.call(u,d,N)}};i.current=n.$$subscribeEvent(l,g),t+=1,a.current={cleanupToken:t},e.registry.register(x,()=>{var d;(d=i.current)==null||d.call(i),i.current=null,a.current=null},a.current)}else!u.current&&i.current&&(i.current(),i.current=null,a.current&&(e.registry.unregister(a.current),a.current=null));p.useEffect(()=>{if(!i.current&&u.current){const g=(d,N)=>{if(!N.defaultMuiPrevented){var f;(f=u.current)==null||f.call(u,d,N)}};i.current=n.$$subscribeEvent(l,g)}return a.current&&e.registry&&(e.registry.unregister(a.current),a.current=null),()=>{var g;(g=i.current)==null||g.call(i),i.current=null}},[n,l])}}const Bo={registry:null},Ho=Vo(Bo),je=({instance:e,params:t,state:o,setState:n,models:l,rootRef:c})=>{const x=X(f=>{const s=typeof f=="function"?f(o.focusedNodeId):f;n(m=>E({},m,{focusedNodeId:s}))}),i=p.useCallback(f=>o.focusedNodeId===f,[o.focusedNodeId]),u=X((f,s)=>{s&&(x(s),t.onNodeFocus&&t.onNodeFocus(f,s))});H(e,{isNodeFocused:i,focusNode:u}),Ho(e,"removeNode",({id:f})=>{x(s=>s===f&&c.current===Qe(c.current).activeElement?e.getChildrenIds(null)[0]:s)});const a=f=>s=>{var m;if((m=f.onFocus)==null||m.call(f,s),s.target===s.currentTarget){const h=b=>{const y=e.getNode(b);return y&&(y.parentId==null||e.isNodeExpanded(y.parentId))};let v;Array.isArray(l.selected.value)?v=l.selected.value.find(h):l.selected.value!=null&&h(l.selected.value)&&(v=l.selected.value),v==null&&(v=e.getNavigableChildrenIds(null)[0]),e.focusNode(s,v)}},g=f=>s=>{var m;(m=f.onBlur)==null||m.call(f,s),x(null)},d=e.getNode(o.focusedNodeId),N=d?d.idAttribute:null;return{getRootProps:f=>({onFocus:a(f),onBlur:g(f),"aria-activedescendant":N??void 0})}};je.getInitialState=()=>({focusedNodeId:null});je.getDefaultizedParams=e=>{var t;return E({},e,{disabledItemsFocusable:(t=e.disabledItemsFocusable)!=null?t:!1})};function Ko(e){return e&&e.length===1&&e.match(/\S/)}function Me(e,t,o){for(let n=t;n<e.length;n+=1)if(o===e[n])return n;return-1}const Uo=({instance:e,params:t,state:o})=>{const l=Vt().direction==="rtl",c=p.useRef({}),x=X((f,s)=>(c.current[f]=s,()=>{const m=E({},c.current);delete m[f],c.current=m}));H(e,{mapFirstChar:x});const i=f=>(o.focusedNodeId!=null&&e.isNodeExpandable(o.focusedNodeId)&&(e.isNodeExpanded(o.focusedNodeId)?e.focusNode(f,Q(e,o.focusedNodeId)):e.isNodeDisabled(o.focusedNodeId)||e.toggleNodeExpansion(f,o.focusedNodeId)),!0),u=f=>{if(o.focusedNodeId==null)return!1;if(e.isNodeExpanded(o.focusedNodeId)&&!e.isNodeDisabled(o.focusedNodeId))return e.toggleNodeExpansion(f,o.focusedNodeId),!0;const s=e.getNode(o.focusedNodeId).parentId;return s?(e.focusNode(f,s),!0):!1},a=(f,s,m)=>{let h,v;const b=m.toLowerCase(),y=[],C=[];Object.keys(c.current).forEach(S=>{const j=e.getNode(S),T=j.parentId?e.isNodeExpanded(j.parentId):!0,P=t.disabledItemsFocusable?!1:e.isNodeDisabled(S);T&&!P&&(y.push(S),C.push(c.current[S]))}),h=y.indexOf(s)+1,h>=y.length&&(h=0),v=Me(C,h,b),v===-1&&(v=Me(C,0,b)),v>-1&&e.focusNode(f,y[v])},g=(f,s)=>{e.isNodeDisabled(Q(e,s))||e.selectRange(f,{end:Q(e,s),current:s},!0)},d=(f,s)=>{e.isNodeDisabled(ve(e,s))||e.selectRange(f,{end:ve(e,s),current:s},!0)},N=f=>s=>{var m;(m=f.onKeyDown)==null||m.call(f,s);let h=!1;const v=s.key;if(s.altKey||s.currentTarget!==s.target||o.focusedNodeId==null)return;const b=s.ctrlKey||s.metaKey;switch(v){case" ":!t.disableSelection&&!e.isNodeDisabled(o.focusedNodeId)&&(h=!0,t.multiSelect&&s.shiftKey?e.selectRange(s,{end:o.focusedNodeId}):t.multiSelect?e.selectNode(s,o.focusedNodeId,!0):e.selectNode(s,o.focusedNodeId)),s.stopPropagation();break;case"Enter":e.isNodeDisabled(o.focusedNodeId)||(e.isNodeExpandable(o.focusedNodeId)?(e.toggleNodeExpansion(s,o.focusedNodeId),h=!0):t.disableSelection||(h=!0,t.multiSelect?e.selectNode(s,o.focusedNodeId,!0):e.selectNode(s,o.focusedNodeId))),s.stopPropagation();break;case"ArrowDown":t.multiSelect&&s.shiftKey&&!t.disableSelection&&g(s,o.focusedNodeId),e.focusNode(s,Q(e,o.focusedNodeId)),h=!0;break;case"ArrowUp":t.multiSelect&&s.shiftKey&&!t.disableSelection&&d(s,o.focusedNodeId),e.focusNode(s,ve(e,o.focusedNodeId)),h=!0;break;case"ArrowRight":l?h=u(s):h=i(s);break;case"ArrowLeft":l?h=i(s):h=u(s);break;case"Home":t.multiSelect&&b&&s.shiftKey&&!t.disableSelection&&!e.isNodeDisabled(o.focusedNodeId)&&e.rangeSelectToFirst(s,o.focusedNodeId),e.focusNode(s,ye(e)),h=!0;break;case"End":t.multiSelect&&b&&s.shiftKey&&!t.disableSelection&&!e.isNodeDisabled(o.focusedNodeId)&&e.rangeSelectToLast(s,o.focusedNodeId),e.focusNode(s,Ne(e)),h=!0;break;default:v==="*"?(e.expandAllSiblings(s,o.focusedNodeId),h=!0):t.multiSelect&&b&&v.toLowerCase()==="a"&&!t.disableSelection?(e.selectRange(s,{start:ye(e),end:Ne(e)}),h=!0):!b&&!s.shiftKey&&Ko(v)&&(a(s,o.focusedNodeId,v),h=!0)}h&&(s.preventDefault(),s.stopPropagation())};return{getRootProps:f=>({onKeyDown:N(f)})}},Wo=({instance:e,params:t})=>{const o=pt(t.id);return{getRootProps:()=>({id:o}),contextValue:{treeId:o,instance:e,multiSelect:t.multiSelect,disabledItemsFocusable:t.disabledItemsFocusable,icons:{defaultCollapseIcon:t.defaultCollapseIcon,defaultEndIcon:t.defaultEndIcon,defaultExpandIcon:t.defaultExpandIcon,defaultParentIcon:t.defaultParentIcon}}}},zo=[Po,Se,Ce,je,Uo,Wo],qo=["disabledItemsFocusable","expanded","defaultExpanded","onNodeToggle","onNodeFocus","disableSelection","defaultSelected","selected","multiSelect","onNodeSelect","id","defaultCollapseIcon","defaultEndIcon","defaultExpandIcon","defaultParentIcon","children"],Yo=e=>{const{classes:t}=e;return Ke({root:["root"]},Co,t)},Pe=Z("ul",{name:"MuiTreeView",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:0,margin:0,listStyle:"none",outline:0}),Go=p.forwardRef(function(t,o){const n=Be({props:t,name:"MuiTreeView"}),l=n,c=n,{disabledItemsFocusable:x,expanded:i,defaultExpanded:u,onNodeToggle:a,onNodeFocus:g,disableSelection:d,defaultSelected:N,selected:f,multiSelect:s,onNodeSelect:m,id:h,defaultCollapseIcon:v,defaultEndIcon:b,defaultExpandIcon:y,defaultParentIcon:C,children:S}=c,j=me(c,qo),{getRootProps:T,contextValue:P}=Do({disabledItemsFocusable:x,expanded:i,defaultExpanded:u,onNodeToggle:a,onNodeFocus:g,disableSelection:d,defaultSelected:N,selected:f,multiSelect:s,onNodeSelect:m,id:h,defaultCollapseIcon:v,defaultEndIcon:b,defaultExpandIcon:y,defaultParentIcon:C,plugins:zo,rootRef:o}),k=Yo(n),$=Ot({elementType:Pe,externalSlotProps:{},externalForwardedProps:j,className:k.root,getSlotProps:T,ownerState:l});return r.jsx(Ro,{value:P,children:r.jsx(Pe,E({},$,{children:S}))})}),Jo=Z(So)(({theme:e})=>({color:e.palette.text.secondary,[`& .${D.content}`]:{color:e.palette.text.secondary,borderTopRightRadius:e.spacing(2),borderBottomRightRadius:e.spacing(2),paddingRight:e.spacing(1),fontWeight:e.typography.fontWeightMedium,"&.MuiTreeItem-content":{paddingLeft:"3px",paddingRight:"3px"},".MuiTreeItem-label":{paddingLeft:"0px"},".MuiTreeItem-iconContainer":{marginRight:"0px"},"&.Mui-expanded":{fontWeight:e.typography.fontWeightRegular},"&:hover":{backgroundColor:e.palette.action.hover},"&.Mui-selected":{backgroundColor:"rgba(145, 85, 253, 0.16)",color:"var(--tree-view-color)"},"&.Mui-focused, &.Mui-selected, &.Mui-selected.Mui-focused":{backgroundColor:"rgba(145, 85, 253, 0.16)",color:"var(--tree-view-color)"},[`& .${D.label}`]:{fontWeight:"inherit",color:"inherit"}},[`& .${D.group}`]:{marginLeft:0,[`& .${D.content}`]:{paddingLeft:e.spacing(1)}}})),Qo=p.forwardRef(function(t,o){const{labelIcon:n,labelInfo:l,labelText:c,pl:x,...i}=t;return r.jsx(Jo,{label:r.jsxs(R,{sx:{display:"flex",alignItems:"center",p:.5,pr:2,pl:{pl:x}},children:[r.jsx(R,{component:n,color:"inherit",sx:{mr:1,pl:{pl:x}}}),r.jsx(ce,{sx:{fontWeight:"inherit",flexGrow:1},component:"div",children:c}),r.jsx(ce,{variant:"caption",color:"inherit",children:l})]}),...i,ref:o})}),it=e=>{const{id:t,fullIndex:o,title:n,sub:l}=e.item;if(t===void 0)return console.log("SubTreeItem.item.undefined=",e.item),r.jsx(r.Fragment,{});const c=l&&Object.values(l).length>0?Object.values(l).length+"":"";return r.jsx(Qo,{onClick:()=>e.onDetail(t,o),nodeId:t,labelText:n,labelInfo:c,pl:e.pl,children:l!=null?Object.values(l).sort((x,i)=>x.title>i.title?1:-1).map((x,i)=>r.jsx("div",{style:{paddingLeft:e.pl+5},children:r.jsx(it,{onDetail:e.onDetail,item:x,pl:e.pl+5})},i+"")):""})};function Xo(e){const[t,o]=p.useState([]),[n,l]=p.useState([]),c=(u,a)=>{e.onDetail(u,a)};p.useEffect(()=>{if(e.expandIndex!==void 0){let u=e.expandIndex.split("/");u=u.filter(a=>a!=="sub"),e.expandIndex.indexOf("undefined")<0&&(o(u),l(u[u.length-1]))}},[e.expandIndex]);const x=(u,a)=>{},i=(u,a)=>{o(a)};return r.jsx(R,{sx:{minHeight:180,flexGrow:1,display:"flex",flexDirection:"column",height:e.maxHeight,overflow:"hidden",overflowY:"auto",width:"100%"},children:r.jsx(Go,{"aria-label":"icon expansion",defaultCollapseIcon:r.jsx(io,{}),defaultExpandIcon:r.jsx(ro,{}),expanded:t,onNodeSelect:x,selected:n,onNodeToggle:i,sx:{flexGrow:1,overflow:"hidden",overflowY:"auto"},children:e.data&&e.data.map((u,a)=>r.jsx(it,{onDetail:c,item:u,parentIndex:a+1,pl:5},a+1))})})}const Zo={position:"absolute",top:"50%",left:"50%",display:"flex",flexDirection:"column",alignItems:"center",transform:"translate(-50%, -50%)",width:250,maxHeight:"400px",bgcolor:"background.paper",border:"1px solid #000",boxShadow:24,boxSizing:"border-box",p:4},en=e=>r.jsxs(R,{sx:{my:2,mt:3,display:"flex"},children:[r.jsx(V,{type:"submit",variant:"outlined",color:"success",onClick:e.onPost,children:"확인"}),r.jsx(V,{type:"button",variant:"outlined",onClick:e.onClose,children:"취소"})]}),tn=e=>{const[t,o]=p.useState(e.open),[n,l]=p.useState(),c=()=>{o(!1),l(void 0),e.onClose()};p.useEffect(()=>{o(e.open)},[e.open]);const x=u=>{l(u)},i=()=>{if(n===void 0){alert("이동할 메모장을 선택해 주세요");return}e.onPost(n)};return r.jsx("div",{children:r.jsx(At,{open:t,onClose:c,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:r.jsxs(R,{sx:Zo,children:[r.jsx(ce,{id:"modal-modal-title",variant:"h6",component:"h2",children:"이동할 메모장 선택"}),r.jsx(J,{}),r.jsx(R,{sx:{width:"100%",minHeight:110,maxHeight:200,flexGrow:1,minWidth:100,overflow:"hidden"},children:r.jsx(Xo,{data:e.data,onDetail:x,maxHeight:200})}),r.jsx(en,{onPost:i,onClose:c})]})})})},on=e=>r.jsxs(R,{sx:{flexGrow:1,my:2,width:"100%",display:"grid",gridTemplateColumns:"64px 64px  64px  64px ",flexDirection:"row",alignItems:"center",alignContent:"center",justifyContent:"center",textAlign:"center",whiteSpace:"nowrap"},children:[r.jsx(V,{type:"button",size:"small",variant:"outlined",color:"success",onClick:e.onEdit,children:"수정"}),r.jsx(V,{type:"button",size:"small",variant:"outlined",onClick:e.onNewMemo,children:"새글"}),e.rootDb==="memo"?r.jsx(V,{type:"button",size:"small",variant:"outlined",color:"warning",onClick:e.onMove,children:"이동"}):"",r.jsx(V,{type:"button",size:"small",variant:"outlined",color:"error",onClick:e.onDelete,children:"삭제"})]}),nn=e=>{const{rootDb:t,isLoading:o,memoDetailData:n}=e;console.log("MemoDetail.memoDetailData.title=",n?.title,", bookmark=",n?.bookmark);const{scrollYProgress:l}=Ye(),c=Ge(l,{stiffness:100,damping:30,restDelta:.001}),[x,i]=p.useState(!1),u=fe(),a=p.useRef();a.current=e.searchWord;const{memoId:g}=Ue(),N=Ie()?.state?.fullIndex,{user:f}=ue(),s=()=>{const S=`/${t}/edit/${g}`;u(S,{state:{fullIndex:N}})},m=()=>{const S=`/${t}/insert/${g}`;u(S,{state:{fullIndex:N}})},h=async()=>{const S=t==="memo"?`${t}_txt/${f.uid}/${g}`:`${t}_txt/${g}`,j=t==="memo"?`${t}/${f.uid}`:t;if(await Tt(S,j)===void 0){alert("삭제에 실패했습니다.[code:d02]");return}e.onTreeUpdate(),u(`/${t}`)},v=()=>{window.confirm(`하위 자료가 있는 경우 같이 삭제됩니다.
삭제하시겠습니까?`)&&h()},b=()=>{i(!0)},y=()=>{e.onBookmark()},C=async S=>{try{const j=t==="memo"?`${t}_txt/${f.uid}`:`${t}_txt`,T=t==="memo"?`memo/${f.uid}`:t,P=await wt(j,T,g,S);e.onTreeUpdate()}catch(j){console.log("catch",j)}finally{i(!1)}};return p.useEffect(()=>{n&&n.title!==void 0&&et({title:n.title,description:n.title});function S(){window.scrollTo({top:0}),n&&n.html!=="N"&&document.querySelectorAll("pre").forEach(j=>{j.innerHTML=Ht(j.innerHTML)})}n&&n.memo!==null&&S()},[n]),o?r.jsx(B,{}):g===""||f===void 0?r.jsx(r.Fragment,{}):r.jsxs("div",{children:[r.jsx(xt.div,{className:"progress-bar",style:{scaleX:c}}),r.jsxs("div",{className:`grid grid-cols-3 
				items-center w-full 
				dark:bg-stone-950 rounded-md shadow-sm 
				dark:shadow-stone-800 shadow-stone-900`,children:[r.jsx("div",{}),r.jsx("div",{className:"flex justify-center",children:n&&n.title}),r.jsxs("div",{className:"text-right justify-end mr-3.5",children:[r.jsx(Kt,{"aria-label":"bookmark",onClick:y,children:n&&n.bookmark==="Y"?r.jsx(_t,{sx:{color:"red"}}):r.jsx(jt,{})}),r.jsx("div",{className:"text-right mb-3 text-sm text-red-400",children:e.pathNm})]})]}),r.jsxs("div",{className:"w-full p-0 m-0",children:[r.jsx(on,{rootDb:t,onEdit:s,onNewMemo:m,onMove:b,onDelete:v,onBookmark:y,bookmark:n&&n.bookmark}),r.jsxs(R,{sx:{my:2},children:[n&&n.html==="N"?r.jsx(Ze,{postData:n&&n.memo}):n&&n.html!=="N"&&n.memo&&r.jsx(ht,{text:n.memo}),r.jsx(Bt,{imageList:n&&n.image}),!n&&r.jsx(R,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:r.jsx(Ut,{sx:{mt:5}})})]}),r.jsx(tn,{userId:f?.uid,open:x,data:e.data,onClose:()=>i(!1),onPost:C})]})]})},rn=({onSubmit:e,onCancel:t,isSubmitting:o,newMode:n})=>r.jsxs("div",{className:"flex justify-end mb-1.5 gap-1",children:[r.jsxs(de,{variant:"outlined",color:"success",disabled:o,onClick:l=>{l.preventDefault(),e(l)},children:[n?"새글":""," 저장"]}),r.jsx(de,{variant:"outlined",color:"error",onClick:t,children:"취소"})]}),sn=p.lazy(()=>ze(()=>import("./HomeChartForm-CrKT0MNu.js").then(e=>e.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36])));Et.Quill.register("modules/imageDrop",Dt);We.configure({languages:["javascript","ruby","python","java","cpp","kotlin","sql"]});const ln={syntax:{highlight:e=>We.highlightAuto(e).value},toolbar:[[{header:"1"},{header:"2"},{header:"3"},{font:[]}],[{size:[]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","image","video"],["clean"],["code-block"]],imageDrop:!0,clipboard:{matchVisual:!1}},an=["header","font","size","bold","italic","underline","strike","blockquote","list","bullet","indent","link","image","video","clean","code-block","code-custom"],cn=e=>{const[t,o]=p.useState(e.imageList),[n,l]=p.useState(e.htmlCheck==="Y"),[c,x]=p.useState(e.newMode?"":e.content),i=p.useRef(),u=p.useRef(),a=p.useRef(null),g=p.useRef(null),d=e.newMode,N=p.useRef([]),{height:f}=Wt(),s=zt.now().setZone("Asia/Seoul").toFormat("yyyy-MM-dd"),m={edTitle:d?"":e.title,edGbn:e.gbn?e.gbn:"etc",edDate:d?s:e.date,content:d?"":e.content,memoTxt:d?"":e.content,htmlCheck:e.htmlCheck},{register:h,handleSubmit:v,trigger:b,control:y,setValue:C,getValues:S,watch:j,formState:{errors:T,isSubmitting:P}}=qt({mode:"onChange",defaultValues:m});p.useEffect(()=>{h("edDate",{required:!0,minLength:10}),h("edGbn",{required:!0}),h("htmlCheck"),h("memoTxt")},[]),p.useEffect(()=>{N.current=[],i.current=e.content,u.current=!1},[e.content]);const k=async I=>{d?await e.onNewSubmit(I,N.current):await e.onPostSubmit(I,t,N.current)},$=()=>{v(k)()},ee=I=>{console.log("onDelete.imageList=",I),o(I)},ge=I=>{let w=i.current;I.ext==="jpg"?w+=`<img src='${I.url}'/>`:I.ext==="mp4"&&(w+=`<video preload="auto" controls="" src='${I.url}'></video>`),i.current=w},te=I=>{i.current=I},pe=I=>{console.log("handleFileUpload",I),N.current=I};function xe(I){i.current=I,C("content",I),b("content")}function K(I){console.log("handleChangeDate=",I);let w=be(I);w.format("YYYY-MM-DD HH:mm:ss"),console.log("handleChangeDate.dayjs=",w.format("YYYY-MM-DD HH:mm:ss")),C("edDate",w.format("YYYY-MM-DD")),b("edDate")}const oe=I=>{console.log("onChecked=",I),C("htmlCheck",I?"Y":"N"),l(I)},F=j("content"),_=[{value:"",text:"None"},{value:"react",text:"React"},{value:"css",text:"CSS"},{value:"android",text:"Android"},{value:"java",text:"JAVA"},{value:"image",text:"그림 / 사진"},{value:"etc",text:"기타"},{value:"mui",text:"MUI"}],ne=["React","JavaScript","Bash","Java","Kotlin","CSS","C++","C#","Command","Script","Python","Ruby","Go","Swift","Rust"],U=I=>{const w=a.current;if(w){const O=w.selectionStart,W=w.selectionEnd,A=c.slice(0,O),re=c.slice(W);x(A+I+re),C("memoTxt",A+I+re),setTimeout(()=>{w.selectionStart=w.selectionEnd=O+I.length,w.focus()},0)}},L=I=>{U(I)};return r.jsx("div",{className:"my-2 mb-[50px], w-full",children:r.jsxs("form",{onSubmit:v(k),style:{width:"100%",minHeight:"300px",maxHeight:{height:f},display:"flex",flexDirection:"column"},children:[r.jsx(rn,{onSubmit:I=>$(),onCancel:e.onCancel,isSubmitting:P,newMode:d}),r.jsx(kt,{control:y,onDelete:ee,onInsert:ge,setContent:te,onFileUpload:pe,imageList:e.imageList}),r.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[r.jsx(Xt,{...h("edTitle",{required:"해당 필드는 필수입니다.",minLength:{value:1,message:"1글자 이상 입력해주세요."}}),fullWidth:!0,label:"제목",placeholder:"제목",variant:"filled",size:"small",error:!!T.edTitle}),r.jsx(Gt,{id:"edGbn",name:"edGbn",label:"구분",mdSize:6,control:y,defaultValue:S("edGbn"),selectList:_,error:!!T.edGbn,onChange:I=>{I.preventDefault();const w=I.target.value;console.log("edGbn=",S("edGbn")),C("edGbn",w)}}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(Yt,{id:"edDate",label:"일자",mdSize:6,value:be(S("edDate")),...h("edDate"),defaultValue:be(S("edDate")),onChange:K}),r.jsx(Jt,{id:"html",checked:n,onChange:oe,label:"HTML사용"})]})]}),r.jsx(J,{}),r.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[r.jsx("div",{className:"max-h-130 overflow-y-scroll",children:r.jsx(Ze,{postData:c})}),r.jsxs("div",{children:[r.jsx(Qt,{ref:a,className:"",value:c,onChange:I=>{C("memoTxt",I),x(I)},rows:22}),r.jsx(J,{}),r.jsxs("div",{className:"grid grid-cols-4 gap-2 xsm:grid-cols-5 sm:grid-cols-7 md:grid-cols-7 lg:grid-cols-8",children:[r.jsx(ae,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L("<box></box>"),children:"<Box>"}),r.jsx(ae,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L("</code>"),children:"</code>"}),ne.map((I,w)=>r.jsx(ae,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L("<code>"+I+"</code>"),children:I},w)),r.jsx(ae,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L('<a href="" target="_blank"></a>'),children:"Link"})]}),r.jsx(J,{})]})]}),r.jsx(p.Suspense,{fallback:r.jsx("div",{children:"Loading editor..."}),children:r.jsx(sn,{ref:g,fullWidth:!0,theme:"snow",id:"content",name:"content",type:"div",value:F,style:{minWidth:"400px",border:"1px solid primary.main",minHeight:"200px",height:"400px",maxHeight:"450px"},modules:ln,formats:an,onChange:xe})}),r.jsx(J,{})]})})},$e=e=>{const{rootDb:t,isLoading:o,memoDetailData:n}=e,{scrollYProgress:l}=Ye();Ge(l,{stiffness:100,damping:30,restDelta:.001});const c=fe(),x=p.useRef(),i=p.useRef();i.current=e.searchWord;const{memoId:u}=Ue(),a=Ie(),g=n?.fullIndex,{user:d}=ue();x.current=a.pathname.split("/")[2]==="insert",console.log("MemoDetailEdit.memoDetailData=",n?.title),console.log("MemoDetailEdit.newMode=",x.current);const N=()=>{const m=`/${t}/${u==="insert"?"":u}`;c(m,{state:{fullIndex:g}})},f=async(m,h)=>{console.log("onNewSubmit.values",m),console.log("onNewSubmit.fullIndex",g);const v=t==="memo"?`${t}_txt/${d.uid}/`:`${t}_txt/`,b=t==="memo"?`${t}/${d.uid}/`:`${t}/`;console.log("onNewSubmit.txtLocate",v),console.log("onNewSubmit.locate",b);const y=await we(void 0,v,b,g,m);if(await Te(`${t}_txt`,t,y,h),y!==void 0){const C=`/${t}/${y}`;c(C,{state:{reflash:!0}})}},s=async(m,h,v)=>{const b=t==="memo"?`${t}_txt/${d.uid}`:`${t}_txt`,y=t==="memo"?`${t}/${d.uid}`:t;await Rt(b,y,u,h),console.log("onPostSubmit.values",m);const C=await we(x.current?void 0:u,`${b}/`,`${y}/`,g,m);console.log("onPostSubmit.newKey=",C),console.log("onPostSubmit.files=",v);const S=await Te(`${b}/`,`${y}/`,u,v);if(console.log("onNewSubmit.imageResult",S),console.log("onPostSubmit.fullIndex",g),t==="memo"&&g===void 0){const T=await St(d.uid,`${u}/fullIndex`);console.log("onPostSubmit.fullPath",T),T!==void 0&&qe(`memo/${d.uid}/${T}/title`,m.edTitle)}x.current=!1;const j=`/${t}/${u}`;c(j,{state:{fullIndex:g,reflash:!0}})};return p.useEffect(()=>{n&&n.title!==void 0&&et({title:n.title,description:n.title});function m(){document.querySelectorAll("pre").forEach((h,v)=>{})}n&&n.memo!==null&&m()},[n]),u===""||d===void 0?r.jsx(r.Fragment,{}):(console.log("MemoDetailEdit.isLoading=",o),n===void 0||o?r.jsx(B,{}):r.jsx(r.Fragment,{children:r.jsx("div",{className:"w-full p-0 m-0",children:x.current===!1&&n&&(n.title===void 0||n.title===""||n.title===null)?r.jsx(B,{}):r.jsx(cn,{newMode:x.current,onPostSubmit:s,onNewSubmit:f,onCancel:N,title:n?.title,gbn:n?.gbn,date:n?.date,htmlCheck:n?.html?n?.html:"Y",content:n?.memo,imageList:n?.image})})}))},dn=e=>{const t=p.useRef(null);function o(){e.onSearchDataBtn(t.current.value)}function n(){return e.onNewMemoBtn(),!1}function l(c){c.which===13&&o()}return r.jsxs(r.Fragment,{children:[r.jsx(Zt,{id:"edSearch",type:"edSearch",name:"edSearch",inputRef:t,className:"w-full ",allClassName:"px-3 py-2",placeholder:"Enter Search...",fullWidth:!0,onKeyDownCapture:l}),r.jsxs("div",{className:"flex justify-center",children:[r.jsx(de,{variant:"outlined",color:"success",className:"m-1 p-1",onClick:n,children:"새글"}),r.jsx(de,{variant:"outlined",color:"brand",className:"m-1 p-1",onClick:c=>o(),children:"조회"})]})]})},un=p.lazy(async()=>await ze(()=>import("./MUIMemoMain-B1b7_Tw4.js"),__vite__mapDeps([37,1,2,19,26]))),Nr=({rootDb:e})=>{const t=fe(),{user:o}=ue(),n=p.useRef(),l=p.useRef(!0),c=p.useRef(),[x,i]=p.useState(),u=p.useRef(!1),a=Ie(),g=p.useRef(!1);g.current=a?.state?.reflash===!0;const d=yt({queryKey:["treeMemo",o?.uid,n.current],queryFn:()=>Mt(e,o?.uid,n.current)});d.data!==void 0&&d.data!==""&&!u.current&&(u.current=!0);const N=()=>{const b=x;b&&(b.bookmark=b.bookmark==="Y"?"N":"Y");const y=e==="memo"?`memo_tree/${o.uid}/${c.current}/bm`:`home_txt/${c.current}/bookmark`;qe(y,x.bookmark),i({...x,bookmark:b.bookmark})};p.useEffect(()=>{o!==void 0&&o!=null&&d.refetch()},[o]),p.useEffect(()=>{const b=async S=>{if(S!==""&&o){const j=await eo(e,o?.uid,S,n.current);e==="memo"&&(j.path=to(d.data,S)),j.code==="404"&&(j.title="No title"),l.current=!1,i(j===void 0?{}:j)}else i({})},y=a.pathname.split("/"),C=y.length>2?y[y.length-1]:"";l.current=!0,c.current=C,b(C)},[a.pathname,o,g.current]),p.useEffect(()=>{o!==void 0&&o!=null&&d.refetch()},[g.current]);const f=b=>{u.current=!1,b!==void 0&&(n.current=b),d.refetch()},s=b=>{b.id!==c.current&&(l.current=!0,t(`/${e==="memo"?"m":e}/${b.id}`))},m=()=>{if(o==null){alert("로그인 후 이용 가능합니다.");return}const b=`/${e==="memo"?"m":e}/insert/insert`;t(b)},h=b=>{},v=r.jsxs(R,{sx:{width:270,p:1},children:[r.jsx(R,{sx:{mt:2,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(ce,{variant:"h6",component:"div",children:r.jsx(q,{component:z,to:e==="memo"?"/m":"/home",underline:"hover",children:e==="memo"?"메모장":"홈관리"})})}),r.jsxs(R,{sx:{display:"flex",gap:2,justifyContent:"center",my:2},children:[e==="memo"?null:r.jsx(q,{component:z,to:"/m",underline:"hover",children:"메모"}),e==="memo"&&o?.uid===bt?r.jsx(q,{component:z,to:"/home",underline:"hover",children:"홈관리"}):null,r.jsx(q,{component:z,to:"/todo",underline:"hover",children:"TODO"}),r.jsx(q,{component:z,to:"/tw",underline:"hover",children:"Sheet"})]}),o!==null&&r.jsx(dn,{onNewMemoBtn:m,onSearchDataBtn:f}),u.current&&d.isFetched?r.jsx(Pt,{initTreeData:d.data,userId:o?.uid,memoId:c.current,onClick:s}):o===null?r.jsx(r.Fragment,{}):r.jsx(B,{})]});return r.jsxs(vt,{sideType:"memo",title:e==="memo"?"메모장":"홈페이지관리",sideContents:v,children:[r.jsx(p.Suspense,{fallback:r.jsx(B,{}),children:r.jsxs(Nt,{children:[r.jsx(ie,{path:"/edit/:memoId",element:r.jsx($e,{rootDb:e,isLoading:l.current,searchWord:n.current,memoDetailData:x})}),r.jsx(ie,{path:"/insert/:memoId",element:r.jsx($e,{rootDb:e,isLoading:l.current,searchWord:n.current,memoDetailData:x})}),r.jsx(ie,{path:"/:memoId",element:r.jsx(nn,{rootDb:e,isLoading:l.current,searchWord:n.current,memoDetailData:x,onTreeUpdate:f,onBookmark:N,data:d.data})}),r.jsx(ie,{path:"*",element:r.jsx(un,{searchWord:n.current,data:d.data,onNewMemoBtn:m,title:e==="memo"?"메모장":"홈페이지관리",rootDb:e})})]})}),e==="memo"?r.jsx(ao,{onSelected:h}):null,c.current===""?r.jsx($t,{data:d.data}):null,r.jsx(Lt,{})]})};export{Nr as default};
