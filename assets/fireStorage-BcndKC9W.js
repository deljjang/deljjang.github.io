import{bU as c,bV as g,bW as u,bX as f,bY as y,bZ as $,b_ as b}from"./index-DM1iZTPq.js";import{s as h}from"./fireDatabase-p21Gmfrk.js";function w(t){var l=t.length,o=t.lastIndexOf("."),e=t.substring(o+1,l).toLowerCase();return e}function D(t){var l=t.indexOf("."),o=t.substring(0,l);return o}const k=async(t,l,o)=>{console.log("getImagePath.userId=",t),console.log("getImagePath.id=",l),console.log("getImagePath.fileNm=",o);const e={};e.ext=w(o),e.name=o,e.key=D(o);try{const a=`memo/${t}`,n=c(g,`${a}/${o}`),s=await u(n);e.url=s,console.log("getImagePath.img=",e),h(`memo_txt/${t}/${l}/image/${e.key}`,e)}catch(a){console.log("getImageList.catch",a)}return e},p=async(t,l,o,e)=>{const a="memo/I3cTgdCxwjhBBno4mtZYvnODPJu1";console.log("getImageList.id=",t),console.log("getImageList.base=",a),console.log("getImageList.image=",o);let n=new Array;for(let s in o){const r=o[s];try{if(r.key=s,r.url===void 0||r.url===""){const i=c(g,`${a}/${s}.${r.ext}`),m=await u(i);console.log("getImageList.downUrl=",m),r.url=m,h(`${t}/image/${s}/url`,m)}}catch{}n.push(r)}return n},L=async(t,l,o,e)=>{w(e.name),console.log("setFileUpload.locate=",t),console.log("setFileUpload.file=",e);let a=c(g,`${t}/${e.name}`);try{const s=await y(a);console.log("setFileUpload: 파일이 이미 존재합니다 파일정보=",s),a=c(g,`${t}/${o}${e.name}`)}catch(s){if(s.code!=="storage/object-not-found")throw console.error("setFileUpload: 파일 확인 중 오류:",s),s}return await $(a,e)},R=async(t,l,o,e)=>{const a={success:!0,key:o,message:"파일명이 성공적으로 변경되었습니다."};try{const n=c(g,t+l+"."+e);let s=c(g,t+o+"."+e);const r=await f(n);let i=0;for(;;)try{const F=await y(s);i++;const d=o+i;a.key=d,s=c(g,t+d+"."+e)}catch{console.log("renameFile: 업로드 확인 대기중...",i);break}await $(s,r),await b(n);const m=await u(s);return a.url=m,console.log("renameFile: 파일명 변경 완료"),a}catch(n){return console.error("renameFile: 파일명 변경 중 오류:",n),{success:!1,message:"파일명 변경 실패"}}},x=async(t,l,o)=>{console.log("setFileDelete.locate=",t),console.log("setFileDelete.id=",l),console.log("setFileDelete.file=",o);try{const e=c(g,`${t}/${o.key}.${o.ext}`);b(e).then(()=>{console.log("setFileDelete.storageRef=",e)}).catch(a=>{console.log("setFileDelete.error=",a)})}catch(e){console.log("setFileDelete.catch",e)}};export{w as a,D as b,x as c,k as d,R as e,p as g,L as s};
