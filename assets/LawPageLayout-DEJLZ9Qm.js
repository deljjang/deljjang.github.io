import{j as t,i}from"./index-6nPoEYnd.js";import{g as M,r as l}from"./router-BlMcuVHC.js";import{m as N,A as T,S as z,H as R,a as A}from"./App-gfyO5pOu.js";const P={civil:t.jsx(A,{}),criminal:t.jsx(R,{}),constitution:t.jsx(z,{})},Q=({pageType:f,lawContent:b})=>{const[k,y]=M(),[x,$]=l.useState([]),[m,E]=l.useState(!0),[j,v]=l.useState(""),[h,C]=l.useState(!0),[s,w]=l.useState(k.get("q")||""),n=`${f}Code`;l.useEffect(()=>{const e=setTimeout(()=>{y(s?{q:s}:{},{replace:!0})},300);return()=>clearTimeout(e)},[s,y]),l.useEffect(()=>{const e=[...b];if(e.sort((r,a)=>r.number>a.number?1:-1),$(e),E(!1),e.length>0){const r=e.find(a=>a.type==="article");r&&v(`article-${r.number}`)}},[b]),l.useEffect(()=>{if(m||x.length===0)return;const e=new IntersectionObserver(a=>{a.forEach(d=>{d.isIntersecting&&v(d.target.id)})},{rootMargin:"0px 0px -80% 0px",threshold:0}),r=document.querySelectorAll("section[id]");return r.forEach(a=>e.observe(a)),()=>r.forEach(a=>e.unobserve(a))},[m,x]);const S=(e,r)=>{e.preventDefault();const a=document.getElementById(r);a&&a.scrollIntoView({behavior:"smooth",block:"start"})},c=l.useCallback((e,r)=>{if(!r.trim()||!e)return e;const a=new RegExp(`(${r})`,"gi"),d=e.split(a);return t.jsx("span",{children:d.map((u,g)=>a.test(u)?t.jsx("mark",{className:"bg-yellow-300 dark:bg-yellow-500 px-0",children:u},g):u)})},[]),o=l.useMemo(()=>{if(!s.trim())return x;const e=s.toLowerCase();return x.filter(r=>["part","chapter","section"].includes(r.type)?!0:r.text&&r.text.toLowerCase().includes(e)||r.textEn&&r.textEn.toLowerCase().includes(e))},[x,s]),L=l.useMemo(()=>s.trim()?o.some(e=>e.type==="article"):!0,[o,s]),p=l.useMemo(()=>s.trim()?o.filter(e=>e.type==="article").length:null,[o,s]),I=l.useMemo(()=>t.jsxs("div",{className:"tableOfContents w-full",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:i.t(`${n}.tocTitle`)}),p!==null&&t.jsxs("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:["(",i.t(`${n}.searchResultCount`,{count:p}),")"]})]}),t.jsx("button",{onClick:()=>C(e=>!e),className:"p-1 rounded-md hover:bg-gray-200 dark:hover:bg-zinc-700","aria-label":h?i.t(`${n}.collapseToc`):i.t(`${n}.expandToc`),children:t.jsx(N.svg,{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",animate:{rotate:h?0:-90},transition:{duration:.2},children:t.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),t.jsx(T,{children:h&&t.jsx(N.ul,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"space-y-2 text-sm max-h-[60vh] overflow-y-auto origin-top",children:o.map((e,r)=>{if(e.type==="part")return t.jsx("li",{className:"font-semibold text-gray-900 dark:text-gray-100 pt-2",children:e.title},`toc-${r}`);if(e.type==="chapter")return t.jsx("li",{className:"font-medium text-gray-800 dark:text-gray-200 pt-1 ml-2",children:c(e.title,s)},`toc-${r}`);if(e.type==="section")return t.jsx("li",{className:"font-normal text-gray-700 dark:text-gray-300 pt-0 ml-4",children:c(e.title,s)},`toc-${r}`);if(e.type==="article"){const a=`article-${e.number}`,d=i.t(`${n}.article`,{number:e.number}),u=j===a;return t.jsx("li",{className:"ml-4",children:t.jsx("a",{href:`#${a}`,onClick:g=>S(g,a),className:`${u?"text-blue-700 dark:text-blue-300 font-bold":"text-blue-600 dark:text-blue-400"} hover:underline`,children:d})},`toc-${r}`)}return null})},"toc-list")})]}),[o,j,h,s,c,p,n]);return m?t.jsx("div",{className:"p-8 w-full",children:t.jsxs("div",{className:"animate-pulse space-y-4",children:[t.jsx("div",{className:"h-4 bg-gray-200 dark:bg-zinc-700 rounded w-3/4"}),t.jsx("div",{className:"h-4 bg-gray-200 dark:bg-zinc-700 rounded"}),t.jsx("div",{className:"h-4 bg-gray-200 dark:bg-zinc-700 rounded"}),t.jsx("div",{className:"h-4 bg-gray-200 dark:bg-zinc-700 rounded w-5/6"})]})}):t.jsxs("div",{className:"LawPage p-4 md:p-6 bg-white dark:bg-zinc-900 w-full",children:[t.jsxs("h1",{className:"text-3xl md:text-4xl font-bold mb-8 text-gray-900 dark:text-gray-100 border-b pb-4 text-center flex items-center justify-center gap-3",children:[P[f],i.t(`${n}.title`)]}),t.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 max-w-7xl mx-auto",children:[t.jsxs("div",{className:"w-full lg:w-1/4 lg:sticky top-24 self-start",children:[t.jsxs("div",{className:"relative mb-4",children:[t.jsx("input",{type:"text",value:s,onChange:e=>w(e.target.value),placeholder:i.t(`${n}.searchPlaceholder`),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md dark:bg-zinc-800 dark:border-zinc-600 focus:outline-none focus:ring-2 focus:ring-blue-500"}),s&&t.jsx("button",{onClick:()=>w(""),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300","aria-label":i.t(`${n}.clearSearch`),children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),I]}),t.jsx("div",{className:"w-full lg:w-3/4",children:L?t.jsx("div",{className:"prose prose-lg dark:prose-invert max-w-none space-y-6",children:o.map((e,r)=>e.type==="part"?t.jsxs("h2",{className:"text-2xl font-bold !mt-12 !mb-6 border-b pb-2",children:[c(e.title,s)," ",e.titleEn&&t.jsxs("span",{className:"text-gray-600 dark:text-gray-400 text-lg italic",children:["(",c(e.titleEn,s),")"]})]},r):e.type==="chapter"?t.jsxs("h3",{className:"text-xl font-bold !mt-10 !mb-4 border-b pb-1",children:[c(e.title,s)," ",e.titleEn&&t.jsxs("span",{className:"text-gray-600 dark:text-gray-400 text-base italic",children:["(",c(e.titleEn,s),")"]})]},r):e.type==="section"?t.jsxs("h4",{className:"text-lg font-bold !mt-8 !mb-3",children:[c(e.title,s)," ",e.titleEn&&t.jsxs("span",{className:"text-gray-600 dark:text-gray-400 text-sm italic",children:["(",c(e.titleEn,s),")"]})]},r):e.type==="article"?t.jsxs("section",{id:`article-${e.number}`,children:[t.jsx("h3",{className:"text-xl font-semibold !mb-2",children:i.t(`${n}.article`,{number:e.number})}),t.jsx("p",{className:"whitespace-pre-wrap leading-relaxed !mt-0",children:c(e.text,s)}),e.textEn&&t.jsx("p",{className:"whitespace-pre-wrap leading-relaxed text-gray-600 dark:text-gray-400 text-sm italic mt-2",children:c(e.textEn,s)})]},r):null)}):t.jsxs("div",{className:"text-center py-16 text-gray-500 dark:text-gray-400",children:[t.jsx("p",{className:"mb-2",children:i.t(`${n}.noResults`,{query:s})}),t.jsx("p",{className:"text-sm",children:i.t(`${n}.tryAnotherKeyword`)})]})})]})]})};export{Q as L};
