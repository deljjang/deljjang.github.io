const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MemoMain-lmfxsL3A.js","assets/index-CNjKK903.js","assets/index-CIpsw8nD.css","assets/AniButton-lxb_wTyQ.js","assets/Button-C5Pb2wIl.js"])))=>i.map(i=>d[i]);
import{a4 as $,a5 as Me,a6 as ze,a7 as Ne,a8 as Fe,a9 as Oe,aa as Pe,ab as _e,ac as je,ad as Ae,ae as qe,af as Ee,ag as ke,r as d,ah as Ve,ai as N,aj as De,ak as le,al as Ye,q as Ke,k as Ge,o as Xe,n as V,t as Y,am as Je,A as se,C as oe,j as r,i as B,an as Qe,T as Le,ao as Ue,ap as Ze,aq as et,ar as tt,as as nt,at as st,z as ot,D as rt,J as it,K as at,x as lt,au as ct,U as ut,m as ce,av as dt,F as ft,H as mt,S as gt,W as ht,N as xt,aw as pt,ax as vt,O as Ie,P as yt,ay as wt,y as ue,E as St,az as bt,R as Mt,V as de,aA as jt,Y as Et,Z as kt,$ as Dt,a3 as Lt,a0 as It,a1 as Tt,a2 as fe}from"./index-CNjKK903.js";import{M as $t,a as Bt}from"./MemoMoveModal-omeCQMWQ.js";import{S as Ct,g as Ht}from"./useTreeData-C3yY41l6.js";import{C as Rt}from"./CommonLayout-5IG_Mv_w.js";import{H as Te,f as me,a as ge,b as Wt,e as zt,d as Nt,g as Ft}from"./fireDetail-DJZNgAEQ.js";import{F as Ot}from"./Favorite-CLkDzF_G.js";import{A as _}from"./AniButton-lxb_wTyQ.js";import{c as Pt}from"./CodeText-O7JimZZB.js";import{u as _t}from"./useSuspenseQuery-B45VdhvZ.js";import"./TextField-GLSoyZ69.js";import"./Collapse-BvjoFlKZ.js";import"./SinyDate-DvdBAgwC.js";import"./InputAdornment-BHLs0Y08.js";import"./Popper-BPmc15oE.js";import"./Button-C5Pb2wIl.js";import"./Chip-PFHyqunC.js";import"./index.esm-Ca75EsPz.js";import"./datetime-BDx6lZXm.js";import"./useBaseQuery-CvVyCzGt.js";function $e(e,t){let o;const n=()=>{const{currentTime:s}=t,c=(s===null?0:s.value)/100;o!==c&&e(c),o=c};return $.update(n,!0),()=>Me(n)}const A=new WeakMap;let M;function At(e,t){if(t){const{inlineSize:o,blockSize:n}=t[0];return{width:o,height:n}}else return e instanceof SVGElement&&"getBBox"in e?e.getBBox():{width:e.offsetWidth,height:e.offsetHeight}}function qt({target:e,contentRect:t,borderBoxSize:o}){var n;(n=A.get(e))===null||n===void 0||n.forEach(s=>{s({target:e,contentSize:t,get size(){return At(e,o)}})})}function Vt(e){e.forEach(qt)}function Yt(){typeof ResizeObserver>"u"||(M=new ResizeObserver(Vt))}function Kt(e,t){M||Yt();const o=ze(e);return o.forEach(n=>{let s=A.get(n);s||(s=new Set,A.set(n,s)),s.add(t),M?.observe(n)}),()=>{o.forEach(n=>{const s=A.get(n);s?.delete(t),s?.size||M?.unobserve(n)})}}const q=new Set;let F;function Gt(){F=()=>{const e={width:window.innerWidth,height:window.innerHeight},t={target:window,size:e,contentSize:e};q.forEach(o=>o(t))},window.addEventListener("resize",F)}function Xt(e){return q.add(e),F||Gt(),()=>{q.delete(e),!q.size&&F&&(F=void 0)}}function Jt(e,t){return typeof e=="function"?Xt(e):Kt(e,t)}const Qt=50,he=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),Ut=()=>({time:0,x:he(),y:he()}),Zt={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function xe(e,t,o,n){const s=o[t],{length:i,position:c}=Zt[t],u=s.current,f=o.time;s.current=e[`scroll${c}`],s.scrollLength=e[`scroll${i}`]-e[`client${i}`],s.offset.length=0,s.offset[0]=0,s.offset[1]=s.scrollLength,s.progress=Ne(0,s.scrollLength,s.current);const a=n-f;s.velocity=a>Qt?0:Fe(s.current-u,a)}function en(e,t,o){xe(e,"x",t,o),xe(e,"y",t,o),t.time=o}function tn(e,t){const o={x:0,y:0};let n=e;for(;n&&n!==t;)if(n instanceof HTMLElement)o.x+=n.offsetLeft,o.y+=n.offsetTop,n=n.offsetParent;else if(n.tagName==="svg"){const s=n.getBoundingClientRect();n=n.parentElement;const i=n.getBoundingClientRect();o.x+=s.left-i.left,o.y+=s.top-i.top}else if(n instanceof SVGGraphicsElement){const{x:s,y:i}=n.getBBox();o.x+=s,o.y+=i;let c=null,u=n.parentNode;for(;!c;)u.tagName==="svg"&&(c=u),u=n.parentNode;n=c}else break;return o}const ne={start:0,center:.5,end:1};function pe(e,t,o=0){let n=0;if(e in ne&&(e=ne[e]),typeof e=="string"){const s=parseFloat(e);e.endsWith("px")?n=s:e.endsWith("%")?e=s/100:e.endsWith("vw")?n=s/100*document.documentElement.clientWidth:e.endsWith("vh")?n=s/100*document.documentElement.clientHeight:e=s}return typeof e=="number"&&(n=t*e),o+n}const nn=[0,0];function sn(e,t,o,n){let s=Array.isArray(e)?e:nn,i=0,c=0;return typeof e=="number"?s=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?s=e.split(" "):s=[e,ne[e]?e:"0"]),i=pe(s[0],o,n),c=pe(s[1],t),i-c}const on={All:[[0,0],[1,1]]},rn={x:0,y:0};function an(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function ln(e,t,o){const{offset:n=on.All}=o,{target:s=e,axis:i="y"}=o,c=i==="y"?"height":"width",u=s!==e?tn(s,e):rn,f=s===e?{width:e.scrollWidth,height:e.scrollHeight}:an(s),a={width:e.clientWidth,height:e.clientHeight};t[i].offset.length=0;let g=!t[i].interpolate;const p=n.length;for(let v=0;v<p;v++){const y=sn(n[v],a[c],f[c],u[i]);!g&&y!==t[i].interpolatorOffsets[v]&&(g=!0),t[i].offset[v]=y}g&&(t[i].interpolate=Oe(t[i].offset,Pe(n),{clamp:!1}),t[i].interpolatorOffsets=[...t[i].offset]),t[i].progress=_e(0,1,t[i].interpolate(t[i].current))}function cn(e,t=e,o){if(o.x.targetOffset=0,o.y.targetOffset=0,t!==e){let n=t;for(;n&&n!==e;)o.x.targetOffset+=n.offsetLeft,o.y.targetOffset+=n.offsetTop,n=n.offsetParent}o.x.targetLength=t===e?t.scrollWidth:t.clientWidth,o.y.targetLength=t===e?t.scrollHeight:t.clientHeight,o.x.containerLength=e.clientWidth,o.y.containerLength=e.clientHeight}function un(e,t,o,n={}){return{measure:()=>cn(e,n.target,o),update:s=>{en(e,o,s),(n.offset||n.target)&&ln(e,o,n)},notify:()=>t(o)}}const W=new WeakMap,ve=new WeakMap,ee=new WeakMap,ye=e=>e===document.documentElement?window:e;function re(e,{container:t=document.documentElement,...o}={}){let n=ee.get(t);n||(n=new Set,ee.set(t,n));const s=Ut(),i=un(t,e,s,o);if(n.add(i),!W.has(t)){const u=()=>{for(const v of n)v.measure()},f=()=>{for(const v of n)v.update(je.timestamp)},a=()=>{for(const v of n)v.notify()},g=()=>{$.read(u,!1,!0),$.read(f,!1,!0),$.update(a,!1,!0)};W.set(t,g);const p=ye(t);window.addEventListener("resize",g,{passive:!0}),t!==document.documentElement&&ve.set(t,Jt(t,g)),p.addEventListener("scroll",g,{passive:!0})}const c=W.get(t);return $.read(c,!1,!0),()=>{var u;Me(c);const f=ee.get(t);if(!f||(f.delete(i),f.size))return;const a=W.get(t);W.delete(t),a&&(ye(t).removeEventListener("scroll",a),(u=ve.get(t))===null||u===void 0||u(),window.removeEventListener("resize",a))}}function dn({source:e,container:t,axis:o="y"}){e&&(t=e);const n={value:0},s=re(i=>{n.value=i[o].progress*100},{container:t,axis:o});return{currentTime:n,cancel:s}}const te=new Map;function Be({source:e,container:t=document.documentElement,axis:o="y"}={}){e&&(t=e),te.has(t)||te.set(t,{});const n=te.get(t);return n[o]||(n[o]=qe()?new ScrollTimeline({source:t,axis:o}):dn({source:t,axis:o})),n[o]}function fn(e){return e.length===2}function Ce(e){return e&&(e.target||e.offset)}function mn(e,t){return fn(e)||Ce(t)?re(o=>{e(o[t.axis].progress,o)},t):$e(e,Be(t))}function gn(e,t){if(e.flatten(),Ce(t))return e.pause(),re(o=>{e.time=e.duration*o[t.axis].progress},t);{const o=Be(t);return e.attachTimeline?e.attachTimeline(o,n=>(n.pause(),$e(s=>{n.time=n.duration*s},o))):Ae}}function hn(e,{axis:t="y",...o}={}){const n={axis:t,...o};return typeof e=="function"?mn(e,n):gn(e,n)}function we(e,t){Ve(!!(!t||t.current))}const xn=()=>({scrollX:N(0),scrollY:N(0),scrollXProgress:N(0),scrollYProgress:N(0)});function pn({container:e,target:t,layoutEffect:o=!0,...n}={}){const s=Ee(xn);return(o?ke:d.useEffect)(()=>(we("target",t),we("container",e),hn((c,{x:u,y:f})=>{s.scrollX.set(u.current),s.scrollXProgress.set(u.progress),s.scrollY.set(f.current),s.scrollYProgress.set(f.progress)},{...n,container:e?.current||void 0,target:t?.current||void 0})),[e,t,JSON.stringify(n.offset)]),s}function vn(e){const t=Ee(()=>N(e)),{isStatic:o}=d.useContext(De);if(o){const[,n]=d.useState(e);d.useEffect(()=>t.on("change",n),[])}return t}function Se(e){return typeof e=="number"?e:parseFloat(e)}function yn(e,t={}){const{isStatic:o}=d.useContext(De),n=d.useRef(null),s=vn(le(e)?Se(e.get()):e),i=d.useRef(s.get()),c=d.useRef(()=>{}),u=()=>{const a=n.current;a&&a.time===0&&a.sample(je.delta),f(),n.current=Ye({keyframes:[s.get(),i.current],velocity:s.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:c.current})},f=()=>{n.current&&n.current.stop()};return d.useInsertionEffect(()=>s.attach((a,g)=>o?g(a):(i.current=a,c.current=g,$.update(u),s.get()),f),[JSON.stringify(t)]),ke(()=>{if(le(e))return e.on("change",a=>s.set(Se(a)))},[s]),s}const wn=e=>{const[t,o]=d.useState([]),n=()=>{const s=Ke(V(Y,`memo_txt/${e}`),Xe("bookmark"),Ge("Y"));Je(s,i=>{if(!i.exists())return;const c=i.val(),u=[];for(let f in c){const a=c[f];a.key=f,u.push(a)}u.sort((f,a)=>f.title>a.title?1:-1),o(u)})};return d.useEffect(()=>{n()},[e]),t};function Sn(e){const{user:t}=se(),o=oe(),n=wn(t?.uid);return t===void 0?r.jsx(r.Fragment,{}):r.jsxs(B,{sx:{display:"flex",alignItems:"center",flexDirection:"column",width:"100%"},children:[r.jsx(Qe,{}),r.jsx(Le,{children:"BookMark"}),n&&n.map((s,i)=>r.jsx("div",{children:r.jsx(Ue,{component:"button",variant:"body",onClick:()=>{e.onSelected(s.key),o(`/memo/${s.key}`)},children:r.jsx(Ze,{variant:"body1",children:s.title})})},i))]})}var z={},be;function bn(){if(be)return z;be=1;var e=et();Object.defineProperty(z,"__esModule",{value:!0}),z.default=void 0;var t=e(tt()),o=nt();return z.default=(0,t.default)((0,o.jsx)("path",{d:"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3m-4.4 15.55-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05"}),"FavoriteBorder"),z}var Mn=bn();const jn=st(Mn),En=e=>r.jsxs(B,{sx:{flexGrow:1,my:2,width:"100%",display:"grid",gridTemplateColumns:"64px 64px  64px  64px ",flexDirection:"row",alignItems:"center",alignContent:"center",justifyContent:"center",textAlign:"center",whiteSpace:"nowrap"},children:[r.jsx(_,{type:"button",size:"small",variant:"outlined",color:"success",onClick:e.onEdit,children:"수정"}),r.jsx(_,{type:"button",size:"small",variant:"outlined",onClick:e.onNewMemo,children:"새글"}),r.jsx(_,{type:"button",size:"small",variant:"outlined",color:"warning",onClick:e.onMove,children:"이동"}),r.jsx(_,{type:"button",size:"small",variant:"outlined",color:"error",onClick:e.onDelete,children:"삭제"})]}),kn=e=>{const{title:t,gbn:o,date:n,text:s,image:i,setFireId:c,bookmark:u,setBookmark:f,isLoading:a,onReload:g}=ot(),{scrollYProgress:p}=pn(),v=yn(p,{stiffness:100,damping:30,restDelta:.001}),[y,b]=d.useState(!1),[K,E]=d.useState(!1),O=oe(),w=d.useRef(),P=d.useRef();P.current=e.searchWord;const{memoId:h}=rt(),m=it()?.state?.fullIndex,{user:l}=se(),{settings:k,saveSettings:j}=at(),G=()=>{w.current=!1,a===!1&&b(!0)},X=()=>{w.current=!0,a===!1&&b(!0)},C=async()=>{console.log("handleDelete.memoId=",h);const x=`memo_txt/${l.uid}/${h}`,S=await Nt(x,`memo/${l.uid}`);if(console.log("handleDelete.result=",S),S===void 0){alert("삭제에 실패했습니다.[code:d02]");return}O("/memo")},D=()=>{window.confirm(`하위 자료가 있는 경우 같이 삭제됩니다.
삭제하시겠습니까?`)&&C()},H=()=>{b(!1)},J=()=>{E(!0)},L=()=>{const x=u==="Y"?"N":"Y";f(x),pt(l.uid,h,x)},Q=async x=>{console.log("onMoveSubmit.memoId",h),console.log("onMoveSubmit.moveId",x);try{const S=`memo_txt/${l.uid}/${h}`,I=`memo/${l.uid}`,R=await zt(S,I,h,x);console.log("onMoveSubmit.result=",R)}catch(S){console.log("catch",S)}finally{E(!1)}},U=async(x,S)=>{const I=`memo_txt/${l.uid}/`,R=`memo/${l.uid}/`,T=await me(void 0,I,R,m,x);console.log("onNewSubmit.newKey=",T,", homeId=",h);const Z=await ge("home_txt","home",T,S);console.log("onNewSubmit.imageResult",Z),T!==void 0&&O(`/memo/${T}`),w.current=!1,b(!1),g()},He=async(x,S,I)=>{const R=`memo_txt/${l.uid}`,T=`memo/${l.uid}`,Z=await Wt(R,T,h,S);console.log("onPostSubmit.imageDelete",Z),await me(h,`memo_txt/${l.uid}/`,`memo/${l.uid}/`,m,x),console.log("onPostSubmit.files=",I);const We=await ge(`memo_txt/${l.uid}`,`memo/${l.uid}`,h,I);if(console.log("onNewSubmit.imageResult",We),console.log("onPostSubmit.fullIndex",m),m===void 0){const ae=await vt(l.uid,`${h}/fullIndex`);ae!==void 0&&Ie(V(Y,`memo/${l.uid}/${ae}/title`),x.edTitle)}w.current=!1,b(!1),g()};d.useEffect(()=>{if(t.current!==void 0){const x=document.querySelector("title");x.innerHTML=`${lt.templateName} :: ${t.current}`}},[t.current]),d.useEffect(()=>{l!=null&&h!==void 0&&(console.log("useEffect.user=",l),j({...k,nodeId:h}),m!==void 0&&ct(l.uid,h,m),c(`memo_txt/${l.uid}/${h}`,`memo/${l.uid}/${h}`,P.current)),b(!1)},[h,l]);function Re(){document.querySelectorAll("pre").forEach(x=>{x.innerHTML=Pt(x.innerHTML)})}return d.useEffect(()=>{s!==null&&(Re(),console.log("useEffect.detailText=",s))},[s]),h===""||l===void 0?r.jsx(r.Fragment,{}):r.jsxs(ut.Fragment,{children:[r.jsx(ce.div,{className:"progress-bar",style:{scaleX:v}}),r.jsxs(Le,{style:{display:"flex",flexDirection:"row",alignItems:"center",alignContent:"center",justifyContent:"space-between"},children:[r.jsx("div",{}),r.jsx("div",{children:t.current}),r.jsx(ce.div,{whileHover:{scale:1.1},whileTap:{scale:.8},initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},transition:{duration:.5,ease:[0,.71,.2,1.01],scale:{type:"spring",damping:2,stiffness:100,restDelta:.001}},children:r.jsx(dt,{"aria-label":"bookmark",onClick:L,children:u==="Y"?r.jsx(Ot,{sx:{color:"red"}}):r.jsx(jn,{})})})]}),r.jsxs(ft,{className:"container",sx:{p:0,width:"100%"},children:[!y&&r.jsx(En,{onEdit:G,onNewMemo:X,onMove:J,onDelete:D,onBookmark:L,bookmark:u}),y&&r.jsx(Te,{newMode:w.current,onPostSubmit:He,onNewSubmit:U,onCancel:H,title:t.current,gbn:o.current,date:n.current,content:s,imageList:i}),r.jsxs(B,{sx:{my:2},children:[r.jsx(mt,{show:!y,text:s}),!y&&r.jsx(gt,{imageList:i,show:!y}),a&&r.jsx(B,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:r.jsx(ht,{sx:{mt:5}})})]}),r.jsx($t,{userId:l?.uid,open:K,data:e.data,onClose:()=>E(!1),onPost:Q})]}),r.jsx(xt,{})]})},Dn=220,Ln=d.lazy(async()=>await jt(()=>import("./MemoMain-lmfxsL3A.js"),__vite__mapDeps([0,1,2,3,4]))),Gn=()=>{const e=oe(),{user:t}=se(),[o,n]=d.useState(!1),s=d.useRef(),[i,c]=d.useState(""),[u,f]=d.useState(""),a=d.useRef(),g=d.useRef(!1),p=_t({queryKey:["treeMemo",s.current],queryFn:()=>Ht(t?.uid,s.current)});p.data!==void 0&&p.data!==""&&!g.current&&(console.log("setMemoData.tQuery.data=",p.data),g.current=!0,c(...p.data)),console.log("Memo.user=",g.current,t?.uid,", memoData=",i,", memoId=",u,", tQuery.isFetched=",p.isPending),d.useEffect(()=>{console.log("useEffect.memoData=",i)},[i]),d.useEffect(()=>{t!==void 0&&t!=null&&(console.log("useEffect.user=",t),p.refetch())},[t]);const v=m=>{console.log("onSearchDataBtn.v=",m),g.current=!1,s.current=m,p.refetch()},y=(m,l)=>{a.current=l,f(m),e(`/memo/${m}`,{state:{fullIndex:l}})},b=()=>{if(console.log("onNewMemoBtn.fullIndex",a),t===void 0){alert("로그인 후 이용 가능합니다.");return}n(!0)},K=()=>{n(!1)},E=async(m,l)=>{const k=`memo_txt/${t.uid}/`;for(let C=0;C<l.length;C++){const D=l[C].object,H=Ft(D.name);console.log("onNewSubmit.file.name",D.name,"ext=",H);const J={ext:H,name:D.name,use:"Y"},L=Et(kt(V(Y),k+"image")).key;console.log("onNewSubmit.image.newKey",L),Ie(V(Y,k+`image/${L}`),J);const Q=await Dt(Lt,`memo/${t.uid}/${u}/${L}.${H}`),U=await It(Q,D);console.log("onNewSubmit.uploadBytes",U)}const j=Tt(k),G={title:m.edTitle,date:m.edDate,gbn:m.edGbn,memo:m.content,fullIndex:j,up:j,bookmark:"N"};fe(`${k}${j}`,G);const X={gbn:"",property:"m",title:m.edTitle,up:j};fe(`memo/${t.uid}/${j}`,X),n(!1)},O=m=>{console.log("onSelected=",m),f(m)},{height:w,width:P}=yt(),h=r.jsxs(B,{className:"memoSide",sx:{minHeight:110,flexGrow:1,minWidth:100,maxHeight:w},children:[r.jsx(wt,{smHidden:!1}),r.jsx(Bt,{onNewMemoBtn:b,onSearchDataBtn:v}),r.jsx(B,{sx:{flexGrow:1,minWidth:100,minHeight:110,maxHeight:w-220,height:w-220},children:g.current&&p.isFetched?r.jsx(Ct,{data:p.data,onDetail:y,maxHeight:w-150}):r.jsx(ue,{})})]}),ie=t&&t.uid===St?r.jsx(bt,{to:"/homemng",children:" 홈페이지 관리"}):"";return r.jsxs(Rt,{title:"메모장",drawerWidth:Dn,width:P,sideContents:h,children:[!o&&r.jsx(d.Suspense,{fallback:r.jsx(ue,{}),children:r.jsxs(Mt,{children:[r.jsx(de,{path:"/:memoId",element:r.jsx(kn,{searchWord:s.current,data:i})}),r.jsx(de,{path:"*",element:r.jsx(Ln,{searchWord:s.current,data:i,onNewMemoBtn:b,title:"메모장 홈"})})]})}),o&&r.jsx(Te,{show:o,newMode:o.current,onPostSubmit:E,onNewSubmit:E,onCancel:K,title:"",content:"",imageList:[]}),r.jsx(Sn,{onSelected:O}),ie]})};export{Gn as default};
