import{r as M,j as R,a6 as D,dn as k,W as S,dp as E,dq as H,dr as Y,X as v}from"./index-DJthDwo5.js";H(Y);v();const N=({id:n,rootDb:r,memoId:t,index:a,block:o,onUpdateBlock:c,afterSelection:i,readOnly:C})=>{const u=M.useRef(null);M.useRef(null),console.log("HandsontableBlock=");const m=h=>{c(n,{content:h})},f=async(h,y,e)=>{const s=u.current?.hotInstance;if(!s)return;const d=o.content.columns.map((g,l)=>({...g,width:s.getColWidth(l)}));c(n,{content:{...o.content,columns:d}})};return R.jsx(R.Fragment,{children:R.jsx(T,{hotRef:u,columns:o.content.columns,rowData:o.content.data,colorData:o.content.colorData,colorTextData:o.content.colorTextData,gridData:o.content,onGridDataChange:m,afterSelection:i,handleAfterColumnResize:f,isDraggable:!1})})},T=({hotRef:n,search:r,columns:t,rowData:a,colorData:o,colorTextData:c,afterSelection:i,handleAfterColumnResize:C})=>{const{theme:u}=D();M.useEffect(()=>{const e=n.current?.hotInstance;if(!e||!a)return;let s=!1;o&&o.forEach((d,g)=>{d&&d.forEach((l,b)=>{const x=e.getCellMeta(g,b).backgroundColor,p=l||void 0;x!==p&&(e.setCellMeta(g,b,"backgroundColor",p),s=!0)})}),c&&c.forEach((d,g)=>{d&&d.forEach((l,b)=>{const x=e.getCellMeta(g,b).color,p=l||void 0;x!==p&&(e.setCellMeta(g,b,"color",p),s=!0)})}),s&&e.render()},[a,o,c,n]);const m=[],f=M.useMemo(()=>{if(!t)return;const e=[];return t.forEach((s,d)=>{s.select&&m.push({value:d,text:s.title,label:s.title}),e.push({...s,title:s.title})}),e},[t]),h=M.useMemo(()=>f&&f.map((e,s)=>{const{readOnly:d,...g}=e;let l={...g,theme:u,isFirstColumn:f.indexOf(e)===0,data:s,colorData:o,colorTextData:c};return e.type==="numeric"?l={...l,type:"numeric",numericFormat:{pattern:"0,0"},originalRenderer:k.renderers.NumericRenderer}:e.type==="date"?l={...l,type:"date",dateFormat:"YYYY-MM-DD",correctFormat:!0,editorOptions:{i18n:j},originalRenderer:k.renderers.DateRenderer}:e.type==="checkbox"?l={...l,type:"checkbox",className:"htCenter",originalRenderer:k.renderers.CheckboxRenderer}:l.originalRenderer=k.renderers.TextRenderer,{...l,renderer:F}}),[f,u,o,c]),y=u==="dark"?"ht-theme-main-dark-auto":"ht-theme-main";return R.jsx("div",{className:"TwHotTable w-full",children:R.jsx(S,{className:"no-scrollbar no-scrollbar-x no-scrollbar-y",ref:n,data:a,themeName:y,rowHeaders:!0,language:"ko-KR",colHeaders:t&&t.map(e=>e.title),autoWrapRow:!0,height:"auto",contextMenu:!0,search:r,observeChanges:!0,columnSorting:!0,afterSelection:i,formulas:{engine:E.buildEmpty({licenseKey:"gpl-v3"})},columns:h,manualColumnResize:!0,afterColumnResize:C,colWidths:t.map(e=>e.width),filters:!0,licenseKey:"non-commercial-and-evaluation"})})},F=(n,r,t,a,o,c,i)=>{i.originalRenderer?i.originalRenderer.apply(void 0,[n,r,t,a,o,c,i]):k.renderers.TextRenderer.apply(void 0,[n,r,t,a,o,c,i]);const C=n.getSettings().search,u=i.theme,m=n.getCellMeta(t,a),f=i.backgroundColor||m.backgroundColor,h=i.color||m.color,y=i.colorData,e=i.colorTextData;r.style.backgroundColor="",r.style.color="",C&&c&&String(c).toLowerCase().includes(C.toLowerCase())?(r.style.backgroundColor=u==="dark"?"#facc15":"yellow",r.style.color="black"):(r.style.backgroundColor=f,f||(t%2===0?r.style.backgroundColor=u==="dark"?"#101010":"#ffffff":r.style.backgroundColor=u==="dark"?"#000000":"#f8f8f8")),h&&(r.style.color=h),y?.[t]?.[a]&&(r.style.backgroundColor=y[t]?.[a]),e?.[t]?.[a]&&(r.style.color=e[t]?.[a])},j={previousMonth:"이전 달",nextMonth:"다음 달",months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],weekdays:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],weekdaysShort:["일","월","화","수","목","금","토"],firstDay:0,format:"YYYY-MM-DD",toString(n,r){const t=n.getDate(),a=n.getMonth()+1;return`${n.getFullYear()}-${a.toString().padStart(2,"0")}-${t.toString().padStart(2,"0")}`},parse(n,r){const t=n.split("-");return new Date(t[0],t[1]-1,t[2])}};export{N as HandsontableBlock};
