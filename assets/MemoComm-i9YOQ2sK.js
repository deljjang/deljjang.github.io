const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MemoSheetGrid-BV0k7HL7.js","assets/index-ChoWCdWa.js","assets/index-Di5hoLXz.css","assets/MemoDetailEdit-CrO_Xxbo.js","assets/useMemoMutation-CqfyHPfA.js","assets/TwCheckbox-B3sjdyvv.js","assets/TwTextArea-BB36DPgE.js","assets/angle-right-B2--YQzj.js","assets/MemoDetailEdit-DAKl4fNk.css","assets/MemoDetailUtil-j05COIQW.js"])))=>i.map(i=>d[i]);
import{aR as gt,aS as xt,aT as G,aU as ke,aV as Ye,aW as Ge,aX as pt,aY as yt,aZ as vt,a_ as wt,a$ as bt,b0 as jt,b1 as Xe,b2 as kt,b3 as Ct,b4 as Ce,b5 as U,r as u,b6 as Qe,b7 as _e,b8 as Ue,b9 as ge,ba as A,a9 as Je,v as ie,x as Ze,j as t,t as C,w as oe,e as H,bb as le,aF as ce,k as I,a4 as Ne,J as re,bc as Nt,bd as ze,p,be as St,bf as et,aK as ye,h as de,f as tt,al as st,bg as $t,bh as Tt,aa as Mt,bi as Lt,ad as at,ae as nt,bj as Et,bk as _t,bl as zt,bm as Ot,i as V,s as Se,bn as Bt,bo as Rt,bp as Dt,bq as Wt,g as At,br as Ht,a as ue,bs as xe,V as Ft,bt as ve,l as O,bu as we,R as J,m as be,bv as Pt,O as Oe,a1 as Be,H as Vt,am as It,bw as Kt,bx as qt,by as Yt,bz as Gt,bA as rt,ai as Xt,aj as q,_ as me,bB as Qt,bC as Ut,bD as Jt,bE as Zt,bF as es,bG as ts,bH as ss,bI as as}from"./index-ChoWCdWa.js";import{S as it,a as ns,b as rs}from"./angle-right-B2--YQzj.js";const se=new WeakMap;let ae;const ot=(e,a,n)=>(s,r)=>r&&r[0]?r[0][e+"Size"]:xt(s)&&"getBBox"in s?s.getBBox()[a]:s[n],is=ot("inline","width","offsetWidth"),os=ot("block","height","offsetHeight");function ls({target:e,borderBoxSize:a}){se.get(e)?.forEach(n=>{n(e,{get width(){return is(e,a)},get height(){return os(e,a)}})})}function cs(e){e.forEach(ls)}function ds(){typeof ResizeObserver>"u"||(ae=new ResizeObserver(cs))}function us(e,a){ae||ds();const n=gt(e);return n.forEach(s=>{let r=se.get(s);r||(r=new Set,se.set(s,r)),r.add(a),ae?.observe(s)}),()=>{n.forEach(s=>{const r=se.get(s);r?.delete(a),r?.size||ae?.unobserve(s)})}}const ne=new Set;let Y;function ms(){Y=()=>{const e={get width(){return window.innerWidth},get height(){return window.innerHeight}};ne.forEach(a=>a(e))},window.addEventListener("resize",Y)}function hs(e){return ne.add(e),Y||ms(),()=>{ne.delete(e),!ne.size&&typeof Y=="function"&&(window.removeEventListener("resize",Y),Y=void 0)}}function fs(e,a){return typeof e=="function"?hs(e):us(e,a)}function lt(e,a){let n;const s=()=>{const{currentTime:r}=a,i=(r===null?0:r.value)/100;n!==i&&e(i),n=i};return G.preUpdate(s,!0),()=>ke(s)}function gs(...e){const a=!Array.isArray(e[0]),n=a?0:-1,s=e[0+n],r=e[1+n],o=e[2+n],i=e[3+n],l=Ye(r,o,i);return a?l(s):l}function xs(e,a,n){const s=e.get();let r=null,o=s,i;const l=typeof s=="string"?s.replace(/[\d.-]/g,""):void 0,c=()=>{r&&(r.stop(),r=null)},m=()=>{c(),r=new pt({keyframes:[De(e.get()),De(o)],velocity:e.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...n,onUpdate:i})};if(e.attach((d,g)=>{o=d,i=f=>g(Re(f,l)),G.postRender(m)},c),Ge(a)){const d=a.on("change",f=>e.set(Re(f,l))),g=e.on("destroy",d);return()=>{d(),g()}}return c}function Re(e,a){return a?e+a:e}function De(e){return typeof e=="number"?e:parseFloat(e)}const ps=50,We=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),ys=()=>({time:0,x:We(),y:We()}),vs={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function Ae(e,a,n,s){const r=n[a],{length:o,position:i}=vs[a],l=r.current,c=n.time;r.current=e[`scroll${i}`],r.scrollLength=e[`scroll${o}`]-e[`client${o}`],r.offset.length=0,r.offset[0]=0,r.offset[1]=r.scrollLength,r.progress=yt(0,r.scrollLength,r.current);const m=s-c;r.velocity=m>ps?0:vt(r.current-l,m)}function ws(e,a,n){Ae(e,"x",a,n),Ae(e,"y",a,n),a.time=n}function bs(e,a){const n={x:0,y:0};let s=e;for(;s&&s!==a;)if(wt(s))n.x+=s.offsetLeft,n.y+=s.offsetTop,s=s.offsetParent;else if(s.tagName==="svg"){const r=s.getBoundingClientRect();s=s.parentElement;const o=s.getBoundingClientRect();n.x+=r.left-o.left,n.y+=r.top-o.top}else if(s instanceof SVGGraphicsElement){const{x:r,y:o}=s.getBBox();n.x+=r,n.y+=o;let i=null,l=s.parentNode;for(;!i;)l.tagName==="svg"&&(i=l),l=s.parentNode;s=i}else break;return n}const je={start:0,center:.5,end:1};function He(e,a,n=0){let s=0;if(e in je&&(e=je[e]),typeof e=="string"){const r=parseFloat(e);e.endsWith("px")?s=r:e.endsWith("%")?e=r/100:e.endsWith("vw")?s=r/100*document.documentElement.clientWidth:e.endsWith("vh")?s=r/100*document.documentElement.clientHeight:e=r}return typeof e=="number"&&(s=a*e),n+s}const js=[0,0];function ks(e,a,n,s){let r=Array.isArray(e)?e:js,o=0,i=0;return typeof e=="number"?r=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?r=e.split(" "):r=[e,je[e]?e:"0"]),o=He(r[0],n,s),i=He(r[1],a),o-i}const Cs={All:[[0,0],[1,1]]},Ns={x:0,y:0};function Ss(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function $s(e,a,n){const{offset:s=Cs.All}=n,{target:r=e,axis:o="y"}=n,i=o==="y"?"height":"width",l=r!==e?bs(r,e):Ns,c=r===e?{width:e.scrollWidth,height:e.scrollHeight}:Ss(r),m={width:e.clientWidth,height:e.clientHeight};a[o].offset.length=0;let d=!a[o].interpolate;const g=s.length;for(let f=0;f<g;f++){const x=ks(s[f],m[i],c[i],l[o]);!d&&x!==a[o].interpolatorOffsets[f]&&(d=!0),a[o].offset[f]=x}d&&(a[o].interpolate=Ye(a[o].offset,bt(s),{clamp:!1}),a[o].interpolatorOffsets=[...a[o].offset]),a[o].progress=jt(0,1,a[o].interpolate(a[o].current))}function Ts(e,a=e,n){if(n.x.targetOffset=0,n.y.targetOffset=0,a!==e){let s=a;for(;s&&s!==e;)n.x.targetOffset+=s.offsetLeft,n.y.targetOffset+=s.offsetTop,s=s.offsetParent}n.x.targetLength=a===e?a.scrollWidth:a.clientWidth,n.y.targetLength=a===e?a.scrollHeight:a.clientHeight,n.x.containerLength=e.clientWidth,n.y.containerLength=e.clientHeight}function Ms(e,a,n,s={}){return{measure:r=>{Ts(e,s.target,n),ws(e,n,r),(s.offset||s.target)&&$s(e,n,s)},notify:()=>a(n)}}const Q=new WeakMap,Fe=new WeakMap,pe=new WeakMap,Pe=e=>e===document.scrollingElement?window:e;function ct(e,{container:a=document.scrollingElement,...n}={}){if(!a)return Xe;let s=pe.get(a);s||(s=new Set,pe.set(a,s));const r=ys(),o=Ms(a,e,r,n);if(s.add(o),!Q.has(a)){const l=()=>{for(const g of s)g.measure(kt.timestamp);G.preUpdate(c)},c=()=>{for(const g of s)g.notify()},m=()=>G.read(l);Q.set(a,m);const d=Pe(a);window.addEventListener("resize",m,{passive:!0}),a!==document.documentElement&&Fe.set(a,fs(a,m)),d.addEventListener("scroll",m,{passive:!0}),m()}const i=Q.get(a);return G.read(i,!1,!0),()=>{ke(i);const l=pe.get(a);if(!l||(l.delete(o),l.size))return;const c=Q.get(a);Q.delete(a),c&&(Pe(a).removeEventListener("scroll",c),Fe.get(a)?.(),window.removeEventListener("resize",c))}}const Ve=new Map;function Ls(e){const a={value:0},n=ct(s=>{a.value=s[e.axis].progress*100},e);return{currentTime:a,cancel:n}}function dt({source:e,container:a,...n}){const{axis:s}=n;e&&(a=e);const r=Ve.get(a)??new Map;Ve.set(a,r);const o=n.target??"self",i=r.get(o)??{},l=s+(n.offset??[]).join(",");return i[l]||(i[l]=!n.target&&Ct()?new ScrollTimeline({source:a,axis:s}):Ls({container:a,...n})),i[l]}function Es(e,a){const n=dt(a);return e.attachTimeline({timeline:a.target?void 0:n,observe:s=>(s.pause(),lt(r=>{s.time=s.iterationDuration*r},n))})}function _s(e){return e.length===2}function zs(e,a){return _s(e)?ct(n=>{e(n[a.axis].progress,n)},a):lt(e,dt(a))}function Os(e,{axis:a="y",container:n=document.scrollingElement,...s}={}){if(!n)return Xe;const r={axis:a,container:n,...s};return typeof e=="function"?zs(e,r):Es(e,r)}const Bs=()=>({scrollX:U(0),scrollY:U(0),scrollXProgress:U(0),scrollYProgress:U(0)}),te=e=>e?!e.current:!1;function Rs({container:e,target:a,...n}={}){const s=Ce(Bs),r=u.useRef(null),o=u.useRef(!1),i=u.useCallback(()=>(r.current=Os((l,{x:c,y:m})=>{s.scrollX.set(c.current),s.scrollXProgress.set(c.progress),s.scrollY.set(m.current),s.scrollYProgress.set(m.progress)},{...n,container:e?.current||void 0,target:a?.current||void 0}),()=>{r.current?.()}),[e,a,JSON.stringify(n.offset)]);return Qe(()=>{if(o.current=!1,te(e)||te(a)){o.current=!0;return}else return i()},[i]),u.useEffect(()=>{if(o.current)return _e(!te(e)),_e(!te(a)),i()},[i]),s}function ut(e){const a=Ce(()=>U(e)),{isStatic:n}=u.useContext(Ue);if(n){const[,s]=u.useState(e);u.useEffect(()=>a.on("change",s),[])}return a}function mt(e,a){const n=ut(a()),s=()=>n.set(a());return s(),Qe(()=>{const r=()=>G.preRender(s,!1,!0),o=e.map(i=>i.on("change",r));return()=>{o.forEach(i=>i()),ke(s)}}),n}function Ds(e){ge.current=[],e();const a=mt(ge.current,e);return ge.current=void 0,a}function Ws(e,a,n,s){if(typeof e=="function")return Ds(e);const r=gs(a,n,s);return Array.isArray(e)?Ie(e,r):Ie([e],([o])=>r(o))}function Ie(e,a){const n=Ce(()=>[]);return mt(e,()=>{n.length=0;const s=e.length;for(let r=0;r<s;r++)n[r]=e[r].get();return a(n)})}function As(e,a={}){const{isStatic:n}=u.useContext(Ue),s=()=>Ge(e)?e.get():e;if(n)return Ws(s);const r=ut(s());return u.useInsertionEffect(()=>xs(r,e,a),[r,JSON.stringify(a)]),r}const Hs=({className:e})=>t.jsx("svg",{className:e,fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",clipRule:"evenodd"})}),Fs=({className:e})=>t.jsx("svg",{className:e,fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});async function Ps(e,a,n=""){if(a==null||a==="")return"";if(e==="home"){const m=await A("home/tree");if(m!=null)try{return JSON.parse(m)}catch(d){console.error("Error parsing JSON data:",d)}}const s=e==="home"?"home_txt":n===""?`${e}_tree/${a}`:`${e}_txt/${a}`,r=Je(ie(oe,s)),o=await Ze(r);if(!o.exists()||!o.exists())return null;const i=o.val(),l=[{text:"1.React",id:"react",key:"react",parent:"root"},{text:"2.CSS",id:"css",key:"css",parent:"root"},{text:"3.Android",id:"android",key:"android",parent:"root"},{text:"4.Java",id:"java",key:"java",parent:"root"},{text:"5.이미지",id:"image",key:"image",parent:"root"},{text:"6.Etc",id:"etc",key:"etc",parent:"root"}],c=[];e==="home"&&c.push(...l);for(const m in i){const d=i[m];d.id=m;const g={id:m,key:m,text:d.title,parent:e==="home"?d.gbn:d.parent};e==="memo"?(g.icon=d.bm==="Y"?t.jsx(Hs,{className:"w-4 h-4 text-red-500"}):d.icon==="Y"?t.jsx(Fs,{className:"w-4 h-4 text-green-500"}):null,g.droppable=!0):g.droppable=!1,!((n===""||n===void 0||n===null)&&(g.parent===void 0||g.parent===null||g.parent===""))&&(e==="home"||n===""||n===void 0||n===null?c.push(g):(d.id=m,(d.memo+"").toLowerCase().indexOf(n.toLowerCase())>-1&&(g.parent="root",g.droppable=!1,c.push(g))))}return c.sort((m,d)=>m.title>d.title?1:-1),e==="home"&&C("home/tree",JSON.stringify(c)),c}const Vs=({isOpen:e,onClose:a,data:n})=>{const{t:s}=H();if(!e||!n)return null;const{label:r,value:o,items:i}=n;return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",onClick:a,children:t.jsxs("div",{className:"bg-white dark:bg-zinc-800 rounded-lg shadow-xl w-11/12 md:w-1/2 lg:w-1/3 max-h-[80vh] flex flex-col",onClick:l=>l.stopPropagation(),children:[t.jsxs("div",{className:"flex justify-between items-center border-b p-4 dark:border-zinc-600",children:[t.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:r}),t.jsx("button",{onClick:a,className:"text-gray-400 hover:bg-gray-200 dark:hover:bg-zinc-700 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center",children:t.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),t.jsxs("div",{className:"p-4 overflow-y-auto",children:[t.jsxs("p",{className:"text-base leading-relaxed text-gray-600 dark:text-gray-300 mb-4",children:[s("count","개수"),": ",t.jsx("span",{className:"font-bold",children:o.toLocaleString()})]}),t.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:s("main_list","주요 목록")}),t.jsx("ul",{className:"list-disc list-inside bg-gray-50 dark:bg-zinc-700 p-3 rounded-md",children:i&&i.length>0?i.map((l,c)=>t.jsx("li",{className:"text-gray-700 dark:text-gray-300",children:l.text},c)):t.jsx("li",{className:"text-gray-500",children:s("no_results","결과 없음")})})]})]})})};function Is({series:e,labels:a,onDataPointClick:n}){const[s,r]=u.useState({labels:[],colors:le,dataLabels:{style:{colors:["#333"]}},responsive:[{breakpoint:480,options:{chart:{width:"100%"},legend:{position:"bottom"}}}]});return u.useEffect(()=>{r(o=>({...o,labels:a}))},[a]),t.jsx("div",{className:"bg-amber-50 dark:bg-gray-900 shadow-md rounded-sm",children:e&&e.length>0?t.jsx(ce,{type:"donut",series:e,options:s}):t.jsx("div",{className:"text-center text-gray-500",children:"표시할 데이터가 없습니다."})})}function Ks({series:e,labels:a,onDataPointClick:n}){const[s,r]=u.useState({chart:{type:"radar",toolbar:{show:!1},events:{dataPointSelection:(o,i,l)=>{n&&n(l.dataPointIndex)}}},colors:le,plotOptions:{radar:{polygons:{distributed:!0}}},dataLabels:{enabled:!1},xaxis:{categories:[]},legend:{show:!0},tooltip:{theme:"dark",style:{fontSize:"12px"},y:{formatter:o=>o.toLocaleString()}}});return u.useEffect(()=>{r(o=>({...o,xaxis:{...o.xaxis,categories:a}}))},[a]),t.jsx("div",{className:"bg-white dark:bg-black shadow-md rounded-sm w-full h-full",children:e&&e.length>0&&e[0].data.length>0?t.jsx(ce,{type:"radar",series:e,options:s}):t.jsx("div",{className:"text-center text-gray-500 py-10",children:"표시할 데이터가 없습니다."})})}function qs({series:e,labels:a,onDataPointClick:n}){const[s,r]=u.useState({labels:[],chart:{events:{dataPointSelection:(o,i,l)=>{n&&n(l.dataPointIndex)}}},colors:le,plotOptions:{pie:{startAngle:-90,endAngle:90,offsetY:10}},grid:{padding:{bottom:-80}},dataLabels:{style:{colors:["#333"]}},responsive:[{breakpoint:480,options:{chart:{width:"100%"},legend:{position:"bottom"}}}],tooltip:{theme:"dark",style:{fontSize:"12px"},y:{formatter:o=>o.toLocaleString()}},legend:{show:!0}});return u.useEffect(()=>{r(o=>({...o,labels:a}))},[a]),t.jsx("div",{className:"bg-amber-50 dark:bg-gray-900 shadow-md rounded-sm p-2",children:e&&e.length>0&&t.jsx(ce,{type:"donut",series:e,options:s})})}function Ys({series:e,labels:a,showDownload:n=!0,onDataPointClick:s}){const[r,o]=u.useState({chart:{type:"bar",toolbar:{tools:{download:n}},events:{dataPointSelection:(i,l,c)=>{s&&s(c.dataPointIndex)}}},colors:le,plotOptions:{bar:{borderRadius:4,horizontal:!1,distributed:!0}},dataLabels:{enabled:!1},xaxis:{categories:[]},legend:{show:!1},tooltip:{theme:"dark",style:{fontSize:"12px"},y:{formatter:i=>i.toLocaleString()}}});return u.useEffect(()=>{o(i=>({...i,xaxis:{...i.xaxis,categories:a}}))},[a]),t.jsx("div",{className:"bg-white dark:bg-black shadow-md rounded-sm w-full p-2",children:e&&e.length>0&&e[0].data&&e[0].data.length>0?t.jsx(ce,{type:"bar",series:e,options:r,height:"350"}):t.jsx("div",{className:"text-center text-gray-500 py-10",children:"표시할 데이터가 없습니다."})})}const Gs=({rootDb:e})=>{const{user:a}=I(),{t:n}=H(),s=Ne(),r=re(Nt(e)),[o,i]=u.useState(!0),[l,c]=u.useState("donut"),[m,d]=u.useState(!1),[g,f]=u.useState(null),[x,w]=u.useState([]),[b,T]=u.useState([]),[M,y]=u.useState({labels:[],series:[]}),v=["#6366f1","#3b82f6","#22c55e","#ef4444","#f97316","#eab308","#8b5cf6","#d946ef","#14b8a6","#a855f7"],z=[{value:"donut",label:n("donut_chart","도넛 차트")},{value:"bar",label:n("bar_chart","수평 막대 차트")},{value:"radar",label:n("radar_chart","레이더 차트")},{value:"verticalBar",label:n("vertical_bar_chart","수직 막대 차트")},{value:"semiDonut",label:n("semi_donut_chart","반원 도넛 차트")}],L=u.useCallback(j=>{let B=[];if(w(j||[]),j&&j.length>0){const F=j.filter(k=>k.parent==="root").sort((k,R)=>k.text.localeCompare(R.text)),_=(k,R)=>{const P=R.filter(W=>W.parent===k);let D=P.length;for(const W of P)D+=_(W.id,R);return D};B=F.map(k=>({node:k,count:_(k.id,j)})).filter(k=>k.count>=10);const Z=B.map(k=>k.node.text),X=B.map(k=>k.count),K={labels:Z,series:X};T(B),y(K),s(ze({rootDb:e,data:K}))}else y({labels:[],series:[]}),s(ze({rootDb:e,data:{labels:[],series:[]}}));i(!1)},[e,s]),N=u.useCallback(async()=>{i(!0);const j=await Ps(e==="sheet"?"memo":e,a?.uid);L(j)},[e,a?.uid,L]);u.useEffect(()=>{a?.uid&&(r&&r.labels&&r.labels.length>0?(y(r),i(!1)):N())},[e,a?.uid,r,N]);const E=j=>{if(j<0||j>=b.length)return;const B=b[j].node,F=B.text,_=(k,R)=>{const P=R.filter(W=>W.parent===k);let D=[...P];return P.forEach(W=>{D=[...D,..._(W.id,R)]}),D},X=_(B.id,x).length,K=x.filter(k=>k.parent===B.id);f({label:F,value:X,items:K}),d(!0)},S=()=>t.jsx("div",{className:"w-full h-full flex justify-center items-center p-4",children:t.jsxs("div",{className:"w-full h-full bg-gray-200 dark:bg-zinc-800 rounded-md animate-pulse relative overflow-hidden",children:[t.jsx("div",{className:"absolute top-1/4 left-1/4 w-1/2 h-1/2 bg-gray-300 dark:bg-zinc-700 rounded-full opacity-50"}),t.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-1/3 h-1/3 bg-gray-300 dark:bg-zinc-700 rounded-lg opacity-50"})]})}),he=()=>{N()},fe=t.jsxs("div",{className:`HomeChartForm ${p.between}`,children:[t.jsx("div",{children:n("count_stats")}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("select",{value:l,onChange:j=>c(j.target.value),className:"rounded-md border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-200 focus:ring-indigo-500 focus:border-indigo-500 text-sm","aria-label":n("select_chart_type","차트 종류 선택"),children:z.map(j=>t.jsx("option",{value:j.value,children:j.label},j.value))}),t.jsx("button",{onClick:he,className:"rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ","aria-label":n("reload_chart"),children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h5M20 20v-5h-5M4 4l1.5 1.5A9 9 0 0121.5 12M20 20l-1.5-1.5A9 9 0 012.5 12"})})})]})]});return t.jsxs("div",{className:`w-full justify-center ${p.card} `,children:[t.jsx("div",{className:"flex pl-6 py-4",children:t.jsx(St,{title:fe})}),o?t.jsx(S,{}):t.jsxs("div",{className:"w-full justify-center items-center",children:[l==="donut"&&t.jsx(Is,{series:M.series,labels:M.labels,colors:v,onDataPointClick:E}),l==="bar"&&t.jsx(et,{series:[{name:n("count"),data:M.series}],labels:M.labels,colors:v,onDataPointClick:E}),l==="radar"&&t.jsx(Ks,{series:[{name:n("count"),data:M.series}],labels:M.labels,colors:v,onDataPointClick:E}),l==="verticalBar"&&t.jsx(Ys,{series:[{name:n("count"),data:M.series}],labels:M.labels,colors:v,onDataPointClick:E}),l==="semiDonut"&&t.jsx(qs,{series:M.series,labels:M.labels,colors:v,onDataPointClick:E})]}),t.jsx(Vs,{isOpen:m,onClose:()=>d(!1),data:g})]})},Xs=()=>{const[e,a]=u.useState({labels:[],series:[]}),[n,s]=u.useState(null),[r,o]=u.useState({isOpen:!1}),{t:i}=H();return u.useEffect(()=>{(async()=>{const c=await A("home_cnt");if(c){s(c);const d=Object.keys(c).sort().reverse().slice(0,10),g=d.map(x=>x.split("-").slice(1).join("-")),f=d.map(x=>Object.keys(c[x]).length);a({labels:g,series:f})}})()},[]),t.jsxs("div",{className:`w-full justify-center ${p.card} `,children:[t.jsx("div",{className:"flex pl-6 py-4",children:i("visitors.count")}),t.jsx(et,{series:[{name:i("count"),data:e.series}],labels:e.labels,showDownload:!1,onDataPointSelection:(l,c,m)=>{const d=m.dataPointIndex;if(n&&d>-1){const f=Object.keys(n).sort().reverse()[d],x=n[f],w=Object.keys(x).join("<br/>");console.log("filteredNodes=",w),o({isOpen:!0,title:`${f} ${i("visitors.count")}`,message:w,onClose:()=>o({isOpen:!1})})}}}),t.jsx(ye,{...r})]})},Qs=({item:e})=>{const{user:a}=I(),n=de();return t.jsx("div",{onClick:()=>n(`/m/${e.key}`),className:`${p.roundedXl} border border-gray-200 
      bg-white dark:border-gray-800 dark:bg-white/[0.03] 
      overflow-hidden cursor-pointer hover:shadow-md transition-shadow h-full flex flex-col`,children:t.jsx("div",{className:"px-4 py-3",children:t.jsx("h3",{className:"text-base font-medium text-gray-800 dark:text-white/90 truncate",children:e.title})})})};function Us(){const{user:e}=I(),{t:a}=H(),{data:n,isLoading:s}=tt({queryKey:["bookmarks",e?.uid],queryFn:async()=>{const o=[],i=Je(ie(oe,`memo_tree/${e.uid}`),Mt("bm"),Tt("Y")),l=await Ze(i);if(!l.exists())return[];const c=l.val();for(let m in c){const d=c[m];d.id=m,d.key=m,d.text=d.title,o.push(d)}return o.sort((m,d)=>m.title>d.title?1:-1),o},enabled:!!e}),r="grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4";return e===null?t.jsx(t.Fragment,{}):t.jsx(st,{title:a("main_list"),children:t.jsx("div",{className:"p-2",children:s?t.jsx($t,{}):t.jsx("div",{className:`grid ${r} gap-3`,children:n?.map(o=>t.jsx(Qs,{item:o},o.id))})})})}const Js=({rootDb:e})=>{const{user:a}=I(),{t:n}=H(),s=n(e==="memo"?"appMemo":"home_mng"),r=t.jsx("div",{className:`displayTitle text-center  ${p.text3Xl} ${p.textIndigo}`,children:s});return t.jsx(t.Fragment,{children:t.jsx(st,{title:r,className:"MemoMain mt-3 mb-5",children:t.jsxs("div",{className:"grid gird-cols-1 md:grid-cols-5 items-center gap-3",children:[a===null?t.jsx("p",{className:`${p.textRed500} ${p.textLgFontSemiboldLeft} ${p.mdColSpan3}`,children:n("login_used")}):t.jsx("p",{className:`${p.textGray600DarkZinc400} text-left ${p.mdColSpan3}`,dangerouslySetInnerHTML:{__html:n("memo_main_guide").replace(`
`,"<br/>")}}),t.jsx("div",{className:`w-full ${p.flexCenter} md:col-span-2`,children:t.jsx(Lt,{})})]})})})},Zs=async(e,a)=>(await A(e)===void 0||C(e,null),C(a,null),"OK"),ha=async({rootDb:e,uid:a,newData:n=!1,key:s,values:r})=>{const o=e==="memo"?`${e}_txt/${a}/`:`${e}_txt/`,i=e==="memo"?`${e}_tree/${a}/`:`${e}/`;let l=s;n&&(l=at(nt(ie(oe),i)).key),console.log("setFireDetailData.values=",r);const c=o+l;return C(c+"/title",r.edTitle),r.htmlCheck==="N"||r.htmlCheck==="sheet"?C(c+"/memo",r.memoTxt):C(c+"/memo",r.content),C(c+"/date",r.edDate),C(c+"/gbn",r.edGbn),C(c+"/html",r.htmlCheck),n&&e!=="home"&&(C(`${i}/${l}/key`,l),C(`${i}/${l}/parent`,s)),e!=="home"&&(C(`${i}${l}/title`,r.edTitle),C(`${i}${l}/icon`,r.iconCheck)),l},fa=async(e,a,n,s)=>{if(s!==void 0)for(let r=0;r<s.length;r++){const o=s[r];o.del==="Y"&&(C(`${e}/${n}/image/${o.key}`,null),Et(a,n,o))}},ga=async(e,a,n,s)=>{for(let r=0;r<s.length;r++){const o=s[r].object,l={ext:_t(o.name),name:o.name,use:"Y",sever:""},c=at(nt(ie(oe),e+"/image")).key,m=await zt(a,n,c,o);l.sever=Ot(m.metadata.name);const d=`${e}${n}/image/${l.sever}`;C(d,l)}},Ke=e=>{const{t:a}=H();return t.jsxs("div",{className:"mx-auto grid w-full max-w-lg grid-cols-5 items-center justify-center gap-2 px-4 py-2 text-center",children:[e.master&&t.jsx(V,{size:"sm",variant:"outlined",color:"brand",onClick:e.onUtil,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l-.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),t.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("util")})]})}),t.jsx(V,{size:"sm",variant:"outlined",color:"brand",onClick:e.onEdit,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),t.jsx("path",{d:"m15 5 4 4"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("edit")})]})}),t.jsx(V,{size:"sm",variant:"outlined",color:"brand",onClick:e.onNewMemo,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M5 12h14"}),t.jsx("path",{d:"M12 5v14"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("new")})]})}),t.jsx(V,{size:"sm",variant:"outlined",color:"error",onClick:e.onDelete,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M3 6h18"}),t.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),t.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("delete")})]})}),e.onCopy&&t.jsx(V,{size:"sm",variant:"outlined",color:"secondary",onClick:e.onCopy,className:"gap-1.5",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:t.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})}),t.jsx("span",{className:"ml-2 whitespace-nowrap",children:a("public")})]})})]})};function ea(e,a,n,s){const r=Ne(),o=Se(),i=re(Bt(n)),l=re(Rt(n)),c=l==="loading";return u.useEffect(()=>{a?.uid&&n&&n!=="insert"&&l!=="succeeded"&&r(Dt({rootDb:e,userId:a.uid,memoId:n}))},[r,e,a?.uid,n,l]),{memoDetailData:i||{},isLoading:c,onBookmark:()=>{if(!i)return;const d=i.bookmark==="Y"?"N":"Y";r(Wt({rootDb:e,userId:a.uid,memoId:n,newBookmarkState:d})).unwrap().then(()=>{o.invalidateQueries({queryKey:["twTreeData",e],refetchType:"all"}),o.invalidateQueries({queryKey:["bookmarks",a?.uid],refetchType:"all"}),s&&s(!0)})}}}const ta=({rootDb:e,searchWord:a})=>{const{user:n}=I(),{memoId:s}=At(),r=Ne(),o=h=>{r(Gt(h))},{memoDetailData:i,isLoading:l,onBookmark:c}=ea(e,n,s,o),[m,d]=u.useState(!1),{alertInfo:g,setAlertInfo:f,resetAlertInfo:x}=Ht(),[w,b]=u.useState(!1),[T,M]=u.useState(""),[y,v]=u.useState(!1),[z,L]=u.useState(""),[N,E]=u.useState(!1),{t:S}=H(),{scrollYProgress:he}=Rs(),fe=As(he,{stiffness:100,damping:30,restDelta:.001}),j=de(),F=ue()?.state?.fullIndex,_=Se(),Z=xe({mutationFn:async()=>{const h=e==="memo"?`${e}_txt/${n.uid}/${s}`:`${e}_txt/${s}`,$=e==="memo"?`${e}_tree/${n.uid}/${s}`:`${e}/${s}`;return await Zs(h,$)},onSuccess:()=>{_.invalidateQueries({queryKey:["twTreeData",e]}),j(`/${e==="memo"?"m":e}`)},onError:h=>{console.error("삭제 중 오류 발생:",h)}}),X=xe({mutationFn:async()=>{if(!n||!s||e!=="memo")throw new Error("Only private memos can be copied.");`${n.uid}${s}`;const h=i;if(!h)throw new Error("Memo data not found.");const $=`home_txt/${s}`;await C($,h);const ee=`memo_tree/${n.uid}/${s}`,ft=`home/${s}`;await C(`${ee}/public`,"Y"),await C(ft,{...h,key:s,text:h.title})},onSuccess:()=>{f({isOpen:!0,title:S("complete"),message:S("copy_completed"),color:"success",onConfirm:x,onClose:x}),_.invalidateQueries({queryKey:["memoDetail","home",n?.uid,s]})},onError:h=>{console.error("Copy failed:",h);const $=`${S("copy_failed")} ${h.message?`: ${h.message}`:""}`;f({isOpen:!0,title:S("error"),message:$,color:"error",onConfirm:x,onClose:x})}});xe({mutationFn:async h=>{const $=e==="memo"?`memo_txt/${n.uid}/${s}/title`:`home_txt/${s}/title`,ee=e==="memo"?`memo_tree/${n.uid}/${s}/title`:`home/${s}/title`;return await C($,h),await C(ee,h),h},onSuccess:h=>{_.setQueryData(["memoDetail",e,n?.uid,s],$=>({...$,title:h})),_.invalidateQueries({queryKey:["twTreeData",e]}),_.invalidateQueries({queryKey:["tabTitle",e,n?.uid,s]}),v(!1)},onError:h=>{console.error("제목 업데이트 중 오류 발생:",h),v(!1)}});const K=()=>{r(Yt({rootDb:e,memoId:s,newMemoContent:T})).unwrap().then(()=>{b(!1)}).catch(h=>{console.error("메모 저장 중 오류 발생:",h)})},k=()=>{M(i?.memo||""),b(!0)},R=()=>{L(i?.title||""),v(!0)},P=h=>{L(h.target.value)},D=()=>{r(qt({rootDb:e,userId:n.uid,memoId:s,newTitle:z})).unwrap().then(()=>{v(!1),_.invalidateQueries({queryKey:["twTreeData",e]}),_.invalidateQueries({queryKey:["tabTitle",e,n?.uid,s]})}).catch(h=>{console.error("제목 업데이트 중 오류 발생:",h),v(!1)})},W=h=>{h.key==="Enter"?D():h.key==="Escape"&&v(!1)},$e=()=>{const h=`/${e==="memo"?"m":e}/edit/${s}`;j(h,{state:{fullIndex:F}})},Te=()=>{const h=`/${e==="memo"?"m":e}/util/${s}`;j(h,{state:{fullIndex:F}})},Me=()=>{const h=`/${e==="memo"?"m":e}/insert/${s}`;j(h,{state:{fullIndex:F}})},Le=()=>{d(!0)},Ee=()=>{X.mutate()},ht=()=>{d(!1),Z.mutate()};return u.useEffect(()=>{function h(){const $=i.scrollY?i.scrollY:0;window.scrollTo({top:$})}i&&i.memo!==null&&(h(),i.image&&i.image.map(($,ee)=>$),Ft({title:i.title,description:""}))},[i]),s===""||n===void 0?null:l?t.jsx(ve,{}):i?t.jsxs("div",{className:"MemoDetail py-4 relative rounded-t-lg",children:[t.jsx(O.div,{className:`progress-bar sticky ${N?"top-28":"top-16"} z-10`,style:{scaleX:fe}}),t.jsxs("div",{className:"MemoDetail_body overflow-hidden ",children:[t.jsxs("div",{className:`sticky top-0 z-20 ${p.card} backdrop-blur-sm`,children:[t.jsxs("div",{className:"p-3 sm:p-4",children:[t.jsxs("div",{className:p.between,children:[t.jsxs("p",{className:`${p.truncate} ${p.textXs} ${p.textGray500DarkZinc400}`,children:[t.jsx(we,{to:e==="memo"?"/m":"/hmoe",className:"dark:hover:!text-white hover:!text-gray-900",children:e==="memo"?"MEMO":"HOME"}),i?.path?.map((h,$)=>i.path.length===$+1?` > ${h?.title}`:t.jsxs(J.Fragment,{children:[" "," > ",t.jsx(we,{to:e==="memo"?`/m/${h.id}`:`/home/${h.id}`,className:"dark:hover:!text-white hover:!text-gray-900",children:h?.title})]},$))]}),t.jsx(O.button,{whileTap:{scale:.8},className:`${p.flexShrink0} ${p.roundedFull} p-2 ${p.buttonHoverGrayLight}`,"aria-label":S("bookmark"),onClick:c,children:i?.bookmark==="Y"?t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`${p.h5W5} ${p.textRed500}`,fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}):t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`${p.h5W5} ${p.textGray500}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})})]}),y?t.jsx("input",{type:"text",value:z,onChange:P,onKeyDown:W,onBlur:D,className:`w-full bg-transparent border-b-2 border-blue-500 focus:outline-none 
													${p.heading2XlBoldSm3Xl} ${p.textGray900}`,autoFocus:!0}):t.jsx("div",{onDoubleClick:R,className:`MemoDetail_Title text-left ${p.heading2XlBoldSm3Xl} ${p.textGray900} cursor-pointer`,children:i?.title}),t.jsx("button",{onClick:()=>E(!N),className:`${p.floatingActionButton} absolute top-11 sm:top-14 right-2 sm:right-3`,children:t.jsx(O.div,{animate:{rotate:N?135:0},children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})})]}),t.jsx(O.div,{initial:!1,animate:{height:N?"auto":0,opacity:N?1:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:t.jsx("div",{className:"border-t border-gray-200 bg-gray-50 dark:border-zinc-800 dark:bg-zinc-900/50",children:t.jsx(Ke,{master:n?.uid===be,rootDb:e,onEdit:$e,onUtil:Te,onNewMemo:Me,onDelete:Le,onCopy:e==="memo"?Ee:null})})})]}),i&&i.html==="sheet"&&t.jsx(Pt,{rootDb:e,detailData:i}),t.jsxs("div",{className:`MemoDetail_Content ${i?.memo?.length>0?`${p.card} my-4 p-2 sm:p-4`:"p-1"}`,onDoubleClick:k,children:[w?t.jsxs("div",{className:`${p.card} p-4`,children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Oe,{children:S("input")}),t.jsx("textarea",{className:"w-full min-h-[100px] p-2 border rounded dark:bg-gray-700 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500",value:T,rows:`${T.split(/\r\n|\r|\n/g).length}`,onChange:h=>M(h.target.value),autoFocus:!0})]}),t.jsxs("div",{children:[t.jsx(Oe,{children:S("preview")}),t.jsx("div",{className:"prose dark:prose-invert max-w-none p-2 border rounded min-h-[100px] overflow-y-auto dark:bg-gray-700 dark:border-gray-600",children:t.jsx(Be,{postData:T,highlightWord:""})})]})]}),t.jsxs("div",{className:"mt-2 flex justify-end gap-2",children:[t.jsx(V,{variant:"outlined",color:p.button.indigo,size:"sm",onClick:()=>b(!1),children:S("cancel")}),t.jsx(V,{color:p.button.indigo,onClick:K,children:S("save")})]})]}):i&&i.html!=="sheet"?i?.html==="N"?t.jsx(Be,{postData:i?.memo,highlightWord:a}):i?.html!=="N"&&i?.memo&&t.jsx(Vt,{text:i.memo}):"",t.jsx(It,{imageList:i?.image}),!i&&t.jsx("div",{className:"flex justify-center py-12",children:t.jsx("div",{className:`${p.flexCenter} py-12`})})]})]}),t.jsx(Kt,{rootDb:e,memoId:s,enableEdit:!0}),t.jsx(O.div,{initial:!1,animate:{height:N?"auto":0,opacity:N?1:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:t.jsx("div",{className:`${p.line}`,children:t.jsx(Ke,{master:n?.uid===be,rootDb:e,onEdit:$e,onUtil:Te,onNewMemo:Me,onDelete:Le,onCopy:e==="memo"?Ee:null})})}),t.jsx(ye,{isOpen:m,size:"sm",color:"warning",title:S("delete_confirm_title"),message:S("delete_confirm_message"),onClose:()=>d(!1),onConfirm:ht}),t.jsx(ye,{...g})]}):t.jsx("div",{children:"데이터가 없습니다."})},sa=J.lazy(()=>me(()=>import("./MemoSheetGrid-BV0k7HL7.js"),__vite__mapDeps([0,1,2]))),qe=J.lazy(()=>me(()=>import("./MemoDetailEdit-CrO_Xxbo.js"),__vite__mapDeps([3,1,2,4,5,6,7,8]))),aa=J.lazy(()=>me(()=>import("./MemoDetailUtil-j05COIQW.js"),__vite__mapDeps([9,1,2,6,4,7]))),na=J.lazy(()=>me(()=>import("./index-ChoWCdWa.js").then(e=>e.c0),__vite__mapDeps([1,2]))),ra=({rootDb:e,user:a,memoId:n,isLoading:s,onBookmark:r,handleCloseTab:o})=>{const i=ue();return console.log("MemoRoutes.memoId=",n),t.jsx(u.Suspense,{fallback:t.jsx(ve,{}),children:t.jsx(rt,{children:t.jsxs(Xt,{location:i,children:[t.jsx(q,{path:"todo",element:t.jsx(O.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(na,{})})}),t.jsx(q,{path:"sheet/:sheetId?",element:t.jsx(O.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(sa,{})})}),t.jsx(q,{path:"edit/:memoId",element:t.jsx(O.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(qe,{rootDb:e,isLoading:s})})}),t.jsx(q,{path:"insert/:memoId",element:t.jsx(O.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(qe,{rootDb:e,isLoading:s})})}),t.jsx(q,{path:"util/:memoId",element:t.jsx(O.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:t.jsx(aa,{rootDb:e,isLoading:s})})}),t.jsx(q,{path:":memoId",element:t.jsx(O.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s?t.jsx(ve,{}):t.jsx(ta,{rootDb:e,onBookmark:r,onDeleteTab:()=>{o&&o(null,{id:n})}})})})]},i.pathname)})})},ia=e=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...e,children:t.jsx("path",{fillRule:"evenodd",d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zM6 20V4h7v5h5v11H6zM8 12h3v3H8v-3zm0 4h3v3H8v-3zm4-4h3v3h-3v-3zm0 4h3v3h-3v-3z",clipRule:"evenodd"})}),oa=({tabInfo:e,handleCloseTab:a,isActive:n})=>{const{t:s}=H(),{user:r}=I(),{attributes:o,listeners:i,setNodeRef:l,transform:c,transition:m,isDragging:d}=Qt({id:e.id}),g={transform:Ut.Transform?.toString(c),transition:m,zIndex:d?1:"auto"},{data:f}=tt({queryKey:["tabTitle",e.rootDb,r?.uid,e.id],queryFn:async()=>e.rootDb==="sheet"?await A(`memo_sheet/${r?.uid}/${e.id}/title`):e.rootDb==="memo"?await A(`${e.rootDb}_txt/${r?.uid}/${e.id}/title`):e.rootDb==="home"?await A(`${e.rootDb}_txt/${e.id}/title`):e.title,enabled:!!r&&!!e.id,staleTime:1/0,placeholderData:e.title});return t.jsxs(we,{ref:l,style:g,...o,...i,"data-tab-id":e.id,to:e.path,title:f,end:!0,className:({isActive:x})=>`SortableTab group relative flex flex-shrink-0 items-center pl-3 pr-2 py-1.5 text-sm rounded-t-md transition-colors duration-200 min-w-28 max-w-48 border-b-2
				${x?"bg-gray-200 dark:bg-zinc-700 border-blue-500 text-gray-800 dark:text-gray-100":"border-transparent text-secondary hover:bg-gray-200/70 dark:hover:bg-zinc-700/70"}
				${d?"opacity-50 shadow-lg":""}`,children:[e.rootDb==="memo"?t.jsx(Jt,{className:`w-5 h-5 mr-1 flex-shrink-0 transition-transform duration-200 ${n?"scale-110":""}`,fill:"currentColor"}):e.rootDb==="sheet"?t.jsx(ia,{className:`w-5 h-5 mr-1 flex-shrink-0 transition-transform duration-200 ${n?"scale-110":""}`}):null,t.jsx("span",{className:"truncate pr-1",style:{fontFamily:"sans-serif"},children:f||s("loading")}),t.jsx("button",{onClick:x=>a(x,e),className:`ml-auto flex-shrink-0 p-1 rounded-full transition-opacity duration-200 opacity-0 group-hover:opacity-100
					text-gray-500 dark:text-gray-400 
					hover:bg-gray-300/50 dark:hover:bg-gray-600/50 hover:text-gray-700 dark:hover:text-white
				`,children:t.jsx(it,{className:"w-3 h-3"})})]})};function la(e,a,n){const s=a?.uid,[r,o]=u.useState(()=>{try{const f=localStorage.getItem(`openTabs_${s}`);return f?JSON.parse(f):[]}catch(f){return console.error("Failed to parse openTabs from localStorage",f),[]}}),i=u.useRef(),l=ue(),c=de(),m=u.useCallback(async f=>{if(f&&f!=="insert"&&l.pathname!=="/m"&&l.pathname!=="/home"){const x={id:f,path:l.pathname,icon:null,rootDb:e,title:""};if(l.pathname.startsWith("/m/sheet/")){const w=await A(`memo_sheet/${a?.uid}/${f}/title`);x.title=w}else if(l.pathname.startsWith("/m/")){const w=await A(`memo_txt/${a?.uid}/${f}/title`);x.title=w}else if(l.pathname.startsWith("/home/")){const w=await A(`home_txt/${f}/title`);x.title=w}else f==="sheet"&&(x.title="Main Sheet");!r.some(w=>w.id===x.id)&&i.current!==f?(i.current=f,o(w=>[...w,x])):(i.current="",o(w=>w.map(b=>b.id===x.id?{...b,title:x.title||b.title}:b)))}},[n]);u.useEffect(()=>{n&&m(n)},[n]),u.useEffect(()=>{if(s)try{localStorage.setItem(`openTabs_${s}`,JSON.stringify(r))}catch(f){console.error("Failed to save openTabs to localStorage",f)}},[r,s]);const d=u.useCallback((f,x)=>{f?.preventDefault(),f?.stopPropagation(),i.current="";const w=r.findIndex(T=>T.id===x.id),b=r.filter(T=>T.id!==x.id);if(o(b),l.pathname.includes(x.id)){const T=b.length>0?b[Math.max(0,w-1)].path:`/${e==="memo"||e==="sheet"?"m":e}`;c(T,{relative:"path"})}},[r,l.pathname,e,c]),g=u.useCallback(()=>{i.current="",o([]),c(`/${e==="memo"||e==="sheet"?"m":e}`)},[e,c]);return{openTabs:r,setOpenTabs:o,handleCloseTab:d,handleCloseAllTabs:g}}const ca=({rootDb:e,user:a,activeId:n})=>{const s=u.useRef(null),[r,o]=u.useState({left:!1,right:!1}),[i,l]=u.useState({left:0,width:0}),[c,m]=u.useState(!0),d=u.useRef(0),{openTabs:g,setOpenTabs:f,handleCloseTab:x,handleCloseAllTabs:w}=la(e,a,n),b=u.useCallback(()=>{const y=s.current;if(y){const v=y.scrollWidth>y.clientWidth,z=y.scrollLeft===0,L=y.scrollLeft+y.clientWidth>=y.scrollWidth-1;o(N=>{const E={left:v&&!z,right:v&&!L};return N.left===E.left&&N.right===E.right?N:E})}},[]);u.useEffect(()=>{const y=()=>{const v=window.pageYOffset||document.documentElement.scrollTop;v>d.current?m(!1):m(!0),d.current=v<=0?0:v};return window.addEventListener("scroll",y),()=>{window.removeEventListener("scroll",y)}},[]);const T=y=>{s.current?.scrollBy({left:y==="left"?-200:200,behavior:"smooth"})},M=y=>{const{active:v,over:z}=y;console.log("active=",v,"over=",z),v.id!==z.id&&f(L=>{const N=L.findIndex(S=>S.id===v.id),E=L.findIndex(S=>S.id===z.id);return ss(L,N,E)})};return u.useEffect(()=>{b();const y=s.current;return y?.addEventListener("scroll",b),window.addEventListener("resize",b),()=>{y?.removeEventListener("scroll",b),window.removeEventListener("resize",b)}},[g,b]),u.useEffect(()=>{const y=setTimeout(()=>{const v=s.current?.querySelector(`[data-tab-id="${n}"]`);if(v){const{offsetLeft:z,offsetWidth:L}=v;l({left:z,width:L})}},0);return()=>clearTimeout(y)},[n,g]),t.jsx("div",{className:`MemoTabs sticky ${c?"top-18":"top-1"} z-1000 rounded-t-md bg-gray-50/70 dark:bg-zinc-800/70 backdrop-blur-sm shadow-sm`,children:t.jsxs("div",{className:"relative flex items-center justify-between ",children:[r.left&&t.jsx("button",{onClick:()=>T("left"),className:"absolute left-0 z-10 p-1 border border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 bg-white dark:bg-zinc-900 dark:hover:!text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full group",children:t.jsx(ns,{className:"w-5 h-5 fill-current"})}),t.jsx(Zt,{id:"memo-tabs",onDragEnd:M,children:t.jsx("div",{ref:s,className:"MemoTabs relative flex items-center overflow-x-scroll scrollbar-hide whitespace-nowrap",children:t.jsx(es,{items:g.map(y=>y.id),strategy:ts,children:t.jsx(rt,{children:g.map(y=>t.jsx(O.div,{layout:!0,initial:{opacity:0,scale:.8},transition:{type:"spring",stiffness:350,damping:30},animate:{opacity:1,scale:1},exit:{opacity:0,width:0,paddingLeft:0,paddingRight:0,transition:{duration:.3}},children:t.jsx(oa,{tabInfo:y,handleCloseTab:x,isActive:y.id===n})},y.id))})})})}),t.jsxs("div",{className:"flex items-center",children:[r.right&&t.jsx("button",{onClick:()=>T("right"),className:"z-10 p-1 border border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 bg-white dark:bg-zinc-900 dark:hover:!text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full group",children:t.jsx(rs,{className:"w-5 h-5 fill-current"})}),g.length>0&&t.jsx("button",{onClick:w,className:"ml-2 mr-2 p-1.5 text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md",title:"Close all tabs",children:t.jsx(it,{className:"w-4 h-4"})})]})]})})},da=()=>{const e=de(),{user:a}=I(),n=re(as),s=ue(),{rootDb:r,memoId:o}=u.useMemo(()=>{const c=s.pathname,m=c.startsWith("/m/sheet")?"sheet":c.startsWith("/m")?"memo":c.startsWith("/home")?"home":c.startsWith("/bible")?"bible":"default",d=c.split("/").pop()||"";return{rootDb:m,memoId:d}},[s.pathname]),i=s?.state?.reflash===!0,l=Se();return u.useEffect(()=>{a?.uid&&i&&l.invalidateQueries({queryKey:["memoDetail",r,a?.uid,o]})},[i,s.pathname,l,r,a?.uid,o]),u.useEffect(()=>{a===null&&s.pathname!=="/m"&&e("/m")},[a]),t.jsxs(t.Fragment,{children:[n&&t.jsx(ca,{rootDb:r,user:a,activeId:o}),t.jsx(ra,{rootDb:r,user:a,memoId:o}),s.pathname==="/m"&&t.jsx(Js,{rootDb:r}),(r==="memo"||r==="sheet")&&t.jsx(Us,{}),(s.pathname==="/m"||s.pathname==="/home")&&a?.uid===be&&t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-5",children:[t.jsx(Xs,{}),t.jsx(Gs,{rootDb:r})]})]})},xa=Object.freeze(Object.defineProperty({__proto__:null,default:da},Symbol.toStringTag,{value:"Module"}));export{xa as M,As as a,ea as b,ga as c,fa as f,ha as s,Rs as u};
