import{j as t,m as F,r as m,Q as G,R as H,E as M,z as P,aH as J,G as W,al as Y,i as j,W as q,aJ as C,X as z,K as p,a7 as K,aI as Q,k as U}from"./index-EsjifOpZ.js";import{F as V}from"./Favorite-B0q8qtRd.js";import{u as X,B as O}from"./BibleBookmarkText-CetTiyAj.js";import{b as Z}from"./bibleJson-DmvV-gyR.js";import{b as D}from"./bibleTxt-CDg_iih8.js";import{G as u}from"./Grid-Dj9cjDaU.js";import"./useQuery-nyz_Q4M-.js";import"./useBaseQuery-BSBzVg_c.js";function y({children:e,type:l}){switch(l){case"rotate":return t.jsx(F.div,{initial:{scale:0},animate:{rotate:180,scale:1},transition:{type:"spring",stiffness:260,damping:20,duration:2},children:e});case"slide":case"scale":default:return t.jsx(F.div,{whileHover:{scale:1},whileTap:{scale:.9},children:e})}}y.defaultProps={type:"scale"};const tt=e=>{const l=new Array;if(e.data===void 0||e.data===null)return;const x=e.bibleId.split("_");for(let n=1;n<=e.data.cd3;n++){const c={nm:`${e.data.nm2}${n}장`,key:e.data.key};l.push(c)}return x&&x.length===3?t.jsxs(p,{variant:"h6",sx:{display:"flex",alignItems:"center",flexDirection:"column",mb:4},children:[e.nm," ",x[2]," 장"]}):t.jsxs(t.Fragment,{children:[t.jsx(p,{variant:"h6",sx:{display:"flex",alignItems:"center",flexDirection:"column",mb:4},children:e.nm}),t.jsx(u,{container:!0,spacing:2,columns:{xs:4,sm:6,md:10,lg:12},children:l.map((n,c)=>t.jsx(u,{item:!0,xs:1,md:1,children:t.jsx(K,{to:`/bible/${n.key}_${c+1}`,children:n.nm})},c))})]})},et=e=>{const l=e.dataText;if(e.data===void 0||e.data===null||l==null)return;const x=e.bibleId.split("_");return e.bibleId&&x.length!==3?t.jsx(t.Fragment,{}):t.jsxs(t.Fragment,{children:[t.jsx(p,{variant:"h6",sx:{display:"flex",alignItems:"center",flexDirection:"column",mb:4},children:e.nm}),l.map((n,c)=>{let f="text.primary";e.cd4+""===n.cd4&&(f="warning.main");const r=e.bookmark?.data?.filter(s=>s.cd1===n.cd1&&s.cd2===n.cd2&&s.cd3===n.cd3&&s.cd4===n.cd4&&s.bookmark==="Y");return r&&r.length>0&&(n.bookmark="Y"),t.jsxs(u,{container:!0,spacing:2,columns:{xs:5,sm:6,md:10,lg:12},id:`id_${c+1}`,children:[t.jsx(u,{item:!0,xs:1,md:1,children:t.jsxs(j,{sx:{color:f,display:"flex"},children:[t.jsx(Q,{sx:{alignItems:"center",textAlign:"top"},onClick:()=>e.onBookmark(n),children:n.nm}),r&&r.length>0&&t.jsx(V,{sx:{color:"red"}})]})}),t.jsx(u,{item:!0,xs:4,sm:5,md:9,lg:11,children:t.jsx(j,{sx:{color:f},children:t.jsx(U,{text:n.text})})})]},c)})]})},dt=()=>{const[e,l]=m.useState(null),[x,n]=m.useState(!0),{query:c,setBibleBookmark:f}=X(),r=m.useRef(),{bibleId:s}=G(),B=H(),[T,I]=m.useState(!1),[_,$]=m.useState(!1),{user:E}=M(),g=B?.state?.word,b=B?.state?.cd4,A=P();m.useEffect(()=>{if(s!==void 0){(async()=>{const a=await S(s,g);l(a),n(!1)})(),I(!1),$(!0);const i=s.split("_");if(i.length===3){const a=r.current.cd3;I(Number(i[2])!==1),$(i[2]<a)}}},[s,g]),m.useEffect(()=>{b!==void 0&&setTimeout(()=>{N("","id_"+b)},1500)},[e,b]);const N=(o,i)=>{const a=document.getElementById(i);a&&a.scrollIntoView({block:"center",behavior:"smooth"})},R=o=>{E!==void 0&&f(o)},S=async(o,i)=>{if(o===""||o===void 0)return"";const a=o.split("_");if(a.length<1)return;r.current=Z[a[0]][a[1]];const k=new Array;if(a.length===3){for(let h in D){if(!h.includes(o+"_"))continue;let d=D[h];d.id=h;let v=d.txt;if(i!==void 0){const L=new RegExp(i,"gi");v=v.replace(L,`<span class='lightext'>${i}</span>`)}d.nm=`${r.current.nm2}${a[2]}:${d.cd4}`,d.text=v,k.push(d)}return k.sort((h,d)=>h.cd4-d.cd4),k}};if(s==="")return t.jsx(t.Fragment,{});const w=o=>{let i=s.split("_");i[2]=Number(i[2])+o,A(`/bible/${i[0]}_${i[1]}_${i[2]}`)};return t.jsxs(J.Fragment,{children:[t.jsx("div",{id:"back-to-top-anchor"}),t.jsx(O,{}),t.jsx(W,{children:r.current!==null&&r.current!==void 0&&r.current.nm!==null?r.current.nm:""}),t.jsx(tt,{data:r.current,bibleId:s}),t.jsx(et,{dataText:e,data:r.current,searchWord:g,bibleId:s,cd4:b,bookmark:c,onBookmark:R}),t.jsxs(Y,{sx:{p:0},children:[x&&t.jsx(j,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:t.jsx(q,{sx:{mt:5}})}),s&&s.split("_").length===3?t.jsx(j,{sx:{display:"flex",justifyContent:"space-between",mt:5},children:t.jsxs(u,{container:!0,spacing:1,children:[T?t.jsx(u,{item:!0,xs:_?6:12,children:t.jsx(y,{children:t.jsx(C,{type:"button",variant:"outlined",onClick:()=>w(-1),fullWidth:!0,children:"< 이전"})})}):"",_?t.jsx(u,{item:!0,xs:T?6:12,children:t.jsx(y,{children:t.jsx(C,{type:"button",variant:"outlined",onClick:()=>w(1),fullWidth:!0,children:"다음 >"})})}):""]})}):""]}),t.jsx(z,{})]})};export{dt as BibleDetail,dt as default};
