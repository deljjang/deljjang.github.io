import{G as W,e as v,r as a,w as R,cf as y,j as t,n as L,v as p,k as S,s as B}from"./index-Dlo5qAfl.js";import{T as j,a as E,b as F,c as I,d as N}from"./TwMemoMain-CtGz23_3.js";import{f as $}from"./fireMemoDetail-DupTvcft.js";import{g as U,H as q}from"./HomeChartForm-D2xM7G9T.js";import{g as C}from"./memoFun-DpPhML4t.js";import"./TwTitleItem-BNWZ9GOM.js";import"./SinyImageList-nRMRVb2p.js";import"./ImageListItem-CwrH3-4m.js";import"./HtmlCode-rMC-Snn1.js";/* empty css                 */import"./copy-L5q-H5_2.js";import"./TwBadge-ebvrhaJy.js";import"./ComponentCard-D48S9Twc.js";import"./TwRadio-DOQD7TFc.js";import"./toPropertyKey-DCwh5dYN.js";import"./CodeText-CcKt_NMF.js";import"./commonUtil-D6sNiGcV.js";import"./useWindowDimensions-DIlp-qYM.js";import"./datetime-BDx6lZXm.js";import"./index.esm-CVkuEgIk.js";import"./TwCheckbox-Dlrwv6U0.js";import"./TwTextArea-DaBplPdm.js";import"./SinyDate-B2UnZu6-.js";import"./Grid-BZTQCb5O.js";import"./index-CTtl7xg0.js";import"./TextField-BJwzc22I.js";import"./InputAdornment-BKz_AKED.js";import"./Popper-BgVt-nsZ.js";import"./Button-FMDonRCy.js";import"./Chip-BYp4Kq0g.js";import"./TwSelect-B--Vprlm.js";import"./TwDatePicker-2DZhglEn.js";import"./IpInfo-BISogSUG.js";import"./HomeChartSemiDonut-C-TMZc-Z.js";const Tt=({setSideContents:H,setSideType:K})=>{const D=W(),{user:r}=v(),s=a.useRef(),n=a.useRef(!0),d=a.useRef(),[m,f]=a.useState(),h=a.useRef(!1),c=R(),e=c.pathname.startsWith("/m")?"memo":c.pathname.startsWith("/home")?"home":c.pathname.startsWith("/bible")?"bible":"default",k=a.useRef(!1);k.current=c?.state?.reflash===!0;const i=y({queryKey:["twTreeData",r?.uid,s.current],queryFn:()=>U(e,r?.uid,s.current)});i.data!==void 0&&i.data!==""&&!h.current&&(h.current=!0);const b=()=>{const o=m;o&&(o.bookmark=o.bookmark==="Y"?"N":"Y"),console.log("onBookmark.memoDetailData.bookmark=",o.bookmark),console.log("onBookmark.rootDb=",e);const u=e==="memo"?`memo_tree/${r.uid}/${d.current}/bm`:`home_txt/${d.current}/bookmark`;B(u,m.bookmark),f({...m,bookmark:o.bookmark})};a.useEffect(()=>{r!==void 0&&r!=null&&i.refetch()},[r]),a.useEffect(()=>{const o=async x=>{if(x!==""&&r){const l=await $(e,r?.uid,x,s.current);e==="memo"&&(l.path=C(i.data,x)),l.code==="404"&&(l.title="No title"),n.current=!1,f(l===void 0?{}:l)}else f({})},u=c.pathname.split("/"),g=u.length>2?u[u.length-1]:"";n.current=!0,d.current=g,o(g)},[c.pathname,r,k.current]),a.useEffect(()=>{r!==void 0&&r!=null&&i.refetch()},[k.current]);const T=o=>{h.current=!1,o!==void 0&&(s.current=o),i.refetch()},w=()=>{if(r==null){alert("로그인 후 이용 가능합니다.");return}const o=`/${e==="memo"?"m":e}/insert/insert`;D(o)},M=o=>{};return t.jsxs(t.Fragment,{children:[t.jsx(a.Suspense,{fallback:t.jsx(S,{}),children:t.jsxs(L,{children:[t.jsx(p,{path:"/edit/:memoId",element:t.jsx(j,{rootDb:e,isLoading:n.current,searchWord:s.current,memoDetailData:m})}),t.jsx(p,{path:"/insert/:memoId",element:t.jsx(j,{rootDb:e,isLoading:n.current,searchWord:s.current,memoDetailData:m})}),t.jsx(p,{path:"/util/:memoId",element:t.jsx(E,{rootDb:e,isLoading:n.current,searchWord:s.current,memoDetailData:m})}),t.jsx(p,{path:"/:memoId",element:t.jsx(F,{rootDb:e,isLoading:n.current,searchWord:s.current,memoDetailData:m,onTreeUpdate:T,onBookmark:b,data:i.data})}),t.jsx(p,{path:"*",element:t.jsx(I,{searchWord:s.current,data:i.data,onNewMemoBtn:w,title:e==="memo"?"메모장":"홈페이지관리",rootDb:e})})]})}),e==="memo"?t.jsx(N,{onSelected:M}):null,d.current===""?t.jsx(q,{data:i.data}):null]})};export{Tt as default};
