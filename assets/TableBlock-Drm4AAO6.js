import{j as e}from"./index-DvCfMAy7.js";import{r as N}from"./router-v4BRDFYV.js";import"./vendor-CCYiWZgt.js";const L=({id:r,block:o,onUpdateBlock:i,onDelete:x})=>{const m=N.useRef(null),f=(n,t,s)=>{const a={...o.content};a.rows[t][s].text=n.currentTarget.innerHTML,i(r,{content:a})},v=()=>{const n={...o.content},t=n.rows[0]?.length||1;n.rows.push(Array(t).fill({text:""})),i(r,{content:n})},g=n=>{if(o.content.rows.length<=1)return;const t={...o.content};t.rows.splice(n,1),i(r,{content:t})},y=()=>{const n={...o.content};n.rows.forEach(t=>t.push({text:""})),i(r,{content:n})},b=n=>{if(o.content.rows[0]?.length<=1)return;const t={...o.content};t.rows.forEach(s=>s.splice(n,1)),i(r,{content:t})},j=n=>{n.preventDefault(),n.stopPropagation();const t=n.clientX,s=m.current;if(!s)return;const a=s.offsetWidth,l=d=>{const u=a+(d.clientX-t);s.style.width=`${u}px`},c=()=>{document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",c),i&&s&&i(r,{width:s.offsetWidth})};document.addEventListener("mousemove",l),document.addEventListener("mouseup",c)},C=(n,t)=>{n.preventDefault(),n.stopPropagation();const s=n.clientX,l=n.currentTarget.parentElement.offsetWidth,c=u=>{const p=l+(u.clientX-s);if(p>30){const h=m.current.querySelector("table");if(h){const w=h.querySelector("colgroup");w&&w.children[t]&&(w.children[t].style.width=`${p}px`)}}},d=u=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",d);const p=l+(u.clientX-s),h=[...o.content.colWidths||[]];h[t]=Math.max(p,30),i(r,{content:{...o.content,colWidths:h}})};document.addEventListener("mousemove",c),document.addEventListener("mouseup",d)};return e.jsxs("div",{className:"flex items-start group relative w-full",children:[e.jsxs("button",{onClick:v,className:"absolute -bottom-2.5 left-1/2 -translate-x-1/2 w-full h-5 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity z-10",children:[e.jsx("div",{className:"w-6 h-px bg-blue-500"}),e.jsx("div",{className:"absolute w-5 h-5 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs",children:"＋"})]}),e.jsxs("div",{ref:m,className:"relative w-full",style:{width:o.width?`${o.width}px`:"100%"},children:[e.jsxs("button",{onClick:y,className:"absolute top-1/2 -right-2.5 -translate-y-1/2 h-full w-5 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity z-10",children:[e.jsx("div",{className:"h-6 w-px bg-blue-500"}),e.jsx("div",{className:"absolute w-5 h-5 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs",children:"＋"})]}),e.jsxs("table",{className:"w-full border-collapse border border-gray-300 dark:border-zinc-600 table-fixed",children:[e.jsx("colgroup",{children:o.content.rows[0]?.map((n,t)=>e.jsx("col",{style:{width:o.content.colWidths?.[t]?`${o.content.colWidths[t]}px`:"auto"}},t))}),e.jsx("thead",{children:e.jsx("tr",{children:o.content.rows[0]?.map((n,t)=>e.jsxs("th",{className:"relative border-none p-0 h-4 group/col",children:[e.jsx("button",{onClick:()=>b(t),className:"absolute -top-2.5 left-1/2 -translate-x-1/2 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs opacity-0 group-hover/col:opacity-100 transition-opacity z-10",children:"－"}),e.jsx("div",{onMouseDown:s=>C(s,t),className:"absolute top-0 right-0 h-full w-1.5 cursor-col-resize opacity-0 group-hover/col:opacity-100",children:e.jsx("div",{className:"h-full w-px bg-blue-500"})})]},t))})}),e.jsx("tbody",{children:o.content.rows.map((n,t)=>e.jsxs("tr",{className:"relative group/row",children:[e.jsx("button",{onClick:()=>g(t),className:"absolute -left-2.5 top-1/2 -translate-y-1/2 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs opacity-0 group-hover/row:opacity-100 transition-opacity z-10",children:"－"}),n.map((s,a)=>e.jsx("td",{contentEditable:!0,suppressContentEditableWarning:!0,onBlur:l=>f(l,t,a),className:"border border-gray-300 dark:border-zinc-600 p-2 focus:outline-blue-500 overflow-hidden whitespace-nowrap",dangerouslySetInnerHTML:{__html:s.text}},a))]},t))})]}),e.jsx("div",{onMouseDown:j,className:"absolute bottom-0 right-0 w-4 h-4 bg-blue-500 cursor-se-resize opacity-0 group-hover:opacity-100 transition-opacity"})]}),e.jsx("button",{onClick:()=>x(r),className:"p-1 text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity absolute -top-2 -right-2 bg-white dark:bg-zinc-800 rounded-full","aria-label":"Delete block",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",children:[e.jsx("path",{d:"M3 6h18"}),e.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})};export{L as TableBlock};
