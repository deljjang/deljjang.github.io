import{bi as JT,r as Me,R as dn,aP as h1}from"./index-Dlo5qAfl.js";var e_={},lc,t_;function Gt(){if(t_)return lc;t_=1;var t=function(e){return e&&e.Math===Math&&e};return lc=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof JT=="object"&&JT)||t(typeof lc=="object"&&lc)||function(){return this}()||Function("return this")(),lc}var Wp={},Bp,n_;function nn(){return n_||(n_=1,Bp=function(t){try{return!!t()}catch{return!0}}),Bp}var jp,r_;function Qr(){if(r_)return jp;r_=1;var t=nn();return jp=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),jp}var Up,i_;function Vm(){if(i_)return Up;i_=1;var t=nn();return Up=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),Up}var zp,o_;function rn(){if(o_)return zp;o_=1;var t=Vm(),e=Function.prototype.call;return zp=t?e.bind(e):function(){return e.apply(e,arguments)},zp}var Yp={},s_;function lF(){if(s_)return Yp;s_=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return Yp.f=n?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,Yp}var Gp,a_;function Wm(){return a_||(a_=1,Gp=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),Gp}var qp,l_;function qt(){if(l_)return qp;l_=1;var t=Vm(),e=Function.prototype,n=e.call,r=t&&e.bind.bind(n,n);return qp=t?r:function(i){return function(){return n.apply(i,arguments)}},qp}var Kp,u_;function gl(){if(u_)return Kp;u_=1;var t=qt(),e=t({}.toString),n=t("".slice);return Kp=function(r){return n(e(r),8,-1)},Kp}var Xp,c_;function uF(){if(c_)return Xp;c_=1;var t=qt(),e=nn(),n=gl(),r=Object,i=t("".split);return Xp=e(function(){return!r("z").propertyIsEnumerable(0)})?function(o){return n(o)==="String"?i(o,""):r(o)}:r,Xp}var Zp,h_;function Jb(){return h_||(h_=1,Zp=function(t){return t==null}),Zp}var Qp,d_;function ld(){if(d_)return Qp;d_=1;var t=Jb(),e=TypeError;return Qp=function(n){if(t(n))throw new e("Can't call method on "+n);return n},Qp}var Jp,f_;function ud(){if(f_)return Jp;f_=1;var t=uF(),e=ld();return Jp=function(n){return t(e(n))},Jp}var ew,g_;function on(){if(g_)return ew;g_=1;var t=typeof document=="object"&&document.all;return ew=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},ew}var tw,m_;function Jr(){if(m_)return tw;m_=1;var t=on();return tw=function(e){return typeof e=="object"?e!==null:t(e)},tw}var nw,p_;function Uu(){if(p_)return nw;p_=1;var t=Gt(),e=on(),n=function(r){return e(r)?r:void 0};return nw=function(r,i){return arguments.length<2?n(t[r]):t[r]&&t[r][i]},nw}var rw,w_;function cd(){if(w_)return rw;w_=1;var t=qt();return rw=t({}.isPrototypeOf),rw}var iw,v_;function Bm(){if(v_)return iw;v_=1;var t=Gt(),e=t.navigator,n=e&&e.userAgent;return iw=n?String(n):"",iw}var ow,C_;function cF(){if(C_)return ow;C_=1;var t=Gt(),e=Bm(),n=t.process,r=t.Deno,i=n&&n.versions||r&&r.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),ow=a,ow}var sw,y_;function eR(){if(y_)return sw;y_=1;var t=cF(),e=nn(),n=Gt(),r=n.String;return sw=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),sw}var aw,S_;function d1(){if(S_)return aw;S_=1;var t=eR();return aw=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",aw}var lw,b_;function tR(){if(b_)return lw;b_=1;var t=Uu(),e=on(),n=cd(),r=d1(),i=Object;return lw=r?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&n(s.prototype,i(o))},lw}var uw,R_;function jm(){if(R_)return uw;R_=1;var t=String;return uw=function(e){try{return t(e)}catch{return"Object"}},uw}var cw,E_;function gr(){if(E_)return cw;E_=1;var t=on(),e=jm(),n=TypeError;return cw=function(r){if(t(r))return r;throw new n(e(r)+" is not a function")},cw}var hw,T_;function hd(){if(T_)return hw;T_=1;var t=gr(),e=Jb();return hw=function(n,r){var i=n[r];return e(i)?void 0:t(i)},hw}var dw,__;function hF(){if(__)return dw;__=1;var t=rn(),e=on(),n=Jr(),r=TypeError;return dw=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!n(a=t(s,i))||e(s=i.valueOf)&&!n(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!n(a=t(s,i)))return a;throw new r("Can't convert object to primitive value")},dw}var fw={exports:{}},gw,M_;function Xs(){return M_||(M_=1,gw=!1),gw}var mw,I_;function nR(){if(I_)return mw;I_=1;var t=Gt(),e=Object.defineProperty;return mw=function(n,r){try{e(t,n,{value:r,configurable:!0,writable:!0})}catch{t[n]=r}return r},mw}var P_;function rR(){if(P_)return fw.exports;P_=1;var t=Xs(),e=Gt(),n=nR(),r="__core-js_shared__",i=fw.exports=e[r]||n(r,{});return(i.versions||(i.versions=[])).push({version:"3.44.0",mode:t?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.44.0/LICENSE",source:"https://github.com/zloirock/core-js"}),fw.exports}var pw,O_;function f1(){if(O_)return pw;O_=1;var t=rR();return pw=function(e,n){return t[e]||(t[e]=n||{})},pw}var ww,x_;function zu(){if(x_)return ww;x_=1;var t=ld(),e=Object;return ww=function(n){return e(t(n))},ww}var vw,H_;function ei(){if(H_)return vw;H_=1;var t=qt(),e=zu(),n=t({}.hasOwnProperty);return vw=Object.hasOwn||function(i,o){return n(e(i),o)},vw}var Cw,A_;function g1(){if(A_)return Cw;A_=1;var t=qt(),e=0,n=Math.random(),r=t(1.1.toString);return Cw=function(i){return"Symbol("+(i===void 0?"":i)+")_"+r(++e+n,36)},Cw}var yw,N_;function Oi(){if(N_)return yw;N_=1;var t=Gt(),e=f1(),n=ei(),r=g1(),i=eR(),o=d1(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||r;return yw=function(u){return n(a,u)||(a[u]=i&&n(s,u)?s[u]:l("Symbol."+u)),a[u]},yw}var Sw,D_;function dF(){if(D_)return Sw;D_=1;var t=rn(),e=Jr(),n=tR(),r=hd(),i=hF(),o=Oi(),s=TypeError,a=o("toPrimitive");return Sw=function(l,u){if(!e(l)||n(l))return l;var c=r(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||n(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},Sw}var bw,k_;function m1(){if(k_)return bw;k_=1;var t=dF(),e=tR();return bw=function(n){var r=t(n,"string");return e(r)?r:r+""},bw}var Rw,L_;function iR(){if(L_)return Rw;L_=1;var t=Gt(),e=Jr(),n=t.document,r=e(n)&&e(n.createElement);return Rw=function(i){return r?n.createElement(i):{}},Rw}var Ew,$_;function p1(){if($_)return Ew;$_=1;var t=Qr(),e=nn(),n=iR();return Ew=!t&&!e(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),Ew}var F_;function w1(){if(F_)return Wp;F_=1;var t=Qr(),e=rn(),n=lF(),r=Wm(),i=ud(),o=m1(),s=ei(),a=p1(),l=Object.getOwnPropertyDescriptor;return Wp.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return r(!e(n.f,c,h),c[h])},Wp}var Tw={},_w,V_;function v1(){if(V_)return _w;V_=1;var t=Qr(),e=nn();return _w=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),_w}var Mw,W_;function sn(){if(W_)return Mw;W_=1;var t=Jr(),e=String,n=TypeError;return Mw=function(r){if(t(r))return r;throw new n(e(r)+" is not an object")},Mw}var B_;function Zs(){if(B_)return Tw;B_=1;var t=Qr(),e=p1(),n=v1(),r=sn(),i=m1(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return Tw.f=t?n?function(d,f,m){if(r(d),f=i(f),r(m),typeof d=="function"&&f==="prototype"&&"value"in m&&c in m&&!m[c]){var v=a(d,f);v&&v[c]&&(d[f]=m.value,m={configurable:u in m?m[u]:v[u],enumerable:l in m?m[l]:v[l],writable:!1})}return s(d,f,m)}:s:function(d,f,m){if(r(d),f=i(f),r(m),e)try{return s(d,f,m)}catch{}if("get"in m||"set"in m)throw new o("Accessors not supported");return"value"in m&&(d[f]=m.value),d},Tw}var Iw,j_;function Yu(){if(j_)return Iw;j_=1;var t=Qr(),e=Zs(),n=Wm();return Iw=t?function(r,i,o){return e.f(r,i,n(1,o))}:function(r,i,o){return r[i]=o,r},Iw}var Pw={exports:{}},Ow,U_;function fF(){if(U_)return Ow;U_=1;var t=Qr(),e=ei(),n=Function.prototype,r=t&&Object.getOwnPropertyDescriptor,i=e(n,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&r(n,"name").configurable);return Ow={EXISTS:i,PROPER:o,CONFIGURABLE:s},Ow}var xw,z_;function gF(){if(z_)return xw;z_=1;var t=qt(),e=on(),n=rR(),r=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(i){return r(i)}),xw=n.inspectSource,xw}var Hw,Y_;function mF(){if(Y_)return Hw;Y_=1;var t=Gt(),e=on(),n=t.WeakMap;return Hw=e(n)&&/native code/.test(String(n)),Hw}var Aw,G_;function oR(){if(G_)return Aw;G_=1;var t=f1(),e=g1(),n=t("keys");return Aw=function(r){return n[r]||(n[r]=e(r))},Aw}var Nw,q_;function sR(){return q_||(q_=1,Nw={}),Nw}var Dw,K_;function C1(){if(K_)return Dw;K_=1;var t=mF(),e=Gt(),n=Jr(),r=Yu(),i=ei(),o=rR(),s=oR(),a=sR(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,f,m=function(w){return f(w)?d(w):h(w,{})},v=function(w){return function(_){var O;if(!n(_)||(O=d(_)).type!==w)throw new u("Incompatible receiver, "+w+" required");return O}};if(t||o.state){var S=o.state||(o.state=new c);S.get=S.get,S.has=S.has,S.set=S.set,h=function(w,_){if(S.has(w))throw new u(l);return _.facade=w,S.set(w,_),_},d=function(w){return S.get(w)||{}},f=function(w){return S.has(w)}}else{var R=s("state");a[R]=!0,h=function(w,_){if(i(w,R))throw new u(l);return _.facade=w,r(w,R,_),_},d=function(w){return i(w,R)?w[R]:{}},f=function(w){return i(w,R)}}return Dw={set:h,get:d,has:f,enforce:m,getterFor:v},Dw}var X_;function y1(){if(X_)return Pw.exports;X_=1;var t=qt(),e=nn(),n=on(),r=ei(),i=Qr(),o=fF().CONFIGURABLE,s=gF(),a=C1(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),f=t("".replace),m=t([].join),v=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),S=String(String).split("String"),R=Pw.exports=function(w,_,O){d(c(_),0,7)==="Symbol("&&(_="["+f(c(_),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),O&&O.getter&&(_="get "+_),O&&O.setter&&(_="set "+_),(!r(w,"name")||o&&w.name!==_)&&(i?h(w,"name",{value:_,configurable:!0}):w.name=_),v&&O&&r(O,"arity")&&w.length!==O.arity&&h(w,"length",{value:O.arity});try{O&&r(O,"constructor")&&O.constructor?i&&h(w,"prototype",{writable:!1}):w.prototype&&(w.prototype=void 0)}catch{}var L=l(w);return r(L,"source")||(L.source=m(S,typeof _=="string"?_:"")),w};return Function.prototype.toString=R(function(){return n(this)&&u(this).source||s(this)},"toString"),Pw.exports}var kw,Z_;function aR(){if(Z_)return kw;Z_=1;var t=on(),e=Zs(),n=y1(),r=nR();return kw=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&n(s,u,a),a.global)l?i[o]=s:r(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},kw}var Lw={},$w,Q_;function pF(){if(Q_)return $w;Q_=1;var t=Math.ceil,e=Math.floor;return $w=Math.trunc||function(r){var i=+r;return(i>0?e:t)(i)},$w}var Fw,J_;function dd(){if(J_)return Fw;J_=1;var t=pF();return Fw=function(e){var n=+e;return n!==n||n===0?0:t(n)},Fw}var Vw,eM;function wF(){if(eM)return Vw;eM=1;var t=dd(),e=Math.max,n=Math.min;return Vw=function(r,i){var o=t(r);return o<0?e(o+i,0):n(o,i)},Vw}var Ww,tM;function vF(){if(tM)return Ww;tM=1;var t=dd(),e=Math.min;return Ww=function(n){var r=t(n);return r>0?e(r,9007199254740991):0},Ww}var Bw,nM;function Gu(){if(nM)return Bw;nM=1;var t=vF();return Bw=function(e){return t(e.length)},Bw}var jw,rM;function CF(){if(rM)return jw;rM=1;var t=ud(),e=wF(),n=Gu(),r=function(i){return function(o,s,a){var l=t(o),u=n(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return jw={includes:r(!0),indexOf:r(!1)},jw}var Uw,iM;function S1(){if(iM)return Uw;iM=1;var t=qt(),e=ei(),n=ud(),r=CF().indexOf,i=sR(),o=t([].push);return Uw=function(s,a){var l=n(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~r(c,h)||o(c,h));return c},Uw}var zw,oM;function lR(){return oM||(oM=1,zw=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),zw}var sM;function yF(){if(sM)return Lw;sM=1;var t=S1(),e=lR(),n=e.concat("length","prototype");return Lw.f=Object.getOwnPropertyNames||function(i){return t(i,n)},Lw}var Yw={},aM;function SF(){return aM||(aM=1,Yw.f=Object.getOwnPropertySymbols),Yw}var Gw,lM;function bF(){if(lM)return Gw;lM=1;var t=Uu(),e=qt(),n=yF(),r=SF(),i=sn(),o=e([].concat);return Gw=t("Reflect","ownKeys")||function(a){var l=n.f(i(a)),u=r.f;return u?o(l,u(a)):l},Gw}var qw,uM;function b1(){if(uM)return qw;uM=1;var t=ei(),e=bF(),n=w1(),r=Zs();return qw=function(i,o,s){for(var a=e(o),l=r.f,u=n.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},qw}var Kw,cM;function RF(){if(cM)return Kw;cM=1;var t=nn(),e=on(),n=/#|\.prototype\./,r=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=r.normalize=function(l){return String(l).replace(n,".").toLowerCase()},o=r.data={},s=r.NATIVE="N",a=r.POLYFILL="P";return Kw=r,Kw}var Xw,hM;function gt(){if(hM)return Xw;hM=1;var t=Gt(),e=w1().f,n=Yu(),r=aR(),i=nR(),o=b1(),s=RF();return Xw=function(a,l){var u=a.target,c=a.global,h=a.stat,d,f,m,v,S,R;if(c?f=t:h?f=t[u]||i(u,{}):f=t[u]&&t[u].prototype,f)for(m in l){if(S=l[m],a.dontCallGetSet?(R=e(f,m),v=R&&R.value):v=f[m],d=s(c?m:u+(h?".":"#")+m,a.forced),!d&&v!==void 0){if(typeof S==typeof v)continue;o(S,v)}(a.sham||v&&v.sham)&&n(S,"sham",!0),r(f,m,S,a)}},Xw}var Zw,dM;function fd(){if(dM)return Zw;dM=1;var t=Vm(),e=Function.prototype,n=e.apply,r=e.call;return Zw=typeof Reflect=="object"&&Reflect.apply||(t?r.bind(n):function(){return r.apply(n,arguments)}),Zw}var Qw,fM;function R1(){if(fM)return Qw;fM=1;var t=qt(),e=gr();return Qw=function(n,r,i){try{return t(e(Object.getOwnPropertyDescriptor(n,r)[i]))}catch{}},Qw}var Jw,gM;function EF(){if(gM)return Jw;gM=1;var t=Jr();return Jw=function(e){return t(e)||e===null},Jw}var ev,mM;function TF(){if(mM)return ev;mM=1;var t=EF(),e=String,n=TypeError;return ev=function(r){if(t(r))return r;throw new n("Can't set "+e(r)+" as a prototype")},ev}var tv,pM;function E1(){if(pM)return tv;pM=1;var t=R1(),e=Jr(),n=ld(),r=TF();return tv=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return n(l),r(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),tv}var nv,wM;function _F(){if(wM)return nv;wM=1;var t=Zs().f;return nv=function(e,n,r){r in e||t(e,r,{configurable:!0,get:function(){return n[r]},set:function(i){n[r]=i}})},nv}var rv,vM;function MF(){if(vM)return rv;vM=1;var t=on(),e=Jr(),n=E1();return rv=function(r,i,o){var s,a;return n&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&n(r,a),r},rv}var iv,CM;function IF(){if(CM)return iv;CM=1;var t=Oi(),e=t("toStringTag"),n={};return n[e]="z",iv=String(n)==="[object z]",iv}var ov,yM;function T1(){if(yM)return ov;yM=1;var t=IF(),e=on(),n=gl(),r=Oi(),i=r("toStringTag"),o=Object,s=n(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return ov=t?n:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?n(u):(h=n(u))==="Object"&&e(u.callee)?"Arguments":h},ov}var sv,SM;function Um(){if(SM)return sv;SM=1;var t=T1(),e=String;return sv=function(n){if(t(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(n)},sv}var av,bM;function PF(){if(bM)return av;bM=1;var t=Um();return av=function(e,n){return e===void 0?arguments.length<2?"":n:t(e)},av}var lv,RM;function OF(){if(RM)return lv;RM=1;var t=Jr(),e=Yu();return lv=function(n,r){t(r)&&"cause"in r&&e(n,"cause",r.cause)},lv}var uv,EM;function xF(){if(EM)return uv;EM=1;var t=qt(),e=Error,n=t("".replace),r=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(r);return uv=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=n(s,i,"");return s},uv}var cv,TM;function HF(){if(TM)return cv;TM=1;var t=nn(),e=Wm();return cv=!t(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",e(1,7)),n.stack!==7):!0}),cv}var hv,_M;function AF(){if(_M)return hv;_M=1;var t=Yu(),e=xF(),n=HF(),r=Error.captureStackTrace;return hv=function(i,o,s,a){n&&(r?r(i,o):t(i,"stack",e(s,a)))},hv}var dv,MM;function NF(){if(MM)return dv;MM=1;var t=Uu(),e=ei(),n=Yu(),r=cd(),i=E1(),o=b1(),s=_F(),a=MF(),l=PF(),u=OF(),c=AF(),h=Qr(),d=Xs();return dv=function(f,m,v,S){var R="stackTraceLimit",w=S?2:1,_=f.split("."),O=_[_.length-1],L=t.apply(null,_);if(L){var M=L.prototype;if(!d&&e(M,"cause")&&delete M.cause,!v)return L;var x=t("Error"),z=m(function(q,A){var Z=l(S?A:q,void 0),X=S?new L(q):new L;return Z!==void 0&&n(X,"message",Z),c(X,z,X.stack,2),this&&r(M,this)&&a(X,this,z),arguments.length>w&&u(X,arguments[w]),X});if(z.prototype=M,O!=="Error"?i?i(z,x):o(z,x,{name:!0}):h&&R in L&&(s(z,L,R),s(z,L,"prepareStackTrace")),o(z,L),!d)try{M.name!==O&&n(M,"name",O),M.constructor=z}catch{}return z}},dv}var IM;function DF(){if(IM)return e_;IM=1;var t=gt(),e=Gt(),n=fd(),r=NF(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=r(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=r(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return n(u,this,arguments)}}),a("EvalError",function(u){return function(h){return n(u,this,arguments)}}),a("RangeError",function(u){return function(h){return n(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return n(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return n(u,this,arguments)}}),a("TypeError",function(u){return function(h){return n(u,this,arguments)}}),a("URIError",function(u){return function(h){return n(u,this,arguments)}}),l("CompileError",function(u){return function(h){return n(u,this,arguments)}}),l("LinkError",function(u){return function(h){return n(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return n(u,this,arguments)}}),e_}DF();var PM={},fv,OM;function _1(){if(OM)return fv;OM=1;var t=gl();return fv=Array.isArray||function(n){return t(n)==="Array"},fv}var gv,xM;function M1(){if(xM)return gv;xM=1;var t=Qr(),e=_1(),n=TypeError,r=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return gv=i?function(o,s){if(e(o)&&!r(o,"length").writable)throw new n("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},gv}var mv,HM;function I1(){if(HM)return mv;HM=1;var t=TypeError,e=9007199254740991;return mv=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},mv}var AM;function kF(){if(AM)return PM;AM=1;var t=gt(),e=zu(),n=Gu(),r=M1(),i=I1(),o=nn(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=n(h),f=arguments.length;i(d+f);for(var m=0;m<f;m++)h[d]=arguments[m],d++;return r(h,d),d}}),PM}kF();var NM={},pv,DM;function LF(){if(DM)return pv;DM=1;var t=gl(),e=qt();return pv=function(n){if(t(n)==="Function")return e(n)},pv}var wv,kM;function P1(){if(kM)return wv;kM=1;var t=LF(),e=gr(),n=Vm(),r=t(t.bind);return wv=function(i,o){return e(i),o===void 0?i:n?r(i,o):function(){return i.apply(o,arguments)}},wv}var vv,LM;function O1(){return LM||(LM=1,vv={}),vv}var Cv,$M;function $F(){if($M)return Cv;$M=1;var t=Oi(),e=O1(),n=t("iterator"),r=Array.prototype;return Cv=function(i){return i!==void 0&&(e.Array===i||r[n]===i)},Cv}var yv,FM;function uR(){if(FM)return yv;FM=1;var t=T1(),e=hd(),n=Jb(),r=O1(),i=Oi(),o=i("iterator");return yv=function(s){if(!n(s))return e(s,o)||e(s,"@@iterator")||r[t(s)]},yv}var Sv,VM;function FF(){if(VM)return Sv;VM=1;var t=rn(),e=gr(),n=sn(),r=jm(),i=uR(),o=TypeError;return Sv=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return n(t(l,s));throw new o(r(s)+" is not iterable")},Sv}var bv,WM;function mr(){if(WM)return bv;WM=1;var t=rn(),e=sn(),n=hd();return bv=function(r,i,o){var s,a;e(r);try{if(s=n(r,"return"),!s){if(i==="throw")throw o;return o}s=t(s,r)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},bv}var Rv,BM;function qu(){if(BM)return Rv;BM=1;var t=P1(),e=rn(),n=sn(),r=jm(),i=$F(),o=Gu(),s=cd(),a=FF(),l=uR(),u=mr(),c=TypeError,h=function(f,m){this.stopped=f,this.result=m},d=h.prototype;return Rv=function(f,m,v){var S=v&&v.that,R=!!(v&&v.AS_ENTRIES),w=!!(v&&v.IS_RECORD),_=!!(v&&v.IS_ITERATOR),O=!!(v&&v.INTERRUPTED),L=t(m,S),M,x,z,q,A,Z,X,oe=function(ae){return M&&u(M,"normal"),new h(!0,ae)},ee=function(ae){return R?(n(ae),O?L(ae[0],ae[1],oe):L(ae[0],ae[1])):O?L(ae,oe):L(ae)};if(w)M=f.iterator;else if(_)M=f;else{if(x=l(f),!x)throw new c(r(f)+" is not iterable");if(i(x)){for(z=0,q=o(f);q>z;z++)if(A=ee(f[z]),A&&s(d,A))return A;return new h(!1)}M=a(f,x)}for(Z=w?f.next:M.next;!(X=e(Z,M)).done;){try{A=ee(X.value)}catch(ae){u(M,"throw",ae)}if(typeof A=="object"&&A&&s(d,A))return A}return new h(!1)},Rv}var Ev,jM;function x1(){if(jM)return Ev;jM=1;var t=Qr(),e=Zs(),n=Wm();return Ev=function(r,i,o){t?e.f(r,i,n(0,o)):r[i]=o},Ev}var UM;function VF(){if(UM)return NM;UM=1;var t=gt(),e=qu(),n=x1();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){n(o,s,a)},{AS_ENTRIES:!0}),o}}),NM}VF();var zM={},Tv,YM;function fo(){if(YM)return Tv;YM=1;var t=qt(),e=Set.prototype;return Tv={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},Tv}var _v,GM;function ml(){if(GM)return _v;GM=1;var t=fo().has;return _v=function(e){return t(e),e},_v}var Mv,qM;function pl(){if(qM)return Mv;qM=1;var t=rn();return Mv=function(e,n,r){for(var i=r?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=n(s.value),a!==void 0)return a},Mv}var Iv,KM;function gd(){if(KM)return Iv;KM=1;var t=qt(),e=pl(),n=fo(),r=n.Set,i=n.proto,o=t(i.forEach),s=t(i.keys),a=s(new r).next;return Iv=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},Iv}var Pv,XM;function cR(){if(XM)return Pv;XM=1;var t=fo(),e=gd(),n=t.Set,r=t.add;return Pv=function(i){var o=new n;return e(i,function(s){r(o,s)}),o},Pv}var Ov,ZM;function md(){if(ZM)return Ov;ZM=1;var t=R1(),e=fo();return Ov=t(e.proto,"size","get")||function(n){return n.size},Ov}var xv,QM;function go(){return QM||(QM=1,xv=function(t){return{iterator:t,next:t.next,done:!1}}),xv}var Hv,JM;function wl(){if(JM)return Hv;JM=1;var t=gr(),e=sn(),n=rn(),r=dd(),i=go(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(n(this.keys,this.set)))},includes:function(c){return n(this.has,this.set,c)}},Hv=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=r(h);if(d<0)throw new s(o);return new u(c,d)},Hv}var Av,eI;function WF(){if(eI)return Av;eI=1;var t=ml(),e=fo(),n=cR(),r=md(),i=wl(),o=gd(),s=pl(),a=e.has,l=e.remove;return Av=function(c){var h=t(this),d=i(c),f=n(h);return r(h)<=d.size?o(h,function(m){d.includes(m)&&l(f,m)}):s(d.getIterator(),function(m){a(f,m)&&l(f,m)}),f},Av}var Nv,tI;function vl(){if(tI)return Nv;tI=1;var t=Uu(),e=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},n=function(r){return{size:r,has:function(){return!0},keys:function(){throw new Error("e")}}};return Nv=function(r,i){var o=t("Set");try{new o()[r](e(0));try{return new o()[r](e(-1)),!1}catch{if(!i)return!0;try{return new o()[r](n(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[r](n(1/0)))}}}catch{return!1}},Nv}var nI;function BF(){if(nI)return zM;nI=1;var t=gt(),e=WF(),n=nn(),r=vl(),i=!r("difference",function(s){return s.size===0}),o=i||n(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),zM}BF();var rI={},Dv,iI;function jF(){if(iI)return Dv;iI=1;var t=ml(),e=fo(),n=md(),r=wl(),i=gd(),o=pl(),s=e.Set,a=e.add,l=e.has;return Dv=function(c){var h=t(this),d=r(c),f=new s;return n(h)>d.size?o(d.getIterator(),function(m){l(h,m)&&a(f,m)}):i(h,function(m){d.includes(m)&&a(f,m)}),f},Dv}var oI;function UF(){if(oI)return rI;oI=1;var t=gt(),e=nn(),n=jF(),r=vl(),i=!r("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:n}),rI}UF();var sI={},kv,aI;function zF(){if(aI)return kv;aI=1;var t=ml(),e=fo().has,n=md(),r=wl(),i=gd(),o=pl(),s=mr();return kv=function(l){var u=t(this),c=r(l);if(n(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},kv}var lI;function YF(){if(lI)return sI;lI=1;var t=gt(),e=zF(),n=vl(),r=!n("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isDisjointFrom:e}),sI}YF();var uI={},Lv,cI;function GF(){if(cI)return Lv;cI=1;var t=ml(),e=md(),n=gd(),r=wl();return Lv=function(o){var s=t(this),a=r(o);return e(s)>a.size?!1:n(s,function(l){if(!a.includes(l))return!1},!0)!==!1},Lv}var hI;function qF(){if(hI)return uI;hI=1;var t=gt(),e=GF(),n=vl(),r=!n("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSubsetOf:e}),uI}qF();var dI={},$v,fI;function KF(){if(fI)return $v;fI=1;var t=ml(),e=fo().has,n=md(),r=wl(),i=pl(),o=mr();return $v=function(a){var l=t(this),u=r(a);if(n(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},$v}var gI;function XF(){if(gI)return dI;gI=1;var t=gt(),e=KF(),n=vl(),r=!n("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSupersetOf:e}),dI}XF();var mI={},Fv,pI;function ZF(){if(pI)return Fv;pI=1;var t=ml(),e=fo(),n=cR(),r=wl(),i=pl(),o=e.add,s=e.has,a=e.remove;return Fv=function(u){var c=t(this),h=r(u).getIterator(),d=n(c);return i(h,function(f){s(c,f)?a(d,f):o(d,f)}),d},Fv}var Vv,wI;function H1(){return wI||(wI=1,Vv=function(t){try{var e=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},r=e[t](n);return r.size===1&&r.values().next().value===4}catch{return!1}}),Vv}var vI;function QF(){if(vI)return mI;vI=1;var t=gt(),e=ZF(),n=H1(),r=vl(),i=!r("symmetricDifference")||!n("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),mI}QF();var CI={},Wv,yI;function JF(){if(yI)return Wv;yI=1;var t=ml(),e=fo().add,n=cR(),r=wl(),i=pl();return Wv=function(s){var a=t(this),l=r(s).getIterator(),u=n(a);return i(l,function(c){e(u,c)}),u},Wv}var SI;function eV(){if(SI)return CI;SI=1;var t=gt(),e=JF(),n=H1(),r=vl(),i=!r("union")||!n("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),CI}eV();var bI={},RI={},Bv,EI;function tV(){if(EI)return Bv;EI=1;var t=cd(),e=TypeError;return Bv=function(n,r){if(t(r,n))return n;throw new e("Incorrect invocation")},Bv}var jv,TI;function nV(){if(TI)return jv;TI=1;var t=nn();return jv=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),jv}var Uv,_I;function A1(){if(_I)return Uv;_I=1;var t=ei(),e=on(),n=zu(),r=oR(),i=nV(),o=r("IE_PROTO"),s=Object,a=s.prototype;return Uv=i?s.getPrototypeOf:function(l){var u=n(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},Uv}var zv,MI;function rV(){if(MI)return zv;MI=1;var t=y1(),e=Zs();return zv=function(n,r,i){return i.get&&t(i.get,r,{getter:!0}),i.set&&t(i.set,r,{setter:!0}),e.f(n,r,i)},zv}var Yv={},Gv,II;function iV(){if(II)return Gv;II=1;var t=S1(),e=lR();return Gv=Object.keys||function(r){return t(r,e)},Gv}var PI;function oV(){if(PI)return Yv;PI=1;var t=Qr(),e=v1(),n=Zs(),r=sn(),i=ud(),o=iV();return Yv.f=t&&!e?Object.defineProperties:function(a,l){r(a);for(var u=i(l),c=o(l),h=c.length,d=0,f;h>d;)n.f(a,f=c[d++],u[f]);return a},Yv}var qv,OI;function N1(){if(OI)return qv;OI=1;var t=Uu();return qv=t("document","documentElement"),qv}var Kv,xI;function hR(){if(xI)return Kv;xI=1;var t=sn(),e=oV(),n=lR(),r=sR(),i=N1(),o=iR(),s=oR(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},f=function(w){return l+c+a+w+l+"/"+c+a},m=function(w){w.write(f("")),w.close();var _=w.parentWindow.Object;return w=null,_},v=function(){var w=o("iframe"),_="java"+c+":",O;return w.style.display="none",i.appendChild(w),w.src=String(_),O=w.contentWindow.document,O.open(),O.write(f("document.F=Object")),O.close(),O.F},S,R=function(){try{S=new ActiveXObject("htmlfile")}catch{}R=typeof document<"u"?document.domain&&S?m(S):v():m(S);for(var w=n.length;w--;)delete R[u][n[w]];return R()};return r[h]=!0,Kv=Object.create||function(_,O){var L;return _!==null?(d[u]=t(_),L=new d,d[u]=null,L[h]=_):L=R(),O===void 0?L:e.f(L,O)},Kv}var Xv,HI;function D1(){if(HI)return Xv;HI=1;var t=nn(),e=on(),n=Jr(),r=hR(),i=A1(),o=aR(),s=Oi(),a=Xs(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var f=!n(c)||t(function(){var m={};return c[l].call(m)!==m});return f?c={}:a&&(c=r(c)),e(c[l])||o(c,l,function(){return this}),Xv={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},Xv}var AI;function sV(){if(AI)return RI;AI=1;var t=gt(),e=Gt(),n=tV(),r=sn(),i=on(),o=A1(),s=rV(),a=x1(),l=nn(),u=ei(),c=Oi(),h=D1().IteratorPrototype,d=Qr(),f=Xs(),m="constructor",v="Iterator",S=c("toStringTag"),R=TypeError,w=e[v],_=f||!i(w)||w.prototype!==h||!l(function(){w({})}),O=function(){if(n(this,h),o(this)===h)throw new R("Abstract class Iterator not directly constructable")},L=function(M,x){d?s(h,M,{configurable:!0,get:function(){return x},set:function(z){if(r(this),this===h)throw new R("You can't redefine this property");u(this,M)?this[M]=z:a(this,M,z)}}):h[M]=x};return u(h,S)||L(S,v),(_||!u(h,m)||h[m]===Object)&&L(m,O),O.prototype=h,t({global:!0,constructor:!0,forced:_},{Iterator:O}),RI}var NI;function aV(){return NI||(NI=1,sV()),bI}aV();var DI={},kI={},Zv,LI;function lV(){if(LI)return Zv;LI=1;var t=aR();return Zv=function(e,n,r){for(var i in n)t(e,i,n[i],r);return e},Zv}var Qv,$I;function uV(){return $I||($I=1,Qv=function(t,e){return{value:t,done:e}}),Qv}var Jv,FI;function cV(){if(FI)return Jv;FI=1;var t=mr();return Jv=function(e,n,r){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{r=t(e[i].iterator,n,r)}catch(o){n="throw",r=o}if(n==="throw")throw r;return r},Jv}var eC,VI;function dR(){if(VI)return eC;VI=1;var t=rn(),e=hR(),n=Yu(),r=lV(),i=Oi(),o=C1(),s=hd(),a=D1().IteratorPrototype,l=uV(),u=mr(),c=cV(),h=i("toStringTag"),d="IteratorHelper",f="WrapForValidIterator",m="normal",v="throw",S=o.set,R=function(O){var L=o.getterFor(O?f:d);return r(e(a),{next:function(){var x=L(this);if(O)return x.nextHandler();if(x.done)return l(void 0,!0);try{var z=x.nextHandler();return x.returnHandlerResult?z:l(z,x.done)}catch(q){throw x.done=!0,q}},return:function(){var M=L(this),x=M.iterator;if(M.done=!0,O){var z=s(x,"return");return z?t(z,x):l(void 0,!0)}if(M.inner)try{u(M.inner.iterator,m)}catch(q){return u(x,v,q)}if(M.openIters)try{c(M.openIters,m)}catch(q){return u(x,v,q)}return x&&u(x,m),l(void 0,!0)}})},w=R(!0),_=R(!1);return n(_,h,"Iterator Helper"),eC=function(O,L,M){var x=function(q,A){A?(A.iterator=q.iterator,A.next=q.next):A=q,A.type=L?f:d,A.returnHandlerResult=!!M,A.nextHandler=O,A.counter=0,A.done=!1,S(this,A)};return x.prototype=L?w:_,x},eC}var tC,WI;function k1(){if(WI)return tC;WI=1;var t=sn(),e=mr();return tC=function(n,r,i,o){try{return o?r(t(i)[0],i[1]):r(i)}catch(s){e(n,"throw",s)}},tC}var nC,BI;function fR(){return BI||(BI=1,nC=function(t,e){var n=typeof Iterator=="function"&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch{return!0}}),nC}var rC,jI;function Qs(){if(jI)return rC;jI=1;var t=Gt();return rC=function(e,n){var r=t.Iterator,i=r&&r.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof n||(s=!1)}if(!s)return o},rC}var UI;function hV(){if(UI)return kI;UI=1;var t=gt(),e=rn(),n=gr(),r=sn(),i=go(),o=dR(),s=k1(),a=Xs(),l=mr(),u=fR(),c=Qs(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),f=a||h||d,m=o(function(){for(var v=this.iterator,S=this.predicate,R=this.next,w,_,O;;){if(w=r(e(R,v)),_=this.done=!!w.done,_)return;if(O=w.value,s(v,S,[O,this.counter++],!0))return O}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{filter:function(S){r(this);try{n(S)}catch(R){l(this,"throw",R)}return d?e(d,this,S):new m(i(this),{predicate:S})}}),kI}var zI;function dV(){return zI||(zI=1,hV()),DI}dV();var YI={},GI={},qI;function fV(){if(qI)return GI;qI=1;var t=gt(),e=rn(),n=qu(),r=gr(),i=sn(),o=go(),s=mr(),a=Qs(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;n(h,function(f){c(f,d++)},{IS_RECORD:!0})}}),GI}var KI;function gV(){return KI||(KI=1,fV()),YI}gV();var XI={},ZI={},QI;function mV(){if(QI)return ZI;QI=1;var t=gt(),e=rn(),n=gr(),r=sn(),i=go(),o=dR(),s=k1(),a=mr(),l=fR(),u=Qs(),c=Xs(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),f=c||h||d,m=o(function(){var v=this.iterator,S=r(e(this.next,v)),R=this.done=!!S.done;if(!R)return s(v,this.mapper,[S.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:f},{map:function(S){r(this);try{n(S)}catch(R){a(this,"throw",R)}return d?e(d,this,S):new m(i(this),{mapper:S})}}),ZI}var JI;function pV(){return JI||(JI=1,mV()),XI}pV();var eP={},tP={},iC,nP;function gR(){if(nP)return iC;nP=1;var t=qt();return iC=t([].slice),iC}var oC,rP;function L1(){if(rP)return oC;rP=1;var t=TypeError;return oC=function(e,n){if(e<n)throw new t("Not enough arguments");return e},oC}var sC,iP;function wV(){if(iP)return sC;iP=1;var t=Bm();return sC=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),sC}var aC,oP;function $1(){if(oP)return aC;oP=1;var t=Gt(),e=Bm(),n=gl(),r=function(i){return e.slice(0,i.length)===i};return aC=function(){return r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":n(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),aC}var lC,sP;function vV(){if(sP)return lC;sP=1;var t=$1();return lC=t==="NODE",lC}var uC,aP;function F1(){if(aP)return uC;aP=1;var t=Gt(),e=fd(),n=P1(),r=on(),i=ei(),o=nn(),s=N1(),a=gR(),l=iR(),u=L1(),c=wV(),h=vV(),d=t.setImmediate,f=t.clearImmediate,m=t.process,v=t.Dispatch,S=t.Function,R=t.MessageChannel,w=t.String,_=0,O={},L="onreadystatechange",M,x,z,q;o(function(){M=t.location});var A=function(ee){if(i(O,ee)){var ae=O[ee];delete O[ee],ae()}},Z=function(ee){return function(){A(ee)}},X=function(ee){A(ee.data)},oe=function(ee){t.postMessage(w(ee),M.protocol+"//"+M.host)};return(!d||!f)&&(d=function(ae){u(arguments.length,1);var ht=r(ae)?ae:S(ae),Ie=a(arguments,1);return O[++_]=function(){e(ht,void 0,Ie)},x(_),_},f=function(ae){delete O[ae]},h?x=function(ee){m.nextTick(Z(ee))}:v&&v.now?x=function(ee){v.now(Z(ee))}:R&&!c?(z=new R,q=z.port2,z.port1.onmessage=X,x=n(q.postMessage,q)):t.addEventListener&&r(t.postMessage)&&!t.importScripts&&M&&M.protocol!=="file:"&&!o(oe)?(x=oe,t.addEventListener("message",X,!1)):L in l("script")?x=function(ee){s.appendChild(l("script"))[L]=function(){s.removeChild(this),A(ee)}}:x=function(ee){setTimeout(Z(ee),0)}),uC={set:d,clear:f},uC}var lP;function CV(){if(lP)return tP;lP=1;var t=gt(),e=Gt(),n=F1().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==n},{clearImmediate:n}),tP}var uP={},cC,cP;function yV(){if(cP)return cC;cP=1;var t=Gt(),e=fd(),n=on(),r=$1(),i=Bm(),o=gR(),s=L1(),a=t.Function,l=/MSIE .\./.test(i)||r==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return cC=function(u,c){var h=c?2:1;return l?function(d,f){var m=s(arguments.length,1)>h,v=n(d)?d:a(d),S=m?o(arguments,h):[],R=m?function(){e(v,this,S)}:v;return c?u(R,f):u(R)}:u},cC}var hP;function SV(){if(hP)return uP;hP=1;var t=gt(),e=Gt(),n=F1().set,r=yV(),i=e.setImmediate?r(n,!1):n;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),uP}var dP;function bV(){return dP||(dP=1,CV(),SV()),eP}bV();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:V1,setPrototypeOf:fP,isFrozen:RV,getPrototypeOf:EV,getOwnPropertyDescriptor:TV}=Object;let{freeze:Yn,seal:Zr,create:W1}=Object,{apply:KS,construct:XS}=typeof Reflect<"u"&&Reflect;Yn||(Yn=function(e){return e});Zr||(Zr=function(e){return e});KS||(KS=function(e,n,r){return e.apply(n,r)});XS||(XS=function(e,n){return new e(...n)});const Ld=Gn(Array.prototype.forEach),_V=Gn(Array.prototype.lastIndexOf),gP=Gn(Array.prototype.pop),uc=Gn(Array.prototype.push),MV=Gn(Array.prototype.splice),Sg=Gn(String.prototype.toLowerCase),hC=Gn(String.prototype.toString),mP=Gn(String.prototype.match),cc=Gn(String.prototype.replace),IV=Gn(String.prototype.indexOf),PV=Gn(String.prototype.trim),pi=Gn(Object.prototype.hasOwnProperty),kn=Gn(RegExp.prototype.test),hc=OV(TypeError);function Gn(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return KS(t,e,r)}}function OV(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return XS(t,n)}}function ke(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Sg;fP&&fP(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(RV(e)||(e[r]=o),i=o)}t[i]=!0}return t}function xV(t){for(let e=0;e<t.length;e++)pi(t,e)||(t[e]=null);return t}function No(t){const e=W1(null);for(const[n,r]of V1(t))pi(t,n)&&(Array.isArray(r)?e[n]=xV(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=No(r):e[n]=r);return e}function dc(t,e){for(;t!==null;){const r=TV(t,e);if(r){if(r.get)return Gn(r.get);if(typeof r.value=="function")return Gn(r.value)}t=EV(t)}function n(){return null}return n}const pP=Yn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),dC=Yn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),fC=Yn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),HV=Yn(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),gC=Yn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),AV=Yn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),wP=Yn(["#text"]),vP=Yn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),mC=Yn(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),CP=Yn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),$d=Yn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),NV=Zr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),DV=Zr(/<%[\w\W]*|[\w\W]*%>/gm),kV=Zr(/\$\{[\w\W]*/gm),LV=Zr(/^data-[\-\w.\u00B7-\uFFFF]+$/),$V=Zr(/^aria-[\-\w]+$/),B1=Zr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),FV=Zr(/^(?:\w+script|data):/i),VV=Zr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),j1=Zr(/^html$/i),WV=Zr(/^[a-z][.\w]*(-[.\w]+)+$/i);var yP=Object.freeze({__proto__:null,ARIA_ATTR:$V,ATTR_WHITESPACE:VV,CUSTOM_ELEMENT:WV,DATA_ATTR:LV,DOCTYPE_NAME:j1,ERB_EXPR:DV,IS_ALLOWED_URI:B1,IS_SCRIPT_OR_DATA:FV,MUSTACHE_EXPR:NV,TMPLIT_EXPR:kV});const fc={element:1,text:3,progressingInstruction:7,comment:8,document:9},BV=function(){return typeof window>"u"?null:window},jV=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},SP=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function U1(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:BV();const e=me=>U1(me);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==fc.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,m=l.prototype,v=dc(m,"cloneNode"),S=dc(m,"remove"),R=dc(m,"nextSibling"),w=dc(m,"childNodes"),_=dc(m,"parentNode");if(typeof s=="function"){const me=n.createElement("template");me.content&&me.content.ownerDocument&&(n=me.content.ownerDocument)}let O,L="";const{implementation:M,createNodeIterator:x,createDocumentFragment:z,getElementsByTagName:q}=n,{importNode:A}=r;let Z=SP();e.isSupported=typeof V1=="function"&&typeof _=="function"&&M&&M.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:X,ERB_EXPR:oe,TMPLIT_EXPR:ee,DATA_ATTR:ae,ARIA_ATTR:ht,IS_SCRIPT_OR_DATA:Ie,ATTR_WHITESPACE:De,CUSTOM_ELEMENT:vt}=yP;let{IS_ALLOWED_URI:nt}=yP,st=null;const gn=ke({},[...pP,...dC,...fC,...gC,...wP]);let g=null;const p=ke({},[...vP,...mC,...CP,...$d]);let y=Object.seal(W1(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),N=null,F=null,B=!0,Y=!0,C=!1,b=!0,E=!1,T=!0,I=!1,k=!1,W=!1,H=!1,$=!1,V=!1,j=!0,U=!1;const ie="user-content-";let se=!0,Se=!1,$e={},Fe=null;const be=ke({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ye=null;const Je=ke({},["audio","video","img","source","image","track"]);let Xn=null;const vo=ke({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),oi="http://www.w3.org/1998/Math/MathML",an="http://www.w3.org/2000/svg",Ct="http://www.w3.org/1999/xhtml";let Et=Ct,mt=!1,Xe=null;const Hr=ke({},[oi,an,Ct],hC);let Dn=ke({},["mi","mo","mn","ms","mtext"]),ra=ke({},["annotation-xml"]);const kd=ke({},["title","style","font","a","script"]);let sc=null;const rF=["application/xhtml+xml","text/html"],iF="text/html";let mn=null,Rl=null;const oF=n.createElement("form"),WT=function(D){return D instanceof RegExp||D instanceof Function},$p=function(){let D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Rl&&Rl===D)){if((!D||typeof D!="object")&&(D={}),D=No(D),sc=rF.indexOf(D.PARSER_MEDIA_TYPE)===-1?iF:D.PARSER_MEDIA_TYPE,mn=sc==="application/xhtml+xml"?hC:Sg,st=pi(D,"ALLOWED_TAGS")?ke({},D.ALLOWED_TAGS,mn):gn,g=pi(D,"ALLOWED_ATTR")?ke({},D.ALLOWED_ATTR,mn):p,Xe=pi(D,"ALLOWED_NAMESPACES")?ke({},D.ALLOWED_NAMESPACES,hC):Hr,Xn=pi(D,"ADD_URI_SAFE_ATTR")?ke(No(vo),D.ADD_URI_SAFE_ATTR,mn):vo,ye=pi(D,"ADD_DATA_URI_TAGS")?ke(No(Je),D.ADD_DATA_URI_TAGS,mn):Je,Fe=pi(D,"FORBID_CONTENTS")?ke({},D.FORBID_CONTENTS,mn):be,N=pi(D,"FORBID_TAGS")?ke({},D.FORBID_TAGS,mn):No({}),F=pi(D,"FORBID_ATTR")?ke({},D.FORBID_ATTR,mn):No({}),$e=pi(D,"USE_PROFILES")?D.USE_PROFILES:!1,B=D.ALLOW_ARIA_ATTR!==!1,Y=D.ALLOW_DATA_ATTR!==!1,C=D.ALLOW_UNKNOWN_PROTOCOLS||!1,b=D.ALLOW_SELF_CLOSE_IN_ATTR!==!1,E=D.SAFE_FOR_TEMPLATES||!1,T=D.SAFE_FOR_XML!==!1,I=D.WHOLE_DOCUMENT||!1,H=D.RETURN_DOM||!1,$=D.RETURN_DOM_FRAGMENT||!1,V=D.RETURN_TRUSTED_TYPE||!1,W=D.FORCE_BODY||!1,j=D.SANITIZE_DOM!==!1,U=D.SANITIZE_NAMED_PROPS||!1,se=D.KEEP_CONTENT!==!1,Se=D.IN_PLACE||!1,nt=D.ALLOWED_URI_REGEXP||B1,Et=D.NAMESPACE||Ct,Dn=D.MATHML_TEXT_INTEGRATION_POINTS||Dn,ra=D.HTML_INTEGRATION_POINTS||ra,y=D.CUSTOM_ELEMENT_HANDLING||{},D.CUSTOM_ELEMENT_HANDLING&&WT(D.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(y.tagNameCheck=D.CUSTOM_ELEMENT_HANDLING.tagNameCheck),D.CUSTOM_ELEMENT_HANDLING&&WT(D.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(y.attributeNameCheck=D.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),D.CUSTOM_ELEMENT_HANDLING&&typeof D.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(y.allowCustomizedBuiltInElements=D.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),E&&(Y=!1),$&&(H=!0),$e&&(st=ke({},wP),g=[],$e.html===!0&&(ke(st,pP),ke(g,vP)),$e.svg===!0&&(ke(st,dC),ke(g,mC),ke(g,$d)),$e.svgFilters===!0&&(ke(st,fC),ke(g,mC),ke(g,$d)),$e.mathMl===!0&&(ke(st,gC),ke(g,CP),ke(g,$d))),D.ADD_TAGS&&(st===gn&&(st=No(st)),ke(st,D.ADD_TAGS,mn)),D.ADD_ATTR&&(g===p&&(g=No(g)),ke(g,D.ADD_ATTR,mn)),D.ADD_URI_SAFE_ATTR&&ke(Xn,D.ADD_URI_SAFE_ATTR,mn),D.FORBID_CONTENTS&&(Fe===be&&(Fe=No(Fe)),ke(Fe,D.FORBID_CONTENTS,mn)),se&&(st["#text"]=!0),I&&ke(st,["html","head","body"]),st.table&&(ke(st,["tbody"]),delete N.tbody),D.TRUSTED_TYPES_POLICY){if(typeof D.TRUSTED_TYPES_POLICY.createHTML!="function")throw hc('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof D.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw hc('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');O=D.TRUSTED_TYPES_POLICY,L=O.createHTML("")}else O===void 0&&(O=jV(f,i)),O!==null&&typeof L=="string"&&(L=O.createHTML(""));Yn&&Yn(D),Rl=D}},BT=ke({},[...dC,...fC,...HV]),jT=ke({},[...gC,...AV]),sF=function(D){let J=_(D);(!J||!J.tagName)&&(J={namespaceURI:Et,tagName:"template"});const fe=Sg(D.tagName),Tt=Sg(J.tagName);return Xe[D.namespaceURI]?D.namespaceURI===an?J.namespaceURI===Ct?fe==="svg":J.namespaceURI===oi?fe==="svg"&&(Tt==="annotation-xml"||Dn[Tt]):!!BT[fe]:D.namespaceURI===oi?J.namespaceURI===Ct?fe==="math":J.namespaceURI===an?fe==="math"&&ra[Tt]:!!jT[fe]:D.namespaceURI===Ct?J.namespaceURI===an&&!ra[Tt]||J.namespaceURI===oi&&!Dn[Tt]?!1:!jT[fe]&&(kd[fe]||!BT[fe]):!!(sc==="application/xhtml+xml"&&Xe[D.namespaceURI]):!1},Ai=function(D){uc(e.removed,{element:D});try{_(D).removeChild(D)}catch{S(D)}},El=function(D,J){try{uc(e.removed,{attribute:J.getAttributeNode(D),from:J})}catch{uc(e.removed,{attribute:null,from:J})}if(J.removeAttribute(D),D==="is")if(H||$)try{Ai(J)}catch{}else try{J.setAttribute(D,"")}catch{}},UT=function(D){let J=null,fe=null;if(W)D="<remove></remove>"+D;else{const ln=mP(D,/^[\r\n\t ]+/);fe=ln&&ln[0]}sc==="application/xhtml+xml"&&Et===Ct&&(D='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+D+"</body></html>");const Tt=O?O.createHTML(D):D;if(Et===Ct)try{J=new d().parseFromString(Tt,sc)}catch{}if(!J||!J.documentElement){J=M.createDocument(Et,"template",null);try{J.documentElement.innerHTML=mt?L:Tt}catch{}}const Rn=J.body||J.documentElement;return D&&fe&&Rn.insertBefore(n.createTextNode(fe),Rn.childNodes[0]||null),Et===Ct?q.call(J,I?"html":"body")[0]:I?J.documentElement:Rn},zT=function(D){return x.call(D.ownerDocument||D,D,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Fp=function(D){return D instanceof h&&(typeof D.nodeName!="string"||typeof D.textContent!="string"||typeof D.removeChild!="function"||!(D.attributes instanceof c)||typeof D.removeAttribute!="function"||typeof D.setAttribute!="function"||typeof D.namespaceURI!="string"||typeof D.insertBefore!="function"||typeof D.hasChildNodes!="function")},YT=function(D){return typeof a=="function"&&D instanceof a};function Co(me,D,J){Ld(me,fe=>{fe.call(e,D,J,Rl)})}const GT=function(D){let J=null;if(Co(Z.beforeSanitizeElements,D,null),Fp(D))return Ai(D),!0;const fe=mn(D.nodeName);if(Co(Z.uponSanitizeElement,D,{tagName:fe,allowedTags:st}),T&&D.hasChildNodes()&&!YT(D.firstElementChild)&&kn(/<[/\w!]/g,D.innerHTML)&&kn(/<[/\w!]/g,D.textContent)||D.nodeType===fc.progressingInstruction||T&&D.nodeType===fc.comment&&kn(/<[/\w]/g,D.data))return Ai(D),!0;if(!st[fe]||N[fe]){if(!N[fe]&&KT(fe)&&(y.tagNameCheck instanceof RegExp&&kn(y.tagNameCheck,fe)||y.tagNameCheck instanceof Function&&y.tagNameCheck(fe)))return!1;if(se&&!Fe[fe]){const Tt=_(D)||D.parentNode,Rn=w(D)||D.childNodes;if(Rn&&Tt){const ln=Rn.length;for(let Zn=ln-1;Zn>=0;--Zn){const yo=v(Rn[Zn],!0);yo.__removalCount=(D.__removalCount||0)+1,Tt.insertBefore(yo,R(D))}}}return Ai(D),!0}return D instanceof l&&!sF(D)||(fe==="noscript"||fe==="noembed"||fe==="noframes")&&kn(/<\/no(script|embed|frames)/i,D.innerHTML)?(Ai(D),!0):(E&&D.nodeType===fc.text&&(J=D.textContent,Ld([X,oe,ee],Tt=>{J=cc(J,Tt," ")}),D.textContent!==J&&(uc(e.removed,{element:D.cloneNode()}),D.textContent=J)),Co(Z.afterSanitizeElements,D,null),!1)},qT=function(D,J,fe){if(j&&(J==="id"||J==="name")&&(fe in n||fe in oF))return!1;if(!(Y&&!F[J]&&kn(ae,J))){if(!(B&&kn(ht,J))){if(!g[J]||F[J]){if(!(KT(D)&&(y.tagNameCheck instanceof RegExp&&kn(y.tagNameCheck,D)||y.tagNameCheck instanceof Function&&y.tagNameCheck(D))&&(y.attributeNameCheck instanceof RegExp&&kn(y.attributeNameCheck,J)||y.attributeNameCheck instanceof Function&&y.attributeNameCheck(J))||J==="is"&&y.allowCustomizedBuiltInElements&&(y.tagNameCheck instanceof RegExp&&kn(y.tagNameCheck,fe)||y.tagNameCheck instanceof Function&&y.tagNameCheck(fe))))return!1}else if(!Xn[J]){if(!kn(nt,cc(fe,De,""))){if(!((J==="src"||J==="xlink:href"||J==="href")&&D!=="script"&&IV(fe,"data:")===0&&ye[D])){if(!(C&&!kn(Ie,cc(fe,De,"")))){if(fe)return!1}}}}}}return!0},KT=function(D){return D!=="annotation-xml"&&mP(D,vt)},XT=function(D){Co(Z.beforeSanitizeAttributes,D,null);const{attributes:J}=D;if(!J||Fp(D))return;const fe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:g,forceKeepAttr:void 0};let Tt=J.length;for(;Tt--;){const Rn=J[Tt],{name:ln,namespaceURI:Zn,value:yo}=Rn,ac=mn(ln),Vp=yo;let En=ln==="value"?Vp:PV(Vp);if(fe.attrName=ac,fe.attrValue=En,fe.keepAttr=!0,fe.forceKeepAttr=void 0,Co(Z.uponSanitizeAttribute,D,fe),En=fe.attrValue,U&&(ac==="id"||ac==="name")&&(El(ln,D),En=ie+En),T&&kn(/((--!?|])>)|<\/(style|title)/i,En)){El(ln,D);continue}if(fe.forceKeepAttr)continue;if(!fe.keepAttr){El(ln,D);continue}if(!b&&kn(/\/>/i,En)){El(ln,D);continue}E&&Ld([X,oe,ee],QT=>{En=cc(En,QT," ")});const ZT=mn(D.nodeName);if(!qT(ZT,ac,En)){El(ln,D);continue}if(O&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!Zn)switch(f.getAttributeType(ZT,ac)){case"TrustedHTML":{En=O.createHTML(En);break}case"TrustedScriptURL":{En=O.createScriptURL(En);break}}if(En!==Vp)try{Zn?D.setAttributeNS(Zn,ln,En):D.setAttribute(ln,En),Fp(D)?Ai(D):gP(e.removed)}catch{El(ln,D)}}Co(Z.afterSanitizeAttributes,D,null)},aF=function me(D){let J=null;const fe=zT(D);for(Co(Z.beforeSanitizeShadowDOM,D,null);J=fe.nextNode();)Co(Z.uponSanitizeShadowNode,J,null),GT(J),XT(J),J.content instanceof o&&me(J.content);Co(Z.afterSanitizeShadowDOM,D,null)};return e.sanitize=function(me){let D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},J=null,fe=null,Tt=null,Rn=null;if(mt=!me,mt&&(me="<!-->"),typeof me!="string"&&!YT(me))if(typeof me.toString=="function"){if(me=me.toString(),typeof me!="string")throw hc("dirty is not a string, aborting")}else throw hc("toString is not a function");if(!e.isSupported)return me;if(k||$p(D),e.removed=[],typeof me=="string"&&(Se=!1),Se){if(me.nodeName){const yo=mn(me.nodeName);if(!st[yo]||N[yo])throw hc("root node is forbidden and cannot be sanitized in-place")}}else if(me instanceof a)J=UT("<!---->"),fe=J.ownerDocument.importNode(me,!0),fe.nodeType===fc.element&&fe.nodeName==="BODY"||fe.nodeName==="HTML"?J=fe:J.appendChild(fe);else{if(!H&&!E&&!I&&me.indexOf("<")===-1)return O&&V?O.createHTML(me):me;if(J=UT(me),!J)return H?null:V?L:""}J&&W&&Ai(J.firstChild);const ln=zT(Se?me:J);for(;Tt=ln.nextNode();)GT(Tt),XT(Tt),Tt.content instanceof o&&aF(Tt.content);if(Se)return me;if(H){if($)for(Rn=z.call(J.ownerDocument);J.firstChild;)Rn.appendChild(J.firstChild);else Rn=J;return(g.shadowroot||g.shadowrootmode)&&(Rn=A.call(r,Rn,!0)),Rn}let Zn=I?J.outerHTML:J.innerHTML;return I&&st["!doctype"]&&J.ownerDocument&&J.ownerDocument.doctype&&J.ownerDocument.doctype.name&&kn(j1,J.ownerDocument.doctype.name)&&(Zn="<!DOCTYPE "+J.ownerDocument.doctype.name+`>
`+Zn),E&&Ld([X,oe,ee],yo=>{Zn=cc(Zn,yo," ")}),O&&V?O.createHTML(Zn):Zn},e.setConfig=function(){let me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};$p(me),k=!0},e.clearConfig=function(){Rl=null,k=!1},e.isValidAttribute=function(me,D,J){Rl||$p({});const fe=mn(me),Tt=mn(D);return qT(fe,Tt,J)},e.addHook=function(me,D){typeof D=="function"&&uc(Z[me],D)},e.removeHook=function(me,D){if(D!==void 0){const J=_V(Z[me],D);return J===-1?void 0:MV(Z[me],J,1)[0]}return gP(Z[me])},e.removeHooks=function(me){Z[me]=[]},e.removeAllHooks=function(){Z=SP()},e}var UV=U1();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var z1;function K(){return z1.apply(null,arguments)}function zV(t){z1=t}function _i(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function tl(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function mR(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Ze(t,e))return!1;return!0}function sr(t){return t===void 0}function es(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function pd(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function Y1(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function Ls(t,e){for(var n in e)Ze(e,n)&&(t[n]=e[n]);return Ze(e,"toString")&&(t.toString=e.toString),Ze(e,"valueOf")&&(t.valueOf=e.valueOf),t}function mo(t,e,n,r){return mN(t,e,n,r,!0).utc()}function YV(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Pe(t){return t._pf==null&&(t._pf=YV()),t._pf}var ZS;Array.prototype.some?ZS=Array.prototype.some:ZS=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function pR(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=Pe(t),n=ZS.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function zm(t){var e=mo(NaN);return t!=null?Ls(Pe(e),t):Pe(e).userInvalidated=!0,e}var bP=K.momentProperties=[],pC=!1;function wR(t,e){var n,r,i,o=bP.length;if(sr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),sr(e._i)||(t._i=e._i),sr(e._f)||(t._f=e._f),sr(e._l)||(t._l=e._l),sr(e._strict)||(t._strict=e._strict),sr(e._tzm)||(t._tzm=e._tzm),sr(e._isUTC)||(t._isUTC=e._isUTC),sr(e._offset)||(t._offset=e._offset),sr(e._pf)||(t._pf=Pe(e)),sr(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=bP[n],i=e[r],sr(i)||(t[r]=i);return t}function wd(t){wR(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),pC===!1&&(pC=!0,K.updateOffset(this),pC=!1)}function Mi(t){return t instanceof wd||t!=null&&t._isAMomentObject!=null}function G1(t){K.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function ti(t,e){var n=!0;return Ls(function(){if(K.deprecationHandler!=null&&K.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])Ze(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}G1(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var RP={};function q1(t,e){K.deprecationHandler!=null&&K.deprecationHandler(t,e),RP[t]||(G1(e),RP[t]=!0)}K.suppressDeprecationWarnings=!1;K.deprecationHandler=null;function po(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function GV(t){var e,n;for(n in t)Ze(t,n)&&(e=t[n],po(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function QS(t,e){var n=Ls({},t),r;for(r in e)Ze(e,r)&&(tl(t[r])&&tl(e[r])?(n[r]={},Ls(n[r],t[r]),Ls(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)Ze(t,r)&&!Ze(e,r)&&tl(t[r])&&(n[r]=Ls({},n[r]));return n}function vR(t){t!=null&&this.set(t)}var JS;Object.keys?JS=Object.keys:JS=function(t){var e,n=[];for(e in t)Ze(t,e)&&n.push(e);return n};var qV={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function KV(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return po(r)?r.call(e,n):r}function co(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var CR=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Fd=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,wC={},Mu={};function we(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Mu[t]=i),e&&(Mu[e[0]]=function(){return co(i.apply(this,arguments),e[1],e[2])}),n&&(Mu[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function XV(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function ZV(t){var e=t.match(CR),n,r;for(n=0,r=e.length;n<r;n++)Mu[e[n]]?e[n]=Mu[e[n]]:e[n]=XV(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=po(e[s])?e[s].call(i,t):e[s];return o}}function bg(t,e){return t.isValid()?(e=K1(e,t.localeData()),wC[e]=wC[e]||ZV(e),wC[e](t)):t.localeData().invalidDate()}function K1(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Fd.lastIndex=0;n>=0&&Fd.test(t);)t=t.replace(Fd,r),Fd.lastIndex=0,n-=1;return t}var QV={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function JV(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(CR).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var eW="Invalid date";function tW(){return this._invalidDate}var nW="%d",rW=/\d{1,2}/;function iW(t){return this._ordinal.replace("%d",t)}var oW={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function sW(t,e,n,r){var i=this._relativeTime[n];return po(i)?i(t,e,n,r):i.replace(/%d/i,t)}function aW(t,e){var n=this._relativeTime[t>0?"future":"past"];return po(n)?n(e):n.replace(/%s/i,e)}var EP={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function ni(t){return typeof t=="string"?EP[t]||EP[t.toLowerCase()]:void 0}function yR(t){var e={},n,r;for(r in t)Ze(t,r)&&(n=ni(r),n&&(e[n]=t[r]));return e}var lW={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function uW(t){var e=[],n;for(n in t)Ze(t,n)&&e.push({unit:n,priority:lW[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var X1=/\d/,xr=/\d\d/,Z1=/\d{3}/,SR=/\d{4}/,Ym=/[+-]?\d{6}/,Rt=/\d\d?/,Q1=/\d\d\d\d?/,J1=/\d\d\d\d\d\d?/,Gm=/\d{1,3}/,bR=/\d{1,4}/,qm=/[+-]?\d{1,6}/,Ku=/\d+/,Km=/[+-]?\d+/,cW=/Z|[+-]\d\d:?\d\d/gi,Xm=/Z|[+-]\d\d(?::?\d\d)?/gi,hW=/[+-]?\d+(\.\d{1,3})?/,vd=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Xu=/^[1-9]\d?/,RR=/^([1-9]\d|\d)/,jg;jg={};function ue(t,e,n){jg[t]=po(e)?e:function(r,i){return r&&n?n:e}}function dW(t,e){return Ze(jg,t)?jg[t](e._strict,e._locale):new RegExp(fW(t))}function fW(t){return Zo(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function Zo(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Gr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function We(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Gr(e)),n}var eb={};function dt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),es(e)&&(r=function(o,s){s[e]=We(o)}),i=t.length,n=0;n<i;n++)eb[t[n]]=r}function Cd(t,e){dt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function gW(t,e,n){e!=null&&Ze(eb,t)&&eb[t](e,n._a,n,t)}function Zm(t){return t%4===0&&t%100!==0||t%400===0}var Nn=0,Uo=1,io=2,fn=3,Ri=4,zo=5,qa=6,mW=7,pW=8;we("Y",0,0,function(){var t=this.year();return t<=9999?co(t,4):"+"+t});we(0,["YY",2],0,function(){return this.year()%100});we(0,["YYYY",4],0,"year");we(0,["YYYYY",5],0,"year");we(0,["YYYYYY",6,!0],0,"year");ue("Y",Km);ue("YY",Rt,xr);ue("YYYY",bR,SR);ue("YYYYY",qm,Ym);ue("YYYYYY",qm,Ym);dt(["YYYYY","YYYYYY"],Nn);dt("YYYY",function(t,e){e[Nn]=t.length===2?K.parseTwoDigitYear(t):We(t)});dt("YY",function(t,e){e[Nn]=K.parseTwoDigitYear(t)});dt("Y",function(t,e){e[Nn]=parseInt(t,10)});function vh(t){return Zm(t)?366:365}K.parseTwoDigitYear=function(t){return We(t)+(We(t)>68?1900:2e3)};var eN=Zu("FullYear",!0);function wW(){return Zm(this.year())}function Zu(t,e){return function(n){return n!=null?(tN(this,t,n),K.updateOffset(this,e),this):Wh(this,t)}}function Wh(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function tN(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!Zm(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function vW(t){return t=ni(t),po(this[t])?this[t]():this}function CW(t,e){if(typeof t=="object"){t=yR(t);var n=uW(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=ni(t),po(this[t]))return this[t](e);return this}function yW(t,e){return(t%e+e)%e}var zt;Array.prototype.indexOf?zt=Array.prototype.indexOf:zt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function ER(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=yW(e,12);return t+=(e-n)/12,n===1?Zm(t)?29:28:31-n%7%2}we("M",["MM",2],"Mo",function(){return this.month()+1});we("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});we("MMMM",0,0,function(t){return this.localeData().months(this,t)});ue("M",Rt,Xu);ue("MM",Rt,xr);ue("MMM",function(t,e){return e.monthsShortRegex(t)});ue("MMMM",function(t,e){return e.monthsRegex(t)});dt(["M","MM"],function(t,e){e[Uo]=We(t)-1});dt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Uo]=i:Pe(n).invalidMonth=t});var SW="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),nN="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),rN=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,bW=vd,RW=vd;function EW(t,e){return t?_i(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||rN).test(e)?"format":"standalone"][t.month()]:_i(this._months)?this._months:this._months.standalone}function TW(t,e){return t?_i(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[rN.test(e)?"format":"standalone"][t.month()]:_i(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function _W(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=mo([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=zt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=zt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=zt.call(this._shortMonthsParse,s),i!==-1?i:(i=zt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=zt.call(this._longMonthsParse,s),i!==-1?i:(i=zt.call(this._shortMonthsParse,s),i!==-1?i:null))}function MW(t,e,n){var r,i,o;if(this._monthsParseExact)return _W.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=mo([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function iN(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=We(e);else if(e=t.localeData().monthsParse(e),!es(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,ER(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function oN(t){return t!=null?(iN(this,t),K.updateOffset(this,!0),this):Wh(this,"Month")}function IW(){return ER(this.year(),this.month())}function PW(t){return this._monthsParseExact?(Ze(this,"_monthsRegex")||sN.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Ze(this,"_monthsShortRegex")||(this._monthsShortRegex=bW),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function OW(t){return this._monthsParseExact?(Ze(this,"_monthsRegex")||sN.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Ze(this,"_monthsRegex")||(this._monthsRegex=RW),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function sN(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=mo([2e3,i]),s=Zo(this.monthsShort(o,"")),a=Zo(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function xW(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Bh(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Ug(t,e,n){var r=7+e-n,i=(7+Bh(t,0,r).getUTCDay()-e)%7;return-i+r-1}function aN(t,e,n,r,i){var o=(7+n-r)%7,s=Ug(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=vh(l)+a):a>vh(t)?(l=t+1,u=a-vh(t)):(l=t,u=a),{year:l,dayOfYear:u}}function jh(t,e,n){var r=Ug(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Qo(s,e,n)):i>Qo(t.year(),e,n)?(o=i-Qo(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Qo(t,e,n){var r=Ug(t,e,n),i=Ug(t+1,e,n);return(vh(t)-r+i)/7}we("w",["ww",2],"wo","week");we("W",["WW",2],"Wo","isoWeek");ue("w",Rt,Xu);ue("ww",Rt,xr);ue("W",Rt,Xu);ue("WW",Rt,xr);Cd(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=We(t)});function HW(t){return jh(t,this._week.dow,this._week.doy).week}var AW={dow:0,doy:6};function NW(){return this._week.dow}function DW(){return this._week.doy}function kW(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function LW(t){var e=jh(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}we("d",0,"do","day");we("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});we("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});we("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});we("e",0,0,"weekday");we("E",0,0,"isoWeekday");ue("d",Rt);ue("e",Rt);ue("E",Rt);ue("dd",function(t,e){return e.weekdaysMinRegex(t)});ue("ddd",function(t,e){return e.weekdaysShortRegex(t)});ue("dddd",function(t,e){return e.weekdaysRegex(t)});Cd(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Pe(n).invalidWeekday=t});Cd(["d","e","E"],function(t,e,n,r){e[r]=We(t)});function $W(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function FW(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function TR(t,e){return t.slice(e,7).concat(t.slice(0,e))}var VW="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),lN="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),WW="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),BW=vd,jW=vd,UW=vd;function zW(t,e){var n=_i(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?TR(n,this._week.dow):t?n[t.day()]:n}function YW(t){return t===!0?TR(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function GW(t){return t===!0?TR(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function qW(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=mo([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=zt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=zt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=zt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=zt.call(this._weekdaysParse,s),i!==-1||(i=zt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=zt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=zt.call(this._shortWeekdaysParse,s),i!==-1||(i=zt.call(this._weekdaysParse,s),i!==-1)?i:(i=zt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=zt.call(this._minWeekdaysParse,s),i!==-1||(i=zt.call(this._weekdaysParse,s),i!==-1)?i:(i=zt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function KW(t,e,n){var r,i,o;if(this._weekdaysParseExact)return qW.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=mo([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function XW(t){if(!this.isValid())return t!=null?this:NaN;var e=Wh(this,"Day");return t!=null?(t=$W(t,this.localeData()),this.add(t-e,"d")):e}function ZW(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function QW(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=FW(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function JW(t){return this._weekdaysParseExact?(Ze(this,"_weekdaysRegex")||_R.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Ze(this,"_weekdaysRegex")||(this._weekdaysRegex=BW),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function eB(t){return this._weekdaysParseExact?(Ze(this,"_weekdaysRegex")||_R.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Ze(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=jW),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function tB(t){return this._weekdaysParseExact?(Ze(this,"_weekdaysRegex")||_R.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Ze(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=UW),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function _R(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=mo([2e3,1]).day(o),a=Zo(this.weekdaysMin(s,"")),l=Zo(this.weekdaysShort(s,"")),u=Zo(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function MR(){return this.hours()%12||12}function nB(){return this.hours()||24}we("H",["HH",2],0,"hour");we("h",["hh",2],0,MR);we("k",["kk",2],0,nB);we("hmm",0,0,function(){return""+MR.apply(this)+co(this.minutes(),2)});we("hmmss",0,0,function(){return""+MR.apply(this)+co(this.minutes(),2)+co(this.seconds(),2)});we("Hmm",0,0,function(){return""+this.hours()+co(this.minutes(),2)});we("Hmmss",0,0,function(){return""+this.hours()+co(this.minutes(),2)+co(this.seconds(),2)});function uN(t,e){we(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}uN("a",!0);uN("A",!1);function cN(t,e){return e._meridiemParse}ue("a",cN);ue("A",cN);ue("H",Rt,RR);ue("h",Rt,Xu);ue("k",Rt,Xu);ue("HH",Rt,xr);ue("hh",Rt,xr);ue("kk",Rt,xr);ue("hmm",Q1);ue("hmmss",J1);ue("Hmm",Q1);ue("Hmmss",J1);dt(["H","HH"],fn);dt(["k","kk"],function(t,e,n){var r=We(t);e[fn]=r===24?0:r});dt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});dt(["h","hh"],function(t,e,n){e[fn]=We(t),Pe(n).bigHour=!0});dt("hmm",function(t,e,n){var r=t.length-2;e[fn]=We(t.substr(0,r)),e[Ri]=We(t.substr(r)),Pe(n).bigHour=!0});dt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[fn]=We(t.substr(0,r)),e[Ri]=We(t.substr(r,2)),e[zo]=We(t.substr(i)),Pe(n).bigHour=!0});dt("Hmm",function(t,e,n){var r=t.length-2;e[fn]=We(t.substr(0,r)),e[Ri]=We(t.substr(r))});dt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[fn]=We(t.substr(0,r)),e[Ri]=We(t.substr(r,2)),e[zo]=We(t.substr(i))});function rB(t){return(t+"").toLowerCase().charAt(0)==="p"}var iB=/[ap]\.?m?\.?/i,oB=Zu("Hours",!0);function sB(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var hN={calendar:qV,longDateFormat:QV,invalidDate:eW,ordinal:nW,dayOfMonthOrdinalParse:rW,relativeTime:oW,months:SW,monthsShort:nN,week:AW,weekdays:VW,weekdaysMin:WW,weekdaysShort:lN,meridiemParse:iB},_t={},gc={},Uh;function aB(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function TP(t){return t&&t.toLowerCase().replace("_","-")}function lB(t){for(var e=0,n,r,i,o;e<t.length;){for(o=TP(t[e]).split("-"),n=o.length,r=TP(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Qm(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&aB(o,r)>=n-1)break;n--}e++}return Uh}function uB(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Qm(t){var e=null,n;if(_t[t]===void 0&&typeof module<"u"&&module&&module.exports&&uB(t))try{e=Uh._abbr,n=require,n("./locale/"+t),Us(e)}catch{_t[t]=null}return _t[t]}function Us(t,e){var n;return t&&(sr(e)?n=os(t):n=IR(t,e),n?Uh=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Uh._abbr}function IR(t,e){if(e!==null){var n,r=hN;if(e.abbr=t,_t[t]!=null)q1("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=_t[t]._config;else if(e.parentLocale!=null)if(_t[e.parentLocale]!=null)r=_t[e.parentLocale]._config;else if(n=Qm(e.parentLocale),n!=null)r=n._config;else return gc[e.parentLocale]||(gc[e.parentLocale]=[]),gc[e.parentLocale].push({name:t,config:e}),null;return _t[t]=new vR(QS(r,e)),gc[t]&&gc[t].forEach(function(i){IR(i.name,i.config)}),Us(t),_t[t]}else return delete _t[t],null}function cB(t,e){if(e!=null){var n,r,i=hN;_t[t]!=null&&_t[t].parentLocale!=null?_t[t].set(QS(_t[t]._config,e)):(r=Qm(t),r!=null&&(i=r._config),e=QS(i,e),r==null&&(e.abbr=t),n=new vR(e),n.parentLocale=_t[t],_t[t]=n),Us(t)}else _t[t]!=null&&(_t[t].parentLocale!=null?(_t[t]=_t[t].parentLocale,t===Us()&&Us(t)):_t[t]!=null&&delete _t[t]);return _t[t]}function os(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Uh;if(!_i(t)){if(e=Qm(t),e)return e;t=[t]}return lB(t)}function hB(){return JS(_t)}function PR(t){var e,n=t._a;return n&&Pe(t).overflow===-2&&(e=n[Uo]<0||n[Uo]>11?Uo:n[io]<1||n[io]>ER(n[Nn],n[Uo])?io:n[fn]<0||n[fn]>24||n[fn]===24&&(n[Ri]!==0||n[zo]!==0||n[qa]!==0)?fn:n[Ri]<0||n[Ri]>59?Ri:n[zo]<0||n[zo]>59?zo:n[qa]<0||n[qa]>999?qa:-1,Pe(t)._overflowDayOfYear&&(e<Nn||e>io)&&(e=io),Pe(t)._overflowWeeks&&e===-1&&(e=mW),Pe(t)._overflowWeekday&&e===-1&&(e=pW),Pe(t).overflow=e),t}var dB=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,fB=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gB=/Z|[+-]\d\d(?::?\d\d)?/,Vd=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],vC=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],mB=/^\/?Date\((-?\d+)/i,pB=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,wB={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function dN(t){var e,n,r=t._i,i=dB.exec(r)||fB.exec(r),o,s,a,l,u=Vd.length,c=vC.length;if(i){for(Pe(t).iso=!0,e=0,n=u;e<n;e++)if(Vd[e][1].exec(i[1])){s=Vd[e][0],o=Vd[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(vC[e][1].exec(i[3])){a=(i[2]||" ")+vC[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(gB.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),xR(t)}else t._isValid=!1}function vB(t,e,n,r,i,o){var s=[CB(t),nN.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function CB(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function yB(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function SB(t,e,n){if(t){var r=lN.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Pe(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function bB(t,e,n){if(t)return wB[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function fN(t){var e=pB.exec(yB(t._i)),n;if(e){if(n=vB(e[4],e[3],e[2],e[5],e[6],e[7]),!SB(e[1],n,t))return;t._a=n,t._tzm=bB(e[8],e[9],e[10]),t._d=Bh.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Pe(t).rfc2822=!0}else t._isValid=!1}function RB(t){var e=mB.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(dN(t),t._isValid===!1)delete t._isValid;else return;if(fN(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:K.createFromInputFallback(t)}K.createFromInputFallback=ti("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function hu(t,e,n){return t??e??n}function EB(t){var e=new Date(K.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function OR(t){var e,n,r=[],i,o,s;if(!t._d){for(i=EB(t),t._w&&t._a[io]==null&&t._a[Uo]==null&&TB(t),t._dayOfYear!=null&&(s=hu(t._a[Nn],i[Nn]),(t._dayOfYear>vh(s)||t._dayOfYear===0)&&(Pe(t)._overflowDayOfYear=!0),n=Bh(s,0,t._dayOfYear),t._a[Uo]=n.getUTCMonth(),t._a[io]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[fn]===24&&t._a[Ri]===0&&t._a[zo]===0&&t._a[qa]===0&&(t._nextDay=!0,t._a[fn]=0),t._d=(t._useUTC?Bh:xW).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[fn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Pe(t).weekdayMismatch=!0)}}function TB(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=hu(e.GG,t._a[Nn],jh(bt(),1,4).year),r=hu(e.W,1),i=hu(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=jh(bt(),o,s),n=hu(e.gg,t._a[Nn],u.year),r=hu(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>Qo(n,o,s)?Pe(t)._overflowWeeks=!0:l!=null?Pe(t)._overflowWeekday=!0:(a=aN(n,r,i,o,s),t._a[Nn]=a.year,t._dayOfYear=a.dayOfYear)}K.ISO_8601=function(){};K.RFC_2822=function(){};function xR(t){if(t._f===K.ISO_8601){dN(t);return}if(t._f===K.RFC_2822){fN(t);return}t._a=[],Pe(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=K1(t._f,t._locale).match(CR)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(dW(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Pe(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Mu[o]?(r?Pe(t).empty=!1:Pe(t).unusedTokens.push(o),gW(o,r,t)):t._strict&&!r&&Pe(t).unusedTokens.push(o);Pe(t).charsLeftOver=a-l,e.length>0&&Pe(t).unusedInput.push(e),t._a[fn]<=12&&Pe(t).bigHour===!0&&t._a[fn]>0&&(Pe(t).bigHour=void 0),Pe(t).parsedDateParts=t._a.slice(0),Pe(t).meridiem=t._meridiem,t._a[fn]=_B(t._locale,t._a[fn],t._meridiem),u=Pe(t).era,u!==null&&(t._a[Nn]=t._locale.erasConvertYear(u,t._a[Nn])),OR(t),PR(t)}function _B(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function MB(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Pe(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=wR({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],xR(e),pR(e)&&(s=!0),o+=Pe(e).charsLeftOver,o+=Pe(e).unusedTokens.length*10,Pe(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));Ls(t,n||e)}function IB(t){if(!t._d){var e=yR(t._i),n=e.day===void 0?e.date:e.day;t._a=Y1([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),OR(t)}}function PB(t){var e=new wd(PR(gN(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function gN(t){var e=t._i,n=t._f;return t._locale=t._locale||os(t._l),e===null||n===void 0&&e===""?zm({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Mi(e)?new wd(PR(e)):(pd(e)?t._d=e:_i(n)?MB(t):n?xR(t):OB(t),pR(t)||(t._d=null),t))}function OB(t){var e=t._i;sr(e)?t._d=new Date(K.now()):pd(e)?t._d=new Date(e.valueOf()):typeof e=="string"?RB(t):_i(e)?(t._a=Y1(e.slice(0),function(n){return parseInt(n,10)}),OR(t)):tl(e)?IB(t):es(e)?t._d=new Date(e):K.createFromInputFallback(t)}function mN(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(tl(t)&&mR(t)||_i(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,PB(o)}function bt(t,e,n,r){return mN(t,e,n,r,!1)}var xB=ti("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=bt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:zm()}),HB=ti("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=bt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:zm()});function pN(t,e){var n,r;if(e.length===1&&_i(e[0])&&(e=e[0]),!e.length)return bt();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function AB(){var t=[].slice.call(arguments,0);return pN("isBefore",t)}function NB(){var t=[].slice.call(arguments,0);return pN("isAfter",t)}var DB=function(){return Date.now?Date.now():+new Date},mc=["year","quarter","month","week","day","hour","minute","second","millisecond"];function kB(t){var e,n=!1,r,i=mc.length;for(e in t)if(Ze(t,e)&&!(zt.call(mc,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[mc[r]]){if(n)return!1;parseFloat(t[mc[r]])!==We(t[mc[r]])&&(n=!0)}return!0}function LB(){return this._isValid}function $B(){return xi(NaN)}function Jm(t){var e=yR(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=kB(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=os(),this._bubble()}function Rg(t){return t instanceof Jm}function tb(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function FB(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)We(t[s])!==We(e[s])&&o++;return o+i}function wN(t,e){we(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+co(~~(n/60),2)+e+co(~~n%60,2)})}wN("Z",":");wN("ZZ","");ue("Z",Xm);ue("ZZ",Xm);dt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=HR(Xm,t)});var VB=/([\+\-]|\d\d)/gi;function HR(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(VB)||["-",0,0],o=+(i[1]*60)+We(i[2]),o===0?0:i[0]==="+"?o:-o)}function AR(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(Mi(t)||pd(t)?t.valueOf():bt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),K.updateOffset(n,!1),n):bt(t).local()}function nb(t){return-Math.round(t._d.getTimezoneOffset())}K.updateOffset=function(){};function WB(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=HR(Xm,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=nb(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?yN(this,xi(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,K.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:nb(this)}function BB(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function jB(t){return this.utcOffset(0,t)}function UB(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(nb(this),"m")),this}function zB(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=HR(cW,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function YB(t){return this.isValid()?(t=t?bt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function GB(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function qB(){if(!sr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return wR(t,this),t=gN(t),t._a?(e=t._isUTC?mo(t._a):bt(t._a),this._isDSTShifted=this.isValid()&&FB(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function KB(){return this.isValid()?!this._isUTC:!1}function XB(){return this.isValid()?this._isUTC:!1}function vN(){return this.isValid()?this._isUTC&&this._offset===0:!1}var ZB=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,QB=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function xi(t,e){var n=t,r=null,i,o,s;return Rg(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:es(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=ZB.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:We(r[io])*i,h:We(r[fn])*i,m:We(r[Ri])*i,s:We(r[zo])*i,ms:We(tb(r[qa]*1e3))*i}):(r=QB.exec(t))?(i=r[1]==="-"?-1:1,n={y:ia(r[2],i),M:ia(r[3],i),w:ia(r[4],i),d:ia(r[5],i),h:ia(r[6],i),m:ia(r[7],i),s:ia(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=JB(bt(n.from),bt(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Jm(n),Rg(t)&&Ze(t,"_locale")&&(o._locale=t._locale),Rg(t)&&Ze(t,"_isValid")&&(o._isValid=t._isValid),o}xi.fn=Jm.prototype;xi.invalid=$B;function ia(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function _P(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function JB(t,e){var n;return t.isValid()&&e.isValid()?(e=AR(e,t),t.isBefore(e)?n=_P(t,e):(n=_P(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function CN(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(q1(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=xi(n,r),yN(this,i,t),this}}function yN(t,e,n,r){var i=e._milliseconds,o=tb(e._days),s=tb(e._months);t.isValid()&&(r=r??!0,s&&iN(t,Wh(t,"Month")+s*n),o&&tN(t,"Date",Wh(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&K.updateOffset(t,o||s))}var ej=CN(1,"add"),tj=CN(-1,"subtract");function SN(t){return typeof t=="string"||t instanceof String}function nj(t){return Mi(t)||pd(t)||SN(t)||es(t)||ij(t)||rj(t)||t===null||t===void 0}function rj(t){var e=tl(t)&&!mR(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||Ze(t,o);return e&&n}function ij(t){var e=_i(t),n=!1;return e&&(n=t.filter(function(r){return!es(r)&&SN(t)}).length===0),e&&n}function oj(t){var e=tl(t)&&!mR(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||Ze(t,o);return e&&n}function sj(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function aj(t,e){arguments.length===1&&(arguments[0]?nj(arguments[0])?(t=arguments[0],e=void 0):oj(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||bt(),r=AR(n,this).startOf("day"),i=K.calendarFormat(this,r)||"sameElse",o=e&&(po(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,bt(n)))}function lj(){return new wd(this)}function uj(t,e){var n=Mi(t)?t:bt(t);return this.isValid()&&n.isValid()?(e=ni(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function cj(t,e){var n=Mi(t)?t:bt(t);return this.isValid()&&n.isValid()?(e=ni(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function hj(t,e,n,r){var i=Mi(t)?t:bt(t),o=Mi(e)?e:bt(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function dj(t,e){var n=Mi(t)?t:bt(t),r;return this.isValid()&&n.isValid()?(e=ni(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function fj(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function gj(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function mj(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=AR(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=ni(e),e){case"year":o=Eg(this,r)/12;break;case"month":o=Eg(this,r);break;case"quarter":o=Eg(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Gr(o)}function Eg(t,e){if(t.date()<e.date())return-Eg(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}K.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";K.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function pj(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function wj(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?bg(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):po(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",bg(n,"Z")):bg(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function vj(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function Cj(t){t||(t=this.isUtc()?K.defaultFormatUtc:K.defaultFormat);var e=bg(this,t);return this.localeData().postformat(e)}function yj(t,e){return this.isValid()&&(Mi(t)&&t.isValid()||bt(t).isValid())?xi({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Sj(t){return this.from(bt(),t)}function bj(t,e){return this.isValid()&&(Mi(t)&&t.isValid()||bt(t).isValid())?xi({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Rj(t){return this.to(bt(),t)}function bN(t){var e;return t===void 0?this._locale._abbr:(e=os(t),e!=null&&(this._locale=e),this)}var RN=ti("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function EN(){return this._locale}var zg=1e3,Iu=60*zg,Yg=60*Iu,TN=(365*400+97)*24*Yg;function Pu(t,e){return(t%e+e)%e}function _N(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-TN:new Date(t,e,n).valueOf()}function MN(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-TN:Date.UTC(t,e,n)}function Ej(t){var e,n;if(t=ni(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?MN:_N,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Pu(e+(this._isUTC?0:this.utcOffset()*Iu),Yg);break;case"minute":e=this._d.valueOf(),e-=Pu(e,Iu);break;case"second":e=this._d.valueOf(),e-=Pu(e,zg);break}return this._d.setTime(e),K.updateOffset(this,!0),this}function Tj(t){var e,n;if(t=ni(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?MN:_N,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Yg-Pu(e+(this._isUTC?0:this.utcOffset()*Iu),Yg)-1;break;case"minute":e=this._d.valueOf(),e+=Iu-Pu(e,Iu)-1;break;case"second":e=this._d.valueOf(),e+=zg-Pu(e,zg)-1;break}return this._d.setTime(e),K.updateOffset(this,!0),this}function _j(){return this._d.valueOf()-(this._offset||0)*6e4}function Mj(){return Math.floor(this.valueOf()/1e3)}function Ij(){return new Date(this.valueOf())}function Pj(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function Oj(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function xj(){return this.isValid()?this.toISOString():null}function Hj(){return pR(this)}function Aj(){return Ls({},Pe(this))}function Nj(){return Pe(this).overflow}function Dj(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}we("N",0,0,"eraAbbr");we("NN",0,0,"eraAbbr");we("NNN",0,0,"eraAbbr");we("NNNN",0,0,"eraName");we("NNNNN",0,0,"eraNarrow");we("y",["y",1],"yo","eraYear");we("y",["yy",2],0,"eraYear");we("y",["yyy",3],0,"eraYear");we("y",["yyyy",4],0,"eraYear");ue("N",NR);ue("NN",NR);ue("NNN",NR);ue("NNNN",Yj);ue("NNNNN",Gj);dt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Pe(n).era=i:Pe(n).invalidEra=t});ue("y",Ku);ue("yy",Ku);ue("yyy",Ku);ue("yyyy",Ku);ue("yo",qj);dt(["y","yy","yyy","yyyy"],Nn);dt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Nn]=n._locale.eraYearOrdinalParse(t,i):e[Nn]=parseInt(t,10)});function kj(t,e){var n,r,i,o=this._eras||os("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=K(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=K(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function Lj(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function $j(t,e){var n=t.since<=t.until?1:-1;return e===void 0?K(t.since).year():K(t.since).year()+(e-t.offset)*n}function Fj(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function Vj(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function Wj(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function Bj(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-K(i[t].since).year())*n+i[t].offset;return this.year()}function jj(t){return Ze(this,"_erasNameRegex")||DR.call(this),t?this._erasNameRegex:this._erasRegex}function Uj(t){return Ze(this,"_erasAbbrRegex")||DR.call(this),t?this._erasAbbrRegex:this._erasRegex}function zj(t){return Ze(this,"_erasNarrowRegex")||DR.call(this),t?this._erasNarrowRegex:this._erasRegex}function NR(t,e){return e.erasAbbrRegex(t)}function Yj(t,e){return e.erasNameRegex(t)}function Gj(t,e){return e.erasNarrowRegex(t)}function qj(t,e){return e._eraYearOrdinalRegex||Ku}function DR(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=Zo(u[i].name),a=Zo(u[i].abbr),l=Zo(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}we(0,["gg",2],0,function(){return this.weekYear()%100});we(0,["GG",2],0,function(){return this.isoWeekYear()%100});function ep(t,e){we(0,[t,t.length],0,e)}ep("gggg","weekYear");ep("ggggg","weekYear");ep("GGGG","isoWeekYear");ep("GGGGG","isoWeekYear");ue("G",Km);ue("g",Km);ue("GG",Rt,xr);ue("gg",Rt,xr);ue("GGGG",bR,SR);ue("gggg",bR,SR);ue("GGGGG",qm,Ym);ue("ggggg",qm,Ym);Cd(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=We(t)});Cd(["gg","GG"],function(t,e,n,r){e[r]=K.parseTwoDigitYear(t)});function Kj(t){return IN.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Xj(t){return IN.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Zj(){return Qo(this.year(),1,4)}function Qj(){return Qo(this.isoWeekYear(),1,4)}function Jj(){var t=this.localeData()._week;return Qo(this.year(),t.dow,t.doy)}function eU(){var t=this.localeData()._week;return Qo(this.weekYear(),t.dow,t.doy)}function IN(t,e,n,r,i){var o;return t==null?jh(this,r,i).year:(o=Qo(t,r,i),e>o&&(e=o),tU.call(this,t,e,n,r,i))}function tU(t,e,n,r,i){var o=aN(t,e,n,r,i),s=Bh(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}we("Q",0,"Qo","quarter");ue("Q",X1);dt("Q",function(t,e){e[Uo]=(We(t)-1)*3});function nU(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}we("D",["DD",2],"Do","date");ue("D",Rt,Xu);ue("DD",Rt,xr);ue("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});dt(["D","DD"],io);dt("Do",function(t,e){e[io]=We(t.match(Rt)[0])});var PN=Zu("Date",!0);we("DDD",["DDDD",3],"DDDo","dayOfYear");ue("DDD",Gm);ue("DDDD",Z1);dt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=We(t)});function rU(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}we("m",["mm",2],0,"minute");ue("m",Rt,RR);ue("mm",Rt,xr);dt(["m","mm"],Ri);var iU=Zu("Minutes",!1);we("s",["ss",2],0,"second");ue("s",Rt,RR);ue("ss",Rt,xr);dt(["s","ss"],zo);var oU=Zu("Seconds",!1);we("S",0,0,function(){return~~(this.millisecond()/100)});we(0,["SS",2],0,function(){return~~(this.millisecond()/10)});we(0,["SSS",3],0,"millisecond");we(0,["SSSS",4],0,function(){return this.millisecond()*10});we(0,["SSSSS",5],0,function(){return this.millisecond()*100});we(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});we(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});we(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});we(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ue("S",Gm,X1);ue("SS",Gm,xr);ue("SSS",Gm,Z1);var $s,ON;for($s="SSSS";$s.length<=9;$s+="S")ue($s,Ku);function sU(t,e){e[qa]=We(("0."+t)*1e3)}for($s="S";$s.length<=9;$s+="S")dt($s,sU);ON=Zu("Milliseconds",!1);we("z",0,0,"zoneAbbr");we("zz",0,0,"zoneName");function aU(){return this._isUTC?"UTC":""}function lU(){return this._isUTC?"Coordinated Universal Time":""}var Q=wd.prototype;Q.add=ej;Q.calendar=aj;Q.clone=lj;Q.diff=mj;Q.endOf=Tj;Q.format=Cj;Q.from=yj;Q.fromNow=Sj;Q.to=bj;Q.toNow=Rj;Q.get=vW;Q.invalidAt=Nj;Q.isAfter=uj;Q.isBefore=cj;Q.isBetween=hj;Q.isSame=dj;Q.isSameOrAfter=fj;Q.isSameOrBefore=gj;Q.isValid=Hj;Q.lang=RN;Q.locale=bN;Q.localeData=EN;Q.max=HB;Q.min=xB;Q.parsingFlags=Aj;Q.set=CW;Q.startOf=Ej;Q.subtract=tj;Q.toArray=Pj;Q.toObject=Oj;Q.toDate=Ij;Q.toISOString=wj;Q.inspect=vj;typeof Symbol<"u"&&Symbol.for!=null&&(Q[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Q.toJSON=xj;Q.toString=pj;Q.unix=Mj;Q.valueOf=_j;Q.creationData=Dj;Q.eraName=Fj;Q.eraNarrow=Vj;Q.eraAbbr=Wj;Q.eraYear=Bj;Q.year=eN;Q.isLeapYear=wW;Q.weekYear=Kj;Q.isoWeekYear=Xj;Q.quarter=Q.quarters=nU;Q.month=oN;Q.daysInMonth=IW;Q.week=Q.weeks=kW;Q.isoWeek=Q.isoWeeks=LW;Q.weeksInYear=Jj;Q.weeksInWeekYear=eU;Q.isoWeeksInYear=Zj;Q.isoWeeksInISOWeekYear=Qj;Q.date=PN;Q.day=Q.days=XW;Q.weekday=ZW;Q.isoWeekday=QW;Q.dayOfYear=rU;Q.hour=Q.hours=oB;Q.minute=Q.minutes=iU;Q.second=Q.seconds=oU;Q.millisecond=Q.milliseconds=ON;Q.utcOffset=WB;Q.utc=jB;Q.local=UB;Q.parseZone=zB;Q.hasAlignedHourOffset=YB;Q.isDST=GB;Q.isLocal=KB;Q.isUtcOffset=XB;Q.isUtc=vN;Q.isUTC=vN;Q.zoneAbbr=aU;Q.zoneName=lU;Q.dates=ti("dates accessor is deprecated. Use date instead.",PN);Q.months=ti("months accessor is deprecated. Use month instead",oN);Q.years=ti("years accessor is deprecated. Use year instead",eN);Q.zone=ti("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",BB);Q.isDSTShifted=ti("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",qB);function uU(t){return bt(t*1e3)}function cU(){return bt.apply(null,arguments).parseZone()}function xN(t){return t}var Qe=vR.prototype;Qe.calendar=KV;Qe.longDateFormat=JV;Qe.invalidDate=tW;Qe.ordinal=iW;Qe.preparse=xN;Qe.postformat=xN;Qe.relativeTime=sW;Qe.pastFuture=aW;Qe.set=GV;Qe.eras=kj;Qe.erasParse=Lj;Qe.erasConvertYear=$j;Qe.erasAbbrRegex=Uj;Qe.erasNameRegex=jj;Qe.erasNarrowRegex=zj;Qe.months=EW;Qe.monthsShort=TW;Qe.monthsParse=MW;Qe.monthsRegex=OW;Qe.monthsShortRegex=PW;Qe.week=HW;Qe.firstDayOfYear=DW;Qe.firstDayOfWeek=NW;Qe.weekdays=zW;Qe.weekdaysMin=GW;Qe.weekdaysShort=YW;Qe.weekdaysParse=KW;Qe.weekdaysRegex=JW;Qe.weekdaysShortRegex=eB;Qe.weekdaysMinRegex=tB;Qe.isPM=rB;Qe.meridiem=sB;function Gg(t,e,n,r){var i=os(),o=mo().set(r,e);return i[n](o,t)}function HN(t,e,n){if(es(t)&&(e=t,t=void 0),t=t||"",e!=null)return Gg(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Gg(t,r,n,"month");return i}function kR(t,e,n,r){typeof t=="boolean"?(es(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,es(e)&&(n=e,e=void 0),e=e||"");var i=os(),o=t?i._week.dow:0,s,a=[];if(n!=null)return Gg(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=Gg(e,(s+o)%7,r,"day");return a}function hU(t,e){return HN(t,e,"months")}function dU(t,e){return HN(t,e,"monthsShort")}function fU(t,e,n){return kR(t,e,n,"weekdays")}function gU(t,e,n){return kR(t,e,n,"weekdaysShort")}function mU(t,e,n){return kR(t,e,n,"weekdaysMin")}Us("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=We(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});K.lang=ti("moment.lang is deprecated. Use moment.locale instead.",Us);K.langData=ti("moment.langData is deprecated. Use moment.localeData instead.",os);var So=Math.abs;function pU(){var t=this._data;return this._milliseconds=So(this._milliseconds),this._days=So(this._days),this._months=So(this._months),t.milliseconds=So(t.milliseconds),t.seconds=So(t.seconds),t.minutes=So(t.minutes),t.hours=So(t.hours),t.months=So(t.months),t.years=So(t.years),this}function AN(t,e,n,r){var i=xi(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function wU(t,e){return AN(this,t,e,1)}function vU(t,e){return AN(this,t,e,-1)}function MP(t){return t<0?Math.floor(t):Math.ceil(t)}function CU(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=MP(rb(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=Gr(t/1e3),r.seconds=i%60,o=Gr(i/60),r.minutes=o%60,s=Gr(o/60),r.hours=s%24,e+=Gr(s/24),l=Gr(NN(e)),n+=l,e-=MP(rb(l)),a=Gr(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function NN(t){return t*4800/146097}function rb(t){return t*146097/4800}function yU(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=ni(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+NN(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(rb(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function ss(t){return function(){return this.as(t)}}var DN=ss("ms"),SU=ss("s"),bU=ss("m"),RU=ss("h"),EU=ss("d"),TU=ss("w"),_U=ss("M"),MU=ss("Q"),IU=ss("y"),PU=DN;function OU(){return xi(this)}function xU(t){return t=ni(t),this.isValid()?this[t+"s"]():NaN}function Cl(t){return function(){return this.isValid()?this._data[t]:NaN}}var HU=Cl("milliseconds"),AU=Cl("seconds"),NU=Cl("minutes"),DU=Cl("hours"),kU=Cl("days"),LU=Cl("months"),$U=Cl("years");function FU(){return Gr(this.days()/7)}var Fo=Math.round,Su={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function VU(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function WU(t,e,n,r){var i=xi(t).abs(),o=Fo(i.as("s")),s=Fo(i.as("m")),a=Fo(i.as("h")),l=Fo(i.as("d")),u=Fo(i.as("M")),c=Fo(i.as("w")),h=Fo(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,VU.apply(null,d)}function BU(t){return t===void 0?Fo:typeof t=="function"?(Fo=t,!0):!1}function jU(t,e){return Su[t]===void 0?!1:e===void 0?Su[t]:(Su[t]=e,t==="s"&&(Su.ss=e-1),!0)}function UU(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Su,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Su,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=WU(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var CC=Math.abs;function Tl(t){return(t>0)-(t<0)||+t}function tp(){if(!this.isValid())return this.localeData().invalidDate();var t=CC(this._milliseconds)/1e3,e=CC(this._days),n=CC(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=Gr(t/60),i=Gr(r/60),t%=60,r%=60,o=Gr(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Tl(this._months)!==Tl(a)?"-":"",c=Tl(this._days)!==Tl(a)?"-":"",h=Tl(this._milliseconds)!==Tl(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var Ye=Jm.prototype;Ye.isValid=LB;Ye.abs=pU;Ye.add=wU;Ye.subtract=vU;Ye.as=yU;Ye.asMilliseconds=DN;Ye.asSeconds=SU;Ye.asMinutes=bU;Ye.asHours=RU;Ye.asDays=EU;Ye.asWeeks=TU;Ye.asMonths=_U;Ye.asQuarters=MU;Ye.asYears=IU;Ye.valueOf=PU;Ye._bubble=CU;Ye.clone=OU;Ye.get=xU;Ye.milliseconds=HU;Ye.seconds=AU;Ye.minutes=NU;Ye.hours=DU;Ye.days=kU;Ye.weeks=FU;Ye.months=LU;Ye.years=$U;Ye.humanize=UU;Ye.toISOString=tp;Ye.toString=tp;Ye.toJSON=tp;Ye.locale=bN;Ye.localeData=EN;Ye.toIsoString=ti("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",tp);Ye.lang=RN;we("X",0,0,"unix");we("x",0,0,"valueOf");ue("x",Km);ue("X",hW);dt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});dt("x",function(t,e,n){n._d=new Date(We(t))});//! moment.js
K.version="2.30.1";zV(bt);K.fn=Q;K.min=AB;K.max=NB;K.now=DB;K.utc=mo;K.unix=uU;K.months=hU;K.isDate=pd;K.locale=Us;K.invalid=zm;K.duration=xi;K.isMoment=Mi;K.weekdays=fU;K.parseZone=cU;K.localeData=os;K.isDuration=Rg;K.monthsShort=dU;K.weekdaysMin=mU;K.defineLocale=IR;K.updateLocale=cB;K.locales=hB;K.weekdaysShort=gU;K.normalizeUnits=ni;K.relativeTimeRounding=BU;K.relativeTimeThreshold=jU;K.calendarFormat=sj;K.prototype=Q;K.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function zU(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function IP(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function Tg(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function pr(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function il(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ve(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function P(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function YU(t){const e=[];return P(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function PP(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return P(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function OP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function tt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return pr(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function It(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function le(t){return typeof t<"u"}function Mt(t){return typeof t>"u"}function Wt(t){return t===null||t===""||Mt(t)}function GU(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const hh="length",Ch=t=>parseInt(t,16),xP=t=>parseInt(t,10),qg=(t,e,n)=>t.substr(e,n),yh=t=>t.codePointAt(0)-65,ib=t=>`${t}`.replace(/\-/g,""),qU=t=>Ch(qg(ib(t),Ch("12"),yh("F")))/(Ch(qg(ib(t),yh("B"),~~![][hh]))||9),KU=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let HP=!1;const AP={invalid:()=>tt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return tt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>tt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},NP={invalid:()=>tt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return tt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>tt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function XU(t,e){const n=!Wt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.0.1";let o,s="invalid",a="invalid";t=ib(t||"");const l=ZU(t);if(n||r||l)if(l){const u=K("10/07/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=qU(t);o=K((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(KU()&&(s="valid",a="valid"),!HP&&s!=="valid"&&(AP[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](AP[s]({keyValidityDate:o,hotVersion:i})),HP=!0),a!=="valid"&&e&&NP[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=NP[a]({keyValidityDate:o,hotVersion:i}),e.appendChild(c)}}function ZU(t){let e=[][hh],n=e;if(t[hh]!==yh("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=yh(i.shift());o;o=yh(i.shift()||"A"))--o<""[hh]?n=n|(xP(`${xP(Ch(r)+(Ch(qg(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=qg(t,o,o?i[hh]===1?9:8:6);return n===e}function Ii(t){return t[0].toUpperCase()+t.substr(1)}function kN(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function LN(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function $N(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function DP(t){return LR(`${t}`,{ALLOWED_TAGS:[]})}function LR(t,e){return UV.sanitize(t,e)}const Js=t=>["tabindex",t],QU=()=>["role","treegrid"],Yo=()=>["role","presentation"],JU=()=>["role","gridcell"],ez=()=>["role","gridcell button"],tz=()=>["role","rowheader"],FN=()=>["role","rowgroup"],nz=()=>["role","columnheader"],VN=()=>["role","row"],rz=()=>["role","menu"],iz=()=>["role","menuitem"],oz=()=>["role","menuitemcheckbox"],sz=()=>["role","combobox"],WN=()=>["role","listbox"],az=()=>["role","option"],lz=()=>["role","checkbox"],uz=()=>["scope","col"],cz=()=>["scope","row"],hz=()=>["type","text"],Du=t=>["aria-label",t],yl=()=>["aria-hidden","true"],dz=()=>["aria-disabled","true"],fz=()=>["aria-multiselectable","true"],BN=t=>["aria-haspopup",t],jN=t=>["aria-rowcount",t],np=t=>["aria-colcount",t],UN=t=>["aria-rowindex",t],$R=t=>["aria-colindex",t],Xr=t=>["aria-expanded",t],gz=t=>["aria-sort",t],kP=()=>["aria-readonly","true"],LP=()=>["aria-invalid","true"],zN=t=>["aria-checked",t],FR=()=>["aria-selected","true"],mz=()=>["aria-autocomplete","list"],pz=t=>["aria-controls",t],wz=t=>["aria-activedescendant",t],vz=t=>["aria-live",t],Cz=t=>["aria-relevant",t],yz=t=>["aria-setsize",t],Sz=t=>["aria-posinset",t];var $P={},yC,FP;function bz(){if(FP)return yC;FP=1;var t=qt(),e=_1(),n=on(),r=gl(),i=Um(),o=t([].push);return yC=function(s){if(n(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||r(c)==="Number"||r(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(f,m){if(d)return d=!1,m;if(e(this))return m;for(var v=0;v<h;v++)if(l[v]===f)return m}}},yC}var VP;function Rz(){if(VP)return $P;VP=1;var t=gt(),e=Uu(),n=fd(),r=rn(),i=qt(),o=nn(),s=on(),a=tR(),l=gR(),u=bz(),c=eR(),h=String,d=e("JSON","stringify"),f=i(/./.exec),m=i("".charAt),v=i("".charCodeAt),S=i("".replace),R=i(1.1.toString),w=/[\uD800-\uDFFF]/g,_=/^[\uD800-\uDBFF]$/,O=/^[\uDC00-\uDFFF]$/,L=!c||o(function(){var q=e("Symbol")("stringify detection");return d([q])!=="[null]"||d({a:q})!=="{}"||d(Object(q))!=="{}"}),M=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),x=function(q,A){var Z=l(arguments),X=u(A);if(!(!s(X)&&(q===void 0||a(q))))return Z[1]=function(oe,ee){if(s(X)&&(ee=r(X,this,h(oe),ee)),!a(ee))return ee},n(d,null,Z)},z=function(q,A,Z){var X=m(Z,A-1),oe=m(Z,A+1);return f(_,q)&&!f(O,oe)||f(O,q)&&!f(_,X)?"\\u"+R(v(q,0),16):q};return d&&t({target:"JSON",stat:!0,arity:3,forced:L||M},{stringify:function(A,Z,X){var oe=l(arguments),ee=n(L?x:d,null,oe);return M&&typeof ee=="string"?S(ee,w,z):ee}}),$P}Rz();function zh(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ne(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=zh(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[zh(n[0])]:e[r]=[]:e[r]=null)})),e}function Ez(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function tn(t,e,n){const r=Array.isArray(n);return Ne(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function rp(t,e){Ne(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),rp(t[r],e[r])):t[r]=e[r]})}function qn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function ho(t){const e={};return Ne(t,(n,r)=>{e[r]=n}),e}function ct(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return P(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Ne(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=m=>{let v=m;return(Array.isArray(v)||Ae(v))&&(v=qn(v)),v};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function VR(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Ae(t){return Object.prototype.toString.call(t)==="[object Object]"}function as(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Ne(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function Tz(t,e){const n=e.split(".");let r=t;return Ne(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function SC(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(Jt(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function WR(t){if(!Ae(t))return 0;const e=function(n){let r=0;return Ae(n)?Ne(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Or(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function Jt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Kg(t){return window.requestAnimationFrame(t)}function Xg(t){window.cancelAnimationFrame(t)}function YN(){return"ontouchstart"in window}function _z(){return typeof window<"u"}let _l;function Mz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return _l||(typeof Intl=="object"?_l=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?_l=(n,r)=>`${n}`.localeCompare(r):_l=(n,r)=>n===r?0:n>r?-1:1,_l)}const Wr=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},ea={chrome:Wr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Wr(t=>/CriOS/.test(t)),edge:Wr(t=>/Edge/.test(t)),edgeWebKit:Wr(t=>/EdgiOS/.test(t)),firefox:Wr(t=>/Firefox/.test(t)),firefoxWebKit:Wr(t=>/FxiOS/.test(t)),mobile:Wr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Wr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},yd={mac:Wr(t=>/^Mac/.test(t)),win:Wr(t=>/^Win/.test(t)),linux:Wr(t=>/^Linux/.test(t)),ios:Wr(t=>/iPhone|iPad|iPod/i.test(t))};function Iz(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ne(ea,n=>{let{test:r}=n;return void r(t,e)})}function Pz(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ne(yd,e=>{let{test:n}=e;return void n(t)})}_z()&&(Iz(),Pz());function GN(){return ea.chrome.value}function Oz(){return ea.chromeWebKit.value}function bC(){return ea.firefox.value}function xz(){return ea.firefoxWebKit.value}function Yh(){return ea.safari.value}function Hz(){return ea.edge.value}function lo(){return ea.mobile.value}function qN(){return yd.ios.value}function KN(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&yd.mac.value}function ob(){return yd.win.value}function WP(){return yd.mac.value}function Az(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function _g(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function Nz(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function ku(t){return Nz(t)&&t.parent}function ol(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Wd(t,e,n){const r=[];let i=t;for(;i&&(i=ol(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function Dz(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function nl(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function kz(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function oa(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function XN(t){return!t||!t.length?[]:t.filter(e=>!!e)}function ZN(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function Ce(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function G(t,e){typeof e=="string"&&(e=e.split(" ")),e=XN(e),e.length>0&&t.classList.add(...e)}function pe(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=ZN(e,!0);n=XN(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function ve(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Qu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=ZN(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function QN(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)QN(e[n])}}function ts(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const Lz=/(<(.*)>|&(.*);)/;function Ju(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Lz.test(e)?t.innerHTML=n?LR(e):e:sl(t,e)}function sl(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(ts(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Lu(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return Lu(r.host.impl);if(r.host)return Lu(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function $z(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function An(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function JN(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function BR(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function jR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?JN(e):t.scrollTop}function eD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?BR(e):t.scrollLeft}function Zg(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function Fz(t){return t.scrollHeight-t.clientHeight}function Vz(t){return t.scrollWidth-t.clientWidth}function Gh(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function Qg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function Yt(t){return t.offsetWidth}function en(t){return t.offsetHeight}function Sh(t){return t.clientHeight||t.innerHeight}function tD(t){return t.clientWidth||t.innerWidth}function nD(t){return t.selectionStart?t.selectionStart:0}function Wz(t){return t.selectionEnd?t.selectionEnd:0}function BP(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function ip(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let RC;function rD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return ob()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function Bz(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");Yh()&&!lo()&&n.classList.add("htScrollbarSafariTest"),n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i+rD(t)}function Cn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return RC===void 0&&(RC=Bz(t)),RC}function iD(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function oD(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function UR(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function op(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Mg(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function sD(t){return Mg(t)&&t.hasAttribute("data-hot-input")===!1}function aD(t){return!t.parentNode}function jz(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function lD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();ve(t,"contenteditable",!0),n&&ve(t,...yl()),e&&G(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function uD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&pe(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function Uz(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;lD(t,n),e(),uD(t,n)}function Jo(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}function it(t){return typeof t=="function"}function sp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function cD(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function zz(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function sb(t,e,n,r,i,o,s,a){return le(a)?t.call(e,n,r,i,o,s,a):le(s)?t.call(e,n,r,i,o,s):le(o)?t.call(e,n,r,i,o):le(i)?t.call(e,n,r,i):le(r)?t.call(e,n,r):le(n)?t.call(e,n):t.call(e)}const ge={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:bC()?182:174,AUDIO_MUTE:bC()?181:173,AUDIO_UP:bC()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Yz=[ge.ALT,ge.ARROW_DOWN,ge.ARROW_LEFT,ge.ARROW_RIGHT,ge.ARROW_UP,ge.AUDIO_DOWN,ge.AUDIO_MUTE,ge.AUDIO_UP,ge.BACKSPACE,ge.CAPS_LOCK,ge.DELETE,ge.END,ge.ENTER,ge.ESCAPE,ge.F1,ge.F2,ge.F3,ge.F4,ge.F5,ge.F6,ge.F7,ge.F8,ge.F9,ge.F10,ge.F11,ge.F12,ge.F13,ge.F14,ge.F15,ge.F16,ge.F17,ge.F18,ge.F19,ge.HOME,ge.INSERT,ge.MEDIA_NEXT,ge.MEDIA_PLAY_PAUSE,ge.MEDIA_PREV,ge.MEDIA_STOP,ge.NULL,ge.NUM_LOCK,ge.PAGE_DOWN,ge.PAGE_UP,ge.PAUSE,ge.SCROLL_LOCK,ge.SHIFT,ge.TAB];function Gz(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function hD(t){return Yz.includes(t)}function qz(t){return[ge.CONTROL,ge.COMMAND_LEFT,ge.COMMAND_RIGHT,ge.COMMAND_FIREFOX].includes(t)}function Sd(t,e){const n=e.split("|");let r=!1;return P(n,i=>{if(t===ge[i])return r=!0,!1}),r}function Hi(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function za(t){return t.isImmediatePropagationEnabled===!1}function al(t){return t.button===2}function zR(t){return t.button===0}function Kz(t){return t instanceof TouchEvent}function Xz(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!Jo(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}function qe(){le(console)&&console.warn(...arguments)}function YR(){le(console)&&console.error(...arguments)}const Ya=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],EC=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),TC=new Map([[]]);var jP={},_C,UP;function Zz(){if(UP)return _C;UP=1;var t=Gu();return _C=function(e,n,r){for(var i=0,o=arguments.length>2?r:t(n),s=new e(o);o>i;)s[i]=n[i++];return s},_C}var MC,zP;function Qz(){if(zP)return MC;zP=1;var t=Gt();return MC=function(e,n){var r=t[e],i=r&&r.prototype;return i&&i[n]},MC}var IC,YP;function ap(){if(YP)return IC;YP=1;var t=Oi(),e=hR(),n=Zs().f,r=t("unscopables"),i=Array.prototype;return i[r]===void 0&&n(i,r,{configurable:!0,value:e(null)}),IC=function(o){i[r][o]=!0},IC}var GP;function Jz(){if(GP)return jP;GP=1;var t=gt(),e=qt(),n=gr(),r=ud(),i=Zz(),o=Qz(),s=ap(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&n(c);var h=r(this),d=i(a,h);return l(d,c)}}),s("toSorted"),jP}Jz();var qP={},KP={},XP;function eY(){if(XP)return KP;XP=1;var t=gt(),e=rn(),n=qu(),r=gr(),i=sn(),o=go(),s=mr(),a=Qs(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,m){if(c(f,d++))return m(f)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),KP}var ZP;function tY(){return ZP||(ZP=1,eY()),qP}tY();function nY(t,e){dD(t,e),e.add(t)}function PC(t,e,n){dD(t,e),e.set(t,n)}function dD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QP(t,e,n){return t.set(Jg(t,e),n),n}function Sn(t,e){return t.get(Jg(t,e))}function Jg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const rY=100;var yr=new WeakMap,du=new WeakMap,OC=new WeakMap,xC=new WeakSet;class JP{constructor(){nY(this,xC),PC(this,yr,new Map),PC(this,du,new Map),PC(this,OC,new Set),Ya.forEach(e=>Jg(xC,this,eO).call(this,e))}getHooks(e){var n;return(n=Sn(yr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Sn(yr,this).has(e)||(Jg(xC,this,eO).call(this,e),Ya.push(e));const i=Sn(yr,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=Sn(OC,this).has(e);!u&&o!==0&&(u=!0,Sn(OC,this).add(e)),u&&i.length>1&&Sn(yr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return Sn(yr,this).has(e)&&Sn(yr,this).get(e).length>0}remove(e,n){if(!Sn(yr,this).has(e))return!1;const r=Sn(yr,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=Sn(du,this).get(e);return i.skip=!0,o+=1,o>rY&&(Sn(yr,this).set(e,r.filter(s=>!s.skip)),o=0),Sn(du,this).set(e,o),!0}return!1}destroy(){Sn(yr,this).clear(),Sn(du,this).clear(),QP(yr,this,null),QP(du,this,null)}}function eO(t){Sn(yr,this).set(t,[]),Sn(du,this).set(t,0)}function iY(t,e,n){return(e=oY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oY(t){var e=sY(t,"string");return typeof e=="symbol"?e:e+""}function sY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const aY=tt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class ne{constructor(){iY(this,"globalBucket",new JP)}static getSingleton(){return uY()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new JP),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?P(n,o=>this.add(e,o,r)):(EC.has(e)&&qe($N(aY,{hookName:e,removedInVersion:EC.get(e)})),TC.has(e)&&qe(TC.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?P(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?P(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=sb(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=sb(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Ya.push(e)}deregister(e){this.isRegistered(e)&&Ya.splice(Ya.indexOf(e),1)}isDeprecated(e){return TC.has(e)||EC.has(e)}isRegistered(e){return Ya.indexOf(e)>=0}getRegistered(){return Ya}}const lY=new ne;function uY(){return lY}const Ka=new Map;function ri(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Ka.has(t)||Ka.set(t,new Map);const e=Ka.get(t);function n(l,u){e.set(l,u)}function r(l){return e.get(l)}function i(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}function a(){Ka.delete(t),e.clear()}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s,clear:a}}function cY(t,e){var n;return Ka==null||(n=Ka.get(t.guid))===null||n===void 0?void 0:n.get(e)}const ab=new WeakMap,{register:hY,getItem:fD,hasItem:gD,getNames:fue,getValues:gue}=ri("editors");function dY(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},ne.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function mD(t,e){let n;if(typeof t=="function")ab.get(t)||br(null,t),n=ab.get(t);else if(typeof t=="string")n=fD(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function lb(t){if(typeof t=="function")return t;if(!gD(t))throw Error(`No registered editor found under "${t}" name`);return fD(t).getConstructor()}function br(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new dY(e);typeof t=="string"&&hY(t,n),ab.set(e,n)}function fY(t,e,n){return(e=gY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gY(t){var e=mY(t,"string");return typeof e=="symbol"?e:e+""}function mY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;fY(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,pY(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function pY(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Hi(this)},t}function wY(t,e){vY(t,e),e.add(t)}function vY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sa(t,e,n){return(e=CY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CY(t){var e=yY(t,"string");return typeof e=="symbol"?e:e+""}function yY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bd=new WeakSet;class ub{constructor(e,n,r){wY(this,Bd),sa(this,"hot",void 0),sa(this,"tableMeta",void 0),sa(this,"selection",void 0),sa(this,"eventManager",void 0),sa(this,"destroyed",!1),sa(this,"activeEditor",void 0),sa(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Pi(e),this.hot.addHook("afterDocumentKeyDown",i=>HC(Bd,this,tO).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>HC(Bd,this,tO).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>HC(Bd,this,SY).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=mD(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function tO(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||za(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!hD(n)&&!qz(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function SY(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const nO=new WeakMap;ub.getInstance=function(t,e,n){let r=nO.get(t);return r||(r=new ub(t,e,n),nO.set(t,r)),r};function bY(t,e){pD(t,e),e.add(t)}function pc(t,e,n){pD(t,e),e.set(t,n)}function pD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pt(t,e){return t.get(jo(t,e))}function wc(t,e,n){return t.set(jo(t,e),n),n}function jo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ou=Object.freeze({CELL:"cell",MIXED:"mixed"});var Qt=new WeakMap,jd=new WeakMap,Ud=new WeakMap,zd=new WeakMap,Yd=new WeakMap,Ps=new WeakSet;class RY{constructor(e){var n=this;bY(this,Ps),pc(this,Qt,void 0),pc(this,jd,void 0),pc(this,Ud,1),pc(this,zd,null),pc(this,Yd,new Map);const r=e.getSettings();wc(Qt,this,e),wc(jd,this,r.imeFastEdit?Ou.MIXED:Ou.CELL),pt(Qt,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return jo(Ps,n,TY).call(n,...o)}),pt(Qt,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return jo(Ps,n,rO).call(n,...o)}),pt(Qt,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return jo(Ps,n,rO).call(n,...o)}),pt(Qt,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return jo(Ps,n,EY).call(n,...o)})}getFocusMode(){return pt(jd,this)}setFocusMode(e){Object.values(Ou).includes(e)?wc(jd,this,e):qe(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return pt(Ud,this)}setRefocusDelay(e){wc(Ud,this,e)}setRefocusElementGetter(e){wc(zd,this,e)}getRefocusElement(){var e;return typeof pt(zd,this)=="function"?pt(zd,this).call(this):(e=pt(Qt,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=pt(Qt,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=pt(Qt,this).runHooks("modifyFocusedElement",s.row,s.col,r);Jo(a)||(a=r),a&&!((o=pt(Qt,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):jo(Ps,this,GR).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pt(Ud,this);if(pt(Qt,this).getSettings().imeFastEdit&&!((e=pt(Qt,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=pt(Qt,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),pt(Yd,this).has(n)||pt(Yd,this).set(n,sp(()=>{if(!pt(Qt,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),pt(Yd,this).get(n)()}}}function GR(t){var e;const n=(e=pt(Qt,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!pt(Qt,this).selection.isCellVisible(n)){t(null);return}const r=pt(Qt,this).getCell(n.row,n.col,!0);r===null?pt(Qt,this).addHookOnce("afterScroll",()=>{t(pt(Qt,this).getCell(n.row,n.col,!0))}):t(r)}function rO(){jo(Ps,this,GR).call(this,t=>{const{activeElement:e}=pt(Qt,this).rootDocument;e&&sD(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function EY(){jo(Ps,this,GR).call(this,t=>{this.getFocusMode()===Ou.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function TY(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Ou.MIXED:Ou.CELL)}var iO={},AC,oO;function _Y(){if(oO)return AC;oO=1;var t=Jr(),e=gl(),n=Oi(),r=n("match");return AC=function(i){var o;return t(i)&&((o=i[r])!==void 0?!!o:e(i)==="RegExp")},AC}var NC,sO;function MY(){if(sO)return NC;sO=1;var t=Gt(),e=nn(),n=t.RegExp,r=!e(function(){var i=!0;try{n(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,f){Object.defineProperty(o,d,{get:function(){return s+=f,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(n.prototype,"flags").get.call(o);return h!==a||s!==a});return NC={correct:r},NC}var DC,aO;function IY(){if(aO)return DC;aO=1;var t=sn();return DC=function(){var e=t(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},DC}var kC,lO;function PY(){if(lO)return kC;lO=1;var t=rn(),e=ei(),n=cd(),r=MY(),i=IY(),o=RegExp.prototype;return kC=r.correct?function(s){return s.flags}:function(s){return!r.correct&&n(o,s)&&!e(s,"flags")?t(i,s):s.flags},kC}var LC,uO;function OY(){if(uO)return LC;uO=1;var t=qt(),e=zu(),n=Math.floor,r=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return LC=function(l,u,c,h,d,f){var m=c+l.length,v=h.length,S=a;return d!==void 0&&(d=e(d),S=s),i(f,S,function(R,w){var _;switch(r(w,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,m);case"<":_=d[o(w,1,-1)];break;default:var O=+w;if(O===0)return R;if(O>v){var L=n(O/10);return L===0?R:L<=v?h[L-1]===void 0?r(w,1):h[L-1]+r(w,1):R}_=h[O-1]}return _===void 0?"":_})},LC}var cO;function xY(){if(cO)return iO;cO=1;var t=gt(),e=rn(),n=qt(),r=ld(),i=on(),o=Jr(),s=_Y(),a=Um(),l=hd(),u=PY(),c=OY(),h=Oi(),d=Xs(),f=h("replace"),m=TypeError,v=n("".indexOf),S=n("".replace),R=n("".slice),w=Math.max;return t({target:"String",proto:!0},{replaceAll:function(O,L){var M=r(this),x,z,q,A,Z,X,oe,ee,ae,ht,Ie=0,De="";if(o(O)){if(x=s(O),x&&(z=a(r(u(O))),!~v(z,"g")))throw new m("`.replaceAll` does not allow non-global regexes");if(q=l(O,f),q)return e(q,O,M,L);if(d&&x)return S(a(M),O,L)}for(A=a(M),Z=a(O),X=i(L),X||(L=a(L)),oe=Z.length,ee=w(1,oe),ae=v(A,Z);ae!==-1;)ht=X?a(L(Z,ae,A)):c(Z,A,ae,[],void 0,L),De+=R(A,Ie,ae)+ht,Ie=ae+oe,ae=ae+ee>A.length?-1:v(A,Z,ae+ee);return Ie<A.length&&(De+=R(A,Ie)),De}}),iO}xY();var hO={},dO={},fO;function HY(){if(fO)return dO;fO=1;var t=gt(),e=qu(),n=gr(),r=sn(),i=go(),o=mr(),s=Qs(),a=fd(),l=nn(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(f){r(this);try{n(f)}catch(w){o(this,"throw",w)}var m=arguments.length<2,v=m?void 0:arguments[1];if(h)return a(h,this,m?[f]:[f,v]);var S=i(this),R=0;if(e(S,function(w){m?(m=!1,v=w):v=f(v,w,R),R++},{IS_RECORD:!0}),m)throw new u("Reduce of empty iterator with no initial value");return v}}),dO}var gO;function AY(){return gO||(gO=1,HY()),hO}AY();const wD={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},NY=new RegExp(Object.keys(wD).map(t=>`(${t})`).join("|"),"gi");function DY(t){return(t&&t.nodeName||"")==="TABLE"}function mO(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,m=[];for(let S=0;S<s;S+=1){const R=!f&&n&&S===0;let w="";if(f)w=`<th>${t.getColHeader(S-c)}</th>`;else if(R)w=`<th>${t.getRowHeader(d-h)}</th>`;else{const _=i[d][S],{hidden:O,rowspan:L,colspan:M}=t.getCellMeta(d-h,S-c);if(!O){const x=[];if(L&&x.push(`rowspan="${L}"`),M&&x.push(`colspan="${M}"`),Wt(_))w=`<td ${x.join(" ")}></td>`;else{const z=_.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");w=`<td ${x.join(" ")}>${z}</td>`}}}m.push(w)}const v=["<tr>",...m,"</tr>"].join("");f?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function pO(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Wt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function kY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const _=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,O=>{const L=O.match(/<td\b[^>]*?>/g)[0],M=/<p.*?>/g,x=O.substring(L.length,O.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(M,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${L}${x}</td>`});i.insertAdjacentHTML("afterbegin",`${_}`),o=i.querySelector("table")}if(!o||!DY(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((_,O)=>_+O.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,m=0;if(o.tHead){const _=Array.from(o.tHead.rows).filter(O=>{const L=O.querySelector("td")!==null;return L&&h.push(O),!L});f=_.length,d=f>0,f>1?n.nestedHeaders=Array.from(_).reduce((O,L)=>{const M=Array.from(L.cells).reduce((x,z,q)=>{if(a&&q===0)return x;const{colSpan:A,innerHTML:Z}=z,X=A>1?{label:Z,colspan:A}:Z;return x.push(X),x},[]);return O.push(M),O},[]):d&&(n.colHeaders=Array.from(_[0].children).reduce((O,L,M)=>(a&&M===0||O.push(L.innerHTML),O),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const v=[...h,...Array.from(o.tBodies).reduce((_,O)=>(_.push(...Array.from(O.rows)),_),[]),...c];m=v.length;const S=new Array(m);for(let _=0;_<m;_++)S[_]=new Array(u);const R=[],w=[];for(let _=0;_<m;_++){const O=v[_],L=Array.from(O.cells),M=L.length;for(let x=0;x<M;x++){const z=L[x],{nodeName:q,innerHTML:A,rowSpan:Z,colSpan:X}=z,oe=S[_].findIndex(ee=>ee===void 0);if(q==="TD"){if(Z>1||X>1){for(let Ie=_;Ie<_+Z;Ie++)if(Ie<m)for(let De=oe;De<oe+X;De++)S[Ie][De]=null;const ae=z.getAttribute("style");ae&&ae.includes("mso-ignore:colspan")||R.push({col:oe,row:_,rowspan:Z,colspan:X})}let ee="";s&&/excel/gi.test(s.content)?ee=A.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ee=A.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[_][oe]=ee.replace(NY,ae=>wD[ae])}else w.push(A)}}return R.length&&(n.mergeCells=R),w.length&&(n.rowHeaders=w),S.length&&(n.data=S),n}function zn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function LY(t){return zn(t,[","])}function he(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function wO(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function vD(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Be(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const cb="asc",$Y="desc",vO=new Map([[cb,[-1,1]],[$Y,[1,-1]]]),FY=t=>`The priority '${t}' is already declared in a map.`,VY=t=>`The priority '${t}' is not a number.`;function WY(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=it(t)?t:FY,e=it(e)?e:VY;function r(o,s){if(!zn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:cb;const[s,a]=vO.get(o)||vO.get(cb);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const BY=t=>`The id '${t}' is already declared in a map.`;function lp(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=it(t)?t:BY;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const jY=t=>`'${t}' value is already declared in a unique set.`;function UY(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=it(t)?t:jY;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const qR=t=>`There is already registered "${t}" plugin.`,zY=t=>`There is already registered plugin on priority "${t}".`,YY=t=>`The priority "${t}" is not a number.`,CD=WY({errorPriorityExists:zY,errorPriorityNaN:YY}),yD=UY({errorItemExists:qR}),hb=lp({errorIdExists:qR});function SD(){return[...CD.getItems(),...yD.getItems()]}function KR(t){const e=Ii(t);return hb.getItem(e)}function GY(t){return!!KR(t)}function je(t,e,n){[t,e,n]=KY(t,e,n),KR(t)===void 0&&qY(t,e,n)}function qY(t,e,n){const r=Ii(t);if(hb.hasItem(r))throw new Error(qR(r));n===void 0?yD.addItem(r):CD.addItem(n,r),hb.addItem(r,e)}function KY(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:XY,getItem:ZY,hasItem:bD,getNames:mue,getValues:pue}=ri("renderers");function db(t){if(typeof t=="function")return t;if(!bD(t))throw Error(`No registered renderer found under "${t}" name`);return ZY(t)}function Fr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),XY(t,e)}const{register:QY,getItem:JY,hasItem:RD,getNames:wue,getValues:vue}=ri("validators");function eG(t){if(typeof t=="function")return t;if(!RD(t))throw Error(`No registered validator found under "${t}" name`);return JY(t)}function fu(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),QY(t,e)}var CO={},yO;function tG(){if(yO)return CO;yO=1;var t=gt(),e=zu(),n=Gu(),r=dd(),i=ap();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=n(a),u=r(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),CO}tG();var SO={},bO;function nG(){if(bO)return SO;bO=1;var t=gt(),e=qt(),n=ld(),r=dd(),i=Um(),o=nn(),s=e("".charAt),a=o(function(){return"ð ®·".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(n(this)),h=c.length,d=r(u),f=d>=0?d:h+d;return f<0||f>=h?void 0:s(c,f)}}),SO}nG();function vc(t,e,n){return(e=rG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rG(t){var e=iG(t,"string");return typeof e=="symbol"?e:e+""}function iG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oG{constructor(){vc(this,"count",0),vc(this,"startColumn",null),vc(this,"endColumn",null),vc(this,"startPosition",null),vc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=u[this.endColumn]+c-u[this.startColumn-1];if(m<=i&&(this.startColumn-=1),m>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Cc(t,e,n){return(e=sG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sG(t){var e=aG(t,"string");return typeof e=="symbol"?e:e+""}function aG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lG{constructor(){Cc(this,"count",0),Cc(this,"startRow",null),Cc(this,"endRow",null),Cc(this,"startPosition",null),Cc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function yc(t,e,n){return(e=uG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uG(t){var e=cG(t,"string");return typeof e=="symbol"?e:e+""}function cG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ED{constructor(){yc(this,"count",0),yc(this,"startColumn",null),yc(this,"endColumn",null),yc(this,"startPosition",null),yc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Sc(t,e,n){return(e=hG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hG(t){var e=dG(t,"string");return typeof e=="symbol"?e:e+""}function dG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TD{constructor(){Sc(this,"count",0),Sc(this,"startRow",null),Sc(this,"endRow",null),Sc(this,"startPosition",null),Sc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function bc(t,e,n){return(e=fG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fG(t){var e=gG(t,"string");return typeof e=="symbol"?e:e+""}function gG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mG{constructor(){bc(this,"count",0),bc(this,"startColumn",0),bc(this,"endColumn",0),bc(this,"startPosition",0),bc(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function Rc(t,e,n){return(e=pG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pG(t){var e=wG(t,"string");return typeof e=="symbol"?e:e+""}function wG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vG{constructor(){Rc(this,"count",0),Rc(this,"startRow",0),Rc(this,"endRow",0),Rc(this,"startPosition",0),Rc(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function RO(t,e,n){return(e=CG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CG(t){var e=yG(t,"string");return typeof e=="symbol"?e:e+""}function yG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SG extends ED{constructor(){super(...arguments),RO(this,"columnStartOffset",0),RO(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function EO(t,e,n){return(e=bG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bG(t){var e=RG(t,"string");return typeof e=="symbol"?e:e+""}function RG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EG extends TD{constructor(){super(...arguments),EO(this,"rowStartOffset",0),EO(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function TO(t,e,n){return(e=TG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TG(t){var e=_G(t,"string");return typeof e=="symbol"?e:e+""}function _G(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _D{constructor(e){TO(this,"calculationTypes",[]),TO(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function si(t,e,n){return(e=MG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MG(t){var e=IG(t,"string");return typeof e=="symbol"?e:e+""}function IG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $u=50;class PG extends _D{constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),si(this,"viewportWidth",0),si(this,"scrollOffset",0),si(this,"zeroBasedScrollOffset",0),si(this,"totalColumns",0),si(this,"columnWidthFn",null),si(this,"columnWidth",0),si(this,"overrideFn",null),si(this,"inlineStartOffset",0),si(this,"totalCalculatedWidth",0),si(this,"startPositions",[]),si(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?$u:n}}function Ar(t,e,n){return(e=OG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OG(t){var e=xG(t,"string");return typeof e=="symbol"?e:e+""}function xG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HG extends _D{constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),Ar(this,"viewportHeight",0),Ar(this,"scrollOffset",0),Ar(this,"zeroBasedScrollOffset",0),Ar(this,"totalRows",0),Ar(this,"rowHeightFn",null),Ar(this,"rowHeight",0),Ar(this,"overrideFn",null),Ar(this,"horizontalScrollbarHeight",0),Ar(this,"innerViewportHeight",0),Ar(this,"totalCalculatedHeight",0),Ar(this,"startPositions",[]),Ar(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function AG(t,e,n){NG(t,e),e.set(t,n)}function NG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _O(t,e,n){return(e=DG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DG(t){var e=kG(t,"string");return typeof e=="symbol"?e:e+""}function kG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ml(t,e){return t.get(MD(t,e))}function MO(t,e,n){return t.set(MD(t,e),n),n}function MD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var bo=new WeakMap;class ll{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;_O(this,"row",null),_O(this,"col",null),AG(this,bo,!1),MO(bo,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Ml(bo,this)}isSouthEastOf(e){return this.row>=e.row&&(Ml(bo,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Ml(bo,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Ml(bo,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Ml(bo,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof ll&&MO(bo,this,e.isRtl()),this}clone(){return new ll(this.row,this.col,Ml(bo,this))}toObject(){return{row:this.row,col:this.col}}}function LG(t,e,n){$G(t,e),e.set(t,n)}function $G(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $C(t,e,n){return(e=FG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FG(t){var e=VG(t,"string");return typeof e=="symbol"?e:e+""}function VG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nr(t,e){return t.get(ID(t,e))}function WG(t,e,n){return t.set(ID(t,e),n),n}function ID(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Qn=new WeakMap;class bd{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;$C(this,"highlight",null),$C(this,"from",null),$C(this,"to",null),LG(this,Qn,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),WG(Qn,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Nr(Qn,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Nr(Qn,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Nr(Qn,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Nr(Qn,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Nr(Qn,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Nr(Qn,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Nr(Qn,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Nr(Qn,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof ll))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(Nr(Qn,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(Nr(Qn,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new bd(this.highlight,this.from,this.to,Nr(Qn,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new ll(e,n,Nr(Qn,this))}}function Ni(t,e,n){BG(t,e),e.set(t,n)}function BG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function de(t,e){return t.get(PD(t,e))}function cs(t,e,n){return t.set(PD(t,e),n),n}function PD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Dr=new WeakMap,FC=new WeakMap,pn=new WeakMap,Il=new WeakMap,Gd=new WeakMap,ai=new WeakMap,VC=new WeakMap,Ec=new WeakMap,aa=new WeakMap,Di=new WeakMap;let OD=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Ni(this,Dr,void 0),Ni(this,FC,void 0),Ni(this,pn,void 0),Ni(this,Il,void 0),Ni(this,Gd,void 0),Ni(this,ai,void 0),Ni(this,VC,void 0),Ni(this,Ec,void 0),Ni(this,aa,[null,null]),Ni(this,Di,[null,null]),cs(Dr,this,r),cs(FC,this,n),cs(pn,this,o),cs(Il,this,s),cs(Gd,this,a),cs(ai,this,i),cs(VC,this,e),this.registerEvents()}registerEvents(){de(ai,this).addEventListener(de(pn,this).holder,"contextmenu",r=>this.onContextMenu(r)),de(ai,this).addEventListener(de(pn,this).TABLE,"mouseover",r=>this.onMouseOver(r)),de(ai,this).addEventListener(de(pn,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{de(ai,this).addEventListener(de(pn,this).holder,"touchstart",r=>this.onTouchStart(r)),de(ai,this).addEventListener(de(pn,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),de(ai,this).addEventListener(de(pn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||de(Dr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,de(Dr,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{de(ai,this).addEventListener(de(pn,this).holder,"mouseup",r=>this.onMouseUp(r)),de(ai,this).addEventListener(de(pn,this).holder,"mousedown",r=>this.onMouseDown(r))};lo()?e():(YN()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(de(Ec,this)&&r){const[i,o]=[r.row,de(Ec,this).from.row],[s,a]=[r.col,de(Ec,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=de(pn,this).TABLE,i=Wd(e,["TD","TH"],r);return i?(n.coords=de(pn,this).getCoords(i),n.TD=i):Ce(e,"wtBorder")&&Ce(e,"current")?(n.coords=de(Il,this).getFocusSelection().cellRange.highlight,n.TD=de(pn,this).getCell(n.coords)):Ce(e,"wtBorder")&&Ce(e,"area")&&de(Il,this).getAreaSelection().cellRange&&(n.coords=de(Il,this).getAreaSelection().cellRange.to,n.TD=de(pn,this).getCell(n.coords)),n}onMouseDown(e){const n=de(FC,this).rootDocument.activeElement,r=cD(Az,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);Ce(i,"corner")?de(Dr,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&de(Dr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(de(Di,this)[0]=o.TD,clearTimeout(de(aa,this)[0]),de(aa,this)[0]=setTimeout(()=>{de(Di,this)[0]=null},1e3))}onContextMenu(e){if(de(Dr,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!de(Dr,this).has("onCellMouseOver"))return;const n=de(pn,this).TABLE,r=Wd(e.target,["TD","TH"],n),i=de(Gd,this)||this;r&&r!==i.lastMouseOver&&nl(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,de(pn,this).getCoords(r),r))}onMouseOut(e){if(!de(Dr,this).has("onCellMouseOut"))return;const n=de(pn,this).TABLE,r=Wd(e.target,["TD","TH"],n),i=Wd(e.relatedTarget,["TD","TH"],n),o=de(Gd,this)||this;r&&r!==i&&nl(r,n)&&(this.callListener("onCellMouseOut",e,de(pn,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&de(Dr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===de(Di,this)[0]&&n.TD===de(Di,this)[1]?(Ce(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),de(Di,this)[0]=null,de(Di,this)[1]=null):n.TD===de(Di,this)[0]&&(de(Di,this)[1]=n.TD,clearTimeout(de(aa,this)[1]),de(aa,this)[1]=setTimeout(()=>{de(Di,this)[1]=null},500)))}onTouchStart(e){cs(Ec,this,de(Il,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=le(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&de(Dr,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];qN()&&(Oz()||xz())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=de(Dr,this).getSettingPure(e);o&&o(n,r,i,de(VC,this).call(this))}destroy(){clearTimeout(de(aa,this)[0]),clearTimeout(de(aa,this)[1]),de(ai,this).destroy()}};function WC(t,e,n){return(e=jG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jG(t){var e=UG(t,"string");return typeof e=="symbol"?e:e+""}function UG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zG{constructor(e,n,r){WC(this,"offset",void 0),WC(this,"total",void 0),WC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function BC(t,e,n){return(e=YG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YG(t){var e=GG(t,"string");return typeof e=="symbol"?e:e+""}function GG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qG{constructor(e,n,r){BC(this,"offset",void 0),BC(this,"total",void 0),BC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function qd(t,e,n){return(e=KG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KG(t){var e=XG(t,"string");return typeof e=="symbol"?e:e+""}function XG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZG{constructor(){qd(this,"currentSize",0),qd(this,"nextSize",0),qd(this,"currentOffset",0),qd(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const QG=0,IO=1,fb=2;function jC(t,e,n){return(e=JG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JG(t){var e=e2(t,"string");return typeof e=="symbol"?e:e+""}function e2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class t2{constructor(){jC(this,"size",new ZG),jC(this,"workingSpace",QG),jC(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=IO,e.workingSpace=fb,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=fb,e.workingSpace=IO,this.sharedSize=e.getViewSize()}}var PO={},UC,OO;function n2(){if(OO)return UC;OO=1;var t=jm(),e=TypeError;return UC=function(n,r){if(!delete n[r])throw new e("Cannot delete property "+t(r)+" of "+t(n))},UC}var xO;function r2(){if(xO)return PO;xO=1;var t=gt(),e=zu(),n=Gu(),r=M1(),i=n2(),o=I1(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=n(h),f=arguments.length;if(f){o(d+f);for(var m=d;m--;){var v=m+f;m in h?h[v]=h[m]:i(h,v)}for(var S=0;S<f;S++)h[S]=arguments[S]}return r(h,d+f)}}),PO}r2();function i2(t,e,n){return(e=o2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o2(t){var e=s2(t,"string");return typeof e=="symbol"?e:e+""}function s2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HO{constructor(e,n){i2(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function a2(t,e,n){return(e=l2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l2(t){var e=u2(t,"string");return typeof e=="symbol"?e:e+""}function u2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class c2{constructor(e){a2(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new HO(o,n),l=new HO(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(fb)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function Pl(t,e,n){return(e=h2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h2(t){var e=d2(t,"string");return typeof e=="symbol"?e:e+""}function d2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xD{constructor(e,n){Pl(this,"rootNode",void 0),Pl(this,"nodesPool",void 0),Pl(this,"sizeSet",new t2),Pl(this,"collectedNodes",[]),Pl(this,"viewDiffer",new c2(this.sizeSet)),Pl(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class HD extends xD{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function AO(t,e,n){return(e=f2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f2(t){var e=g2(t,"string");return typeof e=="symbol"?e:e+""}function g2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m2{constructor(e){AO(this,"nodeType",void 0),AO(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function Tc(t,e,n){return(e=p2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p2(t){var e=w2(t,"string");return typeof e=="symbol"?e:e+""}function w2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rd{constructor(e,n){Tc(this,"nodesPool",null),Tc(this,"nodeType",void 0),Tc(this,"rootNode",void 0),Tc(this,"table",null),Tc(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new m2(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function NO(t,e,n){return(e=v2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v2(t){var e=C2(t,"string");return typeof e=="symbol"?e:e+""}function C2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y2 extends Rd{constructor(){super("TH"),NO(this,"orderViews",new WeakMap),NO(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new HD(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Qu(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ve(d,[tz(),cz(),$R(h+1),Js(-1)]),n[h](a,d,h)}u.end()}}}class S2 extends Rd{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&ts(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&ve(this.rootNode,[FN()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&ve(s,[VN(),UN(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Qu(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ve(u,[$R(a+1+this.table.rowHeadersCount),Js(-1),nz(),...a>=0?[uz()]:[ez(),Du("Select whole grid")]]),r[n](l,u,n)}}}}let DO=!1;class b2 extends Rd{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!DO&&e>1e3&&(DO=!0,qe(tt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&G(r,"rowHeader")}}function R2(t,e,n){return(e=E2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E2(t){var e=T2(t,"string");return typeof e=="symbol"?e:e+""}function T2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ol={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let kO=!1;class _2 extends Rd{constructor(e){super("TR",e),R2(this,"orderView",void 0),this.orderView=new xD(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!kO&&e>1e3&&(kO=!0,qe(tt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&ve(this.rootNode,[FN()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;ve(o,[VN(),UN(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?Ce(o,Ol.rowEven)||(pe(o,Ol.rowOdd),G(o,Ol.rowEven)):Ce(o,Ol.rowOdd)||(pe(o,Ol.rowEven),G(o,Ol.rowOdd))}this.orderView.end()}}function LO(t,e,n){return(e=M2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M2(t){var e=I2(t,"string");return typeof e=="symbol"?e:e+""}function I2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P2 extends Rd{constructor(){super("TD"),LO(this,"orderViews",new WeakMap),LO(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new HD(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),m=c.getCurrentNode();if(Ce(m,"hide")||(m.className=""),m.removeAttribute("style"),m.removeAttribute("dir"),Qu(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,m),this.table.isAriaEnabled()){var o,s;ve(m,[...m.hasAttribute("role")?[]:[JU()],Js(-1),$R(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function Xt(t,e,n){return(e=O2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O2(t){var e=x2(t,"string");return typeof e=="symbol"?e:e+""}function x2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H2{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Xt(this,"rootNode",void 0),Xt(this,"rootDocument",void 0),Xt(this,"rowHeaders",null),Xt(this,"columnHeaders",null),Xt(this,"colGroup",null),Xt(this,"rows",null),Xt(this,"cells",null),Xt(this,"rowFilter",null),Xt(this,"columnFilter",null),Xt(this,"rowUtils",null),Xt(this,"columnUtils",null),Xt(this,"rowsToRender",0),Xt(this,"columnsToRender",0),Xt(this,"rowHeaderFunctions",[]),Xt(this,"rowHeadersCount",0),Xt(this,"columnHeaderFunctions",[]),Xt(this,"columnHeadersCount",0),Xt(this,"cellRenderer",void 0),Xt(this,"activeOverlayName",void 0),Xt(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class A2{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new H2(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new y2,columnHeaders:new S2(n),colGroup:new b2(r),rows:new _2(i),cells:new P2}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function zC(t,e,n){return(e=N2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N2(t){var e=D2(t,"string");return typeof e=="symbol"?e:e+""}function D2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k2{constructor(e,n){zC(this,"dataAccessObject",void 0),zC(this,"wtSettings",void 0),zC(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function $O(t,e,n){return(e=L2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L2(t){var e=$2(t,"string");return typeof e=="symbol"?e:e+""}function $2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class F2{constructor(e,n){$O(this,"dataAccessObject",void 0),$O(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function ki(t,e,n){return(e=V2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V2(t){var e=W2(t,"string");return typeof e=="symbol"?e:e+""}function W2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ec{constructor(e,n,r,i,o){ki(this,"wtSettings",null),ki(this,"domBindings",void 0),ki(this,"TBODY",null),ki(this,"THEAD",null),ki(this,"COLGROUP",null),ki(this,"hasTableHeight",!0),ki(this,"hasTableWidth",!0),ki(this,"isTableVisible",!1),ki(this,"tableOffset",0),ki(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,QN(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new F2(this.dataAccessObject,this.wtSettings),this.columnUtils=new k2(this.dataAccessObject,this.wtSettings),this.tableRenderer=new A2({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ce(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&ve(r,[Yo()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ce(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ve(r,[Yo()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ce(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",this.isMaster&&ve(r,[Js(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&ve(r.parentNode,[Yo()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ve(r,[Yo()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=An(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,m!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=An(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),m=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new qG(f,o,c),this.columnFilter=new zG(m,s,l);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const S={};this.wtSettings.getSetting("beforeDraw",!0,S),v=S.skipRender!==!0}v&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(oo)||this.is(zs))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(oo))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(oo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=Sh(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(oo))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a?.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o?.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=ol(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=kz(r),s=n.cellIndex;oa(hl,n,this.wtRootElement)||oa(ul,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):oa(zs,n,this.wtRootElement)||oa(oo,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),oa(hl,n,this.wtRootElement)||oa(cl,n,this.wtRootElement)||oa(zs,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=this.wtSettings.getSetting("stylesHandler"),r=e*n.getDefaultRowHeight(),i=Sh(this.TBODY)-1,o=n.areCellsBorderBox(),s=o?en:Sh,a=o?0:1,l=o?1:0;let u,c,h,d,f;if(!(r===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),f=d.querySelector("th");const m=h===0?l:0;f?c=s(f):c=s(d)-a,(!u&&n.getDefaultRowHeight()<c-m||u<c)&&(o||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Yt(this.TABLE)}getHeight(){return en(this.TABLE)}getTotalWidth(){const e=Yt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=en(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Lu(this.TABLE)}_modifyRowHeaderWidth(e){let n=it(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const B2="stickyRowsBottom",XR={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};as(XR,"MIXIN_NAME",B2,{writable:!1,enumerable:!1});const j2="stickyColumnsStart",up={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};as(up,"MIXIN_NAME",j2,{writable:!1,enumerable:!1});class ZR extends ec{constructor(e,n,r,i){super(e,n,r,i,zs)}}ct(ZR,XR);ct(ZR,up);const ul="top",oo="bottom",cl="inline_start",hl="top_inline_start_corner",zs="bottom_inline_start_corner",AD=[ul,oo,cl,hl,zs],U2=new Map([[ul,`ht_clone_${ul}`],[oo,`ht_clone_${oo}`],[cl,`ht_clone_${cl} ht_clone_left`],[hl,`ht_clone_${hl} ht_clone_top_left_corner`],[zs,`ht_clone_${zs} ht_clone_bottom_left_corner`]]);function z2(t,e){Y2(t,e),e.add(t)}function Y2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function G2(t,e,n){return(e=q2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q2(t){var e=K2(t,"string");return typeof e=="symbol"?e:e+""}function K2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _c=new WeakSet;class X2{constructor(e){z2(this,_c),G2(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=Or(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=Or(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Kd(_c,this,VO).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Kd(_c,this,VO).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Kd(_c,this,FO).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Kd(_c,this,FO).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function FO(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=An(r.wtRootElement).left;const u=Math.abs(eD(s,s));if(l>u){const c=tD(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function VO(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=An(n.wtRootElement),a=jR(o,o);if(s.top>a){const l=Sh(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function kr(t,e,n){return(e=Z2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z2(t){var e=Q2(t,"string");return typeof e=="symbol"?e:e+""}function Q2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QR{get eventManager(){return new Pi(this)}constructor(e,n){kr(this,"wtTable",void 0),kr(this,"wtScroll",void 0),kr(this,"wtViewport",void 0),kr(this,"wtOverlays",void 0),kr(this,"selectionManager",void 0),kr(this,"wtEvent",void 0),kr(this,"guid",`wt_${kN()}`),kr(this,"drawInterrupted",!1),kr(this,"drawn",!1),kr(this,"activeOverlayName","master"),kr(this,"domBindings",void 0),kr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new X2(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){sl(r,e[n])}])}}createCellCoords(e,n){return new ll(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new bd(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||$z(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function WO(t,e,n){return(e=J2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J2(t){var e=eq(t,"string");return typeof e=="symbol"?e:e+""}function eq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tq extends QR{constructor(e,n,r){super(e,n),WO(this,"cloneSource",void 0),WO(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new OD(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function nq(t,e,n){return(e=rq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rq(t){var e=iq(t,"string");return typeof e=="symbol"?e:e+""}function iq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ed{constructor(e,n,r,i,o){nq(this,"wtSettings",null),as(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Gh(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Gh(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Zg(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){qe(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Cn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(AD.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${U2.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&ve(o,[Yo()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===ul||u==="vertical"&&this.type===cl?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Zg(e.TABLE),new tq(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class oq extends Ed{constructor(e,n,r,i,o,s){super(e,n,zs,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new ZR(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else op(n),this.repositionOverlay();let r=en(this.clone.wtTable.TABLE);const i=Yt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Cn(r)),i.style.bottom=`${o}px`}}const sq="calculatedColumns",cp={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};as(cp,"MIXIN_NAME",sq,{writable:!1,enumerable:!1});class JR extends ec{constructor(e,n,r,i){super(e,n,r,i,oo)}}ct(JR,XR);ct(JR,cp);function aq(t,e,n){return(e=lq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lq(t){var e=uq(t,"string");return typeof e=="symbol"?e:e+""}function uq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cq extends Ed{constructor(e,n,r,i){super(e,n,oo,r,i),aq(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new JR(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Cn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(BR(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("stylesHandler").getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=Cn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=en(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=Cn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return jR(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=Ce(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(G(s,"innerBorderBottom"),o=!a):(pe(s,"innerBorderBottom"),o=a)}return o}}const hq="calculatedRows",eE={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};as(eE,"MIXIN_NAME",hq,{writable:!1,enumerable:!1});class tE extends ec{constructor(e,n,r,i){super(e,n,r,i,cl)}}ct(tE,eE);ct(tE,up);const dq="localHooks",bn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)sb(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};as(bn,"MIXIN_NAME",dq,{writable:!1,enumerable:!1});let ND=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};ct(ND,bn);const DD="active-header",nE="header",rE="area",em="focus",fq="fill",gq="row",mq="column",pq="custom-selection",iE=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var BO={},jO;function wq(){if(jO)return BO;jO=1;var t=ap();return t("flat"),BO}wq();function vq(t,e){kD(t,e),e.add(t)}function UO(t,e,n){kD(t,e),e.set(t,n)}function kD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ht(t,e){return t.get(bh(t,e))}function zO(t,e,n){return t.set(bh(t,e),n),n}function bh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fi=new WeakMap,In=new WeakMap,Xd=new WeakSet;class Cq{constructor(){vq(this,Xd),UO(this,fi,void 0),UO(this,In,void 0)}setActiveOverlay(e){return zO(In,this,e),this}setActiveSelection(e){return zO(fi,this,e),this}scan(){const e=Ht(fi,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Ht(fi,this).getCorners(),{wtTable:s}=Ht(In,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let m=s.getColumnHeader(h,f);const v=Ht(In,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Ht(fi,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});v!==null&&(v!==h&&(m=s.getColumnHeader(v,f)),e(m))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Ht(fi,this).getCorners(),{wtTable:s}=Ht(In,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let m=s.getRowHeader(h,f);const v=Ht(In,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Ht(fi,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});v!==null&&(v!==h&&(m=s.getRowHeader(v,f)),e(m))}u+=1}}}scanCellsRange(e){const{wtTable:n}=Ht(In,this);bh(Xd,this,yq).call(this,(r,i)=>{const o=n.getCell(Ht(In,this).createCellCoords(r,i)),s=Ht(In,this).getSetting("onAfterDrawSelection",r,i,Ht(fi,this).settings.layerLevel);typeof s=="string"&&G(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=Ht(fi,this).getCorners(),{wtTable:i}=Ht(In,this);bh(Xd,this,YO).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Ht(In,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Ht(fi,this).getCorners(),{wtTable:i}=Ht(In,this);bh(Xd,this,YO).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Ht(In,this).createCellCoords(o,s));e(a)}})}}function yq(t){let[e,n,r,i]=Ht(fi,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=Ht(In,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(Ht(In,this).createCellCoords(e,n));if(!Jo(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function YO(t){const{wtTable:e}=Ht(In,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class GO{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=iE(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Hi(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),lo()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:n}=this.wot,r=n.getSetting("stylesHandler"),i=r.getCSSVariableValue("cell-mobile-handle-size"),o=r.getCSSVariableValue("cell-mobile-handle-border-radius"),s=r.getCSSVariableValue("cell-mobile-handle-background-color"),a=r.getCSSVariableValue("cell-mobile-handle-border-width"),l=r.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};Ne(h,(f,m)=>{this.selectionHandles.styles.bottomHitArea[m]=f,this.selectionHandles.styles.topHitArea[m]=f});const d=r.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${o}px`,background:`${s}`,border:`${a}px solid ${l}`};Ne(d,(f,m)=>{this.selectionHandles.styles.bottom[m]=f,this.selectionHandles.styles.top[m]=f}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),m=parseInt(u.width,10),v=parseInt(c.width,10),S=this.wot.wtTable.getWidth(),R=this.wot.wtTable.getHeight();u.top=`${parseInt(r-m-1,10)}px`,u[l]=`${parseInt(i-m-1,10)}px`,c.top=`${parseInt(r-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const w=Math.min(parseInt(i+o,10),S-m-f*2),_=Math.min(parseInt(i+o-v/4,10),S-v-f*2);h[l]=`${w}px`,d[l]=`${_}px`;const O=Math.min(parseInt(r+s,10),R-m-f*2),L=Math.min(parseInt(r+s-v/4,10),R-v-f*2);h.top=`${O}px`,d.top=`${L}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=s.getFirstRenderedRow(),d=s.getLastRenderedRow(),f=s.getFirstRenderedColumn(),m=s.getLastRenderedColumn();if(f<0&&m<0||h<0&&d<0){this.disappear();return}let v;if(u){if(r=Math.max(r,f),o=Math.min(o,m),n=Math.max(n,h),i=Math.min(i,d),o<r||i<n){this.disappear();return}v=s.getCell(this.wot.createCellCoords(n,r))}else if(v=s.getCell(this.wot.createCellCoords(n,r)),!Jo(v)){this.disappear();return}const S=u?s.getCell(this.wot.createCellCoords(i,o)):v,R=An(v),w=u?An(S):R,_=An(s.TABLE),O=R.top,L=R.left,M=this.wot.wtSettings.getSetting("rtlMode");let x=0,z=0;if(M){const De=Yt(s.TABLE),vt=Yt(v),nt=l.innerWidth-_.left-De;z=L+vt-w.left,x=l.innerWidth-L-vt-nt-1}else z=w.left+Yt(S)-L,x=L-_.left-1;if(this.isEntireColumnSelected(n,i)){const De=n,vt=this.getDimensionsFromHeader("columns",r,o,De,_);let nt=null;vt&&([nt,x,z]=vt),nt&&(v=nt)}let q=O-_.top-1,A=w.top+en(S)-O;if(this.isEntireRowSelected(r,o)){const De=r,vt=this.getDimensionsFromHeader("rows",n,i,De,_);let nt=null;vt&&([nt,q,A]=vt),nt&&(v=nt)}const Z=l.getComputedStyle(v);parseInt(Z.borderTopWidth,10)>0&&(q+=1,A=A>0?A-1:0),parseInt(Z[M?"borderRightWidth":"borderLeftWidth"],10)>0&&(x+=1,z=z>0?z-1:0);const X=M?"right":"left",oe=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${q}px`,this.topStyle[X]=`${x}px`,this.topStyle.width=`${z+oe}px`,this.topStyle.display="block",this.startStyle.top=`${q}px`,this.startStyle[X]=`${x}px`,this.startStyle.height=`${A+oe}px`,this.startStyle.display="block",this.bottomStyle.top=`${q+A-parseInt(this.bottomStyle.height,10)+oe}px`,this.bottomStyle[X]=`${x}px`,this.bottomStyle.width=`${z+oe}px`,this.bottomStyle.display="block",this.endStyle.top=`${q}px`,this.endStyle[X]=`${x+z-parseInt(this.endStyle.width,10)+oe}px`,this.endStyle.height=`${A+oe}px`,this.endStyle.display="block";let ee=this.settings.border.cornerVisible;ee=typeof ee=="function"?ee(this.settings.layerLevel):ee;const ae=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[ht,Ie]=[i,o];if(ae&&Array.isArray(ae)&&([,,ht,Ie]=ae),lo()||!ee||this.isPartRange(ht,Ie))this.cornerStyle.display="none";else{this.cornerStyle.top=`${q+A+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[X]=`${x+z+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let De=Gh(s.TABLE);const vt=De===l;vt&&(De=a.documentElement);const nt=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,st=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),gn=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const g=vt?S.getBoundingClientRect().left:S.offsetLeft;let p=!1,y=0;if(M?(y=g-parseInt(this.cornerDefaultStyle.width,10)/2,p=y<0):(y=g+Yt(S)+parseInt(this.cornerDefaultStyle.width,10)/2,p=y>=tD(De)),p){const N=Math.floor(x+z+this.cornerCenterPointOffset-st-nt);c?(this.cornerStyle[X]=`${N}px`,this.cornerStyle[M?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[X]=`${N-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(vt?S.getBoundingClientRect().top:S.offsetTop)+en(S)+parseInt(this.cornerDefaultStyle.height,10)/2>=Sh(De)){const N=Math.floor(q+A+this.cornerCenterPointOffset-gn-nt);c?(this.cornerStyle.top=`${N}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${N-1}px`}this.cornerStyle.display="block"}lo()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,q,x,z,A)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,m=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return en(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return Yt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const S=this.wot.getSetting("columnHeaders").length;if(m=l(n,S-i),v=l(r,S-i),!m||!v)return!1;const R=An(m),w=An(v);return m&&v&&(h=R[f]-o[f]-1,d=w[f]+u(v)-R[f]),[m,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?G(this[e],"hidden"):(Ce(this[e],"hidden")&&pe(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?G(this[e],"hidden"):pe(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",lo()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function Sq(t,e){LD(t,e),e.add(t)}function xl(t,e,n){LD(t,e),e.set(t,n)}function LD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oe(t,e){return t.get(oE(t,e))}function qO(t,e,n){return t.set(oE(t,e),n),n}function oE(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Pn=new WeakMap,ar=new WeakMap,YC=new WeakMap,dh=new WeakMap,GC=new WeakMap,la=new WeakMap,KO=new WeakSet;class bq{constructor(e){Sq(this,KO),xl(this,Pn,void 0),xl(this,ar,void 0),xl(this,YC,new Cq),xl(this,dh,new WeakMap),xl(this,GC,new WeakSet),xl(this,la,new Map),qO(ar,this,e)}setActiveOverlay(e){return qO(Pn,this,e),Oe(YC,this).setActiveOverlay(Oe(Pn,this)),Oe(dh,this).has(Oe(Pn,this))||Oe(dh,this).set(Oe(Pn,this),new Set),this}getFocusSelection(){return Oe(ar,this)!==null?Oe(ar,this).getFocus():null}getAreaSelection(){return Oe(ar,this)!==null?Oe(ar,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Oe(la,this).has(e)){const r=Oe(la,this).get(e);if(r.has(Oe(Pn,this)))return r.get(Oe(Pn,this));const i=new GO(Oe(Pn,this),e.settings);return r.set(Oe(Pn,this),i),i}const n=new GO(Oe(Pn,this),e.settings);return Oe(la,this).set(e,new Map([[Oe(Pn,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=Oe(la,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Oe(la,this).get(e).forEach(n=>n.destroy()),Oe(la,this).delete(e)}render(e){if(Oe(ar,this)===null)return;e&&oE(KO,this,Rq).call(this);const n=Array.from(Oe(ar,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;Oe(GC,this).has(s)||(Oe(GC,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h?.disappear();continue}a&&Oe(YC,this).setActiveSelection(s).scan().forEach(m=>{if(r.has(m)){const v=r.get(m);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else r.set(m,new Map([[a,1]]));l&&(i.has(m)||i.set(m,[]),m.nodeName==="TH"&&i.get(m).push(...l))});const d=s.getCorners();Oe(Pn,this).getSetting("onBeforeDrawBorders",d,c),h?.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>Oe(dh,this).get(Oe(Pn,this)).add(u)),G(s,l),s.nodeName==="TD"&&Array.isArray((a=Oe(ar,this).options)===null||a===void 0?void 0:a.cellAttributes)&&ve(s,Oe(ar,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{ve(o,[...i.get(o)])})}}function Rq(){const t=Oe(dh,this).get(Oe(Pn,this)),e=Oe(Pn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=Oe(Pn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=Oe(ar,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=Oe(ar,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=Oe(ar,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...Oe(ar,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)pe(o[a],n),Qu(o[a],s)}),t.clear()}class Eq extends Ed{constructor(e,n,r,i){super(e,n,cl,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new tE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),UR(r,`${o}px`,"0px")):(o=this.getScrollPosition(),op(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,JN(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=Cn(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=Yt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=iE(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!Ce(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=Cn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,Vz(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(eD(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?pe(r,"emptyRows"):G(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)G(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=Ce(r,"innerBorderInlineStart");e?(G(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(pe(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const Tq="stickyRowsTop",sE={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};as(sE,"MIXIN_NAME",Tq,{writable:!1,enumerable:!1});class aE extends ec{constructor(e,n,r,i){super(e,n,r,i,hl)}}ct(aE,sE);ct(aE,up);function XO(t,e,n){return(e=_q(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _q(t){var e=Mq(t,"string");return typeof e=="symbol"?e:e+""}function Mq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Iq extends Ed{constructor(e,n,r,i,o,s){super(e,n,hl,r,i),XO(this,"topOverlay",void 0),XO(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new aE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();UR(e,`${i}px`,`${o}px`)}else op(e);let n=en(this.clone.wtTable.TABLE);const r=Yt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class lE extends ec{constructor(e,n,r,i){super(e,n,r,i,ul)}}ct(lE,sE);ct(lE,cp);function Pq(t,e,n){return(e=Oq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oq(t){var e=xq(t,"string");return typeof e=="symbol"?e:e+""}function xq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hq extends Ed{constructor(e,n,r,i){super(e,n,ul,r,i),Pq(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new lE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),UR(e,"0px",`${i}px`)}else i=this.getScrollPosition(),op(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(BR(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=Cn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=en(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=iE(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!Ce(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=Cn(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,Fz(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return jR(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?pe(i,"emptyColumns"):G(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=Ce(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(G(i,"innerBorderTop"),a=!h):(pe(i,"innerBorderTop"),a=h)}}return a}}function Zd(t,e,n){Aq(t,e),e.set(t,n)}function Aq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ro(t,e,n){return(e=Nq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nq(t){var e=Dq(t,"string");return typeof e=="symbol"?e:e+""}function Dq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ua(t,e,n){return t.set($D(t,e),n),n}function Eo(t,e){return t.get($D(t,e))}function $D(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hl=new WeakMap,Qd=new WeakMap,Al=new WeakMap,Jd=new WeakMap;class kq{constructor(e,n,r,i,o,s){Ro(this,"wot",null),Zd(this,Hl,[]),Ro(this,"topOverlay",null),Ro(this,"bottomOverlay",null),Ro(this,"inlineStartOverlay",null),Ro(this,"topInlineStartCornerOverlay",null),Ro(this,"bottomInlineStartCornerOverlay",null),Ro(this,"browserLineHeight",void 0),Ro(this,"wtSettings",null),Zd(this,Qd,!1),Zd(this,Al,0),Zd(this,Jd,null),Ro(this,"resizeObserver",new ResizeObserver(c=>{Kg(()=>{!Array.isArray(c)||!c.length||(ua(Al,this,Eo(Al,this)+1),Eo(Al,this)===100&&(qe("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Eo(Jd,this)!==null&&clearTimeout(Eo(Jd,this)),ua(Jd,this,setTimeout(()=>{ua(Al,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Cn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Zg(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...Eo(Hl,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Hq(...e),this.bottomOverlay=new cq(...e),this.inlineStartOverlay=new Eq(...e),this.topInlineStartCornerOverlay=new Iq(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new oq(...e,this.bottomOverlay,this.inlineStartOverlay),ua(Hl,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){ua(Qd,this,Eo(Hl,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),Eo(Hl,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Eo(Hl,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!GN())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{Kg(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{ua(Al,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Sd(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!Eo(Qd,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),ua(Qd,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Zg(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),m=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),v=f()?1:0,S=m()?1:0;d.width=`${c+S}px`,d.height=`${u+v}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return P(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];P(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function ZO(t,e,n){return(e=Lq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lq(t){var e=$q(t,"string");return typeof e=="symbol"?e:e+""}function $q(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fq{constructor(e){ZO(this,"settings",{}),ZO(this,"defaults",Object.freeze(this.getDefaults())),Ne(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);sl(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,n){return n===void 0?Ne(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class uE extends ec{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Gh(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Qg(e,"height",n),o=Qg(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Lu(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}ct(uE,eE);ct(uE,cp);class Vq{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new vG:new EG],["fullyVisible",()=>new lG],["partiallyVisible",()=>new TD]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new mG:new SG],["fullyVisible",()=>new oG],["partiallyVisible",()=>new ED]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=en(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,r=e.clientWidth,i=n.offsetWidth;return r<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return An(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=en(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=Yt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=Cn(this.domBindings.rootDocument),new HG({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:n.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=Cn(this.domBindings.rootDocument)),new PG({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}resetHasOversizedColumnHeadersMarked(){Ne(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}class Wq extends QR{constructor(e,n){super(e,new Fq(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new uE(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new Vq(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new bq(this.wtSettings.getSetting("selections")),this.wtEvent=new OD(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new kq(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Ne(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),pe(this.wtTable.wtRootElement.parentNode,n),G(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!AD.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class cE{constructor(e){e instanceof QR?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new cE(n);return()=>r},this._wot=new Wq(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function QO(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function Bq(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}function JO(t){let{isLeftClick:e,selection:n,cellRangeMapper:r}=t;if(!e||n.settings.selectionMode!=="multiple")return;const i=n.getSelectedRange(),o=i.clone().map(a=>r.toRenderable(a)),s=o.current();if(o.size()>1&&!s.isHeader()&&!n.isMultiple(s)){const a=o.findAll(s);a.length===o.size()?(i.pop(),n.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),n.refresh())}}const jq=new Map([["touchstart",QO],["touchend",JO],["mousedown",QO],["mouseover",Bq],["mouseup",JO]]);function qC(t,e){jq.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:zR(t)||t.type==="touchstart",isRightClick:al(t),...e})}const FD=new WeakMap,hE=Symbol("rootInstance");function Uq(t){FD.set(t,!0)}function zq(t){return t===hE}function gu(t){return FD.has(t)}function Yq(t,e){VD(t,e),e.add(t)}function hs(t,e,n){VD(t,e),e.set(t,n)}function VD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ds(t,e,n){return(e=Gq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gq(t){var e=qq(t,"string");return typeof e=="symbol"?e:e+""}function qq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jt(t,e){return t.get(xu(t,e))}function Jn(t,e,n){return t.set(xu(t,e),n),n}function xu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var KC=new WeakMap,ef=new WeakMap,tf=new WeakMap,To=new WeakMap,li=new WeakMap,XC=new WeakMap,ZC=new WeakMap,Nl=new WeakMap,fh=new WeakSet;class Kq{constructor(e){Yq(this,fh),ds(this,"hot",void 0),ds(this,"eventManager",void 0),ds(this,"settings",void 0),ds(this,"THEAD",void 0),ds(this,"TBODY",void 0),ds(this,"_wt",void 0),ds(this,"activeWt",void 0),hs(this,KC,0),hs(this,ef,0),ds(this,"postponedAdjustElementsSize",!1),hs(this,tf,!1),hs(this,To,void 0),hs(this,li,void 0),hs(this,XC,0),hs(this,ZC,0),hs(this,Nl,null),this.hot=e,this.eventManager=new Pi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),xu(fh,this,Zq).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),G(e,"handsontable"),Jn(li,this,n.createElement("TABLE")),G(jt(li,this),"htCore"),this.hot.getSettings().tableClassName&&G(jt(li,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(ve(jt(li,this),[Yo()]),ve(e,[QU(),jN(-1),np(this.hot.countCols()),fz()])),this.THEAD=n.createElement("THEAD"),jt(li,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),jt(li,this).appendChild(this.TBODY),this.hot.table=jt(li,this),this.hot.container.insertBefore(jt(li,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{Jn(tf,this,!0),this.isTextSelectionAllowed(a.target)||(BP(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{Jn(tf,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{jt(tf,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&BP(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&zR(a)&&r.finish(),Jn(To,this,!1);const l=sD(n.activeElement);Mg(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!al(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&al(a)&&(r.finish(),Jn(To,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),Jn(To,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(jt(To,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const m=Cn(n);if(n.elementFromPoint(u+m,c)!==d||n.elementFromPoint(u,c+m)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=ku(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=ku(s);this.eventManager.addEventListener(jt(li,this),"selectstart",a=>{this.settings.fragmentSelection||Mg(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&G(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&pe(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:jt(li,this),isDataViewInstance:()=>gu(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Jn(ef,this,o.length),this.hot.getSettings().ariaTags&&xu(fh,this,WD).call(this)===this.hot.countCols()&&xu(fh,this,Xq).call(this,jt(ef,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Jn(KC,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),m=this.hot.colToProp(d);let v=this.hot.getDataAtRowProp(h,m);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,f)),this.hot.runHooks("beforeRenderer",a,l,u,m,v,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,m,v,f),this.hot.runHooks("afterRenderer",a,l,u,m,v,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Lu(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Jn(To,this,!0),Jn(Nl,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!za(o)&&(qC(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Jn(To,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!za(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!za(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!za(o)&&(jt(To,this)&&(!jt(Nl,this)||jt(Nl,this).x!==o.clientX||jt(Nl,this).y!==o.clientY)&&qC(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,Jn(Nl,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(za(o)||this.hot.isDestroyed)&&(qC(o,{coords:u,selection:this.hot.selection,cellRangeMapper:cY(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[m,v,S,R]=f;return[m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,v>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(v,1)):v,S>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(S,-1)):S,R>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(R,-1)):R]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new cE(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(Mg(e))return!0;const n=nl(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return jt(To,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!Ce(r,"relative")){ts(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;Ce(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",G(s,["relative",...o()])):(ts(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(ve(a,...Yo()),ve(l,...Yo())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ce(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):Ce(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Ju(e,r(n,i)):(sl(e,"Â "),G(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){Jn(XC,this,e),Jn(ZC,this,n)}getLastSize(){return{width:jt(XC,this),height:jt(ZC,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return jt(KC,this)}getRowHeadersCount(){return jt(ef,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function WD(){return parseInt(this.hot.rootElement.getAttribute(np()[0]),10)}function Xq(t){const e=xu(fh,this,WD).call(this)+t;ve(this.hot.rootElement,...np(e))}function Zq(){const t=this.hot.rootElement;this.hasVerticalScroll()?G(t,"htHasScrollY"):pe(t,"htHasScrollY"),this.hasHorizontalScroll()?G(t,"htHasScrollX"):pe(t,"htHasScrollX")}var ex={},tx={},nx;function Qq(){if(nx)return tx;nx=1;var t=gt(),e=rn(),n=qu(),r=gr(),i=sn(),o=go(),s=mr(),a=Qs(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return!n(h,function(f,m){if(!c(f,d++))return m()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),tx}var rx;function Jq(){return rx||(rx=1,Qq()),ex}Jq();const eK="ABCDEFGHIJKLMNOPQRSTUVWXYZ",ix=eK.length;function tK(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%ix,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/ix,10);return n}function BD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function jD(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Ae(t[0])&&(e=WR(t[0]))),e}function nK(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function rK(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function Mc(t,e,n){return(e=iK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iK(t){var e=oK(t,"string");return typeof e=="symbol"?e:e+""}function oK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sK{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Mc(this,"hot",void 0),Mc(this,"data",void 0),Mc(this,"dataType","array"),Mc(this,"colToProp",()=>{}),Mc(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return P(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):he(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(Ae(a)||it(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;he(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?SC(l,d,f):l[d]=f}})}else Ne(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?SC(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Or(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:SC(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?Tz(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=Or(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return he(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return jD(this.data)}destroy(){this.data=null,this.hot=null}}var ox={},sx={},ax;function aK(){if(ax)return sx;ax=1;var t=gt(),e=rn(),n=qu(),r=gr(),i=sn(),o=go(),s=mr(),a=Qs(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,m){if(c(f,d++))return m()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),sx}var lx;function lK(){return lx||(lx=1,aK()),ox}lK();function ux(t,e,n){return(e=uK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uK(t){var e=cK(t,"string");return typeof e=="symbol"?e:e+""}function cK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ux(this,"indexedValues",[]),ux(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,it(this.initValueOrFn)?he(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):he(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}ct(Sl,bn);function dE(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>it(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function fE(t,e){return il(t,(n,r)=>e.includes(r)===!1)}class ta extends Sl{insert(e,n){this.indexedValues=dE(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=fE(this.indexedValues,e),super.remove(e)}}class hp extends ta{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return pr(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function gE(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function qh(t,e){return il(t,n=>e.includes(n)===!1)}function mE(t,e){return Ve(t,n=>n-e.filter(r=>r<n).length)}function pE(t,e){const n=e[0],r=e.length;return Ve(t,i=>i>=n?i+r:i)}function hK(t,e,n){return(e=dK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dK(t){var e=fK(t,"string");return typeof e=="symbol"?e:e+""}function fK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dp extends Sl{constructor(){super(...arguments),hK(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=qh(this.orderOfIndexes,[e]),it(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=dE(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=pE(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=fE(this.indexedValues,e),this.orderOfIndexes=qh(this.orderOfIndexes,e),this.orderOfIndexes=mE(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Td extends ta{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return pr(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const cx=new Map([["indexesSequence",{getListWithInsertedItems:gE,getListWithRemovedItems:qh}],["physicallyIndexed",{getListWithInsertedItems:dE,getListWithRemovedItems:fE}]]),UD=t=>{if(cx.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return cx.get(t)};class zD extends Sl{constructor(){super(e=>e)}insert(e,n){const r=pE(this.indexedValues,n);this.indexedValues=gE(r,e,n),super.insert(e,n)}remove(e){const n=qh(this.indexedValues,e);this.indexedValues=mE(n,e),super.remove(e)}}const hx=new Map([["hiding",hp],["index",Sl],["linkedPhysicalIndexToValue",dp],["physicalIndexToValue",ta],["trimming",Td]]);function gK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!hx.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(hx.get(t))(e)}function mK(t,e,n){return(e=pK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pK(t){var e=wK(t,"string");return typeof e=="symbol"?e:e+""}function wK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wE{constructor(){mK(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)))}unregister(e){const n=this.collection.get(e);le(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n))}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Mt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}ct(wE,bn);function QC(t,e,n){return(e=vK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vK(t){var e=CK(t,"string");return typeof e=="symbol"?e:e+""}function CK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dx extends wE{constructor(e,n){super(),QC(this,"mergedValuesCache",[]),QC(this,"aggregationFunction",void 0),QC(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ve(this.get(),o=>o.getValues()),r=[],i=le(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ve(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return le(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function yK(t,e,n){SK(t,e),e.set(t,n)}function SK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bK(t,e,n){return t.set(YD(t,e),n),n}function RK(t,e){return t.get(YD(t,e))}function YD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var JC=new WeakMap;class GD{constructor(){yK(this,JC,[])}subscribe(e){return this.addLocalHook("change",e),this._write(RK(JC,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){bK(JC,this,e)}}ct(GD,bn);function fx(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function Ic(t,e,n){EK(t,e),e.set(t,n)}function EK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lr(t,e){return t.get(qD(t,e))}function nf(t,e,n){return t.set(qD(t,e),n),n}function qD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rf=new WeakMap,Pc=new WeakMap,of=new WeakMap,sf=new WeakMap,af=new WeakMap;class TK{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ic(this,rf,new Set),Ic(this,Pc,[]),Ic(this,of,[]),Ic(this,sf,!1),Ic(this,af,!1),nf(af,this,e??!1)}createObserver(){const e=new GD;return Lr(rf,this).add(e),e.addLocalHook("unsubscribe",()=>{Lr(rf,this).delete(e)}),e._writeInitialChanges(fx(Lr(Pc,this),Lr(of,this))),e}emit(e){let n=Lr(of,this);(!Lr(sf,this)||Lr(Pc,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(Lr(af,this)):nf(Pc,this,new Array(e.length).fill(Lr(af,this))),Lr(sf,this)||(nf(sf,this,!0),n=Lr(Pc,this)));const r=fx(n,e);Lr(rf,this).forEach(i=>i._write(r)),nf(of,this,e)}}function Ln(t,e,n){return(e=_K(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _K(t){var e=MK(t,"string");return typeof e=="symbol"?e:e+""}function MK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gb{constructor(){Ln(this,"indexesSequence",new zD),Ln(this,"trimmingMapsCollection",new dx(e=>e.some(n=>n===!0),!1)),Ln(this,"hidingMapsCollection",new dx(e=>e.some(n=>n===!0),!1)),Ln(this,"variousMapsCollection",new wE),Ln(this,"hidingChangesObservable",new TK({initialIndexValue:!1})),Ln(this,"notTrimmedIndexesCache",[]),Ln(this,"notHiddenIndexesCache",[]),Ln(this,"isBatched",!1),Ln(this,"indexesSequenceChanged",!1),Ln(this,"indexesChangeSource",void 0),Ln(this,"trimmedIndexesChanged",!1),Ln(this,"hiddenIndexesChanged",!1),Ln(this,"renderablePhysicalIndexesCache",[]),Ln(this,"fromPhysicalToVisualIndexesCache",new Map),Ln(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,gK(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Td?this.trimmingMapsCollection.register(e,n):n instanceof hp?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return le(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return le(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return le(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return le(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ve(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=qh(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(gE(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],o=le(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=Ve(new Array(n).fill(o),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0;const l=r==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(s,l),this.hidingMapsCollection.insertToEvery(s,l),this.variousMapsCollection.insertToEvery(s,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}ct(gb,bn);function IK(t,e){return Ne(e,(n,r)=>{Mt(t[r])&&(t[r]=n)}),t}function KD(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function XD(t){le(t)&&YR(tt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function PK(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:OK,getValues:xK}=ri("phraseFormatters");function HK(t,e){OK(t,e)}function AK(){return xK()}HK("pluralize",PK);const ZD="ContextMenu:items",Ee=ZD,vE=`${Ee}.noItems`,CE=`${Ee}.insertRowAbove`,yE=`${Ee}.insertRowBelow`,SE=`${Ee}.insertColumnOnTheLeft`,bE=`${Ee}.insertColumnOnTheRight`,RE=`${Ee}.removeRow`,EE=`${Ee}.removeColumn`,TE=`${Ee}.undo`,_E=`${Ee}.redo`,tm=`${Ee}.readOnly`,ME=`${Ee}.clearColumn`,IE=`${Ee}.copy`,PE=`${Ee}.copyWithHeaders`,OE=`${Ee}.copyWithGroupHeaders`,xE=`${Ee}.copyHeadersOnly`,HE=`${Ee}.cut`,AE=`${Ee}.freezeColumn`,NE=`${Ee}.unfreezeColumn`,DE=`${Ee}.mergeCells`,kE=`${Ee}.unmergeCells`,LE=`${Ee}.addComment`,$E=`${Ee}.editComment`,FE=`${Ee}.removeComment`,VE=`${Ee}.readOnlyComment`,WE=`${Ee}.align`,BE=`${Ee}.align.left`,jE=`${Ee}.align.center`,UE=`${Ee}.align.right`,zE=`${Ee}.align.justify`,YE=`${Ee}.align.top`,GE=`${Ee}.align.middle`,qE=`${Ee}.align.bottom`,KE=`${Ee}.borders`,XE=`${Ee}.borders.top`,ZE=`${Ee}.borders.right`,QE=`${Ee}.borders.bottom`,JE=`${Ee}.borders.left`,e0=`${Ee}.borders.remove`,t0=`${Ee}.nestedHeaders.insertChildRow`,n0=`${Ee}.nestedHeaders.detachFromParent`,r0=`${Ee}.hideColumn`,i0=`${Ee}.showColumn`,o0=`${Ee}.hideRow`,s0=`${Ee}.showRow`,Kn="Filters:",kt=`${Kn}conditions`,fp=`${kt}.none`,a0=`${kt}.isEmpty`,l0=`${kt}.isNotEmpty`,u0=`${kt}.isEqualTo`,c0=`${kt}.isNotEqualTo`,h0=`${kt}.beginsWith`,d0=`${kt}.endsWith`,f0=`${kt}.contains`,g0=`${kt}.doesNotContain`,NK=`${kt}.byValue`,m0=`${kt}.greaterThan`,p0=`${kt}.greaterThanOrEqualTo`,w0=`${kt}.lessThan`,v0=`${kt}.lessThanOrEqualTo`,C0=`${kt}.isBetween`,y0=`${kt}.isNotBetween`,S0=`${kt}.after`,b0=`${kt}.before`,R0=`${kt}.today`,E0=`${kt}.tomorrow`,T0=`${kt}.yesterday`,_0=`${Kn}labels.filterByCondition`,M0=`${Kn}labels.filterByValue`,I0=`${Kn}labels.conjunction`,gp=`${Kn}labels.disjunction`,nm=`${Kn}values.blankCells`,P0=`${Kn}buttons.selectAll`,O0=`${Kn}buttons.clear`,x0=`${Kn}buttons.ok`,H0=`${Kn}buttons.cancel`,A0=`${Kn}buttons.placeholder.search`,N0=`${Kn}buttons.placeholder.value`,D0=`${Kn}buttons.placeholder.secondValue`,k0="CheckboxRenderer:",L0=`${k0}checked`,$0=`${k0}unchecked`,DK=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:L0,CHECKBOX_RENDERER_NAMESPACE:k0,CHECKBOX_UNCHECKED:$0,CONTEXTMENU_ITEMS_ADD_COMMENT:LE,CONTEXTMENU_ITEMS_ALIGNMENT:WE,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:qE,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:jE,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:zE,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:BE,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:GE,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:UE,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:YE,CONTEXTMENU_ITEMS_BORDERS:KE,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:QE,CONTEXTMENU_ITEMS_BORDERS_LEFT:JE,CONTEXTMENU_ITEMS_BORDERS_RIGHT:ZE,CONTEXTMENU_ITEMS_BORDERS_TOP:XE,CONTEXTMENU_ITEMS_CLEAR_COLUMN:ME,CONTEXTMENU_ITEMS_COPY:IE,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:xE,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:OE,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:PE,CONTEXTMENU_ITEMS_CUT:HE,CONTEXTMENU_ITEMS_EDIT_COMMENT:$E,CONTEXTMENU_ITEMS_FREEZE_COLUMN:AE,CONTEXTMENU_ITEMS_HIDE_COLUMN:r0,CONTEXTMENU_ITEMS_HIDE_ROW:o0,CONTEXTMENU_ITEMS_INSERT_LEFT:SE,CONTEXTMENU_ITEMS_INSERT_RIGHT:bE,CONTEXTMENU_ITEMS_MERGE_CELLS:DE,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:n0,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:t0,CONTEXTMENU_ITEMS_NO_ITEMS:vE,CONTEXTMENU_ITEMS_READ_ONLY:tm,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:VE,CONTEXTMENU_ITEMS_REDO:_E,CONTEXTMENU_ITEMS_REMOVE_BORDERS:e0,CONTEXTMENU_ITEMS_REMOVE_COLUMN:EE,CONTEXTMENU_ITEMS_REMOVE_COMMENT:FE,CONTEXTMENU_ITEMS_REMOVE_ROW:RE,CONTEXTMENU_ITEMS_ROW_ABOVE:CE,CONTEXTMENU_ITEMS_ROW_BELOW:yE,CONTEXTMENU_ITEMS_SHOW_COLUMN:i0,CONTEXTMENU_ITEMS_SHOW_ROW:s0,CONTEXTMENU_ITEMS_UNDO:TE,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:NE,CONTEXTMENU_ITEMS_UNMERGE_CELLS:kE,CONTEXT_MENU_ITEMS_NAMESPACE:ZD,FILTERS_BUTTONS_CANCEL:H0,FILTERS_BUTTONS_CLEAR:O0,FILTERS_BUTTONS_OK:x0,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:A0,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:D0,FILTERS_BUTTONS_PLACEHOLDER_VALUE:N0,FILTERS_BUTTONS_SELECT_ALL:P0,FILTERS_CONDITIONS_AFTER:S0,FILTERS_CONDITIONS_BEFORE:b0,FILTERS_CONDITIONS_BEGINS_WITH:h0,FILTERS_CONDITIONS_BETWEEN:C0,FILTERS_CONDITIONS_BY_VALUE:NK,FILTERS_CONDITIONS_CONTAINS:f0,FILTERS_CONDITIONS_EMPTY:a0,FILTERS_CONDITIONS_ENDS_WITH:d0,FILTERS_CONDITIONS_EQUAL:u0,FILTERS_CONDITIONS_GREATER_THAN:m0,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:p0,FILTERS_CONDITIONS_LESS_THAN:w0,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:v0,FILTERS_CONDITIONS_NAMESPACE:kt,FILTERS_CONDITIONS_NONE:fp,FILTERS_CONDITIONS_NOT_BETWEEN:y0,FILTERS_CONDITIONS_NOT_CONTAIN:g0,FILTERS_CONDITIONS_NOT_EMPTY:l0,FILTERS_CONDITIONS_NOT_EQUAL:c0,FILTERS_CONDITIONS_TODAY:R0,FILTERS_CONDITIONS_TOMORROW:E0,FILTERS_CONDITIONS_YESTERDAY:T0,FILTERS_DIVS_FILTER_BY_CONDITION:_0,FILTERS_DIVS_FILTER_BY_VALUE:M0,FILTERS_LABELS_CONJUNCTION:I0,FILTERS_LABELS_DISJUNCTION:gp,FILTERS_NAMESPACE:Kn,FILTERS_VALUES_BLANK_CELLS:nm},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const QD={languageCode:"en-US",[vE]:"No available options",[CE]:"Insert row above",[yE]:"Insert row below",[SE]:"Insert column left",[bE]:"Insert column right",[RE]:["Remove row","Remove rows"],[EE]:["Remove column","Remove columns"],[TE]:"Undo",[_E]:"Redo",[tm]:"Read only",[ME]:"Clear column",[WE]:"Alignment",[BE]:"Left",[jE]:"Center",[UE]:"Right",[zE]:"Justify",[YE]:"Top",[GE]:"Middle",[qE]:"Bottom",[AE]:"Freeze column",[NE]:"Unfreeze column",[KE]:"Borders",[XE]:"Top",[ZE]:"Right",[QE]:"Bottom",[JE]:"Left",[e0]:"Remove border(s)",[LE]:"Add comment",[$E]:"Edit comment",[FE]:"Delete comment",[VE]:"Read-only comment",[DE]:"Merge cells",[kE]:"Unmerge cells",[IE]:"Copy",[PE]:["Copy with header","Copy with headers"],[OE]:["Copy with group header","Copy with group headers"],[xE]:["Copy header only","Copy headers only"],[HE]:"Cut",[t0]:"Insert child row",[n0]:"Detach from parent",[r0]:["Hide column","Hide columns"],[i0]:["Show column","Show columns"],[o0]:["Hide row","Hide rows"],[s0]:["Show row","Show rows"],[fp]:"None",[a0]:"Is empty",[l0]:"Is not empty",[u0]:"Is equal to",[c0]:"Is not equal to",[h0]:"Begins with",[d0]:"Ends with",[f0]:"Contains",[g0]:"Does not contain",[m0]:"Greater than",[p0]:"Greater than or equal to",[w0]:"Less than",[v0]:"Less than or equal to",[C0]:"Is between",[y0]:"Is not between",[S0]:"After",[b0]:"Before",[R0]:"Today",[E0]:"Tomorrow",[T0]:"Yesterday",[nm]:"Blank cells",[_0]:"Filter by condition",[M0]:"Filter by value",[I0]:"And",[gp]:"Or",[P0]:"Select all",[O0]:"Clear",[x0]:"OK",[H0]:"Cancel",[A0]:"Search",[N0]:"Value",[D0]:"Second value",[L0]:"Checked",[$0]:"Unchecked"},kK=DK,mb=QD.languageCode,{register:LK,getItem:JD,hasItem:$K,getValues:FK}=ri("languagesDictionaries");ek(QD);function ek(t,e){let n=t,r=e;return Ae(t)&&(r=t,n=r.languageCode),VK(n,r),LK(n,qn(r)),qn(r)}function VK(t,e){t!==mb&&IK(e,JD(mb))}function tk(t){return F0(t)?qn(JD(t)):null}function F0(t){return $K(t)}function WK(){return FK()}function nk(t,e,n){const r=tk(t);if(r===null)return null;const i=r[e];if(Mt(i))return null;const o=BK(i,n);return Array.isArray(o)?o[0]:o}function BK(t,e){let n=t;return P(AK(),r=>{n=r(t,e)}),n}function jK(t){let e=KD(t);return F0(e)||(e=mb,XD(t)),e}function UK(t,e,n){return(e=zK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zK(t){var e=YK(t,"string");return typeof e=="symbol"?e:e+""}function YK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ls extends ND{constructor(e,n){super(e,null),UK(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function ey(t){let{activeHeaderClassName:e,...n}=t;return new ls({className:e,...n,selectionType:DD})}function GK(t){let{areaCornerVisible:e,...n}=t;return new ls({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:rE})}function qK(t){let{...e}=t;return new ls({className:"highlight",...e,selectionType:rE})}function KK(t){let{columnClassName:e,...n}=t;return new ls({className:e,...n,selectionType:mq})}function XK(t){let{cellCornerVisible:e,...n}=t;return new ls({className:"current",headerAttributes:[FR()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:em})}function ZK(t){let{border:e,visualCellRange:n,...r}=t;return new ls({...e,...r,selectionType:pq},n)}function QK(t){let{...e}=t;return new ls({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:fq})}function gx(t){let{headerClassName:e,...n}=t;return new ls({className:e,...n,selectionType:nE})}function JK(t){let{rowClassName:e,...n}=t;return new ls({className:e,...n,selectionType:gq})}function e3(t,e){t3(t,e),e.add(t)}function t3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function er(t,e,n){return(e=n3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n3(t){var e=r3(t,"string");return typeof e=="symbol"?e:e+""}function r3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _o(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Li=new WeakSet;class i3{constructor(e){e3(this,Li),er(this,"options",void 0),er(this,"layerLevel",0),er(this,"focus",void 0),er(this,"fill",void 0),er(this,"layeredAreas",new Map),er(this,"areas",new Map),er(this,"rowHeaders",new Map),er(this,"columnHeaders",new Map),er(this,"activeRowHeaders",new Map),er(this,"activeColumnHeaders",new Map),er(this,"activeCornerHeaders",new Map),er(this,"rowHighlights",new Map),er(this,"columnHighlights",new Map),er(this,"customSelections",[]),this.options=e,this.focus=XK(e),this.fill=QK(e)}isEnabledFor(e,n){let r=e;e===em&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return _o(Li,this,Mo).call(this,this.layeredAreas,GK)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return _o(Li,this,Mo).call(this,this.areas,qK)}getAreas(){return[...this.areas.values()]}createRowHeader(){return _o(Li,this,Mo).call(this,this.rowHeaders,gx)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return _o(Li,this,Mo).call(this,this.columnHeaders,gx)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return _o(Li,this,Mo).call(this,this.activeRowHeaders,ey)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return _o(Li,this,Mo).call(this,this.activeColumnHeaders,ey)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return _o(Li,this,Mo).call(this,this.activeCornerHeaders,ey)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return _o(Li,this,Mo).call(this,this.rowHighlights,JK)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return _o(Li,this,Mo).call(this,this.columnHighlights,KK)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(ZK({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),P(this.areas.values(),e=>void e.clear()),P(this.layeredAreas.values(),e=>void e.clear()),P(this.rowHeaders.values(),e=>void e.clear()),P(this.columnHeaders.values(),e=>void e.clear()),P(this.activeRowHeaders.values(),e=>void e.clear()),P(this.activeColumnHeaders.values(),e=>void e.clear()),P(this.activeCornerHeaders.values(),e=>void e.clear()),P(this.rowHighlights.values(),e=>void e.clear()),P(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Mo(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function mx(t,e,n){return(e=o3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o3(t){var e=s3(t,"string");return typeof e=="symbol"?e:e+""}function s3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class V0{constructor(e){mx(this,"ranges",[]),mx(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((r,i)=>r.includes(e)&&n(r,i))}findAll(e){const n=[];return this.ranges.forEach((r,i)=>{r.isEqual(e)&&n.push({range:r,layer:i})}),n}remove(e){return this.ranges=this.ranges.filter(n=>!e.some(r=>r.isEqual(n))),this}removeLayers(e){return this.ranges=this.ranges.filter((n,r)=>!e.includes(r)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new V0(this.createCellRange);return e.ranges=this.ranges.map(n=>n.clone()),e}map(e){return this.ranges=this.ranges.map((n,r)=>e(n,r)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function a3(t,e){rk(t,e),e.add(t)}function ty(t,e,n){rk(t,e),e.set(t,n)}function rk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ze(t,e){return t.get(Zt(t,e))}function lf(t,e,n){return t.set(Zt(t,e),n),n}function Zt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var uf=new WeakMap,wt=new WeakMap,Ei=new WeakMap,cn=new WeakSet;class pb{constructor(e,n){a3(this,cn),ty(this,uf,void 0),ty(this,wt,void 0),ty(this,Ei,{x:0,y:0}),lf(uf,this,e),lf(wt,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=ze(wt,this).createCellCoords(e,n);let o=ze(uf,this).current().highlight;const s=ze(wt,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=Zt(cn,this,ik).call(this),{row:h,col:d}=Zt(cn,this,wx).call(this,o),f=ze(wt,this).fixedRowsBottom(),m=ze(wt,this).minSpareRows(),v=ze(wt,this).minSpareCols(),S=ze(wt,this).autoWrapRow(),R=ze(wt,this).autoWrapCol(),w=ze(wt,this).createCellCoords(h+i.row,d+i.col);if(w.row>=c){const L=Or(r&&m>0&&f===0),M=w.col+1,x=ze(wt,this).createCellCoords(w.row-c,M>=u?M-u:M);this.runLocalHooks("beforeColumnWrap",L,Zt(cn,this,Dl).call(this,x),M>=u),L.value?this.runLocalHooks("insertRowRequire",ze(wt,this).countRenderableRows()):R&&w.assign(x)}else if(w.row<0){const L=Or(R),M=w.col-1,x=ze(wt,this).createCellCoords(c+w.row,M<0?u+M:M);this.runLocalHooks("beforeColumnWrap",L,Zt(cn,this,Dl).call(this,x),M<0),R&&w.assign(x)}if(w.col>=u){const L=Or(r&&v>0),M=w.row+1,x=ze(wt,this).createCellCoords(M>=c?M-c:M,w.col-u);this.runLocalHooks("beforeRowWrap",L,Zt(cn,this,Dl).call(this,x),M>=c),L.value?this.runLocalHooks("insertColRequire",ze(wt,this).countRenderableColumns()):S&&w.assign(x)}else if(w.col<0){const L=Or(S),M=w.row-1,x=ze(wt,this).createCellCoords(M<0?c+M:M,u+w.col);this.runLocalHooks("beforeRowWrap",L,Zt(cn,this,Dl).call(this,x),M<0),S&&w.assign(x)}const{rowDir:_,colDir:O}=Zt(cn,this,px).call(this,w);a=_,l=O,o=Zt(cn,this,Dl).call(this,w)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const r=ze(wt,this).createCellCoords(e,n),i=ze(uf,this).current(),o=ze(wt,this).visualToRenderableCoords(i.highlight),s=Zt(cn,this,ny).call(this,i.to.row,i.from.row),a=Zt(cn,this,ry).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=Zt(cn,this,wx).call(this,i.highlight),f=ze(wt,this).createCellCoords(s+r.row,a+r.col),m=i.getTopStartCorner(),v=i.getTopEndCorner(),S=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const O=f.col-d;f.col=Zt(cn,this,ry).call(this,m.col,v.col)+O}else if(r.col>0&&a<=d&&f.col>d){const O=Zt(cn,this,ry).call(this,v.col,m.col),L=Math.max(f.col-O,1);f.col=O+L}if(r.row<0&&s>=h&&f.row<h){const O=f.row-h;f.row=Zt(cn,this,ny).call(this,m.row,S.row)+O}else if(r.row>0&&s<=h&&f.row>h){const O=Zt(cn,this,ny).call(this,S.row,m.row),L=Math.max(f.row-O,1);f.row=O+L}const{rowDir:R,colDir:w}=Zt(cn,this,px).call(this,f);u=R,c=w;const _=Zt(cn,this,Dl).call(this,f);r.row===0&&r.col!==0?l.col=_.col:r.row!==0&&r.col===0?l.row=_.row:(l.row=_.row,l.col=_.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;lf(Ei,this,{x:n,y:r})}resetOffsetSize(){lf(Ei,this,{x:0,y:0})}}function px(t){const{width:e,height:n}=Zt(cn,this,ik).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function ik(){return{width:ze(Ei,this).x+ze(wt,this).countRenderableColumns(),height:ze(Ei,this).y+ze(wt,this).countRenderableRows()}}function ny(t,e){const n=ze(wt,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:ze(Ei,this).y+n}function ry(t,e){const n=ze(wt,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:ze(Ei,this).x+n}function wx(t){const{row:e,col:n}=ze(wt,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return ze(wt,this).createCellCoords(ze(Ei,this).y+e,ze(Ei,this).x+n)}function Dl(t){const e=t.clone();return e.col=t.col-ze(Ei,this).x,e.row=t.row-ze(Ei,this).y,ze(wt,this).renderableToVisualCoords(e)}ct(pb,bn);const mp=0,pp=1,ok=2,W0=3,l3=[W0,ok],u3=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],iy=Symbol("root"),vx=Symbol("child");function Fu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:iy;if(e!==iy&&e!==vx)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===iy;let i=mp;if(n){const o=t[0];t.length===0?i=pp:r&&o instanceof bd?i=W0:r&&Array.isArray(o)?i=Fu(o,vx):t.length>=2&&t.length<=4&&!t.some((a,l)=>!u3[l].includes(typeof a))&&(i=ok)}return i}function Kh(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!l3.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===W0;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Mt(u)&&(u=a),Mt(c)&&(c=l),!r){const f=a,m=l,v=u,S=c;a=Math.min(f,v),l=Math.min(m,S),u=Math.max(f,v),c=Math.max(m,S)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function c3(t){const e=Fu(t.getSelected());if(e===mp||e===pp)return[];const n=Kh(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;P(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;P(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return pr(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function h3(t){const e=Fu(t.getSelected());if(e===mp||e===pp)return[];const n=Kh(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;P(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;P(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return pr(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function kl(t,e,n){d3(t,e),e.set(t,n)}function d3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ca(t,e,n){return(e=f3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f3(t){var e=g3(t,"string");return typeof e=="symbol"?e:e+""}function g3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yt(t,e){return t.get(sk(t,e))}function $i(t,e,n){return t.set(sk(t,e),n),n}function sk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Tn=new WeakMap,ha=new WeakMap,cf=new WeakMap,Oc=new WeakMap,hf=new WeakMap,xc=new WeakMap;class ak{constructor(e,n){var r=this;ca(this,"settings",void 0),ca(this,"tableProps",void 0),ca(this,"inProgress",!1),ca(this,"selectedRange",new V0((i,o,s)=>this.tableProps.createCellRange(i,o,s))),ca(this,"highlight",void 0),kl(this,Tn,void 0),kl(this,ha,void 0),ca(this,"selectedByRowHeader",new Set),ca(this,"selectedByColumnHeader",new Set),kl(this,cf,!1),kl(this,Oc,!1),kl(this,hf,"unknown"),kl(this,xc,-1),this.settings=e,this.tableProps=n,this.highlight=new i3({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[FR()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),$i(Tn,this,new pb(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),$i(ha,this,new pb(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),yt(Tn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),yt(Tn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),yt(Tn,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),yt(Tn,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),yt(Tn,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),yt(Tn,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),yt(Tn,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),yt(Tn,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),yt(ha,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),yt(ha,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){$i(hf,this,e)}markEndSource(){$i(hf,this,"unknown")}getSelectionSource(){return yt(hf,this)}setExpectedLayers(e){$i(xc,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,$i(xc,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Mt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();$i(cf,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Mt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=yt(xc,this)===-1||this.selectedRange.size()===yt(xc,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(P(this.highlight.getAreas(),m=>void m.clear()),P(this.highlight.getLayeredAreas(),m=>void m.clear()),P(this.highlight.getRowHeaders(),m=>void m.clear()),P(this.highlight.getColumnHeaders(),m=>void m.clear()),P(this.highlight.getActiveRowHeaders(),m=>void m.clear()),P(this.highlight.getActiveColumnHeaders(),m=>void m.clear()),P(this.highlight.getActiveCornerHeaders(),m=>void m.clear()),P(this.highlight.getRowHighlights(),m=>void m.clear()),P(this.highlight.getColumnHighlights(),m=>void m.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(rE,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const m=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(m.from).commit().syncWith(m),this.highlight.createLayeredArea().add(m.from).commit().syncWith(m),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(nE,e.highlight)){if(!e.isSingleHeader()){const S=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),R=this.tableProps.createCellCoords(e.to.row,-1),w=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),_=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(S).commit(),l.add(w).commit(),d.add(S).commit(),f.add(w).commit()):(a.add(S).add(R).commit(),l.add(w).add(_).commit(),d.add(S).add(R).commit(),f.add(w).add(_).commit())}const m=!yt(Oc,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),v=!yt(Oc,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());m&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),m&&v&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(em,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||($i(cf,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?yt(Tn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):yt(Tn,this).resetOffsetSize(),this.setRangeStart(yt(Tn,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?yt(Tn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):yt(Tn,this).resetOffsetSize(),this.setRangeEnd(yt(Tn,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?yt(ha,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):yt(ha,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=yt(ha,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Be(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(Be(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Be(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,Be(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,Be(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,Be(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current();if(!this.isSelected())return!1;const n=Or(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",n),n.value}isFocusSelectionChanged(){return this.isSelected()&&yt(cf,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;$i(Oc,this,f),d&&Number.isInteger(d?.row)&&Number.isInteger(d?.col)&&(h=this.tableProps.createCellCoords(Be(d.row,u,o-1),Be(d.col,c,s-1)));const m=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(m,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.finish(),$i(Oc,this,!1)}selectCells(e){var n=this;const r=Fu(e);if(r===pp)return!1;if(r===mp)throw new Error(tt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Kh(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),P(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,m=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(f=Be(r.row,u,s-1),m=Be(r.col,Math.min(i,o),Math.max(i,o))):(f=Be(r,u,s-1),m=i);const v=this.tableProps.createCellCoords(f,m),S=l===0?0:Be(v.row,u,-1),R=s-1,w=this.tableProps.createCellCoords(S,i),_=this.tableProps.createCellCoords(R,o);this.runLocalHooks("beforeSelectColumns",w,_,v),w.row=S,_.row=R,this.setRangeStartOnly(w,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(_),this.runLocalHooks("afterSelectColumns",w,_,v),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(h=Be(r.row,Math.min(e,n),Math.max(e,n)),d=Be(r.col,a,o-1)):(h=e,d=Be(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),m=s===0?0:Be(f.col,a,-1),v=o-1,S=this.tableProps.createCellCoords(e,m),R=this.tableProps.createCellCoords(n,v);this.runLocalHooks("beforeSelectRows",S,R,f),S.col=m,R.col=v,this.setRangeStartOnly(S,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(R),this.runLocalHooks("afterSelectRows",S,R,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.ranges.map(s=>s.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(r.length),r.forEach(s=>{const{from:a,to:l,highlight:u}=s,c=e-1,h=n-1;u.assign({row:Be(u.row,this.settings.navigableHeaders?-1/0:0,c),col:Be(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:Be(a.row,-1/0,c),col:Be(a.col,-1/0,h)}),l.assign({row:Be(l.row,-1/0,c),col:Be(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(em,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}ct(ak,bn);const Cx=/^(\r\n|\n\r|\r|\n)/,m3=/^[^\t\r\n]+/,yx=/^\t/;function p3(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(yx))t=t.replace(yx,""),n+=1,e[r][n]="";else if(t.match(Cx))t=t.replace(Cx,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(m3);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function Rh(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function da(t,e,n){return(e=w3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w3(t){var e=v3(t,"string");return typeof e=="symbol"?e:e+""}function v3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bu{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){da(this,"hot",void 0),da(this,"metaManager",void 0),da(this,"tableMeta",void 0),da(this,"dataSource",void 0),da(this,"duckSchema",void 0),da(this,"colToPropCache",void 0),da(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=WR(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(Ae(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return jD(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ne(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&le(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(le(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?zh(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let m=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?m=qn(this.getSchema()):(m=[],he(h-1,()=>m.push(null))):this.hot.dataType==="function"?m=this.tableMeta.dataSchema(l+a):(m={},rp(m,this.getSchema())),d.push(m),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,n,r)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=i==="end"?Math.min(h+1,a):h;let f=0;for(let m=d;f<n&&l+f<s;m++){if(typeof c!="number"||c>=l+f)if(u>0)for(let v=0;v<u;v+=1)typeof o[v]>"u"&&(o[v]=[]),o[v].push(null);else o.push([null]);else for(let v=0;v<u;v++)o[v].splice(m,0,null);f+=1}return f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(d,n)),this.hot.columnIndexMapper.insertIndexes(c,f,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:d}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=le(this.tableMeta.columns)||le(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];IP(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return zU(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];IP(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Jt(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=Or(a);this.hot.runHooks("modifyData",e,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Or(o);this.hot.runHooks("modifyData",e,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&Jt(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,bu.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===bu.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return Rh(this.getRange(e,n,bu.DESTINATION_RENDERER))}getCopyableText(e,n){return Rh(this.getRange(e,n,bu.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:C3,getItem:y3,hasItem:lk,getNames:Sue,getValues:bue}=ri("cellTypes");function S3(t){if(!lk(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return y3(t)}function gi(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&br(t,n),r&&Fr(t,r),i&&fu(t,i),C3(t,e)}function b3(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Jt(e,t)}function wp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?S3(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ne(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Ae(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ne(r,(o,s)=>{if(b3(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),tn(t,i)}function R3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}Ez(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Ig(t){return Number.isInteger(t)&&t>=0}function Pg(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function df(t){return t==null}const uk=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Wt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Wt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),VR(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function Sx(t,e,n){return(e=E3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E3(t){var e=T3(t,"string");return typeof e=="symbol"?e:e+""}function T3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _3(){return class{}}class M3{constructor(e){Sx(this,"metaCtor",_3()),Sx(this,"meta",void 0),this.meta=this.metaCtor.prototype,tn(this.meta,uk()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;tn(this.meta,e),wp(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function I3(t,e,n){return(e=P3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P3(t){var e=O3(t,"string");return typeof e=="symbol"?e:e+""}function O3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x3{constructor(e){I3(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){tn(this.meta,e),wp(this.meta,e,e)}}function ff(t,e,n){return(e=H3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H3(t){var e=A3(t,"string");return typeof e=="symbol"?e:e+""}function A3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rm{constructor(e){ff(this,"valueFactory",void 0),ff(this,"data",[]),ff(this,"index",[]),ff(this,"holes",new Set),this.valueFactory=e}obtain(e){Pg(()=>Ig(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Pg(()=>Ig(e)||df(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=df(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Pg(()=>Ig(e)||df(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(df(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function bx(t,e,n){return(e=N3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N3(t){var e=D3(t,"string");return typeof e=="symbol"?e:e+""}function D3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const k3=["data","width"];class L3{constructor(e){bx(this,"globalMeta",void 0),bx(this,"metas",new rm(()=>this._createMeta())),this.globalMeta=e,this.metas=new rm(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);tn(r,n),wp(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return R3(this.globalMeta.getMetaConstructor(),k3).prototype}}function Rx(t,e,n){return(e=$3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $3(t){var e=F3(t,"string");return typeof e=="symbol"?e:e+""}function F3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class V3{constructor(e){Rx(this,"columnMeta",void 0),Rx(this,"metas",new rm(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);tn(i,r),wp(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)le(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){Pg(()=>Ig(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new rm(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class ck{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new M3(e),this.tableMeta=new x3(this.globalMeta),this.columnMeta=new L3(this.globalMeta),this.cellMeta=new V3(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}ct(ck,bn);function Ex(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=Ii(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":it(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new bu(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const m=f.getSchema();t=[];let v,S=0,R=0;for(S=0,R=d.startRows;S<R;S++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)v=qn(m),t.push(v);else if(i.dataType==="array")v=qn(m[0]),t.push(v);else{v=[];for(let w=0,_=d.startCols;w<_;w++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&ve(i.rootElement,[jN(-1),np(i.countCols()+(i.view?i.countRowHeaders():0))])}function Tx(t,e,n){return(e=W3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W3(t){var e=B3(t,"string");return typeof e=="symbol"?e:e+""}function B3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class j3{constructor(e){var n=this;Tx(this,"metaManager",void 0),Tx(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),ne.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Jt(e,"type")?e.type:null;let c=it(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function U3(t,e,n){z3(t,e),e.set(t,n)}function z3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oy(t,e,n){return(e=Y3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y3(t){var e=G3(t,"string");return typeof e=="symbol"?e:e+""}function G3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function q3(t,e){return t.get(K3(t,e))}function K3(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _x=new WeakMap;class X3{constructor(e){oy(this,"metaManager",void 0),oy(this,"usageTracker",new Set),oy(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),U3(this,_x,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,q3(_x,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const hk="gridDefault",na="editorManager.handlingEditor",Z3={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},Q3="hooksRefRegisterer",dk={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){P(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ne(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};as(dk,"MIXIN_NAME",Q3,{writable:!1,enumerable:!1});function ui(t,e,n){return(e=J3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J3(t){var e=eX(t,"string");return typeof e=="symbol"?e:e+""}function eX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const tX="base",Ft=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class tc{static get EDITOR_TYPE(){return tX}constructor(e){ui(this,"hot",void 0),ui(this,"state",Ft.VIRGIN),ui(this,"_opened",!1),ui(this,"_fullEditMode",!1),ui(this,"_closeCallback",null),ui(this,"TD",null),ui(this,"row",null),ui(this,"col",null),ui(this,"prop",null),ui(this,"originalValue",null),ui(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Ft.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Ft.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=Ft.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:It(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Ft.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Ft.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=Ft.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Ft.FINISHED,this.discardEditor(s)}):(this.state=Ft.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Ft.FINISHED,this.discardEditor()}discardEditor(e){this.state===Ft.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Ft.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Ft.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Ft.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=An(n),a=Yt(n),l=An(this.hot.rootElement),u=Yt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,m=o.innerWidth-l.left-u,{wtTable:v}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,S=v.name,R=["master","inline_start"].includes(S)?d:0,w=["master","top","bottom"].includes(S)?f:0,_=s.top===l.top?0:1;let O=s.top-l.top-_-R,L=0;this.hot.isRtl()?L=o.innerWidth-s.left-a-m-1+w:L=s.left-l.left-1-w,["top","top_inline_start_corner"].includes(S)&&(O+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(S)&&(L+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const M=this.hot.hasColHeaders(),x=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),z=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),A=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(M&&x<=0||x===A)&&(O+=1),z<=0&&(L+=1);const Z=i.rowsRenderCalculator.startPosition,X=i.columnsRenderCalculator.startPosition,oe=Math.abs(r.inlineStartOverlay.getScrollPosition()),ee=r.topOverlay.getScrollPosition(),ae=Cn(this.hot.rootDocument);let ht=n.offsetTop;if(["inline_start","master"].includes(S)&&(ht+=Z-ee),["bottom","bottom_inline_start_corner"].includes(S)){const{wtViewport:B,wtTable:Y}=r.bottomOverlay.clone;ht+=B.getWorkspaceHeight()-Y.getHeight()-ae}let Ie=n.offsetLeft;this.hot.isRtl()?(Ie>=0?Ie=v.getWidth()-n.offsetLeft:Ie=Math.abs(Ie),Ie+=X-oe-a):["top","master","bottom"].includes(S)&&(Ie+=X-oe);const De=o.getComputedStyle(this.TD),vt=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",nt=parseInt(De[vt],10)>0?0:1,st=parseInt(De.borderTopWidth,10)>0?0:1,gn=Yt(n)+nt,g=en(n)+st,p=iD(c)?ae:0,y=oD(h)?ae:0,N=this.hot.view.maximumVisibleElementWidth(Ie)-p+nt,F=Math.max(this.hot.view.maximumVisibleElementHeight(ht)-y+st,this.hot.stylesHandler.getDefaultRowHeight());return{top:O,start:L,height:g,maxHeight:F,width:gn,maxWidth:N}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}ct(tc,dk);const nX={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===Ft.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},rX={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},iX={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},oX={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},sX={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),Hi(e))}};function aX(){return[Z3,nX,rX,iX,oX,sX]}const lX={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},uX={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},cX={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},hX={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},dX={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},fX={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},gX={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},mX={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},pX={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},wX={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},vX={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},CX={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},yX={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},SX={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function bX(){return[lX,uX,cX,hX,dX,fX,gX,mX,pX,wX,vX,CX,yX,SX]}const RX={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},EX={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},TX={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},_X={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},MX={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},IX={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},PX={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},OX={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},xX={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},HX={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},AX={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},NX={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},DX={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},kX={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},LX={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},$X={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function FX(){return[RX,EX,TX,_X,MX,IX,PX,OX,xX,HX,AX,NX,DX,kX,LX,$X]}const VX={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},WX={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},BX={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},jX={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},UX={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},zX=[...aX(),...bX(),...FX(),VX,WX,BX,jX,UX];function fk(t){const e={};return zX.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function YX(t){const e=t.getShortcutManager().addContext("editor"),n=fk(t),r={group:na};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function GX(t){const e=t.getShortcutManager().addContext("grid"),n=fk(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return le(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:hk};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:na,runOnlyIf:()=>le(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function qX(t){[GX,YX].forEach(e=>e(t))}function KX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=Mx(t),i=Mx(t);return r.addEventListener("focus",()=>e?.onFocusFromTop()),i.addEventListener("focus",()=>e?.onFocusFromBottom()),n.before(r),n.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function Mx(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&ve(n,[Du("Focus catcher")]),n}function XX(t){const e=ZX(t);let n;const{activate:r,deactivate:i}=KX(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:wb(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:vb(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,m,v)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,v.value=!0),s){var S;n=(S=t.getSelectedRangeLast())===null||S===void 0?void 0:S.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:hk,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?wb(t):vb(t)),u(),!1;h.preventDefault()},position:"after"}])}function wb(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function vb(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function ZX(t){return e=>{if(!e)return null;const n=wb(t),r=vb(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function nc(t){Jo(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function vp(t){const{selection:e,view:n}=t,r=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,m=r.getBottomEndCorner().row,v=f<=h,S=m>=d;return{getComputedColumnTarget(R){return i==="mouse"||i==="keyboard"?R.col:u&&c?r.highlight.col:u?a:c?l:R.col},getComputedRowTarget(R){return i==="mouse"||i==="keyboard"?R.row:v&&S?r.highlight.row:v?f:S?m:R.row}}}function QX(t){return e=>{const n=vp(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;nc(t.getCell(r?-1:0,n,!0))})}}function JX(){return()=>{}}function e4(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:r}=t.getSelectedRangeLast().highlight;nc(t.getCell(n,r,!0))})}}function t4(t){return e=>{const n=vp(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;nc(t.getCell(i,o,!0))})}}function n4(t){return e=>{const n=vp(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;nc(t.getCell(i,o,!0))})}}function r4(t){return e=>{const n=vp(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;nc(t.getCell(n,r?-1:0,!0))})}}function i4(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{nc(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function o4(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=e4(t):e.isSelectedByCorner()?s=JX():e.isSelectedByRowHeader()?s=r4(t):e.isSelectedByColumnHeader()?s=QX(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=t4(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=i4(t):e.getSelectedRange().size()>1&&(s=n4(t)),(o=s)===null||o===void 0||o(i)}}}const Ix=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),gf=t=>t.map(e=>{const n=e.toLowerCase();return Ix.has(n)?Ix.get(n):n}).sort().join("+"),s4=t=>t.split("+"),Px=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),sy=t=>{let{which:e,key:n}=t;if(Px.has(e))return Px.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},gk=Symbol("shortcut-context");function mk(t){return Ae(t)&&t.__kindOf===gk}const a4=t=>{const e=lp({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:m=!1,relativeToGroup:v,position:S,forwardToContext:R}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Mt(c))throw new Error("You need to define the shortcut's group.");if(it(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(tt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const w={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:m};le(v)&&(w.relativeToGroup=v,w.position=S),mk(R)&&(w.forwardToContext=R),l.forEach(_=>{const O=gf(_);if(e.hasItem(O)){const M=e.getItem(O);let x=M.findIndex(z=>z.group===v);x!==-1?S==="before"?x-=1:x+=1:x=M.length,M.splice(x,0,w)}else e.addItem(O,[w])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Ne(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=gf(l);e.removeItem(u)};return{__kindOf:gk,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=gf(l),c=e.getItem(u);return le(c)?c.slice():[]},hasShortcut:l=>{const u=gf(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(m=>m.group!==l);f.length===0?i(s4(h)):(d.length=0,d.push(...f))})}}};function l4(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const u4=["meta","alt","shift","control"],Hc=l4(),Ac=[];let mf=0;function c4(t,e,n,r,i){const o=f=>u4.includes(f),s=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return f.altKey&&v.push("alt"),m&&(f.ctrlKey||f.metaKey)?v.push("control/meta"):(f.ctrlKey&&v.push("control"),f.metaKey&&v.push("meta")),f.shiftKey&&v.push("shift"),v},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||za(f))return;const v=sy(f);let S=[];o(v)||(S=s(f));const R=[v].concat(S);!i(f,R)&&(WP()&&S.includes("meta")||!WP()&&S.includes("control"))&&i(f,[v].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const m=sy(f);o(m)&&Hc.press(m)}},u=f=>{if(typeof f.key=="string"){const m=sy(f);o(m)&&Hc.release(m)}},c=()=>{Hc.releaseAll()};return{mount:()=>{let f=t;for(mf+=1;f;)mf===1&&(f.document.documentElement.addEventListener("keydown",l),Ac.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),Ac.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=ku(f)},unmount:()=>{let f=t;for(mf-=1;f;){if(mf===0){for(let m=0;m<Ac.length;m++){const{event:v,listener:S}=Ac[m];f.document.documentElement.removeEventListener(v,S)}Ac.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=ku(f)}},isPressed:f=>Hc.isPressed(f),releasePressedKeys:()=>Hc.releaseAll()}}const h4=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=lp({errorIdExists:m=>`The "${m}" context name is already registered.`});let s="grid";const a=m=>{const v=a4(m);return o.addItem(m,v),v},l=()=>s,u=m=>o.getItem(m),c=m=>{if(!o.hasItem(m))throw new Error(tt`You've tried to activate the "${m}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=m};let h=!1;const d=function(m,v){let S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const R=mk(S)?S:u(S);let w=!1;if(!R.hasShortcut(v))return w;const _=R.getShortcuts(v);for(let O=0;O<_.length;O++){const{callback:L,runOnlyIf:M,preventDefault:x,stopPropagation:z,captureCtrl:q,forwardToContext:A}=_[O];if(M(m)===!0){if(h=q,w=L(m,v)===!1,h=!1,x&&m.preventDefault(),z&&(Hi(m),m.stopPropagation()),w)break;A&&d(m,v,A)}}return w},f=c4(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function Ox(t){const{classNames:e}=Dz(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function d4(t,e){pk(t,e),e.add(t)}function fa(t,e,n){pk(t,e),e.set(t,n)}function pk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xn(t,e){return t.get(Si(t,e))}function Br(t,e,n){return t.set(Si(t,e),n),n}function Si(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const xx=23;var ga=new WeakMap,im=new WeakMap,B0=new WeakMap,Cb=new WeakMap,Ms=new WeakMap,gh=new WeakMap,Xh=new WeakMap,Qi=new WeakSet;class f4{constructor(e,n){d4(this,Qi),fa(this,ga,void 0),fa(this,im,void 0),fa(this,B0,void 0),fa(this,Cb,void 0),fa(this,Ms,!0),fa(this,gh,{}),fa(this,Xh,{}),Br(im,this,e),Br(Cb,this,n)}isClassicTheme(){return xn(Ms,this)}getCSSVariableValue(e){var n;if(xn(Ms,this))return null;if(xn(gh,this)[`--ht-${e}`])return xn(gh,this)[`--ht-${e}`];const r=(n=Si(Qi,this,p4).call(this,`--ht-${e}`))!==null&&n!==void 0?n:Si(Qi,this,wk).call(this,`--ht-${e}`);if(r!==null)return xn(gh,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=xn(Xh,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(xn(Ms,this))return xx;const e=Si(Qi,this,g4).call(this);return e||xx}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Br(ga,this,void 0),Br(Ms,this,!0),Si(Qi,this,ay).call(this);return}if(e&&e!==xn(ga,this)){if(!/ht-theme-.*/.test(e)){qe(`Invalid theme name: ${e}. Please provide a valid theme name.`),Br(ga,this,void 0),Br(Ms,this,!1),Si(Qi,this,ay).call(this);return}xn(ga,this)&&Si(Qi,this,w4).call(this),Br(ga,this,e),Br(Ms,this,!1),Si(Qi,this,ay).call(this)}}getThemeName(){return xn(ga,this)}}function g4(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function ay(){this.isClassicTheme()||Br(B0,this,getComputedStyle(xn(im,this)));const t=Si(Qi,this,m4).call(this,["box-sizing","border-bottom-width"]);xn(Xh,this).td={...xn(Xh,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function m4(t){const e=xn(Cb,this),n=xn(im,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function p4(t){const e=Math.ceil(parseFloat(Si(Qi,this,wk).call(this,t)));return Number.isNaN(e)?null:e}function wk(t){const e=xn(B0,this).getPropertyValue(t);return e===""?null:e}function w4(){Br(Xh,this,{}),Br(gh,this,{}),Br(Ms,this,!0)}function v4(t,e){vk(t,e),e.add(t)}function Hx(t,e,n){vk(t,e),e.set(t,n)}function vk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ax(t,e){return t.get(Vu(t,e))}function Nx(t,e,n){return t.set(Vu(t,e),n),n}function Vu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yb=new WeakMap,Sb=new WeakMap,Eh=new WeakSet;class C4{constructor(e){let{rowIndexMapper:n,columnIndexMapper:r}=e;v4(this,Eh),Hx(this,yb,void 0),Hx(this,Sb,void 0),Nx(yb,this,n),Nx(Sb,this,r)}toRenderable(e){const n=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,i=Vu(Eh,this,Dx).call(this,e.from,n,r);if(i===null)return null;const o=Vu(Eh,this,Dx).call(this,e.to,-n,-r);if(o===null)return null;const s=e.clone();return s.from=i,s.to=o,s.includes(e.highlight)||(s.highlight=i),s}}function Dx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const r=Vu(Eh,this,kx).call(this,Ax(yb,this),t.row,e);if(r===null)return null;const i=Vu(Eh,this,kx).call(this,Ax(Sb,this),t.col,n);return i===null?null:t.clone().assign({row:r,col:i})}function kx(t,e,n){return e<0?e:t.getNearestNotHiddenIndex(e,n)}let ly=null;const uy=new Map;function Ck(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new Pi(o);let a,l,u,c,h,d,f=!0;zq(i)&&Uq(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootPortalElement=void 0,this.rootElement=gu(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,gu(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),G(this.rootElement,"ht-wrapper"),G(this.rootWrapperElement,"ht-root-wrapper"),this.rootWrapperElement.appendChild(this.rootElement),this.rootContainer.appendChild(this.rootWrapperElement),G(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const m=(n=e?.layoutDirection)!==null&&n!==void 0?n:"inherit",v=["rtl","ltr"].includes(m)?m:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},this.stylesHandler=new f4(o.rootElement,o.rootDocument),e.language=jK(e.language);const S=Object.fromEntries(Object.entries(e).filter(g=>{let[p]=g;return!(ne.getSingleton().isRegistered(p)||ne.getSingleton().isDeprecated(p))})),R=new ck(o,S,[j3,X3]),w=R.getTableMeta(),_=R.getGlobalMeta(),O=lp();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),gu(this)&&XU(e.licenseKey,this.rootWrapperElement),this.guid=`ht_${kN()}`,uy.set(this.guid,this),this.columnIndexMapper=new gb,this.rowIndexMapper=new gb,this.columnIndexMapper.addLocalHook("indexesSequenceChange",g=>{o.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",g=>{o.runHooks("afterRowSequenceChange",g)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",g=>{o.runHooks("beforeCompositionStart",g)}),l=new sK(o);const L=ri(this.guid);L.register("cellRangeMapper",new C4({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const M=g=>{const{row:p,col:y}=g;return o._createCellCoords(p>=0?o.rowIndexMapper.getRenderableFromVisualIndex(p):p,y>=0?o.columnIndexMapper.getRenderableFromVisualIndex(y):y)},x=g=>{const{row:p,col:y}=g;return o._createCellCoords(p>=0?o.rowIndexMapper.getVisualFromRenderableIndex(p):p,y>=0?o.columnIndexMapper.getVisualFromRenderableIndex(y):y)},z=(g,p)=>{const y=p>g?1:-1,N=Math.min(g,p),F=Math.max(g,p),B=o.rowIndexMapper.getNearestNotHiddenIndex(g,y);return B===null||y===1&&B>F||y===-1&&B<N?null:B>=0?o.rowIndexMapper.getRenderableFromVisualIndex(B):B},q=(g,p)=>{const y=p>g?1:-1,N=Math.min(g,p),F=Math.max(g,p),B=o.columnIndexMapper.getNearestNotHiddenIndex(g,y);return B===null||y===1&&B>F||y===-1&&B<N?null:B>=0?o.columnIndexMapper.getRenderableFromVisualIndex(B):B};let A=new ak(w,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:g=>a.propToCol(g),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(g,p)=>o._createCellCoords(g,p),createCellRange:(g,p,y)=>o._createCellRange(g,p,y),visualToRenderableCoords:M,renderableToVisualCoords:x,findFirstNonHiddenRenderableRow:z,findFirstNonHiddenRenderableColumn:q,isDisabledCellSelection:(g,p)=>g<0||p<0?o.getSettings().disableVisualSelection:o.getCellMeta(g,p).disableVisualSelection});this.selection=A;const Z=g=>{let{hiddenIndexesChanged:p}=g;this.forceFullRender=!0,p&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",Z),this.rowIndexMapper.addLocalHook("cacheUpdated",Z),this.selection.addLocalHook("afterSetRangeEnd",(g,p)=>{const y=Or(!1),N=this.selection.getSelectedRange(),{from:F,to:B}=N.current(),Y=N.size()-1;this.runHooks("afterSelection",F.row,F.col,B.row,B.col,y,Y),this.runHooks("afterSelectionByProp",F.row,o.colToProp(F.col),B.row,o.colToProp(B.col),y,Y),p&&(!y.isTouched()||y.isTouched()&&!y.value)&&d.scrollTo(g);const C=A.isSelectedByRowHeader(),b=A.isSelectedByColumnHeader();C&&b?G(this.rootElement,["ht__selection--rows","ht__selection--columns"]):C?(pe(this.rootElement,"ht__selection--columns"),G(this.rootElement,"ht__selection--rows")):b?(pe(this.rootElement,"ht__selection--rows"),G(this.rootElement,"ht__selection--columns")):pe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(A.getSelectionSource())||c.closeEditor(null),A.getSelectionSource()!=="refresh"&&(o.view.render(),c.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",g=>{this.runHooks("beforeSelectionFocusSet",g.row,g.col)}),this.selection.addLocalHook("afterSetFocus",g=>{const p=Or(!1);this.runHooks("afterSelectionFocusSet",g.row,g.col,p),(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(g),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",g=>{const p=g.length-1,{from:y,to:N}=g[p];this.runHooks("afterSelectionEnd",y.row,y.col,N.row,N.col,p),this.runHooks("afterSelectionEndByProp",y.row,o.colToProp(y.col),N.row,o.colToProp(N.col),p),A.getSelectionSource()==="refresh"&&(o.view.render(),c.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",g=>{const p=this.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=p)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),pe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeSetRangeStart",...p)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeSetRangeStartOnly",...p)}).addLocalHook("beforeSetRangeEnd",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeSetRangeEnd",...p)}).addLocalHook("beforeSelectColumns",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeSelectColumns",...p)}).addLocalHook("afterSelectColumns",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("afterSelectColumns",...p)}).addLocalHook("beforeSelectRows",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeSelectRows",...p)}).addLocalHook("afterSelectRows",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("afterSelectRows",...p)}).addLocalHook("beforeModifyTransformStart",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("modifyTransformStart",...p)}).addLocalHook("afterModifyTransformStart",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("afterModifyTransformStart",...p)}).addLocalHook("beforeModifyTransformFocus",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("modifyTransformFocus",...p)}).addLocalHook("afterModifyTransformFocus",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("afterModifyTransformFocus",...p)}).addLocalHook("beforeModifyTransformEnd",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("modifyTransformEnd",...p)}).addLocalHook("afterModifyTransformEnd",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("afterModifyTransformEnd",...p)}).addLocalHook("beforeRowWrap",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeRowWrap",...p)}).addLocalHook("beforeColumnWrap",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeColumnWrap",...p)}).addLocalHook("insertRowRequire",g=>this.alter("insert_row_above",g,1,"auto")).addLocalHook("insertColRequire",g=>this.alter("insert_col_start",g,1,"auto")),u={alter(g,p){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,N=arguments.length>3?arguments[3]:void 0,F=arguments.length>4?arguments[4]:void 0;const B=Y=>{if(Y.length===0)return[];const C=[...Y];return C.sort((E,T)=>{let[I]=E,[k]=T;return I===k?0:I>k?1:-1}),pr(C,(E,T)=>{let[I,k]=T;const W=E[E.length-1],[H,$]=W,V=H+$;if(I<=V){const j=Math.max(k-(V-I),0);W[1]+=j}else E.push([I,k]);return E},[C[0]])};switch(g){case"insert_row_below":case"insert_row_above":const Y=o.countSourceRows();if(w.maxRows===Y)return;const C=g==="insert_row_below"?"below":"above";p=p??(C==="below"?Y:0);const{delta:b,startPhysicalIndex:E}=a.createRow(p,y,{source:N,mode:C});A.shiftRows(o.toVisualRow(E),b);break;case"insert_col_start":case"insert_col_end":const T=g==="insert_col_end"?"end":"start";p=p??(T==="end"?o.countSourceCols():0);const{delta:I,startPhysicalIndex:k}=a.createCol(p,y,{source:N,mode:T});if(I){if(Array.isArray(w.colHeaders)){const $=[o.toVisualColumn(k),0];$.length+=I,Array.prototype.splice.apply(w.colHeaders,$)}A.shiftColumns(o.toVisualColumn(k),I)}break;case"remove_row":const W=$=>{let V=0;P($,j=>{let[U,ie]=j;const se=Wt(U)?o.countRows()-1:Math.max(U-V,0);if(Number.isInteger(U)&&(U=Math.max(U-V,0)),!a.removeRow(U,ie,N))return;if(A.isSelected()){const{row:ye}=o.getSelectedRangeLast().highlight;ye>=U&&ye<=U+ie-1&&c.closeEditor(!0)}const $e=o.countRows(),Fe=w.fixedRowsTop;Fe>=se+1&&(w.fixedRowsTop-=Math.min(ie,Fe-se));const be=w.fixedRowsBottom;if(be&&se>=$e-be&&(w.fixedRowsBottom-=Math.min(ie,be)),$e===0)A.deselect();else if(N==="ContextMenu.removeRow"){const ye=A.getSelectedRange(),Je=ye.pop();ye.clear().set(Je.from).current().setTo(Je.to),A.refresh()}else A.shiftRows(U,-ie);V+=ie})};Array.isArray(p)?W(B(p)):W([[p,y]]);break;case"remove_col":const H=$=>{let V=0;P($,j=>{let[U,ie]=j;const se=Wt(U)?o.countCols()-1:Math.max(U-V,0);let Se=o.toPhysicalColumn(se);if(Number.isInteger(U)&&(U=Math.max(U-V,0)),!a.removeCol(U,ie,N))return;if(A.isSelected()){const{col:ye}=o.getSelectedRangeLast().highlight;ye>=U&&ye<=U+ie-1&&c.closeEditor(!0)}if(o.countCols()===0)A.deselect();else if(N==="ContextMenu.removeColumn"){const ye=A.getSelectedRange(),Je=ye.pop();ye.clear().set(Je.from).current().setTo(Je.to),A.refresh()}else A.shiftColumns(U,-ie);const be=w.fixedColumnsStart;be>=se+1&&(w.fixedColumnsStart-=Math.min(ie,be-se)),Array.isArray(w.colHeaders)&&(typeof Se>"u"&&(Se=-1),w.colHeaders.splice(Se,ie)),V+=ie})};Array.isArray(p)?H(B(p)):H([[p,y]]);break;default:throw new Error(`There is no such action "${g}"`)}F||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const g=w.minRows,p=w.minSpareRows,y=w.minCols,N=w.minSpareCols;if(g){const F=o.countRows();F<g&&a.createRow(F,g-F,{source:"auto"})}if(p){const F=o.countEmptyRows(!0);if(F<p){const B=p-F,Y=Math.min(B,w.maxRows-o.countSourceRows());a.createRow(o.countRows(),Y,{source:"auto"})}}{let F;(y||N)&&(F=o.countEmptyCols(!0));let B=o.countCols();if(y&&!w.columns&&B<y){const Y=y-B;F+=Y,a.createCol(B,Y,{source:"auto"})}if(N&&!w.columns&&o.dataType==="array"&&F<N){B=o.countCols();const Y=N-F,C=Math.min(Y,w.maxCols-B);a.createCol(B,C,{source:"auto"})}}},populateFromArray(g,p,y,N,F){let B,Y,C,b;const E=[],T={},I=[],k=g.row,W=g.col;if(Y=p.length,Y===0)return!1;let H=0,$=0;switch(Ae(y)&&(H=y.col-W+1,$=y.row-k+1),F){case"shift_down":const V=Tg(p),j=V.length,U=Math.max(j,H),ie=o.getData().slice(k),se=Tg(ie).slice(W,W+U);for(C=0;C<U;C+=1)if(C<j){for(B=0,Y=V[C].length;B<$-Y;B+=1)V[C].push(V[C][B%Y]);C<se.length?I.push(V[C].concat(se[C])):I.push(V[C].concat(new Array(ie.length).fill(null)))}else I.push(V[C%j].concat(se[C]));o.populateFromArray(k,W,Tg(I));break;case"shift_right":const Se=p.length,$e=Math.max(Se,$),Fe=o.getData().slice(k).map(Ct=>Ct.slice(W));for(B=0;B<$e;B+=1)if(B<Se){for(C=0,b=p[B].length;C<H-b;C+=1)p[B].push(p[B][C%b]);if(B<Fe.length)for(let Ct=0;Ct<Fe[B].length;Ct+=1)p[B].push(Fe[B][Ct]);else p[B].push(...new Array(Fe[0].length).fill(null))}else p.push(p[B%Y].slice(0,$e).concat(Fe[B]));o.populateFromArray(k,W,p);break;case"overwrite":default:T.row=g.row,T.col=g.col;let be=0,ye=0,Je=!0,Xn;const vo=function(Et){let mt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Xe=p[Et%p.length];return mt!==null?Xe[mt%Xe.length]:Xe},oi=p.length,an=y?y.row-g.row+1:0;for(y?Y=an:Y=Math.max(oi,an),B=0;B<Y&&!(y&&T.row>y.row&&an>oi||!w.allowInsertRow&&T.row>o.countRows()-1||T.row>=w.maxRows);B++){const Ct=B-be,Et=vo(Ct).length,mt=y?y.col-g.col+1:0;if(y?b=mt:b=Math.max(Et,mt),T.col=g.col,Xn=o.getCellMeta(T.row,T.col),(N==="CopyPaste.paste"||N==="Autofill.fill")&&Xn.skipRowOnPaste){be+=1,T.row+=1,Y+=1;continue}for(ye=0,C=0;C<b&&!(y&&T.col>y.col&&mt>Et||!w.allowInsertColumn&&T.col>o.countCols()-1||T.col>=w.maxCols);C++){if(Xn=o.getCellMeta(T.row,T.col),(N==="CopyPaste.paste"||N==="Autofill.fill")&&Xn.skipColumnOnPaste){ye+=1,T.col+=1,b+=1;continue}if(Xn.readOnly&&N!=="UndoRedo.undo"){T.col+=1;continue}const Xe=C-ye;let Hr=vo(Ct,Xe),Dn=o.getDataAtCell(T.row,T.col);if(Hr!==null&&typeof Hr=="object")if(Array.isArray(Hr)&&Dn===null&&(Dn=[]),Dn===null||typeof Dn!="object")Je=!1;else{const ra=zh(Array.isArray(Dn)?Dn:Dn[0]||Dn),kd=zh(Array.isArray(Hr)?Hr:Hr[0]||Hr);VR(ra,kd)||Array.isArray(ra)&&Array.isArray(kd)?Hr=qn(Hr):Je=!1}else Dn!==null&&typeof Dn=="object"&&(Je=!1);Je&&E.push([T.row,T.col,Hr]),Je=!0,T.col+=1}T.row+=1}o.setDataAtCell(E,null,null,N||"populateFromArray");break}}};function X(g){const p=KD(g);F0(p)?(o.runHooks("beforeLanguageChange",p),_.language=p,o.runHooks("afterLanguageChange",p)):XD(g)}function oe(g,p){const y=g==="className"?o.rootElement:o.table;if(f)G(y,p);else{let N=[],F=[];_[g]&&(N=Array.isArray(_[g])?_[g]:OP(_[g])),p&&(F=Array.isArray(p)?p:OP(p));const B=PP(N,F),Y=PP(F,N);B.length&&pe(y,B),Y.length&&G(y,Y)}_[g]=p}this.init=function(){l.setData(w.data),o.runHooks("beforeInit"),(lo()||KN())&&G(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new Kq(this);const g=w.themeName||Ox(o.rootContainer);o.useTheme(g),c=ub.getInstance(o,w,A),d=o4(o),h=new RY(o),gu(this)&&XX(o),o.runHooks("init"),this.render(),f&&o.rootElement.offsetParent===null&&jz(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function ee(){let g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function ae(g){const p=g.replace(",",".");return isNaN(parseFloat(p))===!1?parseFloat(p):g}function ht(g,p,y){if(!g.length){y();return}const N=o.getActiveEditor(),F=new ee;let B=!0;F.onQueueEmpty=()=>{N&&B&&N.cancelChanges(),y()};for(let Y=g.length-1;Y>=0;Y--){const[C,b]=g[Y],E=a.propToCol(b);let T;Number.isInteger(E)?T=o.getCellMeta(C,E):T={...Object.getPrototypeOf(w),...w},o.getCellValidator(T)&&(F.addValidatorToQueue(),o.validateCell(g[Y][3],T,function(I,k){return function(W){if(typeof W!="boolean")throw new Error("Validation error: result is not boolean");W===!1&&k.allowInvalid===!1&&(B=!1,g.splice(I,1),k.valid=!0),F.removeValidatorFormQueue()}}(Y,T),p))}F.checkIfQueueIsEmpty()}function Ie(g,p){for(let N=g.length-1;N>=0;N--){let F=!1;if(g[N]===null){g.splice(N,1);continue}if(!((g[N][2]===null||g[N][2]===void 0)&&(g[N][3]===null||g[N][3]===void 0))){if(w.allowInsertRow)for(;g[N][0]>o.countRows()-1;){const{delta:B}=a.createRow(void 0,void 0,{source:"auto"});if(B===0){F=!0;break}}if(o.dataType==="array"&&(!w.columns||w.columns.length===0)&&w.allowInsertColumn)for(;a.propToCol(g[N][1])>o.countCols()-1;){const{delta:B}=a.createCol(void 0,void 0,{source:"auto"});if(B===0){F=!0;break}}F||a.set(g[N][0],g[N][1],g[N][3])}}if(g.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",g,p),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",g,p||"edit");const N=o.getActiveEditor();N&&le(N.refreshValue)&&N.refreshValue()}else o.render()}this._createCellCoords=function(g,p){return o.view._wt.createCellCoords(g,p)},this._createCellRange=function(g,p,y){return o.view._wt.createCellRange(g,p,y)},this.validateCell=function(g,p,y,N){let F=o.getCellValidator(p);function B(Y){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||p.hidden===!0){y(Y);return}const b=p.visualCol,E=p.visualRow,T=o.getCell(E,b,!0);if(T&&T.nodeName!=="TH"){const I=o.rowIndexMapper.getRenderableFromVisualIndex(E),k=o.columnIndexMapper.getRenderableFromVisualIndex(b);o.view._wt.getSetting("cellRenderer",I,k,T)}y(Y)}GU(F)&&(F=function(Y){return function(C,b){b(Y.test(C))}}(F)),it(F)?(g=o.runHooks("beforeValidate",g,p.visualRow,p.prop,N),o._registerImmediate(()=>{F.call(p,g,Y=>{o&&(Y=o.runHooks("afterValidate",Y,g,p.visualRow,p.prop,N),p.valid=Y,B(Y),o.runHooks("postAfterValidate",Y,g,p.visualRow,p.prop,N))})})):o._registerImmediate(()=>{p.valid=!0,B(p.valid,!1)})};function De(g,p,y){return Array.isArray(g)?g:[[g,p,y]]}function vt(g,p){const y=o.runHooks("beforeChange",g,p||"edit"),N=g.filter(B=>B!==null);if(y===!1||N.length===0){var F;return(F=o.getActiveEditor())===null||F===void 0||F.cancelChanges(),[]}for(let B=N.length-1;B>=0;B--){const[Y,C,,b]=N[B],E=a.propToCol(C);let T;Number.isInteger(E)?T=o.getCellMeta(Y,E):T={...Object.getPrototypeOf(w),...w};const{type:I,checkedTemplate:k,uncheckedTemplate:W}=T;if(I==="numeric"&&typeof b=="string"&&LY(b)&&(N[B][3]=ae(b)),I==="checkbox"){const H=It(b),$=H===It(k),V=H===It(W);($||V)&&(N[B][3]=$?k:W)}}return N}this.setDataAtCell=function(g,p,y,N){const F=De(g,p,y),B=[];let Y=N,C,b,E;for(C=0,b=F.length;C<b;C++){if(typeof F[C]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof F[C][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");F[C][1]>=this.countCols()?E=F[C][1]:E=a.colToProp(F[C][1]),B.push([F[C][0],E,l.getAtCell(this.toPhysicalRow(F[C][0]),F[C][1]),F[C][2]])}!Y&&typeof g=="object"&&(Y=p);const T=vt(B,Y);o.runHooks("afterSetDataAtCell",T,Y),ht(T,Y,()=>{Ie(T,Y)})},this.setDataAtRowProp=function(g,p,y,N){const F=De(g,p,y),B=[];let Y=N,C,b;for(C=0,b=F.length;C<b;C++)B.push([F[C][0],F[C][1],l.getAtCell(this.toPhysicalRow(F[C][0]),F[C][1]),F[C][2]]);!Y&&typeof g=="object"&&(Y=p);const E=vt(B,N);o.runHooks("afterSetDataAtRowProp",E,Y),ht(E,Y,()=>{Ie(E,Y)})},this.listen=function(){o&&!o.isListening()&&(uy.forEach(g=>{o!==g&&g.unlisten()}),ly=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(ly=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return ly===o.guid},this.destroyEditor=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(g),o.view.render(),p&&A.isSelected()&&c.prepareEditor()},this.populateFromArray=function(g,p,y,N,F,B,Y){if(!(typeof y=="object"&&typeof y[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const C=typeof N=="number"?o._createCellCoords(N,F):null;return u.populateFromArray(o._createCellCoords(g,p),y,C,B,Y)},this.spliceCol=function(g,p,y){for(var N=arguments.length,F=new Array(N>3?N-3:0),B=3;B<N;B++)F[B-3]=arguments[B];return a.spliceCol(g,p,y,...F)},this.spliceRow=function(g,p,y){for(var N=arguments.length,F=new Array(N>3?N-3:0),B=3;B<N;B++)F[B-3]=arguments[B];return a.spliceRow(g,p,y,...F)},this.getSelected=function(){if(A.isSelected())return Ve(A.getSelectedRange(),g=>{let{from:p,to:y}=g;return[p.row,p.col,y.row,y.col]})},this.getSelectedLast=function(){const g=this.getSelected();let p;return g&&g.length>0&&(p=g[g.length-1]),p},this.getSelectedRange=function(){if(A.isSelected())return Array.from(A.getSelectedRange())},this.getSelectedRangeLast=function(){const g=this.getSelectedRange();let p;return g&&g.length>0&&(p=g[g.length-1]),p},this.emptySelectedCells=function(g){if(!A.isSelected()||this.countRows()===0||this.countCols()===0)return;const p=[];P(A.getSelectedRange(),y=>{if(y.isSingleHeader())return;const N=y.getTopStartCorner(),F=y.getBottomEndCorner();he(N.row,F.row,B=>{he(N.col,F.col,Y=>{this.getCellMeta(B,Y).readOnly||p.push([B,Y,null])})})}),p.length>0&&this.setDataAtCell(p,g)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(g){this.suspendRender();const p=g();return this.resumeRender(),p},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const p=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(p,0),(!this.isExecutionSuspended()&&p===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const y=g();return this.resumeExecution(p),y},this.batch=function(g){this.suspendRender(),this.suspendExecution();const p=g();return this.resumeExecution(),this.resumeRender(),p},this.refreshDimensions=function(){if(!o.view)return;const g=o.view,{width:p,height:y}=g.getLastSize(),{width:N,height:F}=o.rootElement.getBoundingClientRect(),B=N!==p||F!==y;o.runHooks("beforeRefreshDimensions",{width:p,height:y},{width:N,height:F},B)!==!1&&((B||g._wt.wtOverlays.scrollableElement===o.rootWindow)&&(g.setLastSize(N,F),o.render(),g.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:p,height:y},{width:N,height:F},B))},this.updateData=function(g,p){Ex(g,y=>{a=y},y=>{a=y,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),A.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:p,metaManager:R,firstRun:f})},this.loadData=function(g,p){Ex(g,y=>{a=y},()=>{R.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),A.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:p,metaManager:R,firstRun:f})},this.getInitialColumnCount=function(){const g=w.columns;let p=0;if(Array.isArray(g))p=g.length;else if(it(g))if(o.dataType==="array"){const y=this.countSourceCols();for(let N=0;N<y;N+=1)g(N)&&(p+=1)}else(o.dataType==="object"||o.dataType==="function")&&(p=a.colToPropCache.length);else if(le(w.dataSchema)){const y=a.getSchema();p=Array.isArray(y)?y.length:WR(y)}else p=this.countSourceCols();return p},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,p,y,N){return Mt(g)?a.getAll():a.getRange(o._createCellCoords(g,p),o._createCellCoords(y,N),a.DESTINATION_RENDERER)},this.getCopyableText=function(g,p,y,N){return a.getCopyableText(o._createCellCoords(g,p),o._createCellCoords(y,N))},this.getCopyableData=function(g,p){return a.getCopyable(g,a.colToProp(p))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=(f?o.loadData:o.updateData).bind(this);let N=!1,F,B;if(le(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(le(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(le(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');g.language&&X(g.language);for(F in g)if(!(F==="data"||F==="language"))if(F==="className")oe("className",g.className);else if(F==="tableClassName"&&o.table)oe("tableClassName",g.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(ne.getSingleton().isRegistered(F)||ne.getSingleton().isDeprecated(F)){const T=g[F];it(T)?(ne.getSingleton().addAsFixed(F,T,o),w[F]=T):Array.isArray(T)&&(ne.getSingleton().add(F,T,o),w[F]=T)}else!p&&Jt(g,F)&&(_[F]=g[F]);g.data===void 0&&w.data===void 0?y(null,"updateSettings"):g.data!==void 0?y(g.data,"updateSettings"):g.columns!==void 0&&(a.createMap(),o.initIndexMappers());const Y=o.countCols(),C=w.columns;if(C&&it(C)&&(N=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&R.clearCache(),Y>0)for(F=0,B=0;F<Y;F++){if(C){const T=N?C(F):C[B];T&&R.updateColumnMeta(B,T)}B+=1}le(g.cell)&&Ne(g.cell,T=>{o.setCellMetaObject(T.row,T.col,T)}),o.runHooks("afterCellMetaReset");let b=o.rootElement.style.height;b!==""&&(b=parseInt(o.rootElement.style.height,10));let E=g.height;if(it(E)&&(E=E()),p&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),E===null){const T=o.rootElement.getAttribute("data-initialstyle");T&&(T.indexOf("height")>-1||T.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",T):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else E!==void 0&&(o.rootElement.style.height=isNaN(E)?`${E}`:`${E}px`,o.rootElement.style.overflow="hidden");if(typeof g.width<"u"){let T=g.width;it(T)&&(T=T()),o.rootElement.style.width=isNaN(T)?`${T}`:`${T}px`}if(!p){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const T=o.getCurrentThemeName();Jt(g,"themeName")&&T!==g.themeName&&o.useTheme(g.themeName)}o.runHooks("afterUpdateSettings",g)}u.adjustRowsAndCols(),o.view&&!f&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!p&&o.view&&(b===""||E===""||E===void 0)&&b!==E&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const g=o.getSelectedLast();if(w.getValue){if(it(w.getValue))return w.getValue.call(o);if(g)return o.getData()[g[0][0]][w.getValue]}else if(g)return o.getDataAtCell(g[0],g[1])},this.getSettings=function(){return w},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,p,y,N,F){u.alter(g,p,y,N,F)},this.getCell=function(g,p){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,N=p,F=g;if(p>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(p)))return null;N=this.columnIndexMapper.getRenderableFromVisualIndex(p)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;F=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return F===null||N===null||F===void 0||N===void 0?null:o.view.getCellAtCoords(o._createCellCoords(F,N),y)},this.getCoords=function(g){const p=this.view._wt.wtTable.getCoords(g);if(p===null)return null;const{row:y,col:N}=p;let F=y,B=N;return y>=0&&(F=this.rowIndexMapper.getVisualFromRenderableIndex(y)),N>=0&&(B=this.columnIndexMapper.getVisualFromRenderableIndex(N)),o._createCellCoords(F,B)},this.colToProp=function(g){return a.colToProp(g)},this.propToCol=function(g){return a.propToCol(g)},this.toVisualRow=g=>this.rowIndexMapper.getVisualFromPhysicalIndex(g),this.toVisualColumn=g=>this.columnIndexMapper.getVisualFromPhysicalIndex(g),this.toPhysicalRow=g=>this.rowIndexMapper.getPhysicalFromVisualIndex(g),this.toPhysicalColumn=g=>this.columnIndexMapper.getPhysicalFromVisualIndex(g),this.getDataAtCell=function(g,p){return a.get(g,a.colToProp(p))},this.getDataAtRowProp=function(g,p){return a.get(g,p)},this.getDataAtCol=function(g){const p=[],y=a.getRange(o._createCellCoords(0,g),o._createCellCoords(w.data.length-1,g),a.DESTINATION_RENDERER);for(let N=0;N<y.length;N+=1)for(let F=0;F<y[N].length;F+=1)p.push(y[N][F]);return p},this.getDataAtProp=function(g){const p=[],y=a.getRange(o._createCellCoords(0,a.propToCol(g)),o._createCellCoords(w.data.length-1,a.propToCol(g)),a.DESTINATION_RENDERER);for(let N=0;N<y.length;N+=1)for(let F=0;F<y[N].length;F+=1)p.push(y[N][F]);return p},this.getSourceData=function(g,p,y,N){let F;return g===void 0?F=l.getData():F=l.getByRange(o._createCellCoords(g,p),o._createCellCoords(y,N)),F},this.getSourceDataArray=function(g,p,y,N){let F;return g===void 0?F=l.getData(!0):F=l.getByRange(o._createCellCoords(g,p),o._createCellCoords(y,N),!0),F},this.getSourceDataAtCol=function(g){return l.getAtColumn(g)},this.setSourceDataAtCell=function(g,p,y,N){const F=De(g,p,y),B=this.hasHook("afterSetSourceDataAtCell"),Y=[];B&&P(F,b=>{let[E,T,I]=b;Y.push([E,T,l.getAtCell(E,T),I])}),P(F,b=>{let[E,T,I]=b;l.setAtCell(E,T,I)}),B&&this.runHooks("afterSetSourceDataAtCell",Y,N),this.render();const C=o.getActiveEditor();C&&le(C.refreshValue)&&C.refreshValue()},this.getSourceDataAtRow=function(g){return l.getAtRow(g)},this.getSourceDataAtCell=function(g,p){return l.getAtCell(g,p)},this.getDataAtRow=function(g){return a.getRange(o._createCellCoords(g,0),o._createCellCoords(g,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(g,p,y,N){const F=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,p,y,N],[B,Y]=F;let[,,C,b]=F,E=null,T=null;C===void 0&&(C=B),b===void 0&&(b=Y);let I="mixed";return he(Math.max(Math.min(B,C),0),Math.max(B,C),k=>{let W=!0;return he(Math.max(Math.min(Y,b),0),Math.max(Y,b),H=>(T=this.getCellMeta(k,H).type,E?W=E===T:E=T,W)),I=W?T:"mixed",W}),I},this.removeCellMeta=function(g,p,y){const[N,F]=[this.toPhysicalRow(g),this.toPhysicalColumn(p)];let B=R.getCellMetaKeyValue(N,F,y);o.runHooks("beforeRemoveCellMeta",g,p,y,B)!==!1&&(R.removeCellMeta(N,F,y),o.runHooks("afterRemoveCellMeta",g,p,y,B)),B=null},this.spliceCellsMeta=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var y=arguments.length,N=new Array(y>2?y-2:0),F=2;F<y;F++)N[F-2]=arguments[F];if(N.length>0&&!Array.isArray(N[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");p>0&&R.removeRow(this.toPhysicalRow(g),p),N.length>0&&P(N.reverse(),B=>{R.createRow(this.toPhysicalRow(g)),P(B,(Y,C)=>this.setCellMetaObject(g,C,Y))}),o.render()},this.setCellMetaObject=function(g,p,y){typeof y=="object"&&Ne(y,(N,F)=>{this.setCellMeta(g,p,F,N)})},this.setCellMeta=function(g,p,y,N){if(o.runHooks("beforeSetCellMeta",g,p,y,N)===!1)return;let B=g,Y=p;g<this.countRows()&&(B=this.toPhysicalRow(g)),p<this.countCols()&&(Y=this.toPhysicalColumn(p)),R.setCellMeta(B,Y,y,N),o.runHooks("afterSetCellMeta",g,p,y,N)},this.getCellsMeta=function(){return R.getCellsMeta()},this.getCellMeta=function(g,p){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},N=this.toPhysicalRow(g),F=this.toPhysicalColumn(p);return N===null&&(N=g),F===null&&(F=p),R.getCellMeta(N,F,{visualRow:g,visualColumn:p,...y})},this.getColumnMeta=function(g){return R.getColumnMeta(this.toPhysicalColumn(g))},this.getCellMetaAtRow=function(g){return R.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||w.columns)},this.getCellRenderer=function(g,p){const y=typeof g=="number"?o.getCellMeta(g,p).renderer:g.renderer;return typeof y=="string"?db(y):Mt(y)?db("text"):y},this.getCellEditor=function(g,p){const y=typeof g=="number"?o.getCellMeta(g,p).editor:g.editor;return typeof y=="string"?lb(y):Mt(y)?lb("text"):y},this.getCellValidator=function(g,p){const y=typeof g=="number"?o.getCellMeta(g,p).validator:g.validator;return typeof y=="string"?eG(y):y},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,p){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(p,g)},this.validateColumns=function(g,p){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(p,void 0,g)},this._validateCells=function(g,p,y){const N=new ee;g&&(N.onQueueEmpty=g);let F=o.countRows()-1;for(;F>=0;){if(p!==void 0&&p.indexOf(F)===-1){F-=1;continue}let B=o.countCols()-1;for(;B>=0;){if(y!==void 0&&y.indexOf(B)===-1){B-=1;continue}N.addValidatorToQueue(),o.validateCell(o.getDataAtCell(F,B),o.getCellMeta(F,B),Y=>{if(typeof Y!="boolean")throw new Error("Validation error: result is not boolean");Y===!1&&(N.valid=!1),N.removeValidatorFormQueue()},"validateCells"),B-=1}F-=1}N.checkIfQueueIsEmpty()},this.getRowHeader=function(g){let p=w.rowHeaders,y=g;return y!==void 0&&(y=o.runHooks("modifyRowHeader",y)),y===void 0?(p=[],he(o.countRows()-1,N=>{p.push(o.getRowHeader(N))})):Array.isArray(p)&&p[y]!==void 0?p=p[y]:it(p)?p=p(y):p&&typeof p!="string"&&typeof p!="number"&&(p=y+1),p},this.hasRowHeaders=function(){return!!w.rowHeaders},this.hasColHeaders=function(){if(w.colHeaders!==void 0&&w.colHeaders!==null)return!!w.colHeaders;for(let g=0,p=o.countCols();g<p;g++)if(o.getColHeader(g))return!0;return!1},this.getColHeader=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const y=o.runHooks("modifyColHeader",g);if(y===void 0){const C=[],b=o.countCols();for(let E=0;E<b;E++)C.push(o.getColHeader(E));return C}let N=w.colHeaders;const F=function(C){const b=[],E=o.countCols();let T=0;for(;T<E;T++)it(w.columns)&&w.columns(T)&&b.push(T);return b[C]},B=o.toPhysicalColumn(y),Y=F(B);return w.colHeaders===!1?N=null:w.columns&&it(w.columns)&&w.columns(Y)&&w.columns(Y).title?N=w.columns(Y).title:w.columns&&w.columns[B]&&w.columns[B].title?N=w.columns[B].title:Array.isArray(w.colHeaders)&&w.colHeaders[B]!==void 0?N=w.colHeaders[B]:it(w.colHeaders)?N=w.colHeaders(B):w.colHeaders&&typeof w.colHeaders!="string"&&typeof w.colHeaders!="number"&&(N=tK(y)),N=o.runHooks("modifyColumnHeaderValue",N,g,p),N},this._getColWidthFromSettings=function(g){let p;if(g>=0&&(p=o.getCellMeta(0,g).width),(p===void 0||p===w.width)&&(p=w.colWidths),p!=null){switch(typeof p){case"object":p=p[g];break;case"function":p=p(g);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getColWidth=function(g,p){let y=o._getColWidthFromSettings(g);return y=o.runHooks("modifyColWidth",y,g,p),y===void 0&&(y=$u),y},this._getRowHeightFromSettings=function(g){const p=o.stylesHandler.getDefaultRowHeight();let y=w.rowHeights;if(y!=null){switch(typeof y){case"object":y=y[g];break;case"function":y=y(g);break}typeof y=="string"&&(y=parseInt(y,10))}return y!=null&&y<p?p:y},this.getRowHeight=function(g,p){let y=o._getRowHeightFromSettings(g);return y=o.runHooks("modifyRowHeight",y,g,p),y},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const g=w.maxCols,p=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,p)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return wO(o.countRows()-1,y=>{if(o.isEmptyRow(y))p+=1;else if(g===!0)return!1}),p},this.countEmptyCols=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return wO(o.countCols()-1,y=>{if(o.isEmptyCol(y))p+=1;else if(g===!0)return!1}),p},this.isEmptyRow=function(g){return w.isEmptyRow.call(o,g)},this.isEmptyCol=function(g){return w.isEmptyCol.call(o,g)},this.selectCell=function(g,p,y,N){let F=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,B=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Mt(g)||Mt(p)?!1:this.selectCells([[g,p,y,N]],F,B)},this.selectCells=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p===!1&&d.suspend();const N=A.selectCells(g);return N&&y&&o.listen(),d.resume(),N},this.selectColumns=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,y=arguments.length>2?arguments[2]:void 0;return A.selectColumns(g,p,y)},this.selectRows=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,y=arguments.length>2?arguments[2]:void 0;return A.selectRows(g,p,y)},this.deselectCell=function(){A.deselect()},this.selectAll=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,y=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),A.selectAll(g,p,y)};const nt=(g,p)=>g.getNearestNotHiddenIndex(p,1,!0);this.scrollViewportTo=function(g,p){if(typeof g=="number"){var y;g={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(y=arguments[4])!==null&&y!==void 0?y:!0}}const{row:N,col:F,considerHiddenIndexes:B}=g??{};let Y=N,C=F;if(it(p)&&this.addHookOnce("afterScroll",p),B===void 0||B){const I=Number.isInteger(N)&&N>=0,k=Number.isInteger(F)&&F>=0,W=I?nt(this.rowIndexMapper,N):void 0,H=k?nt(this.columnIndexMapper,F):void 0;if(W===null||H===null)return!1;Y=I?o.rowIndexMapper.getRenderableFromVisualIndex(W):N,C=k?o.columnIndexMapper.getRenderableFromVisualIndex(H):F}const b=Number.isInteger(Y),E=Number.isInteger(C);let T=!1;return b&&Y>=0&&E&&C>=0?T=o.view.scrollViewport(o._createCellCoords(Y,C),g.horizontalSnap,g.verticalSnap):b&&Y>=0&&(E&&C<0||!E)?T=o.view.scrollViewportVertically(Y,g.verticalSnap):E&&C>=0&&(b&&Y<0||!b)&&(T=o.view.scrollViewportHorizontally(C,g.horizontalSnap)),it(p)&&(T?this.view.render():(this.removeHook("afterScroll",p),this._registerMicrotask(()=>p()))),T},this.scrollToFocusedCell=function(g){if(!this.selection.isSelected())return!1;it(g)&&this.addHookOnce("afterScroll",g);const{highlight:p}=this.getSelectedRangeLast(),y=this.scrollViewportTo(p.toObject());return y?this.view.render():it(g)&&(this.removeHook("afterScroll",g),this._registerMicrotask(()=>g())),y},this.destroy=function(){o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),L.clear(),R.clearCache(),uy.delete(this.guid),s.destroy(),c&&c.destroy(),o.rootContainer&&ts(o.rootContainer),o.rootPortalElement&&o.rootPortalElement.remove(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),O.getItems().forEach(g=>{let[,p]=g;p.destroy()}),O.clear(),o.runHooks("afterDestroy")},!0),ne.getSingleton().destroy(o),Ne(o,(g,p,y)=>{it(g)?y[p]=st(p):p!=="guid"&&(y[p]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,A=null,c=null,o=null};function st(g){return()=>{throw new Error(`The "${g}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(g){return O.getItem(Ii(g))},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:O.getId(g)},this.getInstance=function(){return o},this.addHook=function(g,p,y){ne.getSingleton().add(g,p,o,y)},this.hasHook=function(g){return ne.getSingleton().has(g,o)||ne.getSingleton().has(g)},this.addHookOnce=function(g,p,y){ne.getSingleton().once(g,p,o,y)},this.removeHook=function(g,p){ne.getSingleton().remove(g,p,o)},this.runHooks=function(g,p,y,N,F,B,Y){return ne.getSingleton().run(o,g,p,y,N,F,B,Y)},this.getTranslatedPhrase=function(g,p){return nk(w.language,g,p)},this.toHTML=()=>mO(this),this.toTableElement=()=>{const g=this.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",mO(this)),g.firstElementChild},this.timeouts=[],this.useTheme=g=>{const p=!!f;this.stylesHandler.useTheme(g);const y=this.stylesHandler.getThemeName();gu(this)&&(pe(this.rootWrapperElement,/ht-theme-.*/g),pe(this.rootPortalElement,/ht-theme-.*/g),y&&(G(this.rootWrapperElement,y),G(this.rootPortalElement,y),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||qe(`The "${y}" theme is enabled, but its stylesheets are missing or not imported correctly.             Import the correct CSS files in order to use that theme.`))),p||(o.render(),o.scrollViewportTo(0,0),Ox(this.rootContainer)&&(pe(this.rootContainer,/ht-theme-.*/g),y&&G(this.rootContainer,y))),this.runHooks("afterSetTheme",y,p)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=g;typeof y=="function"&&(y=setTimeout(y,p)),this.timeouts.push(y)},this._clearTimeouts=function(){P(this.timeouts,g=>{clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){P(this.immediates,g=>{clearImmediate(g)})},this._registerMicrotask=function(g){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||g()})},this._getEditorManager=function(){return c};const gn=h4({handleEvent(){return o.isListening()},beforeKeyDown:g=>this.runHooks("beforeKeyDown",g),afterKeyDown:g=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",g)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",g=>{g.ctrlKey===!1&&g.metaKey===!1&&gn.releasePressedKeys()}),this.getShortcutManager=function(){return gn},this.getFocusManager=function(){return h},SD().forEach(g=>{const p=KR(g);O.addItem(g,new p(this))}),qX(o),gn.setActiveContextName("grid"),ne.getSingleton().run(o,"construct")}function Lx(t,e,n){t.addEventListener(e,n,!1)}function $x(t,e,n){t.removeEventListener(e,n,!1)}function pf(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function yk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=pf(s).fontSize,o.style.fontFamily=pf(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=pf(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),m=parseInt(((d=pf(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),v=o.clientWidth+f+m+1;r.removeChild(o);const S=s.style;S.height=`${n.minHeight}px`,n.minWidth>v?S.width=`${n.minWidth}px`:v>n.maxWidth?S.width=`${n.maxWidth}px`:S.width=`${v}px`;const R=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>R?S.height=`${n.minHeight}px`:n.maxHeight<R?(S.height=`${n.maxHeight}px`,S.overflowY="visible"):S.height=`${R}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(Lx(s,"input",a),Lx(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){$x(s,"input",a),$x(s,"keydown",l)}}}function Fx(t,e){const n=nD(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}ip(e,i)}function ma(t,e,n){return(e=y4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y4(t){var e=S4(t,"string");return typeof e=="symbol"?e:e+""}function S4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const b4="ht_editor_visible",wf="ht_editor_hidden",Vx="textEditor",R4="text";class bl extends tc{static get EDITOR_TYPE(){return R4}constructor(e){super(e),ma(this,"eventManager",new Pi(this)),ma(this,"autoResize",yk(this.hot.rootDocument)),ma(this,"TEXTAREA",void 0),ma(this,"textareaStyle",void 0),ma(this,"TEXTAREA_PARENT",void 0),ma(this,"textareaParentStyle",void 0),ma(this,"layerClass",void 0),this.eventManager=new Pi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),_g(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Ft.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Ft.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),ip(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),ve(this.TEXTAREA,[["data-hot-input",""],Js(-1)]),G(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),G(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ce(this.TEXTAREA_PARENT,this.layerClass)&&pe(this.TEXTAREA_PARENT,this.layerClass),G(this.TEXTAREA_PARENT,wf),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Hz()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",pe(this.TEXTAREA_PARENT,this.layerClass),G(this.TEXTAREA_PARENT,wf)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;he(e.length-1,r=>{const i=e[r];if(Ce(i,"handsontableEditor"))return n=!0,!1}),Ce(this.TEXTAREA_PARENT,wf)&&pe(this.TEXTAREA_PARENT,wf),n?(this.layerClass=b4,G(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),G(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Ft.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){qN()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Ft.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Ft.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>le(this.hot.getSelected()),group:Vx},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;Fx(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;Fx(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Vx)}}const E4="base",T4="htTextEllipsis";function _d(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&G(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(kP())):a&&c.push(kP()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(LP())):(u.push(s.invalidCellClassName),a&&c.push(LP()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),s.textEllipsis&&l.push(T4),pe(e,u),G(e,l),Qu(e,c),ve(e,h)}_d.RENDERER_TYPE=E4;const _4="text";function us(t,e,n,r,i,o,s){_d.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=It(a),s.trimWhitespace&&(a=a.trim()),sl(e,a)}us.RENDERER_TYPE=_4;const M4="text",Sk={CELL_TYPE:M4,editor:bl,renderer:us};gi(Sk);fr.editors={BaseEditor:tc};function fr(t,e){const n=new Ck(t,e||{},hE);return n.init(),n}fr.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Ck(t,e,hE)};fr.DefaultSettings=uk();fr.hooks=ne.getSingleton();fr.CellCoords=ll;fr.CellRange=bd;fr.packageName="handsontable";fr.buildDate="10/07/2025 10:59:01";fr.version="16.0.1";fr.languages={dictionaryKeys:kK,getLanguageDictionary:tk,getLanguagesDictionaries:WK,registerLanguageDictionary:ek,getTranslatedPhrase:nk};var cy=null,I4="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",P4="Providing a component-based renderer using `hot-renderer`-annotated component is no longer supported. Pass your component using `renderer` prop of the `HotTable` or `HotColumn` component instead.",O4="Providing a component-based editor using `hot-editor`-annotated component is no longer supported. Pass your component using `editor` prop of the `HotTable` or `HotColumn` component instead.",x4="Unexpected children nodes found in HotTable component. Only HotColumn components are allowed.",H4="Unexpected children nodes found in HotColumn component. HotColumn components do not support any children.",A4="The Handsontable instance bound to this component was destroyed and cannot be used properly.",N4="hot-wrapper-editor-container";function Zh(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function bb(t){return Wx(t,"hot-renderer")?(Zh(P4),!0):Wx(t,"hot-editor")?(Zh(O4),!0):!1}function D4(t,e){var n=dn.Children.toArray(t);return n.some(function(r){return r.type!==e})?(Zh(x4),!0):!1}function k4(t){var e=dn.Children.toArray(t);return e.length?(Zh(H4),!0):!1}function Wx(t,e){var n=dn.Children.toArray(t);return n.some(function(r){return r.props[e]!==void 0})}function bk(t,e){if(!t||!e||typeof e=="boolean")return null;var n=dn.createElement(e,null),r=Rk({},!1);return r.className="".concat(N4," ").concat(r.className),h1.createPortal(dn.createElement("div",Object.assign({},r),n),t.body)}function L4(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;e||(e=document),cy||(cy=e.createDocumentFragment());var i=r??e.createElement("DIV");return cy.appendChild(i),{portal:h1.createPortal(t,i,n),portalContainer:i}}function Rk(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}function $4(){return typeof window<"u"}function F4(t,e){var n=dn.useRef(!1);Me.useEffect(function(){if(n.current)return t();n.current=!0},e)}function Rb(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function V4(t){if(Array.isArray(t))return t}function W4(t){if(Array.isArray(t))return Rb(t)}function B4(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j4(t,e,n){return e=om(e),Z4(t,_k()?Reflect.construct(e,n||[],om(t).constructor):e.apply(t,n))}function Ek(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,t6(r.key),r)}}function Tk(t,e,n){return e&&Bx(t.prototype,e),n&&Bx(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function om(t){return om=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},om(t)}function U4(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Eb(t,e)}function _k(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_k=function(){return!!t})()}function z4(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Y4(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,o,s,a=[],l=!0,u=!1;try{if(o=(n=n.call(t)).next,e!==0)for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}function G4(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function q4(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function K4(t,e){if(t==null)return{};var n,r,i=X4(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function X4(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function Z4(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return B4(t)}function Eb(t,e){return Eb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Eb(t,e)}function Q4(t,e){return V4(t)||Y4(t,e)||Mk(t,e)||G4()}function J4(t){return W4(t)||z4(t)||Mk(t)||q4()}function e6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function t6(t){var e=e6(t,"string");return typeof e=="symbol"?e:e+""}function Mk(t,e){if(t){if(typeof t=="string")return Rb(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rb(t,e):void 0}}var Ik=function(){function t(){Ek(this,t)}return Tk(t,null,[{key:"getSettings",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=r.prevProps,o=i===void 0?{}:i,s=r.isInit,a=s===void 0?!1:s,l=r.initOnlySettingKeys,u=l===void 0?[]:l,c=function(m){return!a&&u.includes(m)?o[m]===n[m]:!1},h={};for(var d in n)d!=="children"&&!c(d)&&n.hasOwnProperty(d)&&(h[d]=n[d]);return h}}])}(),Pk=Me.createContext(void 0),n6=function(e){var n=e.children,r=Me.useRef([]),i=Me.useCallback(function(S,R){r.current[R]=S},[]),o=Me.useRef(new Map),s=Me.useRef(new Map),a=Me.useCallback(function(){return s.current.clear()},[]),l=Me.useRef(new Map),u=Me.useCallback(function(){return l.current.clear()},[]),c=Me.useRef(new Map),h=Me.useCallback(function(S){return function(w,_,O,L,M,x,z){var q="".concat(O,"-").concat(L),A=w.guid,Z="".concat(A,"-").concat(q),X="".concat(q,"-").concat(A);if(s.current.has(q)&&(_.innerHTML=s.current.get(q).innerHTML),_&&!_.getAttribute("ghost-table")){for(var oe=l.current.get(X),ee=c.current.get(Z);_.firstChild;)_.removeChild(_.firstChild);if(oe&&ee)_.appendChild(ee);else{var ae=dn.createElement(S,{instance:w,TD:_,row:O,col:L,prop:M,value:x,cellProperties:z}),ht=L4(ae,_.ownerDocument,X,ee),Ie=ht.portal,De=ht.portalContainer;c.current.set(Z,De),_.appendChild(De),l.current.set(X,Ie)}}return s.current.set("".concat(O,"-").concat(L),_),_}},[]),d=Me.useRef(function(){}),f=Me.useCallback(function(S){d.current=S},[]),m=Me.useCallback(function(){d.current(J4(l.current.values()))},[]),v=Me.useMemo(function(){return{componentRendererColumns:o.current,columnsSettings:r.current,emitColumnSettings:i,getRendererWrapper:h,clearPortalCache:u,clearRenderedCellCache:a,setRenderersPortalManagerRef:f,pushCellPortalsIntoPortalManager:m}},[i,h,a,f,m]);return dn.createElement(Pk.Provider,{value:v},n)};function Ok(){return Me.useContext(Pk)}var xk=Me.createContext(void 0),r6=function(e){var n=e.columnIndex,r=e.getOwnerDocument,i=e.children,o=Me.useMemo(function(){return{columnIndex:n,getOwnerDocument:r}},[n,r]);return dn.createElement(xk.Provider,{value:o},i)},i6=function(){return Me.useContext(xk)},o6=["close","focus","open"],s6=["getValue","setValue"],hy={open:"onOpen",close:"onClose",prepare:"onPrepare",focus:"onFocus"};function Hk(t,e){return function(n){function r(i){var o;return Ek(this,r),o=j4(this,r,[i]),e.current=o,Object.getOwnPropertyNames(fr.editors.BaseEditor.prototype).forEach(function(s){if(!(s==="constructor"||s6.includes(s))){var a=fr.editors.BaseEditor.prototype[s];r.prototype[s]=(function(){for(var l,u,c=arguments.length,h=new Array(c),d=0;d<c;d++)h[d]=arguments[d];if(o6.includes(s)||(u=a.call.apply(a,[this].concat(h))),hy[s]&&(l=t.current)!==null&&l!==void 0&&l[hy[s]]){var f;u=(f=t.current[hy[s]]).call.apply(f,[this].concat(h))}return u}).bind(o)}}),o}return U4(r,n),Tk(r,[{key:"focus",value:function(){}},{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(o){this.value=o}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(fr.editors.BaseEditor)}var a6=Me.createContext(void 0),Ak=function(e){var n=e.hooksRef,r=e.hotCustomEditorInstanceRef,i=e.children;return dn.createElement(a6.Provider,{value:{hooksRef:n,hotCustomEditorInstanceRef:r}},i)},l6=function(e){return e.type===Nk},u6=["_columnIndex","_getOwnerDocument","children"],Nk=function(e){var n=Ok(),r=n.componentRendererColumns,i=n.emitColumnSettings,o=n.getRendererWrapper,s=i6(),a=s.columnIndex,l=s.getOwnerDocument,u=Me.useRef(null),c=Me.useRef(null);Me.useEffect(function(){var d=function(){return Object.keys(e).filter(function(S){return!u6.includes(S)}).reduce(function(S,R){return S[R]=e[R],S},{})},f=function(){var S=Ik.getSettings(d());return e.renderer?(S.renderer=o(e.renderer),r.set(a,!0)):e.hotRenderer&&(S.renderer=e.hotRenderer),e.editor?S.editor=Hk(u,c):e.hotEditor&&(S.editor=e.hotEditor),S},m=f();i(m,a),bb(e.children)||k4(e.children)});var h=bk(l(),e.editor);return dn.createElement(Ak,{hooksRef:u,hotCustomEditorInstanceRef:c},h)},c6="16.0.1",h6=Me.forwardRef(function(t,e){var n=Me.useState([]),r=Q4(n,2),i=r[0],o=r[1];return Me.useImperativeHandle(e,function(){return o}),dn.createElement(Me.Fragment,null,i)});function d6(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Dk={exports:{}},dy,jx;function f6(){if(jx)return dy;jx=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return dy=t,dy}var fy,Ux;function g6(){if(Ux)return fy;Ux=1;var t=f6();function e(){}function n(){}return n.resetWarningCache=e,fy=function(){function i(a,l,u,c,h,d){if(d!==t){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}i.isRequired=i;function o(){return i}var s={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:o,element:i,elementType:i,instanceOf:o,node:i,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:n,resetWarningCache:e};return s.PropTypes=s,s},fy}Dk.exports=g6()();var m6=Dk.exports,gy=d6(m6),kk=Me.forwardRef(function(t,e){var n=Me.useRef(null),r=Me.useRef(null),i=Me.useRef(null),o=Me.useRef(null),s=Me.useRef(),a=Ok(),l=Me.useCallback(function(){return!n.current||!n.current.isDestroyed?n.current:(console.warn(A4),null)},[n]),u=Me.useCallback(function(){return!n.current||n.current.isDestroyed},[n]),c=Me.useCallback(function(){a.clearRenderedCellCache(),a.componentRendererColumns.clear()},[a]),h=Me.useCallback(function(){return $4()?r.current?r.current.ownerDocument:document:null},[r]),d=function(){var w,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},L=u()?[]:((w=l())===null||w===void 0||(w=w.getSettings())===null||w===void 0?void 0:w._initOnlySettings)||[],M=Ik.getSettings(t,{prevProps:O,isInit:_,initOnlySettingKeys:L});return M.columns=a.columnsSettings.length?a.columnsSettings:M.columns,t.renderer?(M.renderer=a.getRendererWrapper(t.renderer),a.componentRendererColumns.set("global",!0)):M.renderer=t.hotRenderer||db("text"),t.editor?M.editor=Hk(i,o):M.editor=t.hotEditor||lb("text"),M},f=function(w){var _,O;w&&((_=w.getPlugin("autoRowSize"))!==null&&_!==void 0&&_.enabled||(O=w.getPlugin("autoColumnSize"))!==null&&O!==void 0&&O.enabled)&&a.componentRendererColumns.size>0&&Zh(I4)};Me.useEffect(function(){var R=d(!0);return s.current=t,n.current=new fr.Core(r.current,R),n.current.addHook("beforeViewRender",function(){a.clearPortalCache(),a.clearRenderedCellCache()}),n.current.addHook("afterViewRender",function(){a.pushCellPortalsIntoPortalManager()}),n.current.init(),f(n.current),bb(t.children)||D4(t.children,Nk),function(){var w;c(),(w=l())===null||w===void 0||w.destroy()}},[]),F4(function(){c();var R=l(),w=d(!1,s.current);s.current=t,R?.updateSettings(w,!1),f(R),bb(t.children)}),Me.useImperativeHandle(e,function(){return{get hotElementRef(){return r.current},get hotInstance(){return l()}}});var m=Me.Children.toArray(t.children).filter(l6).map(function(R,w){return dn.createElement(r6,{columnIndex:w,getOwnerDocument:h,key:w},R)}),v=Rk(t),S=bk(h(),t.editor);return dn.createElement(Me.Fragment,null,dn.createElement("div",Object.assign({ref:r},v),m),dn.createElement(h6,{ref:a.setRenderersPortalManagerRef}),dn.createElement(Ak,{hooksRef:i,hotCustomEditorInstanceRef:o},S))});kk.propTypes={style:gy.object,id:gy.string,className:gy.string};var p6=["children"],w6=Me.forwardRef(function(t,e){var n,r=t.children,i=K4(t,p6),o=(n=i.id)!==null&&n!==void 0?n:Me.useId();return dn.createElement(n6,null,dn.createElement(kk,Object.assign({id:o},i,{ref:e}),r))});w6.version=c6;function zx(t,e,n){return(e=v6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v6(t){var e=C6(t,"string");return typeof e=="symbol"?e:e+""}function C6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Yx="handsontableEditor",y6="handsontable";class j0 extends bl{constructor(){super(...arguments),zx(this,"isFlippedVertically",!1),zx(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return y6}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),ip(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&tn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let r=n.top;if(e.isVerticallyScrollableByWindow()){const a=e.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getDropdownHeight(),o=e.getWorkspaceHeight()-r-n.height,s=i>o&&r>o+n.height;return s?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:s,spaceAbove:r,spaceBelow:o}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let r=n.start+n.width;if(e.isHorizontallyScrollableByWindow()){const a=e.getTableOffset().left-this.hot.rootWindow.scrollX;r=Math.max(r+a,0)}const i=this.getDropdownWidth(),o=e.getWorkspaceWidth()-r+n.width,s=i>o&&r>o;return s?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:s,spaceInlineStart:r,spaceInlineEnd:o}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:n}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-n)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:Yx,relativeToGroup:na,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||this.isFlippedVertically&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Hi(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&this.isFlippedVertically?a=s.countRows()-1:s.getSelectedLast()&&(this.isFlippedVertically?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!this.isFlippedVertically)a=0;else if(s.getSelectedLast()){if(this.isFlippedVertically)a=s.getSelectedLast()[0]+1;else if(!this.isFlippedVertically){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Yx)}}function S6(t,e){Lk(t,e),e.add(t)}function Gx(t,e,n){Lk(t,e),e.set(t,n)}function Lk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vf(t,e,n){return(e=b6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b6(t){var e=R6(t,"string");return typeof e=="symbol"?e:e+""}function R6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function my(t,e){return t.get(Tb(t,e))}function Tb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const E6="autocomplete";var py=new WeakMap,qx=new WeakMap,wy=new WeakSet;class U0 extends j0{constructor(){super(...arguments),S6(this,wy),vf(this,"query",null),vf(this,"strippedChoices",[]),vf(this,"rawChoices",[]),Gx(this,py,this.hot.guid.slice(0,9)),Gx(this,qx,sp(()=>{this.focus()},100)),vf(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=DP(It(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return E6}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return le(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),G(this.htContainer,"autocompleteEditor"),G(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[hz(),sz(),BN("listbox"),mz()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[Xr("false"),pz(`${my(py,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r?.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",my(qx,this)),this.htEditor.updateSettings({colWidths:e?[Yt(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{us(a,l,u,c,h,d,f);const{filteringCaseSensitive:m,allowHtml:v,locale:S}=this.cellProperties,R=this.query;let w=It(d),_,O;w&&!v&&(_=m===!0?w.indexOf(R):w.toLocaleLowerCase(S).indexOf(R.toLocaleLowerCase(S)),_!==-1&&(O=w.substr(_,R.length),w=w.replace(O,`<strong>${O}</strong>`))),n&&ve(l,[az(),...r?[yz(i)]:[],...r?[Sz(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=w},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{ve(h,[FR()]),ve(this.TEXTAREA,...wz(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(ve(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Yo()),ve(this.htEditor.rootElement,[WN(),vz("polite"),Cz("text"),["id",`${my(py,this)}-listbox-${o}-${s}`]]),ve(this.TEXTAREA,...Xr("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[Xr("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=nD(this.TEXTAREA),r=Wz(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Tg([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),ip(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:n,spaceAbove:r,spaceBelow:i}=e;return this.limitDropdownIfNeeded(n?r:i),e}limitDropdownIfNeeded(e){const n=this.getDropdownHeight();if(n>e){let r=0,i=0,o=null;do i=this.htEditor.stylesHandler.getDefaultRowHeight(),r+=i;while(r<e);o=r-i,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-o}px`),this.setDropdownHeight(r-i)}}updateDropdownDimensions(){const e=rD(),n=this.getTargetEditorWidth()+e,r=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:n,height:r}),Tb(wy,this,Kx).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),Tb(wy,this,Kx).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const i=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)}const n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:n},(i,o)=>o).reduce((i,o)=>{const s=this.hot.stylesHandler.getDefaultRowHeight()+(o===0?1:0);return i+s},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const n=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(n.borderInlineStartWidth,10)+parseInt(n.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Ve(e,o=>It(o));return Ve(r,o=>n?o:DP(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===ge.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===ge.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(Gz(e.keyCode)||e.keyCode===ge.BACKSPACE||e.keyCode===ge.DELETE||e.keyCode===ge.INSERT){let n=10;if(e.keyCode===ge.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function Kx(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+Cn(this.hot.rootDocument)})}const T6="checkbox";class $k extends tc{static get EDITOR_TYPE(){return T6}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');Ce(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Fs=()=>window,Yr=()=>window.document,_b=(t,e)=>window.setTimeout(t,e),Xi=function(t,e,n,r){t.addEventListener(e,n,!!r)},Io=function(t,e,n,r){t.removeEventListener(e,n,!!r)},_6=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Sr=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},vy=function(t,e){Sr(t,e)||(t.className=t.className===""?e:t.className+" "+e)},Cy=function(t,e){t.className=_6((" "+t.className+" ").replace(" "+e+" "," "))},z0=function(t){return/Array/.test(Object.prototype.toString.call(t))},_r=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},M6=function(t){let e=t.getDay();return e===0||e===6},I6=function(t){return t%4===0&&t%100!==0||t%400===0},Xx=function(t,e){return[31,I6(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Cf=function(t){_r(t)&&t.setHours(0,0,0,0)},yf=function(t,e){return t.getTime()===e.getTime()},sm=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?_r(e[r])?n&&(t[r]=new Date(e[r].getTime())):z0(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=sm({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},Zx=function(t,e,n){let r=Yr().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=sm(r,n),t.dispatchEvent(r)},Qx=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Fi={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},Jx=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},P6=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},O6=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=1440*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},x6=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():O6(o,i))+"</td>"},H6=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},A6=function(t){return"<tbody>"+t.join("")+"</tbody>"},N6=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+Jx(t,e)+'">'+Jx(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},D6=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,m,v=!0,S=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",z0(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return m='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=m+f:d+=f+m,c&&(r===0||u.minMonth>=r)&&(v=!1),h&&(r===11||u.maxMonth<=r)&&(S=!1),e===0&&(d+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(S?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},k6=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+N6(t)+A6(e)+"</table>"};function Mb(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||Fs().event;let o=i.target||i.srcElement;if(o)if(Sr(o,"is-disabled")||(Sr(o,"pika-button")&&!Sr(o,"is-empty")&&!Sr(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&_b(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Sr(o,"pika-prev")?e.prevMonth():Sr(o,"pika-next")&&e.nextMonth()),Sr(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Fs().event;let o=i.target||i.srcElement;o&&(Sr(o,"pika-select-month")?e.gotoMonth(o.value):Sr(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||Fs().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),_r(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Yr().activeElement;do if(Sr(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=_b(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Fs().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&Sr(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),Xi(o,"change",e._onChange)));do if(Sr(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=Yr().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),Xi(e.el,"mousedown",e._onMouseDown,!0),Xi(e.el,"touchend",e._onMouseDown,!0),Xi(e.el,"change",e._onChange),n.keyboardInput&&Xi(Yr(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?Yr().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),Xi(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;_r(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",Xi(n.trigger,"click",e._onInputClick),Xi(n.trigger,"focus",e._onInputFocus),Xi(n.trigger,"blur",e._onInputBlur)):this.show()}Mb.prototype={config:function(t){this._o||(this._o=sm({},Fi,!0));let e=sm(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,_r(e.minDate)||(e.minDate=!1),_r(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),z0(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Fi.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,_r(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return _r(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",Zx(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!_r(t))return;let n=this._o.minDate,r=this._o.maxDate;_r(n)&&t<n?t=n:_r(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),Cf(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),Zx(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(_r(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=Qx(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=Qx({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(Cf(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Fi.minDate,this._o.minYear=Fi.minYear,this._o.minMonth=Fi.minMonth,this._o.startRange=Fi.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(Cf(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Fi.maxDate,this._o.maxYear=Fi.maxYear,this._o.maxMonth=Fi.maxMonth,this._o.endRange=Fi.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+D6(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&_b(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=Fs().innerWidth||Yr().documentElement.clientWidth,i=Fs().innerHeight||Yr().documentElement.clientHeight,o=Yr().body.scrollTop||Yr().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+Fs().pageXOffset,a=l.bottom+Fs().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",vy(this.el,u?"left-aligned":"right-aligned"),vy(this.el,c?"bottom-aligned":"top-aligned"),Cy(this.el,u?"right-aligned":"left-aligned"),Cy(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=Xx(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];Cf(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=Xx(h,u),m=o+s,v=m;for(;v>7;)v-=7;m+=7-v;let S=!1;for(let R=0,w=0;R<m;R++){let _=new Date(t,e,1+(R-s)),O=_r(this._d)?yf(_,this._d):!1,L=yf(_,i),M=r.events.indexOf(_.toDateString())!==-1,x=R<s||R>=o+s,z=1+(R-s),q=e,A=t,Z=r.startRange&&yf(r.startRange,_),X=r.endRange&&yf(r.endRange,_),oe=r.startRange&&r.endRange&&r.startRange<_&&_<r.endRange,ee=r.minDate&&_<r.minDate||r.maxDate&&_>r.maxDate||r.disableWeekends&&M6(_)||r.disableDayFn&&r.disableDayFn(_);x&&(R<s?(z=f+z,q=u,A=h):(z=z-o,q=c,A=d));let ae={day:z,month:q,year:A,hasEvent:M,isSelected:O,isToday:L,isDisabled:ee,isEmpty:x,isStartRange:Z,isEndRange:X,isInRange:oe,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&O&&(S=!0),l.push(P6(ae)),++w===7&&(r.showWeekNumber&&l.unshift(x6(this,R-s,e,t,r.firstWeekOfYearMinDays)),a.push(H6(l,r.isRTL,r.pickWholeWeek,S)),l=[],w=0,S=!1)}return k6(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),Cy(this.el,"is-hidden"),this._o.bound&&(Xi(Yr(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Io(Yr(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),vy(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Io(this.el,"mousedown",this._onMouseDown,!0),Io(this.el,"touchend",this._onMouseDown,!0),Io(this.el,"change",this._onChange),t.keyboardInput&&Io(Yr(),"keydown",this._onKeyChange),t.field&&(Io(t.field,"change",this._onInputChange),t.bound&&(Io(t.trigger,"click",this._onInputClick),Io(t.trigger,"focus",this._onInputFocus),Io(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function L6(t,e){$6(t,e),e.add(t)}function $6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eH(t,e,n){return(e=F6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F6(t){var e=V6(t,"string");return typeof e=="symbol"?e:e+""}function V6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yy(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Fk="date",tH="dateEditor",W6="DD/MM/YYYY";var Sf=new WeakSet;class Vk extends bl{constructor(){super(...arguments),L6(this,Sf),eH(this,"parentDestroyed",!1),eH(this,"$datePicker",null)}static get EDITOR_TYPE(){return Fk}init(){if(typeof K!="function")throw new Error("You need to include moment.js to your project.");if(typeof Mb!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),G(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Ce(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:tH})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(tH),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=yy(Sf,this,Sy).call(this),r=this.hot.view.isMouseDown(),i=e?hD(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new Mb(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(K),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,K(o,n,!0).isValid()&&this.$datePicker.setMoment(K(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,K(o,n,!0).isValid()&&this.$datePicker.setMoment(K(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&rp(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:yy(Sf,this,Sy).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=K(a).format(yy(Sf,this,Sy).call(this))),this.setValue(a),i&&i(),lo()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Ft.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+en(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-Yt(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function Sy(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:W6}const B6="dropdown";class Wk extends U0{static get EDITOR_TYPE(){return B6}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const j6="numeric";class Bk extends bl{static get EDITOR_TYPE(){return j6}}function U6(t,e,n){return(e=z6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z6(t){var e=Y6(t,"string");return typeof e=="symbol"?e:e+""}function Y6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const G6="password";class jk extends bl{constructor(){super(...arguments),U6(this,"autoResize",yk(this.hot.rootDocument,{textContent:e=>"â¢".repeat(e.value.length)}))}static get EDITOR_TYPE(){return G6}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,ts(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...Js(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const by="ht_editor_visible",nH="selectEditor",q6="select";class Uk extends tc{static get EDITOR_TYPE(){return q6}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...yl()),e.appendChild(this.hot.rootDocument.createTextNode("â¼")),G(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",Ce(this.selectWrapper,by)&&pe(this.selectWrapper,by),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),ts(this.select),Ne(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Ju(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Ft.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",G(this.selectWrapper,by)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:nH};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(nH)}}const K6="time";class zk extends bl{static get EDITOR_TYPE(){return K6}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function X6(){br(tc),br(U0),br($k),br(Vk),br(Wk),br(j0),br(Bk),br(jk),br(Uk),br(bl),br(zk)}const Z6="html";function Y0(t,e,n,r,i,o,s){_d.apply(this,[t,e,n,r,i,o,s]),Ju(e,o??"",!1)}Y0.RENDERER_TYPE=Z6;const Q6="autocomplete";function rc(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?Y0:us,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...yl()),u.appendChild(a.createTextNode("â¼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode("Â ")),e.insertBefore(u,e.firstChild),G(e,"htAutocomplete"),!t.acArrowListener){const h=new Pi(t);t.acArrowListener=function(d){Ce(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}rc.RENDERER_TYPE=Q6;const J6="dropdown";function G0(t,e,n,r,i,o,s){rc.apply(this,[t,e,n,r,i,o,s])}G0.RENDERER_TYPE=J6;const rH=new WeakMap,iH=new WeakMap,e9="htBadValue",Wu="data-row",Bu="data-col",t9="checkboxRenderer",Yk="checkbox";ne.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===Yk){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function q0(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;_d.apply(this,[t,e,n,r,i,o,s]),n9(t);let u=r9(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),ts(e),o===s.checkedTemplate||It(o).toLocaleLowerCase(s.locale)===It(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||It(o).toLocaleLowerCase(s.locale)===It(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Wt(o)?G(u,"noValue"):(u.style.display="none",G(u,e9),h=!0),ve(u,[[Wu,n],[Bu,r]]),l&&ve(u,[Du(u.checked?t.getTranslatedPhrase(L0):t.getTranslatedPhrase($0)),zN(u.checked),lz()]),!h&&c){let v="";if(c.value)v=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const R=t.getDataAtRowProp(n,c.property);v=R!==null?R:""}const S=i9(a,v,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(S),e.appendChild(u)):(S.appendChild(u),u=S):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(S)):(S.insertBefore(u,S.firstChild),u=S))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),rH.has(t)||(rH.set(t,!0),d());function d(){const S=t.getShortcutManager().getContext("grid"),R={group:t9,relativeToGroup:na,position:"before"};S.addShortcuts([{keys:[["space"]],callback:()=>(f(),!m()),runOnlyIf:()=>{var w;return(w=t.getSelectedRangeLast())===null||w===void 0?void 0:w.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!m()),runOnlyIf:()=>{const w=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&w?.highlight.isCell()&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!m()),runOnlyIf:()=>{var w;return(w=t.getSelectedRangeLast())===null||w===void 0?void 0:w.highlight.isCell()}}],R)}function f(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const S=t.getSelectedRange(),R=[],w=new Map;let _=[],O=0;if(S){for(let L=0;L<S.length;L++){const{row:M,col:x}=S[L].getTopStartCorner(),{row:z,col:q}=S[L].getBottomEndCorner();for(let A=M;A<=z;A+=1)for(let Z=x;Z<=q;Z+=1){const X=t.getCellMeta(A,Z);if(X.hidden)continue;const oe={checkedTemplate:X.checkedTemplate,uncheckedTemplate:X.uncheckedTemplate};if(X.type!=="checkbox"){v===!0&&!X.readOnly&&(w.has(R.length)?w.set(R.length,[...w.get(R.length),[A,Z,null]]):w.set(R.length,[[A,Z,null]]));continue}if(X.readOnly===!0)continue;typeof X.checkedTemplate>"u"&&(X.checkedTemplate=!0),typeof X.uncheckedTemplate>"u"&&(X.uncheckedTemplate=!1);const ee=t.getDataAtCell(A,Z);v===!1?[X.checkedTemplate,X.checkedTemplate.toString()].includes(ee)?_.push([A,Z,X.uncheckedTemplate,oe]):[X.uncheckedTemplate,X.uncheckedTemplate.toString(),null,void 0].includes(ee)&&_.push([A,Z,X.checkedTemplate,oe]):_.push([A,Z,X.uncheckedTemplate,oe]),O+=1}R.push(O),O=0}_.every(L=>{let[,,M]=L;return M===_[0][2]})?_=_.map(L=>{let[M,x,z]=L;return[M,x,z]}):_=_.map(L=>{let[M,x,,z]=L;return[M,x,z.checkedTemplate]}),_.length>0&&R.forEach((L,M)=>{let x=_.splice(0,L);w.size&&w.has(M)&&(x=[...x,...w.get(M)]),t.setDataAtCell(x)})}}function m(){const v=t.getSelectedRange();if(v){for(let S=0;S<v.length;S++){const R=v[S].getTopStartCorner(),w=v[S].getBottomEndCorner();for(let _=R.row;_<=w.row;_++)for(let O=R.col;O<=w.col;O++){if(t.getCellMeta(_,O).readOnly)continue;const M=t.getCell(_,O);if(Jo(M)&&M.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}q0.RENDERER_TYPE=Yk;function n9(t){let e=iH.get(t);if(!e){const{rootElement:n}=t;e=new Pi(t),e.addEventListener(n,"click",r=>s9(r,t)),e.addEventListener(n,"mouseup",r=>o9(r,t)),e.addEventListener(n,"change",r=>a9(r,t)),iH.set(t,e)}return e}function r9(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function i9(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function o9(t,e){const{target:n}=t;K0(n)&&(!n.hasAttribute(Wu)||!n.hasAttribute(Bu)||setTimeout(e.listen,10))}function s9(t,e){const{target:n}=t;if(!K0(n)||!n.hasAttribute(Wu)||!n.hasAttribute(Bu))return;const r=parseInt(n.getAttribute(Wu),10),i=parseInt(n.getAttribute(Bu),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function a9(t,e){const{target:n}=t;if(!K0(n)||!n.hasAttribute(Wu)||!n.hasAttribute(Bu))return;const r=parseInt(n.getAttribute(Wu),10),i=parseInt(n.getAttribute(Bu),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function K0(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const l9="handsontable";function X0(t,e,n,r,i,o,s){rc.apply(this,[t,e,n,r,i,o,s])}X0.RENDERER_TYPE=l9;var u9=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function c9(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Ry,oH;function h9(){return oH||(oH=1,Ry={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),Ry}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Ey,sH;function Gk(){if(sH)return Ey;sH=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,m){if(!isNaN(+l))return+l;let v="",S=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(S!==l)return-1*n(S,u,c,h,d,f);for(let M=0;M<t.length;M++){let x=t[M];if(v=l.replace(RegExp(`([0-9 ])(${x.key})$`),"$1"),v!==l)return n(v,u,c,h,d,f)*x.factor}if(v=l.replace("%",""),v!==l)return n(v,u,c,h,d,f)/100;let R=parseFloat(l);if(isNaN(R))return;let w=h(R);if(w&&w!=="."&&(v=l.replace(new RegExp(`${e(w)}$`),""),v!==l))return n(v,u,c,h,d,f);let _={};Object.keys(f).forEach(M=>{_[f[M]]=M});let O=Object.keys(_).sort().reverse(),L=O.length;for(let M=0;M<L;M++){let x=O[M],z=_[x];if(v=l.replace(x,""),v!==l){let q;switch(z){case"thousand":q=Math.pow(10,3);break;case"million":q=Math.pow(10,6);break;case"billion":q=Math.pow(10,9);break;case"trillion":q=Math.pow(10,12);break}return n(v,u,c,h,d,f)*q}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,m){if(l==="")return;if(l===d)return 0;let v=r(l,u,c);return n(v,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],m=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(m)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=J0();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),m=c.getZeroFormat(),v=c.currentAbbreviations(),S;if(typeof l=="string")o(l,h)?S=s(l):S=i(l,h,d,f,m,v);else if(typeof l=="number")S=l;else return;if(S!==void 0)return S}return Ey={unformat:a},Ey}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Ty,aH;function Z0(){if(aH)return Ty;aH=1;let t=Gk();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(S,R)=>R.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:S=>S.output==="byte"},characteristic:{type:"number",restriction:S=>S>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(S,R)=>R.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:S=>S>=0,message:"value must be positive"},{restriction:(S,R)=>!R.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:S=>S>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(S,R)=>R.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:S=>S.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(S,R){let w=d(S),_=m(R);return w&&_}function d(S){return t.unformat(S)!==void 0}function f(S,R,w,_=!1){let O=Object.keys(S).map(L=>{if(!R[L])return console.error(`${w} Invalid key: ${L}`),!1;let M=S[L],x=R[L];if(typeof x=="string"&&(x={type:x}),x.type==="format"){if(!f(M,u,`[Validate ${L}]`,!0))return!1}else if(typeof M!==x.type)return console.error(`${w} ${L} type mismatched: "${x.type}" expected, "${typeof M}" provided`),!1;if(x.restrictions&&x.restrictions.length){let z=x.restrictions.length;for(let q=0;q<z;q++){let{restriction:A,message:Z}=x.restrictions[q];if(!A(M,S))return console.error(`${w} ${L} invalid value: ${Z}`),!1}}return x.restriction&&!x.restriction(M,S)?(console.error(`${w} ${L} invalid value: ${x.message}`),!1):x.validValues&&x.validValues.indexOf(M)===-1?(console.error(`${w} ${L} invalid value: must be among ${JSON.stringify(x.validValues)}, "${M}" provided`),!1):!(x.children&&!f(M,x.children,`[Validate ${L}]`))});return _||O.push(...Object.keys(R).map(L=>{let M=R[L];if(typeof M=="string"&&(M={type:M}),M.mandatory){let x=M.mandatory;if(typeof x=="function"&&(x=x(S)),x&&S[L]===void 0)return console.error(`${w} Missing mandatory key "${L}"`),!1}return!0})),O.reduce((L,M)=>L&&M,!0)}function m(S){return f(S,u,"[Validate format]")}function v(S){return f(S,c,"[Validate language]")}return Ty={validate:h,validateFormat:m,validateInput:d,validateLanguage:v},Ty}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function d9(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function f9(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function g9(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function m9(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function p9(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function w9(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function v9(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function C9(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function y9(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function S9(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function b9(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function R9(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function E9(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function T9(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function _9(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function M9(t,e={}){return typeof t!="string"?t:(t=d9(t,e),t=f9(t,e),g9(t,e),w9(t,e),v9(t,e),E9(t,e),S9(t,e),b9(t,e),C9(t,e),R9(t,e),y9(t,e),m9(t,e),p9(t,e),T9(t,e),_9(t,e),e)}var Q0={parseFormat:M9};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var _y,lH;function J0(){if(lH)return _y;lH=1;const t=h9(),e=Z0(),n=Q0;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(m=>m.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,_y=r,_y}function I9(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function P9(t,e){t.forEach(n=>{let r;try{r=I9(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var O9=t=>({loadLanguagesInNode:e=>P9(e,t)}),qk={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function m(M){var x,z,q,A=p.prototype={constructor:p,toString:null,valueOf:null},Z=new p(1),X=20,oe=4,ee=-7,ae=21,ht=-1e7,Ie=1e7,De=!1,vt=1,nt=0,st={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},gn="0123456789abcdefghijklmnopqrstuvwxyz",g=!0;function p(C,b){var E,T,I,k,W,H,$,V,j=this;if(!(j instanceof p))return new p(C,b);if(b==null){if(C&&C._isBigNumber===!0){j.s=C.s,!C.c||C.e>Ie?j.c=j.e=null:C.e<ht?j.c=[j.e=0]:(j.e=C.e,j.c=C.c.slice());return}if((H=typeof C=="number")&&C*0==0){if(j.s=1/C<0?(C=-C,-1):1,C===~~C){for(k=0,W=C;W>=10;W/=10,k++);k>Ie?j.c=j.e=null:(j.e=k,j.c=[C]);return}V=String(C)}else{if(!r.test(V=String(C)))return q(j,V,H);j.s=V.charCodeAt(0)==45?(V=V.slice(1),-1):1}(k=V.indexOf("."))>-1&&(V=V.replace(".","")),(W=V.search(/e/i))>0?(k<0&&(k=W),k+=+V.slice(W+1),V=V.substring(0,W)):k<0&&(k=V.length)}else{if(w(b,2,gn.length,"Base"),b==10&&g)return j=new p(C),B(j,X+j.e+1,oe);if(V=String(C),H=typeof C=="number"){if(C*0!=0)return q(j,V,H,b);if(j.s=1/C<0?(V=V.slice(1),-1):1,p.DEBUG&&V.replace(/^0\.0*|\./,"").length>15)throw Error(a+C)}else j.s=V.charCodeAt(0)===45?(V=V.slice(1),-1):1;for(E=gn.slice(0,b),k=W=0,$=V.length;W<$;W++)if(E.indexOf(T=V.charAt(W))<0){if(T=="."){if(W>k){k=$;continue}}else if(!I&&(V==V.toUpperCase()&&(V=V.toLowerCase())||V==V.toLowerCase()&&(V=V.toUpperCase()))){I=!0,W=-1,k=0;continue}return q(j,String(C),H,b)}H=!1,V=z(V,b,10,j.s),(k=V.indexOf("."))>-1?V=V.replace(".",""):k=V.length}for(W=0;V.charCodeAt(W)===48;W++);for($=V.length;V.charCodeAt(--$)===48;);if(V=V.slice(W,++$)){if($-=W,H&&p.DEBUG&&$>15&&(C>c||C!==o(C)))throw Error(a+j.s*C);if((k=k-W-1)>Ie)j.c=j.e=null;else if(k<ht)j.c=[j.e=0];else{if(j.e=k,j.c=[],W=(k+1)%u,k<0&&(W+=u),W<$){for(W&&j.c.push(+V.slice(0,W)),$-=u;W<$;)j.c.push(+V.slice(W,W+=u));W=u-(V=V.slice(W)).length}else W-=$;for(;W--;V+="0");j.c.push(+V)}}else j.c=[j.e=0]}p.clone=m,p.ROUND_UP=0,p.ROUND_DOWN=1,p.ROUND_CEIL=2,p.ROUND_FLOOR=3,p.ROUND_HALF_UP=4,p.ROUND_HALF_DOWN=5,p.ROUND_HALF_EVEN=6,p.ROUND_HALF_CEIL=7,p.ROUND_HALF_FLOOR=8,p.EUCLID=9,p.config=p.set=function(C){var b,E;if(C!=null)if(typeof C=="object"){if(C.hasOwnProperty(b="DECIMAL_PLACES")&&(E=C[b],w(E,0,f,b),X=E),C.hasOwnProperty(b="ROUNDING_MODE")&&(E=C[b],w(E,0,8,b),oe=E),C.hasOwnProperty(b="EXPONENTIAL_AT")&&(E=C[b],E&&E.pop?(w(E[0],-f,0,b),w(E[1],0,f,b),ee=E[0],ae=E[1]):(w(E,-f,f,b),ee=-(ae=E<0?-E:E))),C.hasOwnProperty(b="RANGE"))if(E=C[b],E&&E.pop)w(E[0],-f,-1,b),w(E[1],1,f,b),ht=E[0],Ie=E[1];else if(w(E,-f,f,b),E)ht=-(Ie=E<0?-E:E);else throw Error(s+b+" cannot be zero: "+E);if(C.hasOwnProperty(b="CRYPTO"))if(E=C[b],E===!!E)if(E)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))De=E;else throw De=!E,Error(s+"crypto unavailable");else De=E;else throw Error(s+b+" not true or false: "+E);if(C.hasOwnProperty(b="MODULO_MODE")&&(E=C[b],w(E,0,9,b),vt=E),C.hasOwnProperty(b="POW_PRECISION")&&(E=C[b],w(E,0,f,b),nt=E),C.hasOwnProperty(b="FORMAT"))if(E=C[b],typeof E=="object")st=E;else throw Error(s+b+" not an object: "+E);if(C.hasOwnProperty(b="ALPHABET"))if(E=C[b],typeof E=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(E))g=E.slice(0,10)=="0123456789",gn=E;else throw Error(s+b+" invalid: "+E)}else throw Error(s+"Object expected: "+C);return{DECIMAL_PLACES:X,ROUNDING_MODE:oe,EXPONENTIAL_AT:[ee,ae],RANGE:[ht,Ie],CRYPTO:De,MODULO_MODE:vt,POW_PRECISION:nt,FORMAT:st,ALPHABET:gn}},p.isBigNumber=function(C){if(!C||C._isBigNumber!==!0)return!1;if(!p.DEBUG)return!0;var b,E,T=C.c,I=C.e,k=C.s;e:if({}.toString.call(T)=="[object Array]"){if((k===1||k===-1)&&I>=-f&&I<=f&&I===o(I)){if(T[0]===0){if(I===0&&T.length===1)return!0;break e}if(b=(I+1)%u,b<1&&(b+=u),String(T[0]).length==b){for(b=0;b<T.length;b++)if(E=T[b],E<0||E>=l||E!==o(E))break e;if(E!==0)return!0}}}else if(T===null&&I===null&&(k===null||k===1||k===-1))return!0;throw Error(s+"Invalid BigNumber: "+C)},p.maximum=p.max=function(){return N(arguments,-1)},p.minimum=p.min=function(){return N(arguments,1)},p.random=function(){var C=9007199254740992,b=Math.random()*C&2097151?function(){return o(Math.random()*C)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(E){var T,I,k,W,H,$=0,V=[],j=new p(Z);if(E==null?E=X:w(E,0,f),W=i(E/u),De)if(crypto.getRandomValues){for(T=crypto.getRandomValues(new Uint32Array(W*=2));$<W;)H=T[$]*131072+(T[$+1]>>>11),H>=9e15?(I=crypto.getRandomValues(new Uint32Array(2)),T[$]=I[0],T[$+1]=I[1]):(V.push(H%1e14),$+=2);$=W/2}else if(crypto.randomBytes){for(T=crypto.randomBytes(W*=7);$<W;)H=(T[$]&31)*281474976710656+T[$+1]*1099511627776+T[$+2]*4294967296+T[$+3]*16777216+(T[$+4]<<16)+(T[$+5]<<8)+T[$+6],H>=9e15?crypto.randomBytes(7).copy(T,$):(V.push(H%1e14),$+=7);$=W/7}else throw De=!1,Error(s+"crypto unavailable");if(!De)for(;$<W;)H=b(),H<9e15&&(V[$++]=H%1e14);for(W=V[--$],E%=u,W&&E&&(H=h[u-E],V[$]=o(W/H)*H);V[$]===0;V.pop(),$--);if($<0)V=[k=0];else{for(k=-1;V[0]===0;V.splice(0,1),k-=u);for($=1,H=V[0];H>=10;H/=10,$++);$<u&&(k-=u-$)}return j.e=k,j.c=V,j}}(),p.sum=function(){for(var C=1,b=arguments,E=new p(b[0]);C<b.length;)E=E.plus(b[C++]);return E},z=function(){var C="0123456789";function b(E,T,I,k){for(var W,H=[0],$,V=0,j=E.length;V<j;){for($=H.length;$--;H[$]*=T);for(H[0]+=k.indexOf(E.charAt(V++)),W=0;W<H.length;W++)H[W]>I-1&&(H[W+1]==null&&(H[W+1]=0),H[W+1]+=H[W]/I|0,H[W]%=I)}return H.reverse()}return function(E,T,I,k,W){var H,$,V,j,U,ie,se,Se,$e=E.indexOf("."),Fe=X,be=oe;for($e>=0&&(j=nt,nt=0,E=E.replace(".",""),Se=new p(T),ie=Se.pow(E.length-$e),nt=j,Se.c=b(L(S(ie.c),ie.e,"0"),10,I,C),Se.e=Se.c.length),se=b(E,T,I,W?(H=gn,C):(H=C,gn)),V=j=se.length;se[--j]==0;se.pop());if(!se[0])return H.charAt(0);if($e<0?--V:(ie.c=se,ie.e=V,ie.s=k,ie=x(ie,Se,Fe,be,I),se=ie.c,U=ie.r,V=ie.e),$=V+Fe+1,$e=se[$],j=I/2,U=U||$<0||se[$+1]!=null,U=be<4?($e!=null||U)&&(be==0||be==(ie.s<0?3:2)):$e>j||$e==j&&(be==4||U||be==6&&se[$-1]&1||be==(ie.s<0?8:7)),$<1||!se[0])E=U?L(H.charAt(1),-Fe,H.charAt(0)):H.charAt(0);else{if(se.length=$,U)for(--I;++se[--$]>I;)se[$]=0,$||(++V,se=[1].concat(se));for(j=se.length;!se[--j];);for($e=0,E="";$e<=j;E+=H.charAt(se[$e++]));E=L(E,V,H.charAt(0))}return E}}(),x=function(){function C(T,I,k){var W,H,$,V,j=0,U=T.length,ie=I%d,se=I/d|0;for(T=T.slice();U--;)$=T[U]%d,V=T[U]/d|0,W=se*$+V*ie,H=ie*$+W%d*d+j,j=(H/k|0)+(W/d|0)+se*V,T[U]=H%k;return j&&(T=[j].concat(T)),T}function b(T,I,k,W){var H,$;if(k!=W)$=k>W?1:-1;else for(H=$=0;H<k;H++)if(T[H]!=I[H]){$=T[H]>I[H]?1:-1;break}return $}function E(T,I,k,W){for(var H=0;k--;)T[k]-=H,H=T[k]<I[k]?1:0,T[k]=H*W+T[k]-I[k];for(;!T[0]&&T.length>1;T.splice(0,1));}return function(T,I,k,W,H){var $,V,j,U,ie,se,Se,$e,Fe,be,ye,Je,Xn,vo,oi,an,Ct,Et=T.s==I.s?1:-1,mt=T.c,Xe=I.c;if(!mt||!mt[0]||!Xe||!Xe[0])return new p(!T.s||!I.s||(mt?Xe&&mt[0]==Xe[0]:!Xe)?NaN:mt&&mt[0]==0||!Xe?Et*0:Et/0);for($e=new p(Et),Fe=$e.c=[],V=T.e-I.e,Et=k+V+1,H||(H=l,V=v(T.e/u)-v(I.e/u),Et=Et/u|0),j=0;Xe[j]==(mt[j]||0);j++);if(Xe[j]>(mt[j]||0)&&V--,Et<0)Fe.push(1),U=!0;else{for(vo=mt.length,an=Xe.length,j=0,Et+=2,ie=o(H/(Xe[0]+1)),ie>1&&(Xe=C(Xe,ie,H),mt=C(mt,ie,H),an=Xe.length,vo=mt.length),Xn=an,be=mt.slice(0,an),ye=be.length;ye<an;be[ye++]=0);Ct=Xe.slice(),Ct=[0].concat(Ct),oi=Xe[0],Xe[1]>=H/2&&oi++;do{if(ie=0,$=b(Xe,be,an,ye),$<0){if(Je=be[0],an!=ye&&(Je=Je*H+(be[1]||0)),ie=o(Je/oi),ie>1)for(ie>=H&&(ie=H-1),se=C(Xe,ie,H),Se=se.length,ye=be.length;b(se,be,Se,ye)==1;)ie--,E(se,an<Se?Ct:Xe,Se,H),Se=se.length,$=1;else ie==0&&($=ie=1),se=Xe.slice(),Se=se.length;if(Se<ye&&(se=[0].concat(se)),E(be,se,ye,H),ye=be.length,$==-1)for(;b(Xe,be,an,ye)<1;)ie++,E(be,an<ye?Ct:Xe,ye,H),ye=be.length}else $===0&&(ie++,be=[0]);Fe[j++]=ie,be[0]?be[ye++]=mt[Xn]||0:(be=[mt[Xn]],ye=1)}while((Xn++<vo||be[0]!=null)&&Et--);U=be[0]!=null,Fe[0]||Fe.splice(0,1)}if(H==l){for(j=1,Et=Fe[0];Et>=10;Et/=10,j++);B($e,k+($e.e=j+V*u-1)+1,W,U)}else $e.e=V,$e.r=+U;return $e}}();function y(C,b,E,T){var I,k,W,H,$;if(E==null?E=oe:w(E,0,8),!C.c)return C.toString();if(I=C.c[0],W=C.e,b==null)$=S(C.c),$=T==1||T==2&&(W<=ee||W>=ae)?O($,W):L($,W,"0");else if(C=B(new p(C),b,E),k=C.e,$=S(C.c),H=$.length,T==1||T==2&&(b<=k||k<=ee)){for(;H<b;$+="0",H++);$=O($,k)}else if(b-=W,$=L($,k,"0"),k+1>H){if(--b>0)for($+=".";b--;$+="0");}else if(b+=k-H,b>0)for(k+1==H&&($+=".");b--;$+="0");return C.s<0&&I?"-"+$:$}function N(C,b){for(var E,T,I=1,k=new p(C[0]);I<C.length;I++)T=new p(C[I]),(!T.s||(E=R(k,T))===b||E===0&&k.s===b)&&(k=T);return k}function F(C,b,E){for(var T=1,I=b.length;!b[--I];b.pop());for(I=b[0];I>=10;I/=10,T++);return(E=T+E*u-1)>Ie?C.c=C.e=null:E<ht?C.c=[C.e=0]:(C.e=E,C.c=b),C}q=function(){var C=/^(-?)0([xbo])(?=\w[\w.]*$)/i,b=/^([^.]+)\.$/,E=/^\.([^.]+)$/,T=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(k,W,H,$){var V,j=H?W:W.replace(I,"");if(T.test(j))k.s=isNaN(j)?null:j<0?-1:1;else{if(!H&&(j=j.replace(C,function(U,ie,se){return V=(se=se.toLowerCase())=="x"?16:se=="b"?2:8,!$||$==V?ie:U}),$&&(V=$,j=j.replace(b,"$1").replace(E,"0.$1")),W!=j))return new p(j,V);if(p.DEBUG)throw Error(s+"Not a"+($?" base "+$:"")+" number: "+W);k.s=null}k.c=k.e=null}}();function B(C,b,E,T){var I,k,W,H,$,V,j,U=C.c,ie=h;if(U){e:{for(I=1,H=U[0];H>=10;H/=10,I++);if(k=b-I,k<0)k+=u,W=b,$=U[V=0],j=o($/ie[I-W-1]%10);else if(V=i((k+1)/u),V>=U.length)if(T){for(;U.length<=V;U.push(0));$=j=0,I=1,k%=u,W=k-u+1}else break e;else{for($=H=U[V],I=1;H>=10;H/=10,I++);k%=u,W=k-u+I,j=W<0?0:o($/ie[I-W-1]%10)}if(T=T||b<0||U[V+1]!=null||(W<0?$:$%ie[I-W-1]),T=E<4?(j||T)&&(E==0||E==(C.s<0?3:2)):j>5||j==5&&(E==4||T||E==6&&(k>0?W>0?$/ie[I-W]:0:U[V-1])%10&1||E==(C.s<0?8:7)),b<1||!U[0])return U.length=0,T?(b-=C.e+1,U[0]=ie[(u-b%u)%u],C.e=-b||0):U[0]=C.e=0,C;if(k==0?(U.length=V,H=1,V--):(U.length=V+1,H=ie[u-k],U[V]=W>0?o($/ie[I-W]%ie[W])*H:0),T)for(;;)if(V==0){for(k=1,W=U[0];W>=10;W/=10,k++);for(W=U[0]+=H,H=1;W>=10;W/=10,H++);k!=H&&(C.e++,U[0]==l&&(U[0]=1));break}else{if(U[V]+=H,U[V]!=l)break;U[V--]=0,H=1}for(k=U.length;U[--k]===0;U.pop());}C.e>Ie?C.c=C.e=null:C.e<ht&&(C.c=[C.e=0])}return C}function Y(C){var b,E=C.e;return E===null?C.toString():(b=S(C.c),b=E<=ee||E>=ae?O(b,E):L(b,E,"0"),C.s<0?"-"+b:b)}return A.absoluteValue=A.abs=function(){var C=new p(this);return C.s<0&&(C.s=1),C},A.comparedTo=function(C,b){return R(this,new p(C,b))},A.decimalPlaces=A.dp=function(C,b){var E,T,I,k=this;if(C!=null)return w(C,0,f),b==null?b=oe:w(b,0,8),B(new p(k),C+k.e+1,b);if(!(E=k.c))return null;if(T=((I=E.length-1)-v(this.e/u))*u,I=E[I])for(;I%10==0;I/=10,T--);return T<0&&(T=0),T},A.dividedBy=A.div=function(C,b){return x(this,new p(C,b),X,oe)},A.dividedToIntegerBy=A.idiv=function(C,b){return x(this,new p(C,b),0,1)},A.exponentiatedBy=A.pow=function(C,b){var E,T,I,k,W,H,$,V,j,U=this;if(C=new p(C),C.c&&!C.isInteger())throw Error(s+"Exponent not an integer: "+Y(C));if(b!=null&&(b=new p(b)),H=C.e>14,!U.c||!U.c[0]||U.c[0]==1&&!U.e&&U.c.length==1||!C.c||!C.c[0])return j=new p(Math.pow(+Y(U),H?C.s*(2-_(C)):+Y(C))),b?j.mod(b):j;if($=C.s<0,b){if(b.c?!b.c[0]:!b.s)return new p(NaN);T=!$&&U.isInteger()&&b.isInteger(),T&&(U=U.mod(b))}else{if(C.e>9&&(U.e>0||U.e<-1||(U.e==0?U.c[0]>1||H&&U.c[1]>=24e7:U.c[0]<8e13||H&&U.c[0]<=9999975e7)))return k=U.s<0&&_(C)?-0:0,U.e>-1&&(k=1/k),new p($?1/k:k);nt&&(k=i(nt/u+2))}for(H?(E=new p(.5),$&&(C.s=1),V=_(C)):(I=Math.abs(+Y(C)),V=I%2),j=new p(Z);;){if(V){if(j=j.times(U),!j.c)break;k?j.c.length>k&&(j.c.length=k):T&&(j=j.mod(b))}if(I){if(I=o(I/2),I===0)break;V=I%2}else if(C=C.times(E),B(C,C.e+1,1),C.e>14)V=_(C);else{if(I=+Y(C),I===0)break;V=I%2}U=U.times(U),k?U.c&&U.c.length>k&&(U.c.length=k):T&&(U=U.mod(b))}return T?j:($&&(j=Z.div(j)),b?j.mod(b):k?B(j,nt,oe,W):j)},A.integerValue=function(C){var b=new p(this);return C==null?C=oe:w(C,0,8),B(b,b.e+1,C)},A.isEqualTo=A.eq=function(C,b){return R(this,new p(C,b))===0},A.isFinite=function(){return!!this.c},A.isGreaterThan=A.gt=function(C,b){return R(this,new p(C,b))>0},A.isGreaterThanOrEqualTo=A.gte=function(C,b){return(b=R(this,new p(C,b)))===1||b===0},A.isInteger=function(){return!!this.c&&v(this.e/u)>this.c.length-2},A.isLessThan=A.lt=function(C,b){return R(this,new p(C,b))<0},A.isLessThanOrEqualTo=A.lte=function(C,b){return(b=R(this,new p(C,b)))===-1||b===0},A.isNaN=function(){return!this.s},A.isNegative=function(){return this.s<0},A.isPositive=function(){return this.s>0},A.isZero=function(){return!!this.c&&this.c[0]==0},A.minus=function(C,b){var E,T,I,k,W=this,H=W.s;if(C=new p(C,b),b=C.s,!H||!b)return new p(NaN);if(H!=b)return C.s=-b,W.plus(C);var $=W.e/u,V=C.e/u,j=W.c,U=C.c;if(!$||!V){if(!j||!U)return j?(C.s=-b,C):new p(U?W:NaN);if(!j[0]||!U[0])return U[0]?(C.s=-b,C):new p(j[0]?W:oe==3?-0:0)}if($=v($),V=v(V),j=j.slice(),H=$-V){for((k=H<0)?(H=-H,I=j):(V=$,I=U),I.reverse(),b=H;b--;I.push(0));I.reverse()}else for(T=(k=(H=j.length)<(b=U.length))?H:b,H=b=0;b<T;b++)if(j[b]!=U[b]){k=j[b]<U[b];break}if(k&&(I=j,j=U,U=I,C.s=-C.s),b=(T=U.length)-(E=j.length),b>0)for(;b--;j[E++]=0);for(b=l-1;T>H;){if(j[--T]<U[T]){for(E=T;E&&!j[--E];j[E]=b);--j[E],j[T]+=l}j[T]-=U[T]}for(;j[0]==0;j.splice(0,1),--V);return j[0]?F(C,j,V):(C.s=oe==3?-1:1,C.c=[C.e=0],C)},A.modulo=A.mod=function(C,b){var E,T,I=this;return C=new p(C,b),!I.c||!C.s||C.c&&!C.c[0]?new p(NaN):!C.c||I.c&&!I.c[0]?new p(I):(vt==9?(T=C.s,C.s=1,E=x(I,C,0,3),C.s=T,E.s*=T):E=x(I,C,0,vt),C=I.minus(E.times(C)),!C.c[0]&&vt==1&&(C.s=I.s),C)},A.multipliedBy=A.times=function(C,b){var E,T,I,k,W,H,$,V,j,U,ie,se,Se,$e,Fe,be=this,ye=be.c,Je=(C=new p(C,b)).c;if(!ye||!Je||!ye[0]||!Je[0])return!be.s||!C.s||ye&&!ye[0]&&!Je||Je&&!Je[0]&&!ye?C.c=C.e=C.s=null:(C.s*=be.s,!ye||!Je?C.c=C.e=null:(C.c=[0],C.e=0)),C;for(T=v(be.e/u)+v(C.e/u),C.s*=be.s,$=ye.length,U=Je.length,$<U&&(Se=ye,ye=Je,Je=Se,I=$,$=U,U=I),I=$+U,Se=[];I--;Se.push(0));for($e=l,Fe=d,I=U;--I>=0;){for(E=0,ie=Je[I]%Fe,se=Je[I]/Fe|0,W=$,k=I+W;k>I;)V=ye[--W]%Fe,j=ye[W]/Fe|0,H=se*V+j*ie,V=ie*V+H%Fe*Fe+Se[k]+E,E=(V/$e|0)+(H/Fe|0)+se*j,Se[k--]=V%$e;Se[k]=E}return E?++T:Se.splice(0,1),F(C,Se,T)},A.negated=function(){var C=new p(this);return C.s=-C.s||null,C},A.plus=function(C,b){var E,T=this,I=T.s;if(C=new p(C,b),b=C.s,!I||!b)return new p(NaN);if(I!=b)return C.s=-b,T.minus(C);var k=T.e/u,W=C.e/u,H=T.c,$=C.c;if(!k||!W){if(!H||!$)return new p(I/0);if(!H[0]||!$[0])return $[0]?C:new p(H[0]?T:I*0)}if(k=v(k),W=v(W),H=H.slice(),I=k-W){for(I>0?(W=k,E=$):(I=-I,E=H),E.reverse();I--;E.push(0));E.reverse()}for(I=H.length,b=$.length,I-b<0&&(E=$,$=H,H=E,b=I),I=0;b;)I=(H[--b]=H[b]+$[b]+I)/l|0,H[b]=l===H[b]?0:H[b]%l;return I&&(H=[I].concat(H),++W),F(C,H,W)},A.precision=A.sd=function(C,b){var E,T,I,k=this;if(C!=null&&C!==!!C)return w(C,1,f),b==null?b=oe:w(b,0,8),B(new p(k),C,b);if(!(E=k.c))return null;if(I=E.length-1,T=I*u+1,I=E[I]){for(;I%10==0;I/=10,T--);for(I=E[0];I>=10;I/=10,T++);}return C&&k.e+1>T&&(T=k.e+1),T},A.shiftedBy=function(C){return w(C,-c,c),this.times("1e"+C)},A.squareRoot=A.sqrt=function(){var C,b,E,T,I,k=this,W=k.c,H=k.s,$=k.e,V=X+4,j=new p("0.5");if(H!==1||!W||!W[0])return new p(!H||H<0&&(!W||W[0])?NaN:W?k:1/0);if(H=Math.sqrt(+Y(k)),H==0||H==1/0?(b=S(W),(b.length+$)%2==0&&(b+="0"),H=Math.sqrt(+b),$=v(($+1)/2)-($<0||$%2),H==1/0?b="5e"+$:(b=H.toExponential(),b=b.slice(0,b.indexOf("e")+1)+$),E=new p(b)):E=new p(H+""),E.c[0]){for($=E.e,H=$+V,H<3&&(H=0);;)if(I=E,E=j.times(I.plus(x(k,I,V,1))),S(I.c).slice(0,H)===(b=S(E.c)).slice(0,H))if(E.e<$&&--H,b=b.slice(H-3,H+1),b=="9999"||!T&&b=="4999"){if(!T&&(B(I,I.e+X+2,0),I.times(I).eq(k))){E=I;break}V+=4,H+=4,T=1}else{(!+b||!+b.slice(1)&&b.charAt(0)=="5")&&(B(E,E.e+X+2,1),C=!E.times(E).eq(k));break}}return B(E,E.e+X+1,oe,C)},A.toExponential=function(C,b){return C!=null&&(w(C,0,f),C++),y(this,C,b,1)},A.toFixed=function(C,b){return C!=null&&(w(C,0,f),C=C+this.e+1),y(this,C,b)},A.toFormat=function(C,b,E){var T,I=this;if(E==null)C!=null&&b&&typeof b=="object"?(E=b,b=null):C&&typeof C=="object"?(E=C,C=b=null):E=st;else if(typeof E!="object")throw Error(s+"Argument not an object: "+E);if(T=I.toFixed(C,b),I.c){var k,W=T.split("."),H=+E.groupSize,$=+E.secondaryGroupSize,V=E.groupSeparator||"",j=W[0],U=W[1],ie=I.s<0,se=ie?j.slice(1):j,Se=se.length;if($&&(k=H,H=$,$=k,Se-=k),H>0&&Se>0){for(k=Se%H||H,j=se.substr(0,k);k<Se;k+=H)j+=V+se.substr(k,H);$>0&&(j+=V+se.slice(k)),ie&&(j="-"+j)}T=U?j+(E.decimalSeparator||"")+(($=+E.fractionGroupSize)?U.replace(new RegExp("\\d{"+$+"}\\B","g"),"$&"+(E.fractionGroupSeparator||"")):U):j}return(E.prefix||"")+T+(E.suffix||"")},A.toFraction=function(C){var b,E,T,I,k,W,H,$,V,j,U,ie,se=this,Se=se.c;if(C!=null&&(H=new p(C),!H.isInteger()&&(H.c||H.s!==1)||H.lt(Z)))throw Error(s+"Argument "+(H.isInteger()?"out of range: ":"not an integer: ")+Y(H));if(!Se)return new p(se);for(b=new p(Z),V=E=new p(Z),T=$=new p(Z),ie=S(Se),k=b.e=ie.length-se.e-1,b.c[0]=h[(W=k%u)<0?u+W:W],C=!C||H.comparedTo(b)>0?k>0?b:V:H,W=Ie,Ie=1/0,H=new p(ie),$.c[0]=0;j=x(H,b,0,1),I=E.plus(j.times(T)),I.comparedTo(C)!=1;)E=T,T=I,V=$.plus(j.times(I=V)),$=I,b=H.minus(j.times(I=b)),H=I;return I=x(C.minus(E),T,0,1),$=$.plus(I.times(V)),E=E.plus(I.times(T)),$.s=V.s=se.s,k=k*2,U=x(V,T,k,oe).minus(se).abs().comparedTo(x($,E,k,oe).minus(se).abs())<1?[V,T]:[$,E],Ie=W,U},A.toNumber=function(){return+Y(this)},A.toPrecision=function(C,b){return C!=null&&w(C,1,f),y(this,C,b,2)},A.toString=function(C){var b,E=this,T=E.s,I=E.e;return I===null?T?(b="Infinity",T<0&&(b="-"+b)):b="NaN":(C==null?b=I<=ee||I>=ae?O(S(E.c),I):L(S(E.c),I,"0"):C===10&&g?(E=B(new p(E),X+I+1,oe),b=L(S(E.c),E.e,"0")):(w(C,2,gn.length,"Base"),b=z(L(S(E.c),I,"0"),10,C,T,!0)),T<0&&E.c[0]&&(b="-"+b)),b},A.valueOf=A.toJSON=function(){return Y(this)},A._isBigNumber=!0,M!=null&&p.set(M),p}function v(M){var x=M|0;return M>0||M===x?x:x-1}function S(M){for(var x,z,q=1,A=M.length,Z=M[0]+"";q<A;){for(x=M[q++]+"",z=u-x.length;z--;x="0"+x);Z+=x}for(A=Z.length;Z.charCodeAt(--A)===48;);return Z.slice(0,A+1||1)}function R(M,x){var z,q,A=M.c,Z=x.c,X=M.s,oe=x.s,ee=M.e,ae=x.e;if(!X||!oe)return null;if(z=A&&!A[0],q=Z&&!Z[0],z||q)return z?q?0:-oe:X;if(X!=oe)return X;if(z=X<0,q=ee==ae,!A||!Z)return q?0:!A^z?1:-1;if(!q)return ee>ae^z?1:-1;for(oe=(ee=A.length)<(ae=Z.length)?ee:ae,X=0;X<oe;X++)if(A[X]!=Z[X])return A[X]>Z[X]^z?1:-1;return ee==ae?0:ee>ae^z?1:-1}function w(M,x,z,q){if(M<x||M>z||M!==o(M))throw Error(s+(q||"Argument")+(typeof M=="number"?M<x||M>z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(M))}function _(M){var x=M.c.length-1;return v(M.e/u)==x&&M.c[x]%2!=0}function O(M,x){return(M.length>1?M.charAt(0)+"."+M.slice(1):M)+(x<0?"e":"e+")+x}function L(M,x,z){var q,A;if(x<0){for(A=z+".";++x;A+=z);M=A+M}else if(q=M.length,++x>q){for(A=z,x-=q;--x;A+=z);M+=A}else x<q&&(M=M.slice(0,x)+"."+M.slice(x));return M}n=m(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(u9)})(qk);var Kk=qk.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const wi=J0(),x9=Z0(),H9=Q0,A9=Kk,yn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Md={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:Xk,decimalSuffixes:am}=wi.currentBytes(),eT={general:{scale:1024,suffixes:am},binary:{scale:1024,suffixes:Xk},decimal:{scale:1e3,suffixes:am}};function N9(t,e={},n){if(typeof e=="string"&&(e=H9.parseFormat(e)),!x9.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=D9(t,e,n);return s=e8(s,i),s=t8(s,o),s}function D9(t,e,n){switch(e.output){case"currency":return e=mu(e,wi.currentCurrencyDefaultFormat()),j9(t,e,wi);case"percent":return e=mu(e,wi.currentPercentageDefaultFormat()),B9(t,e,wi,n);case"byte":return e=mu(e,wi.currentByteDefaultFormat()),F9(t,e,wi,n);case"time":return e=mu(e,wi.currentTimeDefaultFormat()),W9(t);case"ordinal":return e=mu(e,wi.currentOrdinalDefaultFormat()),V9(t,e,wi);case"number":default:return Id({instance:t,providedFormat:e})}}function k9(t){let e=eT.decimal;return Cp(t._value,e.suffixes,e.scale).suffix}function L9(t){let e=eT.binary;return Cp(t._value,e.suffixes,e.scale).suffix}function $9(t){let e=eT.general;return Cp(t._value,e.suffixes,e.scale).suffix}function Cp(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function F9(t,e,n,r){let i=e.base||"binary",o=Object.assign({},Md,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||am,marker:"bd"},binary:{scale:1024,suffixes:s||Xk,marker:"b"},decimal:{scale:1e3,suffixes:a||am,marker:"d"}}[i],{value:c,suffix:h}=Cp(t._value,u.suffixes,u.scale);return`${Id({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function V9(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},Md,e),o=Id({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function W9(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function B9(t,e,n,r){let i=e.prefixSymbol,o=Id({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},Md,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function j9(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},Md,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=Id({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function U9({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&yn[e]?(a=r[e],t=t/yn[e]):l>=yn.trillion||n&&s(l/yn.trillion)===1?(a=r.trillion,t=t/yn.trillion):l<yn.trillion&&l>=yn.billion||n&&s(l/yn.billion)===1?(a=r.billion,t=t/yn.billion):l<yn.billion&&l>=yn.million||n&&s(l/yn.million)===1?(a=r.million,t=t/yn.million):(l<yn.million&&l>=yn.thousand||n&&s(l/yn.thousand)===1)&&(a=r.thousand,t=t/yn.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function z9({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function bf(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function Y9(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+bf(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(bf(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=bf(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${bf(e)}`),n}function G9(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?Y9(t,e):new A9(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function q9(t,e,n,r,i,o){if(r===-1)return t;let s=G9(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function K9(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function X9(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function Z9(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),X9(u.length,a).forEach((f,m)=>{u=u.slice(0,f+m)+s+u.slice(f+m)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function Q9(t,e){return t+e}function J9(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function e8(t,e){return e+t}function t8(t,e){return t+e}function Id({instance:t,providedFormat:e,state:n=wi,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},Md,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,m=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,v=s.trimMantissa,S=s.thousandSeparated,R=s.spaceSeparated,w=s.negative,_=s.forceSign,O=s.exponential,L=s.roundingFunction,M="";if(d){let z=U9({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:R,roundingFunction:L,totalLength:a});o=z.value,M+=z.abbreviation,a&&(f=z.mantissaPrecision)}if(O){let z=z9({value:o,characteristicPrecision:l});o=z.value,M=z.abbreviation+M}let x=q9(o.toString(),o,m,f,v,L);return x=K9(x,o,u,l),x=Z9(x,o,S,n,r),(d||O)&&(x=Q9(x,M)),(_||o<0)&&(x=J9(x,o,w)),x}function mu(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var n8=t=>({format:(...e)=>N9(...e,t),getByteUnit:(...e)=>$9(...e,t),getBinaryByteUnit:(...e)=>L9(...e,t),getDecimalByteUnit:(...e)=>k9(...e,t),formatOrDefault:mu});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const ns=Kk;function r8(t,e,n){let r=new ns(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new ns(i),t._value=r.plus(i).toNumber(),t}function Zk(t,e,n){let r=new ns(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new ns(i),t._value=r.minus(i).toNumber(),t}function i8(t,e,n){let r=new ns(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new ns(i),t._value=r.times(i).toNumber(),t}function o8(t,e,n){let r=new ns(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new ns(i),t._value=r.dividedBy(i).toNumber(),t}function s8(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function a8(t,e,n){let r=n(t._value);return Zk(r,e,n),Math.abs(r._value)}var l8=t=>({add:(e,n)=>r8(e,n,t),subtract:(e,n)=>Zk(e,n,t),multiply:(e,n)=>i8(e,n,t),divide:(e,n)=>o8(e,n,t),set:(e,n)=>s8(e,n,t),difference:(e,n)=>a8(e,n,t),BigNumber:ns});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const u8="2.5.0",wo=J0(),c8=Z0(),h8=O9(Bt),d8=Gk();let pa=n8(Bt),Ba=l8(Bt);const f8=Q0;class Qk{constructor(e){this._value=e}clone(){return Bt(this._value)}format(e={}){return pa.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=f8.parseFormat(e)),e=pa.formatOrDefault(e,wo.currentCurrencyDefaultFormat()),e.output="currency",pa.format(this,e)}formatTime(e={}){return e.output="time",pa.format(this,e)}binaryByteUnits(){return pa.getBinaryByteUnit(this)}decimalByteUnits(){return pa.getDecimalByteUnit(this)}byteUnits(){return pa.getByteUnit(this)}difference(e){return Ba.difference(this,e)}add(e){return Ba.add(this,e)}subtract(e){return Ba.subtract(this,e)}multiply(e){return Ba.multiply(this,e)}divide(e){return Ba.divide(this,e)}set(e){return Ba.set(this,Jk(e))}value(){return this._value}valueOf(){return this._value}}function Jk(t){let e=t;return Bt.isNumbro(t)?e=t._value:typeof t=="string"?e=Bt.unformat(t):isNaN(t)&&(e=NaN),e}function Bt(t){return new Qk(Jk(t))}Bt.version=u8;Bt.isNumbro=function(t){return t instanceof Qk};Bt.language=wo.currentLanguage;Bt.registerLanguage=wo.registerLanguage;Bt.setLanguage=wo.setLanguage;Bt.languages=wo.languages;Bt.languageData=wo.languageData;Bt.zeroFormat=wo.setZeroFormat;Bt.defaultFormat=wo.currentDefaults;Bt.setDefaults=wo.setDefaults;Bt.defaultCurrencyFormat=wo.currentCurrencyDefaultFormat;Bt.validate=c8.validate;Bt.loadLanguagesInNode=h8.loadLanguagesInNode;Bt.unformat=d8.unformat;Bt.BigNumber=Ba.BigNumber;var g8=Bt,wa=c9(g8);const m8="numeric";function eL(t,e){if(zn(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!wa.languages()[r]){const o=r.replace("-",""),s=wa.allLanguages?wa.allLanguages[r]:wa[o];s&&wa.registerLanguage(s)}wa.setLanguage(r),t=wa(t).format(i||"0")}return t}function tT(t,e,n,r,i,o,s){let a=o;if(zn(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=eL(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}us(t,e,n,r,i,a,s)}tT.RENDERER_TYPE=m8;const p8="password";function nT(t,e,n,r,i,o,s){us.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";he(a-1,()=>{u+=l}),Ju(e,u)}nT.RENDERER_TYPE=p8;const w8="select";function rT(t,e,n,r,i,o,s){us.apply(this,[t,e,n,r,i,o,s])}rT.RENDERER_TYPE=w8;const v8="time";function iT(t,e,n,r,i,o,s){us.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}iT.RENDERER_TYPE=v8;function C8(){Fr(rc),Fr(_d),Fr(q0),Fr(G0),Fr(X0),Fr(Y0),Fr(tT),Fr(nT),Fr(rT),Fr(us),Fr(iT)}const y8="autocomplete";function yp(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,uH(n,e)):uH(n,e)(this.source):e(!0)}yp.VALIDATOR_TYPE=y8;function uH(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function S8(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const b8="date";function oT(t,e){const n=mD(Fk,this.instance);let r=t,i=!0;r==null&&(r="");let o=K(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=K(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=R8(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}oT.VALIDATOR_TYPE=b8;function R8(t,e){const n=K(S8(t)),r=K(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const E8="dropdown";function sT(t,e){yp.apply(this,[t,e])}sT.VALIDATOR_TYPE=E8;const T8="numeric";function aT(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:zn(t))}aT.VALIDATOR_TYPE=T8;const _8=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],M8="time";function lT(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=K(i,_8,!0).isValid()?K(i):K(i,n);let a=s.isValid(),l=K(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}lT.VALIDATOR_TYPE=M8;function I8(){fu(yp),fu(sT),fu(oT),fu(aT),fu(lT)}const P8="autocomplete",O8={CELL_TYPE:P8,editor:U0,renderer:rc,validator:yp},x8="checkbox",H8={CELL_TYPE:x8,editor:$k,renderer:q0},A8="date";function tL(t,e,n,r,i,o,s){rc.apply(this,[t,e,n,r,i,o,s])}tL.RENDERER_TYPE=A8;const N8="date",D8={CELL_TYPE:N8,editor:Vk,renderer:tL,validator:oT},k8="dropdown",L8={CELL_TYPE:k8,editor:Wk,renderer:G0,validator:sT,filter:!1,strict:!0},$8="handsontable",F8={CELL_TYPE:$8,editor:j0,renderer:X0},V8="numeric",W8={CELL_TYPE:V8,editor:Bk,renderer:tT,validator:aT,dataType:"number"},B8="password",j8={CELL_TYPE:B8,editor:jk,renderer:nT,copyable:!1},U8="select",z8={CELL_TYPE:U8,editor:Uk,renderer:rT},Y8="time",G8={CELL_TYPE:Y8,editor:zk,renderer:iT,validator:lT};function q8(){gi(O8),gi(H8),gi(D8),gi(L8),gi(F8),gi(W8),gi(j8),gi(z8),gi(Sk),gi(G8)}function K8(t,e){nL(t,e),e.add(t)}function X8(t,e,n){nL(t,e),e.set(t,n)}function nL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ll(t,e,n){return(e=Z8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z8(t){var e=Q8(t,"string");return typeof e=="symbol"?e:e+""}function Q8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $l(t,e){return t.get(rL(t,e))}function rL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cH=new Map([["plugin",GY],["cell-type",lk],["editor",gD],["renderer",bD],["validator",RD]]),iL=Symbol("mainSetting"),J8="base",Rf=[];let va=null;var Ca=new WeakMap,hH=new WeakSet;class Ke{static get PLUGIN_KEY(){return J8}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){K8(this,hH),Ll(this,"eventManager",new Pi(this)),Ll(this,"pluginName",null),Ll(this,"pluginsInitializedCallbacks",[]),Ll(this,"isPluginsReady",!1),Ll(this,"enabled",!1),Ll(this,"initialized",!1),X8(this,Ca,{}),as(this,"hot",e,{writable:!1}),va=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!cH.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);cH.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Rf.push(o)}}if(va||(va=SD()),va.indexOf(this.pluginName)>=0&&va.splice(va.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),va.length===0){if(Rf.length>0){const i=[`${Rf.join(`
`)}
`,"You have to import and register them manually."].join("");throw Rf.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||Ae(n))&&r[iL]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if(Ae(n)){var o;return(o=n[e])!==null&&o!==void 0?o:r[e]}return r[e]}addHook(e,n,r){$l(Ca,this)[e]=$l(Ca,this)[e]||[];const i=$l(Ca,this)[e];this.hot.addHook(e,n,r),i.push(n),$l(Ca,this)[e]=i}removeHooks(e){P($l(Ca,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=$l(Ca,this);Ne(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){P(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=rL(hH,this,e7).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ne(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function e7(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function ya(t,e,n){return(e=t7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t7(t){var e=n7(t,"string");return typeof e=="symbol"?e:e+""}function n7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let oL=class{constructor(e){ya(this,"hot",null),ya(this,"container",null),ya(this,"injected",!1),ya(this,"rows",[]),ya(this,"columns",[]),ya(this,"samples",null),ya(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&G(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),P(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),P(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{P(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{P(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{P(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),P(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{P(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),G(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return G(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Ef(t,e,n){return(e=r7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r7(t){var e=i7(t,"string");return typeof e=="symbol"?e:e+""}function i7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sp{static get SAMPLE_COUNT(){return 3}constructor(e){Ef(this,"samples",null),Ef(this,"dataFactory",null),Ef(this,"customSampleCount",null),Ef(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Sp.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return he(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return he(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:Ae(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${It(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function o7(t,e){sL(t,e),e.add(t)}function My(t,e,n){sL(t,e),e.set(t,n)}function sL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nc(t,e,n){return(e=s7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s7(t){var e=a7(t,"string");return typeof e=="symbol"?e:e+""}function a7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vs(t,e){return t.get(ur(t,e))}function lm(t,e,n){return t.set(ur(t,e),n),n}function ur(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("modifyAutoColumnSizeSeed");const Iy="autoColumnSize",l7=10,u7="autoColumnSize";var uT=new WeakMap,pu=new WeakMap,ju=new WeakMap,Er=new WeakSet;class Th extends Ke{static get PLUGIN_KEY(){return Iy}static get PLUGIN_PRIORITY(){return l7}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),o7(this,Er),Nc(this,"ghostTable",new oL(this.hot)),Nc(this,"samplesGenerator",new Sp((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),Nc(this,"inProgress",!1),Nc(this,"measuredColumns",0),Nc(this,"columnWidthsMap",new ta),My(this,uT,!1),My(this,pu,[]),My(this,ju,[]),this.hot.columnIndexMapper.registerMap(u7,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>ur(Er,this,dH).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[Iy]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ur(Er,e,d7).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ur(Er,e,f7).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ur(Er,e,m7).call(e,...i)}),this.addHook("beforeRender",()=>ur(Er,this,h7).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>ur(Er,this,g7).call(this)),super.enablePlugin()}updatePlugin(){lm(ju,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>ur(Er,this,dH).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;he(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&ur(Er,this,aL).call(this,s,o)}),this.ghostTable.columns.length&&(ur(Er,this,lL).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Xg(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+Th.CALCULATION_STEP,i)},e,n),r=r+Th.CALCULATION_STEP+1,r<i?o=Kg(s):(Xg(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Iy];let n=Th.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return Ae(e)&&(n=e.syncLimit,LN(n)?n=vD(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,$u))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=Vs(pu,this).length;return(s-1<o||Vs(pu,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?Vs(pu,this).push(i):Vs(pu,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function c7(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||ur(Er,this,aL).call(this,n,e))}),this.ghostTable.columns.length&&(ur(Er,this,lL).call(this),this.ghostTable.clean())}function aL(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function lL(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function h7(){this.calculateVisibleColumnsWidth(),this.inProgress||(ur(Er,this,c7).call(this,Vs(ju,this)),lm(ju,this,[]))}function d7(t,e){e||this.recalculateAllColumnsWidth()}function f7(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Vs(ju,this).push(...e)}function dH(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function g7(){lm(pu,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),lm(uT,this,!0)}function m7(t){if(!Vs(uT,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Vs(ju,this).push(...e)}const Xa={horizontal:"horizontal",vertical:"vertical"};function p7(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function w7(t){const e={};return t===!0?(e.directions=Object.keys(Xa),e.autoInsertRow=!0):Ae(t)?(le(t.autoInsertRow)?t.direction===Xa.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,le(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Xa)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function v7(t,e){C7(t,e),e.add(t)}function C7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fl(t,e,n){return(e=y7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y7(t){var e=S7(t,"string");return typeof e=="symbol"?e:e+""}function S7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("modifyAutofillRange");ne.getSingleton().register("beforeAutofill");ne.getSingleton().register("afterAutofill");const fH="autofill",b7=20,R7=["fillHandle"],E7="insert_row_below",T7=200;var Vl=new WeakSet;class _7 extends Ke{constructor(){super(...arguments),v7(this,Vl),Fl(this,"addingStarted",!1),Fl(this,"mouseDownOnCellCorner",!1),Fl(this,"mouseDragOutside",!1),Fl(this,"handleDraggedCells",0),Fl(this,"directions",[]),Fl(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return fH}static get PLUGIN_PRIORITY(){return b7}static get SETTING_KEYS(){return[fH,...R7]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Dc(Vl,this,I7).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Dc(Vl,this,M7).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Dc(Vl,this,P7).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return P(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),P(a,c=>{const h=[];P(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=p7(l,u,(f,m)=>this.hot._createCellCoords(f,m));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),m=o.clone(),v=this.hot._createCellRange(h,h,d),S=this.hot.runHooks("beforeAutofill",f,m,v,c);if(S===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let R=S;const w=S;if(["up","left"].indexOf(c)>-1&&!(w.length===1&&w[0].length===0))if(R=[],c==="up"){const _=d.row-h.row+1,O=_%w.length;for(let L=0;L<_;L++)R.push(w[(L+(w.length-O))%w.length])}else{const _=d.col-h.col+1,O=_%w[0].length;for(let L=0;L<w.length;L++){R.push([]);for(let M=0;M<_;M++)R[L].push(w[L][(M+(w[L].length-O))%w[L].length])}}this.hot.populateFromArray(h.row,h.col,R,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",R,m,v,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(Xa.vertical)&&this.directions.includes(Xa.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Xa.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Xa.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(E7,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},T7)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!Wt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!Wt(s)||!Wt(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ve(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=An(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+en(this.hot.table),i=An(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+Yt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Dc(Vl,this,O7).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Dc(Vl,this,x7).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=w7(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function M7(){this.selectAdjacent()&&this.fillIn()}function I7(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function P7(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function O7(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function x7(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function H7(t,e){uL(t,e),e.add(t)}function gH(t,e,n){uL(t,e),e.set(t,n)}function uL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wl(t,e,n){return(e=A7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A7(t){var e=N7(t,"string");return typeof e=="symbol"?e:e+""}function N7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cL(t,e,n){return t.set(no(t,e),n),n}function um(t,e){return t.get(no(t,e))}function no(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Py="autoRowSize",D7=40,k7="autoRowSize";var Qh=new WeakMap,cT=new WeakMap,Do=new WeakSet;class _h extends Ke{static get PLUGIN_KEY(){return Py}static get PLUGIN_PRIORITY(){return D7}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),H7(this,Do),Wl(this,"headerHeight",null),Wl(this,"ghostTable",new oL(this.hot)),Wl(this,"samplesGenerator",new Sp((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),Wl(this,"inProgress",!1),Wl(this,"measuredRows",0),Wl(this,"rowHeightsMap",new ta),gH(this,Qh,[]),gH(this,cT,!1),this.hot.rowIndexMapper.registerMap(k7,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>no(Do,this,mH).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[Py];return e===!0||Ae(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return no(Do,e,F7).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return no(Do,e,V7).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return no(Do,e,B7).call(e,...i)}),this.addHook("beforeRender",()=>no(Do,this,$7).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>no(Do,this,W7).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>no(Do,this,mH).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}he(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Xg(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+_h.CALCULATION_STEP,i)},e,n),r=r+_h.CALCULATION_STEP+1,r<i?o=Kg(s):(Xg(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Py];let n=_h.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return Ae(e)&&(n=e.syncLimit,LN(n)?n=vD(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{he(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function L7(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function $7(){this.calculateVisibleRowsHeight(),this.inProgress||(no(Do,this,L7).call(this,um(Qh,this)),cL(Qh,this,[]))}function mH(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function F7(t,e){e||this.recalculateAllRowsHeight()}function V7(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);um(Qh,this).push(...e)}function W7(){this.recalculateAllRowsHeight(),cL(cT,this,!0)}function B7(t){if(!um(cT,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);um(Qh,this).push(...e)}const{getListWithInsertedItems:j7,getListWithRemovedItems:U7}=UD("physicallyIndexed");class z7 extends Sl{constructor(){super(e=>e)}insert(e,n){const r=pE(this.indexedValues,n);this.indexedValues=j7(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=U7(this.indexedValues,e);this.indexedValues=mE(n,e),super.remove(e)}}const{getListWithInsertedItems:Y7,getListWithRemovedItems:G7}=UD("physicallyIndexed");class q7 extends Sl{constructor(){super(e=>e)}insert(e,n){this.indexedValues=Y7(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=G7(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function K7(t,e){X7(t,e),e.add(t)}function X7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Z7(t,e,n){return(e=Q7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q7(t){var e=J7(t,"string");return typeof e=="symbol"?e:e+""}function J7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function e5(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pH="bindRowsWithHeaders",t5=210,n5="loose",wH=new Map([["loose",z7],["strict",q7]]);var vH=new WeakSet;class r5 extends Ke{constructor(){super(...arguments),K7(this,vH),Z7(this,"headerIndexes",null)}static get PLUGIN_KEY(){return pH}static get PLUGIN_PRIORITY(){return t5}isEnabled(){return!!this.hot.getSettings()[pH]}enablePlugin(){var e;if(this.enabled)return;const n=(e=wH.get(this.getSetting()))!==null&&e!==void 0?e:wH.get(n5);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>e5(vH,this,i5).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function i5(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function o5(t,e){hL(t,e),e.add(t)}function s5(t,e,n){hL(t,e),e.set(t,n)}function hL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CH(t,e,n){return(e=a5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a5(t){var e=l5(t,"string");return typeof e=="symbol"?e:e+""}function l5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yH(t,e){return t.get(Ru(t,e))}function Oy(t,e,n){return t.set(Ru(t,e),n),n}function Ru(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Og="collapsibleColumns",u5=290,c5=["nestedHeaders"],Hu="collapsibleIndicator",SH=Og,bH=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Bl=new WeakMap,kc=new WeakSet;class h5 extends Ke{constructor(){super(...arguments),o5(this,kc),CH(this,"nestedHeadersPlugin",null),CH(this,"headerStateManager",null),s5(this,Bl,null)}static get PLUGIN_KEY(){return Og}static get PLUGIN_PRIORITY(){return u5}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Og,...c5]}isEnabled(){return!!this.hot.getSettings()[Og]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||qe("You need to configure the Nested Headers plugin in order to use collapsible headers."),Oy(Bl,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Ru(kc,this,g5).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ru(kc,e,m5).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ru(kc,e,d5).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Ru(kc,this,f5).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Oy(Bl,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:SH,relativeToGroup:na,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SH)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};he(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;he(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Hu}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Hu}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Hu}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!bH.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=il(e,f=>{let{row:m}=f;return m<0});let i=r.length>0;P(r,f=>{var m;let{row:v,col:S}=f;const{collapsible:R,isCollapsed:w}=(m=this.headerStateManager.getHeaderSettings(v,S))!==null&&m!==void 0?m:{};if(!R||w&&n==="collapse"||!w&&n==="expand")return i=!1,!1});const o=[],s=[];i&&P(r,f=>{let{row:m,col:v}=f;const{colspanCompensation:S,affectedColumns:R,rollbackModification:w}=this.headerStateManager.triggerNodeModification(n,m,v);S>0&&(s.push(...R),o.push(w))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=YU([...a,...s]):n==="expand"&&(l=il(a,f=>!s.includes(f)));const u=bH.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){P(o,f=>{f()});return}this.hot.batchExecution(()=>{P(s,f=>{yH(Bl,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:m}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(m))&&s.includes(m)){const S=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,R=m>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(m,1,!0):m;S!==null&&R!==null&&this.hot.selectCell(S,R)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return yH(Bl,this).getHiddenIndexes()}destroy(){Oy(Bl,this,null),super.destroy()}}function d5(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Hu}`);if(Qu(e,[Xr("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),G(u,Hu),e.querySelector("div:first-child").appendChild(u)),pe(u,["collapsed","expanded"]),s?(G(u,"collapsed"),sl(u,"+"),l&&ve(e,...Xr(!1))):(G(u,"expanded"),sl(u,"-"),l&&ve(e,...Xr(!0))),l&&ve(u,...yl());else{var c;(c=u)===null||c===void 0||c.remove()}}function f5(t,e){Ce(t.target,Hu)&&(Ce(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Ce(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Hi(t))}function g5(){this.updatePlugin()}function m5(t,e){e||this.updatePlugin()}function Sa(t,e,n){return(e=p5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p5(t){var e=w5(t,"string");return typeof e=="symbol"?e:e+""}function w5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const v5=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],C5=!1,y5=!0,S5=!0;class b5{constructor(e,n){Sa(this,"hot",void 0),Sa(this,"sortingStates",new dp),Sa(this,"sortEmptyCells",C5),Sa(this,"indicator",y5),Sa(this,"headerAction",S5),Sa(this,"compareFunctionFactory",void 0),Sa(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Ae(e)&&Ne(e,(n,r)=>{v5.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Ae(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(le(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function dL(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?uo:Wt(i)?Wt(o)?uo:s&&t==="asc"?Nt:Dt:Wt(o)?s&&t==="asc"?Dt:Nt:isNaN(i)&&!isNaN(o)?t==="asc"?Dt:Nt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?Nt:Dt:i>o?t==="asc"?Dt:Nt:uo}}const fL="default";function R5(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return uo;if(a){if(Wt(r))return t==="asc"?Nt:Dt;if(Wt(i))return t==="asc"?Dt:Nt}return isNaN(o)?Dt:isNaN(s)?Nt:o<s?t==="asc"?Nt:Dt:o>s?t==="asc"?Dt:Nt:uo}}const E5="numeric";function T5(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Wt(s),u=Wt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return Dt;if(l===!1&&u)return Nt}return d===!1&&f?t==="asc"?Nt:Dt:d&&f===!1?t==="asc"?Dt:Nt:d===!1&&f===!1?dL(t,e,n)(s,a):c===i&&h===r?t==="asc"?Nt:Dt:c===r&&h===i?t==="asc"?Dt:Nt:uo}}const _5="checkbox";function M5(t,e,n){return CL(t,e.dateFormat,n)}const I5="date";function P5(t,e,n){return CL(t,e.timeFormat,n)}const O5="time",{register:Pd,getItem:RH,hasItem:x5}=ri("sorting.compareFunctionFactory"),{register:gL,getItem:H5}=ri("sorting.mainSortComparator");function mL(t){return x5(t)?RH(t):RH(fL)}Pd(_5,T5);Pd(I5,M5);Pd(fL,dL);Pd(E5,R5);Pd(O5,P5);const uo=0,Nt=-1,Dt=1;function A5(t,e){const n=H5(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const cm="asc",hm="desc",pL="colHeader";function N5(t){if(Ae(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[cm,hm].includes(n)}function D5(t){if(t.some(n=>N5(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function EH(t){if(t!==hm)return t===cm?hm:cm}function wL(t){return t.querySelector(`.${pL}`)}function vL(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function hT(t,e,n){return t===-1&&e>=0&&al(n)===!1}function CL(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return uo;if(Wt(r))return Wt(i)?uo:o&&t==="asc"?Nt:Dt;if(Wt(i))return o&&t==="asc"?Dt:Nt;const s=K(r,e),a=K(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?Nt:Dt:a.isBefore(s)?t==="asc"?Dt:Nt:uo:Nt:Dt}}function k5(t,e){qe(tt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const L5="ascending",$5="descending",yL="indicatorDisabled",SL="columnSorting",bL="sortAction",RL=new Map([[cm,L5],[hm,$5]]);function F5(t,e,n,r){const i=[SL];if(r&&i.push(bL),n===!1)return i.push(yL),i;const o=t.getSortOrderOfColumn(e);return le(o)&&i.push(RL.get(o)),i}function V5(){return Array.from(RL.values()).concat(bL,yL,SL)}function W5(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:mL(u.type))(l,u,d)(c,h)}(0)}}function B5(t,e){j5(t,e),e.add(t)}function j5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tf(t,e,n){return(e=U5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U5(t){var e=z5(t,"string");return typeof e=="symbol"?e:e+""}function z5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const dm="columnSorting",Y5=50,fm="append",G5="replace",TH=dm;gL(dm,W5);ne.getSingleton().register("beforeColumnSort");ne.getSingleton().register("afterColumnSort");const Lc=new WeakMap;var ja=new WeakSet;class EL extends Ke{constructor(){super(...arguments),B5(this,ja),Tf(this,"columnStatesManager",null),Tf(this,"columnMetaCache",null),Tf(this,"pluginKey",dm),Tf(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return dm}static get PLUGIN_PRIORITY(){return Y5}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(Lc.has(this.hot)&&Lc.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),k5(Lc.get(this.hot),this.pluginKey);return}this.enabled||(Lc.set(this.hot,this.pluginKey),this.columnStatesManager=new b5(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new ta(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>wu(ja,this,q5).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wu(ja,e,X5).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>wu(ja,this,Ib).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wu(ja,e,K5).call(e,...r)}),this.hot.view&&wu(ja,this,Ib).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=wL(r);vL(n,r)===!1||i===null||this.updateHeaderClasses(i)};Lc.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:na,position:"before",group:TH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(TH)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new zD),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return le(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return D5(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ve(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return le(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ve(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(le(n)){const i=EH(n);return le(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:EH()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fm;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Mt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===fm)return[...o.slice(0,r),...o.slice(r+1),s];if(n===G5)return[...o.slice(0,r),s,...o.slice(r+1)]}return le(s)?o.concat(s):o}getPluginColumnConfig(e){if(Ae(e)){const n=e[this.pluginKey];if(Ae(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):it(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>Ve(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ve(n,u=>u[0]);A5(n,this.pluginKey,Ve(e,u=>u.sortOrder),Ve(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ve(n,u=>u[0]),a=new Map(Ve(o,(u,c)=>[u,s[c]])),l=Ve(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Ae(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Ae(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(pe(e,V5()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];G(e,F5(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),le(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&Ce(e.target,pL)}onAfterOnCellMouseDown(e,n){if(hT(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function Ib(){const t=this.getAllSavedSortSettings();if(Ae(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function q5(t,e){const n=wL(e);if(vL(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);ve(e,...gz(s?`${s}ending`:"none"))}}function K5(t){t===!0&&this.hot.view&&wu(ja,this,Ib).call(this)}function X5(t,e,n,r){hT(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function ba(t,e,n){return(e=Z5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z5(t){var e=Q5(t,"string");return typeof e=="symbol"?e:e+""}function Q5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class J5{constructor(e,n){ba(this,"plugin",void 0),ba(this,"hot",void 0),ba(this,"endpoints",[]),ba(this,"settings",void 0),ba(this,"settingsType","array"),ba(this,"currentEndpoint",null),ba(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),P(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();P(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;P(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?P(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):P(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){P(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];P(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),P(i,o=>{let s=[];P(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,P(e.ranges,r=>{P(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],P(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],P(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],P(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&P(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),P(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){qe("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function xy(t){return t==null||isNaN(t)}function eZ(t,e){tZ(t,e),e.add(t)}function tZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nZ(t,e,n){return(e=rZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rZ(t){var e=iZ(t,"string");return typeof e=="symbol"?e:e+""}function iZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _f(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Hy="columnSummary",oZ=220;var $c=new WeakSet;class sZ extends Ke{constructor(){super(...arguments),eZ(this,$c),nZ(this,"endpoints",null)}static get PLUGIN_KEY(){return Hy}static get PLUGIN_PRIORITY(){return oZ}isEnabled(){return!!this.hot.getSettings()[Hy]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Hy],this.endpoints=new J5(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _f($c,e,aZ).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _f($c,e,uZ).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _f($c,e,lZ).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return _f($c,e,cZ).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ne(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=xy(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Ne(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=xy(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=xy(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Ne(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(tt`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function aZ(){this.endpoints.initEndpoints()}function lZ(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function uZ(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function cZ(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function hZ(t,e){TL(t,e),e.add(t)}function Ay(t,e,n){TL(t,e),e.set(t,n)}function TL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vu(t,e){return t.get(dT(t,e))}function Pb(t,e,n){return t.set(dT(t,e),n),n}function dT(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gm=new WeakMap,Mf=new WeakMap,If=new WeakMap,_H=new WeakSet;class _L{constructor(){hZ(this,_H),Ay(this,gm,!0),Ay(this,Mf,null),Ay(this,If,new ResizeObserver(e=>dT(_H,this,dZ).call(this,e)))}setObservedElement(e){Pb(Mf,this,e)}unobserve(){vu(If,this).unobserve(vu(Mf,this))}observe(){Pb(gm,this,!0),vu(If,this).observe(vu(Mf,this))}destroy(){vu(If,this).disconnect()}}function dZ(t){if(vu(gm,this)||!Array.isArray(t)||!t.length){Pb(gm,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}ct(_L,bn);function fs(t,e,n){fZ(t,e),e.set(t,n)}function fZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function at(t,e){return t.get(ML(t,e))}function Vi(t,e,n){return t.set(ML(t,e),n),n}function ML(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jl=new WeakMap,Ny=new WeakMap,Dy=new WeakMap,Po=new WeakMap,gs=new WeakMap,ms=new WeakMap,Pf=new WeakMap,Ul=new WeakMap;class Za{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n,r){var i=this;fs(this,jl,void 0),fs(this,Ny,void 0),fs(this,Dy,!1),fs(this,Po,null),fs(this,gs,void 0),fs(this,ms,void 0),fs(this,Pf,!0),fs(this,Ul,new _L),Vi(jl,this,e),Vi(Ny,this,r),Vi(Dy,this,n),Vi(gs,this,this.createEditor()),Vi(ms,this,at(gs,this).style),at(Ul,this).setObservedElement(this.getInputElement()),at(Ul,this).addLocalHook("resize",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,n){at(ms,this).left=`${e}px`,at(ms,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:Yt(this.getInputElement()),height:en(this.getInputElement())}}observeSize(){at(Ul,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){at(ms,this).display="block",Vi(Pf,this,!1)}hide(){at(Ul,this).unobserve(),at(Pf,this)||(at(ms,this).display="none"),Vi(Pf,this,!0)}isVisible(){return at(ms,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return at(jl,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=at(jl,this).createElement("div"),n=at(jl,this).createElement("textarea");return e.style.display="none",Vi(Po,this,at(jl,this).createElement("div")),at(Po,this).setAttribute("dir",at(Dy,this)?"rtl":"ltr"),G(at(Po,this),Za.CLASS_EDITOR_CONTAINER),at(Ny,this).appendChild(at(Po,this)),G(e,Za.CLASS_EDITOR),G(n,Za.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),at(Po,this).appendChild(e),e}getInputElement(){return at(gs,this).querySelector(`.${Za.CLASS_INPUT}`)}getEditorElement(){return at(gs,this)}destroy(){const e=at(Po,this)?at(Po,this).parentNode:null;at(gs,this).parentNode.removeChild(at(gs,this)),Vi(gs,this,null),Vi(ms,this,null),at(Ul,this).destroy(),e&&e.removeChild(at(Po,this))}}ct(Za,bn);function ky(t,e,n){return(e=gZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gZ(t){var e=mZ(t,"string");return typeof e=="symbol"?e:e+""}function mZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pZ=250,wZ=250;class IL{constructor(e){ky(this,"wasLastActionShow",!0),ky(this,"showDebounced",null),ky(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},wZ)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pZ;this.showDebounced=sp(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}ct(IL,bn);function vZ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function CZ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Ra(t,e){const n={};return P(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function Is(t,e,n,r,i){P(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&yZ(s,a,e,n,r,i)})})}function yZ(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=vZ(s.className,r):a=CZ(s.className,r)),o(t,e,"className",a)}function PL(t){return`<span class="selected">â</span>${t}`}function xg(t,e){let n=!1;return Array.isArray(t)&&P(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function bp(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const He="---------";function SZ(){return{name:He}}const jr="alignment";function bZ(){return{key:jr,name(){return this.getTranslatedPhrase(WE)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${jr}:left`,name(){return this.getTranslatedPhrase(BE)},callback(){const t=this.getSelectedRange(),e=Ra(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),Is(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${jr}:center`,name(){return this.getTranslatedPhrase(jE)},callback(){const t=this.getSelectedRange(),e=Ra(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),Is(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${jr}:right`,name(){return this.getTranslatedPhrase(UE)},callback(){const t=this.getSelectedRange(),e=Ra(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),Is(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${jr}:justify`,name(){return this.getTranslatedPhrase(zE)},callback(){const t=this.getSelectedRange(),e=Ra(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),Is(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:He},{key:`${jr}:top`,name(){return this.getTranslatedPhrase(YE)},callback(){const t=this.getSelectedRange(),e=Ra(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),Is(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${jr}:middle`,name(){return this.getTranslatedPhrase(GE)},callback(){const t=this.getSelectedRange(),e=Ra(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),Is(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${jr}:bottom`,name(){return this.getTranslatedPhrase(qE)},callback(){const t=this.getSelectedRange(),e=Ra(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),Is(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Rp="clear_column";function RZ(){return{key:Rp,name(){return this.getTranslatedPhrase(ME)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const Od="col_left";function EZ(){return{key:Od,name(){return this.getTranslatedPhrase(SE)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const xd="col_right";function TZ(){return{key:xd,name(){return this.getTranslatedPhrase(bE)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Hd="make_read_only";function _Z(){return{key:Hd,checkable:!0,ariaChecked(){return xg(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(tm)},name(){let t=this.getTranslatedPhrase(tm);return xg(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=PL(t)),t},callback(){const t=this.getSelectedRange(),e=xg(t,(n,r)=>this.getCellMeta(n,r).readOnly);P(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Ep="redo";function MZ(){return{key:Ep,name(){return this.getTranslatedPhrase(_E)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Ad="remove_col";function IZ(){return{key:Ad,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(EE,e)},callback(){this.alter("remove_col",c3(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Tp="remove_row";function PZ(){return{key:Tp,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(RE,e)},callback(){this.alter("remove_row",h3(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const _p="row_above";function OZ(){return{key:_p,name(){return this.getTranslatedPhrase(CE)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const Mp="row_below";function xZ(){return{key:Mp,name(){return this.getTranslatedPhrase(yE)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Jh="no_items";function HZ(){return{key:Jh,name(){return this.getTranslatedPhrase(vE)},disabled:!0,isCommand:!1}}const Ip="undo";function AZ(){return{key:Ip,name(){return this.getTranslatedPhrase(TE)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const NZ=[_p,Mp,Od,xd,Rp,Tp,Ad,Ip,Ep,Hd,jr,He,Jh],DZ={[He]:SZ,[Jh]:HZ,[_p]:OZ,[Mp]:xZ,[Od]:EZ,[xd]:TZ,[Rp]:RZ,[Tp]:PZ,[Ad]:IZ,[Ip]:AZ,[Ep]:MZ,[Hd]:_Z,[jr]:bZ};function OL(){const t={};return Ne(DZ,(e,n)=>{t[n]=e()}),t}function kZ(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase($E):this.getTranslatedPhrase(LE)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function LZ(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(FE)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function $Z(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(VE);return xg(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Hg))?PL(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Hg);t.updateCommentMeta(n,r,{[Hg]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function FZ(t,e){xL(t,e),e.add(t)}function zl(t,e,n){xL(t,e),e.set(t,n)}function xL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VZ(t,e,n){return(e=WZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WZ(t){var e=BZ(t,"string");return typeof e=="symbol"?e:e+""}function BZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ws(t,e,n){return t.set(Rr(t,e),n),n}function xe(t,e){return t.get(Rr(t,e))}function Rr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const mm="comments",jZ=60,Vo="comment",mh="value",HL="style",Hg="readOnly",Fc=mm,Ob=`plugin:${mm}`;var ut=new WeakMap,Ji=new WeakMap,Pp=new WeakMap,Ag=new WeakMap,xb=new WeakMap,pm=new WeakMap,$r=new WeakSet;class UZ extends Ke{constructor(){super(...arguments),FZ(this,$r),VZ(this,"range",{}),zl(this,ut,null),zl(this,Ji,null),zl(this,Pp,!1),zl(this,Ag,!1),zl(this,xb,null),zl(this,pm,"")}static get PLUGIN_KEY(){return mm}static get PLUGIN_PRIORITY(){return jZ}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[mm]}enablePlugin(){var e=this;this.enabled||(xe(ut,this)||(Ws(ut,this,new Za(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),xe(ut,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rr($r,e,QZ).call(e,...r)}),this.hot.addHook("afterSetTheme",(n,r)=>{r||this.hide()})),xe(Ji,this)||Ws(Ji,this,new IL(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>Rr($r,this,KZ).call(this,n,a)),this.addHook("afterScroll",()=>Rr($r,this,JZ).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Rr($r,this,MH).call(this,n)),this.addHook("beforeCompositionStart",n=>Rr($r,this,MH).call(this,n)),xe(Ji,this).addLocalHook("hide",()=>this.hide()),xe(Ji,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){xe(Ji,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(Ob);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();Ws(Ag,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(Ob),this.hot._registerTimeout(()=>{Ws(Ag,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:Fc}),r.addShortcut({keys:[["Escape"]],callback:()=>{xe(ut,this).setValue(xe(pm,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>xe(ut,this).isVisible()&&xe(ut,this).isFocused(),group:Fc}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>xe(ut,this).isVisible()&&xe(ut,this).isFocused(),group:Fc}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{xe(ut,this).setValue(xe(ut,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:Fc})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Fc)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Rr($r,this,GZ).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Rr($r,this,zZ).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Rr($r,this,qZ).call(this)),this.eventManager.addEventListener(n,"focus",()=>Rr($r,this,ZZ).call(this)),this.eventManager.addEventListener(n,"blur",()=>Rr($r,this,XZ).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>Rr($r,this,YZ).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=ol(e.target,"TD","TBODY");return!!(n&&Ce(n,"htCommentCell")&&ol(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=xe(ut,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[mh]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Vo),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,mh)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,mh)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return xe(Ji,this).cancelHiding(),xe(ut,this).setValue((e=i[Vo]?i[Vo][mh]:null)!==null&&e!==void 0?e:""),xe(ut,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){xe(ut,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!xe(ut,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;xe(ut,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,m=d.getCell({row:s,col:a},!0),v=this.getCommentMeta(i,o,HL);v?xe(ut,this).setSize(v.width,v.height):xe(ut,this).resetSize();const S=c?0:f.getColumnWidth(a),R=l&&!u?en(m):0,{left:w,top:_,width:O,height:L}=m.getBoundingClientRect(),{width:M,height:x}=xe(ut,this).getSize(),{innerWidth:z,innerHeight:q}=this.hot.rootWindow,A=this.hot.rootDocument.documentElement,Z=Cn(this.hot.rootDocument),X=iD(this.hot.rootWindow)?Z:0,oe=oD(this.hot.rootWindow)?Z:0;let ee=w+h.scrollX+S,ae=_+h.scrollY+R;this.hot.isRtl()&&(ee-=M+S),this.hot.isLtr()&&w+O+M>z-X?ee=w+h.scrollX-M-1:this.hot.isRtl()&&ee<-(A.scrollWidth-A.clientWidth)&&(ee=w+h.scrollX+S+1),_+x>q-oe&&(ae-=x-L+1),xe(ut,this).setPosition(ee,ae),xe(ut,this).setReadOnlyState(this.getCommentMeta(i,o,Hg)),xe(ut,this).observeSize()}focusEditor(){xe(ut,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[Vo];let o;i?(o=qn(i),rp(o,r)):o=r,this.hot.setCellMeta(e,n,Vo,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[Vo])return i[Vo][r]}addToContextMenu(e){e.items.push({name:He},kZ(this),LZ(this),$Z(this))}getEditorInputElement(){return xe(ut,this).getInputElement()}destroy(){var e,n;(e=xe(ut,this))===null||e===void 0||e.destroy(),(n=xe(Ji,this))===null||n===void 0||n.destroy(),super.destroy()}}function zZ(t){if(!(!this.hot.view||!this.hot.view._wt)&&!xe(Pp,this)&&!this.targetIsCommentTextArea(t)){const e=ol(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function YZ(t){t.stopPropagation()}function GZ(t){const{rootDocument:e}=this.hot;if(!(xe(Pp,this)||xe(ut,this).isFocused()||Ce(t.target,"wtBorder")||xe(xb,this)===t.target||!xe(ut,this)))if(Ws(xb,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));xe(Ji,this).show(n)}else nl(t.target,e)&&!this.targetIsCommentTextArea(t)&&xe(Ji,this).hide()}function qZ(){Ws(Pp,this,!1)}function KZ(t,e){e[Vo]&&e[Vo][mh]&&G(t,e.commentedCellClassName)}function XZ(){Ws(pm,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function ZZ(){Ws(pm,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(Ob)}function QZ(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[HL]:{width:t,height:e}})}function MH(t){xe(ut,this).isFocused()&&Hi(t)}function JZ(){xe(Ag,this)||this.hide()}function Ly(t,e,n){return(e=eQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eQ(t){var e=tQ(t,"string");return typeof e=="symbol"?e:e+""}function tQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AL{constructor(e){Ly(this,"hot",void 0),Ly(this,"commands",{}),Ly(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=nQ(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Jt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),P(u,c=>c.apply(this.hot,r))}}function nQ(t,e){let n;return P(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function $y(t,e,n){return(e=rQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rQ(t){var e=iQ(t,"string");return typeof e=="symbol"?e:e+""}function iQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NL{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;$y(this,"hot",void 0),$y(this,"predefinedItems",OL()),$y(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ne(e,(r,i)=>{let o="";r.name===He?(n[He]=r,o=He):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return oQ(e,this.defaultOrderPattern,this.predefinedItems)}}function oQ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Ae(i)?Ne(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),Ae(o)?tn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):P(i,(o,s)=>{let a=n[o];!a&&NZ.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Ae(o)&&tn(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function ps(t,e,n){return(e=sQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sQ(t){var e=aQ(t,"string");return typeof e=="symbol"?e:e+""}function aQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lQ{constructor(e,n){ps(this,"top",void 0),ps(this,"topRelative",void 0),ps(this,"left",void 0),ps(this,"leftRelative",void 0),ps(this,"scrollTop",void 0),ps(this,"scrollLeft",void 0),ps(this,"cellHeight",void 0),ps(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Vc(t,e,n){uQ(t,e),e.set(t,n)}function uQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Te(t,e){return t.get(DL(t,e))}function Of(t,e,n){return t.set(DL(t,e),n),n}function DL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $n=new WeakMap,tr=new WeakMap,nr=new WeakMap,Fy=new WeakMap,Yl=new WeakMap;class cQ{constructor(e){Vc(this,$n,void 0),Vc(this,tr,void 0),Vc(this,nr,void 0),Vc(this,Fy,!1),Vc(this,Yl,{above:0,below:0,left:0,right:0}),Of(Fy,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Te(Yl,this)[e]=n,this}setElement(e){return Of($n,this,e),this}setParentElement(e){return Of(tr,this,e),this}updatePosition(e){Of(nr,this,new lQ(e,Te($n,this).ownerDocument.defaultView)),Te(Fy,this)?(Te(nr,this).fitsBelow(Te($n,this))?this.setPositionBelowCursor():Te(nr,this).fitsAbove(Te($n,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Te($n,this).dir==="rtl"?Te(nr,this).fitsOnLeft(Te($n,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Te(nr,this).fitsOnRight(Te($n,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Te(Yl,this).above+Te(nr,this).top-Te($n,this).offsetHeight;if(Te(tr,this)){const r=Te(tr,this).ownerDocument.defaultView.getComputedStyle(Te(tr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Te(nr,this).top+Te(nr,this).cellHeight-Te($n,this).scrollHeight+i+o}Te($n,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Te(Yl,this).below+Te(nr,this).top+1;if(Te(tr,this)){const r=Te(tr,this).ownerDocument.defaultView.getComputedStyle(Te(tr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Te(nr,this).top-i-o-1}Te($n,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Te(nr,this).left;if(Te(tr,this)){const n=Te(tr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Te(tr,this).querySelector(".htCore")).borderRightWidth,10);e+=Te(nr,this).cellWidth+r}else e+=Te(Yl,this).right;Te($n,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Te(Yl,this).left+Te(nr,this).left-Te($n,this).offsetWidth;if(Te(tr,this)){const n=Te(tr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Te(tr,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}Te($n,this).style.left=`${e}px`}}function kL(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=Be(e,-1,v()-1);function a(R,w){const _=v()-1;return R<0&&(R=_),R>_&&(R=0),o.has(R)?-1:(o.add(R),r(R,!1)===!1&&(R=a(w===1?++R:--R,w)),R)}function l(R){R>-1&&R<v()&&r(R,!0)!==!1&&(s=R)}function u(R){R>-1&&R<v()&&(s=R)}function c(){return s}function h(){v()>0&&(o.clear(),s=a(0,1))}function d(){v()>0&&(o.clear(),s=a(v()-1,-1))}function f(){v()>0&&(o.clear(),s=a(++s,1))}function m(){v()>0&&(o.clear(),s=a(--s,-1))}function v(){return Math.max(n(),0)}function S(){o.clear(),s=e,i()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:f,toPreviousItem:m,getSize:v,clear:S}}function hQ(t){return Ve(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Hb(t){return Jt(t,"submenu")}function Ab(t){return new RegExp(He,"i").test(t.name)}function Ng(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function IH(t){return Jt(t,"disableSelection")}function dQ(t){return Ce(t,"htSeparator")}function fQ(t){return Ce(t,"htSubmenu")}function gQ(t){return Ce(t,"htDisabled")}function mQ(t){return Ce(t,"htSelectionDisabled")}function pQ(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function LL(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function wQ(t,e){let n=t.slice(0);return n.reverse(),n=LL(n,e),n.reverse(),n}function vQ(t){const e=[];return P(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function CQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:He,n=t.slice(0);return n=LL(n,e),n=wQ(n,e),n=vQ(n),n}function yQ(t){return t.checkable===!0}function SQ(t){return kL({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||dQ(r)||gQ(r)||mQ(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function bQ(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const $L="menu",PH=$L;function RQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(bQ(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:$L})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(m=>h.removeShortcutsByKeys(m))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${PH}:${u}`:PH}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function EQ(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(ts(n),G(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Ng(a,t)&&!IH(a)&&!Ab(a);ve(n,[...yQ(a)?[oz(),Du(c),zN(h)]:[iz(),Du(u)],...d?[Js(-1)]:[],...Ng(a,t)?[dz()]:[],...Hb(a)?[Xr(!1)]:[]])}n.className="",n.appendChild(l),Ab(a)?G(n,"htSeparator"):typeof a.renderer=="function"?(G(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Ju(l,u),Ng(a,t)?G(n,"htDisabled"):IH(a)?G(n,"htSelectionDisabled"):Hb(a)&&G(n,"htSubmenu")}}function Vy(t,e,n){TQ(t,e),e.set(t,n)}function TQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wi(t,e,n){return(e=_Q(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _Q(t){var e=MQ(t,"string");return typeof e=="symbol"?e:e+""}function MQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wy(t,e,n){return t.set(FL(t,e),n),n}function ws(t,e){return t.get(FL(t,e))}function FL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const OH=215;var Gl=new WeakMap,xf=new WeakMap,Hf=new WeakMap;class ic{get tableBorderWidth(){return ws(Hf,this)===void 0&&this.hotMenu&&Wy(Hf,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),ws(Hf,this)}constructor(e,n){var r=this;Wi(this,"hot",void 0),Wi(this,"options",void 0),Wi(this,"eventManager",new Pi(this)),Wi(this,"container",void 0),Wi(this,"positioner",void 0),Wi(this,"hotMenu",null),Wi(this,"hotSubMenus",{}),Wi(this,"parentMenu",void 0),Wi(this,"menuItems",null),Wi(this,"origOutsideClickDeselects",null),Vy(this,Gl,void 0),Vy(this,xf,void 0),Vy(this,Hf,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:OH,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new cQ(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{this.options.container!==this.hot.rootPortalElement&&(pe(this.options.container,/ht-theme-.*/g),G(this.options.container,i)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=ku(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return ws(Gl,this)}getKeyboardShortcutsCtrl(){return ws(xf,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=sp(a=>this.openSubMenu(a),300),n=this.options.minWidth||OH;let r=!1,i=il(this.menuItems,a=>(a.key===Jh&&(r=!0),pQ(a,this.hot)));if(i.length<1&&!r)i.push(OL()[Jh]);else if(i.length===0)return;i=CQ(i,He);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return le(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:EQ(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?ws(Gl,this).setCurrentPage(l.row):ws(Gl,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),ob()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!ob()||!al(a))&&o&&this.hasSelectedItem()&&(lo()||KN()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),Wy(Gl,this,SQ(this.hotMenu)),Wy(xf,this,RQ(this)),ws(xf,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(ws(Gl,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);ve(r,[Xr(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!fQ(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new ic(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&ve(n,[Xr(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&ve(i,[Xr(!1)])}}closeAllSubMenus(){P(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?hQ(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||Ab(e)||Ng(e,this.hot)||Hb(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=pr(n,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?en(this.hotMenu.getCell(u,0)):0;return a+(l.name===He?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),r.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(it(r)&&(r=r.call(this.hot),r===null||Mt(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),G(i,`htMenu handsontable ${this.options.className}`),r&&G(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&ve(this.hotMenu.rootElement,[rz(),Js(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!nl(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!nl(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ce(e.target,"htCore")&&nl(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}ct(ic,bn);function IQ(t,e){PQ(t,e),e.add(t)}function PQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function By(t,e,n){return(e=OQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OQ(t){var e=xQ(t,"string");return typeof e=="symbol"?e:e+""}function xQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Af(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ph="contextMenu",HQ=70,xH=ph;ne.getSingleton().register("afterContextMenuDefaultOptions");ne.getSingleton().register("beforeContextMenuShow");ne.getSingleton().register("afterContextMenuShow");ne.getSingleton().register("afterContextMenuHide");ne.getSingleton().register("afterContextMenuExecute");var Wc=new WeakSet;class Op extends Ke{constructor(){super(...arguments),IQ(this,Wc),By(this,"commandExecutor",new AL(this.hot)),By(this,"itemsFactory",null),By(this,"menu",null)}static get PLUGIN_KEY(){return ph}static get PLUGIN_PRIORITY(){return HQ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[_p,Mp,He,Od,xd,He,Tp,Ad,He,Ip,Ep,He,Hd,He,jr]}isEnabled(){return!!this.hot.getSettings()[ph]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[ph];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new ic(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>Af(Wc,this,NQ).call(this)),this.menu.addLocalHook("afterOpen",()=>Af(Wc,this,DQ).call(this)),this.menu.addLocalHook("afterClose",()=>Af(Wc,this,kQ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>Af(Wc,this,AQ).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=bp(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:xH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(xH)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;Ne(r,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new NL(this.hot,Op.DEFAULT_ITEMS);const e=this.hot.getSettings()[ph],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),P(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function AQ(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),Ce(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(Ce(o,"current")&&Ce(o,"wtBorder"))))return;const s=bp(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function NQ(){this.hot.runHooks("beforeContextMenuShow",this)}function DQ(){this.hot.runHooks("afterContextMenuShow",this)}function kQ(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Op.SEPARATOR={name:He};function LQ(t){return{key:"copy",name(){return this.getTranslatedPhrase(IE)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function $Q(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?Be(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(xE,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function FQ(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?Be(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(OE,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function VQ(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?Be(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(PE,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function WQ(t){return{key:"cut",name(){return this.getTranslatedPhrase(HE)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class BQ{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class jQ{constructor(){this.clipboardData=new BQ}preventDefault(){}composedPath(){return[]}}function UQ(t,e){VL(t,e),e.add(t)}function ql(t,e,n){VL(t,e),e.set(t,n)}function VL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wn(t,e){return t.get(Eu(t,e))}function Kl(t,e,n){return t.set(Eu(t,e),n),n}function Eu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vs=new WeakMap,jy=new WeakMap,Bc=new WeakMap,Nb=new WeakMap,Db=new WeakMap,jc=new WeakMap,Uc=new WeakSet;class zQ{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;UQ(this,Uc),ql(this,vs,void 0),ql(this,jy,void 0),ql(this,Bc,void 0),ql(this,Nb,void 0),ql(this,Db,void 0),ql(this,jc,void 0),Kl(jy,this,n),Kl(Bc,this,r),Kl(Nb,this,i),Kl(Db,this,o),Kl(jc,this,s)}setSelectedRange(e){Kl(vs,this,e)}getCellsRange(){if(Wn(jy,this).call(this)===0||Wn(Bc,this).call(this)===0)return null;const{row:e,col:n}=Wn(vs,this).getTopStartCorner(),{row:r,col:i}=Wn(vs,this).getBottomEndCorner(),o=Eu(Uc,this,YQ).call(this,e,r),s=Eu(Uc,this,Uy).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Wn(Bc,this).call(this)===0||Wn(jc,this).call(this)===0)return null;const{col:e}=Wn(vs,this).getTopStartCorner(),{col:n}=Wn(vs,this).getBottomEndCorner(),r=Eu(Uc,this,Uy).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(Wn(Bc,this).call(this)===0||Wn(jc,this).call(this)===0)return null;const{col:e}=Wn(vs,this).getTopStartCorner(),{col:n}=Wn(vs,this).getBottomEndCorner(),r=Eu(Uc,this,Uy).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-Wn(jc,this).call(this),startCol:e,endRow:-1,endCol:r}}}function Uy(t,e){return Math.min(e,Math.max(t+Wn(Db,this).call(this)-1,t))}function YQ(t,e){return Math.min(e,Math.max(t+Wn(Nb,this).call(this)-1,t))}function WL(t){const e=[],n=[];return P(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);he(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);he(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function GQ(t,e){BL(t,e),e.add(t)}function Cs(t,e,n){BL(t,e),e.set(t,n)}function BL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zc(t,e,n){return(e=qQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qQ(t){var e=KQ(t,"string");return typeof e=="symbol"?e:e+""}function KQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lr(t,e){return t.get(cr(t,e))}function mi(t,e,n){return t.set(cr(t,e),n),n}function cr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("afterCopyLimit");ne.getSingleton().register("modifyCopyableRange");ne.getSingleton().register("beforeCut");ne.getSingleton().register("afterCut");ne.getSingleton().register("beforePaste");ne.getSingleton().register("afterPaste");ne.getSingleton().register("beforeCopy");ne.getSingleton().register("afterCopy");const zy="copyPaste",XQ=80,ZQ=["fragmentSelection"],HH=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var kb=new WeakMap,Lb=new WeakMap,$b=new WeakMap,Xl=new WeakMap,Nf=new WeakMap,Df=new WeakMap,Zl=new WeakMap,wm=new WeakMap,Tr=new WeakSet;class QQ extends Ke{constructor(){super(...arguments),GQ(this,Tr),zc(this,"columnsLimit",1/0),zc(this,"rowsLimit",1/0),zc(this,"pasteMode","overwrite"),zc(this,"uiContainer",this.hot.rootDocument.body),Cs(this,kb,!1),Cs(this,Lb,!1),Cs(this,$b,!1),Cs(this,Xl,"cells-only"),Cs(this,Nf,!1),Cs(this,Df,!1),Cs(this,Zl,new zQ({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Cs(this,wm,!1),zc(this,"copyableRanges",[])}static get PLUGIN_KEY(){return zy}static get SETTING_KEYS(){return[zy,...ZQ]}static get PLUGIN_PRIORITY(){return XQ}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[zy]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),mi(kb,this,this.getSetting("copyColumnHeaders")),mi(Lb,this,this.getSetting("copyColumnGroupHeaders")),mi($b,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>cr(Tr,this,tJ).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return cr(Tr,r,nJ).call(r,...o)}),this.addHook("afterSelectionEnd",()=>cr(Tr,this,rJ).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),Yh()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return cr(Tr,r,iJ).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return cr(Tr,r,oJ).call(r,...o)}),this.addHook("afterSelection",()=>cr(Tr,this,sJ).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";mi(Xl,this,e),mi(Nf,this,!0),cr(Tr,this,AH).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){mi(Df,this,!0),cr(Tr,this,AH).call(this,"cut")}getRangedCopyableData(e){return Rh(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=WL(e);return P(r,o=>{const s=[];P(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new jQ;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}lr(Zl,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);lr(Xl,this)==="column-headers-only"?n.set("headers",lr(Zl,this).getMostBottomColumnHeadersRange()):(lr(Xl,this)==="with-column-headers"?n.set("headers",lr(Zl,this).getMostBottomColumnHeadersRange()):lr(Xl,this)==="with-column-group-headers"&&n.set("headers",lr(Zl,this).getAllColumnHeadersRange()),n.set("cells",lr(Zl,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:m,visualRow:v}=this.hot.getCellMeta(c,a);if(c=v+1,m===!0)continue;d=v,h=a;const S=[],R=o.length%r;for(;S.length<i||h<=u;){const{skipColumnOnPaste:w,visualCol:_}=this.hot.getCellMeta(s,h);if(h=_+1,w===!0)continue;f=_;const O=S.length%i;S.push(e[R][O])}o.push(S)}return mi(wm,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!lr(Nf,this)||this.isEditorOpened()||Jo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!_g(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),mi(Nf,this,!1);const o=this.getRangedData(this.copyableRanges),s=cr(Tr,this,JQ).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=Rh(o);if(e&&e.clipboardData){const u=pO(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[HH,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}mi(Xl,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!lr(Df,this)||this.isEditorOpened()||Jo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!_g(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),mi(Df,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=Rh(o);if(e&&e.clipboardData){const l=pO(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[HH,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Jo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!_g(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=LR(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=kY(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=p3(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function AH(t){if(Yh()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&Uz(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function JQ(t){const{rows:e}=WL(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function eJ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&lD(r)}}}function jL(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&uD(r)}}}function tJ(t){t.items.push({name:"---------"},LQ(this)),lr(kb,this)&&t.items.push(VQ(this)),lr(Lb,this)&&t.items.push(FQ(this)),lr($b,this)&&t.items.push($Q(this)),t.items.push(WQ(this))}function nJ(t,e,n,r,i){lr(wm,this)&&(i.value=!0),mi(wm,this,!1)}function rJ(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function iJ(){cr(Tr,this,jL).call(this)}function oJ(){cr(Tr,this,eJ).call(this)}function sJ(){cr(Tr,this,jL).call(this)}function UL(t,e){return`border_row${t}col${e}`}function wh(){return{width:1,color:"#000"}}function Go(){return{hide:!0}}function aJ(){return{width:1,color:"#000",cornerVisible:!1}}function Yy(t){if(le(t.start)||le(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(le(t.end)||le(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Yc(t){return le(t.start)&&(t.left=t.start),le(t.end)&&(t.right=t.end),t}function Gy(t,e){return{id:UL(t,e),border:aJ(),row:t,col:e,top:Go(),bottom:Go(),start:Go(),end:Go()}}function lJ(t,e){return Jt(e,"border")&&e.border&&(t.border=e.border),Jt(e,"top")&&le(e.top)&&(e.top?(Ae(e.top)||(e.top=wh()),t.top=e.top):(e.top=Go(),t.top=e.top)),Jt(e,"bottom")&&le(e.bottom)&&(e.bottom?(Ae(e.bottom)||(e.bottom=wh()),t.bottom=e.bottom):(e.bottom=Go(),t.bottom=e.bottom)),Jt(e,"start")&&le(e.start)&&(e.start?(Ae(e.start)||(e.start=wh()),t.start=e.start):(e.start=Go(),t.start=e.start)),Jt(e,"end")&&le(e.end)&&(e.end?(Ae(e.end)||(e.end=wh()),t.end=e.end):(e.end=Go(),t.end=e.end)),t}function rs(t,e){let n=!1;return P(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!Jt(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function xp(t){return`<span class="selected">â</span>${t}`}function uJ(t){return t.some(e=>le(e.left)||le(e.right))}function cJ(t){return t.some(e=>le(e.start)||le(e.end))}const hJ=new Map([["left","start"],["right","end"]]);function dJ(t){var e;return(e=hJ.get(t))!==null&&e!==void 0?e:t}function fJ(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(QE);return rs(this,"bottom")&&(e=xp(e)),e},callback(e,n){const r=rs(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function gJ(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(JE);return rs(this,e)&&(n=xp(n)),n},callback(n,r){const i=rs(this,e);t.prepareBorder(r,e,i)}}}function mJ(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(e0)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!rs(this)}}}function pJ(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(ZE);return rs(this,e)&&(n=xp(n)),n},callback(n,r){const i=rs(this,e);t.prepareBorder(r,e,i)}}}function wJ(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(XE);return rs(this,"top")&&(e=xp(e)),e},callback(e,n){const r=rs(this,"top");t.prepareBorder(n,"top",r)}}}function vJ(t,e){CJ(t,e),e.add(t)}function CJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yJ(t,e,n){return(e=SJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SJ(t){var e=bJ(t,"string");return typeof e=="symbol"?e:e+""}function bJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function NH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Dg="customBorders",RJ=90;var qy=new WeakSet;class EJ extends Ke{constructor(){super(...arguments),vJ(this,qy),yJ(this,"savedBorders",[])}static get PLUGIN_KEY(){return Dg}static get PLUGIN_PRIORITY(){return RJ}isEnabled(){return!!this.hot.getSettings()[Dg]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>NH(qy,this,TJ).call(this,e)),this.addHook("init",()=>NH(qy,this,_J).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Yy(n));const o=Fu(e),s=Kh(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});P(e,a=>{s(a).forAll((l,u)=>{P(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,dJ(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Fu(e),r=Kh(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return P(e,o=>{r(o).forAll((s,a)=>{P(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(Yc(l))})})}),i}clearBorders(e){e?this.setBorders(e):(P(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Gy(e,n);r&&(a=lJ(a,r),P(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Yc(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);he(e.from.row,r,o=>{he(e.from.col,i,s=>{const a=Gy(o,s);let l=0;o===e.from.row&&Jt(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&Jt(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&Jt(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&Jt(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",Yc(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=UL(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Gy(e,n):o=Yy(o),i?(o[r]=Go(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Yc(o)))):(o[r]=wh(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Yc(o)))}prepareBorder(e,n,r){P(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":he(o.col,s.col,a=>{he(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":he(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":he(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":he(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":he(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){P(e,n=>{const r=Yy(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return pr([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ve(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){P(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){P(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ve(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):P(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return P(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return P(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):P(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);P(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[Dg];if(Array.isArray(e)){const n=qn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=uJ(e),r=cJ(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function TJ(t){this.hot.getSettings()[Dg]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(KE)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[wJ(this),pJ(this),fJ(this),gJ(this),mJ(this)]}})}function _J(){this.changeBorderSettings()}function MJ(t,e){IJ(t,e),e.add(t)}function IJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ky(t,e,n){return(e=PJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PJ(t){var e=OJ(t,"string");return typeof e=="symbol"?e:e+""}function OJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const kH="dragToScroll",xJ=100;var Xy=new WeakSet;class HJ extends Ke{constructor(){super(...arguments),MJ(this,Xy),Ky(this,"boundaries",null),Ky(this,"callback",null),Ky(this,"listening",!1)}static get PLUGIN_KEY(){return kH}static get PLUGIN_PRIORITY(){return xJ}isEnabled(){return!!this.hot.getSettings()[kH]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>DH(Xy,this,LH).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>DH(Xy,this,LH).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=ku(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function LH(t){if(al(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function AJ(t,e){zL(t,e),e.add(t)}function NJ(t,e,n){zL(t,e),e.set(t,n)}function zL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zy(t,e,n){return(e=DJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DJ(t){var e=kJ(t,"string");return typeof e=="symbol"?e:e+""}function kJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function LJ(t,e){return t.get(Ur(t,e))}function YL(t,e,n){return t.set(Ur(t,e),n),n}function Ur(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("afterDropdownMenuDefaultOptions");ne.getSingleton().register("beforeDropdownMenuShow");ne.getSingleton().register("afterDropdownMenuShow");ne.getSingleton().register("afterDropdownMenuHide");ne.getSingleton().register("afterDropdownMenuExecute");const kg="dropdownMenu",$J=230,ed="changeType",Qy=kg;var Hp=new WeakMap,vi=new WeakSet;class Ap extends Ke{static get PLUGIN_KEY(){return kg}static get PLUGIN_PRIORITY(){return $J}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Od,xd,He,Ad,He,Rp,He,Hd,He,jr]}constructor(e){super(e),AJ(this,vi),Zy(this,"commandExecutor",new AL(this.hot)),Zy(this,"itemsFactory",null),Zy(this,"menu",null),NJ(this,Hp,!1),this.hot.addHook("afterGetColHeader",(n,r)=>Ur(vi,this,VJ).call(this,n,r))}isEnabled(){return this.hot.getSettings()[kg]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new NL(this.hot,Ap.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ur(vi,e,YJ).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ur(vi,e,zJ).call(e,...o)});const n=this.hot.getSettings()[kg],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new ic(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>Ur(vi,this,WJ).call(this)),this.menu.addLocalHook("afterOpen",()=>Ur(vi,this,BJ).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>Ur(vi,this,jJ).call(this,o)),this.menu.addLocalHook("afterClose",()=>Ur(vi,this,UJ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),P(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=bp(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${ed}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Qy},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Qy}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Qy)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Ur(vi,this,FJ).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ne(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function GL(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function FJ(t){if(Ce(t.target,ed)){const e=bp(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),YL(Hp,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function VJ(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${ed}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=ed,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(ve(s,[yl(),Du(" ")]),ve(e,[BN("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function WJ(){this.hot.runHooks("beforeDropdownMenuShow",this)}function BJ(){this.hot.runHooks("afterDropdownMenuShow",this),Ur(vi,this,GL).call(this,this.menu)}function jJ(t){Ur(vi,this,GL).call(this,t)}function UJ(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function zJ(t){return LJ(Hp,this)?null:t}function YJ(t){Ce(t.target,ed)&&YL(Hp,this,!0)}Ap.SEPARATOR={name:He};function $H(t,e,n){return(e=GJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GJ(t){var e=qJ(t,"string");return typeof e=="symbol"?e:e+""}function qJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KJ{constructor(e){$H(this,"hot",void 0),$H(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return he(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(he(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();he(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();he(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function FH(t,e,n){return(e=XJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XJ(t){var e=ZJ(t,"string");return typeof e=="symbol"?e:e+""}function ZJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fT{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){FH(this,"dataProvider",void 0),FH(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=ho(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=tn(ho(fT.DEFAULT_OPTIONS),n),n=tn(n,e),n.filename=$N(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function QJ(t,e){JJ(t,e),e.add(t)}function JJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const qL="\r",eee='"',tee=`
`,nee="=",ree="+",iee="-",oee="@",see="	";var Jy=new WeakSet;class aee extends fT{constructor(){super(...arguments),QJ(this,Jy)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=Ve(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),P(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=It(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=VH(Jy,this,uee).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=VH(Jy,this,lee).call(this,i)),(n||i.indexOf(qL)>=0||i.indexOf(eee)>=0||i.indexOf(tee)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function lee(t){return t.startsWith(nee)||t.startsWith(ree)||t.startsWith(iee)||t.startsWith(oee)||t.startsWith(see)||t.startsWith(qL)?`'${t}`:t}function uee(t,e){return e.test(t)?`'${t}`:t}const cee="csv",Fb={[cee]:aee};function hee(t,e,n){return typeof Fb[t]=="function"?new Fb[t](e,n):null}const dee="exportFile",fee=240;class gee extends Ke{static get PLUGIN_KEY(){return dee}static get PLUGIN_PRIORITY(){return fee}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Fb[e])throw new Error(`Export format type "${e}" is not supported.`);return hee(e,new KJ(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Ql(t,e,n){return(e=mee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mee(t){var e=pee(t,"string");return typeof e=="symbol"?e:e+""}function pee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nd{constructor(e,n){let{id:r,stateless:i=!0}=n;Ql(this,"hot",void 0),Ql(this,"id",void 0),Ql(this,"elements",[]),Ql(this,"hidden",!1),Ql(this,"stateId",""),Ql(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new dp)}getElements(){return this.elements}reset(){P(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),P(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}ct(Nd,bn);const td={};function qs(t,e){if(!td[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=td[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function Qa(t){if(!td[t])throw Error(`Filter condition "${t}" does not exist.`);return td[t].descriptor}function Kt(t,e,n){n.key=t,td[t]={condition:e,descriptor:n}}const vn="none";function wee(){return!0}Kt(vn,wee,{name:fp,inputsCount:0,showOperators:!1});const Mh="empty";function vee(t){return Wt(t.value)}Kt(Mh,vee,{name:a0,inputsCount:0,showOperators:!0});const Lg="not_empty";function Cee(t,e){return!qs(Mh,e)(t)}Kt(Lg,Cee,{name:l0,inputsCount:0,showOperators:!0});const Ih="eq";function yee(t,e){let[n]=e;return It(t.value).toLocaleLowerCase(t.meta.locale)===It(n)}Kt(Ih,yee,{name:u0,inputsCount:1,showOperators:!0});const $g="neq";function See(t,e){return!qs(Ih,e)(t)}Kt($g,See,{name:c0,inputsCount:1,showOperators:!0});const KL="gt";function bee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}Kt(KL,bee,{name:m0,inputsCount:1,showOperators:!0});const XL="gte";function Ree(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}Kt(XL,Ree,{name:p0,inputsCount:1,showOperators:!0});const ZL="lt";function Eee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}Kt(ZL,Eee,{name:w0,inputsCount:1,showOperators:!0});const QL="lte";function Tee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}Kt(QL,Tee,{name:v0,inputsCount:1,showOperators:!0});const gT="date_after";function _ee(t,e){let[n]=e;const r=K(t.value,t.meta.dateFormat),i=K(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}Kt(gT,_ee,{name:S0,inputsCount:1,showOperators:!0});const mT="date_before";function Mee(t,e){let[n]=e;const r=K(t.value,t.meta.dateFormat),i=K(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}Kt(mT,Mee,{name:b0,inputsCount:1,showOperators:!0});const vm="between";function Iee(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=qs(mT,[o]),a=qs(gT,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}Kt(vm,Iee,{name:C0,inputsCount:2,showOperators:!0});const JL="not_between";function Pee(t,e){return!qs(vm,e)(t)}Kt(JL,Pee,{name:y0,inputsCount:2,showOperators:!0});const e$="begins_with";function Oee(t,e){let[n]=e;return It(t.value).toLocaleLowerCase(t.meta.locale).startsWith(It(n))}Kt(e$,Oee,{name:h0,inputsCount:1,showOperators:!0});const t$="ends_with";function xee(t,e){let[n]=e;return It(t.value).toLocaleLowerCase(t.meta.locale).endsWith(It(n))}Kt(t$,xee,{name:d0,inputsCount:1,showOperators:!0});const pT="contains";function Hee(t,e){let[n]=e;return It(t.value).toLocaleLowerCase(t.meta.locale).indexOf(It(n))>=0}Kt(pT,Hee,{name:f0,inputsCount:1,showOperators:!0});const n$="not_contains";function Aee(t,e){return!qs(pT,e)(t)}Kt(n$,Aee,{name:g0,inputsCount:1,showOperators:!0});const r$="date_tomorrow";function Nee(t){const e=K(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(K().subtract(-1,"days").startOf("day"),"d"):!1}Kt(r$,Nee,{name:E0,inputsCount:0});const i$="date_today";function Dee(t){const e=K(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(K().startOf("day"),"d"):!1}Kt(i$,Dee,{name:R0,inputsCount:0});const o$="date_yesterday";function kee(t){const e=K(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(K().subtract(1,"days").startOf("day"),"d"):!1}Kt(o$,kee,{name:T0,inputsCount:0});Mz();function Lee(t,e){let n=t;return n===""&&(n=`(${e})`),n}function Dd(t){const e=new Set(t);return function(n){return e.has(n)}}function wT(t){return t??""}function Vb(t){return Array.from(new Set(t)).map(e=>wT(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function WH(t,e,n,r){const i=[],o=t===e;let s;return o||(s=Dd(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:Lee(a,n)};r&&r(u),i.push(u)}),i}const Ja="by_value";function $ee(t,e){let[n]=e;return n(t.value)}Kt(Ja,$ee,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Dd(e)]},showOperators:!1});const nd={};function Fee(t){if(!nd[t])throw Error(`Operation with id "${t}" does not exist.`);const e=nd[t].func;return function(n,r){return e(n,r)}}function Vee(t){return nd[t].name}function vT(t,e,n){nd[t]={name:e,func:n}}const Ys="conjunction",Wee=I0;function Bee(t,e){return t.every(n=>n.func(e))}vT(Ys,Wee,Bee);const Cm="disjunction",jee=gp;function Uee(t,e){return t.some(n=>n.func(e))}vT(Cm,jee,Uee);const CT="disjunctionWithExtraCondition",zee=gp;function Yee(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}vT(CT,zee,Yee);const Gee="numeric",s$="text",qee="date",BH={[Gee]:[vn,He,Mh,Lg,He,Ih,$g,He,KL,XL,ZL,QL,vm,JL],[s$]:[vn,He,Mh,Lg,He,Ih,$g,He,e$,t$,He,pT,n$],[qee]:[vn,He,Mh,Lg,He,Ih,$g,He,mT,gT,vm,He,r$,i$,o$]};function Kee(t){const e=[];let n=t;return BH[n]||(n=s$),P(BH[n],r=>{let i;r===He?i={name:He}:i=ho(Qa(r)),e.push(i)}),e}function Gc(t,e,n){return(e=Xee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xee(t){var e=Zee(t,"string");return typeof e=="symbol"?e:e+""}function Zee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const eS="built",tS="building",jH=["click","input","keydown","keypress","keyup","focus","blur","change"];let Ti=class a${static get DEFAULTS(){return ho({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Gc(this,"hot",void 0),Gc(this,"eventManager",new Pi(this)),Gc(this,"options",void 0),Gc(this,"_element",void 0),Gc(this,"buildState",void 0),this.hot=e,this.options=tn(a$.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===tS?this._element:this.buildState===eS?(this.update(),this._element):(this.buildState=tS,this.build(),this.buildState=eS,this._element)}isBuilt(){return this.buildState===eS}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Kn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=tS),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&G(this._element,this.options.className),this.options.children.length)P(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Ne(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),P(jH,r=>e(n,r))}else P(jH,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};ct(Ti,bn);function Qee(t,e){l$(t,e),e.add(t)}function Jee(t,e,n){l$(t,e),e.set(t,n)}function l$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kf(t,e){return t.get(yT(t,e))}function ete(t,e,n){return t.set(yT(t,e),n),n}function yT(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Jl=new WeakMap,UH=new WeakSet;class Gs extends Ti{static get DEFAULTS(){return ho({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,tn(Gs.DEFAULTS,n)),Qee(this,UH),Jee(this,Jl,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>yT(UH,this,tte).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");ete(Jl,this,this._element.firstChild),G(this._element,"htUIInput"),G(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(kf(Jl,this).type=this.options.type,kf(Jl,this).placeholder=this.translateIfPossible(this.options.placeholder),kf(Jl,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&kf(Jl,this).focus()}}function tte(t){this.options.value=t.target.value}function nte(t,e){u$(t,e),e.add(t)}function qc(t,e,n){u$(t,e),e.set(t,n)}function u$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eu(t,e,n){return t.set(Ph(t,e),n),n}function Pt(t,e){return t.get(Ph(t,e))}function Ph(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var un=new WeakMap,Lf=new WeakMap,$f=new WeakMap,nS=new WeakMap,Ff=new WeakMap,Vf=new WeakSet;class rd extends Ti{static get DEFAULTS(){return ho({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,tn(rd.DEFAULTS,n)),nte(this,Vf),qc(this,un,null),qc(this,Lf,[]),qc(this,$f,void 0),qc(this,nS,void 0),qc(this,Ff,void 0),this.registerHooks()}getMenu(){return Pt(un,this)}registerHooks(){this.addLocalHook("click",()=>Ph(Vf,this,ote).call(this))}setItems(e){eu(Lf,this,this.translateNames(e)),Pt(un,this)&&Pt(un,this).setMenuItems(Pt(Lf,this))}translateNames(e){return P(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),eu(un,this,new ic(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Pt(un,this).setMenuItems(Pt(Lf,this));const e=new Ti(this.hot,{className:"htUISelectCaption"}),n=new Ti(this.hot,{className:"htUISelectDropdown"});eu($f,this,e),eu(nS,this,e.element),eu(Ff,this,n),this.hot.getSettings().ariaTags&&(ve(n.element,[yl()]),ve(this._element,[WN()])),P([e,n],r=>this._element.appendChild(r.element)),Pt(un,this).addLocalHook("select",r=>Ph(Vf,this,rte).call(this,r)),Pt(un,this).addLocalHook("afterClose",()=>Ph(Vf,this,ite).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Pt(un,this).hot.getTranslatedPhrase(fp),Pt(nS,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Pt(un,this)&&(Pt(un,this).open(),Pt(un,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Pt(un,this).getNavigator().toFirstItem(),Pt(un,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Pt(un,this)&&Pt(un,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Pt(un,this)&&(Pt(un,this).destroy(),eu(un,this,null)),Pt($f,this)&&Pt($f,this).destroy(),Pt(Ff,this)&&Pt(Ff,this).destroy(),super.destroy()}}function rte(t){t.name!==He&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function ite(){this.runLocalHooks("afterClose")}function ote(){this.openOptions()}function ste(t,e){ate(t,e),e.add(t)}function ate(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zH(t,e,n){return(e=lte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lte(t){var e=ute(t,"string");return typeof e=="symbol"?e:e+""}function ute(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rS=new WeakSet;class Wb extends Nd{constructor(e,n){super(e,{id:n.id,stateless:!1}),ste(this,rS),zH(this,"name",""),zH(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new rd(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Gs(this.hot,{placeholder:N0})),this.elements.push(new Gs(this.hot,{placeholder:D0})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>YH(rS,this,cte).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),P(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>YH(rS,this,hte).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=ho(e.command);n.name.startsWith(kt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),P(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Qa(vn),n=[];return P(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=Qa(e?e.name:vn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||P(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof rd)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Gs)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{G(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&G(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return G(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||P(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Qa(vn)];if(e!==null){const{visualIndex:r}=e;n=Kee(this.hot.getDataType(0,r,this.hot.countRows(),r))}P(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function cte(t){P(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function hte(t){Sd(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Hi(t))}function GH(t,e,n){dte(t,e),e.set(t,n)}function dte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kc(t,e){return t.get(c$(t,e))}function qH(t,e,n){return t.set(c$(t,e),n),n}function c$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var tu=new WeakMap,iS=new WeakMap;class ym extends Ti{static get DEFAULTS(){return ho({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,tn(ym.DEFAULTS,n)),GH(this,tu,void 0),GH(this,iS,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),qH(iS,this,e),qH(tu,this,this._element.firstChild),Kc(tu,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Kc(iS,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Kc(tu,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Kc(tu,this).checked=e)}focus(){this.isBuilt()&&Kc(tu,this).focus()}}function fte(t,e){gte(t,e),e.add(t)}function gte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mte(t,e,n){return(e=pte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pte(t){var e=wte(t,"string");return typeof e=="symbol"?e:e+""}function wte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vte(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const KH=0;var XH=new WeakSet;class Cte extends Nd{constructor(e,n){super(e,{id:n.id,stateless:!1}),fte(this,XH),mte(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(G(n.parentNode,"htFiltersMenuOperators"),P(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[Ys,Cm];P(e,n=>{const r=new ym(this.hot,{name:"operator",label:{htmlFor:n,textContent:Vee(n)},value:n,checked:n===e[KH],id:n});r.addLocalHook("change",i=>vte(XH,this,yte).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(tt`Radio button with index ${e} doesn't exist.`);P(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof ym&&n.isChecked());return e?e.getValue():Ys}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&P(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ys,n=arguments.length>1?arguments[1]:void 0,r=e;r===CT&&(r=Cm),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(KH)}}function yte(t){this.setState(t.target.value)}function Ste(t,e,n){bte(t,e),e.set(t,n)}function bte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oS(t,e){return t.get(h$(t,e))}function Rte(t,e,n){return t.set(h$(t,e),n),n}function h$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xc=new WeakMap;class id extends Ti{static get DEFAULTS(){return ho({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,tn(id.DEFAULTS,n)),Ste(this,Xc,void 0)}build(){super.build(),Rte(Xc,this,this._element.firstChild)}update(){this.isBuilt()&&(oS(Xc,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&oS(Xc,this).focus()}activate(){oS(Xc,this).click()}}function Ete(t,e){d$(t,e),e.add(t)}function nu(t,e,n){d$(t,e),e.set(t,n)}function d$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _e(t,e){return t.get(Tu(t,e))}function ci(t,e,n){return t.set(Tu(t,e),n),n}function Tu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ZH="multipleSelect.itemBox";var Ci=new WeakMap,Ut=new WeakMap,sS=new WeakMap,Oo=new WeakMap,ys=new WeakMap,Ss=new WeakMap,Zc=new WeakSet;class od extends Ti{static get DEFAULTS(){return ho({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,tn(od.DEFAULTS,n)),Ete(this,Zc),nu(this,Ci,[]),nu(this,Ut,void 0),nu(this,sS,void 0),nu(this,Oo,void 0),nu(this,ys,void 0),nu(this,Ss,void 0),ci(Oo,this,new Gs(this.hot,{placeholder:A0,className:"htUIMultipleSelectSearch"})),ci(ys,this,new id(this.hot,{textContent:P0,className:"htUISelectAll"})),ci(Ss,this,new id(this.hot,{textContent:O0,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return _e(Ut,this)}registerHooks(){_e(Oo,this).addLocalHook("keydown",e=>Tu(Zc,this,_te).call(this,e)),_e(Oo,this).addLocalHook("input",e=>Tu(Zc,this,Tte).call(this,e)),_e(ys,this).addLocalHook("click",e=>Tu(Zc,this,Mte).call(this,e)),_e(Ss,this).addLocalHook("click",e=>Tu(Zc,this,Ite).call(this,e))}setItems(e){var n;ci(Ci,this,e),(n=_e(Ut,this))===null||n===void 0||n.loadData(_e(Ci,this))}setLocale(e){ci(sS,this,e)}getLocale(){return _e(sS,this)}getItems(){return[..._e(Ci,this)]}getValue(){return Ote(_e(Ci,this))}getSearchInputElement(){return _e(Oo,this)}getSelectAllElement(){return _e(ys,this)}getClearAllElement(){return _e(Ss,this)}isSelectedAllValues(){return _e(Ci,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new Ti(this.hot,{className:"htUISelectionControls",children:[_e(ys,this),_e(Ss,this)]});this._element.appendChild(_e(Oo,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=_e(Ut,this))===null||s===void 0||s.destroy(),G(o,"htUIMultipleSelectHot"),ci(Ut,this,new this.hot.constructor(o,{data:_e(Ci,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,m)=>{u.title=m.instance.getDataAtRowProp(c,m.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{_e(Ut,this).listen()},modifyColWidth:u=>{const c=_e(Ut,this).container.scrollWidth-Cn(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),_e(Ut,this).init();const l=_e(Ut,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:ZH}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{_e(Ut,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:ZH})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&_e(Ut,this).listen()}reset(){_e(Oo,this).reset(),_e(ys,this).reset(),_e(Ss,this).reset()}update(){this.isBuilt()&&(_e(Ut,this).loadData(Pte(_e(Ci,this),this.options.value)),super.update())}destroy(){var e;(e=_e(Ut,this))===null||e===void 0||e.destroy(),_e(Oo,this).destroy(),_e(Ss,this).destroy(),_e(ys,this).destroy(),ci(Oo,this,null),ci(Ss,this,null),ci(ys,this,null),ci(Ut,this,null),ci(Ci,this,null),super.destroy()}}function Tte(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[..._e(Ci,this)]:n=_e(Ci,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),_e(Ut,this).loadData(n)}function _te(t){this.runLocalHooks("keydown",t,this),cD(Sd,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Hi(t),_e(Ut,this).listen(),_e(Ut,this).selectCell(0,0))}function Mte(t){const e=[];t.preventDefault(),_e(Ut,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(BD(n,r)[0])}),_e(Ut,this).setSourceDataAtCell(e)}function Ite(t){const e=[];t.preventDefault(),_e(Ut,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(BD(n,r)[0])}),_e(Ut,this).setSourceDataAtCell(e)}function Pte(t,e){const n=Dd(e);return t.map(r=>(r.checked=n(r.value),r))}function Ote(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function xte(t,e){Hte(t,e),e.add(t)}function Hte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ate(t,e,n){return(e=Nte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nte(t){var e=Dte(t,"string");return typeof e=="symbol"?e:e+""}function Dte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Qc=new WeakSet;class kte extends Nd{constructor(e,n){super(e,{id:n.id,stateless:!1}),xte(this,Qc),Ate(this,"name",""),this.name=n.name,this.elements.push(new od(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Wf(Qc,this,Lte).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Wf(Qc,this,$te).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Ja){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?vn:Ja},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=il(i,h=>h.name===Ja),u={},c=this.hot.getTranslatedPhrase(nm);if(l){const h=s(r,a),d=Ve(h,w=>w.value),f=new Map(h.map(w=>[w.value,this.hot.getCellMeta(w.meta.visualRow,w.meta.visualCol)])),m=Vb(d);o&&(l.args[0]=o);const v=[],S=WH(m,l.args[0],c,w=>{w.checked&&v.push(w.value),Wf(Qc,this,QH).call(this,w,f)}),R=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,R).locale,u.args=[v],u.command=Qa(Ja),u.itemsSnapshot=S}else u.args=[],u.command=Qa(vn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof od)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{G(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return G(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||P(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(nm),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=Vb(r),s=WH(o,o,e,l=>{Wf(Qc,this,QH).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ve(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:wT(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function Lte(t){Sd(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Hi(t))}function QH(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function $te(t,e){switch(e.type){case"numeric":return eL(t,e);default:return t}}var f$;function Fte(t,e){Vte(t,e),e.add(t)}function Vte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wte(t,e,n){return(e=Bte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bte(t){var e=jte(t,"string");return typeof e=="symbol"?e:e+""}function jte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ute(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var JH=new WeakSet;class sd extends Nd{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),Fte(this,JH),Wte(this,"name",""),this.name=n.name,this.elements.push(new Gs(this.hot,{type:"button",value:x0,className:"htUIButton htUIButtonOK",identifier:sd.BUTTON_OK})),this.elements.push(new Gs(this.hot,{type:"button",value:H0,className:"htUIButton htUIButtonCancel",identifier:sd.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){P(this.elements,e=>{e.addLocalHook("click",(n,r)=>Ute(JH,this,zte).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(G(n.parentNode,"htFiltersMenuActionBar"),P(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}f$=sd;function zte(t,e){e.options.identifier===f$.BUTTON_OK?this.accept():this.cancel()}function aS(t,e,n){return(e=Yte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yte(t){var e=Gte(t,"string");return typeof e=="symbol"?e:e+""}function Gte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const eA="ConditionCollection.filteringStates";class ST{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;aS(this,"hot",void 0),aS(this,"isMapRegistrable",void 0),aS(this,"filteringStates",new dp),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(eA,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i?.conditions)!==null&&r!==void 0?r:[],s=i?.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ys;return e.length?Fee(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ys,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(tt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Mt(nd[r]))throw new Error(tt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:qs(a,s)}]},i):u.push({name:a,args:s,func:qs(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(eA),this.filteringStates=null,this.clearLocalHooks()}}ct(ST,bn);function tA(t,e,n){return(e=qte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qte(t){var e=Kte(t,"string");return typeof e=="symbol"?e:e+""}function Kte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g${constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];tA(this,"conditionCollection",void 0),tA(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return P(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return P(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return P(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function Xte(t,e){Zte(t,e),e.add(t)}function Zte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ea(t,e,n){return(e=Qte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qte(t){var e=Jte(t,"string");return typeof e=="symbol"?e:e+""}function Jte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bf=new WeakSet;class m${constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Xte(this,Bf),Ea(this,"hot",void 0),Ea(this,"conditionCollection",void 0),Ea(this,"columnDataFactory",void 0),Ea(this,"changes",[]),Ea(this,"grouping",!1),Ea(this,"latestEditedColumnPosition",-1),Ea(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>lS(Bf,this,ene).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>lS(Bf,this,tne).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>lS(Bf,this,nne).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,P(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=zz(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new ST(r.hot,!1),m=[].concat(c,d);f.importAllConditions(m);const v=r.columnDataFactory(h);let S;f.isEmpty()?S=v:S=new g$(f,w=>r.columnDataFactory(w)).filter(),S=Ve(S,w=>w.meta.visualRow);const R=Dd(S);return f.destroy(),il(v,w=>R(w.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Ne(this,(e,n)=>{this[n]=null})}}function ene(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function tne(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function nne(){P(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}ct(m$,bn);function rne(t){return kL({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof od)return r;if(i.element&&!Lu(i.element))return!1;i.focus()}})}const Jc="filters";function ine(t,e){let n=-1,r;const i=rne(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(Jc),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof Ti&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(Jc),callback:()=>{h.isSubMenu()&&h.close(),d.listen(Jc)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:m=>{const v=r.getNavigator();v.getCurrentPage()>-1&&(n=v.getCurrentPage()),v.clear(),m.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:m=>{const v=e[i.getCurrentPage()];v instanceof rd&&(v.openOptions(),m.preventDefault()),v instanceof id&&(v.activate(),m.preventDefault()),v instanceof Ti||m.preventDefault()}}],Jc)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(Jc)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function one(t,e){p$(t,e),e.add(t)}function uS(t,e,n){p$(t,e),e.set(t,n)}function p$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eh(t,e,n){return(e=sne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sne(t){var e=ane(t,"string");return typeof e=="symbol"?e:e+""}function ane(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fg(t,e,n){return t.set(or(t,e),n),n}function zr(t,e){return t.get(or(t,e))}function or(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Bb="filters",lne=250,nA=Bb;var ko=new WeakMap,jb=new WeakMap,Ga=new WeakMap,wr=new WeakSet;class une extends Ke{static get PLUGIN_KEY(){return Bb}static get PLUGIN_PRIORITY(){return lne}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,one(this,wr),eh(this,"dropdownMenuPlugin",null),eh(this,"conditionCollection",null),eh(this,"conditionUpdateObserver",null),eh(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),eh(this,"filtersRowsMap",null),uS(this,ko,void 0),uS(this,jb,new WeakSet),uS(this,Ga,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return or(wr,n,pne).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[Bb]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Td),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootPortalElement,i=a=>(a.addLocalHook("accept",()=>or(wr,this,rA).call(this,"accept")),a.addLocalHook("cancel",()=>or(wr,this,rA).call(this,"cancel")),a.addLocalHook("change",l=>or(wr,this,mne).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(_0)}:`,s=()=>`${this.hot.getTranslatedPhrase(M0)}:`;if(!this.components.get("filter_by_condition")){const a=new Wb(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>or(wr,this,iA).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Cte(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new Wb(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>or(wr,this,iA).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new kte(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new sd(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new ST(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new m$(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>or(wr,this,wne).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return or(wr,e,gne).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>or(wr,this,fne).call(this)),this.addHook("afterDropdownMenuShow",()=>or(wr,this,hne).call(this)),this.addHook("afterDropdownMenuHide",()=>or(wr,this,dne).call(this)),this.addHook("afterChange",a=>or(wr,this,cne).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!zr(ko,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=zr(ko,this).getMenu(),c=u.getNavigator(),h=zr(ko,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];Fg(ko,this,ine(this.dropdownMenuPlugin.menu,a));const l=u=>{zr(ko,this).listen(),u.preventDefault(),Sd(u.keyCode,"TAB")&&(u.shiftKey?zr(ko,this).toPreviousItem():zr(ko,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:nA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(nA)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ys;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,zr(Ga,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ve(n.filter(),u=>u.meta.visualRow);const l=Dd(i);he(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),P(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),Fg(Ga,this,this.exportConditions())}else s!==!1&&!r?(Fg(Ga,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(zr(Ga,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return P(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m}=this.hot.getCellMeta(o,n),v=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m},value:wT(v)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=Vb(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Cm&&n.command.key!==vn&&r.command.key!==vn&&i.command.key!==vn?o=CT:i.command.key!==vn&&(n.command.key===vn||r.command.key===vn)&&(o=Ys),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new g$(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return P(i,s=>{P(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function cne(t){t&&P(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function hne(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function dne(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function fne(){const t=this.dropdownMenuPlugin.menu;zr(jb,this).has(t)||zr(ko,this).setMenu(t),zr(jb,this).add(t)}function gne(t){t.items.push({name:He}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function rA(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==vn&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==vn&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==vn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function mne(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===Wb&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function iA(){this.setListeningDropdownMenu()}function pne(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?G(e,"htFiltersActive"):pe(e,"htFiltersActive")}function wne(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&Fg(Ga,this,zr(Ga,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===Ja),s=n.filter(a=>a.name!==Ja);if(o.length>=2||s.length>=3)qe(tt`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const w$="internal-use-in-handsontable",Ub={licenseKey:w$,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function v$(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Hn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function C$(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function vne(t){var e;const n=t[Hn],r=C$(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=v$(t);return{...Ub,...r,...i}}function Cne(t){var e;const n=t[Hn],r=C$(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=v$(t);return{...r,...i}}function yne(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function Np(){const t="engine_relationship",e=ri(Hn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function bT(){const t="shared_engine_usage",e=ri(Hn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Sne(t){const e=t.getSettings(),n=e[Hn],r=n?.engine;if(n===!0||Mt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return bne((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Mt(r.hyperformula)){const o=Np(),s=bT().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:w$}),(r.getConfig().leapYear1900!==Ub.leapYear1900||VR(r.getConfig().nullDate,Ub.nullDate)===!1)&&qe(tt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function bne(t,e,n){const r=e[Hn],i=vne(e),o=Np(),s=bT();Rne(t,r.functions),Ene(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),Tne(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function oA(t){var e;const n=Np(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function sA(t,e){if(t){const n=Np(),r=n.get(t),i=bT(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Rne(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){qe(s.message)}})}function Ene(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){qe(r.message)}}}function Tne(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){qe(a.message)}}),t.resumeEvaluation())}function _ne(t,e){return(Mt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const y$="DD/MM/YYYY";function Mne(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Ine(t){return Mne(t)?t.substr(1):t}function Pne(t){return typeof t=="string"&&t.startsWith("=")}function RT(t,e){return typeof t=="string"&&e==="date"}function S$(t,e){return K(t,e,!0).isValid()}function b$(t,e){return K(t,e,!0).format(y$)}function One(t,e){return K(t,y$,!0).format(e)}function R$(t,e){const r=new Date(Date.UTC(0,0,t+-1));return K(r).format(e)}function xne(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function Hne(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function Ane(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function ET(t,e,n){const r=Hne(t,xne(t,e,n));return Ane(r)}function Ta(t,e,n){Nne(t,e),e.set(t,n)}function Nne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function St(t,e){return t.get(E$(t,e))}function bs(t,e,n){return t.set(E$(t,e),n),n}function E$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var th=new WeakMap,Rs=new WeakMap,vr=new WeakMap,jf=new WeakMap,cS=new WeakMap,hS=new WeakMap,Uf=new WeakMap;class aA{constructor(e,n,r){Ta(this,th,void 0),Ta(this,Rs,void 0),Ta(this,vr,void 0),Ta(this,jf,[]),Ta(this,cS,[]),Ta(this,hS,void 0),Ta(this,Uf,[]),bs(th,this,e),bs(Rs,this,n),bs(vr,this,r)}setRemovedHfIndexes(e){return bs(Uf,this,e.map(n=>{const r=St(Rs,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),St(Uf,this)}getRemovedHfIndexes(){return St(Uf,this)}getHfIndexFromVisualIndex(e){const n=St(Rs,this).getIndexesSequence(),r=St(Rs,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${Ii(St(th,this))}s`;St(vr,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&St(vr,this).getEngine()[r](St(vr,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(bs(cS,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),bs(hS,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(St(vr,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=ET(St(cS,this),St(hS,this),St(Rs,this).getNumberOfIndexes());St(vr,this).getSheetId()===null?St(vr,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Ii(St(th,this))}Order`;return n=>{if(St(vr,this).isPerformingUndoRedo())return;const r=St(Rs,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=St(jf,this).map(l=>r.indexOf(l)),o=St(vr,this).getEngine().getSheetDimensions(St(vr,this).getSheetId());let s;St(th,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);St(vr,this).getEngine()[e](St(vr,this).getSheetId(),i)}bs(jf,this,r)}}init(){bs(jf,this,St(Rs,this).getIndexesSequence())}}function _a(t,e,n){Dne(t,e),e.set(t,n)}function Dne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xo(t,e){return t.get(T$(t,e))}function Ma(t,e,n){return t.set(T$(t,e),n),n}function T$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zf=new WeakMap,Yf=new WeakMap,dS=new WeakMap,fS=new WeakMap,gS=new WeakMap,mS=new WeakMap,pS=new WeakMap;class kne{constructor(e,n,r){_a(this,zf,void 0),_a(this,Yf,void 0),_a(this,dS,void 0),_a(this,fS,!1),_a(this,gS,!1),_a(this,mS,null),_a(this,pS,null),Ma(zf,this,new aA("row",e,this)),Ma(Yf,this,new aA("column",n,this)),Ma(dS,this,r)}getForAxis(e){return e==="row"?xo(zf,this):xo(Yf,this)}setPerformUndo(e){Ma(fS,this,e)}setPerformRedo(e){Ma(gS,this,e)}isPerformingUndoRedo(){return xo(fS,this)||xo(gS,this)}getSheetId(){return xo(pS,this)}getEngine(){return xo(mS,this)}getPostponeAction(){return xo(dS,this)}setupSyncEndpoint(e,n){Ma(mS,this,e),Ma(pS,this,n),xo(zf,this).init(),xo(Yf,this).init()}}function Lne(t,e){_$(t,e),e.add(t)}function Ia(t,e,n){return(e=$ne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ne(t){var e=Fne(t,"string");return typeof e=="symbol"?e:e+""}function Fne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wS(t,e,n){_$(t,e),e.set(t,n)}function _$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ks(t,e,n){return t.set(Ue(t,e),n),n}function rl(t,e){return t.get(Ue(t,e))}function Ue(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Hn="formulas",Vne=["maxRows","maxColumns","language"],Wne=260;ne.getSingleton().register("afterNamedExpressionAdded");ne.getSingleton().register("afterNamedExpressionRemoved");ne.getSingleton().register("afterSheetAdded");ne.getSingleton().register("afterSheetRemoved");ne.getSingleton().register("afterSheetRenamed");ne.getSingleton().register("afterFormulasValuesUpdate");const oc=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var is=new WeakMap,Dp=new WeakMap,nh=new WeakMap,Ge=new WeakSet;class Bne extends Ke{constructor(){var e;super(...arguments),e=this,Lne(this,Ge),wS(this,is,!1),wS(this,Dp,!1),wS(this,nh,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ue(Ge,e,ire).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ue(Ge,e,ore).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ue(Ge,e,sre).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ue(Ge,e,are).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ue(Ge,e,lre).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ue(Ge,e,ure).call(e,...r)}]]),Ia(this,"staticRegister",ri("formulas")),Ia(this,"engine",null),Ia(this,"sheetId",null),Ia(this,"sheetName",null),Ia(this,"indexSyncer",null),Ia(this,"rowAxisSyncer",null),Ia(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Hn}static get PLUGIN_PRIORITY(){return Wne}static get SETTING_KEYS(){return[Hn,...Vne]}isEnabled(){return!!this.hot.getSettings()[Hn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Sne(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){qe("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&Ue(Ge,this,Oh).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,lA).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,uA).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,lA).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,uA).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,Yne).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,Gne).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,jne).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,qne).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,cA).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,cA).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,Kne).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,Xne).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,Jne).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,ere).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,Zne).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,Qne).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,tre).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,nre).call(n,...i)}),this.indexSyncer=new kne(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,zne).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,rre).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ue(Ge,n,Une).call(n,...i)}),rl(nh,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){rl(nh,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),sA(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Cne(this.hot.getSettings());yne(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Hn];if(le(r)&&le(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Hn].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,this.hot.getSourceDataArray());Ue(Ge,this,Oh).call(this,o)}}super.updatePlugin(e)}destroy(){rl(nh,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),Ks(nh,this,null),sA(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(le(n)&&!nK(n))return qe("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return qe("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return qe(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){YR(`The sheet named \`${e}\` does not exist, switch aborted.`);return}Ue(Ge,this,Oh).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Ii(Hn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),oA(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o?.address)!==null&&s!==void 0?s:{};return le(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(le(l)===!1||le(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=oA(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){qe(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return RT(r,o.type)&&(S$(r,o.dateFormat)?r=b$(r,o.dateFormat):Pne(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function Oh(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function jne(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&zn(s)&&(s=R$(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Une(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:m,col:v}=h.start,{row:S,col:R}=h.end,w=S-m+1,_=R-v+1;for(let O=0;O<f.length;O+=1)for(let L=0;L<f[O].length;L+=1){const M=f[O][L],x=m+O%w,z=v+L%_,q=this.hot.getCellMeta(x,z);RT(M,q.type)&&(M.startsWith("'")?f[O][L]=M.slice(1):this.isFormulaCellType(x,z,this.sheetId)===!1&&(f[O][L]=One(M,q.dateFormat)))}return f}function lA(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Ii(Hn))||Ks(Dp,this,Mt(this.hot.getSettings().data))}function zne(){if(rl(Dp,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;RT(i,s.type)&&(S$(i,a)?t[r][o]=b$(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),Ks(is,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),Ks(is,this,!1)}function uA(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(Ii(Hn)))return;const r=_ne(this.engine,this.hot.getSettings()[Hn].sheetName);if(Ue(Ge,this,Oh).call(this,r),n!=="updateSettings")if(rl(Dp,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){Ks(is,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),Ks(is,this,!1)}}}function Yne(t,e,n,r){if(r!=="get"||rl(is,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||t===null||e===null)return;const i=this.getCellType(t,e);if(i==="VALUE"||i==="EMPTY"){n.value=Ine(n.value);return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let s=this.engine.getCellValue(o);const a=this.hot.getCellMeta(t,e,{skipMetaExtension:!0});a.type==="date"&&zn(s)&&(s=R$(s,a.dateFormat)),n.value=typeof s=="object"&&s!==null?s.value:s}function Gne(t,e,n,r){if(r!=="get"||rl(is,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function cA(t,e){if(oc(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function qne(t,e){if(oc(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!zn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){qe(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function Kne(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Xne(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Zne(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Qne(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Jne(t,e,n){if(oc(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function ere(t,e,n){if(oc(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function tre(t,e,n,r){if(oc(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function nre(t,e,n,r){if(oc(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function rre(t,e,n){var r;Ks(is,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Ks(is,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function ire(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function ore(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function sre(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function are(t){this.hot.runHooks("afterSheetAdded",t)}function lre(t,e){Ue(Ge,this,Oh).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function ure(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function cre(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(r0,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function hre(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(i0,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ve(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return P(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function dre(t,e){M$(t,e),e.add(t)}function fre(t,e,n){M$(t,e),e.set(t,n)}function M$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pa(t,e){return t.get(Os(t,e))}function hA(t,e,n){return t.set(Os(t,e),n),n}function Os(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("beforeHideColumns");ne.getSingleton().register("afterHideColumns");ne.getSingleton().register("beforeUnhideColumns");ne.getSingleton().register("afterUnhideColumns");const dA="hiddenColumns",gre=310;var Bi=new WeakMap,Oa=new WeakSet;class mre extends Ke{constructor(){super(...arguments),dre(this,Oa),fre(this,Bi,null)}static get PLUGIN_KEY(){return dA}static get PLUGIN_PRIORITY(){return gre}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[dA]}enablePlugin(){var e=this;this.enabled||(hA(Bi,this,new hp),Pa(Bi,this).addLocalHook("init",()=>Os(Oa,this,Sre).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Pa(Bi,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Os(Oa,e,yre).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Os(Oa,this,wre).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>Os(Oa,this,pre).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Os(Oa,e,Cre).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Os(Oa,this,vre).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=Pa(Bi,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));P(l,u=>{o[u]=!1}),i=pr(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&Pa(Bi,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{P(e,s=>{Pa(Bi,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ve(Pa(Bi,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Pa(Bi,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){P(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){hA(Bi,this,null),super.destroy()}}function pre(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function wre(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function vre(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return P(t,r=>{let i=!0,o=0;he(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Cre(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),G(e,n)}function yre(t){t.items.push({name:He},cre(this),hre(this))}function Sre(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function bre(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(o0,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Rre(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(s0,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ve(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return P(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Ere(t,e){I$(t,e),e.add(t)}function Tre(t,e,n){I$(t,e),e.set(t,n)}function I$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xa(t,e){return t.get(xs(t,e))}function fA(t,e,n){return t.set(xs(t,e),n),n}function xs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("beforeHideRows");ne.getSingleton().register("afterHideRows");ne.getSingleton().register("beforeUnhideRows");ne.getSingleton().register("afterUnhideRows");const gA="hiddenRows",_re=320;var ji=new WeakMap,Ha=new WeakSet;class Mre extends Ke{constructor(){super(...arguments),Ere(this,Ha),Tre(this,ji,null)}static get PLUGIN_KEY(){return gA}static get PLUGIN_PRIORITY(){return _re}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[gA]}enablePlugin(){var e=this;this.enabled||(fA(ji,this,new hp),xa(ji,this).addLocalHook("init",()=>xs(Ha,this,Are).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,xa(ji,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xs(Ha,e,Hre).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>xs(Ha,this,Pre).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>xs(Ha,this,Ire).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xs(Ha,e,xre).call(e,...r)}),this.addHook("modifyCopyableRange",n=>xs(Ha,this,Ore).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=xa(ji,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));P(l,u=>{o[u]=!1}),i=pr(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&xa(ji,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{P(e,s=>{xa(ji,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ve(xa(ji,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return xa(ji,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){P(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){fA(ji,this,null),super.destroy()}}function Ire(t,e){return this.isHidden(e)?0:t}function Pre(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Ore(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return P(t,r=>{let i=!0,o=0;he(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function xre(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),G(e,n)}function Hre(t){t.items.push({name:He},bre(this),Rre(this))}function Are(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function Nre(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(AE)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Dre(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(NE)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function kre(t,e){P$(t,e),e.add(t)}function Lre(t,e,n){P$(t,e),e.set(t,n)}function P$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zb(t,e){return t.get(Sm(t,e))}function vS(t,e,n){return t.set(Sm(t,e),n),n}function Sm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("beforeColumnFreeze");ne.getSingleton().register("afterColumnFreeze");ne.getSingleton().register("beforeColumnUnfreeze");ne.getSingleton().register("afterColumnUnfreeze");const mA="manualColumnFreeze",$re=110;var Ua=new WeakMap,CS=new WeakSet;class Fre extends Ke{constructor(){super(...arguments),kre(this,CS),Lre(this,Ua,!1)}static get PLUGIN_KEY(){return mA}static get PLUGIN_PRIORITY(){return $re}isEnabled(){return!!this.hot.getSettings()[mA]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Sm(CS,this,Vre).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>Sm(CS,this,Wre).call(this,e,n)),super.enablePlugin())}disablePlugin(){vS(Ua,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;zb(Ua,this)||vS(Ua,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;zb(Ua,this)||vS(Ua,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Vre(t){t.items.push({name:"---------"},Nre(this),Dre(this))}function Wre(t,e){if(zb(Ua,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function Gf(t,e,n){return(e=Bre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bre(t){var e=jre(t,"string");return typeof e=="symbol"?e:e+""}function jre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const yS=0,pA=1,wA=2,ru="px";let O$=class{constructor(e){Gf(this,"hot",void 0),Gf(this,"_element",null),Gf(this,"state",yS),Gf(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=wA}build(){this.state===yS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=pA)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=yS}isAppended(){return this.state===wA}isBuilt(){return this.state>=pA}setPosition(e,n){zn(e)&&(this._element.style.top=e+ru),zn(n)&&(this._element.style[this.inlineProperty]=n+ru)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){zn(e)&&(this._element.style.width=e+ru),zn(n)&&(this._element.style.height=n+ru)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){zn(e)&&(this._element.style.marginTop=e+ru),zn(n)&&(this._element.style[`margin${Ii(this.inlineProperty)}`]=n+ru)}getOffset(){const e=this._element.style,n=`margin${Ii(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const Ure="ht__manualColumnMove--backlight";let zre=class extends O${build(){super.build(),G(this._element,Ure)}};const Yre="ht__manualColumnMove--guideline";let Gre=class extends O${build(){super.build(),G(this._element,Yre)}};function qre(t,e){x$(t,e),e.add(t)}function hi(t,e,n){x$(t,e),e.set(t,n)}function x$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hr(t,e,n){return t.set(Hs(t,e),n),n}function ce(t,e){return t.get(Hs(t,e))}function Hs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("beforeColumnMove");ne.getSingleton().register("afterColumnMove");const SS="manualColumnMove",Kre=120,vA="ht__manualColumnMove",bm="show-ui",Yb="on-moving--columns",Gb="after-selection--columns";var jn=new WeakMap,Ns=new WeakMap,qo=new WeakMap,Vg=new WeakMap,Bs=new WeakMap,Bn=new WeakMap,qf=new WeakMap,Vr=new WeakMap,Cu=new WeakMap,Rm=new WeakMap,xh=new WeakMap,Aa=new WeakSet;class Xre extends Ke{constructor(){super(...arguments),qre(this,Aa),hi(this,jn,new zre(this.hot)),hi(this,Ns,new Gre(this.hot)),hi(this,qo,[]),hi(this,Vg,0),hi(this,Bs,!1),hi(this,Bn,{}),hi(this,qf,void 0),hi(this,Vr,void 0),hi(this,Cu,void 0),hi(this,Rm,void 0),hi(this,xh,void 0)}static get PLUGIN_KEY(){return SS}static get PLUGIN_PRIORITY(){return Kre}isEnabled(){return!!this.hot.getSettings()[SS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hs(Aa,e,Zre).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hs(Aa,e,Jre).call(e,...r)}),this.addHook("afterScrollVertically",()=>Hs(Aa,this,tie).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hs(Aa,e,nie).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),G(this.hot.rootElement,vA),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){pe(this.hot.rootElement,vA),this.unregisterEvents(),ce(jn,this).destroy(),ce(Ns,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=ce(qf,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(hr(qf,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return hr(qf,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=pr(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[SS];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return he(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(ce(Vr,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,ce(Vr,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=ce(jn,this).getOffset().start,u=ce(jn,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const m=this.hot.rootWindow,v=Yt(this.hot.rootElement),S=m.innerWidth-ce(Cu,this)-v;h=m.innerWidth-ce(Bn,this).eventPageX-S-(r.scrollX===void 0?i:0)}else h=ce(Bn,this).eventPageX-(ce(Cu,this)-(r.scrollX===void 0?i:0));if(ce(Rm,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(ce(Vr,this))&&(o+=i),o+=c,ce(Vr,this)<0)ce(xh,this)>0?ce(Bn,this).col=0:ce(Bn,this).col=e>0?e-1:e;else if(ce(Bn,this).TD.offsetWidth/2+o<=h){const m=ce(Vr,this)>=ce(Vg,this)?ce(Vg,this)-1:ce(Vr,this);ce(Bn,this).col=m+1,o+=ce(Bn,this).TD.offsetWidth}else ce(Bn,this).col=ce(Vr,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&ce(Vr,this)<ce(xh,this)&&(f-=ce(Cu,this)<=r.scrollX?ce(Cu,this):0),ce(jn,this).setPosition(null,d),ce(Ns,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Hs(Aa,this,Qre).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Hs(Aa,this,eie).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){ce(jn,this).build(),ce(Ns,this).build()}destroy(){ce(jn,this).destroy(),ce(Ns,this).destroy(),super.destroy()}}function Zre(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=Ce(t.target,"sortAction");if(!s||!o||ce(Bs,this)||t.button!==0||a){hr(Bs,this,!1),ce(qo,this).length=0,pe(this.hot.rootElement,[Yb,bm]);return}const l=ce(Ns,this).isBuilt()&&!ce(Ns,this).isAppended(),u=ce(jn,this).isBuilt()&&!ce(jn,this).isAppended();l&&u&&(ce(Ns,this).appendTo(i.hider),ce(jn,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,hr(Bs,this,!0);const m=n.firstChild?Xz(t,n.firstChild).x:t.offsetX;ce(Bn,this).eventPageX=t.pageX,hr(Vr,this,e.col),ce(Bn,this).TD=n,ce(Bn,this).col=e.col,hr(qo,this,this.prepareColumnsToMoving(d,f)),hr(Rm,this,!!this.hot.getSettings().rowHeaders),hr(Vg,this,this.hot.countCols()),hr(xh,this,this.hot.getSettings().fixedColumnsStart),hr(Cu,this,An(this.hot.rootElement).left);const v=ce(Rm,this)?-1:0,S=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,R=e.col<ce(xh,this),w=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),_=Math.abs(m-(this.hot.isRtl()?n.offsetWidth:0)),O=this.getColumnsWidth(d,e.col-1)+_,L=this.getColumnsWidth(v,d-1)+(R?w:0)+O;ce(jn,this).setPosition(S,L),ce(jn,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-S),ce(jn,this).setOffset(null,-O),G(this.hot.rootElement,Yb)}else pe(this.hot.rootElement,Gb),hr(Bs,this,!1),ce(qo,this).length=0}function Qre(t){ce(Bs,this)&&(ce(Bn,this).eventPageX=t.pageX,this.refreshPositions())}function Jre(t,e,n,r){!this.hot.getSelectedRangeLast()||!ce(Bs,this)||(ce(qo,this).indexOf(e.col)>-1?pe(this.hot.rootElement,bm):G(this.hot.rootElement,bm),r.row=!0,r.column=!0,r.cell=!0,hr(Vr,this,e.col),ce(Bn,this).TD=n)}function eie(){const t=ce(Bn,this).col,e=ce(qo,this).length;if(hr(Vr,this,void 0),hr(Bs,this,!1),pe(this.hot.rootElement,[Yb,bm,Gb]),this.hot.selection.isSelectedByColumnHeader()&&G(this.hot.rootElement,Gb),e<1||t===void 0)return;const n=ce(qo,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(ce(qo,this),t);if(ce(qo,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function tie(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;ce(jn,this).setPosition(r),ce(jn,this).setSize(null,t.hider.offsetHeight-r)}function nie(){this.moveBySettingsOrLoad()}function rie(t,e){H$(t,e),e.add(t)}function _n(t,e,n){H$(t,e),e.set(t,n)}function H$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vt(t,e,n){return t.set(yi(t,e),n),n}function re(t,e){return t.get(yi(t,e))}function yi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Em="manualColumnResize",iie=130,CA="manualColumnWidths";var Wo=new WeakMap,Kf=new WeakMap,Mr=new WeakMap,Tm=new WeakMap,so=new WeakMap,oie=new WeakMap,Au=new WeakMap,Xf=new WeakMap,ir=new WeakMap,Lo=new WeakMap,dl=new WeakMap,_m=new WeakMap,Hh=new WeakMap,Ah=new WeakMap,Pr=new WeakMap,Nh=new WeakMap,Ui=new WeakSet;class sie extends Ke{static get PLUGIN_KEY(){return Em}static get PLUGIN_PRIORITY(){return iie}constructor(e){super(e),rie(this,Ui),_n(this,Wo,null),_n(this,Kf,null),_n(this,Mr,[]),_n(this,Tm,null),_n(this,so,null),_n(this,oie,null),_n(this,Au,null),_n(this,Xf,null),_n(this,ir,this.hot.rootDocument.createElement("DIV")),_n(this,Lo,this.hot.rootDocument.createElement("DIV")),_n(this,dl,null),_n(this,_m,!1),_n(this,Hh,0),_n(this,Ah,null),_n(this,Pr,void 0),_n(this,Nh,void 0),G(re(ir,this),"manualColumnResizer"),G(re(Lo,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Em]}enablePlugin(){var e=this;this.enabled||(Vt(Pr,this,new ta),re(Pr,this).addLocalHook("init",()=>yi(Ui,this,aie).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,re(Pr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yi(Ui,e,fie).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yi(Ui,e,gie).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yi(Ui,e,mie).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Vt(Nh,this,re(Pr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",CA,re(Pr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",CA,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return re(Pr,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);re(Pr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Vt(Wo,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(re(Wo,this)),i=r.col;if(i<0)return;const o=en(re(Wo,this)),s=re(Wo,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(re(Wo,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(re(Wo,this),r.row,r.col)),Vt(Kf,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Vt(Mr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();P(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;he(d,f,m=>{re(Mr,this).includes(m)||re(Mr,this).push(m)})})}re(Mr,this).includes(re(Kf,this))||Vt(Mr,this,[re(Kf,this)]),Vt(Xf,this,l.start-6),Vt(Au,this,parseInt(s.width,10)),re(ir,this).style.top=`${l.top}px`,re(ir,this).style[this.inlineDir]=`${re(Xf,this)+re(Au,this)}px`,re(ir,this).style.height=`${o}px`,this.hot.rootElement.appendChild(re(ir,this))}refreshHandlePosition(){re(ir,this).style[this.inlineDir]=`${re(Xf,this)+re(Tm,this)}px`}setupGuidePosition(){const e=parseInt(en(re(ir,this)),10),n=parseInt(re(ir,this).style.top,10)+e,r=this.hot.view.getTableHeight();G(re(ir,this),"active"),G(re(Lo,this),"active"),re(Lo,this).style.top=`${n}px`,this.refreshGuidePosition(),re(Lo,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(re(Lo,this))}refreshGuidePosition(){re(Lo,this).style[this.inlineDir]=re(ir,this).style[this.inlineDir]}hideHandleAndGuide(){pe(re(ir,this),"active"),pe(re(Lo,this),"active")}checkIfColumnHeader(e){const n=ol(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",re(so,this),r,!0);o!==void 0&&Vt(so,this,o),this.setManualSize(r,re(so,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",re(so,this),r,!0),i&&e()};re(Hh,this)>=2&&(re(Mr,this).length>1?(P(re(Mr,this),i=>{n(i)}),e()):P(re(Mr,this),i=>{n(i,!0)})),Vt(Hh,this,0),Vt(Ah,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>yi(Ui,this,lie).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>yi(Ui,this,uie).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>yi(Ui,this,cie).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>yi(Ui,this,hie).call(this)),this.eventManager.addEventListener(re(ir,this),"contextmenu",()=>yi(Ui,this,die).call(this))}destroy(){super.destroy()}}function aie(){const t=this.hot.getSettings()[Em],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{re(Pr,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{re(Pr,this).setValueAtIndex(r,n)})},!0),Vt(Nh,this,t)):t===!0&&Array.isArray(re(Nh,this))&&this.hot.batchExecution(()=>{re(Nh,this).forEach((n,r)=>{re(Pr,this).setValueAtIndex(r,n)})},!0)}function lie(t){if(!aD(t.target)&&re(_m,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(re(dl,this)||this.setupHandlePosition(e))}}function uie(t){t.target.parentNode===this.hot.rootElement&&Ce(t.target,"manualColumnResizer")&&(this.setupHandlePosition(re(Wo,this)),this.setupGuidePosition(),Vt(dl,this,!0),re(Ah,this)===null&&(Vt(Ah,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(re(Ah,this))),Vt(Hh,this,re(Hh,this)+1),this.startX=t.pageX,Vt(so,this,re(Au,this)))}function cie(t){if(re(dl,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Vt(Tm,this,re(Au,this)+e),P(re(Mr,this),n=>{Vt(so,this,this.setManualSize(n,re(Tm,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function hie(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",re(so,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",re(so,this),n,!1)};re(dl,this)&&(this.hideHandleAndGuide(),Vt(dl,this,!1),re(so,this)!==re(Au,this)&&(re(Mr,this).length>1?(P(re(Mr,this),r=>{e(r)}),t()):P(re(Mr,this),r=>{e(r,!0)})),this.setupHandlePosition(re(Wo,this)))}function die(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(re(ir,this)),this.hot.rootElement.removeChild(re(Lo,this)),Vt(dl,this,!1),Vt(_m,this,!0),this.hot._registerImmediate(()=>{Vt(_m,this,!1)})}function fie(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=re(Pr,this).getValueAtIndex(r);this.hot.getSettings()[Em]&&i&&(n=i)}return n}function gie(t,e){const n=re(Pr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function mie(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function bS(t,e,n){return(e=pie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pie(t){var e=wie(t,"string");return typeof e=="symbol"?e:e+""}function wie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const RS=0,yA=1,SA=2,iu="px";let A$=class{constructor(e){bS(this,"hot",void 0),bS(this,"_element",null),bS(this,"state",RS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=SA}build(){this.state===RS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=yA)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=RS}isAppended(){return this.state===SA}isBuilt(){return this.state>=yA}setPosition(e,n){e!==void 0&&(this._element.style.top=e+iu),n!==void 0&&(this._element.style.left=n+iu)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+iu),n&&(this._element.style.height=n+iu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+iu),n&&(this._element.style.marginLeft=n+iu)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const vie="ht__manualRowMove--backlight";class Cie extends A${build(){super.build(),G(this._element,vie)}}const yie="ht__manualRowMove--guideline";class Sie extends A${build(){super.build(),G(this._element,yie)}}function bie(t,e){N$(t,e),e.add(t)}function ou(t,e,n){N$(t,e),e.set(t,n)}function N$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function el(t,e,n){return t.set(As(t,e),n),n}function Re(t,e){return t.get(As(t,e))}function As(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("beforeRowMove");ne.getSingleton().register("afterRowMove");const ES="manualRowMove",Rie=140,bA="ht__manualRowMove",Mm="show-ui",qb="on-moving--rows",Kb="after-selection--rows";var Un=new WeakMap,Ds=new WeakMap,Ko=new WeakMap,js=new WeakMap,dr=new WeakMap,Zf=new WeakMap,Na=new WeakSet;class Eie extends Ke{constructor(){super(...arguments),bie(this,Na),ou(this,Un,new Cie(this.hot)),ou(this,Ds,new Sie(this.hot)),ou(this,Ko,[]),ou(this,js,void 0),ou(this,dr,{}),ou(this,Zf,void 0)}static get PLUGIN_KEY(){return ES}static get PLUGIN_PRIORITY(){return Rie}isEnabled(){return!!this.hot.getSettings()[ES]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return As(Na,e,Tie).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return As(Na,e,Mie).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>As(Na,this,Pie).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return As(Na,e,Oie).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),G(this.hot.rootElement,bA),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){pe(this.hot.rootElement,bA),this.unregisterEvents(),Re(Un,this).destroy(),Re(Ds,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Re(Zf,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(el(Zf,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return el(Zf,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=pr(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.stylesHandler.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[ES];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return he(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Re(dr,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Re(dr,this).TD,a=this.hot.rootElement,l=An(a),u=Gh(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Re(dr,this).eventPageY-d+c,m=o.hider.offsetHeight,v=o.TBODY.offsetTop,S=Re(Un,this).getOffset().top,R=Re(Un,this).getSize().height,w=s.offsetHeight/2,_=s.offsetHeight;let O=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const L=f>=O+w;this.isFixedRowTop(e.row)&&(O+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Re(dr,this).row=n>0?n-1:n:L?(Re(dr,this).row=e.row+1,O+=e.row===0?_-1:_):Re(dr,this).row=e.row;let M=f,x=O;f+R+S>=m?M=m-R-S:f+S<v&&(M=v+Math.abs(S)),O>=m-1&&(x=m-1),Re(Un,this).setPosition(M),Re(Ds,this).setPosition(x)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>As(Na,this,_ie).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>As(Na,this,Iie).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Re(Un,this).build(),Re(Ds,this).build()}destroy(){Re(Un,this).destroy(),Re(Ds,this).destroy(),super.destroy()}}function Tie(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Re(js,this)||t.button!==0){el(js,this,!1),Re(Ko,this).length=0,pe(this.hot.rootElement,[qb,Mm]);return}const l=Re(Ds,this).isBuilt()&&!Re(Ds,this).isAppended(),u=Re(Un,this).isBuilt()&&!Re(Un,this).isAppended();l&&u&&(Re(Ds,this).appendTo(i.hider),Re(Un,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,el(js,this,!0),Re(dr,this).eventPageY=t.pageY,Re(dr,this).coords=e,Re(dr,this).TD=n,el(Ko,this,this.prepareRowsToMoving());const m=i.holder.scrollLeft+o.getRowHeaderWidth(),v=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);Re(Un,this).setPosition(null,m),Re(Un,this).setSize(i.hider.offsetWidth-m,this.getRowsHeight(d,f)),Re(Un,this).setOffset(-v,null),G(this.hot.rootElement,qb),this.refreshPositions()}else pe(this.hot.rootElement,Kb),el(js,this,!1),Re(Ko,this).length=0}function _ie(t){Re(js,this)&&(Re(dr,this).eventPageY=t.pageY,this.refreshPositions())}function Mie(t,e,n,r){!this.hot.getSelectedRangeLast()||!Re(js,this)||(Re(Ko,this).indexOf(e.row)>-1?pe(this.hot.rootElement,Mm):G(this.hot.rootElement,Mm),r.row=!0,r.column=!0,r.cell=!0,Re(dr,this).coords=e,Re(dr,this).TD=n)}function Iie(){const t=Re(dr,this).row,e=Re(Ko,this).length;if(el(js,this,!1),pe(this.hot.rootElement,[qb,Mm,Kb]),this.hot.selection.isSelectedByRowHeader()&&G(this.hot.rootElement,Kb),e<1||t===void 0)return;const n=Re(Ko,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Re(Ko,this),t);if(Re(Ko,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function Pie(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Re(Un,this).setPosition(null,r),Re(Un,this).setSize(t.hider.offsetWidth-r)}function Oie(){this.moveBySettingsOrLoad()}function xie(t,e){D$(t,e),e.add(t)}function Mn(t,e,n){D$(t,e),e.set(t,n)}function D$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function At(t,e,n){return t.set(Bo(t,e),n),n}function te(t,e){return t.get(Bo(t,e))}function Bo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Im="manualRowResize",Hie=30,RA="manualRowHeights";var eo=new WeakMap,Qf=new WeakMap,Ir=new WeakMap,Dh=new WeakMap,ks=new WeakMap,TT=new WeakMap,Nu=new WeakMap,Jf=new WeakMap,Vn=new WeakMap,Zi=new WeakMap,fl=new WeakMap,Pm=new WeakMap,kh=new WeakMap,Lh=new WeakMap,bi=new WeakMap,$h=new WeakMap,Es=new WeakSet;class Aie extends Ke{static get PLUGIN_KEY(){return Im}static get PLUGIN_PRIORITY(){return Hie}constructor(e){super(e),xie(this,Es),Mn(this,eo,null),Mn(this,Qf,null),Mn(this,Ir,[]),Mn(this,Dh,null),Mn(this,ks,null),Mn(this,TT,null),Mn(this,Nu,null),Mn(this,Jf,null),Mn(this,Vn,this.hot.rootDocument.createElement("DIV")),Mn(this,Zi,this.hot.rootDocument.createElement("DIV")),Mn(this,fl,!1),Mn(this,Pm,!1),Mn(this,kh,0),Mn(this,Lh,null),Mn(this,bi,void 0),Mn(this,$h,void 0),G(te(Vn,this),"manualRowResizer"),G(te(Zi,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Im]}enablePlugin(){this.enabled||(At(bi,this,new ta),te(bi,this).addLocalHook("init",()=>Bo(Es,this,Vie).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,te(bi,this)),this.addHook("modifyRowHeight",(e,n)=>Bo(Es,this,Fie).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){At($h,this,te(bi,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",RA,te(bi,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",RA,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.stylesHandler.getDefaultRowHeight());return te(bi,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return te(Dh,this)}setupHandlePosition(e){At(eo,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(te(eo,this)),o=i.row;if(o<0)return;const s=Yt(te(eo,this)),a=te(eo,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(te(eo,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(te(eo,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(te(eo,this),i.row,i.col)),At(Qf,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),At(Ir,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();P(d,f=>{const m=f.getTopStartCorner().row,v=f.getBottomStartCorner().row;he(m,v,S=>{te(Ir,this).includes(S)||te(Ir,this).push(S)})})}te(Ir,this).includes(te(Qf,this))||At(Ir,this,[te(Qf,this)]),At(Jf,this,c.top-6),At(Nu,this,parseInt(a.height,10)),te(Vn,this).style.top=`${te(Jf,this)+te(Nu,this)}px`,te(Vn,this).style[this.inlineDir]=`${c.start}px`,te(Vn,this).style.width=`${s}px`,this.hot.rootElement.appendChild(te(Vn,this))}refreshHandlePosition(){te(Vn,this).style.top=`${te(Jf,this)+te(Dh,this)}px`}setupGuidePosition(){const e=parseInt(Yt(te(Vn,this)),10),n=parseInt(te(Vn,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();G(te(Vn,this),"active"),G(te(Zi,this),"active"),te(Zi,this).style.top=te(Vn,this).style.top,te(Zi,this).style[this.inlineDir]=`${n}px`,te(Zi,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(te(Zi,this))}refreshGuidePosition(){te(Zi,this).style.top=te(Vn,this).style.top}hideHandleAndGuide(){pe(te(Vn,this),"active"),pe(te(Zi,this),"active")}checkIfRowHeader(e){const n=ol(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&te(ks,this)<n?n:te(ks,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&At(ks,this,o),this.setManualSize(r,te(ks,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};te(kh,this)>=2&&(te(Ir,this).length>1?(P(te(Ir,this),i=>{n(i)}),e()):P(te(Ir,this),i=>{n(i,!0)})),At(kh,this,0),At(Lh,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Bo(Es,this,Nie).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Bo(Es,this,Die).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Bo(Es,this,kie).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Bo(Es,this,Lie).call(this)),this.eventManager.addEventListener(te(Vn,this),"contextmenu",()=>Bo(Es,this,$ie).call(this))}destroy(){super.destroy()}}function Nie(t){if(!aD(t.target)&&te(Pm,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(te(fl,this)||this.setupHandlePosition(e))}}function Die(t){Ce(t.target,"manualRowResizer")&&(this.setupHandlePosition(te(eo,this)),this.setupGuidePosition(),At(fl,this,!0),te(Lh,this)===null&&(At(Lh,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(te(Lh,this))),At(kh,this,te(kh,this)+1),At(TT,this,t.pageY),At(ks,this,te(Nu,this)))}function kie(t){te(fl,this)&&(At(Dh,this,te(Nu,this)+(t.pageY-te(TT,this))),P(te(Ir,this),e=>{At(ks,this,this.setManualSize(e,te(Dh,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Lie(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};te(fl,this)&&(this.hideHandleAndGuide(),At(fl,this,!1),te(ks,this)!==te(Nu,this)&&(te(Ir,this).length>1?(P(te(Ir,this),r=>{e(r)}),t()):P(te(Ir,this),r=>{e(r,!0)})),this.setupHandlePosition(te(eo,this)))}function $ie(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(te(Vn,this)),this.hot.rootElement.removeChild(te(Zi,this)),At(fl,this,!1),At(Pm,this,!0),this.hot._registerImmediate(()=>{At(Pm,this,!1)})}function Fie(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=te(bi,this).getValueAtIndex(r);this.hot.getSettings()[Im]&&i&&(n=i)}return n}function Vie(){const t=this.hot.getSettings()[Im],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{te(bi,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{te(bi,this).setValueAtIndex(r,n)}),At($h,this,t)):t===!0&&Array.isArray(te($h,this))&&te($h,this).forEach((n,r)=>{te(bi,this).setValueAtIndex(r,n)})},!0)}var EA={},TA;function Wie(){if(TA)return EA;TA=1;var t=ap();return t("flatMap"),EA}Wie();var _A={},MA={},TS,IA;function Bie(){if(IA)return TS;IA=1;var t=rn(),e=sn(),n=go(),r=uR();return TS=function(i,o){(!o||typeof i!="string")&&e(i);var s=r(i);return n(e(s!==void 0?t(s,i):i))},TS}var PA;function jie(){if(PA)return MA;PA=1;var t=gt(),e=rn(),n=gr(),r=sn(),i=go(),o=Bie(),s=dR(),a=mr(),l=Xs(),u=fR(),c=Qs(),h=!l&&!u("flatMap",function(){}),d=!l&&!h&&c("flatMap",TypeError),f=l||h||d,m=s(function(){for(var v=this.iterator,S=this.mapper,R,w;;){if(w=this.inner)try{if(R=r(e(w.next,w.iterator)),!R.done)return R.value;this.inner=null}catch(_){a(v,"throw",_)}if(R=r(e(this.next,v)),this.done=!!R.done)return;try{this.inner=o(S(R.value,this.counter++),!1)}catch(_){a(v,"throw",_)}}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{flatMap:function(S){r(this);try{n(S)}catch(R){a(this,"throw",R)}return d?e(d,this,S):new m(i(this),{mapper:S,inner:null})}}),MA}var OA;function Uie(){return OA||(OA=1,jie()),_A}Uie();function zie(t,e,n){Yie(t,e),e.set(t,n)}function Yie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Da(t,e,n){return(e=Gie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gie(t){var e=qie(t,"string");return typeof e=="symbol"?e:e+""}function qie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xA(t,e){return t.get(k$(t,e))}function eg(t,e,n){return t.set(k$(t,e),n),n}function k$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ka=new WeakMap;class to{constructor(e,n,r,i,o,s){Da(this,"row",void 0),Da(this,"col",void 0),Da(this,"rowspan",void 0),Da(this,"colspan",void 0),Da(this,"removed",!1),Da(this,"cellCoordsFactory",void 0),Da(this,"cellRangeFactory",void 0),zie(this,ka,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return tt`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return tt`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return tt`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return tt`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),eg(ka,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,eg(ka,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return eg(ka,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return xA(ka,this)||eg(ka,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),xA(ka,this)}}function Kie(t,e){Xie(t,e),e.add(t)}function Xie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tg(t,e,n){return(e=Zie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zie(t){var e=Qie(t,"string");return typeof e=="symbol"?e:e+""}function Qie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function La(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ts=new WeakSet;class Om{constructor(e){Kie(this,Ts),tg(this,"plugin",void 0),tg(this,"mergedCells",[]),tg(this,"mergedCellsMatrix",new Map),tg(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return tt`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){qe(Om.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new to(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),La(Ts,this,HA).call(this,a),a):(u&&qe(Om.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),La(Ts,this,Jie).call(this,r),r):!1}clear(){P(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;he(n,n+i,s=>{he(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Be(u,i,i+s-1),d=Be(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=La(Ts,this,ng).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=La(Ts,this,ng).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=La(Ts,this,ng).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=La(Ts,this,ng).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{La(Ts,this,HA).call(this,s)})}}function ng(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function HA(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function Jie(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function _S(t,e,n){return(e=eoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eoe(t){var e=toe(t,"string");return typeof e=="symbol"?e:e+""}function toe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class noe{constructor(e){_S(this,"plugin",void 0),_S(this,"mergedCellsCollection",void 0),_S(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,m=s-f,v=this.getFarthestCollection(e,n,r,i);if(v){if(r==="down"){const S=v.row+v.rowspan-a-m;o[2]+S>=this.plugin.hot.countRows()?o[2]-=m:o[2]+=m?S:0}else if(r==="right"){const S=v.col+v.colspan-l-m;o[3]+S>=this.plugin.hot.countCols()?o[3]-=m:o[3]+=m?S:0}else if(r==="up"){const S=u-m-v.row+1;o[0]+S<0?o[0]+=m:o[0]-=m?S:0}else if(r==="left"){const S=c-m-v.col+1;o[1]+S<0?o[1]+=m:o[1]-=m?S:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),tn(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,m=Math.floor(d/f)*f,v=d-m;let S=null,R=null,w=null;switch(r){case"up":S="includesVertically",w=c-v+1;break;case"left":S="includesHorizontally",w=c-v+1;break;case"down":S="includesVertically",w=h+v-1;break;case"right":S="includesHorizontally",w=h+v-1;break}return P(i,_=>{_[S](w)&&_.isFarther(R,r)&&(R=_)}),R}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return P(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(m=>{let{colspan:v}=m;return v===h.getWidth()}):!f.every(m=>{let{rowspan:v}=m;return v===h.getHeight()})}}function MS(t,e,n){return(e=roe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function roe(t){var e=ioe(t,"string");return typeof e=="symbol"?e:e+""}function ioe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ooe{constructor(e){MS(this,"plugin",void 0),MS(this,"hot",void 0),MS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function soe(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(kE)}return this.getTranslatedPhrase(DE)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?to.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Fh(t,e,n){return(e=aoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aoe(t){var e=loe(t,"string");return typeof e=="symbol"?e:e+""}function loe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AA{constructor(e){Fh(this,"data",void 0),Fh(this,"next",null),Fh(this,"prev",null),this.data=e}}class rg{constructor(){Fh(this,"first",null),Fh(this,"last",null)}push(e){const n=new AA(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new AA(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function uoe(t,e){L$(t,e),e.add(t)}function $a(t,e,n){L$(t,e),e.set(t,n)}function L$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function et(t,e){return t.get(xm(t,e))}function Cr(t,e,n){return t.set(xm(t,e),n),n}function xm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zi=new WeakMap,Yi=new WeakMap,Gi=new WeakMap,qi=new WeakMap,Xb=new WeakMap,ig=new WeakMap,og=new WeakMap,IS=new WeakSet;class coe{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;uoe(this,IS),$a(this,zi,new rg),$a(this,Yi,new rg),$a(this,Gi,null),$a(this,qi,null),$a(this,Xb,null),$a(this,ig,null),$a(this,og,null),Cr(Xb,this,n),Cr(ig,this,r),Cr(og,this,i)}getCurrentVerticalNode(){return et(qi,this).data}getFirstVerticalNode(){return et(Yi,this).first.data}getNextVerticalNode(){return et(qi,this).next.data}getPrevVerticalNode(){return et(qi,this).prev.data}getCurrentHorizontalNode(){return et(Gi,this).data}getFirstHorizontalNode(){return et(zi,this).first.data}getNextHorizontalNode(){return et(Gi,this).next.data}getPrevHorizontalNode(){return et(Gi,this).prev.data}setPrevNodeAsActive(){Cr(qi,this,et(qi,this).prev),Cr(Gi,this,et(Gi,this).prev)}setNextNodeAsActive(){Cr(qi,this,et(qi,this).next),Cr(Gi,this,et(Gi,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;Cr(zi,this,new rg);for(let s=n.row;s<=r.row;s++)if(!et(ig,this).isHidden(s))for(let a=n.col;a<=r.col;a++){if(et(og,this).isHidden(a))continue;const l=xm(IS,this,NA).call(this,e,et(zi,this),i,s,a);l&&Cr(Gi,this,l)}et(zi,this).first&&(et(zi,this).first.prev=et(zi,this).last,et(zi,this).last.next=et(zi,this).first);const o=new WeakSet;Cr(Yi,this,new rg);for(let s=n.col;s<=r.col;s++)if(!et(og,this).isHidden(s))for(let a=n.row;a<=r.row;a++){if(et(ig,this).isHidden(a))continue;const l=xm(IS,this,NA).call(this,e,et(Yi,this),o,a,s);l&&Cr(qi,this,l)}et(Yi,this).first&&(et(Yi,this).first.prev=et(Yi,this).last,et(Yi,this).last.next=et(Yi,this).first)}setActiveNode(e,n){return et(zi,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Cr(Gi,this,r),!1}),et(Yi,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Cr(qi,this,r),!1}),this}}function NA(t,e,n,r,i){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=et(Xb,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function $$(t,e,n){const{rowIndexMapper:r,stylesHandler:i}=t,o=i.getDefaultRowHeight();let s=0;for(let l=e;l<e+n;l++)if(!r.isHidden(l)){var a;s+=(a=t.getRowHeight(l))!==null&&a!==void 0?a:o,l===0&&!i.isClassicTheme()&&(s+=1)}return s}function hoe(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!Ae(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),Yh()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:m}=c,[v,S]=t.translateMergedCellToRenderable(h,m,d,f),R=t.getSetting("virtualized");if(Yh()&&d===0&&!e.getSettings().rowHeaders){const A=$$(e,h,m);i.set(l,A/m)}const w=n.getRenderableFromVisualIndex(l),_=r.getRenderableFromVisualIndex(u),O=v-w+1,L=S-_+1;let M=n.getNearestNotHiddenIndex(h,1),x=r.getNearestNotHiddenIndex(d,1);if(R){const A=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(A)||(M=Math.max(M,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(A)||(x=Math.max(x,e.getFirstRenderedVisibleColumn()))}const z=Math.min(m,O),q=Math.min(f,L);M===l&&x===u?(a.setAttribute("rowspan",z),a.setAttribute("colspan",q)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function doe(t,e){F$(t,e),e.add(t)}function sg(t,e,n){F$(t,e),e.set(t,n)}function F$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PS(t,e,n){return(e=foe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function foe(t){var e=goe(t,"string");return typeof e=="symbol"?e:e+""}function goe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ad(t,e,n){return t.set(rt(t,e),n),n}function ft(t,e){return t.get(rt(t,e))}function rt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("beforeMergeCells");ne.getSingleton().register("afterMergeCells");ne.getSingleton().register("beforeUnmergeCells");ne.getSingleton().register("afterUnmergeCells");const Zb="mergeCells",moe=150,DA=Zb;var qr=new WeakMap,Kr=new WeakMap,ao=new WeakMap,kA=new WeakMap,lt=new WeakSet;class poe extends Ke{constructor(){super(...arguments),doe(this,lt),PS(this,"mergedCellsCollection",null),PS(this,"autofillCalculations",null),PS(this,"selectionCalculations",null),sg(this,qr,null),sg(this,Kr,{row:0,col:0}),sg(this,ao,new coe({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),sg(this,kA,hoe(this))}static get PLUGIN_KEY(){return Zb}static get PLUGIN_PRIORITY(){return moe}static get DEFAULT_SETTINGS(){return{[iL]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[Zb]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Om(this),this.autofillCalculations=new noe(this),this.selectionCalculations=new ooe(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,woe).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,Coe).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,yoe).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,Soe).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,boe).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,$A).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,$A).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,Eoe).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,Toe).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,_oe).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,LA).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,LA).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,voe).call(e,...r)}),this.addHook("afterRenderer",function(){return ft(kA,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,Roe).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,Moe).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,Ioe).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,Poe).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,Ooe).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,xoe).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,Hoe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,Aoe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,Noe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,Doe).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,koe).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,Loe).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,$oe).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,Foe).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rt(lt,e,Voe).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!GN())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>o?.name==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=Qg(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=Qg(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?to.containsNegativeValues(e)?(qe(to.NEGATIVE_VALUES_WARNING(e)),!1):to.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(qe(to.IS_OUT_OF_BOUNDS_WARNING(e)),!1):to.isSingleCell(e)?(qe(to.IS_SINGLE_CELL(e)),!1):to.containsZeroSpan(e)?(qe(to.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),he(0,s.rowspan-1,c=>{he(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),P(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),he(0,i.rowspan-1,o=>{he(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:DA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(DA)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Ae(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Ae(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Ae(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Ae(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function woe(){this.generateFromSettings(),this.hot.render()}function voe(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function Coe(t){ft(Kr,this).row=t.row,ft(Kr,this).col=t.col}function yoe(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;ft(qr,this)&&(i.getRenderableFromVisualIndex(ft(qr,this).row)!==null&&(n.row=ft(qr,this).row),r.getRenderableFromVisualIndex(ft(qr,this).col)!==null&&(n.col=ft(qr,this).col),ad(qr,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function Soe(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function boe(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){ad(qr,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);ad(qr,this,e.clone()),n&&e.assign(n)}function LA(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),m=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),v=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[Be(m,u,h),Be(v,c,d),Be(this.hot.getLastRenderedVisibleRow(),u,h),Be(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function Roe(t){t.items.push({name:"---------"},soe(this))}function $A(){ad(qr,this,null)}function Eoe(){if(ft(qr,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=ft(qr,this).clone().normalize();ft(ao,this).setActiveNode(r.row,r.col),ft(Kr,this).row>0||ft(Kr,this).col>0?ft(ao,this).setPrevNodeAsActive():(n==="E-W"&&ft(Kr,this).col<0||e==="S-N"&&ft(Kr,this).row<0)&&ft(ao,this).setNextNodeAsActive()}function Toe(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(ft(Kr,this).col<0){const{rowEnd:a,colEnd:l}=ft(ao,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(ft(Kr,this).col>0){const{rowStart:a,colStart:l}=ft(ao,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}else if(ft(Kr,this).row<0){const{rowEnd:a,colEnd:l}=ft(ao,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(ft(Kr,this).row>0){const{rowStart:a,colStart:l}=ft(ao,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}ft(ao,this).setActiveNode(t,e),ad(Kr,this,{row:0,col:0})}function _oe(){this.hot.getSelectedRangeLast().isHeader()||ft(ao,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function Moe(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function Ioe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Poe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Ooe(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function xoe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Hoe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Aoe(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Noe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Doe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function koe(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);P(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function Loe(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function $oe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Foe(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function Voe(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:m}=f;return Math.max(d,m)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,m=0;n==="top"||n==="top_inline_start_corner"?m=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):m=f-h,t=Math.max(t??0,$$(this.hot,e,m))}),t}function Woe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,m=(d.compareFunctionFactory?d.compareFunctionFactory:mL(u.type))(l,u,d)(c,h);if(m===uo){const v=a+1;if(typeof e[v]<"u")return s(v)}return m}(0)}}const V$="sort";function Boe(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${V$}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function joe(t){const e=t.className.split(" "),n=new RegExp(`^${V$}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function Uoe(t,e,n){return(e=zoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zoe(t){var e=Yoe(t,"string");return typeof e=="symbol"?e:e+""}function Yoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Hm="multiColumnSorting",Goe=170,FA=Hm;gL(Hm,Woe);class qoe extends EL{constructor(){super(...arguments),Uoe(this,"pluginKey",Hm)}static get PLUGIN_KEY(){return Hm}static get PLUGIN_PRIORITY(){return Goe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,fm)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:na,position:"before",group:FA})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(FA)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),pe(e,joe(e)),this.enabled!==!1&&G(e,Boe(...r))}onAfterOnCellMouseDown(e,n){hT(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,fm))):this.sort(this.getColumnNextConfig(n.col)))}}function VA(t,e,n){return(e=Koe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Koe(t){var e=Xoe(t,"string");return typeof e=="symbol"?e:e+""}function Xoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Zoe="multipleSelectionHandles",Qoe=160;class Joe extends Ke{constructor(){super(...arguments),VA(this,"dragged",[]),VA(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Zoe}static get PLUGIN_PRIORITY(){return Qoe}isEnabled(){return lo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(Ce(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(Ce(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(Ce(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Ce(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function Qb(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function W$(){return{label:"",isPlaceholder:!0}}function ese(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;P(t,i=>{const o=[];let s=0;n.push(o),P(i,a=>{const l=Qb();if(Ae(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=It(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=It(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(W$());return!u})});const r=Math.max(...Ve(n,i=>i.length));return P(n,i=>{if(i.length<r){const o=Ve(new Array(r-i.length),()=>Qb());i.splice(i.length,0,...o)}}),n}function OS(t,e,n){tse(t,e),e.set(t,n)}function tse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function di(t,e){return t.get(B$(t,e))}function rh(t,e,n){return t.set(B$(t,e),n),n}function B$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const WA=["label","collapsible"];var Ho=new WeakMap,Fa=new WeakMap,xS=new WeakMap;class nse{constructor(){OS(this,Ho,[]),OS(this,Fa,0),OS(this,xS,1/0)}setColumnsLimit(e){rh(xS,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];rh(Ho,this,ese(e,di(xS,this))),rh(Fa,this,di(Ho,this).length)}getData(){return di(Ho,this)}mergeWith(e){P(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&tn(s,o,WA)})}map(e){P(di(Ho,this),n=>{P(n,r=>{const i=e({...r});Ae(i)&&tn(r,i,WA)})})}getHeaderSettings(e,n){var r;if(e>=di(Fa,this)||e<0)return null;const i=di(Ho,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=di(Fa,this)||e<0)return i;const o=di(Ho,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return di(Fa,this)}getColumnsCount(){return di(Fa,this)>0?di(Ho,this)[0].length:0}clear(){rh(Ho,this,[]),rh(Fa,this,0)}}function HS(t,e,n){return(e=rse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rse(t){var e=ise(t,"string");return typeof e=="symbol"?e:e+""}function ise(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const j$="DF-pre-order";function U$(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=U$.call(this.childs[r],t,e)}return n}const ose="DF-post-order";function z$(t,e){for(let n=0;n<this.childs.length;n++)if(z$.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const Y$="BF";function sse(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const ase=Y$,BA=new Map([[j$,U$],[ose,z$],[Y$,sse]]);class Am{constructor(e){HS(this,"data",{}),HS(this,"parent",null),HS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new Am({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ase;if(!BA.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);BA.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function AS(t,e,n){lse(t,e),e.set(t,n)}function lse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fn(t,e){return t.get(G$(t,e))}function use(t,e,n){return t.set(G$(t,e),n),n}function G$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var su=new WeakMap,Va=new WeakMap,au=new WeakMap;class cse{constructor(e){AS(this,su,new Map),AS(this,Va,new Map),AS(this,au,null),use(au,this,e)}getRoots(){return Array.from(Fn(su,this).values())}getRootByColumn(e){let n;return Fn(Va,this).has(e)&&(n=Fn(su,this).get(Fn(Va,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-Fn(Va,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;Fn(Va,this).clear(),P(Fn(su,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)Fn(Va,this).set(i,e);e+=r})}buildTree(){this.clear();const e=Fn(au,this).getColumnsCount();let n=0;for(;n<e;){const r=Fn(au,this).getHeaderSettings(0,n),i=new Am;Fn(su,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=Fn(au,this).getHeadersSettings(r,n,i);r+=1,P(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new Am(a),e.addChild(l)),r<Fn(au,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){Fn(su,this).clear(),Fn(Va,this).clear()}}function q$(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function Nm(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function Dm(t){return Nm(t,"origColspan")===t.data.origColspan}function _T(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Dm(t))return _T(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)P(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,q$(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Dm(a)&&(l.isCollapsed=Nm(a,"isCollapsed"))}),{rollbackModification:()=>MT(t),affectedColumns:Array.from(o),colspanCompensation:s}}function MT(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Dm(t))return MT(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)P(o,l=>{q$(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=Nm(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Dm(l)&&(u.isCollapsed=Nm(l,"isCollapsed"))}),{rollbackModification:()=>_T(t),affectedColumns:Array.from(s),colspanCompensation:a}}function hse(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(tt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function dse(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(tt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const jA=new Map([["collapse",MT],["expand",_T],["hide-column",hse],["show-column",dse]]);function fse(t,e,n){if(!jA.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return jA.get(t)(e,n)}function ag(t){const e=[];return P(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=mse(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(W$());else{const f=gse(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function gse(t){const{crossHiddenColumns:e,...n}=Qb(t);return n}function mse(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function NS(t,e,n){pse(t,e),e.set(t,n)}function pse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ih(t,e,n){return t.set(K$(t,e),n),n}function Ot(t,e){return t.get(K$(t,e))}function K$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ki=new WeakMap,rr=new WeakMap,Wa=new WeakMap;class wse{constructor(){NS(this,Ki,new nse),NS(this,rr,new cse(Ot(Ki,this))),NS(this,Wa,[[]])}setState(e){Ot(Ki,this).setData(e);let n=!1;try{Ot(rr,this).buildTree()}catch{Ot(rr,this).clear(),Ot(Ki,this).clear(),n=!0}return ih(Wa,this,ag(Ot(rr,this).getRoots())),n}setColumnsLimit(e){Ot(Ki,this).setColumnsLimit(e)}mergeStateWith(e){const n=Ve(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Ot(Ki,this).mergeWith(n),Ot(rr,this).buildTree(),ih(Wa,this,ag(Ot(rr,this).getRoots()))}mapState(e){Ot(Ki,this).map(e),Ot(rr,this).buildTree(),ih(Wa,this,ag(Ot(rr,this).getRoots()))}mapNodes(e){return pr(Ot(rr,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Ot(rr,this).getNode(n,r);let o;return i&&(o=fse(e,i,r),ih(Wa,this,ag(Ot(rr,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Ot(Wa,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Ot(rr,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=Ot(rr,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},j$)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Ot(Ki,this).getLayersCount()}getColumnsCount(){return Ot(Ki,this).getColumnsCount()}clear(){ih(Wa,this,[]),Ot(Ki,this).clear(),Ot(rr,this).clear()}}function oh(t,e,n){return(e=vse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vse(t){var e=Cse(t,"string");return typeof e=="symbol"?e:e+""}function Cse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yse{constructor(e,n){oh(this,"hot",void 0),oh(this,"nestedHeaderSettingsGetter",void 0),oh(this,"layersCount",0),oh(this,"container",void 0),oh(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let m=f.label;s&&(m+='<button class="changeType"></button>'),Ju(d,m),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function Sse(t,e){X$(t,e),e.add(t)}function UA(t,e,n){return(e=bse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bse(t){var e=Rse(t,"string");return typeof e=="symbol"?e:e+""}function Rse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sh(t,e,n){X$(t,e),e.set(t,n)}function X$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xo(t,e,n){return t.set(xt(t,e),n),n}function Le(t,e){return t.get(xt(t,e))}function xt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zA="nestedHeaders",Ese=280;var ot=new WeakMap,_s=new WeakMap,Vh=new WeakMap,kp=new WeakMap,km=new WeakMap,Lt=new WeakSet;class Tse extends Ke{constructor(){super(...arguments),Sse(this,Lt),sh(this,ot,new wse),sh(this,_s,null),sh(this,Vh,null),sh(this,kp,!1),sh(this,km,null),UA(this,"ghostTable",new yse(this.hot,(e,n)=>this.getHeaderSettings(e,n))),UA(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return zA}static get PLUGIN_PRIORITY(){return Ese}isEnabled(){return!!this.hot.getSettings()[zA]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&qe(tt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>xt(Lt,this,Wse).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,Bse).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,Pse).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,Ose).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,xse).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,Hse).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,Ase).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,Nse).call(e,...i)}),this.addHook("afterSelection",()=>xt(Lt,this,lg).call(this)),this.addHook("afterSelectionFocusSet",()=>xt(Lt,this,lg).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,_se).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>xt(Lt,this,kse).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,$se).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,Fse).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,Mse).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,Ise).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,Dse).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,Lse).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return xt(Lt,e,Vse).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>xt(Lt,this,lg).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>xt(Lt,this,lg).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Le(ot,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Le(ot,this).setState(e)),this.detectedOverlappedHeaders&&qe(tt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";Le(ot,this).triggerColumnModification(i,r)}),!Le(_s,this)&&this.enabled&&Xo(_s,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";Le(ot,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Le(ot,this).clear(),Le(_s,this).unsubscribe(),Xo(_s,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Le(ot,this)}getLayersCount(){return Le(ot,this).getLayersCount()}getHeaderSettings(e,n){return Le(ot,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),pe(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),pe(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),pe(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),pe(o,"hiddenHeader"),pe(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=Le(ot,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)G(o,"hiddenHeader");else if(c>1){var m,v,S;const{wtOverlays:R}=l._wt,w=(m=R.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(o),_=(v=R.inlineStartOverlay)===null||v===void 0?void 0:v.clone.wtTable.THEAD.contains(o);((S=R.topOverlay)===null||S===void 0?void 0:S.clone.wtTable.THEAD.contains(o))&&u<r&&G(o,"hiddenHeaderText");const L=w||_?Math.min(c,r-i):c;L>1&&o.setAttribute("colspan",L)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const R=o.querySelector("div.relative");R&&f&&f.length>0&&(pe(R,this.hot.getColumnMeta(u).headerClassName),G(R,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=Le(ot,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){Xo(ot,this,null),Le(_s,this)!==null&&(Le(_s,this).unsubscribe(),Xo(_s,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Le(ot,this).getHeaderTreeNodeData(e.row,e.col)}}function lg(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=Le(ot,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function _se(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=Le(km,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if(Xo(km,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=Le(ot,this).findLeftMostColumnIndex(a,l),m=Le(ot,this).findRightMostColumnIndex(a,l),v=m-f+1;if(f<c&&m>h)return f;if(s){let S=null;return f>=c&&m>h?v>d?(e.value="start",S=f):(e.value="end",S=m):f<c&&m<=h&&(v>d?(e.value="end",S=m):(e.value="start",S=f)),S}return f<=c?f:m}function Mse(t,e,n){const r=Le(ot,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=Le(ot,this).getHeaderSettings(e,t);if(o===nE){if(!a)return r.columnIndex}else if(o===DD&&(l>s-i||!a))return null;return t}function Ise(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const m=c+f,v=d-a;if(v===0)continue;((i=Le(ot,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[m][v]="")}}}function Pse(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function Ose(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Xo(Vh,this,e.clone()),Xo(kp,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(zR(t)||al(t)&&l||Kz(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function xse(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=Be(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function Hse(){Xo(kp,this,!1)}function Ase(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Le(kp,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=Le(ot,this).getHeaderTreeNodeData(Le(Vh,this).row,Le(Vh,this).col);if(e.setHighlight(Le(Vh,this)),o>e.getWidth()||i<n||i+o-1>r){const s=Le(ot,this).findTopMostEntireHeaderLevel(Be(n,i,i+o-1),Be(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function Nse(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=Le(ot,this).findLeftMostColumnIndex(n.row,n.col),o=Le(ot,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Dse(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});Xo(km,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function kse(t){if(Le(ot,this).getLayersCount()>0){t.length=0;for(let e=0;e<Le(ot,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function Lse(t){const e=Le(ot,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=Le(ot,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),zn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?Le(ot,this).getHeaderTreeNodeData(0,n).columnIndex:n}function $se(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Fse(t,e,n){var r;const{label:i}=(r=Le(ot,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Vse(t,e){if(t<0)return this.hot.getCell(t,Le(ot,this).findLeftMostColumnIndex(t,e),!0)}function Wse(){this.updatePlugin()}function Bse(t,e){e||this.updatePlugin()}function ah(t,e,n){return(e=jse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jse(t){var e=Use(t,"string");return typeof e=="symbol"?e:e+""}function Use(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zse{constructor(e,n){ah(this,"hot",void 0),ah(this,"data",null),ah(this,"plugin",void 0),ah(this,"parentReference",new WeakMap),ah(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},he(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&P(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&P(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ne(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(P(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(he(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),he(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),m=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",m+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];P(r,o=>{i.push(this.getDataObject(o))}),P(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function YA(t,e,n){return(e=Yse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yse(t){var e=Gse(t,"string");return typeof e=="symbol"?e:e+""}function Gse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IT{constructor(e,n){YA(this,"hot",void 0),YA(this,"plugin",void 0),this.hot=n,this.plugin=e}}class ro extends IT{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(P(l,c=>{c&&s.removeChild(c)}),G(n,ro.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",he(0,i-1,()=>{const d=c.createElement("SPAN");G(d,ro.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&ve(c,[yl()]),G(n,ro.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(G(c,`${ro.CSS_CLASSES.button} ${ro.CSS_CLASSES.expandButton}`),u&&ve(n,[Xr(!1)])):(G(c,`${ro.CSS_CLASSES.button} ${ro.CSS_CLASSES.collapseButton}`),u&&ve(n,[Xr(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);let r=11;this.hot.stylesHandler.isClassicTheme()||(r=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,r+10*n+25),this.hot.render()}}class qse extends IT{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),P(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{he(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&P(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];P(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return P(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);P(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return P(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);P(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&P(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];P(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];P(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];P(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{P(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{P(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&P(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);Ce(e.target,ro.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Hi(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function Kse(t,e,n){Xse(t,e),e.set(t,n)}function Xse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zse(t,e,n){return(e=Qse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qse(t){var e=Jse(t,"string");return typeof e=="symbol"?e:e+""}function Jse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eae(t,e){return t.get(tae(t,e))}function tae(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var GA=new WeakMap;class nae extends IT{constructor(){super(...arguments),Zse(this,"dataManager",this.plugin.dataManager),Kse(this,GA,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(t0)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(n0)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return he(0,e.items.length-1,r=>{if(r===0)return P(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return he(0,e.items.length-1,n=>{const r=eae(GA,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function ug(t,e,n){return(e=rae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rae(t){var e=iae(t,"string");return typeof e=="symbol"?e:e+""}function iae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oae{constructor(e){ug(this,"plugin",void 0),ug(this,"hot",void 0),ug(this,"dataManager",void 0),ug(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(m=>{if(!l)return!1;const v=this.dataManager.translateTrimmedRow(m);return l=this.shouldAllowMoving(v,a),v}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Mt(i)&&(qe(tt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function sae(t,e){Z$(t,e),e.add(t)}function qA(t,e,n){Z$(t,e),e.set(t,n)}function Z$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DS(t,e,n){return(e=aae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aae(t){var e=lae(t,"string");return typeof e=="symbol"?e:e+""}function lae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wg(t,e){return t.get(hn(t,e))}function Lm(t,e,n){return t.set(hn(t,e),n),n}function hn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const $m="nestedRows",uae=300,KA=$m,cae="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Lp=new WeakMap,lu=new WeakMap,wn=new WeakSet;class hae extends Ke{constructor(){super(...arguments),sae(this,wn),DS(this,"dataManager",null),DS(this,"headersUI",null),DS(this,"collapsedRowsMap",null),qA(this,Lp,!1),qA(this,lu,!1)}static get PLUGIN_KEY(){return $m}static get PLUGIN_PRIORITY(){return uae}isEnabled(){return!!this.hot.getSettings()[$m]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Td),this.dataManager=new zse(this,this.hot),this.collapsingUI=new qse(this,this.hot),this.headersUI=new ro(this,this.hot),this.contextMenuUI=new nae(this,this.hot),this.rowMoveController=new oae(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(wn,e,Tae).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(wn,e,_ae).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(wn,e,gae).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(wn,e,mae).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(wn,e,pae).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(wn,e,fae).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(wn,e,Cae).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(wn,e,vae).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(wn,e,yae).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(wn,e,Sae).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(wn,e,bae).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(wn,e,Rae).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(wn,e,wae).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(wn,e,Eae).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(wn,e,dae).call(e,...r)}),this.addHook("beforeLoadData",n=>hn(wn,this,XA).call(this,n)),this.addHook("beforeUpdateData",n=>hn(wn,this,XA).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:KA,relativeToGroup:na,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(KA)}disableCoreAPIModifiers(){Lm(lu,this,!0)}enableCoreAPIModifiers(){Lm(lu,this,!1)}onModifyRowData(e){if(!Wg(lu,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Wg(lu,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return Wg(lu,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function dae(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function fae(t,e,n){this.collapsingUI.toggleState(t,e,n)}function gae(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),Lm(Lp,this,!0),this.dataManager.getData().slice()}function mae(t){return this.contextMenuUI.appendOptions(t)}function pae(t,e){this.headersUI.appendLevelIndicators(t,e)}function wae(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function vae(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{Lm(Lp,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Cae(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function yae(){this.collapsingUI.collapsedRowsStash.stash()}function Sae(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function bae(){this.collapsingUI.collapsedRowsStash.stash()}function Rae(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Eae(){this.dataManager.rewriteCache()}function Tae(){this.headersUI.updateRowHeaderWidth()}function _ae(t,e){Wg(Lp,this)&&(e.skipRender=!0)}function XA(t){if(!rK(t)){YR(cae),this.hot.getSettings()[$m]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function kS(t,e,n){return(e=Mae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mae(t){var e=Iae(t,"string");return typeof e=="symbol"?e:e+""}function Iae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pae{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;kS(this,"rootWindow",void 0),kS(this,"prefix",void 0),kS(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){P(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function Oae(t,e,n){return(e=xae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xae(t){var e=Hae(t,"string");return typeof e=="symbol"?e:e+""}function Hae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}ne.getSingleton().register("persistentStateSave");ne.getSingleton().register("persistentStateLoad");ne.getSingleton().register("persistentStateReset");const ZA="persistentState",Aae=0;class Nae extends Ke{constructor(){super(...arguments),Oae(this,"storage",void 0)}static get PLUGIN_KEY(){return ZA}static get PLUGIN_PRIORITY(){return Aae}isEnabled(){return!!this.hot.getSettings()[ZA]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Pae(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Dae(t,e){kae(t,e),e.add(t)}function kae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LS(t,e,n){return(e=Lae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lae(t){var e=$ae(t,"string");return typeof e=="symbol"?e:e+""}function $ae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const $S="search",Fae=190,Vae="htSearchResult",Wae=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},Bae=function(t,e,n){return Mt(t)||t===null||!t.toLocaleLowerCase||t.length===0||Mt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var FS=new WeakSet;class jae extends Ke{constructor(){super(...arguments),Dae(this,FS),LS(this,"callback",Wae),LS(this,"queryMethod",Bae),LS(this,"searchResultClass",Vae)}static get PLUGIN_KEY(){return $S}static get PLUGIN_PRIORITY(){return Fae}isEnabled(){return this.hot.getSettings()[$S]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[$S];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return QA(FS,e,JA).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return QA(FS,e,JA).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return he(0,i-1,l=>{he(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,m=(h.search.queryMethod||r)(e,c,h);if(m){const v={row:l,col:u,data:c};s.push(v)}d&&d(a,l,u,c,m)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Ae(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function JA(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function cg(t,e,n){return(e=Uae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uae(t){var e=zae(t,"string");return typeof e=="symbol"?e:e+""}function zae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Q${constructor(e){cg(this,"viewportWidth",void 0),cg(this,"overwriteColumnWidthFn",void 0),cg(this,"baseWidths",new Map),cg(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class Yae extends Q${calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),m=this.overwriteColumnWidthFn(f,d);f===m&&f>=$u?(i.push([d,m]),a+=m):f!==m&&(i.push([d,m]),o.push(d),s-=m)}),s<=$u){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,m]=h,v=m;o.includes(f)||(v=Math.round(m*l)),this.stretchedWidths.set(f,v),u=f,d<i.length-1&&(c+=v)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function e1(t,e,n){Gae(t,e),e.set(t,n)}function Gae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VS(t,e){return t.get(J$(t,e))}function hg(t,e,n){return t.set(J$(t,e),n),n}function J$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dg=new WeakMap,lh=new WeakMap;class qae extends Q${constructor(){super(...arguments),e1(this,dg,0),e1(this,lh,-1)}prepare(e){super.prepare(e),hg(dg,this,0),hg(lh,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),hg(lh,this,e),hg(dg,this,n)}calculate(){if(VS(lh,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+VS(dg,this),0);this.stretchedWidths.set(VS(lh,this),n)}}function Kae(t,e){eF(t,e),e.add(t)}function fg(t,e,n){eF(t,e),e.set(t,n)}function eF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $t(t,e){return t.get(_u(t,e))}function WS(t,e,n){return t.set(_u(t,e),n),n}function _u(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Xae="stretchColumns";var On=new WeakMap,uu=new WeakMap,BS=new WeakMap,gg=new WeakMap,uh=new WeakSet;class Zae{constructor(e){Kae(this,uh),fg(this,On,void 0),fg(this,uu,void 0),fg(this,BS,new Map([["all",new Yae(_u(uh,this,t1).bind(this))],["last",new qae(_u(uh,this,t1).bind(this))]])),fg(this,gg,"none"),WS(On,this,e),WS(uu,this,$t(On,this).columnIndexMapper.createAndRegisterIndexMap(Xae,"physicalIndexToValue"))}useStrategy(e){WS(gg,this,$t(BS,this).has(e)?e:"none")}refreshStretching(){if($t(gg,this)==="none"){$t(uu,this).clear();return}$t(On,this).batchExecution(()=>{$t(uu,this).clear();const e=$t(BS,this).get($t(gg,this));let r=$t(On,this).view.getViewportWidth();_u(uh,this,Qae).call(this)&&(r-=Cn($t(On,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<$t(On,this).countCols();i++)$t(On,this).columnIndexMapper.isHidden($t(On,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,_u(uh,this,Jae).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;$t(uu,this).setValueAtIndex($t(On,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return $t(uu,this).getValueAtIndex($t(On,this).toPhysicalColumn(e))}}function Qae(){const{view:t,stylesHandler:e}=$t(On,this);if(t.isVerticallyScrollableByWindow())return!1;const n=t.getViewportHeight(),r=$t(On,this).countRows(),i=e.getDefaultRowHeight();let o=0,s=!1;for(let l=0;l<r;l++){var a;if(o+=((a=$t(On,this).getRowHeight(l))!==null&&a!==void 0?a:i)+(l===0?1:0),o>n){s=!0;break}}return s}function Jae(t){var e;return(e=$t(On,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:$u}function t1(t,e){return $t(On,this).runHooks("beforeStretchingColumnWidth",t,e)}function ele(t,e){tF(t,e),e.add(t)}function jS(t,e,n){tF(t,e),e.set(t,n)}function tF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function US(t,e,n){return t.set(Fm(t,e),n),n}function $o(t,e){return t.get(Fm(t,e))}function Fm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const tle="stretchColumns",nle=155;var yu=new WeakMap,mg=new WeakMap,ch=new WeakMap,zS=new WeakSet;class rle extends Ke{constructor(){super(...arguments),ele(this,zS),jS(this,yu,new Zae(this.hot)),jS(this,mg,null),jS(this,ch,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;$o(mg,this)!==null&&$o(mg,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),US(mg,this,i.width)})})}))}static get PLUGIN_KEY(){return tle}static get PLUGIN_PRIORITY(){return nle}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||($o(yu,this).useStrategy(this.hot.getSettings().stretchH),$o(ch,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Fm(zS,e,ole).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Fm(zS,e,ile).call(e,...r)},10),super.enablePlugin())}updatePlugin(){$o(yu,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),$o(ch,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return $o(yu,this).getStretchedWidth(e)}destroy(){$o(ch,this).disconnect(),US(ch,this,null),US(yu,this,null),super.destroy()}}function ile(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function ole(t){t&&$o(yu,this).refreshStretching()}function sle(t,e){ale(t,e),e.add(t)}function ale(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pg(t,e,n){return(e=lle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lle(t){var e=ule(t,"string");return typeof e=="symbol"?e:e+""}function ule(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cle="touchScroll",hle=200;var wg=new WeakSet;class dle extends Ke{constructor(){super(...arguments),sle(this,wg),pg(this,"scrollbars",[]),pg(this,"clones",[]),pg(this,"lockedCollection",!1),pg(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return cle}static get PLUGIN_PRIORITY(){return hle}static get SETTING_KEYS(){return!0}isEnabled(){return YN()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>YS(wg,this,fle).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>YS(wg,this,gle).call(this)),this.addHook("afterMomentumScroll",()=>YS(wg,this,mle).call(this))}}function fle(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function gle(){this.freezeOverlays=!0,P(this.clones,t=>{G(t,"hide-tween")})}function mle(){this.freezeOverlays=!1,P(this.clones,t=>{pe(t,"hide-tween"),G(t,"show-tween")}),this.hot._registerTimeout(()=>{P(this.clones,t=>{pe(t,"show-tween")})},400),P(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function ple(t,e){wle(t,e),e.add(t)}function wle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vle(t,e,n){return(e=Cle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cle(t){var e=yle(t,"string");return typeof e=="symbol"?e:e+""}function yle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sle(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Bg="trimRows",ble=330;var n1=new WeakSet;class Rle extends Ke{constructor(){super(...arguments),ple(this,n1),vle(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Bg}static get PLUGIN_PRIORITY(){return ble}isEnabled(){return!!this.hot.getSettings()[Bg]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Td),this.trimmedRowsMap.addLocalHook("init",()=>Sle(n1,this,Ele).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Bg];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),P(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{P(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(P(e,l=>{o[l]=!1}),i=pr(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function Ele(){const t=this.hot.getSettings()[Bg];Array.isArray(t)&&this.hot.batchExecution(()=>{P(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function Tle(t,e,n){return(e=_le(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _le(t){var e=Mle(t,"string");return typeof e=="symbol"?e:e+""}function Mle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ii{constructor(e){Tle(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function vg(t,e,n){return(e=Ile(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ile(t){var e=Ple(t,"string");return typeof e=="symbol"?e:e+""}function Ple(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PT extends ii{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),vg(this,"stateBefore",void 0),vg(this,"range",void 0),vg(this,"type",void 0),vg(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new PT({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){P(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){Is(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function r1(t,e,n){return(e=Ole(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ole(t){var e=xle(t,"string");return typeof e=="symbol"?e:e+""}function xle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OT extends ii{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),r1(this,"columns",void 0),r1(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new OT({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),ET(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function i1(t,e,n){return(e=Hle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hle(t){var e=Ale(t,"string");return typeof e=="symbol"?e:e+""}function Ale(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xT extends ii{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),i1(this,"previousSortState",void 0),i1(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new xT({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function o1(t,e,n){return(e=Nle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nle(t){var e=Dle(t,"string");return typeof e=="symbol"?e:e+""}function Dle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HT extends ii{constructor(e){let{index:n,amount:r}=e;super("insert_col"),o1(this,"index",void 0),o1(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new HT({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function s1(t,e,n){return(e=kle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kle(t){var e=Lle(t,"string");return typeof e=="symbol"?e:e+""}function Lle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AT extends ii{constructor(e){let{index:n,amount:r}=e;super("insert_row"),s1(this,"index",void 0),s1(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new AT({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Cg(t,e,n){return(e=$le(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $le(t){var e=Fle(t,"string");return typeof e=="symbol"?e:e+""}function Fle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NT extends ii{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),Cg(this,"changes",void 0),Cg(this,"selected",void 0),Cg(this,"countCols",void 0),Cg(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new NT({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=qn(this.changes);for(let s=0,a=r.length;s<a;s++)r[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const r=qn(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function a1(t,e,n){return(e=Vle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vle(t){var e=Wle(t,"string");return typeof e=="symbol"?e:e+""}function Wle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DT extends ii{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),a1(this,"conditionsStack",void 0),a1(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new DT({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function Ble(t,e,n){return(e=jle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jle(t){var e=Ule(t,"string");return typeof e=="symbol"?e:e+""}function Ule(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kT extends ii{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),Ble(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new kT({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function nF(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return he(r,i,l=>{he(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Ao(t,e,n){return(e=zle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zle(t){var e=Yle(t,"string");return typeof e=="symbol"?e:e+""}function Yle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LT extends ii{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Ao(this,"index",void 0),Ao(this,"indexes",void 0),Ao(this,"data",void 0),Ao(this,"amount",void 0),Ao(this,"headers",void 0),Ao(this,"columnPositions",void 0),Ao(this,"rowPositions",void 0),Ao(this,"fixedColumnsStart",void 0),Ao(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return he(l.length-1,m=>{const v=[],S=l[m];he(u,c,R=>{v.push(S[e.toPhysicalColumn(R)])}),h.push(v)}),he(i-1,m=>{f.push(e.toPhysicalColumn(u+m))}),Array.isArray(e.getSettings().colHeaders)&&he(i-1,m=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+m)]||null)}),new LT({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:nF(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(Ve(this.data[c],o));const l=Ve(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),P(e.getSourceDataArray(),(c,h)=>{P(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&P(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function cu(t,e,n){return(e=Gle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gle(t){var e=qle(t,"string");return typeof e=="symbol"?e:e+""}function qle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $T extends ii{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),cu(this,"index",void 0),cu(this,"data",void 0),cu(this,"fixedRowsBottom",void 0),cu(this,"fixedRowsTop",void 0),cu(this,"rowIndexesSequence",void 0),cu(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=qn(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new $T({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:nF(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function l1(t,e,n){return(e=Kle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kle(t){var e=Xle(t,"string");return typeof e=="symbol"?e:e+""}function Xle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FT extends ii{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),l1(this,"rows",void 0),l1(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new FT({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),ET(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function Zle(t,e,n){return(e=Qle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qle(t){var e=Jle(t,"string");return typeof e=="symbol"?e:e+""}function Jle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VT extends ii{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),Zle(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new VT({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function eue(t,e){[PT,OT,xT,HT,AT,NT,DT,kT,LT,$T,FT,VT].forEach(n=>n.startRegisteringEvents(t,e))}function tue(t,e){nue(t,e),e.add(t)}function nue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GS(t,e,n){return(e=rue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rue(t){var e=iue(t,"string");return typeof e=="symbol"?e:e+""}function iue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const u1="undoRedo",oue="undoRedo",sue=1e3;ne.getSingleton().register("beforeUndo");ne.getSingleton().register("afterUndo");ne.getSingleton().register("beforeRedo");ne.getSingleton().register("afterRedo");const c1=new Set;var yg=new WeakSet;class aue extends Ke{static get PLUGIN_KEY(){return oue}static get PLUGIN_PRIORITY(){return sue}static get SETTING_KEYS(){return!0}constructor(e){super(e),tue(this,yg),GS(this,"doneActions",[]),GS(this,"undoneActions",[]),GS(this,"ignoreNewActions",!1),eue(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qS(yg,e,lue).call(e,...r)}),this.registerShortcuts(),qS(yg,this,uue).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),qS(yg,this,cue).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:u1};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(u1)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=qn(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=qn(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function lue(t,e){e==="loadData"&&this.clear()}function uue(){const t=e=>{c1.has(e)||(qe(tt`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),c1.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function cue(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function hue(){je(Th),je(_7),je(_h),je(r5),je(h5),je(EL),je(sZ),je(UZ),je(Op),je(QQ),je(EJ),je(HJ),je(Ap),je(gee),je(une),je(Bne),je(mre),je(Mre),je(Fre),je(Xre),je(sie),je(Eie),je(Aie),je(poe),je(qoe),je(Joe),je(Tse),je(hae),je(Nae),je(jae),je(rle),je(dle),je(Rle),je(aue)}function Oue(){X6(),C8(),I8(),q8(),hue()}export{w6 as H,Oue as r};
