const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DR2AJDfj.js","assets/index-CvT5YaSg.js","assets/index-Bxn7MviP.css","assets/createSvgIcon-CVbHwdI_.js","assets/useControlled-IYaOVZhp.js","assets/ownerWindow-DvT1GKkC.js","assets/isMuiElement-DWhK3728.js","assets/fireDatabase-V756jICp.js","assets/fireStorage-KtnmbIfI.js","assets/SinyDate-DASoKPnH.js","assets/Grid-C9y34BYf.js","assets/useTheme-DFlWa2Mk.js","assets/index-BAiSu5QZ.js","assets/Typography-CHb_Yaam.js","assets/Menu-BLVqlSbS.js","assets/useSlotProps-BlJXSYDE.js","assets/resolveComponentProps-Op5Zu1FD.js","assets/IconButton-DIZWXFv9.js","assets/TextField-DYRK4ui4.js","assets/InputAdornment-OePoEkcC.js","assets/Popper-MB0Xb1qb.js","assets/Button-BL8t6y7w.js","assets/Chip-DTO5lcYH.js","assets/index.esm-BjAQZWJ4.js","assets/TwButton-Dlyxo1KU.js","assets/Loading-0EEKtlum.js","assets/Container-tgbpLRfl.js","assets/styled-CZC7bwuH.js","assets/CircularProgress-C4ffWbHS.js","assets/Divider-Bwjk2vy1.js","assets/dividerClasses-D1fPCAFU.js","assets/index-Cmdt2tIm.css","assets/MemoMain-CkJZ091Q.js"])))=>i.map(i=>d[i]);
import{r as Oe,a as _e,g as Ae,b as g,q as Ve,e as ht,o as bt,c as Be,f as We,d as vt,u as Z,j as s,h as ue,T as Nt,i as It,m as ke,_ as fe,k as E,l as yt,n as He,p as Ke,s as ze,t as Ue,v as qe,w as K,x as Ge,y as re,z as X,A as St,B as Ct,C as P,D as Ye,E as Ie,F as jt,H as Tt,G as he,I as Je,J as Qe,K as kt,L as wt,R as Et,M as ie}from"./index-CvT5YaSg.js";import{u as Dt}from"./useSuspenseQuery-CdFQGTyr.js";import{L as W}from"./Loading-0EEKtlum.js";import{g as Rt,S as Mt,T as $t}from"./index-DUp0-uXk.js";import{g as Pt,a as Lt,s as Ft,b as Ot,c as _t}from"./fireDatabase-V756jICp.js";import{r as Xe}from"./createSvgIcon-CVbHwdI_.js";import{D as At}from"./DndProvider-CwKNg52d.js";import{D as O}from"./Divider-Bwjk2vy1.js";import{L as Vt}from"./Link-CDtkXzdW.js";import{T as H}from"./Typography-CHb_Yaam.js";import{T as Bt}from"./TwInput-Dod_gj7Y.js";import{T as de}from"./TwButton-Dlyxo1KU.js";import{T as Wt}from"./Footer-BzN4yNqc.js";import{L as ae,a as Ht}from"./LinkItem-CPuYx88B.js";import{u as Kt}from"./useSlotProps-BlJXSYDE.js";import{o as Ze}from"./ownerWindow-DvT1GKkC.js";import{u as zt}from"./useTheme-DFlWa2Mk.js";import{C as et}from"./Collapse-aqi46JjZ.js";import{F as Ut}from"./Favorite-CyfOfJQ_.js";import{u as tt,a as ot,F as qt,f as Gt,b as Yt,D as Jt,l as Qt,I as Xt,c as we,d as Ee,e as Zt}from"./index-DR2AJDfj.js";import{A as B}from"./AniButton-Co6JiSmW.js";import{M as eo}from"./Menu-BLVqlSbS.js";import{S as to}from"./SinyImageList-CVKwgmP5.js";import{H as nt}from"./HtmlCode-hNbsvGm4.js";import{c as oo}from"./CodeText-q5M8sHdK.js";import{s as st}from"./commonUtil-BVvWhpjp.js";import{I as no}from"./IconButton-DIZWXFv9.js";import{C as so}from"./CircularProgress-C4ffWbHS.js";import{u as lo}from"./useWindowDimensions-DFaRtNkh.js";import{D as ro}from"./datetime-BDx6lZXm.js";import{u as io}from"./index.esm-BjAQZWJ4.js";import{S as ao}from"./SinyDate-DASoKPnH.js";import{S as co}from"./SinySelect-i5o7JKQO.js";import{T as ce}from"./TwBadge-CLrTtP-_.js";import{T as uo}from"./TwCheckbox-BhzaCk8h.js";import{T as fo}from"./TwTextArea-CY1Xrm8X.js";import{T as mo}from"./TextField-DYRK4ui4.js";import{f as go}from"./fireMemoDetail-6dOGOL3O.js";import"./useBaseQuery-BzUDA1ET.js";import"./Container-tgbpLRfl.js";import"./styled-CZC7bwuH.js";import"./useControlled-IYaOVZhp.js";import"./isMuiElement-DWhK3728.js";import"./dividerClasses-D1fPCAFU.js";import"./TwLinkItem-DyZdov9f.js";import"./resolveComponentProps-Op5Zu1FD.js";import"./fireStorage-KtnmbIfI.js";import"./Button-BL8t6y7w.js";import"./ImageListItem-Bzg6IH4D.js";/* empty css                 */import"./copy-H6wBFEHv.js";import"./ComponentCard-D2fPtw54.js";import"./TwRadio-Uvp9kuTu.js";import"./toPropertyKey-DCwh5dYN.js";import"./Grid-C9y34BYf.js";import"./index-BAiSu5QZ.js";import"./InputAdornment-OePoEkcC.js";import"./Popper-MB0Xb1qb.js";import"./Chip-DTO5lcYH.js";import"./MenuItem-zEPYNeef.js";var Y={},De;function xo(){if(De)return Y;De=1;var e=Oe();Object.defineProperty(Y,"__esModule",{value:!0}),Y.default=void 0;var t=e(Xe()),o=_e();return Y.default=(0,t.default)((0,o.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"ChevronRight"),Y}var po=xo();const ye=Ae(po);var J={},Re;function ho(){if(Re)return J;Re=1;var e=Oe();Object.defineProperty(J,"__esModule",{value:!0}),J.default=void 0;var t=e(Xe()),o=_e();return J.default=(0,t.default)((0,o.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore"),J}var bo=ho();const Se=Ae(bo),vo=e=>{const[t,o]=g.useState([]),n=()=>{const l=Ve(Be(We,`memo_txt/${e}`),bt("bookmark"),ht("Y"));vt(l,r=>{if(!r.exists())return;const f=r.val(),i=[];for(let u in f){const a=f[u];a.key=u,i.push(a)}i.sort((u,a)=>u.title>a.title?1:-1),o(i)})};return g.useEffect(()=>{n()},[e]),t};function No({initTreeData:e,uid:t}){const[o,n]=g.useState(),l=i=>n(i),r=Z();if(g.useEffect(()=>{(async()=>{const u=[];if(e)for(const a of e){const d=a.fullIndex.split("/");let x="root";if(d.length>1)for(let c=0;c<d.length;c++){const m=d[c];if(m!=="sub"&&d.length>c){const h=await Pt(`memo_txt/${t}/${m}/title`),b={id:m,text:h,droppable:!1,parent:x};x=m,u.filter(N=>N.id===m).length===0&&u.push(b)}}const v={id:a.key,text:a.title,droppable:!1,parent:x};u.filter(c=>c.id===v.id).length===0&&u.push(v)}for(const a of u){const d=a.id;a.cnt=u.filter(x=>x.parent===d).length}n(u)})()},[e]),o==null||o.length===0)return s.jsx(W,{});const f=i=>{console.log("node",i),r(`/memo/${i.id}`)};return s.jsx(At,{backend:Mt,options:Rt(),children:s.jsx($t,{tree:o,rootId:"root",onDrop:l,render:(i,{depth:u,isOpen:a,onToggle:d})=>s.jsxs("div",{className:"w-60 flex items-center justify-between hover:bg-gray-300 dark:hover:bg-gray-700 rounded-sm ",style:{paddingLeft:u*20+(i.cnt===0?5:0)},children:[s.jsxs("div",{className:"flex items-center",children:[i.cnt>0&&s.jsx("div",{onClick:d,children:a?s.jsx(Se,{}):s.jsx(ye,{})}),s.jsx("div",{className:"cursor-pointer",onClick:()=>f(i),children:i.text})]}),i.cnt>0&&s.jsxs("div",{className:"text-gray-500 text-sm",children:["(",i.cnt,")"]})]})})})}function Io(e){const{user:t}=ue(),o=Z(),n=vo(t?.uid);return t===void 0?s.jsx(s.Fragment,{}):s.jsxs("div",{className:"tail-bookmark justify-items-center",sx:{display:"flex",alignItems:"center",flexDirection:"column",width:"100%"},children:[s.jsx(O,{}),s.jsx(Nt,{children:"BookMark"}),s.jsx("div",{className:`tail-bookmark 
        grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-1 
        justify-items-center 
        w-full`,children:n&&n.map((l,r)=>s.jsx("div",{children:s.jsx(Vt,{component:"button",variant:"body",onClick:()=>{e.onSelected(l.key),o(`/memo/${l.key}`)},children:s.jsx(H,{variant:"body1",children:l.title})})},r))}),s.jsx(O,{}),s.jsx(No,{initTreeData:n,uid:t?.uid})]})}const yo=e=>{const t=g.useRef(null);function o(){e.onSearchDataBtn(t.current.value)}function n(){return e.onNewMemoBtn(),!1}function l(r){r.which===13&&o()}return s.jsxs(s.Fragment,{children:[s.jsx(Bt,{id:"edSearch",type:"edSearch",name:"edSearch",inputRef:t,placeholder:"Enter Search...",fullWidth:!0,sx:{pt:0,pl:2,pr:2,pb:1},onKeyDownCapture:l}),s.jsxs("div",{className:"flex justify-center",children:[s.jsx(de,{variant:"outlined",color:"success",className:"m-1 p-1",onClick:n,children:"새글"}),s.jsx(de,{variant:"outlined",color:"brand",className:"m-1 p-1",onClick:o,children:"조회"})]})]})};async function So(e,t,o=""){if(t==null||t==="")return"";let n=o===""?`${e}/${t}`:`${e}_txt/${t}`;e==="home"&&(n="home_txt");const l=Ve(Be(We,n)),r=await It(l);if(!r.exists())return console.log("getTreeData.null"),null;if(!r.exists())return console.log("getTreeData.exists"),null;const f=r.val(),i=[],u={};e==="home"&&(ke.map(a=>{i.push({title:a.label,id:a.id,sub:[]})}),ke.map(a=>{u[a.id]=[]}));for(const a in f){const d=f[a];d.up===void 0?(d.id=a,d.fullIndex=a):(d.id=d.up,d.fullIndex=d.up),e==="home"?d.gbn!==void 0&&u[d.gbn].push(d):o===""||o===void 0?(d.sub!==null&&(d.children=lt(d,d.up)),i.push(d)):(d.id=a,(d.memo+"").toLowerCase().indexOf(o.toLowerCase())>-1&&i.push(d))}return e==="home"?Object.values(u).map((a,d)=>{a.sort((x,v)=>x.title>v.title?1:-1),i[d].sub=a}):i.sort((a,d)=>a.title>d.title?1:-1),i}function lt(e,t,o,n){const l=[];if(console.log("dbChildren.data=",e.id,e.title,e),e===void 0||e.sub===void 0)return l;for(let r in e.sub){let f=e.sub[r];f.id=r,f.key=r}return Object.values(e.sub).sort((r,f)=>f.title-r.title).map(r=>{r.id=r.key,r.fullIndex=t+"/sub/"+r.key,r.sub!==null&&(r.children=lt(r,r.fullIndex)),l.push(r)}),l}const Co=({className:e="",children:t})=>s.jsx("h4",{className:`mb-2 text-lg font-semibold text-center text-gray-800 dark:text-white/90 
      ${e}}
      `,children:t}),jo=["element"];function To(e,t){for(let o=0;o<e.length;o+=1)if(t(e[o]))return o;return-1}function ko(e,t){let o=0,n=e.length-1;for(;o<=n;){const l=Math.floor((o+n)/2);if(e[l].element===t)return l;e[l].element.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING?n=l-1:o=l+1}return o}const rt=g.createContext({});function wo(e){const t=g.useRef(null);return g.useEffect(()=>{t.current=e},[e]),t.current}const Me=()=>{};function Eo(e){const[,t]=g.useState(),{registerDescendant:o=Me,unregisterDescendant:n=Me,descendants:l=[],parentId:r=null}=g.useContext(rt),f=To(l,a=>a.element===e.element),i=wo(l),u=l.some((a,d)=>i&&i[d]&&i[d].element!==a.element);return yt(()=>{if(e.element)return o(E({},e,{index:f})),()=>{n(e.element)};t({})},[o,n,f,u,e]),{parentId:r,index:f}}function it(e){const{children:t,id:o}=e,[n,l]=g.useState([]),r=g.useCallback(u=>{let{element:a}=u,d=fe(u,jo);l(x=>{if(x.length===0)return[E({},d,{element:a,index:0})];const v=ko(x,a);let p;if(x[v]&&x[v].element===a)p=x;else{const c=E({},d,{element:a,index:v});p=x.slice(),p.splice(v,0,c)}return p.forEach((c,m)=>{c.index=m}),p})},[]),f=g.useCallback(u=>{l(a=>a.filter(d=>u!==d.element))},[]),i=g.useMemo(()=>({descendants:n,registerDescendant:r,unregisterDescendant:f,parentId:o}),[n,r,f,o]);return s.jsx(rt.Provider,{value:i,children:t})}const at={instance:null,multiSelect:!1,disabledItemsFocusable:!1,treeId:void 0,icons:{defaultCollapseIcon:null,defaultExpandIcon:null,defaultParentIcon:null,defaultEndIcon:null}},ct=g.createContext(at),dt=()=>g.useContext(ct);function Do(e){const{instance:t,multiSelect:o}=dt(),n=t?t.isNodeExpandable(e):!1,l=t?t.isNodeExpanded(e):!1,r=t?t.isNodeFocused(e):!1,f=t?t.isNodeSelected(e):!1,i=t?t.isNodeDisabled(e):!1;return{disabled:i,expanded:l,selected:f,focused:r,handleExpansion:x=>{if(t&&!i){r||t.focusNode(x,e);const v=o&&(x.shiftKey||x.ctrlKey||x.metaKey);n&&!(v&&t.isNodeExpanded(e))&&t.toggleNodeExpansion(x,e)}},handleSelection:x=>{t&&!i&&(r||t.focusNode(x,e),o&&(x.shiftKey||x.ctrlKey||x.metaKey)?x.shiftKey?t.selectRange(x,{end:e}):t.selectNode(x,e,!0):t.selectNode(x,e))},preventSelection:x=>{(x.shiftKey||x.ctrlKey||x.metaKey||i)&&x.preventDefault()}}}const Ro=["classes","className","displayIcon","expansionIcon","icon","label","nodeId","onClick","onMouseDown"],ut=g.forwardRef(function(t,o){const{classes:n,className:l,displayIcon:r,expansionIcon:f,icon:i,label:u,nodeId:a,onClick:d,onMouseDown:x}=t,v=fe(t,Ro),{disabled:p,expanded:c,selected:m,focused:h,handleExpansion:b,handleSelection:y,preventSelection:N}=Do(a),I=i||f||r,C=k=>{N(k),x&&x(k)},j=k=>{b(k),y(k),d&&d(k)};return s.jsxs("div",E({},v,{className:He(l,n.root,c&&n.expanded,m&&n.selected,h&&n.focused,p&&n.disabled),onClick:j,onMouseDown:C,ref:o,children:[s.jsx("div",{className:n.iconContainer,children:I}),s.jsx("div",{className:n.label,children:u})]}))});function Mo(e){return ze("MuiTreeItem",e)}const D=Ke("MuiTreeItem",["root","group","content","expanded","selected","focused","disabled","iconContainer","label"]),$o=["children","className","collapseIcon","ContentComponent","ContentProps","endIcon","expandIcon","disabled","icon","id","label","nodeId","onClick","onMouseDown","TransitionComponent","TransitionProps"],Po=e=>{const{classes:t}=e;return Ge({root:["root"],content:["content"],expanded:["expanded"],selected:["selected"],focused:["focused"],disabled:["disabled"],iconContainer:["iconContainer"],label:["label"],group:["group"]},Mo,t)},Lo=K("li",{name:"MuiTreeItem",slot:"Root",overridesResolver:(e,t)=>t.root})({listStyle:"none",margin:0,padding:0,outline:0}),Fo=K(ut,{name:"MuiTreeItem",slot:"Content",overridesResolver:(e,t)=>[t.content,t.iconContainer&&{[`& .${D.iconContainer}`]:t.iconContainer},t.label&&{[`& .${D.label}`]:t.label}]})(({theme:e})=>({padding:"0 8px",width:"100%",boxSizing:"border-box",display:"flex",alignItems:"center",cursor:"pointer",WebkitTapHighlightColor:"transparent","&:hover":{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${D.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity,backgroundColor:"transparent"},[`&.${D.focused}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${D.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:re(e.palette.primary.main,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:re(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:re(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${D.focused}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:re(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`& .${D.iconContainer}`]:{marginRight:4,width:15,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},[`& .${D.label}`]:E({paddingLeft:4,width:"100%",boxSizing:"border-box",minWidth:0,position:"relative"},e.typography.body1)})),Oo=K(et,{name:"MuiTreeItem",slot:"Group",overridesResolver:(e,t)=>t.group})({margin:0,padding:0,marginLeft:17}),ft=g.forwardRef(function(t,o){const n=Ue({props:t,name:"MuiTreeItem"}),{children:l,className:r,collapseIcon:f,ContentComponent:i=ut,ContentProps:u,endIcon:a,expandIcon:d,disabled:x,icon:v,id:p,label:c,nodeId:m,onClick:h,onMouseDown:b,TransitionComponent:y=et,TransitionProps:N}=n,I=fe(n,$o),{icons:C,multiSelect:j,disabledItemsFocusable:k,treeId:R,instance:w}=dt();let M;p!=null?M=p:R&&m&&(M=`${R}-${m}`);const[ee,me]=g.useState(null),te=g.useRef(null),ge=qe(me,o),xe=g.useMemo(()=>({element:ee,id:m}),[m,ee]),{index:U,parentId:oe}=Eo(xe),F=!!(Array.isArray(l)?l.length:l),_=w?w.isNodeExpanded(m):!1,ne=w?w.isNodeFocused(m):!1,q=w?w.isNodeSelected(m):!1,L=w?w.isNodeDisabled(m):!1,S=E({},n,{expanded:_,focused:ne,selected:q,disabled:L}),T=Po(S);let A,G;F&&(_?G=f||C.defaultCollapseIcon:G=d||C.defaultExpandIcon),F?A=C.defaultParentIcon:A=a||C.defaultEndIcon,g.useEffect(()=>{if(w&&U!==-1)return w.updateNode({id:m,idAttribute:M,index:U,parentId:oe,expandable:F,disabled:x}),()=>w.removeNode(m)},[w,oe,U,m,F,x,M]),g.useEffect(()=>{if(w&&c){var $,le;return w.mapFirstChar(m,(($=(le=te.current)==null?void 0:le.textContent)!=null?$:"").substring(0,1).toLowerCase())}},[w,m,c]);let V;j?V=q:q&&(V=!0);function se($){if($.target===$.currentTarget){let pe;typeof $.target.getRootNode=="function"?pe=$.target.getRootNode():pe=Ze($.target),pe.getElementById(R).focus({preventScroll:!0})}const le=!k&&L;w&&!ne&&$.currentTarget===$.target&&!le&&w.focusNode($,m)}return s.jsxs(Lo,E({className:He(T.root,r),role:"treeitem","aria-expanded":F?_:void 0,"aria-selected":V,"aria-disabled":L||void 0,id:M,tabIndex:-1},I,{ownerState:S,onFocus:se,ref:ge,children:[s.jsx(Fo,E({as:i,ref:te,classes:{root:T.content,expanded:T.expanded,selected:T.selected,focused:T.focused,disabled:T.disabled,iconContainer:T.iconContainer,label:T.label},label:c,nodeId:m,onClick:h,onMouseDown:b,icon:v,expansionIcon:G,displayIcon:A,ownerState:S},u)),l&&s.jsx(it,{id:m,children:s.jsx(Oo,E({as:y,unmountOnExit:!0,className:T.group,in:_,component:"ul",role:"group"},N,{children:l}))})]}))});function _o(e){return ze("MuiTreeView",e)}Ke("MuiTreeView",["root"]);const Ao=(e,t)=>{const o=g.useRef({}),[n,l]=g.useState(()=>{const f={};return e.forEach(i=>{i.models&&Object.entries(i.models).forEach(([u,a])=>{o.current[u]={controlledProp:a.controlledProp,defaultProp:a.defaultProp,isControlled:t[a.controlledProp]!==void 0},f[u]=t[a.defaultProp]})}),f});return Object.fromEntries(Object.entries(o.current).map(([f,i])=>{const u=i.isControlled?t[i.controlledProp]:n[f];return[f,{value:u,setValue:a=>{i.isControlled||l(d=>E({},d,{[f]:a}))}}]}))};class Vo{constructor(){this.maxListeners=20,this.warnOnce=!1,this.events={}}on(t,o,n={}){let l=this.events[t];l||(l={highPriority:new Map,regular:new Map},this.events[t]=l),n.isFirst?l.highPriority.set(o,!0):l.regular.set(o,!0)}removeListener(t,o){this.events[t]&&(this.events[t].regular.delete(o),this.events[t].highPriority.delete(o))}removeAllListeners(){this.events={}}emit(t,...o){const n=this.events[t];if(!n)return;const l=Array.from(n.highPriority.keys()),r=Array.from(n.regular.keys());for(let f=l.length-1;f>=0;f-=1){const i=l[f];n.highPriority.has(i)&&i.apply(this,o)}for(let f=0;f<r.length;f+=1){const i=r[f];n.regular.has(i)&&i.apply(this,o)}}once(t,o){const n=this;this.on(t,function l(...r){n.removeListener(t,l),o.apply(n,r)})}}const be=(e,t)=>{const o=e.getNode(t),n=e.getNavigableChildrenIds(o.parentId),l=n.indexOf(t);if(l===0)return o.parentId;let r=n[l-1];for(;e.isNodeExpanded(r)&&e.getNavigableChildrenIds(r).length>0;)r=e.getNavigableChildrenIds(r).pop();return r},Q=(e,t)=>{if(e.isNodeExpanded(t)&&e.getNavigableChildrenIds(t).length>0)return e.getNavigableChildrenIds(t)[0];let o=e.getNode(t);for(;o!=null;){const n=e.getNavigableChildrenIds(o.parentId),l=n[n.indexOf(o.id)+1];if(l)return l;o=e.getNode(o.parentId)}return null},ve=e=>{let t=e.getNavigableChildrenIds(null).pop();for(;e.isNodeExpanded(t);)t=e.getNavigableChildrenIds(t).pop();return t},Ne=e=>e.getNavigableChildrenIds(null)[0],z=(e,t)=>{Object.assign(e,t)},Bo=e=>e.isPropagationStopped!==void 0,Wo=({instance:e})=>{const[t]=g.useState(()=>new Vo),o=g.useCallback((...l)=>{const[r,f,i={}]=l;i.defaultMuiPrevented=!1,!(Bo(i)&&i.isPropagationStopped())&&t.emit(r,f,i)},[t]),n=g.useCallback((l,r)=>(t.on(l,r),()=>{t.removeListener(l,r)}),[t]);z(e,{$$publishEvent:o,$$subscribeEvent:n})},Ho=[Wo],Ko=e=>{const t=[...Ho,...e.plugins],o=t.reduce((c,m)=>m.getDefaultizedParams?m.getDefaultizedParams(c):c,e),n=Ao(t,o),r=g.useRef({}).current,f=g.useRef(null),i=qe(f,e.rootRef),[u,a]=g.useState(()=>{const c={};return t.forEach(m=>{m.getInitialState&&Object.assign(c,m.getInitialState(o))}),c}),d=[];let x=at;const v=c=>{const m=c({instance:r,params:o,state:u,setState:a,rootRef:f,models:n})||{};m.getRootProps&&d.push(m.getRootProps),m.contextValue&&(x=m.contextValue)};return t.forEach(v),{getRootProps:(c={})=>{const m=E({role:"tree",tabIndex:0},c,{ref:i});return d.forEach(h=>{Object.assign(m,h(c))}),m},rootRef:i,contextValue:x}};function zo(e){const{value:t,children:o}=e;return s.jsx(ct.Provider,{value:t,children:s.jsx(it,{children:o})})}const Uo=(e,t,o)=>{e.$$publishEvent(t,o)},qo=({instance:e,params:t})=>{const o=g.useRef({}),n=g.useCallback(a=>o.current[a],[]),l=g.useCallback(a=>{o.current[a.id]=a},[]),r=g.useCallback(a=>{const d=E({},o.current);delete d[a],o.current=d,Uo(e,"removeNode",{id:a})},[e]),f=g.useCallback(a=>{if(a==null)return!1;let d=e.getNode(a);if(!d)return!1;if(d.disabled)return!0;for(;d.parentId!=null;)if(d=e.getNode(d.parentId),d.disabled)return!0;return!1},[e]),i=X(a=>Object.values(o.current).filter(d=>d.parentId===a).sort((d,x)=>d.index-x.index).map(d=>d.id));z(e,{getNode:n,updateNode:l,removeNode:r,getChildrenIds:i,getNavigableChildrenIds:a=>{let d=e.getChildrenIds(a);return t.disabledItemsFocusable||(d=d.filter(x=>!e.isNodeDisabled(x))),d},isNodeDisabled:f})},Ce=({instance:e,params:t,models:o})=>{const n=g.useCallback(i=>Array.isArray(o.expanded.value)?o.expanded.value.indexOf(i)!==-1:!1,[o.expanded.value]),l=g.useCallback(i=>{var u;return!!((u=e.getNode(i))!=null&&u.expandable)},[e]),r=X((i,u)=>{if(u==null)return;let a;o.expanded.value.indexOf(u)!==-1?a=o.expanded.value.filter(d=>d!==u):a=[u].concat(o.expanded.value),t.onNodeToggle&&t.onNodeToggle(i,a),o.expanded.setValue(a)});z(e,{isNodeExpanded:n,isNodeExpandable:l,toggleNodeExpansion:r,expandAllSiblings:(i,u)=>{const a=e.getNode(u),x=e.getChildrenIds(a.parentId).filter(p=>e.isNodeExpandable(p)&&!e.isNodeExpanded(p)),v=o.expanded.value.concat(x);x.length>0&&(o.expanded.setValue(v),t.onNodeToggle&&t.onNodeToggle(i,v))}})};Ce.models={expanded:{controlledProp:"expanded",defaultProp:"defaultExpanded"}};const Go=[];Ce.getDefaultizedParams=e=>{var t;return E({},e,{defaultExpanded:(t=e.defaultExpanded)!=null?t:Go})};const Yo=(e,t,o)=>{if(t===o)return[t,o];const n=e.getNode(t),l=e.getNode(o);if(n.parentId===l.id||l.parentId===n.id)return l.parentId===n.id?[n.id,l.id]:[l.id,n.id];const r=[n.id],f=[l.id];let i=n.parentId,u=l.parentId,a=f.indexOf(i)!==-1,d=r.indexOf(u)!==-1,x=!0,v=!0;for(;!d&&!a;)x&&(r.push(i),a=f.indexOf(i)!==-1,x=i!==null,!a&&x&&(i=e.getNode(i).parentId)),v&&!a&&(f.push(u),d=r.indexOf(u)!==-1,v=u!==null,!d&&v&&(u=e.getNode(u).parentId));const p=a?i:u,c=e.getChildrenIds(p),m=r[r.indexOf(p)-1],h=f[f.indexOf(p)-1];return c.indexOf(m)<c.indexOf(h)?[t,o]:[o,t]},je=({instance:e,params:t,models:o})=>{const n=g.useRef(null),l=g.useRef(!1),r=g.useRef([]),f=c=>Array.isArray(o.selected.value)?o.selected.value.indexOf(c)!==-1:o.selected.value===c,i=(c,m,h=!1)=>{if(!t.disableSelection){if(h){if(Array.isArray(o.selected.value)){let b;o.selected.value.indexOf(m)!==-1?b=o.selected.value.filter(y=>y!==m):b=[m].concat(o.selected.value),t.onNodeSelect&&t.onNodeSelect(c,b),o.selected.setValue(b)}}else{const b=t.multiSelect?[m]:m;t.onNodeSelect&&t.onNodeSelect(c,b),o.selected.setValue(b)}n.current=m,l.current=!1,r.current=[]}},u=(c,m)=>{const[h,b]=Yo(e,c,m),y=[h];let N=h;for(;N!==b;)N=Q(e,N),y.push(N);return y},a=(c,m)=>{let h=o.selected.value.slice();const{start:b,next:y,current:N}=m;!y||!N||(r.current.indexOf(N)===-1&&(r.current=[]),l.current?r.current.indexOf(y)!==-1?(h=h.filter(I=>I===b||I!==N),r.current=r.current.filter(I=>I===b||I!==N)):(h.push(y),r.current.push(y)):(h.push(y),r.current.push(N,y)),t.onNodeSelect&&t.onNodeSelect(c,h),o.selected.setValue(h))},d=(c,m)=>{let h=o.selected.value.slice();const{start:b,end:y}=m;l.current&&(h=h.filter(C=>r.current.indexOf(C)===-1));let N=u(b,y);N=N.filter(C=>!e.isNodeDisabled(C)),r.current=N;let I=h.concat(N);I=I.filter((C,j)=>I.indexOf(C)===j),t.onNodeSelect&&t.onNodeSelect(c,I),o.selected.setValue(I)};return z(e,{isNodeSelected:f,selectNode:i,selectRange:(c,m,h=!1)=>{if(t.disableSelection)return;const{start:b=n.current,end:y,current:N}=m;h?a(c,{start:b,next:y,current:N}):b!=null&&y!=null&&d(c,{start:b,end:y}),l.current=!0},rangeSelectToLast:(c,m)=>{n.current||(n.current=m);const h=l.current?n.current:m;e.selectRange(c,{start:h,end:ve(e)})},rangeSelectToFirst:(c,m)=>{n.current||(n.current=m);const h=l.current?n.current:m;e.selectRange(c,{start:h,end:Ne(e)})}}),{getRootProps:()=>({"aria-multiselectable":t.multiSelect})}};je.models={selected:{controlledProp:"selected",defaultProp:"defaultSelected"}};const Jo=[];je.getDefaultizedParams=e=>{var t,o,n;return E({},e,{disableSelection:(t=e.disableSelection)!=null?t:!1,multiSelect:(o=e.multiSelect)!=null?o:!1,defaultSelected:(n=e.defaultSelected)!=null?n:e.multiSelect?Jo:null})};const $e=1e3;class Qo{constructor(t=$e){this.timeouts=new Map,this.cleanupTimeout=$e,this.cleanupTimeout=t}register(t,o,n){this.timeouts||(this.timeouts=new Map);const l=setTimeout(()=>{typeof o=="function"&&o(),this.timeouts.delete(n.cleanupToken)},this.cleanupTimeout);this.timeouts.set(n.cleanupToken,l)}unregister(t){const o=this.timeouts.get(t.cleanupToken);o&&(this.timeouts.delete(t.cleanupToken),clearTimeout(o))}reset(){this.timeouts&&(this.timeouts.forEach((t,o)=>{this.unregister({cleanupToken:o})}),this.timeouts=void 0)}}class Xo{constructor(){this.registry=new FinalizationRegistry(t=>{typeof t=="function"&&t()})}register(t,o,n){this.registry.register(t,o,n)}unregister(t){this.registry.unregister(t)}reset(){}}class Zo{}function en(e){let t=0;return function(n,l,r){e.registry===null&&(e.registry=typeof FinalizationRegistry<"u"?new Xo:new Qo);const[f]=g.useState(new Zo),i=g.useRef(null),u=g.useRef();u.current=r;const a=g.useRef(null);if(!i.current&&u.current){const d=(x,v)=>{if(!v.defaultMuiPrevented){var p;(p=u.current)==null||p.call(u,x,v)}};i.current=n.$$subscribeEvent(l,d),t+=1,a.current={cleanupToken:t},e.registry.register(f,()=>{var x;(x=i.current)==null||x.call(i),i.current=null,a.current=null},a.current)}else!u.current&&i.current&&(i.current(),i.current=null,a.current&&(e.registry.unregister(a.current),a.current=null));g.useEffect(()=>{if(!i.current&&u.current){const d=(x,v)=>{if(!v.defaultMuiPrevented){var p;(p=u.current)==null||p.call(u,x,v)}};i.current=n.$$subscribeEvent(l,d)}return a.current&&e.registry&&(e.registry.unregister(a.current),a.current=null),()=>{var d;(d=i.current)==null||d.call(i),i.current=null}},[n,l])}}const tn={registry:null},on=en(tn),Te=({instance:e,params:t,state:o,setState:n,models:l,rootRef:r})=>{const f=X(p=>{const c=typeof p=="function"?p(o.focusedNodeId):p;n(m=>E({},m,{focusedNodeId:c}))}),i=g.useCallback(p=>o.focusedNodeId===p,[o.focusedNodeId]),u=X((p,c)=>{c&&(f(c),t.onNodeFocus&&t.onNodeFocus(p,c))});z(e,{isNodeFocused:i,focusNode:u}),on(e,"removeNode",({id:p})=>{f(c=>c===p&&r.current===Ze(r.current).activeElement?e.getChildrenIds(null)[0]:c)});const a=p=>c=>{var m;if((m=p.onFocus)==null||m.call(p,c),c.target===c.currentTarget){const h=y=>{const N=e.getNode(y);return N&&(N.parentId==null||e.isNodeExpanded(N.parentId))};let b;Array.isArray(l.selected.value)?b=l.selected.value.find(h):l.selected.value!=null&&h(l.selected.value)&&(b=l.selected.value),b==null&&(b=e.getNavigableChildrenIds(null)[0]),e.focusNode(c,b)}},d=p=>c=>{var m;(m=p.onBlur)==null||m.call(p,c),f(null)},x=e.getNode(o.focusedNodeId),v=x?x.idAttribute:null;return{getRootProps:p=>({onFocus:a(p),onBlur:d(p),"aria-activedescendant":v??void 0})}};Te.getInitialState=()=>({focusedNodeId:null});Te.getDefaultizedParams=e=>{var t;return E({},e,{disabledItemsFocusable:(t=e.disabledItemsFocusable)!=null?t:!1})};function nn(e){return e&&e.length===1&&e.match(/\S/)}function Pe(e,t,o){for(let n=t;n<e.length;n+=1)if(o===e[n])return n;return-1}const sn=({instance:e,params:t,state:o})=>{const l=zt().direction==="rtl",r=g.useRef({}),f=X((p,c)=>(r.current[p]=c,()=>{const m=E({},r.current);delete m[p],r.current=m}));z(e,{mapFirstChar:f});const i=p=>(o.focusedNodeId!=null&&e.isNodeExpandable(o.focusedNodeId)&&(e.isNodeExpanded(o.focusedNodeId)?e.focusNode(p,Q(e,o.focusedNodeId)):e.isNodeDisabled(o.focusedNodeId)||e.toggleNodeExpansion(p,o.focusedNodeId)),!0),u=p=>{if(o.focusedNodeId==null)return!1;if(e.isNodeExpanded(o.focusedNodeId)&&!e.isNodeDisabled(o.focusedNodeId))return e.toggleNodeExpansion(p,o.focusedNodeId),!0;const c=e.getNode(o.focusedNodeId).parentId;return c?(e.focusNode(p,c),!0):!1},a=(p,c,m)=>{let h,b;const y=m.toLowerCase(),N=[],I=[];Object.keys(r.current).forEach(C=>{const j=e.getNode(C),k=j.parentId?e.isNodeExpanded(j.parentId):!0,R=t.disabledItemsFocusable?!1:e.isNodeDisabled(C);k&&!R&&(N.push(C),I.push(r.current[C]))}),h=N.indexOf(c)+1,h>=N.length&&(h=0),b=Pe(I,h,y),b===-1&&(b=Pe(I,0,y)),b>-1&&e.focusNode(p,N[b])},d=(p,c)=>{e.isNodeDisabled(Q(e,c))||e.selectRange(p,{end:Q(e,c),current:c},!0)},x=(p,c)=>{e.isNodeDisabled(be(e,c))||e.selectRange(p,{end:be(e,c),current:c},!0)},v=p=>c=>{var m;(m=p.onKeyDown)==null||m.call(p,c);let h=!1;const b=c.key;if(c.altKey||c.currentTarget!==c.target||o.focusedNodeId==null)return;const y=c.ctrlKey||c.metaKey;switch(b){case" ":!t.disableSelection&&!e.isNodeDisabled(o.focusedNodeId)&&(h=!0,t.multiSelect&&c.shiftKey?e.selectRange(c,{end:o.focusedNodeId}):t.multiSelect?e.selectNode(c,o.focusedNodeId,!0):e.selectNode(c,o.focusedNodeId)),c.stopPropagation();break;case"Enter":e.isNodeDisabled(o.focusedNodeId)||(e.isNodeExpandable(o.focusedNodeId)?(e.toggleNodeExpansion(c,o.focusedNodeId),h=!0):t.disableSelection||(h=!0,t.multiSelect?e.selectNode(c,o.focusedNodeId,!0):e.selectNode(c,o.focusedNodeId))),c.stopPropagation();break;case"ArrowDown":t.multiSelect&&c.shiftKey&&!t.disableSelection&&d(c,o.focusedNodeId),e.focusNode(c,Q(e,o.focusedNodeId)),h=!0;break;case"ArrowUp":t.multiSelect&&c.shiftKey&&!t.disableSelection&&x(c,o.focusedNodeId),e.focusNode(c,be(e,o.focusedNodeId)),h=!0;break;case"ArrowRight":l?h=u(c):h=i(c);break;case"ArrowLeft":l?h=i(c):h=u(c);break;case"Home":t.multiSelect&&y&&c.shiftKey&&!t.disableSelection&&!e.isNodeDisabled(o.focusedNodeId)&&e.rangeSelectToFirst(c,o.focusedNodeId),e.focusNode(c,Ne(e)),h=!0;break;case"End":t.multiSelect&&y&&c.shiftKey&&!t.disableSelection&&!e.isNodeDisabled(o.focusedNodeId)&&e.rangeSelectToLast(c,o.focusedNodeId),e.focusNode(c,ve(e)),h=!0;break;default:b==="*"?(e.expandAllSiblings(c,o.focusedNodeId),h=!0):t.multiSelect&&y&&b.toLowerCase()==="a"&&!t.disableSelection?(e.selectRange(c,{start:Ne(e),end:ve(e)}),h=!0):!y&&!c.shiftKey&&nn(b)&&(a(c,o.focusedNodeId,b),h=!0)}h&&(c.preventDefault(),c.stopPropagation())};return{getRootProps:p=>({onKeyDown:v(p)})}},ln=({instance:e,params:t})=>{const o=St(t.id);return{getRootProps:()=>({id:o}),contextValue:{treeId:o,instance:e,multiSelect:t.multiSelect,disabledItemsFocusable:t.disabledItemsFocusable,icons:{defaultCollapseIcon:t.defaultCollapseIcon,defaultEndIcon:t.defaultEndIcon,defaultExpandIcon:t.defaultExpandIcon,defaultParentIcon:t.defaultParentIcon}}}},rn=[qo,Ce,je,Te,sn,ln],an=["disabledItemsFocusable","expanded","defaultExpanded","onNodeToggle","onNodeFocus","disableSelection","defaultSelected","selected","multiSelect","onNodeSelect","id","defaultCollapseIcon","defaultEndIcon","defaultExpandIcon","defaultParentIcon","children"],cn=e=>{const{classes:t}=e;return Ge({root:["root"]},_o,t)},Le=K("ul",{name:"MuiTreeView",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:0,margin:0,listStyle:"none",outline:0}),mt=g.forwardRef(function(t,o){const n=Ue({props:t,name:"MuiTreeView"}),l=n,r=n,{disabledItemsFocusable:f,expanded:i,defaultExpanded:u,onNodeToggle:a,onNodeFocus:d,disableSelection:x,defaultSelected:v,selected:p,multiSelect:c,onNodeSelect:m,id:h,defaultCollapseIcon:b,defaultEndIcon:y,defaultExpandIcon:N,defaultParentIcon:I,children:C}=r,j=fe(r,an),{getRootProps:k,contextValue:R}=Ko({disabledItemsFocusable:f,expanded:i,defaultExpanded:u,onNodeToggle:a,onNodeFocus:d,disableSelection:x,defaultSelected:v,selected:p,multiSelect:c,onNodeSelect:m,id:h,defaultCollapseIcon:b,defaultEndIcon:y,defaultExpandIcon:N,defaultParentIcon:I,plugins:rn,rootRef:o}),w=cn(n),M=Kt({elementType:Le,externalSlotProps:{},externalForwardedProps:j,className:w.root,getSlotProps:k,ownerState:l});return s.jsx(zo,{value:R,children:s.jsx(Le,E({},M,{children:C}))})}),dn=K(ft)(({theme:e})=>({color:e.palette.text.secondary,[`& .${D.content}`]:{color:e.palette.text.secondary,borderTopRightRadius:e.spacing(2),borderBottomRightRadius:e.spacing(2),paddingRight:e.spacing(1),fontWeight:e.typography.fontWeightMedium,"&.MuiTreeItem-content":{paddingLeft:"3px",paddingRight:"3px"},".MuiTreeItem-label":{paddingLeft:"0px"},".MuiTreeItem-iconContainer":{marginRight:"0px"},"&.Mui-expanded":{fontWeight:e.typography.fontWeightRegular},"&:hover":{backgroundColor:e.palette.action.hover},"&.Mui-selected":{backgroundColor:"rgba(145, 85, 253, 0.16)",color:"var(--tree-view-color)"},"&.Mui-focused, &.Mui-selected, &.Mui-selected.Mui-focused":{backgroundColor:"rgba(145, 85, 253, 0.16)",color:"var(--tree-view-color)"},[`& .${D.label}`]:{fontWeight:"inherit",color:"inherit"}},[`& .${D.group}`]:{marginLeft:0,[`& .${D.content}`]:{paddingLeft:e.spacing(1)}}})),un=g.forwardRef(function(t,o){const{labelIcon:n,labelInfo:l,labelText:r,pl:f,...i}=t;return s.jsx(dn,{label:s.jsxs(P,{sx:{display:"flex",alignItems:"center",p:.5,pr:2,pl:{pl:f}},children:[s.jsx(P,{component:n,color:"inherit",sx:{mr:1,pl:{pl:f}}}),s.jsx(H,{sx:{fontWeight:"inherit",flexGrow:1},component:"div",children:r}),s.jsx(H,{variant:"caption",color:"inherit",children:l})]}),...i,ref:o})}),gt=e=>{const{id:t,fullIndex:o,title:n,sub:l}=e.item;if(t===void 0)return console.log("SubTreeItem.item.undefined=",e.item),s.jsx(s.Fragment,{});const r=l&&Object.values(l).length>0?Object.values(l).length+"":"";return s.jsx(un,{onClick:()=>e.onDetail(t,o),nodeId:t,labelText:n,labelInfo:r,pl:e.pl,children:l!=null?Object.values(l).sort((f,i)=>f.title>i.title?1:-1).map((f,i)=>s.jsx("div",{style:{paddingLeft:e.pl+5},children:s.jsx(gt,{onDetail:e.onDetail,item:f,pl:e.pl+5})},i+"")):""})};function fn(e){const[t,o]=g.useState([]),[n,l]=g.useState([]),{isMobileFooter:r}=Ct(),f=(a,d)=>{e.onDetail(a,d)};g.useEffect(()=>{if(e.expandIndex!==void 0){let a=e.expandIndex.split("/");a=a.filter(d=>d!=="sub"),e.expandIndex.indexOf("undefined")<0&&(o(a),l(a[a.length-1]))}},[e.expandIndex]);const i=(a,d)=>{},u=(a,d)=>{o(d)};return s.jsx("div",{className:"overflow-y-auto overflow-x-hidden h-[calc(100vh-220px-var(--footer-height))] lg:h-[calc(100vh-160px-var(--footer-height))]",style:{"--footer-height":r?"56px":"0px"},children:s.jsx(mt,{"aria-label":"icon expansion",defaultCollapseIcon:s.jsx(Se,{}),defaultExpandIcon:s.jsx(ye,{}),expanded:t,onNodeSelect:i,selected:n,onNodeToggle:u,sx:{flexGrow:1},children:e.data&&e.data.map((a,d)=>s.jsx(gt,{onDetail:f,item:a,parentIndex:d+1,pl:5},d+1))})})}const mn=K(ft)(({theme:e})=>({color:e.palette.text.secondary,[`& .${D.content}`]:{color:e.palette.text.secondary,borderTopRightRadius:e.spacing(2),borderBottomRightRadius:e.spacing(2),paddingRight:e.spacing(1),fontWeight:e.typography.fontWeightMedium,"&.MuiTreeItem-content":{paddingLeft:"3px",paddingRight:"3px"},".MuiTreeItem-label":{paddingLeft:"0px"},".MuiTreeItem-iconContainer":{marginRight:"0px"},"&.Mui-expanded":{fontWeight:e.typography.fontWeightRegular},"&:hover":{backgroundColor:e.palette.action.hover},"&.Mui-selected":{backgroundColor:"rgba(145, 85, 253, 0.16)",color:"var(--tree-view-color)"},"&.Mui-focused, &.Mui-selected, &.Mui-selected.Mui-focused":{backgroundColor:"rgba(145, 85, 253, 0.16)",color:"var(--tree-view-color)"},[`& .${D.label}`]:{fontWeight:"inherit",color:"inherit"}},[`& .${D.group}`]:{marginLeft:0,[`& .${D.content}`]:{paddingLeft:e.spacing(1)}}})),gn=g.forwardRef(function(t,o){const{labelIcon:n,labelInfo:l,labelText:r,pl:f,...i}=t;return s.jsx(mn,{label:s.jsxs(P,{sx:{display:"flex",alignItems:"center",p:.5,pr:2,pl:{pl:f}},children:[s.jsx(P,{component:n,color:"inherit",sx:{mr:1,pl:{pl:f}}}),s.jsx(H,{sx:{fontWeight:"inherit",flexGrow:1},component:"div",children:r}),s.jsx(H,{variant:"caption",color:"inherit",children:l})]}),...i,ref:o})}),xt=e=>{const{id:t,fullIndex:o,title:n,sub:l}=e.item;if(t===void 0)return console.log("SubTreeItem.item.undefined=",e.item),s.jsx(s.Fragment,{});const r=l&&Object.values(l).length>0?Object.values(l).length+"":"";return s.jsx(gn,{onClick:()=>e.onDetail(t,o),nodeId:t,labelText:n,labelInfo:r,pl:e.pl,children:l!=null?Object.values(l).sort((f,i)=>f.title>i.title?1:-1).map((f,i)=>s.jsx("div",{style:{paddingLeft:e.pl+5},children:s.jsx(xt,{onDetail:e.onDetail,item:f,pl:e.pl+5})},i+"")):""})};function xn(e){const[t,o]=g.useState([]),[n,l]=g.useState([]),r=(u,a)=>{e.onDetail(u,a)};g.useEffect(()=>{if(e.expandIndex!==void 0){let u=e.expandIndex.split("/");u=u.filter(a=>a!=="sub"),e.expandIndex.indexOf("undefined")<0&&(o(u),l(u[u.length-1]))}},[e.expandIndex]);const f=(u,a)=>{},i=(u,a)=>{o(a)};return s.jsx(P,{sx:{minHeight:180,flexGrow:1,display:"flex",flexDirection:"column",height:e.maxHeight,overflow:"hidden",overflowY:"auto",width:"100%"},children:s.jsx(mt,{"aria-label":"icon expansion",defaultCollapseIcon:s.jsx(Se,{}),defaultExpandIcon:s.jsx(ye,{}),expanded:t,onNodeSelect:f,selected:n,onNodeToggle:i,sx:{flexGrow:1,overflow:"hidden",overflowY:"auto"},children:e.data&&e.data.map((u,a)=>s.jsx(xt,{onDetail:r,item:u,parentIndex:a+1,pl:5},a+1))})})}const pn={position:"absolute",top:"50%",left:"50%",display:"flex",flexDirection:"column",alignItems:"center",transform:"translate(-50%, -50%)",width:250,maxHeight:"400px",bgcolor:"background.paper",border:"1px solid #000",boxShadow:24,boxSizing:"border-box",p:4},hn=e=>s.jsxs(P,{sx:{my:2,mt:3,display:"flex"},children:[s.jsx(B,{type:"submit",variant:"outlined",color:"success",onClick:e.onPost,children:"확인"}),s.jsx(B,{type:"button",variant:"outlined",onClick:e.onClose,children:"취소"})]}),bn=e=>{const[t,o]=g.useState(e.open),[n,l]=g.useState(),r=()=>{o(!1),l(void 0),e.onClose()};g.useEffect(()=>{o(e.open)},[e.open]);const f=u=>{l(u)},i=()=>{if(n===void 0){alert("이동할 메모장을 선택해 주세요");return}e.onPost(n)};return s.jsx("div",{children:s.jsx(eo,{open:t,onClose:r,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:s.jsxs(P,{sx:pn,children:[s.jsx(H,{id:"modal-modal-title",variant:"h6",component:"h2",children:"이동할 메모장 선택"}),s.jsx(O,{}),s.jsx(P,{sx:{width:"100%",minHeight:110,maxHeight:200,flexGrow:1,minWidth:100,overflow:"hidden"},children:s.jsx(xn,{data:e.data,onDetail:f,maxHeight:200})}),s.jsx(hn,{onPost:i,onClose:r})]})})})},vn=e=>s.jsxs(P,{sx:{flexGrow:1,my:2,width:"100%",display:"grid",gridTemplateColumns:"64px 64px  64px  64px ",flexDirection:"row",alignItems:"center",alignContent:"center",justifyContent:"center",textAlign:"center",whiteSpace:"nowrap"},children:[s.jsx(B,{type:"button",size:"small",variant:"outlined",color:"success",onClick:e.onEdit,children:"수정"}),s.jsx(B,{type:"button",size:"small",variant:"outlined",onClick:e.onNewMemo,children:"새글"}),e.rootDb==="memo"?s.jsx(B,{type:"button",size:"small",variant:"outlined",color:"warning",onClick:e.onMove,children:"이동"}):"",s.jsx(B,{type:"button",size:"small",variant:"outlined",color:"error",onClick:e.onDelete,children:"삭제"})]}),Nn=e=>{const{rootDb:t,isLoading:o,memoDetailData:n}=e;console.log("MemoDetail.memoDetailData.title=",n?.title,", bookmark=",n?.bookmark);const{scrollYProgress:l}=tt(),r=ot(l,{stiffness:100,damping:30,restDelta:.001}),[f,i]=g.useState(!1),u=Z(),a=g.useRef();a.current=e.searchWord;const{memoId:d}=Ye(),v=Ie()?.state?.fullIndex,{user:p}=ue(),c=()=>{const C=`/${t}/edit/${d}`;u(C,{state:{fullIndex:v}})},m=()=>{const C=`/${t}/insert/${d}`;u(C,{state:{fullIndex:v}})},h=async()=>{const C=t==="memo"?`${t}_txt/${p.uid}/${d}`:`${t}_txt/${d}`,j=t==="memo"?`${t}/${p.uid}`:t;if(await Yt(C,j)===void 0){alert("삭제에 실패했습니다.[code:d02]");return}e.onTreeUpdate(),u(`/${t}`)},b=()=>{window.confirm(`하위 자료가 있는 경우 같이 삭제됩니다.
삭제하시겠습니까?`)&&h()},y=()=>{i(!0)},N=()=>{e.onBookmark()},I=async C=>{try{const j=t==="memo"?`${t}_txt/${p.uid}`:`${t}_txt`,k=t==="memo"?`memo/${p.uid}`:t,R=await Gt(j,k,d,C);e.onTreeUpdate()}catch(j){console.log("catch",j)}finally{i(!1)}};return g.useEffect(()=>{n&&n.title!==void 0&&st({title:n.title,description:n.title});function C(){window.scrollTo({top:0}),n&&n.html!=="N"&&document.querySelectorAll("pre").forEach(j=>{j.innerHTML=oo(j.innerHTML)})}n&&n.memo!==null&&C()},[n]),o?s.jsx(W,{}):d===""||p===void 0?s.jsx(s.Fragment,{}):s.jsxs("div",{children:[s.jsx(jt.div,{className:"progress-bar",style:{scaleX:r}}),s.jsxs("div",{className:`grid grid-cols-3 
				items-center w-full 
				dark:bg-stone-950 rounded-md shadow-sm 
				dark:shadow-stone-800 shadow-stone-900`,children:[s.jsx("div",{}),s.jsx("div",{className:"flex justify-center",children:n&&n.title}),s.jsxs("div",{className:"text-right justify-end mr-3.5",children:[s.jsx(no,{"aria-label":"bookmark",onClick:N,children:n&&n.bookmark==="Y"?s.jsx(Ut,{sx:{color:"red"}}):s.jsx(qt,{})}),s.jsx("div",{className:"text-right mb-3 text-sm text-red-400",children:e.pathNm})]})]}),s.jsxs("div",{className:"w-full p-0 m-0",children:[s.jsx(vn,{rootDb:t,onEdit:c,onNewMemo:m,onMove:y,onDelete:b,onBookmark:N,bookmark:n&&n.bookmark}),s.jsxs(P,{sx:{my:2},children:[n&&n.html==="N"?s.jsx(nt,{postData:n&&n.memo}):n&&n.html!=="N"&&n.memo&&s.jsx(Tt,{text:n.memo}),s.jsx(to,{imageList:n&&n.image}),!n&&s.jsx(P,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:s.jsx(so,{sx:{mt:5}})})]}),s.jsx(bn,{userId:p?.uid,open:f,data:e.data,onClose:()=>i(!1),onPost:I})]})]})},In=({onSubmit:e,onCancel:t,isSubmitting:o,newMode:n})=>s.jsxs("div",{className:"flex justify-end mb-1.5 gap-1",children:[s.jsxs(de,{variant:"outlined",color:"success",disabled:o,onClick:l=>{l.preventDefault(),e(l)},children:[n?"새글":""," 저장"]}),s.jsx(de,{variant:"outlined",color:"error",onClick:t,children:"취소"})]}),yn=g.lazy(()=>Qe(()=>import("./index-DR2AJDfj.js").then(e=>e.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31])));Qt.Quill.register("modules/imageDrop",Xt);Je.configure({languages:["javascript","ruby","python","java","cpp","kotlin","sql"]});const Sn={syntax:{highlight:e=>Je.highlightAuto(e).value},toolbar:[[{header:"1"},{header:"2"},{header:"3"},{font:[]}],[{size:[]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","image","video"],["clean"],["code-block"]],imageDrop:!0,clipboard:{matchVisual:!1}},Cn=["header","font","size","bold","italic","underline","strike","blockquote","list","bullet","indent","link","image","video","clean","code-block","code-custom"],jn=e=>{const[t,o]=g.useState(e.imageList),[n,l]=g.useState(e.htmlCheck==="Y"),[r,f]=g.useState(e.newMode?"":e.content),i=g.useRef(),u=g.useRef(),a=g.useRef(null),d=g.useRef(null),x=e.newMode,v=g.useRef([]),{height:p}=lo(),c=ro.now().setZone("Asia/Seoul").toFormat("yyyy-MM-dd"),m={edTitle:x?"":e.title,edGbn:e.gbn?e.gbn:"etc",edDate:x?c:e.date,content:x?"":e.content,memoTxt:x?"":e.content,htmlCheck:e.htmlCheck},{register:h,handleSubmit:b,trigger:y,control:N,setValue:I,getValues:C,watch:j,formState:{errors:k,isSubmitting:R}}=io({mode:"onChange",defaultValues:m});g.useEffect(()=>{h("edDate",{required:!0,minLength:10}),h("edGbn",{required:!0}),h("htmlCheck"),h("memoTxt")},[]),g.useEffect(()=>{v.current=[],i.current=e.content,u.current=!1},[e.content]);const w=async S=>{x?await e.onNewSubmit(S,v.current):await e.onPostSubmit(S,t,v.current)},M=()=>{b(w)()},ee=S=>{console.log("onDelete.imageList=",S),o(S)},me=S=>{let T=i.current;S.ext==="jpg"?T+=`<img src='${S.url}'/>`:S.ext==="mp4"&&(T+=`<video preload="auto" controls="" src='${S.url}'></video>`),i.current=T},te=S=>{i.current=S},ge=S=>{console.log("handleFileUpload",S),v.current=S};function xe(S){i.current=S,I("content",S),y("content")}function U(S){console.log("handleChangeDate=",S);let T=he(S);T.format("YYYY-MM-DD HH:mm:ss"),console.log("handleChangeDate.dayjs=",T.format("YYYY-MM-DD HH:mm:ss")),I("edDate",T.format("YYYY-MM-DD")),y("edDate")}const oe=S=>{console.log("onChecked=",S),I("htmlCheck",S?"Y":"N"),l(S)},F=j("content"),_=[{value:"",text:"None"},{value:"react",text:"React"},{value:"css",text:"CSS"},{value:"android",text:"Android"},{value:"java",text:"JAVA"},{value:"image",text:"그림 / 사진"},{value:"etc",text:"기타"},{value:"mui",text:"MUI"}],ne=["React","JavaScript","Bash","Java","Kotlin","CSS","C++","C#","Command","Script","Python","Ruby","Go","Swift","Rust"],q=S=>{const T=a.current;if(T){const A=T.selectionStart,G=T.selectionEnd,V=r.slice(0,A),se=r.slice(G);f(V+S+se),I("memoTxt",V+S+se),setTimeout(()=>{T.selectionStart=T.selectionEnd=A+S.length,T.focus()},0)}},L=S=>{q(S)};return s.jsx("div",{className:"my-2 mb-[50px], w-full",children:s.jsxs("form",{onSubmit:b(w),style:{width:"100%",minHeight:"300px",maxHeight:{height:p},display:"flex",flexDirection:"column"},children:[s.jsx(In,{onSubmit:S=>M(),onCancel:e.onCancel,isSubmitting:R,newMode:x}),s.jsx(Jt,{control:N,onDelete:ee,onInsert:me,setContent:te,onFileUpload:ge,imageList:e.imageList}),s.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[s.jsx(mo,{...h("edTitle",{required:"해당 필드는 필수입니다.",minLength:{value:1,message:"1글자 이상 입력해주세요."}}),fullWidth:!0,label:"제목",placeholder:"제목",variant:"filled",size:"small",error:!!k.edTitle}),s.jsx(co,{id:"edGbn",name:"edGbn",label:"구분",mdSize:6,control:N,defaultValue:C("edGbn"),selectList:_,error:!!k.edGbn,onChange:S=>{S.preventDefault();const T=S.target.value;console.log("edGbn=",C("edGbn")),I("edGbn",T)}}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ao,{id:"edDate",label:"일자",mdSize:6,value:he(C("edDate")),...h("edDate"),defaultValue:he(C("edDate")),onChange:U}),s.jsx(uo,{id:"html",checked:n,onChange:oe,label:"HTML사용"})]})]}),s.jsx(O,{}),s.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-2",children:[s.jsx("div",{className:"max-h-130 overflow-y-scroll",children:s.jsx(nt,{postData:r})}),s.jsxs("div",{children:[s.jsx(fo,{ref:a,className:"",value:r,onChange:S=>{I("memoTxt",S),f(S)},rows:22}),s.jsx(O,{}),s.jsxs("div",{className:"grid grid-cols-4 gap-2 xsm:grid-cols-5 sm:grid-cols-7 md:grid-cols-7 lg:grid-cols-8",children:[s.jsx(ce,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L("<box></box>"),children:"<Box>"}),s.jsx(ce,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L("</code>"),children:"</code>"}),ne.map((S,T)=>s.jsx(ce,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L("<code>"+S+"</code>"),children:S},T)),s.jsx(ce,{className:"cursor-pointer",variant:"light",color:"dark",onClick:()=>L('<a href="" target="_blank"></a>'),children:"Link"})]}),s.jsx(O,{})]})]}),s.jsx(g.Suspense,{fallback:s.jsx("div",{children:"Loading editor..."}),children:s.jsx(yn,{ref:d,fullWidth:!0,theme:"snow",id:"content",name:"content",type:"div",value:F,style:{minWidth:"400px",border:"1px solid primary.main",minHeight:"200px",height:"400px",maxHeight:"450px"},modules:Sn,formats:Cn,onChange:xe})}),s.jsx(O,{})]})})},Fe=e=>{const{rootDb:t,isLoading:o,memoDetailData:n}=e,{scrollYProgress:l}=tt();ot(l,{stiffness:100,damping:30,restDelta:.001});const r=Z(),f=g.useRef(),i=g.useRef();i.current=e.searchWord;const{memoId:u}=Ye(),a=Ie(),d=n?.fullIndex,{user:x}=ue();f.current=a.pathname.split("/")[2]==="insert",console.log("MemoDetailEdit.memoDetailData=",n?.title),console.log("MemoDetailEdit.newMode=",f.current);const v=()=>{const m=`/${t}/${u==="insert"?"":u}`;r(m,{state:{fullIndex:d}})},p=async(m,h)=>{console.log("onNewSubmit.values",m),console.log("onNewSubmit.fullIndex",d);const b=t==="memo"?`${t}_txt/${x.uid}/`:`${t}_txt/`,y=t==="memo"?`${t}/${x.uid}/`:`${t}/`;console.log("onNewSubmit.txtLocate",b),console.log("onNewSubmit.locate",y);const N=await we(void 0,b,y,d,m);if(await Ee(`${t}_txt`,t,N,h),N!==void 0){const I=`/${t}/${N}`;r(I,{state:{reflash:!0}})}},c=async(m,h,b)=>{const y=t==="memo"?`${t}_txt/${x.uid}`:`${t}_txt`,N=t==="memo"?`${t}/${x.uid}`:t;await Zt(y,N,u,h),console.log("onPostSubmit.values",m);const I=await we(f.current?void 0:u,`${y}/`,`${N}/`,d,m);console.log("onPostSubmit.newKey=",I),console.log("onPostSubmit.files=",b);const C=await Ee(`${y}/`,`${N}/`,u,b);if(console.log("onNewSubmit.imageResult",C),console.log("onPostSubmit.fullIndex",d),t==="memo"&&d===void 0){const k=await Lt(x.uid,`${u}/fullIndex`);console.log("onPostSubmit.fullPath",k),k!==void 0&&Ft(`memo/${x.uid}/${k}/title`,m.edTitle)}f.current=!1;const j=`/${t}/${u}`;r(j,{state:{fullIndex:d,reflash:!0}})};return g.useEffect(()=>{n&&n.title!==void 0&&st({title:n.title,description:n.title});function m(){document.querySelectorAll("pre").forEach((h,b)=>{})}n&&n.memo!==null&&m()},[n]),u===""||x===void 0?s.jsx(s.Fragment,{}):(console.log("MemoDetailEdit.isLoading=",o),n===void 0||o?s.jsx(W,{}):s.jsx(s.Fragment,{children:s.jsx("div",{className:"w-full p-0 m-0",children:f.current===!1&&n&&(n.title===void 0||n.title===""||n.title===null)?s.jsx(W,{}):s.jsx(jn,{newMode:f.current,onPostSubmit:c,onNewSubmit:p,onCancel:v,title:n?.title,gbn:n?.gbn,date:n?.date,htmlCheck:n?.html?n?.html:"Y",content:n?.memo,imageList:n?.image})})}))},Tn=g.lazy(async()=>await Qe(()=>import("./MemoMain-CkJZ091Q.js"),__vite__mapDeps([32,1,2,24]))),kn=({rootDb:e})=>{const t=Z(),{user:o}=ue(),n=g.useRef(),l=g.useRef(),r=g.useRef(!0),f=g.useRef(),i=g.useRef(),[u,a]=g.useState(),d=g.useRef(!1),x=Ie(),v=g.useRef(!1);v.current=x?.state?.reflash===!0;const p=Dt({queryKey:["treeMemo",o?.uid,n.current],queryFn:()=>So(e,o?.uid,n.current)});p.data!==void 0&&p.data!==""&&!d.current&&(d.current=!0);const c=()=>{const I=u;I&&(I.bookmark=I.bookmark==="Y"?"N":"Y"),_t(o.uid,i.current,u.bookmark),a({...u,bookmark:I.bookmark})};g.useEffect(()=>{o!==void 0&&o!=null&&p.refetch()},[o]),g.useEffect(()=>{const I=async k=>{if(k!==""&&o){const R=await go(e,o?.uid,k,n.current);{const w=pt(p.data,{id:"",nm:""},k),M=w.id;l.current=w.nm,R.fullIndex=M,M!==f&&(f.current=M,Ot(o.uid,k,M))}R.bookmark===void 0&&(R.bookmark="N"),a(R),r.current=!1}},C=x.pathname.split("/"),j=C.length>2?C[C.length-1]:"";r.current=!0,I(j),i.current=j},[x.pathname,o]),g.useEffect(()=>{o!==void 0&&o!=null&&p.refetch()},[v.current]);const m=I=>{d.current=!1,I!==void 0&&(n.current=I),p.refetch()},h=(I,C)=>{if(I===i.current)return;r.current=!0;const j=`/${e}/${I}`;t(j,{state:{fullIndex:f.current}})},b=()=>{if(o==null){alert("로그인 후 이용 가능합니다.");return}const I=`/${e}/insert/insert`;t(I)},y=I=>{},N=s.jsxs("div",{className:"",children:[s.jsx(Co,{className:"mt-3 ",children:e==="memo"?"메모장":"홈페이지관리"}),s.jsxs("div",{className:"flex gap-7 justify-center",children:[s.jsx(ae,{to:"/",children:"홈"}),e==="memo"?"":s.jsx(ae,{to:"/memo",children:"메모"}),s.jsx(ae,{to:"/todo",children:"TODO"}),s.jsx(ae,{to:"/tw",children:"Sheet"})]}),s.jsx(yo,{onNewMemoBtn:b,onSearchDataBtn:m}),d.current&&p.isFetched?s.jsx(fn,{expandIndex:f.current,data:p.data,onDetail:h}):s.jsx(W,{})]});return o&&o.uid===kt&&Ht,s.jsxs(wt,{sideType:"memo",title:e==="memo"?"메모장":"홈페이지관리",sideContents:N,children:[s.jsx(g.Suspense,{fallback:s.jsx(W,{}),children:s.jsxs(Et,{children:[s.jsx(ie,{path:"/edit/:memoId",element:s.jsx(Fe,{rootDb:e,isLoading:r.current,searchWord:n.current,memoDetailData:u})}),s.jsx(ie,{path:"/insert/:memoId",element:s.jsx(Fe,{rootDb:e,isLoading:r.current,searchWord:n.current,memoDetailData:u})}),s.jsx(ie,{path:"/:memoId",element:s.jsx(Nn,{rootDb:e,isLoading:r.current,searchWord:n.current,memoDetailData:u,onTreeUpdate:m,pathNm:l.current,onBookmark:c,data:p.data})}),s.jsx(ie,{path:"*",element:s.jsx(Tn,{searchWord:n.current,data:p.data,onNewMemoBtn:b,title:e==="memo"?"메모장 홈":"홈페이지관리 홈"})})]})}),e==="memo"?s.jsx(Io,{onSelected:y}):"",s.jsx(Wt,{})]})},pt=(e,t,o)=>{let n={};if(e)for(let l=0;l<e.length;l++){const r=e[l];if(r.id===o)return n.id=t.id+r.id,n.nm=t.nm+r.title,n;if(r.sub!==null&&r.sub!==void 0){if(n.id=t.id+r.id+"/sub/",n.nm=t.nm+r.title+" > ",n=pt(Object.values(r.sub),n,o),n.id&&n.id.endsWith(o))return n;n={}}}return n},Ps=()=>s.jsx(kn,{rootDb:"memo"});export{Ps as default};
