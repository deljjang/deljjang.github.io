const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MemoSheetGrid-eLyz3PCN.js","assets/index-DRYhf1EU.js","assets/index-DHc_eIal.css","assets/MemoDetailEdit-Bxj9RY1c.js","assets/useMemoMutation-3c3fi1bl.js","assets/TwCheckbox-i8PuqLbB.js","assets/TwTextArea-CIPVVrW4.js","assets/angle-right-rSJLrUVR.js","assets/MemoDetailEdit-DAKl4fNk.css","assets/MemoDetailUtil-C2OrX9V3.js"])))=>i.map(i=>d[i]);
import{aR as mt,aS as ht,aT as R,aU as le,aV as Be,aW as We,aX as ft,aY as pt,aZ as gt,a_ as xt,a$ as yt,b0 as vt,b1 as Fe,b2 as wt,b3 as jt,b4 as ce,b5 as V,r as h,b6 as Re,b7 as we,b8 as Ae,b9 as se,ba as L,t as $,ad as He,ae as Ve,v as U,w as J,bb as kt,bc as bt,bd as $t,be as Ct,e as z,j as s,i as _,bf as Nt,h as Z,g as St,a as D,k as O,s as de,bg as P,V as Tt,l as M,p as x,bh as re,R as K,m as ae,bi as Mt,O as je,a1 as ke,H as Et,am as Lt,bj as _t,aK as ie,bk as Pe,ai as zt,aj as W,bl as be,_ as ee,bm as Ot,bn as Bt,f as ue,bo as Wt,bp as Ft,bq as Rt,br as At,bs as Ht,ak as Vt,al as me,bt as Pt,a9 as Ke,bu as Kt,aa as qt,x as qe,bv as Ye,bw as Ie,aF as he,a4 as Qe,J as Xe,bx as Yt,by as It,bz as Qt,bA as Xt,bB as Gt,bC as Ut}from"./index-DRYhf1EU.js";import{S as Ge,a as Jt,b as Zt}from"./angle-right-rSJLrUVR.js";const Q=new WeakMap;let X;const Ue=(e,t,r)=>(a,n)=>n&&n[0]?n[0][e+"Size"]:ht(a)&&"getBBox"in a?a.getBBox()[t]:a[r],Dt=Ue("inline","width","offsetWidth"),es=Ue("block","height","offsetHeight");function ts({target:e,borderBoxSize:t}){Q.get(e)?.forEach(r=>{r(e,{get width(){return Dt(e,t)},get height(){return es(e,t)}})})}function ss(e){e.forEach(ts)}function ns(){typeof ResizeObserver>"u"||(X=new ResizeObserver(ss))}function rs(e,t){X||ns();const r=mt(e);return r.forEach(a=>{let n=Q.get(a);n||(n=new Set,Q.set(a,n)),n.add(t),X?.observe(a)}),()=>{r.forEach(a=>{const n=Q.get(a);n?.delete(t),n?.size||X?.unobserve(a)})}}const G=new Set;let F;function as(){F=()=>{const e={get width(){return window.innerWidth},get height(){return window.innerHeight}};G.forEach(t=>t(e))},window.addEventListener("resize",F)}function is(e){return G.add(e),F||as(),()=>{G.delete(e),!G.size&&typeof F=="function"&&(window.removeEventListener("resize",F),F=void 0)}}function os(e,t){return typeof e=="function"?is(e):rs(e,t)}function Je(e,t){let r;const a=()=>{const{currentTime:n}=t,o=(n===null?0:n.value)/100;r!==o&&e(o),r=o};return R.preUpdate(a,!0),()=>le(a)}function ls(...e){const t=!Array.isArray(e[0]),r=t?0:-1,a=e[0+r],n=e[1+r],i=e[2+r],o=e[3+r],c=Be(n,i,o);return t?c(a):c}function cs(e,t,r){const a=e.get();let n=null,i=a,o;const c=typeof a=="string"?a.replace(/[\d.-]/g,""):void 0,u=()=>{n&&(n.stop(),n=null)},l=()=>{u(),n=new ft({keyframes:[Ce(e.get()),Ce(i)],velocity:e.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...r,onUpdate:o})};if(e.attach((d,m)=>{i=d,o=y=>m($e(y,c)),R.postRender(l)},u),We(t)){const d=t.on("change",y=>e.set($e(y,c))),m=e.on("destroy",d);return()=>{d(),m()}}return u}function $e(e,t){return t?e+t:e}function Ce(e){return typeof e=="number"?e:parseFloat(e)}const ds=50,Ne=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),us=()=>({time:0,x:Ne(),y:Ne()}),ms={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function Se(e,t,r,a){const n=r[t],{length:i,position:o}=ms[t],c=n.current,u=r.time;n.current=e[`scroll${o}`],n.scrollLength=e[`scroll${i}`]-e[`client${i}`],n.offset.length=0,n.offset[0]=0,n.offset[1]=n.scrollLength,n.progress=pt(0,n.scrollLength,n.current);const l=a-u;n.velocity=l>ds?0:gt(n.current-c,l)}function hs(e,t,r){Se(e,"x",t,r),Se(e,"y",t,r),t.time=r}function fs(e,t){const r={x:0,y:0};let a=e;for(;a&&a!==t;)if(xt(a))r.x+=a.offsetLeft,r.y+=a.offsetTop,a=a.offsetParent;else if(a.tagName==="svg"){const n=a.getBoundingClientRect();a=a.parentElement;const i=a.getBoundingClientRect();r.x+=n.left-i.left,r.y+=n.top-i.top}else if(a instanceof SVGGraphicsElement){const{x:n,y:i}=a.getBBox();r.x+=n,r.y+=i;let o=null,c=a.parentNode;for(;!o;)c.tagName==="svg"&&(o=c),c=a.parentNode;a=o}else break;return r}const oe={start:0,center:.5,end:1};function Te(e,t,r=0){let a=0;if(e in oe&&(e=oe[e]),typeof e=="string"){const n=parseFloat(e);e.endsWith("px")?a=n:e.endsWith("%")?e=n/100:e.endsWith("vw")?a=n/100*document.documentElement.clientWidth:e.endsWith("vh")?a=n/100*document.documentElement.clientHeight:e=n}return typeof e=="number"&&(a=t*e),r+a}const ps=[0,0];function gs(e,t,r,a){let n=Array.isArray(e)?e:ps,i=0,o=0;return typeof e=="number"?n=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?n=e.split(" "):n=[e,oe[e]?e:"0"]),i=Te(n[0],r,a),o=Te(n[1],t),i-o}const xs={All:[[0,0],[1,1]]},ys={x:0,y:0};function vs(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function ws(e,t,r){const{offset:a=xs.All}=r,{target:n=e,axis:i="y"}=r,o=i==="y"?"height":"width",c=n!==e?fs(n,e):ys,u=n===e?{width:e.scrollWidth,height:e.scrollHeight}:vs(n),l={width:e.clientWidth,height:e.clientHeight};t[i].offset.length=0;let d=!t[i].interpolate;const m=a.length;for(let y=0;y<m;y++){const v=gs(a[y],l[o],u[o],c[i]);!d&&v!==t[i].interpolatorOffsets[y]&&(d=!0),t[i].offset[y]=v}d&&(t[i].interpolate=Be(t[i].offset,yt(a),{clamp:!1}),t[i].interpolatorOffsets=[...t[i].offset]),t[i].progress=vt(0,1,t[i].interpolate(t[i].current))}function js(e,t=e,r){if(r.x.targetOffset=0,r.y.targetOffset=0,t!==e){let a=t;for(;a&&a!==e;)r.x.targetOffset+=a.offsetLeft,r.y.targetOffset+=a.offsetTop,a=a.offsetParent}r.x.targetLength=t===e?t.scrollWidth:t.clientWidth,r.y.targetLength=t===e?t.scrollHeight:t.clientHeight,r.x.containerLength=e.clientWidth,r.y.containerLength=e.clientHeight}function ks(e,t,r,a={}){return{measure:n=>{js(e,a.target,r),hs(e,r,n),(a.offset||a.target)&&ws(e,r,a)},notify:()=>t(r)}}const H=new WeakMap,Me=new WeakMap,ne=new WeakMap,Ee=e=>e===document.scrollingElement?window:e;function Ze(e,{container:t=document.scrollingElement,...r}={}){if(!t)return Fe;let a=ne.get(t);a||(a=new Set,ne.set(t,a));const n=us(),i=ks(t,e,n,r);if(a.add(i),!H.has(t)){const c=()=>{for(const m of a)m.measure(wt.timestamp);R.preUpdate(u)},u=()=>{for(const m of a)m.notify()},l=()=>R.read(c);H.set(t,l);const d=Ee(t);window.addEventListener("resize",l,{passive:!0}),t!==document.documentElement&&Me.set(t,os(t,l)),d.addEventListener("scroll",l,{passive:!0}),l()}const o=H.get(t);return R.read(o,!1,!0),()=>{le(o);const c=ne.get(t);if(!c||(c.delete(i),c.size))return;const u=H.get(t);H.delete(t),u&&(Ee(t).removeEventListener("scroll",u),Me.get(t)?.(),window.removeEventListener("resize",u))}}const Le=new Map;function bs(e){const t={value:0},r=Ze(a=>{t.value=a[e.axis].progress*100},e);return{currentTime:t,cancel:r}}function De({source:e,container:t,...r}){const{axis:a}=r;e&&(t=e);const n=Le.get(t)??new Map;Le.set(t,n);const i=r.target??"self",o=n.get(i)??{},c=a+(r.offset??[]).join(",");return o[c]||(o[c]=!r.target&&jt()?new ScrollTimeline({source:t,axis:a}):bs({container:t,...r})),o[c]}function $s(e,t){const r=De(t);return e.attachTimeline({timeline:t.target?void 0:r,observe:a=>(a.pause(),Je(n=>{a.time=a.iterationDuration*n},r))})}function Cs(e){return e.length===2}function Ns(e,t){return Cs(e)?Ze(r=>{e(r[t.axis].progress,r)},t):Je(e,De(t))}function Ss(e,{axis:t="y",container:r=document.scrollingElement,...a}={}){if(!r)return Fe;const n={axis:t,container:r,...a};return typeof e=="function"?Ns(e,n):$s(e,n)}const Ts=()=>({scrollX:V(0),scrollY:V(0),scrollXProgress:V(0),scrollYProgress:V(0)}),I=e=>e?!e.current:!1;function Ms({container:e,target:t,...r}={}){const a=ce(Ts),n=h.useRef(null),i=h.useRef(!1),o=h.useCallback(()=>(n.current=Ss((c,{x:u,y:l})=>{a.scrollX.set(u.current),a.scrollXProgress.set(u.progress),a.scrollY.set(l.current),a.scrollYProgress.set(l.progress)},{...r,container:e?.current||void 0,target:t?.current||void 0}),()=>{n.current?.()}),[e,t,JSON.stringify(r.offset)]);return Re(()=>{if(i.current=!1,I(e)||I(t)){i.current=!0;return}else return o()},[o]),h.useEffect(()=>{if(i.current)return we(!I(e)),we(!I(t)),o()},[o]),a}function et(e){const t=ce(()=>V(e)),{isStatic:r}=h.useContext(Ae);if(r){const[,a]=h.useState(e);h.useEffect(()=>t.on("change",a),[])}return t}function tt(e,t){const r=et(t()),a=()=>r.set(t());return a(),Re(()=>{const n=()=>R.preRender(a,!1,!0),i=e.map(o=>o.on("change",n));return()=>{i.forEach(o=>o()),le(a)}}),r}function Es(e){se.current=[],e();const t=tt(se.current,e);return se.current=void 0,t}function Ls(e,t,r,a){if(typeof e=="function")return Es(e);const n=ls(t,r,a);return Array.isArray(e)?_e(e,n):_e([e],([i])=>n(i))}function _e(e,t){const r=ce(()=>[]);return tt(e,()=>{r.length=0;const a=e.length;for(let n=0;n<a;n++)r[n]=e[n].get();return t(r)})}function _s(e,t={}){const{isStatic:r}=h.useContext(Ae),a=()=>We(e)?e.get():e;if(r)return Ls(a);const n=et(a());return h.useInsertionEffect(()=>cs(n,e,t),[n,JSON.stringify(t)]),n}const zs=async(e,t)=>(await L(e)===void 0||$(e,null),$(t,null),"OK"),on=async({rootDb:e,uid:t,newData:r=!1,key:a,values:n})=>{const i=e==="memo"?`${e}_txt/${t}/`:`${e}_txt/`,o=e==="memo"?`${e}_tree/${t}/`:`${e}/`;let c=a;r&&(c=He(Ve(U(J),o)).key),console.log("setFireDetailData.values=",n);const u=i+c;return $(u+"/title",n.edTitle),n.htmlCheck==="N"||n.htmlCheck==="sheet"?$(u+"/memo",n.memoTxt):$(u+"/memo",n.content),$(u+"/date",n.edDate),$(u+"/gbn",n.edGbn),$(u+"/html",n.htmlCheck),r&&e!=="home"&&($(`${o}/${c}/key`,c),$(`${o}/${c}/parent`,a)),e!=="home"&&($(`${o}${c}/title`,n.edTitle),$(`${o}${c}/icon`,n.iconCheck)),c},ln=async(e,t,r,a)=>{if(a!==void 0)for(let n=0;n<a.length;n++){const i=a[n];i.del==="Y"&&($(`${e}/${r}/image/${i.key}`,null),kt(t,r,i))}},cn=async(e,t,r,a)=>{for(let n=0;n<a.length;n++){const i=a[n].object,c={ext:bt(i.name),name:i.name,use:"Y",sever:""},u=He(Ve(U(J),e+"/image")).key,l=await $t(t,r,u,i);c.sever=Ct(l.metadata.name);const d=`${e}${r}/image/${c.sever}`;$(d,c)}},ze=e=>{const{t}=z();return s.jsxs("div",{className:"mx-auto grid w-full max-w-lg grid-cols-5 items-center justify-center gap-2 px-4 py-2 text-center",children:[e.master&&s.jsx(_,{size:"sm",variant:"outlined",color:"brand",onClick:e.onUtil,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l-.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),s.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("util")})]})}),s.jsx(_,{size:"sm",variant:"outlined",color:"brand",onClick:e.onEdit,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),s.jsx("path",{d:"m15 5 4 4"})]}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("edit")})]})}),s.jsx(_,{size:"sm",variant:"outlined",color:"brand",onClick:e.onNewMemo,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M5 12h14"}),s.jsx("path",{d:"M12 5v14"})]}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("new")})]})}),s.jsx(_,{size:"sm",variant:"outlined",color:"error",onClick:e.onDelete,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M3 6h18"}),s.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),s.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("delete")})]})}),e.onCopy&&s.jsx(_,{size:"sm",variant:"outlined",color:"secondary",onClick:e.onCopy,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:s.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("public")})]})})]})},Os=({rootDb:e,memoDetailData:t,onBookmark:r,searchWord:a,onDeleteTab:n})=>{const[i,o]=h.useState(!1),{alertInfo:c,setAlertInfo:u,resetAlertInfo:l}=Nt(),[d,m]=h.useState(!1),[y,v]=h.useState(""),[k,b]=h.useState(!1),[p,g]=h.useState(""),[w,T]=h.useState(!1),{t:C}=z(),{scrollYProgress:E}=Ms(),A=_s(E,{stiffness:100,damping:30,restDelta:.001}),q=Z(),{memoId:j}=St(),te=D()?.state?.fullIndex,{user:S}=O(),B=de(),st=P({mutationFn:async()=>{const f=e==="memo"?`${e}_txt/${S.uid}/${j}`:`${e}_txt/${j}`,N=e==="memo"?`${e}_tree/${S.uid}/${j}`:`${e}/${j}`;return await zs(f,N)},onSuccess:()=>{B.invalidateQueries({queryKey:["twTreeData",e]}),n&&n(j),q(`/${e==="memo"?"m":e}`)},onError:f=>{console.error("삭제 중 오류 발생:",f)}}),nt=P({mutationFn:async()=>{if(!S||!j||e!=="memo")throw new Error("Only private memos can be copied.");`${S.uid}${j}`;const f=t;if(!f)throw new Error("Memo data not found.");const N=`home_txt/${j}`;await $(N,f);const Y=`memo_tree/${S.uid}/${j}`,ut=`home/${j}`;await $(`${Y}/public`,"Y"),await $(ut,{...f,key:j,text:f.title})},onSuccess:()=>{u({isOpen:!0,title:C("complete"),message:C("copy_completed"),color:"success",onConfirm:l,onClose:l}),B.invalidateQueries({queryKey:["memoDetail","home",S?.uid,j]})},onError:f=>{console.error("Copy failed:",f);const N=`${C("copy_failed")} ${f.message?`: ${f.message}`:""}`;u({isOpen:!0,title:C("error"),message:N,color:"error",onConfirm:l,onClose:l})}}),fe=P({mutationFn:async f=>{const N=e==="memo"?`memo_txt/${S.uid}/${j}/title`:`home_txt/${j}/title`,Y=e==="memo"?`memo_tree/${S.uid}/${j}/title`:`home/${j}/title`;return await $(N,f),await $(Y,f),f},onSuccess:f=>{B.setQueryData(["memoDetail",e,S?.uid,j],N=>({...N,title:f})),B.invalidateQueries({queryKey:["twTreeData",e]}),B.invalidateQueries({queryKey:["tabTitle",e,S?.uid,j]}),b(!1)},onError:f=>{console.error("제목 업데이트 중 오류 발생:",f),b(!1)}}),rt=P({mutationFn:async f=>{const N=e==="memo"?`memo_txt/${S.uid}/${j}/memo`:`home_txt/${j}/memo`;return await $(N,f),f},onSuccess:f=>{B.setQueryData(["memoDetail",e,S?.uid,j],N=>({...N,memo:f})),m(!1)},onError:f=>{console.error("메모 저장 중 오류 발생:",f)}}),at=()=>{rt.mutate(y)},it=()=>{v(t?.memo||""),m(!0)},ot=()=>{g(t?.title||""),b(!0)},lt=f=>{g(f.target.value)},ct=f=>{f.key==="Enter"?fe.mutate(p):f.key==="Escape"&&b(!1)},pe=()=>{const f=`/${e==="memo"?"m":e}/edit/${j}`;q(f,{state:{fullIndex:te}})},ge=()=>{const f=`/${e==="memo"?"m":e}/util/${j}`;q(f,{state:{fullIndex:te}})},xe=()=>{const f=`/${e==="memo"?"m":e}/insert/${j}`;q(f,{state:{fullIndex:te}})},ye=()=>{o(!0)},ve=()=>{nt.mutate()},dt=()=>{o(!1),st.mutate()};return h.useEffect(()=>{function f(){const N=t.scrollY?t.scrollY:0;window.scrollTo({top:N})}t&&t.memo!==null&&(f(),t.image&&t.image.map((N,Y)=>N),Tt({title:t.title,description:""}))},[t]),j===""||S===void 0?null:s.jsxs("div",{className:"MemoDetail py-4 relative rounded-t-lg",children:[s.jsx(M.div,{className:`progress-bar sticky ${w?"top-28":"top-16"} z-10`,style:{scaleX:A}}),s.jsxs("div",{className:"MemoDetail_body overflow-hidden ",children:[s.jsxs("div",{className:`sticky top-0 z-20 ${x.card} backdrop-blur-sm`,children:[s.jsxs("div",{className:"p-3 sm:p-4",children:[s.jsxs("div",{className:x.between,children:[s.jsxs("p",{className:`${x.truncate} ${x.textXs} ${x.textGray500DarkZinc400}`,children:[s.jsx(re,{to:e==="memo"?"/m":"/hmoe",className:"dark:hover:!text-white hover:!text-gray-900",children:e==="memo"?"MEMO":"HOME"}),t?.path?.map((f,N)=>t.path.length===N+1?` > ${f?.title}`:s.jsxs(K.Fragment,{children:[" "," > ",s.jsx(re,{to:e==="memo"?`/m/${f.id}`:`/home/${f.id}`,className:"dark:hover:!text-white hover:!text-gray-900",children:f?.title})]},N))]}),s.jsx(M.button,{whileTap:{scale:.8},className:`${x.flexShrink0} ${x.roundedFull} p-2 ${x.buttonHoverGrayLight}`,"aria-label":C("bookmark"),onClick:r,children:t?.bookmark==="Y"?s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`${x.h5W5} ${x.textRed500}`,fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}):s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`${x.h5W5} ${x.textGray500}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})})]}),k?s.jsx("input",{type:"text",value:p,onChange:lt,onKeyDown:ct,onBlur:()=>fe.mutate(p),className:`w-full bg-transparent border-b-2 border-blue-500 focus:outline-none 
													${x.heading2XlBoldSm3Xl} ${x.textGray900}`,autoFocus:!0}):s.jsx("div",{onDoubleClick:ot,className:`MemoDetail_Title text-left ${x.heading2XlBoldSm3Xl} ${x.textGray900} cursor-pointer`,children:t?.title}),s.jsx("button",{onClick:()=>T(!w),className:`${x.floatingActionButton} absolute top-11 sm:top-14 right-2 sm:right-3`,children:s.jsx(M.div,{animate:{rotate:w?135:0},children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})})]}),s.jsx(M.div,{initial:!1,animate:{height:w?"auto":0,opacity:w?1:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:s.jsx("div",{className:"border-t border-gray-200 bg-gray-50 dark:border-zinc-800 dark:bg-zinc-900/50",children:s.jsx(ze,{master:S?.uid===ae,rootDb:e,onEdit:pe,onUtil:ge,onNewMemo:xe,onDelete:ye,onCopy:e==="memo"?ve:null})})})]}),t&&t.html==="sheet"&&s.jsx(Mt,{rootDb:e,detailData:t}),s.jsxs("div",{className:`MemoDetail_Content ${t?.memo?.length>0?`${x.card} my-4 p-2 sm:p-4`:"p-1"}`,onDoubleClick:it,children:[d?s.jsxs("div",{className:`${x.card} p-4`,children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(je,{children:C("input")}),s.jsx("textarea",{className:"w-full h-64 p-2 border rounded dark:bg-gray-700 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500",value:y,onChange:f=>v(f.target.value),autoFocus:!0})]}),s.jsxs("div",{children:[s.jsx(je,{children:C("preview")}),s.jsx("div",{className:"prose dark:prose-invert max-w-none p-2 border rounded h-64 overflow-y-auto dark:bg-gray-700 dark:border-gray-600",children:s.jsx(ke,{postData:y,highlightWord:""})})]})]}),s.jsxs("div",{className:"mt-2 flex justify-end gap-2",children:[s.jsx(_,{variant:"outlined",color:x.button.indigo,size:"sm",onClick:()=>m(!1),children:C("cancel")}),s.jsx(_,{color:x.button.indigo,onClick:at,children:C("save")})]})]}):t&&t.html!=="sheet"?t?.html==="N"?s.jsx(ke,{postData:t?.memo,highlightWord:a}):t?.html!=="N"&&t?.memo&&s.jsx(Et,{text:t.memo}):"",s.jsx(Lt,{imageList:t?.image}),!t&&s.jsx("div",{className:"flex justify-center py-12",children:s.jsx("div",{className:`${x.flexCenter} py-12`})})]})]}),s.jsx(_t,{rootDb:e,memoId:j,enableEdit:!0}),s.jsx(M.div,{initial:!1,animate:{height:w?"auto":0,opacity:w?1:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:s.jsx("div",{className:`${x.line}`,children:s.jsx(ze,{master:S?.uid===ae,rootDb:e,onEdit:pe,onUtil:ge,onNewMemo:xe,onDelete:ye,onCopy:e==="memo"?ve:null})})}),s.jsx(ie,{isOpen:i,size:"sm",color:"warning",title:C("delete_confirm_title"),message:C("delete_confirm_message"),onClose:()=>o(!1),onConfirm:dt}),s.jsx(ie,{...c})]})},Bs=K.lazy(()=>ee(()=>import("./MemoSheetGrid-eLyz3PCN.js"),__vite__mapDeps([0,1,2]))),Oe=K.lazy(()=>ee(()=>import("./MemoDetailEdit-Bxj9RY1c.js"),__vite__mapDeps([3,1,2,4,5,6,7,8]))),Ws=K.lazy(()=>ee(()=>import("./MemoDetailUtil-C2OrX9V3.js"),__vite__mapDeps([9,1,2,6,4,7]))),Fs=K.lazy(()=>ee(()=>import("./index-DRYhf1EU.js").then(e=>e.bW),__vite__mapDeps([1,2]))),Rs=({rootDb:e,user:t,memoId:r,memoDetailData:a,isLoading:n,onBookmark:i,handleCloseTab:o})=>{const c=D();return s.jsx(h.Suspense,{fallback:s.jsx(be,{}),children:s.jsx(Pe,{children:s.jsxs(zt,{location:c,children:[s.jsx(W,{path:"todo",element:s.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(Fs,{})})}),s.jsx(W,{path:"sheet/:sheetId?",element:s.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(Bs,{detailData:a})})}),s.jsx(W,{path:"edit/:memoId",element:s.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(Oe,{rootDb:e,isLoading:n,memoDetailData:a})})}),s.jsx(W,{path:"insert/:memoId",element:s.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(Oe,{rootDb:e,isLoading:n,memoDetailData:a})})}),s.jsx(W,{path:"util/:memoId",element:s.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(Ws,{rootDb:e,isLoading:n,memoDetailData:a})})}),s.jsx(W,{path:":memoId",element:s.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:n?s.jsx(be,{}):s.jsx(Os,{rootDb:e,memoDetailData:a,onBookmark:i,onDeleteTab:()=>o(null,{id:r})})})})]},c.pathname)})})},As=e=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...e,children:s.jsx("path",{fillRule:"evenodd",d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zM6 20V4h7v5h5v11H6zM8 12h3v3H8v-3zm0 4h3v3H8v-3zm4-4h3v3h-3v-3zm0 4h3v3h-3v-3z",clipRule:"evenodd"})}),Hs=({tabInfo:e,handleCloseTab:t,isActive:r})=>{const{t:a}=z(),{user:n}=O(),{attributes:i,listeners:o,setNodeRef:c,transform:u,transition:l,isDragging:d}=Ot({id:e.id}),m={transform:Bt.Transform?.toString(u),transition:l,zIndex:d?1:"auto"},{data:y}=ue({queryKey:["tabTitle",e.rootDb,n?.uid,e.id],queryFn:async()=>e.rootDb==="sheet"?await L(`memo_sheet/${n?.uid}/${e.id}/title`):e.rootDb==="memo"?await L(`${e.rootDb}_txt/${n?.uid}/${e.id}/title`):e.rootDb==="home"?await L(`${e.rootDb}_txt/${e.id}/title`):e.title,enabled:!!n&&!!e.id,staleTime:1/0,placeholderData:e.title});return s.jsxs(re,{ref:c,style:m,...i,...o,"data-tab-id":e.id,to:e.path,title:y,end:!0,className:({isActive:v})=>`SortableTab group relative flex flex-shrink-0 items-center pl-3 pr-2 py-1.5 text-sm rounded-t-md transition-colors duration-200 min-w-28 max-w-48 border-b-2
				${v?"bg-gray-200 dark:bg-zinc-700 border-blue-500 text-gray-800 dark:text-gray-100":"border-transparent text-secondary hover:bg-gray-200/70 dark:hover:bg-zinc-700/70"}
				${d?"opacity-50 shadow-lg":""}`,children:[e.rootDb==="memo"?s.jsx(Wt,{className:`w-5 h-5 mr-1 flex-shrink-0 transition-transform duration-200 ${r?"scale-110":""}`,fill:"currentColor"}):e.rootDb==="sheet"?s.jsx(As,{className:`w-5 h-5 mr-1 flex-shrink-0 transition-transform duration-200 ${r?"scale-110":""}`}):null,s.jsx("span",{className:"truncate pr-1",style:{fontFamily:"sans-serif"},children:y||a("loading")}),s.jsx("button",{onClick:v=>t(v,e),className:`ml-auto flex-shrink-0 p-1 rounded-full transition-opacity duration-200 opacity-0 group-hover:opacity-100
					text-gray-500 dark:text-gray-400 
					hover:bg-gray-300/50 dark:hover:bg-gray-600/50 hover:text-gray-700 dark:hover:text-white
				`,children:s.jsx(Ge,{className:"w-3 h-3"})})]})},Vs=({openTabs:e,setOpenTabs:t,handleCloseTab:r,handleCloseAllTabs:a,activeId:n})=>{const i=h.useRef(null),[o,c]=h.useState({left:!1,right:!1}),[u,l]=h.useState({left:0,width:0}),[d,m]=h.useState(!0),y=h.useRef(0),v=h.useCallback(()=>{const p=i.current;if(p){const g=p.scrollWidth>p.clientWidth,w=p.scrollLeft===0,T=p.scrollLeft+p.clientWidth>=p.scrollWidth-1;c(C=>{const E={left:g&&!w,right:g&&!T};return C.left===E.left&&C.right===E.right?C:E})}},[]);h.useEffect(()=>{const p=()=>{const g=window.pageYOffset||document.documentElement.scrollTop;g>y.current?m(!1):m(!0),y.current=g<=0?0:g};return window.addEventListener("scroll",p),()=>{window.removeEventListener("scroll",p)}},[]);const k=p=>{i.current?.scrollBy({left:p==="left"?-200:200,behavior:"smooth"})},b=p=>{const{active:g,over:w}=p;console.log("active=",g,"over=",w),g.id!==w.id&&t(T=>{const C=T.findIndex(A=>A.id===g.id),E=T.findIndex(A=>A.id===w.id);return Ht(T,C,E)})};return h.useEffect(()=>{v();const p=i.current;return p?.addEventListener("scroll",v),window.addEventListener("resize",v),()=>{p?.removeEventListener("scroll",v),window.removeEventListener("resize",v)}},[e,v]),h.useEffect(()=>{const p=setTimeout(()=>{const g=i.current?.querySelector(`[data-tab-id="${n}"]`);if(g){const{offsetLeft:w,offsetWidth:T}=g;l({left:w,width:T})}},0);return()=>clearTimeout(p)},[n,e]),s.jsx("div",{className:`MemoTabs sticky ${d?"top-18":"top-1"} z-1000 rounded-t-md bg-gray-50/70 dark:bg-zinc-800/70 backdrop-blur-sm shadow-sm`,children:s.jsxs("div",{className:"relative flex items-center justify-between ",children:[o.left&&s.jsx("button",{onClick:()=>k("left"),className:"absolute left-0 z-10 p-1 border border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 bg-white dark:bg-zinc-900 dark:hover:!text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full group",children:s.jsx(Jt,{className:"w-5 h-5 fill-current"})}),s.jsx(Ft,{id:"memo-tabs",onDragEnd:b,children:s.jsx("div",{ref:i,className:"MemoTabs relative flex items-center overflow-x-scroll scrollbar-hide whitespace-nowrap",children:s.jsx(Rt,{items:e.map(p=>p.id),strategy:At,children:s.jsx(Pe,{children:e.map(p=>s.jsx(M.div,{layout:!0,initial:{opacity:0,scale:.8},transition:{type:"spring",stiffness:350,damping:30},animate:{opacity:1,scale:1},exit:{opacity:0,width:0,paddingLeft:0,paddingRight:0,transition:{duration:.3}},children:s.jsx(Hs,{tabInfo:p,handleCloseTab:r,isActive:p.id===n})},p.id))})})})}),s.jsxs("div",{className:"flex items-center",children:[o.right&&s.jsx("button",{onClick:()=>k("right"),className:"z-10 p-1 border border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 bg-white dark:bg-zinc-900 dark:hover:!text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full group",children:s.jsx(Zt,{className:"w-5 h-5 fill-current"})}),e.length>0&&s.jsx("button",{onClick:a,className:"ml-2 mr-2 p-1.5 text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md",title:"Close all tabs",children:s.jsx(Ge,{className:"w-4 h-4"})})]})]})})},Ps=async(e,t)=>{const r=[];let a=t;if(!e||!a)return r;for(;a&&a!=="root";){const n=await L(`memo_tree/${e}/${a}`);if(!n)break;r.unshift({id:a,...n}),a=n.parent}return r};function Ks(e,t,r,a){const n=de(),{data:i,isLoading:o}=ue({queryKey:["memoDetail",e,t?.uid,r],queryFn:async()=>{if(!r||!t||r==="insert")return{};if(e==="memo"||e==="home"){const l=await Vt(e,t.uid,r);if(l&&e==="memo"){l.path=await Ps(t?.uid,r);const d=await L(`memo_tree/${t.uid}/${r}/bm`);l.bookmark=d==="Y"?"Y":"N"}return l||{}}else if(e==="sheet")return{title:await L(`memo_sheet/${t.uid}/${r}/title`)}},enabled:!!t&&!!r,staleTime:1e3*60*5}),{mutate:c}=P({mutationFn:async l=>{const d=e==="memo"?`memo_tree/${t.uid}/${r}/bm`:`home_txt/${r}/bookmark`;await $(d,l)},onMutate:async l=>{await n.cancelQueries({queryKey:["memoDetail",e,t?.uid,r]});const d=n.getQueryData(["memoDetail",e,t?.uid,r]);return n.setQueryData(["memoDetail",e,t?.uid,r],m=>({...m,bookmark:l})),{previousMemoDetail:d}},onError:(l,d,m)=>{n.setQueryData(["memoDetail",e,t?.uid,r],m.previousMemoDetail)},onSettled:()=>{n.invalidateQueries({queryKey:["memoDetail",e,t?.uid,r],refetchType:"all"}),n.invalidateQueries({queryKey:["twTreeData",e],refetchType:"all"}),n.invalidateQueries({queryKey:["bookmarks",t?.uid],refetchType:"all"}),a(!0)}});return{memoDetailData:i,isLoading:o,onBookmark:()=>{if(!i)return;const l=i.bookmark==="Y"?"N":"Y";c(l)}}}function qs(e,t,r,a,n){const i=r?.uid,[o,c]=h.useState(()=>{try{const k=localStorage.getItem(`openTabs_${i}`);return k?JSON.parse(k):[]}catch(k){return console.error("Failed to parse openTabs from localStorage",k),[]}}),u=h.useRef(),l=D(),d=Z(),m=h.useCallback(async k=>{if(e&&a&&a!=="insert"&&l.pathname!=="/m"&&l.pathname!=="/home"){const b={id:a,path:l.pathname,icon:null,rootDb:t,title:k?.title};if(l.pathname.startsWith("/m/sheet/")){const p=await L(`memo_sheet/${r?.uid}/${a}/title`);b.title=p}else a==="sheet"&&(b.title="Main Sheet");!o.some(p=>p.id===b.id)&&u.current!==a?(u.current=a,c(p=>[...p,b])):(u.current="",c(p=>p.map(g=>g.id===b.id?{...g,title:b.title||g.title}:g)))}},[n,e]);h.useEffect(()=>{n&&m(n)},[n,e]),h.useEffect(()=>{if(i)try{localStorage.setItem(`openTabs_${i}`,JSON.stringify(o))}catch(k){console.error("Failed to save openTabs to localStorage",k)}},[o,i]);const y=h.useCallback((k,b)=>{k?.preventDefault(),k?.stopPropagation(),u.current="";const p=o.findIndex(w=>w.id===b.id),g=o.filter(w=>w.id!==b.id);if(c(g),l.pathname.includes(b.id)){const w=g.length>0?g[Math.max(0,p-1)].path:`/${t==="memo"||t==="sheet"?"m":t}`;d(w,{relative:"path"})}},[o,l.pathname,t,d]),v=h.useCallback(()=>{u.current="",c([]),d(`/${t==="memo"||t==="sheet"?"m":t}`)},[t,d]);return{openTabs:o,setOpenTabs:c,handleCloseTab:y,handleCloseAllTabs:v}}const Ys=({item:e})=>{const{user:t}=O(),r=Z();return s.jsx("div",{onClick:()=>r(`/m/${e.key}`),className:`${x.roundedXl} border border-gray-200 
      bg-white dark:border-gray-800 dark:bg-white/[0.03] 
      overflow-hidden cursor-pointer hover:shadow-md transition-shadow h-full flex flex-col`,children:s.jsx("div",{className:"px-4 py-3",children:s.jsx("h3",{className:"text-base font-medium text-gray-800 dark:text-white/90 truncate",children:e.title})})})};function Is(){const{user:e}=O(),{t}=z(),{data:r,isLoading:a}=ue({queryKey:["bookmarks",e?.uid],queryFn:async()=>{const i=[],o=Ke(U(J,`memo_tree/${e.uid}`),qt("bm"),Kt("Y")),c=await qe(o);if(!c.exists())return[];const u=c.val();for(let l in u){const d=u[l];d.id=l,d.key=l,d.text=d.title,i.push(d)}return i.sort((l,d)=>l.title>d.title?1:-1),i},enabled:!!e}),n="grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4";return e===null?s.jsx(s.Fragment,{}):s.jsx(me,{title:t("main_list"),children:s.jsx("div",{className:"p-2",children:a?s.jsx(Pt,{}):s.jsx("div",{className:`grid ${n} gap-3`,children:r?.map(i=>s.jsx(Ys,{item:i},i.id))})})})}const Qs=()=>{const[e,t]=h.useState({labels:[],series:[]}),[r,a]=h.useState(null),[n,i]=h.useState({isOpen:!1}),{t:o}=z();return h.useEffect(()=>{(async()=>{const u=await L("home_cnt");if(u){a(u);const d=Object.keys(u).sort().reverse().slice(0,30),m=d.map(v=>v.split("-").slice(1).join("-")),y=d.map(v=>Object.keys(u[v]).length);t({labels:m,series:y})}})()},[]),s.jsxs(s.Fragment,{children:[s.jsx(ie,{...n}),s.jsx(me,{title:o("visitors.count"),className:"w-full justify-center mt-5",children:s.jsx(Ye,{series:[{name:o("count"),data:e.series}],labels:e.labels,showDownload:!1,onDataPointSelection:(c,u,l)=>{const d=l.dataPointIndex;if(r&&d>-1){const y=Object.keys(r).sort().reverse()[d],v=r[y],k=Object.keys(v).join("<br/>");i({isOpen:!0,title:`${y} ${o("visitors.count")}`,message:k,onClose:()=>i({isOpen:!1})})}}})})]})};function Xs({series:e,labels:t}){const[r,a]=h.useState({labels:[],colors:Ie,dataLabels:{style:{colors:["#333"]}},responsive:[{breakpoint:480,options:{chart:{width:"100%"},legend:{position:"bottom"}}}]});return h.useEffect(()=>{a(n=>({...n,labels:t}))},[t]),s.jsx("div",{className:"bg-amber-50 dark:bg-gray-900 shadow-md rounded-sm p-2",children:e&&e.length>0?s.jsx(he,{type:"donut",series:e,options:r}):s.jsx("div",{className:"text-center text-gray-500 py-10",children:"표시할 데이터가 없습니다."})})}function Gs({series:e,labels:t}){const[r,a]=h.useState({chart:{type:"radar"},colors:["#008FFB"],dataLabels:{enabled:!1},xaxis:{categories:[]},yaxis:{show:!1}});return h.useEffect(()=>{a(n=>({...n,xaxis:{...n.xaxis,categories:t}}))},[t]),s.jsx("div",{className:"bg-white dark:bg-black shadow-md rounded-sm p-2",children:e&&e.length>0&&e[0].data.length>0?s.jsx(he,{type:"radar",series:e,options:r}):s.jsx("div",{className:"text-center text-gray-500 py-10",children:"표시할 데이터가 없습니다."})})}function Us({series:e,labels:t}){const[r,a]=h.useState({labels:[],colors:Ie,plotOptions:{pie:{startAngle:-90,endAngle:90,offsetY:10}},grid:{padding:{bottom:-80}},dataLabels:{style:{colors:["#333"]}},responsive:[{breakpoint:480,options:{chart:{width:"100%"},legend:{position:"bottom"}}}]});return h.useEffect(()=>{a(n=>({...n,labels:t}))},[t]),s.jsx("div",{className:"bg-amber-50 dark:bg-gray-900 shadow-md rounded-sm p-2",children:e&&e.length>0&&s.jsx(he,{type:"donut",series:e,options:r})})}const Js=({className:e})=>s.jsx("svg",{className:e,fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",clipRule:"evenodd"})}),Zs=({className:e})=>s.jsx("svg",{className:e,fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});async function Ds(e,t,r=""){if(t==null||t==="")return"";if(e==="home"){const l=await L("home/tree");if(l!=null)try{return JSON.parse(l)}catch(d){console.error("Error parsing JSON data:",d)}}const a=e==="home"?"home_txt":r===""?`${e}_tree/${t}`:`${e}_txt/${t}`,n=Ke(U(J,a)),i=await qe(n);if(!i.exists()||!i.exists())return null;const o=i.val(),c=[{text:"1.React",id:"react",key:"react",parent:"root"},{text:"2.CSS",id:"css",key:"css",parent:"root"},{text:"3.Android",id:"android",key:"android",parent:"root"},{text:"4.Java",id:"java",key:"java",parent:"root"},{text:"5.이미지",id:"image",key:"image",parent:"root"},{text:"6.Etc",id:"etc",key:"etc",parent:"root"}],u=[];e==="home"&&u.push(...c);for(const l in o){const d=o[l];d.id=l;const m={id:l,key:l,text:d.title,parent:e==="home"?d.gbn:d.parent};e==="memo"?(m.icon=d.bm==="Y"?s.jsx(Js,{className:"w-4 h-4 text-red-500"}):d.icon==="Y"?s.jsx(Zs,{className:"w-4 h-4 text-green-500"}):null,m.droppable=!0):m.droppable=!1,!((r===""||r===void 0||r===null)&&(m.parent===void 0||m.parent===null||m.parent===""))&&(e==="home"||r===""||r===void 0||r===null?u.push(m):(d.id=l,(d.memo+"").toLowerCase().indexOf(r.toLowerCase())>-1&&(m.parent="root",m.droppable=!1,u.push(m))))}return u.sort((l,d)=>l.title>d.title?1:-1),e==="home"&&$("home/tree",JSON.stringify(u)),u}const en=({rootDb:e})=>{const{user:t}=O(),{t:r}=z(),a=Qe(),n=Xe(Yt(e)),[i,o]=h.useState({labels:[],series:[]}),c=["#6366f1","#3b82f6","#22c55e","#ef4444","#f97316","#eab308","#8b5cf6","#d946ef","#14b8a6","#a855f7"],u=async()=>{const m=await Ds(e==="sheet"?"memo":e,t?.uid);l(m)};h.useEffect(()=>{n&&n.labels&&n.labels.length>0?o(n):u()},[e,t,n,a]);const l=m=>{if(m&&m.length>0){const y=m.filter(g=>g.parent==="root").sort((g,w)=>g.text.localeCompare(w.text)),v=(g,w)=>{const T=w.filter(E=>E.parent===g);let C=T.length;for(const E of T)C+=v(E.id,w);return C},k=y.map(g=>g.text),b=y.map(g=>v(g.id,m)),p={labels:k,series:b};o(p),a(Qt({rootDb:e,data:p}))}},d=()=>{u()};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`HomeChartForm ${x.between} bg-[#f1f1f1] dark:bg-[#181818] p-2`,children:[s.jsx("div",{className:"px-6 py-5",children:s.jsx(It,{title:r("count_stats")})}),s.jsx("button",{onClick:d,className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors mr-2","aria-label":r("reload_chart"),children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h5M20 20v-5h-5M4 4l1.5 1.5A9 9 0 0121.5 12M20 20l-1.5-1.5A9 9 0 012.5 12"})})})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 w-full gap-2 justify-center",children:[s.jsx(Xs,{series:i.series,labels:i.labels,colors:c}),s.jsx(Ye,{series:[{name:r("count"),data:i.series}],labels:i.labels,colors:c}),s.jsx(Gs,{series:[{name:r("count"),data:i.series}],labels:i.labels,colors:c}),s.jsx(Us,{series:i.series,labels:i.labels,colors:c})]})]})},tn=({rootDb:e})=>{const{user:t}=O(),{t:r}=z(),a=r(e==="memo"?"appMemo":"home_mng"),n=s.jsx("div",{className:`displayTitle text-center  ${x.text3Xl} ${x.textIndigo}`,children:a});return s.jsx(s.Fragment,{children:s.jsx(me,{title:n,className:"MemoMain mt-3 mb-5",children:s.jsxs("div",{className:"grid gird-cols-1 md:grid-cols-5 items-center gap-3",children:[t===null?s.jsx("p",{className:`${x.textRed500} ${x.textLgFontSemiboldLeft} ${x.mdColSpan3}`,children:r("login_used")}):s.jsx("p",{className:`${x.textGray600DarkZinc400} text-left ${x.mdColSpan3}`,dangerouslySetInnerHTML:{__html:r("memo_main_guide").replace(`
`,"<br/>")}}),s.jsx("div",{className:`w-full ${x.flexCenter} md:col-span-2`,children:s.jsx(Xt,{})})]})})})},sn=()=>{const e=Z(),{user:t}=O(),r=Xe(Gt),a=Qe(),n=D(),{rootDb:i,memoId:o}=h.useMemo(()=>{const g=n.pathname,w=g.startsWith("/m/sheet")?"sheet":g.startsWith("/m")?"memo":g.startsWith("/home")?"home":g.startsWith("/bible")?"bible":"default",T=g.split("/").pop()||"";return{rootDb:w,memoId:T}},[n.pathname]),c=n?.state?.reflash===!0,u=de(),l=g=>{a(Ut(g))},{memoDetailData:d,isLoading:m,onBookmark:y}=Ks(i,t,o,l),{openTabs:v,setOpenTabs:k,handleCloseTab:b,handleCloseAllTabs:p}=qs(r,i,t,o,d);return h.useEffect(()=>{t?.uid&&c&&u.invalidateQueries({queryKey:["memoDetail",i,t?.uid,o]})},[c,n.pathname,u,i,t?.uid,o]),h.useEffect(()=>{t===null&&n.pathname!=="/m"&&e("/m")},[t]),s.jsxs(s.Fragment,{children:[r&&s.jsx(Vs,{openTabs:v,setOpenTabs:k,handleCloseTab:b,handleCloseAllTabs:p,activeId:o}),s.jsx(Rs,{rootDb:i,user:t,memoId:o,memoDetailData:d,isLoading:m,onBookmark:y,handleCloseTab:b}),n.pathname==="/m"&&s.jsx(tn,{rootDb:i}),(i==="memo"||i==="sheet")&&s.jsx(Is,{}),n.pathname==="/m"&&t?.uid===ae&&s.jsxs(s.Fragment,{children:[s.jsx(Qs,{}),s.jsx("div",{className:`mt-5 ${x.card}`,children:s.jsx(en,{rootDb:i})})]})]})},dn=Object.freeze(Object.defineProperty({__proto__:null,default:sn},Symbol.toStringTag,{value:"Module"}));export{dn as M,_s as a,cn as b,ln as f,on as s,Ms as u};
