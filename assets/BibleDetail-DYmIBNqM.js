import{r as f,E as S,w as L,e as G,G as J,j as t,R as M,i as P,C as Y,B as g,K as q,l as B,M as H,A as K,N as U,I as V,J as W}from"./index-Dlo5qAfl.js";import{u as z,B as O}from"./BibleBookmarkText-3oRzX6xf.js";import{A as w}from"./AniButton-i7AtPWGD.js";import{b as C}from"./bibleTxt-CDg_iih8.js";import{G as x}from"./Grid-BZTQCb5O.js";import"./Button-FMDonRCy.js";const Q=e=>{const c=new Array;if(e.data===void 0||e.data===null)return;const m=e.bibleId.split("_");for(let n=1;n<=e.data.cd3;n++){const o={nm:`${e.data.nm2}${n}장`,key:e.data.id+"_"+n};c.push(o)}return m&&m.length===3?t.jsxs(B,{variant:"h6",sx:{display:"flex",alignItems:"center",flexDirection:"column",mb:4},children:[e.nm," ",m[2]," 장"]}):t.jsxs(t.Fragment,{children:[t.jsx(B,{variant:"h6",sx:{display:"flex",alignItems:"center",flexDirection:"column",mb:4},children:e.nm}),t.jsx(x,{container:!0,spacing:2,columns:{xs:4,sm:6,md:10,lg:12},children:c.map((n,o)=>t.jsx(x,{item:!0,xs:1,md:1,children:t.jsx(H,{to:`/bible/${n.key}`,children:n.nm})},o))})]})},X=e=>{const c=e.dataText;if(e.data===void 0||e.data===null||c==null)return;const m=e.bibleId.split("_");return e.bibleId&&m.length!==3?t.jsx(t.Fragment,{}):t.jsxs(t.Fragment,{children:[t.jsx(B,{variant:"h6",sx:{display:"flex",alignItems:"center",flexDirection:"column",mb:4},children:e.nm}),c.map((n,o)=>{let b="text.primary";e.cd4+""===n.cd4&&(b="warning.main");const r=e.bookmark?.data?.filter(s=>s.cd1===n.cd1&&s.cd2===n.cd2&&s.cd3===n.cd3&&s.cd4===n.cd4&&s.bookmark==="Y");return r&&r.length>0&&(n.bookmark="Y"),t.jsxs(x,{container:!0,spacing:2,columns:{xs:5,sm:6,md:10,lg:12},id:`id_${o+1}`,children:[t.jsx(x,{item:!0,xs:1,md:1,children:t.jsxs(g,{sx:{color:b,display:"flex"},children:[t.jsx(K,{sx:{alignItems:"center",textAlign:"top"},onClick:()=>e.onBookmark(n),children:n.nm}),r&&r.length>0&&t.jsx(U,{sx:{color:"red"}})]})}),t.jsx(x,{item:!0,xs:4,sm:5,md:9,lg:11,children:t.jsx(g,{sx:{color:b},children:t.jsx(V,{text:n.text})})})]},o)})]})},it=()=>{const[e,c]=f.useState(null),[m,n]=f.useState(!0),{query:o,setBibleBookmark:b}=z(),r=f.useRef(),{bibleId:s}=S(),y=L(),[I,T]=f.useState(!1),[p,_]=f.useState(!1),{user:A}=G(),j=y?.state?.word,h=y?.state?.cd4,D=J();f.useEffect(()=>{if(s!==void 0){(async()=>{const a=await N(s,j);c(a),n(!1)})(),T(!1),_(!0);const i=s.split("_");if(r.current&&i.length===3){const a=r.current.cd3;T(Number(i[2])!==1),_(i[2]<a)}}},[s,j]),f.useEffect(()=>{h!==void 0&&setTimeout(()=>{E("","id_"+h)},1500)},[e,h]);const E=(l,i)=>{const a=document.getElementById(i);a&&a.scrollIntoView({block:"center",behavior:"smooth"})},F=l=>{A!==void 0&&b(l)},N=async(l,i)=>{if(l===""||l===void 0)return"";const a=l.split("_");if(a.length<1)return;a.length>1&&W.map(d=>{d.id===a[0]+"_"+a[1]&&(r.current=d)});const k=new Array;if(a.length===3){for(let d in C){if(!d.includes(l+"_"))continue;let u=C[d];u.id=d;let v=u.txt;if(i!==void 0){const R=new RegExp(i,"gi");v=v.replace(R,`<span class='lightext'>${i}</span>`)}u.nm=`${r.current.nm2}${a[2]}:${u.cd4}`,u.text=v,k.push(u)}return k.sort((d,u)=>d.cd4-u.cd4),k}};if(s==="")return t.jsx(t.Fragment,{});const $=l=>{let i=s.split("_");i[2]=Number(i[2])+l,D(`/bible/${i[0]}_${i[1]}_${i[2]}`)};return t.jsxs(M.Fragment,{children:[t.jsx("div",{id:"back-to-top-anchor"}),t.jsx(O,{}),t.jsx(P,{children:r.current!==null&&r.current!==void 0&&r.current.nm!==null?r.current.text:""}),t.jsx(Q,{data:r.current,bibleId:s}),t.jsx(X,{dataText:e,data:r.current,searchWord:j,bibleId:s,cd4:h,bookmark:o,onBookmark:F}),t.jsxs(Y,{sx:{p:0},children:[m&&t.jsx(g,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:t.jsx(q,{sx:{mt:5}})}),s&&s.split("_").length===3?t.jsx(g,{sx:{display:"flex",justifyContent:"space-between",mt:5},children:t.jsxs(x,{container:!0,spacing:1,children:[I?t.jsx(x,{item:!0,xs:p?6:12,children:t.jsx(w,{type:"button",variant:"outlined",onClick:()=>$(-1),fullWidth:!0,children:"< 이전"})}):"",p?t.jsx(x,{item:!0,xs:I?6:12,children:t.jsx(w,{type:"button",variant:"outlined",onClick:()=>$(1),fullWidth:!0,children:"다음 >"})}):""]})}):""]})]})};export{it as BibleDetail,it as default};
