const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MemoSheetGrid-B-8up7L1.js","assets/index-DJsI4Zxh.js","assets/index-DrOrSGlS.css","assets/MemoDetailEdit-CyY2G3kb.js","assets/useMemoMutation-CVqcoQbW.js","assets/TwCheckbox-D5G7khgP.js","assets/TwTextArea-BtWXESD-.js","assets/angle-right-BucpeKCD.js","assets/MemoDetailEdit-Cmdt2tIm.css","assets/MemoDetailUtil-CdWzL27t.js"])))=>i.map(i=>d[i]);
import{aR as F,aS as Le,aT as at,aU as rt,aV as it,aW as ot,aX as lt,aY as ct,aZ as _e,a_ as dt,a$ as ut,b0 as ze,b1 as P,b2 as Oe,r as m,b3 as mt,b4 as Be,b5 as ye,b6 as ht,b7 as L,s as $,ad as We,ae as Re,t as G,v as U,b8 as ft,b9 as pt,ba as xt,bb as gt,e as O,j as s,a1 as z,bc as yt,h as J,g as vt,a as Z,i as B,q as oe,bd as V,V as wt,k as M,o as y,be as ne,R as K,m as ae,bf as jt,N as ve,a2 as we,H as kt,am as bt,bg as $t,aL as re,bh as Fe,ai as Ct,aj as R,bi as je,_ as D,bj as Nt,bk as St,f as le,bl as Et,bm as Mt,bn as Tt,bo as Lt,bp as _t,ak as zt,al as ce,bq as Ot,aa as He,br as Bt,ab as Wt,w as Ae,bs as Pe,bt as Ve,aF as de,a5 as qe,bu as Rt,bv as Ft,bw as Ht,P as At,bx as Pt,by as Vt}from"./index-DJsI4Zxh.js";import{S as Ke,a as qt,b as Kt}from"./angle-right-BucpeKCD.js";function Ye(e,t){let r;const a=()=>{const{currentTime:n}=t,l=(n===null?0:n.value)/100;r!==l&&e(l),r=l};return F.update(a,!0),()=>Le(a)}const Q=new WeakMap;let _;function Yt(e,t){if(t){const{inlineSize:r,blockSize:a}=t[0];return{width:r,height:a}}else return e instanceof SVGElement&&"getBBox"in e?e.getBBox():{width:e.offsetWidth,height:e.offsetHeight}}function It({target:e,contentRect:t,borderBoxSize:r}){var a;(a=Q.get(e))===null||a===void 0||a.forEach(n=>{n({target:e,contentSize:t,get size(){return Yt(e,r)}})})}function Qt(e){e.forEach(It)}function Xt(){typeof ResizeObserver>"u"||(_=new ResizeObserver(Qt))}function Gt(e,t){_||Xt();const r=at(e);return r.forEach(a=>{let n=Q.get(a);n||(n=new Set,Q.set(a,n)),n.add(t),_?.observe(a)}),()=>{r.forEach(a=>{const n=Q.get(a);n?.delete(t),n?.size||_?.unobserve(a)})}}const X=new Set;let q;function Ut(){q=()=>{const e={width:window.innerWidth,height:window.innerHeight},t={target:window,size:e,contentSize:e};X.forEach(r=>r(t))},window.addEventListener("resize",q)}function Jt(e){return X.add(e),q||Ut(),()=>{X.delete(e),!X.size&&q&&(q=void 0)}}function Zt(e,t){return typeof e=="function"?Jt(e):Gt(e,t)}const Dt=50,ke=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),es=()=>({time:0,x:ke(),y:ke()}),ts={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function be(e,t,r,a){const n=r[t],{length:i,position:l}=ts[t],d=n.current,u=r.time;n.current=e[`scroll${l}`],n.scrollLength=e[`scroll${i}`]-e[`client${i}`],n.offset.length=0,n.offset[0]=0,n.offset[1]=n.scrollLength,n.progress=rt(0,n.scrollLength,n.current);const o=a-u;n.velocity=o>Dt?0:it(n.current-d,o)}function ss(e,t,r){be(e,"x",t,r),be(e,"y",t,r),t.time=r}function ns(e,t){const r={x:0,y:0};let a=e;for(;a&&a!==t;)if(a instanceof HTMLElement)r.x+=a.offsetLeft,r.y+=a.offsetTop,a=a.offsetParent;else if(a.tagName==="svg"){const n=a.getBoundingClientRect();a=a.parentElement;const i=a.getBoundingClientRect();r.x+=n.left-i.left,r.y+=n.top-i.top}else if(a instanceof SVGGraphicsElement){const{x:n,y:i}=a.getBBox();r.x+=n,r.y+=i;let l=null,d=a.parentNode;for(;!l;)d.tagName==="svg"&&(l=d),d=a.parentNode;a=l}else break;return r}const ie={start:0,center:.5,end:1};function $e(e,t,r=0){let a=0;if(e in ie&&(e=ie[e]),typeof e=="string"){const n=parseFloat(e);e.endsWith("px")?a=n:e.endsWith("%")?e=n/100:e.endsWith("vw")?a=n/100*document.documentElement.clientWidth:e.endsWith("vh")?a=n/100*document.documentElement.clientHeight:e=n}return typeof e=="number"&&(a=t*e),r+a}const as=[0,0];function rs(e,t,r,a){let n=Array.isArray(e)?e:as,i=0,l=0;return typeof e=="number"?n=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?n=e.split(" "):n=[e,ie[e]?e:"0"]),i=$e(n[0],r,a),l=$e(n[1],t),i-l}const is={All:[[0,0],[1,1]]},os={x:0,y:0};function ls(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function cs(e,t,r){const{offset:a=is.All}=r,{target:n=e,axis:i="y"}=r,l=i==="y"?"height":"width",d=n!==e?ns(n,e):os,u=n===e?{width:e.scrollWidth,height:e.scrollHeight}:ls(n),o={width:e.clientWidth,height:e.clientHeight};t[i].offset.length=0;let c=!t[i].interpolate;const p=a.length;for(let g=0;g<p;g++){const v=rs(a[g],o[l],u[l],d[i]);!c&&v!==t[i].interpolatorOffsets[g]&&(c=!0),t[i].offset[g]=v}c&&(t[i].interpolate=ot(t[i].offset,lt(a),{clamp:!1}),t[i].interpolatorOffsets=[...t[i].offset]),t[i].progress=ct(0,1,t[i].interpolate(t[i].current))}function ds(e,t=e,r){if(r.x.targetOffset=0,r.y.targetOffset=0,t!==e){let a=t;for(;a&&a!==e;)r.x.targetOffset+=a.offsetLeft,r.y.targetOffset+=a.offsetTop,a=a.offsetParent}r.x.targetLength=t===e?t.scrollWidth:t.clientWidth,r.y.targetLength=t===e?t.scrollHeight:t.clientHeight,r.x.containerLength=e.clientWidth,r.y.containerLength=e.clientHeight}function us(e,t,r,a={}){return{measure:()=>ds(e,a.target,r),update:n=>{ss(e,r,n),(a.offset||a.target)&&cs(e,r,a)},notify:()=>t(r)}}const A=new WeakMap,Ce=new WeakMap,te=new WeakMap,Ne=e=>e===document.documentElement?window:e;function ue(e,{container:t=document.documentElement,...r}={}){let a=te.get(t);a||(a=new Set,te.set(t,a));const n=es(),i=us(t,e,n,r);if(a.add(i),!A.has(t)){const d=()=>{for(const g of a)g.measure()},u=()=>{for(const g of a)g.update(_e.timestamp)},o=()=>{for(const g of a)g.notify()},c=()=>{F.read(d,!1,!0),F.read(u,!1,!0),F.update(o,!1,!0)};A.set(t,c);const p=Ne(t);window.addEventListener("resize",c,{passive:!0}),t!==document.documentElement&&Ce.set(t,Zt(t,c)),p.addEventListener("scroll",c,{passive:!0})}const l=A.get(t);return F.read(l,!1,!0),()=>{var d;Le(l);const u=te.get(t);if(!u||(u.delete(i),u.size))return;const o=A.get(t);A.delete(t),o&&(Ne(t).removeEventListener("scroll",o),(d=Ce.get(t))===null||d===void 0||d(),window.removeEventListener("resize",o))}}function ms({source:e,container:t,axis:r="y"}){e&&(t=e);const a={value:0},n=ue(i=>{a.value=i[r].progress*100},{container:t,axis:r});return{currentTime:a,cancel:n}}const se=new Map;function Ie({source:e,container:t=document.documentElement,axis:r="y"}={}){e&&(t=e),se.has(t)||se.set(t,{});const a=se.get(t);return a[r]||(a[r]=ut()?new ScrollTimeline({source:t,axis:r}):ms({source:t,axis:r})),a[r]}function hs(e){return e.length===2}function Qe(e){return e&&(e.target||e.offset)}function fs(e,t){return hs(e)||Qe(t)?ue(r=>{e(r[t.axis].progress,r)},t):Ye(e,Ie(t))}function ps(e,t){if(e.flatten(),Qe(t))return e.pause(),ue(r=>{e.time=e.duration*r[t.axis].progress},t);{const r=Ie(t);return e.attachTimeline?e.attachTimeline(r,a=>(a.pause(),Ye(n=>{a.time=a.duration*n},r))):dt}}function xs(e,{axis:t="y",...r}={}){const a={axis:t,...r};return typeof e=="function"?fs(e,a):ps(e,a)}function Se(e,t){mt(!!(!t||t.current))}const gs=()=>({scrollX:P(0),scrollY:P(0),scrollXProgress:P(0),scrollYProgress:P(0)});function ys({container:e,target:t,layoutEffect:r=!0,...a}={}){const n=ze(gs);return(r?Oe:m.useEffect)(()=>(Se("target",t),Se("container",e),xs((l,{x:d,y:u})=>{n.scrollX.set(d.current),n.scrollXProgress.set(d.progress),n.scrollY.set(u.current),n.scrollYProgress.set(u.progress)},{...a,container:e?.current||void 0,target:t?.current||void 0})),[e,t,JSON.stringify(a.offset)]),n}function vs(e){const t=ze(()=>P(e)),{isStatic:r}=m.useContext(Be);if(r){const[,a]=m.useState(e);m.useEffect(()=>t.on("change",a),[])}return t}function Ee(e){return typeof e=="number"?e:parseFloat(e)}function ws(e,t={}){const{isStatic:r}=m.useContext(Be),a=m.useRef(null),n=vs(ye(e)?Ee(e.get()):e),i=m.useRef(n.get()),l=m.useRef(()=>{}),d=()=>{const o=a.current;o&&o.time===0&&o.sample(_e.delta),u(),a.current=ht({keyframes:[n.get(),i.current],velocity:n.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:l.current})},u=()=>{a.current&&a.current.stop()};return m.useInsertionEffect(()=>n.attach((o,c)=>r?c(o):(i.current=o,l.current=c,F.update(d),n.get()),u),[JSON.stringify(t)]),Oe(()=>{if(ye(e))return e.on("change",o=>n.set(Ee(o)))},[n]),n}const js=async(e,t)=>(await L(e)===void 0||$(e,null),$(t,null),"OK"),Xs=async({rootDb:e,uid:t,newData:r=!1,key:a,values:n})=>{const i=e==="memo"?`${e}_txt/${t}/`:`${e}_txt/`,l=e==="memo"?`${e}_tree/${t}/`:`${e}/`;let d=a;r&&(d=We(Re(G(U),l)).key),console.log("setFireDetailData.values=",n);const u=i+d;return $(u+"/title",n.edTitle),n.htmlCheck==="N"||n.htmlCheck==="sheet"?$(u+"/memo",n.memoTxt):$(u+"/memo",n.content),$(u+"/date",n.edDate),$(u+"/gbn",n.edGbn),$(u+"/html",n.htmlCheck),r&&e!=="home"&&($(`${l}/${d}/key`,d),$(`${l}/${d}/parent`,a)),e!=="home"&&($(`${l}${d}/title`,n.edTitle),$(`${l}${d}/icon`,n.iconCheck)),d},Gs=async(e,t,r,a)=>{if(a!==void 0)for(let n=0;n<a.length;n++){const i=a[n];i.del==="Y"&&($(`${e}/${r}/image/${i.key}`,null),ft(t,r,i))}},Us=async(e,t,r,a)=>{for(let n=0;n<a.length;n++){const i=a[n].object,d={ext:pt(i.name),name:i.name,use:"Y",sever:""},u=We(Re(G(U),e+"/image")).key,o=await xt(t,r,u,i);d.sever=gt(o.metadata.name);const c=`${e}${r}/image/${d.sever}`;$(c,d)}},Me=e=>{const{t}=O();return s.jsxs("div",{className:"mx-auto grid w-full max-w-lg grid-cols-5 items-center justify-center gap-2 px-4 py-2 text-center",children:[e.master&&s.jsx(z,{size:"sm",variant:"outlined",color:"brand",onClick:e.onUtil,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l-.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),s.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("util")})]})}),s.jsx(z,{size:"sm",variant:"outlined",color:"brand",onClick:e.onEdit,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),s.jsx("path",{d:"m15 5 4 4"})]}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("edit")})]})}),s.jsx(z,{size:"sm",variant:"outlined",color:"brand",onClick:e.onNewMemo,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M5 12h14"}),s.jsx("path",{d:"M12 5v14"})]}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("new")})]})}),s.jsx(z,{size:"sm",variant:"outlined",color:"error",onClick:e.onDelete,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M3 6h18"}),s.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),s.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("delete")})]})}),e.onCopy&&s.jsx(z,{size:"sm",variant:"outlined",color:"secondary",onClick:e.onCopy,className:"gap-1.5",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:s.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})}),s.jsx("span",{className:"ml-2 whitespace-nowrap",children:t("public")})]})})]})},ks=({rootDb:e,memoDetailData:t,onBookmark:r,searchWord:a,onDeleteTab:n})=>{const[i,l]=m.useState(!1),{alertInfo:d,setAlertInfo:u,resetAlertInfo:o}=yt(),[c,p]=m.useState(!1),[g,v]=m.useState(""),[k,b]=m.useState(!1),[f,x]=m.useState(""),[w,E]=m.useState(!1),{t:C}=O(),{scrollYProgress:T}=ys(),H=ws(T,{stiffness:100,damping:30,restDelta:.001}),Y=J(),{memoId:j}=vt(),ee=Z()?.state?.fullIndex,{user:S}=B(),W=oe(),Xe=V({mutationFn:async()=>{const h=e==="memo"?`${e}_txt/${S.uid}/${j}`:`${e}_txt/${j}`,N=e==="memo"?`${e}_tree/${S.uid}/${j}`:`${e}/${j}`;return await js(h,N)},onSuccess:()=>{W.invalidateQueries({queryKey:["twTreeData",e]}),n&&n(j),Y(`/${e==="memo"?"m":e}`)},onError:h=>{console.error("삭제 중 오류 발생:",h)}}),Ge=V({mutationFn:async()=>{if(!S||!j||e!=="memo")throw new Error("Only private memos can be copied.");`${S.uid}${j}`;const h=t;if(!h)throw new Error("Memo data not found.");const N=`home_txt/${j}`;await $(N,h);const I=`memo_tree/${S.uid}/${j}`,nt=`home/${j}`;await $(`${I}/public`,"Y"),await $(nt,{...h,key:j,text:h.title})},onSuccess:()=>{u({isOpen:!0,title:C("complete"),message:C("copy_completed"),color:"success",onConfirm:o,onClose:o}),W.invalidateQueries({queryKey:["memoDetail","home",S?.uid,j]})},onError:h=>{console.error("Copy failed:",h);const N=`${C("copy_failed")} ${h.message?`: ${h.message}`:""}`;u({isOpen:!0,title:C("error"),message:N,color:"error",onConfirm:o,onClose:o})}}),me=V({mutationFn:async h=>{const N=e==="memo"?`memo_txt/${S.uid}/${j}/title`:`home_txt/${j}/title`,I=e==="memo"?`memo_tree/${S.uid}/${j}/title`:`home/${j}/title`;return await $(N,h),await $(I,h),h},onSuccess:h=>{W.setQueryData(["memoDetail",e,S?.uid,j],N=>({...N,title:h})),W.invalidateQueries({queryKey:["twTreeData",e]}),W.invalidateQueries({queryKey:["tabTitle",e,S?.uid,j]}),b(!1)},onError:h=>{console.error("제목 업데이트 중 오류 발생:",h),b(!1)}}),Ue=V({mutationFn:async h=>{const N=e==="memo"?`memo_txt/${S.uid}/${j}/memo`:`home_txt/${j}/memo`;return await $(N,h),h},onSuccess:h=>{W.setQueryData(["memoDetail",e,S?.uid,j],N=>({...N,memo:h})),p(!1)},onError:h=>{console.error("메모 저장 중 오류 발생:",h)}}),Je=()=>{Ue.mutate(g)},Ze=()=>{v(t?.memo||""),p(!0)},De=()=>{x(t?.title||""),b(!0)},et=h=>{x(h.target.value)},tt=h=>{h.key==="Enter"?me.mutate(f):h.key==="Escape"&&b(!1)},he=()=>{const h=`/${e==="memo"?"m":e}/edit/${j}`;Y(h,{state:{fullIndex:ee}})},fe=()=>{const h=`/${e==="memo"?"m":e}/util/${j}`;Y(h,{state:{fullIndex:ee}})},pe=()=>{const h=`/${e==="memo"?"m":e}/insert/${j}`;Y(h,{state:{fullIndex:ee}})},xe=()=>{l(!0)},ge=()=>{Ge.mutate()},st=()=>{l(!1),Xe.mutate()};return m.useEffect(()=>{function h(){const N=t.scrollY?t.scrollY:0;window.scrollTo({top:N})}t&&t.memo!==null&&(h(),t.image&&t.image.map((N,I)=>N),wt({title:t.title,description:""}))},[t]),j===""||S===void 0?null:s.jsxs("div",{className:"MemoDetail py-2 relative rounded-t-lg",children:[s.jsx(M.div,{className:`progress-bar sticky ${w?"top-28":"top-16"} z-10`,style:{scaleX:H}}),s.jsxs("div",{className:"MemoDetail_body overflow-hidden ",children:[s.jsxs("div",{className:`sticky top-0 z-20 ${y.card} backdrop-blur-sm`,children:[s.jsxs("div",{className:"p-3 sm:p-4",children:[s.jsxs("div",{className:y.between,children:[s.jsxs("p",{className:`${y.truncate} ${y.textXs} ${y.textGray500DarkZinc400}`,children:[s.jsx(ne,{to:e==="memo"?"/m":"/hmoe",className:"dark:hover:!text-white hover:!text-gray-900",children:e==="memo"?"MEMO":"HOME"}),t?.path?.map((h,N)=>t.path.length===N+1?` > ${h?.title}`:s.jsxs(K.Fragment,{children:[" "," > ",s.jsx(ne,{to:e==="memo"?`/m/${h.id}`:`/home/${h.id}`,className:"dark:hover:!text-white hover:!text-gray-900",children:h?.title})]},N))]}),s.jsx(M.button,{whileTap:{scale:.8},className:`${y.flexShrink0} ${y.roundedFull} p-2 ${y.buttonHoverGrayLight}`,"aria-label":C("bookmark"),onClick:r,children:t?.bookmark==="Y"?s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`${y.h5W5} ${y.textRed500}`,fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}):s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`${y.h5W5} ${y.textGray500}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})})]}),k?s.jsx("input",{type:"text",value:f,onChange:et,onKeyDown:tt,onBlur:()=>me.mutate(f),className:`w-full bg-transparent border-b-2 border-blue-500 focus:outline-none 
													${y.heading2XlBoldSm3Xl} ${y.textGray900}`,autoFocus:!0}):s.jsx("div",{onDoubleClick:De,className:`MemoDetail_Title text-left ${y.heading2XlBoldSm3Xl} ${y.textGray900} cursor-pointer`,children:t?.title}),s.jsx("button",{onClick:()=>E(!w),className:`${y.floatingActionButton} absolute top-11 sm:top-14 right-2 sm:right-3`,children:s.jsx(M.div,{animate:{rotate:w?135:0},children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})})]}),s.jsx(M.div,{initial:!1,animate:{height:w?"auto":0,opacity:w?1:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:s.jsx("div",{className:"border-t border-gray-200 bg-gray-50 dark:border-zinc-800 dark:bg-zinc-900/50",children:s.jsx(Me,{master:S?.uid===ae,rootDb:e,onEdit:he,onUtil:fe,onNewMemo:pe,onDelete:xe,onCopy:e==="memo"?ge:null})})})]}),t&&t.html==="sheet"&&s.jsx(jt,{rootDb:e,detailData:t}),s.jsxs("div",{className:`MemoDetail_Content ${t?.memo?.length>0?`${y.card} my-4 p-2 sm:p-4`:"p-1"}`,onDoubleClick:Ze,children:[c?s.jsxs("div",{className:`${y.card} p-4`,children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(ve,{children:C("input")}),s.jsx("textarea",{className:"w-full h-64 p-2 border rounded dark:bg-gray-700 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500",value:g,onChange:h=>v(h.target.value),autoFocus:!0})]}),s.jsxs("div",{children:[s.jsx(ve,{children:C("preview")}),s.jsx("div",{className:"prose dark:prose-invert max-w-none p-2 border rounded h-64 overflow-y-auto dark:bg-gray-700 dark:border-gray-600",children:s.jsx(we,{postData:g,highlightWord:""})})]})]}),s.jsxs("div",{className:"mt-2 flex justify-end gap-2",children:[s.jsx(z,{variant:"outlined",color:y.button.indigo,size:"sm",onClick:()=>p(!1),children:C("cancel")}),s.jsx(z,{color:y.button.indigo,onClick:Je,children:C("save")})]})]}):t&&t.html!=="sheet"?t?.html==="N"?s.jsx(we,{postData:t?.memo,highlightWord:a}):t?.html!=="N"&&t?.memo&&s.jsx(kt,{text:t.memo}):"",s.jsx(bt,{imageList:t?.image}),!t&&s.jsx("div",{className:"flex justify-center py-12",children:s.jsx("div",{className:`${y.flexCenter} py-12`})})]})]}),s.jsx($t,{rootDb:e,memoId:j,enableEdit:!0}),s.jsx(M.div,{initial:!1,animate:{height:w?"auto":0,opacity:w?1:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:s.jsx("div",{className:`${y.line}`,children:s.jsx(Me,{master:S?.uid===ae,rootDb:e,onEdit:he,onUtil:fe,onNewMemo:pe,onDelete:xe,onCopy:e==="memo"?ge:null})})}),s.jsx(re,{isOpen:i,size:"sm",color:"warning",title:C("delete_confirm_title"),message:C("delete_confirm_message"),onClose:()=>l(!1),onConfirm:st}),s.jsx(re,{...d})]})},bs=K.lazy(()=>D(()=>import("./MemoSheetGrid-B-8up7L1.js"),__vite__mapDeps([0,1,2]))),Te=K.lazy(()=>D(()=>import("./MemoDetailEdit-CyY2G3kb.js"),__vite__mapDeps([3,1,2,4,5,6,7,8]))),$s=K.lazy(()=>D(()=>import("./MemoDetailUtil-CdWzL27t.js"),__vite__mapDeps([9,1,2,6,4,7]))),Cs=K.lazy(()=>D(()=>import("./index-DJsI4Zxh.js").then(e=>e.bU),__vite__mapDeps([1,2]))),Ns=({rootDb:e,user:t,memoId:r,memoDetailData:a,isLoading:n,onBookmark:i,handleCloseTab:l})=>{const d=Z();return s.jsx(m.Suspense,{fallback:s.jsx(je,{}),children:s.jsx(Fe,{children:s.jsxs(Ct,{location:d,children:[s.jsx(R,{path:"todo",element:s.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(Cs,{})})}),s.jsx(R,{path:"sheet/:sheetId?",element:s.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(bs,{detailData:a})})}),s.jsx(R,{path:"edit/:memoId",element:s.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(Te,{rootDb:e,isLoading:n,memoDetailData:a})})}),s.jsx(R,{path:"insert/:memoId",element:s.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx(Te,{rootDb:e,isLoading:n,memoDetailData:a})})}),s.jsx(R,{path:"util/:memoId",element:s.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:s.jsx($s,{rootDb:e,isLoading:n,memoDetailData:a})})}),s.jsx(R,{path:":memoId",element:s.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:n?s.jsx(je,{}):s.jsx(ks,{rootDb:e,memoDetailData:a,onBookmark:i,onDeleteTab:()=>l(null,{id:r})})})})]},d.pathname)})})},Ss=e=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...e,children:s.jsx("path",{fillRule:"evenodd",d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zM6 20V4h7v5h5v11H6zM8 12h3v3H8v-3zm0 4h3v3H8v-3zm4-4h3v3h-3v-3zm0 4h3v3h-3v-3z",clipRule:"evenodd"})}),Es=({tabInfo:e,handleCloseTab:t,isActive:r})=>{const{t:a}=O(),{user:n}=B(),{attributes:i,listeners:l,setNodeRef:d,transform:u,transition:o,isDragging:c}=Nt({id:e.id}),p={transform:St.Transform?.toString(u),transition:o,zIndex:c?1:"auto"},{data:g}=le({queryKey:["tabTitle",e.rootDb,n?.uid,e.id],queryFn:async()=>e.rootDb==="sheet"?await L(`memo_sheet/${n?.uid}/${e.id}/title`):e.rootDb==="memo"?await L(`${e.rootDb}_txt/${n?.uid}/${e.id}/title`):e.rootDb==="home"?await L(`${e.rootDb}_txt/${e.id}/title`):e.title,enabled:!!n&&!!e.id,staleTime:1/0,placeholderData:e.title});return s.jsxs(ne,{ref:d,style:p,...i,...l,"data-tab-id":e.id,to:e.path,title:g,end:!0,className:({isActive:v})=>`SortableTab group relative flex flex-shrink-0 items-center pl-3 pr-2 py-1.5 text-sm rounded-t-md transition-colors duration-200 min-w-28 max-w-48 border-b-2
				${v?"bg-gray-200 dark:bg-zinc-700 border-blue-500 text-gray-800 dark:text-gray-100":"border-transparent text-secondary hover:bg-gray-200/70 dark:hover:bg-zinc-700/70"}
				${c?"opacity-50 shadow-lg":""}`,children:[e.rootDb==="memo"?s.jsx(Et,{className:`w-5 h-5 mr-1 flex-shrink-0 transition-transform duration-200 ${r?"scale-110":""}`,fill:"currentColor"}):e.rootDb==="sheet"?s.jsx(Ss,{className:`w-5 h-5 mr-1 flex-shrink-0 transition-transform duration-200 ${r?"scale-110":""}`}):null,s.jsx("span",{className:"truncate pr-1",style:{fontFamily:"sans-serif"},children:g||a("loading")}),s.jsx("button",{onClick:v=>t(v,e),className:`ml-auto flex-shrink-0 p-1 rounded-full transition-opacity duration-200 opacity-0 group-hover:opacity-100
					text-gray-500 dark:text-gray-400 
					hover:bg-gray-300/50 dark:hover:bg-gray-600/50 hover:text-gray-700 dark:hover:text-white
				`,children:s.jsx(Ke,{className:"w-3 h-3"})})]})},Ms=({openTabs:e,setOpenTabs:t,handleCloseTab:r,handleCloseAllTabs:a,activeId:n})=>{const i=m.useRef(null),[l,d]=m.useState({left:!1,right:!1}),[u,o]=m.useState({left:0,width:0}),[c,p]=m.useState(!0),g=m.useRef(0),v=m.useCallback(()=>{const f=i.current;if(f){const x=f.scrollWidth>f.clientWidth,w=f.scrollLeft===0,E=f.scrollLeft+f.clientWidth>=f.scrollWidth-1;d(C=>{const T={left:x&&!w,right:x&&!E};return C.left===T.left&&C.right===T.right?C:T})}},[]);m.useEffect(()=>{const f=()=>{const x=window.pageYOffset||document.documentElement.scrollTop;x>g.current?p(!1):p(!0),g.current=x<=0?0:x};return window.addEventListener("scroll",f),()=>{window.removeEventListener("scroll",f)}},[]);const k=f=>{i.current?.scrollBy({left:f==="left"?-200:200,behavior:"smooth"})},b=f=>{const{active:x,over:w}=f;console.log("active=",x,"over=",w),x.id!==w.id&&t(E=>{const C=E.findIndex(H=>H.id===x.id),T=E.findIndex(H=>H.id===w.id);return _t(E,C,T)})};return m.useEffect(()=>{v();const f=i.current;return f?.addEventListener("scroll",v),window.addEventListener("resize",v),()=>{f?.removeEventListener("scroll",v),window.removeEventListener("resize",v)}},[e,v]),m.useEffect(()=>{const f=setTimeout(()=>{const x=i.current?.querySelector(`[data-tab-id="${n}"]`);if(x){const{offsetLeft:w,offsetWidth:E}=x;o({left:w,width:E})}},0);return()=>clearTimeout(f)},[n,e]),s.jsx("div",{className:`MemoTabs sticky ${c?"top-18":"top-1"} z-1000 rounded-t-md bg-gray-50/70 dark:bg-zinc-800/70 backdrop-blur-sm shadow-sm`,children:s.jsxs("div",{className:"relative flex items-center justify-between ",children:[l.left&&s.jsx("button",{onClick:()=>k("left"),className:"absolute left-0 z-10 p-1 border border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 bg-white dark:bg-zinc-900 dark:hover:!text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full group",children:s.jsx(qt,{className:"w-5 h-5 fill-current"})}),s.jsx(Mt,{id:"memo-tabs",onDragEnd:b,children:s.jsx("div",{ref:i,className:"MemoTabs relative flex items-center overflow-x-scroll scrollbar-hide whitespace-nowrap",children:s.jsx(Tt,{items:e.map(f=>f.id),strategy:Lt,children:s.jsx(Fe,{children:e.map(f=>s.jsx(M.div,{layout:!0,initial:{opacity:0,scale:.8},transition:{type:"spring",stiffness:350,damping:30},animate:{opacity:1,scale:1},exit:{opacity:0,width:0,paddingLeft:0,paddingRight:0,transition:{duration:.3}},children:s.jsx(Es,{tabInfo:f,handleCloseTab:r,isActive:f.id===n})},f.id))})})})}),s.jsxs("div",{className:"flex items-center",children:[l.right&&s.jsx("button",{onClick:()=>k("right"),className:"z-10 p-1 border border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 bg-white dark:bg-zinc-900 dark:hover:!text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full group",children:s.jsx(Kt,{className:"w-5 h-5 fill-current"})}),e.length>0&&s.jsx("button",{onClick:a,className:"ml-2 mr-2 p-1.5 text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md",title:"Close all tabs",children:s.jsx(Ke,{className:"w-4 h-4"})})]})]})})},Ts=async(e,t)=>{const r=[];let a=t;if(!e||!a)return r;for(;a&&a!=="root";){const n=await L(`memo_tree/${e}/${a}`);if(!n)break;r.unshift({id:a,...n}),a=n.parent}return r};function Ls(e,t,r,a){const n=oe(),{data:i,isLoading:l}=le({queryKey:["memoDetail",e,t?.uid,r],queryFn:async()=>{if(!r||!t||r==="insert")return{};if(e==="memo"||e==="home"){const o=await zt(e,t.uid,r);if(o&&e==="memo"){o.path=await Ts(t?.uid,r);const c=await L(`memo_tree/${t.uid}/${r}/bm`);o.bookmark=c==="Y"?"Y":"N"}return o||{}}else if(e==="sheet")return{title:await L(`memo_sheet/${t.uid}/${r}/title`)}},enabled:!!t&&!!r,staleTime:1e3*60*5}),{mutate:d}=V({mutationFn:async o=>{const c=e==="memo"?`memo_tree/${t.uid}/${r}/bm`:`home_txt/${r}/bookmark`;await $(c,o)},onMutate:async o=>{await n.cancelQueries({queryKey:["memoDetail",e,t?.uid,r]});const c=n.getQueryData(["memoDetail",e,t?.uid,r]);return n.setQueryData(["memoDetail",e,t?.uid,r],p=>({...p,bookmark:o})),{previousMemoDetail:c}},onError:(o,c,p)=>{n.setQueryData(["memoDetail",e,t?.uid,r],p.previousMemoDetail)},onSettled:()=>{n.invalidateQueries({queryKey:["memoDetail",e,t?.uid,r],refetchType:"all"}),n.invalidateQueries({queryKey:["twTreeData",e],refetchType:"all"}),n.invalidateQueries({queryKey:["bookmarks",t?.uid],refetchType:"all"}),a(!0)}});return{memoDetailData:i,isLoading:l,onBookmark:()=>{if(!i)return;const o=i.bookmark==="Y"?"N":"Y";d(o)}}}function _s(e,t,r,a,n){const i=r?.uid,[l,d]=m.useState(()=>{try{const k=localStorage.getItem(`openTabs_${i}`);return k?JSON.parse(k):[]}catch(k){return console.error("Failed to parse openTabs from localStorage",k),[]}}),u=m.useRef(),o=Z(),c=J(),p=m.useCallback(async k=>{if(e&&a&&a!=="insert"&&o.pathname!=="/m"&&o.pathname!=="/home"){const b={id:a,path:o.pathname,icon:null,rootDb:t,title:k?.title};if(o.pathname.startsWith("/m/sheet/")){const f=await L(`memo_sheet/${r?.uid}/${a}/title`);b.title=f}else a==="sheet"&&(b.title="Main Sheet");!l.some(f=>f.id===b.id)&&u.current!==a?(u.current=a,d(f=>[...f,b])):(u.current="",d(f=>f.map(x=>x.id===b.id?{...x,title:b.title||x.title}:x)))}},[n,e]);m.useEffect(()=>{n&&p(n)},[n,e]),m.useEffect(()=>{if(i)try{localStorage.setItem(`openTabs_${i}`,JSON.stringify(l))}catch(k){console.error("Failed to save openTabs to localStorage",k)}},[l,i]);const g=m.useCallback((k,b)=>{k?.preventDefault(),k?.stopPropagation(),u.current="";const f=l.findIndex(w=>w.id===b.id),x=l.filter(w=>w.id!==b.id);if(d(x),o.pathname.includes(b.id)){const w=x.length>0?x[Math.max(0,f-1)].path:`/${t==="memo"||t==="sheet"?"m":t}`;c(w,{relative:"path"})}},[l,o.pathname,t,c]),v=m.useCallback(()=>{u.current="",d([]),c(`/${t==="memo"||t==="sheet"?"m":t}`)},[t,c]);return{openTabs:l,setOpenTabs:d,handleCloseTab:g,handleCloseAllTabs:v}}const zs=({item:e})=>{const{user:t}=B(),r=J();return s.jsx("div",{onClick:()=>r(`/m/${e.key}`),className:`${y.roundedXl} border border-gray-200 
      bg-white dark:border-gray-800 dark:bg-white/[0.03] 
      overflow-hidden cursor-pointer hover:shadow-md transition-shadow h-full flex flex-col`,children:s.jsx("div",{className:"px-4 py-3",children:s.jsx("h3",{className:"text-base font-medium text-gray-800 dark:text-white/90 truncate",children:e.title})})})};function Os(){const{user:e}=B(),{t}=O(),{data:r,isLoading:a}=le({queryKey:["bookmarks",e?.uid],queryFn:async()=>{const i=[],l=He(G(U,`memo_tree/${e.uid}`),Wt("bm"),Bt("Y")),d=await Ae(l);if(!d.exists())return[];const u=d.val();for(let o in u){const c=u[o];c.id=o,c.key=o,c.text=c.title,i.push(c)}return i.sort((o,c)=>o.title>c.title?1:-1),i},enabled:!!e}),n="grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4";return e===null?s.jsx(s.Fragment,{}):s.jsx(ce,{title:t("main_list"),children:s.jsx("div",{className:"p-2",children:a?s.jsx(Ot,{}):s.jsx("div",{className:`grid ${n} gap-3`,children:r?.map(i=>s.jsx(zs,{item:i},i.id))})})})}const Bs=()=>{const[e,t]=m.useState({labels:[],series:[]}),[r,a]=m.useState(null),[n,i]=m.useState({isOpen:!1}),{t:l}=O();return m.useEffect(()=>{(async()=>{const u=await L("home_cnt");if(u){a(u);const c=Object.keys(u).sort().reverse().slice(0,30),p=c.map(v=>v.split("-").slice(1).join("-")),g=c.map(v=>Object.keys(u[v]).length);t({labels:p,series:g})}})()},[]),s.jsxs(s.Fragment,{children:[s.jsx(re,{...n}),s.jsx(ce,{title:l("visitors.count"),className:"w-full justify-center mt-5",children:s.jsx(Pe,{series:[{name:l("count"),data:e.series}],labels:e.labels,showDownload:!1,onDataPointSelection:(d,u,o)=>{const c=o.dataPointIndex;if(r&&c>-1){const g=Object.keys(r).sort().reverse()[c],v=r[g],k=Object.keys(v).join("<br/>");i({isOpen:!0,title:`${g} ${l("visitors.count")}`,message:k,onClose:()=>i({isOpen:!1})})}}})})]})};function Ws({series:e,labels:t}){const[r,a]=m.useState({labels:[],colors:Ve,dataLabels:{style:{colors:["#333"]}},responsive:[{breakpoint:480,options:{chart:{width:"100%"},legend:{position:"bottom"}}}]});return m.useEffect(()=>{a(n=>({...n,labels:t}))},[t]),s.jsx("div",{className:"bg-amber-50 dark:bg-gray-900 shadow-md rounded-sm p-2",children:e&&e.length>0?s.jsx(de,{type:"donut",series:e,options:r}):s.jsx("div",{className:"text-center text-gray-500 py-10",children:"표시할 데이터가 없습니다."})})}function Rs({series:e,labels:t}){const[r,a]=m.useState({chart:{type:"radar"},colors:["#008FFB"],dataLabels:{enabled:!1},xaxis:{categories:[]},yaxis:{show:!1}});return m.useEffect(()=>{a(n=>({...n,xaxis:{...n.xaxis,categories:t}}))},[t]),s.jsx("div",{className:"bg-white dark:bg-black shadow-md rounded-sm p-2",children:e&&e.length>0&&e[0].data.length>0?s.jsx(de,{type:"radar",series:e,options:r}):s.jsx("div",{className:"text-center text-gray-500 py-10",children:"표시할 데이터가 없습니다."})})}function Fs({series:e,labels:t}){const[r,a]=m.useState({labels:[],colors:Ve,plotOptions:{pie:{startAngle:-90,endAngle:90,offsetY:10}},grid:{padding:{bottom:-80}},dataLabels:{style:{colors:["#333"]}},responsive:[{breakpoint:480,options:{chart:{width:"100%"},legend:{position:"bottom"}}}]});return m.useEffect(()=>{a(n=>({...n,labels:t}))},[t]),s.jsx("div",{className:"bg-amber-50 dark:bg-gray-900 shadow-md rounded-sm p-2",children:e&&e.length>0&&s.jsx(de,{type:"donut",series:e,options:r})})}const Hs=({className:e})=>s.jsx("svg",{className:e,fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",clipRule:"evenodd"})}),As=({className:e})=>s.jsx("svg",{className:e,fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});async function Ps(e,t,r=""){if(t==null||t==="")return"";if(e==="home"){const o=await L("home/tree");if(o!=null)try{return JSON.parse(o)}catch(c){console.error("Error parsing JSON data:",c)}}const a=e==="home"?"home_txt":r===""?`${e}_tree/${t}`:`${e}_txt/${t}`,n=He(G(U,a)),i=await Ae(n);if(!i.exists()||!i.exists())return null;const l=i.val(),d=[{text:"1.React",id:"react",key:"react",parent:"root"},{text:"2.CSS",id:"css",key:"css",parent:"root"},{text:"3.Android",id:"android",key:"android",parent:"root"},{text:"4.Java",id:"java",key:"java",parent:"root"},{text:"5.이미지",id:"image",key:"image",parent:"root"},{text:"6.Etc",id:"etc",key:"etc",parent:"root"}],u=[];e==="home"&&u.push(...d);for(const o in l){const c=l[o];c.id=o;const p={id:o,key:o,text:c.title,parent:e==="home"?c.gbn:c.parent};e==="memo"?(p.icon=c.bm==="Y"?s.jsx(Hs,{className:"w-4 h-4 text-red-500"}):c.icon==="Y"?s.jsx(As,{className:"w-4 h-4 text-green-500"}):null,p.droppable=!0):p.droppable=!1,!((r===""||r===void 0||r===null)&&(p.parent===void 0||p.parent===null||p.parent===""))&&(e==="home"||r===""||r===void 0||r===null?u.push(p):(c.id=o,(c.memo+"").toLowerCase().indexOf(r.toLowerCase())>-1&&(p.parent="root",p.droppable=!1,u.push(p))))}return u.sort((o,c)=>o.title>c.title?1:-1),e==="home"&&$("home/tree",JSON.stringify(u)),u}const Vs=({rootDb:e})=>{const{user:t}=B(),[r,a]=qe(Rt(e)),{t:n}=O(),[i,l]=m.useState({labels:[],series:[]}),d=["#6366f1","#3b82f6","#22c55e","#ef4444","#f97316","#eab308","#8b5cf6","#d946ef","#14b8a6","#a855f7"],u=async()=>{const p=await Ps(e==="sheet"?"memo":e,t?.uid);o(p)};m.useEffect(()=>{r&&r.labels&&r.labels.length>0?l(r):u()},[e,t,r,a]);const o=p=>{if(p&&p.length>0){const g=p.filter(x=>x.parent==="root").sort((x,w)=>x.text.localeCompare(w.text)),v=(x,w)=>{const E=w.filter(T=>T.parent===x);let C=E.length;for(const T of E)C+=v(T.id,w);return C},k=g.map(x=>x.text),b=g.map(x=>v(x.id,p)),f={labels:k,series:b};l(f),a(f)}},c=()=>{u()};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`HomeChartForm ${y.between} bg-[#f1f1f1] dark:bg-[#181818] p-2`,children:[s.jsx("div",{className:"px-6 py-5",children:s.jsx(Ft,{title:n("count_stats")})}),s.jsx("button",{onClick:c,className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors mr-2","aria-label":n("reload_chart"),children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h5M20 20v-5h-5M4 4l1.5 1.5A9 9 0 0121.5 12M20 20l-1.5-1.5A9 9 0 012.5 12"})})})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 w-full gap-2 justify-center",children:[s.jsx(Ws,{series:i.series,labels:i.labels,colors:d}),s.jsx(Pe,{series:[{name:n("count"),data:i.series}],labels:i.labels,colors:d}),s.jsx(Rs,{series:[{name:n("count"),data:i.series}],labels:i.labels,colors:d}),s.jsx(Fs,{series:i.series,labels:i.labels,colors:d})]})]})},qs=({rootDb:e})=>{const{user:t}=B(),{t:r}=O(),a=r(e==="memo"?"appMemo":"home_mng"),n=s.jsx("div",{className:`displayTitle text-center  ${y.text3Xl} ${y.textIndigo}`,children:a});return s.jsx(s.Fragment,{children:s.jsx(ce,{title:n,className:"MemoMain mt-3 mb-5",children:s.jsxs("div",{className:"grid gird-cols-1 md:grid-cols-5 items-center gap-3",children:[t===null?s.jsx("p",{className:`${y.textRed500} ${y.textLgFontSemiboldLeft} ${y.mdColSpan3}`,children:r("login_used")}):s.jsx("p",{className:`${y.textGray600DarkZinc400} text-left ${y.mdColSpan3}`,dangerouslySetInnerHTML:{__html:r("memo_main_guide").replace(`
`,"<br/>")}}),s.jsx("div",{className:`w-full ${y.flexCenter} md:col-span-2`,children:s.jsx(Ht,{})})]})})})},Ks=()=>{const e=J(),{user:t}=B(),r=At(Pt),a=Z(),{rootDb:n,memoId:i}=m.useMemo(()=>{const x=a.pathname,w=x.startsWith("/m/sheet")?"sheet":x.startsWith("/m")?"memo":x.startsWith("/home")?"home":x.startsWith("/bible")?"bible":"default",E=x.split("/").pop()||"";return{rootDb:w,memoId:E}},[a.pathname]),l=a?.state?.reflash===!0,d=oe(),[u,o]=qe(Vt),{memoDetailData:c,isLoading:p,onBookmark:g}=Ls(n,t,i,o),{openTabs:v,setOpenTabs:k,handleCloseTab:b,handleCloseAllTabs:f}=_s(r,n,t,i,c);return m.useEffect(()=>{t?.uid&&l&&d.invalidateQueries({queryKey:["memoDetail",n,t?.uid,i]})},[l,a.pathname,d,n,t?.uid,i]),m.useEffect(()=>{t===null&&a.pathname!=="/m"&&e("/m")},[t]),s.jsxs(s.Fragment,{children:[r&&s.jsx(Ms,{openTabs:v,setOpenTabs:k,handleCloseTab:b,handleCloseAllTabs:f,activeId:i}),s.jsx(Ns,{rootDb:n,user:t,memoId:i,memoDetailData:c,isLoading:p,onBookmark:g,handleCloseTab:b}),a.pathname==="/m"&&s.jsx(qs,{rootDb:n}),(n==="memo"||n==="sheet")&&s.jsx(Os,{}),a.pathname==="/m"&&t?.uid===ae&&s.jsxs(s.Fragment,{children:[s.jsx(Bs,{}),s.jsx("div",{className:`mt-5 ${y.card}`,children:s.jsx(Vs,{rootDb:n})})]})]})},Js=Object.freeze(Object.defineProperty({__proto__:null,default:Ks},Symbol.toStringTag,{value:"Module"}));export{Js as M,ws as a,Us as b,Gs as f,Xs as s,ys as u};
