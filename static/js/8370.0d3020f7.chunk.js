"use strict";(self.webpackChunksiny_memo=self.webpackChunksiny_memo||[]).push([[8370,1473],{35230:(e,t,n)=>{n.r(t),n.d(t,{default:()=>L});var o=n(41806),s=n(12725),c=n(87120),i=n(47313),a=n(58467),r=n(37029),l=n(4319),d=n(93727),m=n(87185),h=n(68322),u=n(47317),x=n(2024),g=n(96821),j=n(70298),w=n(71318),f=n(6608),b=n(63325),y=n(71473),v=n(49336),p=n(85281),M=n(47825),Z=n(21587),S=n(46417);const k=e=>(0,S.jsxs)(o.Z,{sx:{flexGrow:1,my:2,width:"100%",display:"flex",flexDirection:"row",alignItems:"center",alignContent:"center",justifyContent:"center",textAlign:"center"},children:[(0,S.jsx)(Z.ZP,{type:"button",size:"small",variant:"outlined",color:"success",onClick:e.onEdit,children:"\uc218\uc815"}),(0,S.jsx)(Z.ZP,{type:"button",size:"small",variant:"outlined",onClick:e.onNewMemo,children:"\uc0c8\uae00"}),(0,S.jsx)(Z.ZP,{type:"button",size:"small",variant:"outlined",color:"warning",onClick:e.onMove,children:"\uc774\ub3d9"}),(0,S.jsx)(Z.ZP,{type:"button",size:"small",variant:"outlined",color:"error",onClick:e.onDelete,children:"\uc0ad\uc81c"})]});var C=n(35074),I=n(50003),H=n(79148),_=n(2774),N=n(69066),D=n(11338),E=(n(8374),n(59941)),R=n(73786),P=n(25266);const W=e=>{const{title:t,gbn:n,date:s,text:c,image:l,setFireId:d,isLoading:h,onReload:j}=(0,N.C)(),[w,f]=(0,i.useState)(!1),[b,y]=(0,i.useState)(!1),Z=(0,a.s0)(),W=(0,i.useRef)(),F=(0,i.useRef)();F.current=e.searchWord;const{homeId:L}=(0,a.UO)(),A="".concat(n.current,"/sub/").concat(L);console.log("HomeMngDetail.fullIndex=",A);const{user:B}=(0,g.$)(),{settings:G,saveSettings:z}=(0,D.r)();return(0,i.useEffect)((()=>{z({...G,nodeId:L}),f(!1),d("home_txt/".concat(L),"home/".concat(L),F.current)}),[L,B]),(0,i.useEffect)((()=>{null!==c&&document.querySelectorAll("pre").forEach((e=>{e.innerHTML=(0,P.A)(e.innerHTML)}))}),[c]),""===L||void 0===B?(0,S.jsx)(S.Fragment,{}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(_.a,{children:t.current}),(0,S.jsx)(i.Suspense,{fallback:(0,S.jsx)(r.g,{}),children:(0,S.jsxs)(M.Z,{className:"container",sx:{p:0,width:"100%"},children:[!w&&(0,S.jsx)(k,{onEdit:()=>{W.current=!1,!1===h&&f(!0)},onNewMemo:()=>{W.current=!0,!1===h&&f(!0)},onMove:()=>{y(!0)},onDelete:()=>{window.confirm("\ud558\uc704 \uc790\ub8cc\uac00 \uc788\ub294 \uacbd\uc6b0 \uac19\uc774 \uc0ad\uc81c\ub429\ub2c8\ub2e4.\n\uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&(async()=>{console.log("handleDelete.homeId=",L);const e="home_txt/".concat(L),t=await(0,R.Rb)(e,"home");console.log("handleDelete.result=",t),void 0!==t?Z("/homemng"):alert("\uc0ad\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.[code:d02]")})()}}),w&&(0,S.jsx)(m.Z,{newMode:W.current,onPostSubmit:async(e,t,n)=>{const o="home";if(await(0,R.FR)("home_txt",o,L,t),await(0,R.t4)(L,"home_txt/","home/",A,e),await(0,R.YE)("home_txt","home",L,n),void 0===A){const t=await(0,u.MB)("".concat(o,"fullIndex"));void 0!==t&&await(0,v.t8)((0,v.iH)(x.h3,"home/".concat(t,"/title")),e.edTitle)}W.current=!1,f(!1),j()},onNewSubmit:async(e,t)=>{const n=await(0,R.t4)(void 0,"home_txt/","home/",A,e);console.log("onNewSubmit.newKey=",n,", homeId=",L);const o=await(0,R.YE)("home_txt","home",n,t);console.log("onNewSubmit.imageResult",o),void 0!==n&&Z("/homemng/".concat(n)),W.current=!1,f(!1),j()},onCancel:()=>{f(!1)},title:t.current,gbn:n.current,date:s.current,content:c,imageList:l}),(0,S.jsxs)(o.Z,{sx:{my:2,overflow:"hidden",overflowX:"auto"},children:[n.current,(0,S.jsx)(C.O,{show:!w,text:c}),!w&&(0,S.jsx)(H.J,{imageList:l}),h&&(0,S.jsx)(o.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:(0,S.jsx)(p.Z,{sx:{mt:5}})})]}),(0,S.jsx)(I._,{userId:B.uid,open:b,data:e.data,onClose:()=>y(!1),onPost:async e=>{try{const t="home_txt",n="home",o=await(0,R.RV)(t,n,L,e);console.log("onMoveSubmit.result=",o)}catch(t){}finally{y(!1)}}})]})}),(0,S.jsx)(E.d,{})]})};var F=n(99333);const L=()=>{const e=(0,a.s0)(),{user:t}=(0,g.$)(),[n,v]=(0,i.useState)(!1),p=(0,i.useRef)(),[M]=(0,j.V)("home"),[Z,k]=(0,i.useState)(""),C=(0,i.useRef)();(0,i.useEffect)((()=>{}),[t]);const I=()=>{v(!0)},H=async(e,n)=>{const o="home_txt/".concat(t.uid,"/");for(let t=0;t<n.length;t++){const e=n[t].object,i=(0,f.Z)(e.name),a={ext:i,name:e.name,use:"Y"},r=(0,s.VF)((0,s.iU)((0,s.iH)(x.h3),o+"image")).key;(0,s.t8)((0,s.iH)(x.h3,o+"image/".concat(r)),a);const l=await(0,c.iH)(x.IG,"home/".concat(Z,"/").concat(r,".").concat(i));await(0,c.KV)(l,e)}const i=(0,u.K9)(o),a={title:e.edTitle,date:e.edDate,gbn:e.edGbn,memo:e.content,fullIndex:i,up:i,bookmark:"N"};(0,u.hb)("".concat(o).concat(i),a);const r={gbn:"",property:"m",title:e.title,up:i};(0,u.hb)("home/".concat(i),r),v(!1)},{height:_,width:N}=(0,b.Z)();if(!t)return(0,S.jsx)(S.Fragment,{});t.uid!==F.kS&&e("/");const D=(0,S.jsxs)(o.Z,{sx:{minHeight:110,flexGrow:1,minWidth:100,maxHeight:_},children:[(0,S.jsx)(d.j,{}),(0,S.jsx)(l.x,{onNewMemoBtn:I,onSearchDataBtn:e=>{p.current=e}}),(0,S.jsx)(o.Z,{sx:{flexGrow:1,minWidth:100,minHeight:110,maxHeight:_-220,height:_-220},children:(0,S.jsx)(i.Suspense,{fallback:(0,S.jsx)(r.g,{}),children:(0,S.jsx)(h.Z,{data:M,onDetail:(t,n)=>{C.current=n,k(t),e("/homemng/".concat(t),{state:{fullIndex:n}})},maxHeight:_-150})})})]});return(0,S.jsxs)(w.j,{title:"\ud648 \uad00\ub9ac",drawerWidth:220,width:N,sideContents:D,children:[(0,S.jsxs)(a.Z5,{children:[(0,S.jsx)(a.AW,{path:"/",element:(0,S.jsx)(y.MemoMain,{searchWord:p.current,data:M,onNewMemoBtn:I,title:"\ud648\ud398\uc774\uc9c0 \uad00\ub9ac"})}),(0,S.jsx)(a.AW,{path:"/:homeId",element:(0,S.jsx)(W,{searchWord:p.current,data:M})})]}),n&&(0,S.jsx)(m.Z,{show:n,newMode:n.current,onPostSubmit:H,onNewSubmit:H,onCancel:()=>{v(!1)},title:"",content:"",imageList:[]})]})}},71473:(e,t,n)=>{n.r(t),n.d(t,{MemoMain:()=>c,default:()=>i});var o=n(21587),s=n(46417);const c=e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{children:e.title}),"\uc0ac\uc774\ub4dc \uba54\ub274\uc5d0\uc11c",(0,s.jsx)(o.ZP,{disableElevation:!0,type:"button",variant:"outlined",color:"success",onClick:function(){return e.onNewMemoBtn(),!1},children:"\uc0c8\uae00"}),"\ubc84\ud2bc\uc744 \uc0ac\uc6a9\ud574 \uba54\ubaa8\ub97c \uc791\uc131\ud569\ub2c8\ub2e4."]}),i=c}}]);