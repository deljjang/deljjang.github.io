{"version":3,"file":"static/js/653.6c8b7822.chunk.js","mappings":"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","sources":["components/BibleBookmarkText.js","firebase/useBibleBookmark.js","views/bible/BibleDetail.js"],"sourcesContent":["import { Divider, Grid } from '@mui/material';\r\nimport { HtmlText } from './HtmlText';\r\nimport { LinkItem } from './LinkItem';\r\nimport { useBibleBookmark } from '../firebase/useBibleBookmark';\r\n\r\nconst BibleBookmarkText = () => {\r\n  // const data = new Array();\r\n  const { query } = useBibleBookmark();\r\n  const data = query.data;\r\n\r\n  // console.log('BibleText.dataText=', props.dataText);\r\n  // console.log('BibleBookmarkText.data=', data);\r\n\r\n  if (data === undefined || data === null) return;\r\n\r\n  return (\r\n    <>\r\n      {data.map((item, idx) => {\r\n        // console.log('BibleText.item=', item);\r\n        return (\r\n          <Grid\r\n            container\r\n            spacing={2}\r\n            columns={{ xs: 5, sm: 7, md: 10, lg: 12 }}\r\n            key={idx}\r\n            id={`id_${idx + 1}`}\r\n          >\r\n            <Grid item xs={1} md={1}>\r\n              <LinkItem\r\n                to={`/bible/${item.cd1}_${item.cd2}_${item.cd3}`}\r\n                state={{ cd4: item.cd4 }}\r\n              >\r\n                {item.nm}\r\n              </LinkItem>\r\n            </Grid>\r\n            <Grid item xs={4} sm={6} md={9} lg={11}>\r\n              <HtmlText show={true} text={item.txt} />\r\n            </Grid>\r\n          </Grid>\r\n        );\r\n      })}\r\n      <Divider />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default BibleBookmarkText;\r\n","import { get, onValue, ref, set } from 'firebase/database';\r\nimport { useEffect, useState } from 'react';\r\nimport { firebaseDB } from './firebase';\r\nimport { useFireUser } from './useFireUser';\r\nimport { QueryClient, useQuery, useSuspenseQuery } from '@tanstack/react-query';\r\n\r\n// 북마크 관련\r\n// use :\r\n// const bookmark = useBibleBookmark();\r\nexport const useBibleBookmark = () => {\r\n  const queryClient = new QueryClient();\r\n  const { user } = useFireUser();\r\n\r\n  // const queryClient = new QueryClient();\r\n  // const id = queryClient.getQueryData('userId');\r\n  // console.log('useBibleBookmark.id=', id);\r\n  // let userId; // 'I3cTgdCxwjhBBno4mtZYvnODPJu1';\r\n\r\n  const query = useQuery({\r\n    queryKey: ['useBibleBookmark'],\r\n    // queryFn: () => new Promise(() => {getBookmarkData()}),\r\n    queryFn: ()=> getBookmarkData(),\r\n    // The query will not execute until the userId exists\r\n    enabled: false,\r\n  });\r\n\r\n  useEffect(() => {\r\n    if(user !== undefined) {\r\n      // console.log('useEffect.user=', user);\r\n      query.refetch();\r\n    }\r\n  }, [user]);\r\n\r\n  async function getBookmarkData() {\r\n    // console.log('getBookmarkData.user', user.uid);\r\n    if (user.uid === undefined) {\r\n      return new Error('Error undefined');\r\n    }\r\n    const locate = ref(firebaseDB, `bible_mark/${user.uid}`);\r\n\r\n    const snapshot = await get(locate);\r\n    const result = new Array();\r\n    // console.log('useBookmark.snapshot', snapshot);\r\n\r\n    if (!snapshot.exists()) {\r\n      // console.log('getBookmarkData.exists', snapshot);\r\n      return new Error('Error exists');\r\n    } else {\r\n      const data = snapshot.val();\r\n      // console.log('useBookmark.data=', data);\r\n      Object.values(data).map((item) => {\r\n        item.bookmark === 'Y' && result.push(item);\r\n      });\r\n      // console.log('getBookmarkData.result=', result);\r\n      return result;\r\n    }\r\n  }\r\n\r\n  // song_mark\r\n  // bible_mark\r\n  const setBibleBookmark = (item) => {\r\n    if (user === undefined) return;\r\n\r\n    /* \r\n    {nm: '잠31:2', text: '내 아들아 내가 무엇을 말하랴 내 태에서 난 아들아 내가 무엇을 말하랴 서원대로 얻은 아들아 내가 무엇을 말하랴', \r\n    key: '1_20', cd1: '1', cd2: '20', …}\r\n    */\r\n\r\n    if (user === undefined) return;\r\n\r\n    let value = 'N';\r\n    if (item.bookmark === undefined || item.bookmark === 'N') {\r\n      value = 'Y';\r\n    }\r\n    item.bookmark = value;\r\n\r\n    // console.log('setBibleBookmark.item=', item);\r\n\r\n    const locate = `bible_mark/${user.uid}/${item.cd1}_${item.cd2}_${item.cd3}_${item.cd4}`;\r\n    set(ref(firebaseDB, locate), item);\r\n\r\n    queryClient.invalidateQueries({ queryKey: ['useBibleBookmark'] })\r\n    query.refetch();\r\n\r\n    /*     const val = bookmark === 'Y' ? 'N' : 'Y';\r\n    setBookmark(val);\r\n\r\n    */\r\n  }\r\n\r\n  // console.log('useBibleBookmark.query.data=', query.data);\r\n  return {query, setBibleBookmark};\r\n  //return query\r\n}; // end of useBibleBookmark\r\n","import { get, ref, set } from '@firebase/database';\r\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\r\nimport Box from '@mui/material/Box';\r\nimport CircularProgress from '@mui/material/CircularProgress';\r\nimport Fab from '@mui/material/Fab';\r\nimport Typography from '@mui/material/Typography';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport { useLocation, useNavigate, useParams } from 'react-router-dom';\r\nimport { firebaseAuth, firebaseDB } from '../../firebase/firebase';\r\n\r\nimport { Button, Grid, IconButton } from '@mui/material';\r\nimport Container from '@mui/material/Container';\r\nimport { HtmlText } from '../../components/HtmlText';\r\nimport { LinkItem, TextItem } from '../../components/LinkItem';\r\nimport { ScrollToTop } from '../../components/screen/ScrollToTop';\r\nimport bibleJson from '../../data/bibleJson';\r\nimport { useSettings } from '../../hooks/useSettings';\r\nimport '../MemoDetail.css';\r\nimport AnimateButton from '../../components/button/AnimateButton';\r\nimport FavoriteIcon from '@mui/icons-material/Favorite';\r\nimport { useBibleBookmark } from '../../firebase/useBibleBookmark';\r\nimport { useFireUser } from '../../firebase/useFireUser';\r\nimport BibleBookmarkText from '../../components/BibleBookmarkText';\r\nimport { TitleItem } from '../../components/TitleItem';\r\nimport { QueryClient } from '@tanstack/react-query';\r\n\r\n// {cd1: '1', cd2: '1', cd3: 50, db_set: '1', key: '1_1', nm: \"창세기\", nm2: \"창\" }\r\nconst BibleTop = (props) => {\r\n  const data = new Array();\r\n\r\n  if (props.data === undefined || props.data === null) return;\r\n\r\n  const bibleId = props.bibleId.split('_');\r\n\r\n  for (let i = 1; i <= props.data.cd3; i++) {\r\n    const item = {\r\n      nm: `${props.data.nm2}${i}장`,\r\n      key: props.data.key,\r\n    };\r\n    data.push(item);\r\n  }\r\n\r\n  if (bibleId && bibleId.length === 3) {\r\n    return (\r\n      <Typography\r\n        variant=\"h6\"\r\n        sx={{\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          flexDirection: 'column',\r\n          mb: 4,\r\n        }}\r\n      >\r\n        {props.nm} {bibleId[2]} 장\r\n      </Typography>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Typography\r\n        variant=\"h6\"\r\n        sx={{\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          flexDirection: 'column',\r\n          mb: 4,\r\n        }}\r\n      >\r\n        {props.nm}\r\n      </Typography>\r\n      <Grid container spacing={2} columns={{ xs: 4, sm: 6, md: 10, lg: 12 }}>\r\n        {data.map((item, idx) => {\r\n          return (\r\n            <Grid item xs={1} md={1} key={idx}>\r\n              <LinkItem to={`/bible/${item.key}_${idx + 1}`}>\r\n                {item.nm}\r\n              </LinkItem>\r\n            </Grid>\r\n          );\r\n        })}\r\n      </Grid>\r\n    </>\r\n  );\r\n};\r\n\r\n// data: {cd1: '1', cd2: '1', cd3: 50, db_set: '1', key: '1_1', nm: \"창세기\", nm2: \"창\" }\r\n//dataText: {cd1: '1', cd2: '1', cd3: '48', cd4: '22', txt: '내가 네게...'}\r\nconst BibleText = (props) => {\r\n  // const data = new Array();\r\n\r\n  // console.log('BibleText.data', props.data);\r\n  // console.log('BibleText.dataText', props.dataText);\r\n  const data = props.dataText;\r\n\r\n  if (props.data === undefined || props.data === null) return;\r\n  if (data === undefined || data === null) return;\r\n\r\n  const bibleId = props.bibleId.split('_');\r\n  if (props.bibleId && bibleId.length !== 3) {\r\n    return <></>;\r\n  }\r\n\r\n  // console.log('BibleText.props.bibleId', props.bibleId);\r\n  // console.log('BibleText.props.bookmark', props.bookmark);\r\n  // console.log('BibleText.data', data);\r\n\r\n  return (\r\n    <>\r\n      <Typography\r\n        variant=\"h6\"\r\n        sx={{\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          flexDirection: 'column',\r\n          mb: 4,\r\n        }}\r\n      >\r\n        {props.nm}\r\n      </Typography>\r\n      {data.map((item, idx) => {\r\n        if (item.bm !== undefined) console.log('item', props.cd4, item);\r\n\r\n        let color = 'text.primary';\r\n        if (props.cd4 + '' === item.cd4) {\r\n          color = 'warning.main';\r\n        }\r\n\r\n        const f = props.bookmark?.data?.filter((x) => {\r\n          return (\r\n            x.cd1 === item.cd1 &&\r\n            x.cd2 === item.cd2 &&\r\n            x.cd3 === item.cd3 &&\r\n            x.cd4 === item.cd4 &&\r\n            x.bookmark === 'Y'\r\n          );\r\n        });\r\n        // console.log('BibleText.f', f);\r\n\r\n        if (f && f.length > 0) {\r\n          // console.log('bookmark = Y', f);\r\n          item.bookmark = 'Y';\r\n        }\r\n\r\n        // console.log('f', f);\r\n\r\n        return (\r\n          <Grid\r\n            container\r\n            spacing={2}\r\n            columns={{ xs: 5, sm: 6, md: 10, lg: 12 }}\r\n            key={idx}\r\n            id={`id_${idx + 1}`}\r\n          >\r\n            <Grid item xs={1} md={1}>\r\n              <Box sx={{ color: color, display: 'flex' }}>\r\n                <TextItem\r\n                  sx={{ alignItems: 'center', textAlign: 'top' }}\r\n                  onClick={(e) => props.onBookmark(item)}\r\n                >\r\n                  {item.nm}\r\n                </TextItem>\r\n                {f && f.length > 0 && <FavoriteIcon sx={{ color: 'red' }} />}\r\n              </Box>\r\n            </Grid>\r\n            <Grid item xs={4} sm={5} md={9} lg={11}>\r\n              <Box sx={{ color: color }}>\r\n                <HtmlText text={item.text} />\r\n              </Box>\r\n            </Grid>\r\n          </Grid>\r\n        );\r\n      })}\r\n    </>\r\n  );\r\n};\r\n\r\nexport const BibleDetail = (props) => {\r\n  const [bibleText, setBibleText] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const  {query: bookmark, setBibleBookmark} = useBibleBookmark();\r\n  const bibleTitle = useRef();\r\n\r\n  const { bibleId } = useParams();\r\n  const location = useLocation();\r\n\r\n  const [buttonBefore, setButtonBefore] = useState(false);\r\n  const [buttonNext, setButtonNext] = useState(false);\r\n\r\n  const { user } = useFireUser();\r\n  const searchWord = location?.state?.word;\r\n  const cd4 = location?.state?.cd4;\r\n  const navigate = useNavigate();\r\n\r\n  const queryClient = new QueryClient();\r\n\r\n  console.log('BibleDetail.bookmark=', bookmark);\r\n\r\n  useEffect(() => {\r\n    if (bibleId !== undefined) {\r\n      // todo : 잠시 리마크\r\n      // saveSettings({ ...settings, bibleId: bibleId });\r\n      const runData = async () => {\r\n        const data = await getBibleText(bibleId, searchWord);\r\n        setBibleText(data);\r\n        // console.log('setBibleText');\r\n        setIsLoading(false);\r\n      };\r\n      runData();\r\n\r\n      // {cd1: '2', cd2: '3', cd3: 24, db_set: '1', key: '2_3', …}\r\n      setButtonBefore(false);\r\n      setButtonNext(true);\r\n      const tmp = bibleId.split('_');\r\n      if (tmp.length === 3) {\r\n        const cd3 = bibleTitle.current.cd3;\r\n\r\n        setButtonBefore(Number(tmp[2]) !== 1);\r\n        setButtonNext(tmp[2] < cd3);\r\n      }\r\n    }\r\n  }, [bibleId]);\r\n\r\n  //console.log('MemoDetail.memoId=', memoId);\r\n  useEffect(() => {\r\n    if (cd4 !== undefined) {\r\n      setTimeout(() => {\r\n        // console.log('1초가 지났습니다');\r\n        // console.log('document=', document);\r\n\r\n        moveTo('', 'id_' + cd4);\r\n      }, 1500);\r\n    }\r\n  }, [bibleText]);\r\n\r\n  const moveTo = (event, id) => {\r\n    const anchor = document.getElementById(id);\r\n\r\n    if (anchor) {\r\n      anchor.scrollIntoView({\r\n        block: 'center',\r\n        behavior: 'smooth',\r\n      });\r\n    }\r\n  };\r\n\r\n  // song_mark\r\n  // bible_mark\r\n  const onBookmark = (item) => {\r\n    /* \r\n    {nm: '잠31:2', text: '내 아들아 내가 무엇을 말하랴 내 태에서 난 아들아 내가 무엇을 말하랴 서원대로 얻은 아들아 내가 무엇을 말하랴', \r\n    key: '1_20', cd1: '1', cd2: '20', …}\r\n    */\r\n\r\n    if (user === undefined) return;    \r\n\r\n    setBibleBookmark(item);\r\n\r\n    // let bookmark = 'N';\r\n    // if (item.bookmark === undefined || item.bookmark === 'N') {\r\n    //   bookmark = 'Y';\r\n    // }\r\n    // item.bookmark = bookmark;\r\n\r\n    // console.log('onBookmark.item=', item);\r\n\r\n    // const locate = `bible_mark/${user.uid}/${item.cd1}_${item.cd2}_${item.cd3}_${item.cd4}`;\r\n    // set(ref(firebaseDB, locate), item);\r\n\r\n    // queryClient.invalidateQueries({ queryKey: ['useBibleBookmark'] })\r\n  };\r\n\r\n  const getBibleText = async (bibleId, searchWord) => {\r\n    // console.log('getBibleText.bibleId=', bibleId)\r\n    if (bibleId === '' || bibleId === undefined) {\r\n      return '';\r\n    }\r\n\r\n    // https://console.firebase.google.com/project/sinyproject/database/sinyproject/data/~2Fbible_1~2F1\r\n    /*\r\n    https://console.firebase.google.com/project/sinyproject/database/sinyproject/data/~2F\r\n    bible_1~2F1\r\n*/\r\n    //console.log('bibleTitle=', bibleTitle);\r\n\r\n    const bibleIdSplit = bibleId.split('_');\r\n\r\n    if (bibleIdSplit.length < 1) {\r\n      return;\r\n    }\r\n\r\n    // {cd1: '2', cd2: '1', cd3: 28, db_set: '1', key: '2_1', …}\r\n    bibleTitle.current = bibleJson[bibleIdSplit[0]][bibleIdSplit[1]];\r\n    console.log('bibleTitle=', bibleTitle);\r\n\r\n    if (bibleIdSplit.length === 3) {\r\n      const locate = ref(\r\n        firebaseDB,\r\n        `bible_${bibleIdSplit[0]}/${bibleIdSplit[1]}/${bibleIdSplit[2]}`\r\n      );\r\n      // 한번만 읽기\r\n      const snapshot = await get(locate);\r\n      if (snapshot.exists()) {\r\n        const data = snapshot.val();\r\n        // console.log('snapshot.data=', data);\r\n        //return data;\r\n\r\n        const result = new Array();\r\n\r\n        Object.values(data).map((item) => {\r\n          if (item === undefined) return;\r\n\r\n          let txt = item.txt;\r\n          // console.log('txt', txt);\r\n\r\n          if (searchWord !== undefined) {\r\n            const regexAllCase = new RegExp(searchWord, 'gi');\r\n            txt = txt.replace(\r\n              regexAllCase,\r\n              `<span class='lightext'>${searchWord}</span>`\r\n            );\r\n          }\r\n\r\n          item.nm = `${bibleTitle.current.nm2}${bibleIdSplit[2]}:${item.cd4}`;\r\n          item.text = txt;\r\n          result.push(item);\r\n        });\r\n        // console.log('getBibleText.result=', result);\r\n        return result;\r\n      } else {\r\n        return;\r\n      }\r\n    }\r\n  }; // end of getBibleText\r\n\r\n  if (bibleId === '') {\r\n    return <></>;\r\n  }\r\n\r\n  const onMove = (i) => {\r\n    console.log('onMove', i);\r\n    let tmp = bibleId.split('_');\r\n    tmp[2] = Number(tmp[2]) + i;\r\n    console.log('onMove.tmp', tmp);\r\n    navigate(`/bible/${tmp[0]}_${tmp[1]}_${tmp[2]}`);\r\n  };\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div id=\"back-to-top-anchor\"></div>\r\n      <BibleBookmarkText />\r\n      <TitleItem>\r\n        {bibleTitle.current !== null &&\r\n        bibleTitle.current !== undefined &&\r\n        bibleTitle.current.nm !== null\r\n          ? bibleTitle.current.nm\r\n          : ''}\r\n      </TitleItem>\r\n      <BibleTop data={bibleTitle.current} bibleId={bibleId} />\r\n      <BibleText\r\n        dataText={bibleText}\r\n        data={bibleTitle.current}\r\n        searchWord={searchWord}\r\n        bibleId={bibleId}\r\n        cd4={cd4}\r\n        bookmark={bookmark}\r\n        onBookmark={onBookmark}\r\n      />\r\n      <Container sx={{ p: 0 }}>\r\n        {isLoading && (\r\n          <Box\r\n            sx={{\r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n              alignItems: 'center',\r\n            }}\r\n          >\r\n            <CircularProgress sx={{ mt: 5 }} />\r\n          </Box>\r\n        )}\r\n        {/* const bibleIdSplit = bibleId.split('_'); */}\r\n        {bibleId && bibleId.split('_').length === 3 ? (\r\n          <Box sx={{ display: 'flex', justifyContent: 'space-between', mt: 5 }}>\r\n            <Grid container spacing={1}>\r\n              {buttonBefore ? (\r\n                <Grid item xs={buttonNext ? 6 : 12}>\r\n                  <AnimateButton>\r\n                    <Button\r\n                      type=\"button\"\r\n                      variant=\"outlined\"\r\n                      // color=\"success\"\r\n                      onClick={() => onMove(-1)}\r\n                      fullWidth\r\n                    >\r\n                      {'< 이전'}\r\n                    </Button>\r\n                  </AnimateButton>\r\n                </Grid>\r\n              ) : (\r\n                ''\r\n              )}\r\n              {buttonNext ? (\r\n                <Grid item xs={buttonBefore ? 6 : 12}>\r\n                  <AnimateButton>\r\n                    <Button\r\n                      type=\"button\"\r\n                      variant=\"outlined\"\r\n                      // color=\"success\"\r\n                      onClick={() => onMove(1)}\r\n                      fullWidth\r\n                    >\r\n                      {'다음 >'}\r\n                    </Button>\r\n                  </AnimateButton>\r\n                </Grid>\r\n              ) : (\r\n                ''\r\n              )}\r\n            </Grid>\r\n          </Box>\r\n        ) : (\r\n          ''\r\n        )}\r\n      </Container>\r\n      <ScrollToTop {...props} id={'#back-to-top-anchor'}>\r\n        <Fab color=\"primary\" size=\"small\" aria-label=\"scroll back to top\">\r\n          <KeyboardArrowUpIcon />\r\n        </Fab>\r\n      </ScrollToTop>\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nexport default BibleDetail;\r\n"],"names":["BibleBookmarkText","query","useBibleBookmark","data","undefined","_jsxs","_Fragment","children","map","item","idx","Grid","container","spacing","columns","xs","sm","md","lg","id","concat","_jsx","LinkItem","to","cd1","cd2","cd3","state","cd4","nm","HtmlText","show","text","txt","Divider","queryClient","QueryClient","user","useFireUser","useQuery","queryKey","queryFn","async","uid","Error","locate","ref","firebaseDB","snapshot","get","result","Array","exists","val","Object","values","bookmark","push","getBookmarkData","enabled","useEffect","refetch","setBibleBookmark","value","set","invalidateQueries","BibleTop","props","bibleId","split","i","nm2","key","length","Typography","variant","sx","display","alignItems","flexDirection","mb","BibleText","dataText","_props$bookmark","_props$bookmark$data","bm","console","log","color","f","filter","x","Box","TextItem","textAlign","onClick","e","onBookmark","FavoriteIcon","BibleDetail","_location$state","_location$state2","bibleText","setBibleText","useState","isLoading","setIsLoading","bibleTitle","useRef","useParams","location","useLocation","buttonBefore","setButtonBefore","buttonNext","setButtonNext","searchWord","word","navigate","useNavigate","getBibleText","runData","tmp","current","Number","setTimeout","moveTo","event","anchor","document","getElementById","scrollIntoView","block","behavior","bibleIdSplit","bibleJson","regexAllCase","RegExp","replace","onMove","React","TitleItem","Container","p","CircularProgress","mt","justifyContent","AnimateButton","Button","type","fullWidth","ScrollToTop","Fab","size","KeyboardArrowUpIcon"],"sourceRoot":""}