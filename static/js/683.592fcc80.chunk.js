"use strict";(self.webpackChunksiny_memo=self.webpackChunksiny_memo||[]).push([[683],{63449:(e,t,o)=>{o.r(t),o.d(t,{default:()=>V});var n=o(41806),c=o(12725),i=o(87120),a=o(47313),l=o(58467),s=o(19536),d=o(61113),r=o(90891),m=o(2024);var u=o(96821),x=o(2774),h=o(46417);function g(e){const{user:t}=(0,u.$)(),o=(0,l.s0)(),i=(e=>{const[t,o]=(0,a.useState)([]);(0,a.useEffect)((()=>{n()}),[e]);const n=()=>{const t=(0,c.IO)((0,c.iH)(m.h3,"memo_txt/".concat(e)),(0,c.g2)("bookmark"),(0,c.EW)("Y"));(0,c.jM)(t,(e=>{if(!e.exists())return;const t=e.val(),n=[];for(let o in t){const e=t[o];e.key=o,n.push(e)}n.sort(((e,t)=>e.title>t.title?1:-1)),o(n)}))};return t})(null===t||void 0===t?void 0:t.uid);return void 0===t?(0,h.jsx)(h.Fragment,{}):(0,h.jsxs)(n.Z,{sx:{display:"flex",alignItems:"center",flexDirection:"column",width:"100%"},children:[(0,h.jsx)(s.Z,{}),(0,h.jsx)(x.a,{children:"BookMark"}),i&&i.map(((t,n)=>(0,h.jsx)("div",{children:(0,h.jsx)(r.Z,{component:"button",variant:"body",onClick:()=>{e.onSelected(t.key),o("/memo/".concat(t.key))},children:(0,h.jsx)(d.Z,{variant:"body1",children:t.title})})},n)))]})}var f=o(93727),b=o(4319),j=o(68322),w=o(47317),v=o(41792),p=o(6608),y=o(63325),k=o(49336),S=o(3665),Z=o(85281),H=o(42420),I=o(47825),C=o(63856),M=o(43407),D=o(50003),N=o(21587);const B=e=>(0,h.jsxs)(n.Z,{sx:{flexGrow:1,my:2,width:"100%",display:"grid",gridTemplateColumns:"64px 64px  64px  64px ",flexDirection:"row",alignItems:"center",alignContent:"center",justifyContent:"center",textAlign:"center",whiteSpace:"nowrap"},children:[(0,h.jsx)(N.Z,{type:"button",size:"small",variant:"outlined",color:"success",onClick:e.onEdit,children:"\uc218\uc815"}),(0,h.jsx)(N.Z,{type:"button",size:"small",variant:"outlined",onClick:e.onNewMemo,children:"\uc0c8\uae00"}),(0,h.jsx)(N.Z,{type:"button",size:"small",variant:"outlined",color:"warning",onClick:e.onMove,children:"\uc774\ub3d9"}),(0,h.jsx)(N.Z,{type:"button",size:"small",variant:"outlined",color:"error",onClick:e.onDelete,children:"\uc0ad\uc81c"})]});var T=o(11672),G=o(69066),_=o(11338),z=(o(8374),o(79148)),F=o(47131),K=o(11069),L=o(87704);const P=e=>{var t;const{title:o,gbn:c,date:s,home:d,text:r,image:g,setFireId:f,bookmark:b,setBookmark:j,isLoading:v,onReload:y}=(0,G.C)(),[N,P]=(0,a.useState)(!1),[W,Y]=(0,a.useState)(!1),V=(0,l.s0)(),E=(0,a.useRef)(),O=(0,a.useRef)();O.current=e.searchWord;const{memoId:R}=(0,l.UO)(),U=(0,l.TH)(),A=null===U||void 0===U||null===(t=U.state)||void 0===t?void 0:t.fullIndex,{user:$}=(0,u.$)(),{settings:q,saveSettings:J}=(0,_.r)(),Q=()=>{const e="Y"===b?"N":"Y";j(e),(0,w.MD)($.uid,R,e)};return(0,a.useEffect)((()=>{void 0!==$&&(J({...q,nodeId:R}),P(!1),(0,w.nT)($.uid,R,A),f("memo_txt/".concat($.uid,"/").concat(R),"memo/".concat($.uid,"/").concat(R),O.current)),P(!1)}),[R,$]),""===R||void 0===$?(0,h.jsx)(h.Fragment,{}):(0,h.jsxs)(a.Fragment,{children:[(0,h.jsx)("div",{id:"back-to-top-anchor"}),(0,h.jsxs)(x.a,{style:{display:"flex",flexDirection:"row",alignItems:"center",alignContent:"center",justifyContent:"space-between"},children:[(0,h.jsx)("div",{}),(0,h.jsx)("div",{children:o.current}),(0,h.jsx)(F.Z,{"aria-label":"bookmark",onClick:Q,children:"Y"===b?(0,h.jsx)(K.Z,{sx:{color:"red"}}):(0,h.jsx)(L.Z,{})})]}),(0,h.jsxs)(I.Z,{className:"container",sx:{p:0,width:"100%"},children:[!N&&(0,h.jsx)(B,{onEdit:()=>{E.current=!1,!1===v&&P(!0)},onNewMemo:()=>{E.current=!0,!1===v&&P(!0)},onMove:()=>{Y(!0)},onDelete:()=>{window.confirm("\ud558\uc704 \uc790\ub8cc\uac00 \uc788\ub294 \uacbd\uc6b0 \uac19\uc774 \uc0ad\uc81c\ub429\ub2c8\ub2e4.\n\uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&(async()=>{console.log("handleDelete.memoId=",R);const e=await(0,w.iw)($.uid,R);if(void 0===e)return void alert("\uc0ad\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.");console.log("handleDelete.data=",e);const t="memo/".concat($.uid,"/").concat(e.fullIndex,"/");(0,k.t8)((0,k.iH)(m.h3,t),null),(0,k.t8)((0,k.iH)(m.h3,"memo_txt/".concat($.uid,"/").concat(R)),null),V("/memo")})()},onBookmark:Q,bookmark:b}),N&&(0,h.jsx)(C.Z,{newMode:E.current,onPostSubmit:async(e,t,o)=>{const n="memo_txt/".concat($.uid,"/").concat(R,"/");if(void 0!==t)for(let c=0;c<t.length;c++){const e=t[c];if("Y"===e.del){console.log("onPostSubmit.imageList.file",e),(0,k.t8)((0,k.iH)(m.h3,n+"image/".concat(e.key)),null);const t=await(0,i.iH)(m.IG,"memo/".concat($.uid,"/").concat(R,"/").concat(e.key,".").concat(e.ext));(0,i.oq)(t).then((()=>{console.log("deleteObject")})).catch((e=>{console.log("deleteObject.error=",e)}))}}for(let c=0;c<o.length;c++){const e=o[c].object,t=(0,p.Z)(e.name);console.log("onPostSubmit.file.name",e.name),console.log("onPostSubmit.ext",t);const a={ext:t,name:e.name,use:"Y"},l=(0,k.VF)((0,k.iU)((0,k.iH)(m.h3),n+"image")).key;console.log("onPostSubmit.newKey",l),(0,k.t8)((0,k.iH)(m.h3,n+"image/".concat(l)),a);const s=await(0,i.iH)(m.IG,"memo/".concat($.uid,"/").concat(R,"/").concat(l,".").concat(t)),d=await(0,i.KV)(s,e);console.log("onPostSubmit.uploadBytes",d)}if(await(0,k.t8)((0,k.iH)(m.h3,n+"title"),e.edTitle),await(0,k.t8)((0,k.iH)(m.h3,n+"memo"),e.content),await(0,k.t8)((0,k.iH)(m.h3,n+"date"),e.edDate),await(0,k.t8)((0,k.iH)(m.h3,n+"gbn"),e.edGbn),console.log("onPostSubmit.fullIndex",A),void 0===A){const t=await(0,w.iw)($.uid,"".concat(R,"/fullIndex"));void 0!==t&&(0,k.t8)((0,k.iH)(m.h3,"memo/".concat($.uid,"/").concat(t,"/title")),e.edTitle)}else(0,k.t8)((0,k.iH)(m.h3,"memo/".concat($.uid,"/").concat(A,"/title")),e.edTitle);E.current=!1,P(!1),y()},onNewSubmit:async(e,t,o)=>{const n="memo_txt/".concat($.uid,"/");for(let a=0;a<o.length;a++){const e=o[a].object,t=(0,p.Z)(e.name);console.log("onNewSubmit.file.name",e.name,"ext=",t);const c={ext:t,name:e.name,use:"Y"},l=(0,k.VF)((0,k.iU)((0,k.iH)(m.h3),n+"image")).key;console.log("onNewSubmit.image.newKey",l),(0,k.t8)((0,k.iH)(m.h3,n+"image/".concat(l)),c);const s=await(0,i.iH)(m.IG,"memo/".concat($.uid,"/").concat(R,"/").concat(l,".").concat(t)),d=await(0,i.KV)(s,e);console.log("onNewSubmit.uploadBytes",d)}const c=(0,w.K9)(n);console.log("onNewSubmit.newKey",c),(0,k.t8)((0,k.iH)(m.h3,n+c+"/title"),e.edTitle),(0,k.t8)((0,k.iH)(m.h3,n+c+"/memo"),e.content),(0,k.t8)((0,k.iH)(m.h3,n+c+"/date"),e.edDate),(0,k.t8)((0,k.iH)(m.h3,n+c+"/gbn"),e.edGbn),void 0!==A&&(0,k.t8)((0,k.iH)(m.h3,"memo/".concat($.uid,"/").concat(A,"/sub/").concat(c,"/title")),e.edTitle),V("/memo/".concat(c)),E.current=!1,P(!1),y()},onCancel:()=>{P(!1)},title:o.current,gbn:c.current,date:s.current,content:r,imageList:g}),(0,h.jsxs)(n.Z,{sx:{my:2},children:[(0,h.jsx)(M.O,{show:!N,text:r}),!N&&(0,h.jsx)(z.J,{imageList:g,show:!N}),v&&(0,h.jsx)(n.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:(0,h.jsx)(Z.Z,{sx:{mt:5}})})]}),(0,h.jsx)(D._,{userId:$.uid,open:W,data:e.data,onClose:()=>Y(!1),onPost:async e=>{console.log("onMoveSubmit.memoId",R),console.log("onMoveSubmit.moveId",e);try{const t=await(0,w.iw)($.uid,e);if(void 0===t)return void alert("\uc774\ub3d9\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.[code:110]");if(void 0===t.fullIndex)return void alert("\uc774\ub3d9\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.[code:120]");console.log("onMoveSubmit.toData=",t);const o=await(0,w.iw)($.uid,R);if(void 0===o)return void alert("\uc774\ub3d9\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.[code:210]");if(void 0===o.fullIndex)return void alert("\uc774\ub3d9\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.[code2120]");console.log("onMoveSubmit.fromData=",o);const n=await(0,w.M4)($.uid,o.fullIndex);console.log("onMoveSubmit.treeData=",n),n.fullIndex="".concat(t.fullIndex,"/sub/").concat(R),(0,w.LT)($.uid,"".concat(t.fullIndex,"/sub/").concat(R),n),(0,w.LT)($.uid,o.fullIndex,null)}catch(t){console.log("catch",t)}finally{Y(!1)}}})]}),(0,h.jsx)(T.p,{...e,id:"#back-to-top-anchor",children:(0,h.jsx)(H.Z,{color:"primary",size:"small","aria-label":"scroll back to top",children:(0,h.jsx)(S.Z,{})})})]})};var W=o(37029),Y=o(70298);const V=e=>{const t=(0,l.s0)(),{user:s}=(0,u.$)(),[d,r]=(0,a.useState)(!1),x=(0,a.useRef)(),[k,S,Z]=(0,Y.V)(""),[H,I]=(0,a.useState)(""),M=(0,a.useRef)();(0,a.useEffect)((()=>{void 0!==s&&S("memo/".concat(s.uid))}),[s]);const D=()=>{console.log("onNewMemoBtn.fullIndex",M),void 0!==s?r(!0):alert("\ub85c\uadf8\uc778 \ud6c4 \uc774\uc6a9 \uac00\ub2a5\ud569\ub2c8\ub2e4.")},N=async(e,t,o)=>{const n="memo_txt/".concat(s.uid,"/");for(let r=0;r<o.length;r++){const e=o[r].object,t=(0,p.Z)(e.name);console.log("onNewSubmit.file.name",e.name,"ext=",t);const a={ext:t,name:e.name,use:"Y"},l=(0,c.VF)((0,c.iU)((0,c.iH)(m.h3),n+"image")).key;console.log("onNewSubmit.image.newKey",l),(0,c.t8)((0,c.iH)(m.h3,n+"image/".concat(l)),a);const d=await(0,i.iH)(m.IG,"memo/".concat(s.uid,"/").concat(H,"/").concat(l,".").concat(t)),u=await(0,i.KV)(d,e);console.log("onNewSubmit.uploadBytes",u)}const a=(0,w.K9)(n),l={title:e.edTitle,date:e.edDate,gbn:e.edGbn,memo:e.content,fullIndex:a,up:a,bookmark:"N"};(0,w.hb)("".concat(n).concat(a),l);const d={gbn:"",property:"m",title:e.edTitle,up:a};(0,w.hb)("memo/".concat(s.uid,"/").concat(a),d),r(!1)},{height:B,width:T}=(0,y.Z)(),G=(0,h.jsxs)(n.Z,{sx:{minHeight:110,flexGrow:1,minWidth:100,maxHeight:B},children:[(0,h.jsx)(f.j,{}),(0,h.jsx)(b.x,{onNewMemoBtn:D,onSearchDataBtn:e=>{console.log("onSearchDataBtn=",e),""!==e?(S("memo_txt/".concat(s.uid)),Z(e)):(Z(void 0),S("memo/".concat(s.uid))),x.current=e}}),(0,h.jsx)(n.Z,{sx:{flexGrow:1,minWidth:100,minHeight:110,maxHeight:B-220,height:B-220},children:(0,h.jsx)(a.Suspense,{fallback:(0,h.jsx)(W.g,{}),children:(0,h.jsx)(j.Z,{data:k,onDetail:(e,o)=>{M.current=o,I(e),t("/memo/".concat(e),{state:{fullIndex:o}})},maxHeight:B-150})})})]}),_=a.lazy((async()=>await o.e(473).then(o.bind(o,71473))));return(0,h.jsx)(a.Suspense,{fallback:(0,h.jsx)(W.g,{}),children:(0,h.jsxs)(v.j,{title:"\uba54\ubaa8\uc7a5",drawerWidth:220,width:T,sideContents:G,children:[!d&&(0,h.jsx)(a.Suspense,{fallback:(0,h.jsx)(W.g,{}),children:(0,h.jsxs)(l.Z5,{children:[(0,h.jsx)(l.AW,{path:"/:memoId",element:(0,h.jsx)(P,{searchWord:x.current,data:k})}),(0,h.jsx)(l.AW,{path:"*",element:(0,h.jsx)(_,{searchWord:x.current,data:k,onNewMemoBtn:D,title:"\uba54\ubaa8\uc7a5 \ud648"})})]})}),d&&(0,h.jsx)(C.Z,{show:d,newMode:d.current,onPostSubmit:N,onNewSubmit:N,onCancel:()=>{r(!1)},title:"",content:"",imageList:[]}),(0,h.jsx)(g,{onSelected:e=>{console.log("onSelected=",e),I(e)}})]})})}},11069:(e,t,o)=>{var n=o(64836);t.Z=void 0;var c=n(o(45045)),i=o(46417),a=(0,c.default)((0,i.jsx)("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"}),"Favorite");t.Z=a},87704:(e,t,o)=>{var n=o(64836);t.Z=void 0;var c=n(o(45045)),i=o(46417),a=(0,c.default)((0,i.jsx)("path",{d:"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"}),"FavoriteBorder");t.Z=a}}]);