"use strict";(self.webpackChunksiny_memo=self.webpackChunksiny_memo||[]).push([[655,473],{35230:(t,e,n)=>{n.r(e),n.d(e,{default:()=>G});var o=n(41806),i=n(12725),c=n(87120),a=n(47313),s=n(58467),l=n(37029),r=n(4319),d=n(93727),h=n(63856),u=n(68322),m=n(47317),x=n(2024),f=n(96821),g=n(70298),j=n(41792),w=n(6608),b=n(63325),v=n(71473),H=n(49336),y=n(85281),I=n(47825),Z=n(21587),p=n(46417);const k=t=>(0,p.jsxs)(o.Z,{sx:{flexGrow:1,my:2,width:"100%",display:"flex",flexDirection:"row",alignItems:"center",alignContent:"center",justifyContent:"center",textAlign:"center"},children:[(0,p.jsx)(Z.ZP,{type:"button",size:"small",variant:"outlined",color:"success",onClick:t.onEdit,children:"\uc218\uc815"}),(0,p.jsx)(Z.ZP,{type:"button",size:"small",variant:"outlined",onClick:t.onNewMemo,children:"\uc0c8\uae00"}),(0,p.jsx)(Z.ZP,{type:"button",size:"small",variant:"outlined",color:"warning",onClick:t.onMove,children:"\uc774\ub3d9"}),(0,p.jsx)(Z.ZP,{type:"button",size:"small",variant:"outlined",color:"error",onClick:t.onDelete,children:"\uc0ad\uc81c"})]});var M=n(43407),C=n(50003),S=n(79148),P=n(2774),B=n(69066),D=n(11338),N=(n(8374),n(59941));const _=t=>{var e;const{title:n,gbn:i,date:r,text:d,image:u,setFireId:g,isLoading:j,onReload:b}=(0,B.C)(),[v,Z]=(0,a.useState)(!1),[_,G]=(0,a.useState)(!1),F=(0,s.s0)(),T=(0,a.useRef)(),W=(0,a.useRef)();W.current=t.searchWord;const{homeId:V}=(0,s.UO)(),Y=(0,s.TH)(),E=null===Y||void 0===Y||null===(e=Y.state)||void 0===e?void 0:e.fullIndex,{user:L}=(0,f.$)(),{settings:R,saveSettings:U}=(0,D.r)();return(0,a.useEffect)((()=>{U({...R,nodeId:V}),Z(!1),(0,m.w5)(V,E),g("home_txt/".concat(V),"home/".concat(V),W.current)}),[V,L]),""===V||void 0===L?(0,p.jsx)(p.Fragment,{}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{id:"back-to-top-anchor"}),(0,p.jsx)(P.a,{children:n.current}),(0,p.jsx)(a.Suspense,{fallback:(0,p.jsx)(l.g,{}),children:(0,p.jsxs)(I.Z,{className:"container",sx:{p:0,width:"100%"},children:[!v&&(0,p.jsx)(k,{onEdit:()=>{T.current=!1,!1===j&&Z(!0)},onNewMemo:()=>{T.current=!0,!1===j&&Z(!0)},onMove:()=>{G(!0)},onDelete:()=>{window.confirm("\ud558\uc704 \uc790\ub8cc\uac00 \uc788\ub294 \uacbd\uc6b0 \uac19\uc774 \uc0ad\uc81c\ub429\ub2c8\ub2e4.\n\uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&(async()=>{const t=await(0,m.MB)("home_txt/".concat(V));if(void 0===t)return void alert("\uc0ad\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.");const e="home/".concat(t.fullIndex,"/");(0,H.t8)((0,H.iH)(x.h3,e),null),(0,H.t8)((0,H.iH)(x.h3,"home_txt/".concat(V)),null),F("/homemng")})()}}),v&&(0,p.jsx)(h.Z,{newMode:T.current,onPostSubmit:async(t,e,n)=>{console.log("onPostSubmit.values",t);const o="home_txt/".concat(V,"/");if(console.log("onPostSubmit.imageList",e),void 0!==e)for(let i=0;i<e.length;i++){const t=e[i];if("Y"===t.del){(0,H.t8)((0,H.iH)(x.h3,o+"image/".concat(t.key)),null);const e=await(0,c.iH)(x.IG,"home/".concat(V,"/").concat(t.key,".").concat(t.ext));(0,c.oq)(e).then((()=>{})).catch((t=>{}))}}console.log("onPostSubmit.files=",n);for(let i=0;i<n.length;i++){const t=n[i].object,e=(0,w.Z)(t.name),a={ext:e,name:t.name,use:"Y"},s=(0,H.VF)((0,H.iU)((0,H.iH)(x.h3),o+"image")).key;(0,H.t8)((0,H.iH)(x.h3,o+"image/".concat(s)),a);const l=await(0,c.iH)(x.IG,"home/".concat(V,"/").concat(s,".").concat(e));await(0,c.KV)(l,t)}if(await(0,H.t8)((0,H.iH)(x.h3,o+"title"),t.edTitle),await(0,H.t8)((0,H.iH)(x.h3,o+"memo"),t.content),await(0,H.t8)((0,H.iH)(x.h3,o+"date"),t.edDate),await(0,H.t8)((0,H.iH)(x.h3,o+"gbn"),t.edGbn),console.log("onPostSubmit.fullIndex",E),void 0===E){const e=await(0,m.MB)("".concat(o,"fullIndex"));void 0!==e&&await(0,H.t8)((0,H.iH)(x.h3,"home/".concat(e,"/title")),t.edTitle)}else await(0,H.t8)((0,H.iH)(x.h3,"home/".concat(E,"/title")),t.edTitle);T.current=!1,Z(!1),b()},onNewSubmit:async(t,e,n)=>{const o="home_txt/";for(let a=0;a<n.length;a++){const t=n[a].object,e=(0,w.Z)(t.name),i={ext:e,name:t.name,use:"Y"},s=(0,H.VF)((0,H.iU)((0,H.iH)(x.h3),o+"image")).key;(0,H.t8)((0,H.iH)(x.h3,o+"image/".concat(s)),i);const l=await(0,c.iH)(x.IG,"home/".concat(V,"/").concat(s,".").concat(e));await(0,c.KV)(l,t)}const i=(0,H.VF)((0,H.iU)((0,H.iH)(x.h3),o)).key;(0,H.t8)((0,H.iH)(x.h3,o+i+"/title"),t.edTitle),(0,H.t8)((0,H.iH)(x.h3,o+i+"/memo"),t.content),(0,H.t8)((0,H.iH)(x.h3,o+i+"/date"),t.edDate),(0,H.t8)((0,H.iH)(x.h3,o+i+"/gbn"),t.edGbn),void 0!==E&&(0,H.t8)((0,H.iH)(x.h3,"home/".concat(E,"/sub/").concat(i,"/title")),t.edTitle),F("/homemng/".concat(i)),T.current=!1,Z(!1),b()},onCancel:()=>{Z(!1)},title:n.current,gbn:i.current,date:r.current,content:d,imageList:u}),(0,p.jsxs)(o.Z,{sx:{my:2,overflow:"hidden",overflowX:"auto"},children:[i.current,(0,p.jsx)(M.O,{show:!v,text:d}),!v&&(0,p.jsx)(S.J,{imageList:u}),j&&(0,p.jsx)(o.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:(0,p.jsx)(y.Z,{sx:{mt:5}})})]}),(0,p.jsx)(C._,{userId:L.uid,open:_,data:t.data,onClose:()=>G(!1),onPost:async t=>{try{const e=await(0,m.MB)("home_txt/".concat(t));if(void 0===e)return void alert("\uc774\ub3d9\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.[code:110]");if(void 0===e.fullIndex)return void alert("\uc774\ub3d9\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.[code:120]");const n=await(0,m.MB)("home_txt/".concat(V));if(void 0===n)return void alert("\uc774\ub3d9\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.[code:210]");if(void 0===n.fullIndex)return void alert("\uc774\ub3d9\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.[code2120]");const o=await(0,m.MB)("home/".concat(n.fullIndex));o.fullIndex="".concat(e.fullIndex,"/sub/").concat(V),(0,m.bN)("".concat(e.fullIndex,"/sub/").concat(V),o),(0,m.bN)(n.fullIndex,null)}catch(e){}finally{G(!1)}}})]})}),(0,p.jsx)(N.d,{})]})},G=t=>{const e=(0,s.s0)(),{user:n}=(0,f.$)(),[H,y]=(0,a.useState)(!1),I=(0,a.useRef)(),[Z]=(0,g.V)("home"),[k,M]=(0,a.useState)(""),C=(0,a.useRef)();(0,a.useEffect)((()=>{}),[n]);const S=()=>{y(!0)},P=async(t,e,o)=>{const a="home_txt/".concat(n.uid,"/");for(let n=0;n<o.length;n++){const t=o[n].object,e=(0,w.Z)(t.name),s={ext:e,name:t.name,use:"Y"},l=(0,i.VF)((0,i.iU)((0,i.iH)(x.h3),a+"image")).key;(0,i.t8)((0,i.iH)(x.h3,a+"image/".concat(l)),s);const r=await(0,c.iH)(x.IG,"home/".concat(k,"/").concat(l,".").concat(e));await(0,c.KV)(r,t)}const s=(0,m.K9)(a),l={title:t.edTitle,date:t.edDate,gbn:t.edGbn,memo:t.content,fullIndex:s,up:s,bookmark:"N"};(0,m.hb)("".concat(a).concat(s),l);const r={gbn:"",property:"m",title:t.title,up:s};(0,m.hb)("home/".concat(s),r),y(!1)},{height:B,width:D}=(0,b.Z)();if(!n)return(0,p.jsx)(p.Fragment,{});"I3cTgdCxwjhBBno4mtZYvnODPJu1"!==n.uid&&e("/");const N=(0,p.jsxs)(o.Z,{sx:{minHeight:110,flexGrow:1,minWidth:100,maxHeight:B},children:[(0,p.jsx)(d.j,{}),(0,p.jsx)(r.x,{onNewMemoBtn:S,onSearchDataBtn:t=>{I.current=t}}),(0,p.jsx)(o.Z,{sx:{flexGrow:1,minWidth:100,minHeight:110,maxHeight:B-220,height:B-220},children:(0,p.jsx)(a.Suspense,{fallback:(0,p.jsx)(l.g,{}),children:(0,p.jsx)(u.Z,{data:Z,onDetail:(t,n)=>{C.current=n,M(t),e("/homemng/".concat(t),{state:{fullIndex:n}})},maxHeight:B-150})})})]});return(0,p.jsxs)(j.j,{title:"\ud648 \uad00\ub9ac",drawerWidth:220,width:D,sideContents:N,children:[(0,p.jsxs)(s.Z5,{children:[(0,p.jsx)(s.AW,{path:"/",element:(0,p.jsx)(v.MemoMain,{searchWord:I.current,data:Z,onNewMemoBtn:S,title:"\ud648\ud398\uc774\uc9c0 \uad00\ub9ac"})}),(0,p.jsx)(s.AW,{path:"/:homeId",element:(0,p.jsx)(_,{searchWord:I.current,data:Z})})]}),H&&(0,p.jsx)(h.Z,{show:H,newMode:H.current,onPostSubmit:P,onNewSubmit:P,onCancel:()=>{y(!1)},title:"",content:"",imageList:[]})]})}},71473:(t,e,n)=>{n.r(e),n.d(e,{MemoMain:()=>s,default:()=>l});var o=n(21587),i=n(53431),c=n(96821),a=n(46417);const s=t=>{const{user:e}=(0,c.$)();const n=e&&"I3cTgdCxwjhBBno4mtZYvnODPJu1"===e.uid?(0,a.jsx)(i.nf,{to:"/homemng",children:" \ud648\ud398\uc774\uc9c0 \uad00\ub9ac"}):"";return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h3",{children:t.title}),"\uc0ac\uc774\ub4dc \uba54\ub274\uc5d0\uc11c",(0,a.jsx)(o.ZP,{disableElevation:!0,fullWidth:!0,type:"button",variant:"outlined",color:"success",onClick:function(){return t.onNewMemoBtn(),!1},children:"\uc0c8\uae00"}),"\ubc84\ud2bc\uc744 \uc0ac\uc6a9\ud574 \uba54\ubaa8\ub97c \uc791\uc131\ud569\ub2c8\ub2e4.",n]})},l=s}}]);