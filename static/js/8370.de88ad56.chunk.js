"use strict";(self.webpackChunksiny_memo=self.webpackChunksiny_memo||[]).push([[8370,1473],{35230:(e,t,n)=>{n.r(t),n.d(t,{default:()=>W});var o=n(41806),s=n(12725),i=n(87120),c=n(47313),a=n(58467),l=n(37029),r=n(4319),d=n(93727),m=n(63856),u=n(68322),h=n(47317),x=n(2024),g=n(96821),j=n(70298),w=n(41792),f=n(6608),b=n(63325),v=n(71473),y=n(49336),p=n(85281),Z=n(47825),S=n(21587),I=n(46417);const M=e=>(0,I.jsxs)(o.Z,{sx:{flexGrow:1,my:2,width:"100%",display:"flex",flexDirection:"row",alignItems:"center",alignContent:"center",justifyContent:"center",textAlign:"center"},children:[(0,I.jsx)(S.ZP,{type:"button",size:"small",variant:"outlined",color:"success",onClick:e.onEdit,children:"\uc218\uc815"}),(0,I.jsx)(S.ZP,{type:"button",size:"small",variant:"outlined",onClick:e.onNewMemo,children:"\uc0c8\uae00"}),(0,I.jsx)(S.ZP,{type:"button",size:"small",variant:"outlined",color:"warning",onClick:e.onMove,children:"\uc774\ub3d9"}),(0,I.jsx)(S.ZP,{type:"button",size:"small",variant:"outlined",color:"error",onClick:e.onDelete,children:"\uc0ad\uc81c"})]});var C=n(35074),k=n(50003),H=n(79148),N=n(2774),P=n(69066),_=n(11338),D=(n(8374),n(59941)),R=n(73786),B=n(25266);const E=e=>{var t;const{title:n,gbn:s,date:i,text:r,image:d,setFireId:u,isLoading:j,onReload:w}=(0,P.C)(),[f,b]=(0,c.useState)(!1),[v,S]=(0,c.useState)(!1),E=(0,a.s0)(),W=(0,c.useRef)(),F=(0,c.useRef)();F.current=e.searchWord;const{homeId:T}=(0,a.UO)(),L=(0,a.TH)(),A=null===L||void 0===L||null===(t=L.state)||void 0===t?void 0:t.fullIndex,{user:G}=(0,g.$)(),{settings:Y,saveSettings:z}=(0,_.r)();return(0,c.useEffect)((()=>{z({...Y,nodeId:T}),b(!1),(0,h.w5)(T,A),u("home_txt/".concat(T),"home/".concat(T),F.current)}),[T,G]),(0,c.useEffect)((()=>{null!==r&&document.querySelectorAll("pre").forEach((e=>{e.innerHTML=(0,B.A)(e.innerHTML)}))}),[r]),""===T||void 0===G?(0,I.jsx)(I.Fragment,{}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(N.a,{children:n.current}),(0,I.jsx)(c.Suspense,{fallback:(0,I.jsx)(l.g,{}),children:(0,I.jsxs)(Z.Z,{className:"container",sx:{p:0,width:"100%"},children:[!f&&(0,I.jsx)(M,{onEdit:()=>{W.current=!1,!1===j&&b(!0)},onNewMemo:()=>{W.current=!0,!1===j&&b(!0)},onMove:()=>{S(!0)},onDelete:()=>{window.confirm("\ud558\uc704 \uc790\ub8cc\uac00 \uc788\ub294 \uacbd\uc6b0 \uac19\uc774 \uc0ad\uc81c\ub429\ub2c8\ub2e4.\n\uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&(async()=>{console.log("handleDelete.homeId=",T);const e="home_txt/".concat(T),t=await(0,R.Rb)(e,"home");console.log("handleDelete.result=",t),void 0!==t?E("/homemng"):alert("\uc0ad\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.[code:d02]")})()}}),f&&(0,I.jsx)(m.Z,{newMode:W.current,onPostSubmit:async(e,t,n)=>{const o="home_txt/".concat(T),s="home";await(0,R.FR)(o,s,T,t),await(0,R.t4)(T,"home_txt/","home/",A,e);console.log("onPostSubmit.files=",n);const i=await(0,R.YE)("home_txt","home",T,n);if(console.log("onNewSubmit.imageResult",i),console.log("onPostSubmit.fullIndex",A),void 0===A){const t=await(0,h.MB)("".concat(s,"fullIndex"));void 0!==t&&await(0,y.t8)((0,y.iH)(x.h3,"home/".concat(t,"/title")),e.edTitle)}W.current=!1,b(!1),w()},onNewSubmit:async(e,t)=>{const n=await(0,R.t4)(void 0,"home_txt/","home/",A,e);console.log("onNewSubmit.newKey=",n,", homeId=",T);const o=await(0,R.YE)("home_txt","home",n,t);console.log("onNewSubmit.imageResult",o),void 0!==n&&E("/homemng/".concat(n)),W.current=!1,b(!1),w()},onCancel:()=>{b(!1)},title:n.current,gbn:s.current,date:i.current,content:r,imageList:d}),(0,I.jsxs)(o.Z,{sx:{my:2,overflow:"hidden",overflowX:"auto"},children:[s.current,(0,I.jsx)(C.O,{show:!f,text:r}),!f&&(0,I.jsx)(H.J,{imageList:d}),j&&(0,I.jsx)(o.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:(0,I.jsx)(p.Z,{sx:{mt:5}})})]}),(0,I.jsx)(k._,{userId:G.uid,open:v,data:e.data,onClose:()=>S(!1),onPost:async e=>{try{const t="home_txt/".concat(T),n="home",o=await(0,R.RV)(t,n,T,e);console.log("onMoveSubmit.result=",o)}catch(t){}finally{S(!1)}}})]})}),(0,I.jsx)(D.d,{})]})},W=e=>{const t=(0,a.s0)(),{user:n}=(0,g.$)(),[y,p]=(0,c.useState)(!1),Z=(0,c.useRef)(),[S]=(0,j.V)("home"),[M,C]=(0,c.useState)(""),k=(0,c.useRef)();(0,c.useEffect)((()=>{}),[n]);const H=()=>{p(!0)},N=async(e,t)=>{const o="home_txt/".concat(n.uid,"/");for(let n=0;n<t.length;n++){const e=t[n].object,c=(0,f.Z)(e.name),a={ext:c,name:e.name,use:"Y"},l=(0,s.VF)((0,s.iU)((0,s.iH)(x.h3),o+"image")).key;(0,s.t8)((0,s.iH)(x.h3,o+"image/".concat(l)),a);const r=await(0,i.iH)(x.IG,"home/".concat(M,"/").concat(l,".").concat(c));await(0,i.KV)(r,e)}const c=(0,h.K9)(o),a={title:e.edTitle,date:e.edDate,gbn:e.edGbn,memo:e.content,fullIndex:c,up:c,bookmark:"N"};(0,h.hb)("".concat(o).concat(c),a);const l={gbn:"",property:"m",title:e.title,up:c};(0,h.hb)("home/".concat(c),l),p(!1)},{height:P,width:_}=(0,b.Z)();if(!n)return(0,I.jsx)(I.Fragment,{});"I3cTgdCxwjhBBno4mtZYvnODPJu1"!==n.uid&&t("/");const D=(0,I.jsxs)(o.Z,{sx:{minHeight:110,flexGrow:1,minWidth:100,maxHeight:P},children:[(0,I.jsx)(d.j,{}),(0,I.jsx)(r.x,{onNewMemoBtn:H,onSearchDataBtn:e=>{Z.current=e}}),(0,I.jsx)(o.Z,{sx:{flexGrow:1,minWidth:100,minHeight:110,maxHeight:P-220,height:P-220},children:(0,I.jsx)(c.Suspense,{fallback:(0,I.jsx)(l.g,{}),children:(0,I.jsx)(u.Z,{data:S,onDetail:(e,n)=>{k.current=n,C(e),t("/homemng/".concat(e),{state:{fullIndex:n}})},maxHeight:P-150})})})]});return(0,I.jsxs)(w.j,{title:"\ud648 \uad00\ub9ac",drawerWidth:220,width:_,sideContents:D,children:[(0,I.jsxs)(a.Z5,{children:[(0,I.jsx)(a.AW,{path:"/",element:(0,I.jsx)(v.MemoMain,{searchWord:Z.current,data:S,onNewMemoBtn:H,title:"\ud648\ud398\uc774\uc9c0 \uad00\ub9ac"})}),(0,I.jsx)(a.AW,{path:"/:homeId",element:(0,I.jsx)(E,{searchWord:Z.current,data:S})})]}),y&&(0,I.jsx)(m.Z,{show:y,newMode:y.current,onPostSubmit:N,onNewSubmit:N,onCancel:()=>{p(!1)},title:"",content:"",imageList:[]})]})}},71473:(e,t,n)=>{n.r(t),n.d(t,{MemoMain:()=>a,default:()=>l});var o=n(21587),s=n(53431),i=n(96821),c=n(46417);const a=e=>{const{user:t}=(0,i.$)();const n=t&&"I3cTgdCxwjhBBno4mtZYvnODPJu1"===t.uid?(0,c.jsx)(s.nf,{to:"/homemng",children:" \ud648\ud398\uc774\uc9c0 \uad00\ub9ac"}):"";return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("h3",{children:e.title}),"\uc0ac\uc774\ub4dc \uba54\ub274\uc5d0\uc11c",(0,c.jsx)(o.ZP,{disableElevation:!0,type:"button",variant:"outlined",color:"success",onClick:function(){return e.onNewMemoBtn(),!1},children:"\uc0c8\uae00"}),"\ubc84\ud2bc\uc744 \uc0ac\uc6a9\ud574 \uba54\ubaa8\ub97c \uc791\uc131\ud569\ub2c8\ub2e4.",n]})},l=a}}]);