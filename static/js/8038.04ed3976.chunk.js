"use strict";(self.webpackChunksiny_memo=self.webpackChunksiny_memo||[]).push([[8038,1473],{17152:(t,e,n)=>{n.r(e),n.d(e,{default:()=>F});var o=n(41806),c=n(12725),i=n(87120),a=n(47313),s=n(58467),l=n(37029),r=n(4319),d=n(93727),h=n(63856),u=n(68322),m=n(47317),x=n(2024),f=n(96821),g=n(70298),w=n(41792),j=n(6608),b=n(63325),v=n(71473),H=n(49336),y=n(85281),I=n(47825),Z=n(21587),p=n(46417);const k=t=>(0,p.jsxs)(o.Z,{sx:{flexGrow:1,my:2,width:"100%",display:"flex",flexDirection:"row",alignItems:"center",alignContent:"center",justifyContent:"center",textAlign:"center"},children:[(0,p.jsx)(Z.ZP,{type:"button",size:"small",variant:"outlined",color:"success",onClick:t.onEdit,children:"\uc218\uc815"}),(0,p.jsx)(Z.ZP,{type:"button",size:"small",variant:"outlined",onClick:t.onNewMemo,children:"\uc0c8\uae00"}),(0,p.jsx)(Z.ZP,{type:"button",size:"small",variant:"outlined",color:"warning",onClick:t.onMove,children:"\uc774\ub3d9"}),(0,p.jsx)(Z.ZP,{type:"button",size:"small",variant:"outlined",color:"error",onClick:t.onDelete,children:"\uc0ad\uc81c"})]});var M=n(43407),C=n(50003),S=n(79148),P=n(2774),B=n(69066),D=n(11338),_=(n(8374),n(59941));const G=t=>{var e;const{title:n,gbn:r,date:d,text:u,image:g,setFireId:w,isLoading:b,onReload:v}=(0,B.C)(),[Z,G]=(0,a.useState)(!1),[F,N]=(0,a.useState)(!1),T=(0,s.s0)(),W=(0,a.useRef)(),V=(0,a.useRef)();V.current=t.searchWord;const{homeId:Y}=(0,s.UO)(),E=(0,s.TH)(),L=null===E||void 0===E||null===(e=E.state)||void 0===e?void 0:e.fullIndex,{user:R}=(0,f.$)(),{settings:U,saveSettings:z}=(0,D.r)(),K=async()=>{const t="home_txt/".concat(Y),e=await(async t=>{const e=await(0,m.MB)(t);if(void 0===e)return void alert("\uc0ad\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.");const n="home/".concat(e.fullIndex,"/");(0,c.t8)((0,c.iH)(x.h3,n),null),(0,c.t8)((0,c.iH)(x.h3,t),null)})(t);void 0!==e?T("/homemng"):alert("\uc0ad\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")};return(0,a.useEffect)((()=>{z({...U,nodeId:Y}),G(!1),(0,m.w5)(Y,L),w("home_txt/".concat(Y),"home/".concat(Y),V.current)}),[Y,R]),""===Y||void 0===R?(0,p.jsx)(p.Fragment,{}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{id:"back-to-top-anchor"}),(0,p.jsx)(P.a,{children:n.current}),(0,p.jsx)(a.Suspense,{fallback:(0,p.jsx)(l.g,{}),children:(0,p.jsxs)(I.Z,{className:"container",sx:{p:0,width:"100%"},children:[!Z&&(0,p.jsx)(k,{onEdit:()=>{W.current=!1,!1===b&&G(!0)},onNewMemo:()=>{W.current=!0,!1===b&&G(!0)},onMove:()=>{N(!0)},onDelete:()=>{window.confirm("\ud558\uc704 \uc790\ub8cc\uac00 \uc788\ub294 \uacbd\uc6b0 \uac19\uc774 \uc0ad\uc81c\ub429\ub2c8\ub2e4.\n\uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&K()}}),Z&&(0,p.jsx)(h.Z,{newMode:W.current,onPostSubmit:async(t,e,n)=>{console.log("onPostSubmit.values",t);const o="home_txt/".concat(Y,"/");if(console.log("onPostSubmit.imageList",e),void 0!==e)for(let c=0;c<e.length;c++){const t=e[c];if("Y"===t.del){(0,H.t8)((0,H.iH)(x.h3,o+"image/".concat(t.key)),null);const e=await(0,i.iH)(x.IG,"home/".concat(Y,"/").concat(t.key,".").concat(t.ext));(0,i.oq)(e).then((()=>{})).catch((t=>{}))}}console.log("onPostSubmit.files=",n);for(let c=0;c<n.length;c++){const t=n[c].object,e=(0,j.Z)(t.name),a={ext:e,name:t.name,use:"Y"},s=(0,H.VF)((0,H.iU)((0,H.iH)(x.h3),o+"image")).key;(0,H.t8)((0,H.iH)(x.h3,o+"image/".concat(s)),a);const l=await(0,i.iH)(x.IG,"home/".concat(Y,"/").concat(s,".").concat(e));await(0,i.KV)(l,t)}if(await(0,H.t8)((0,H.iH)(x.h3,o+"title"),t.edTitle),await(0,H.t8)((0,H.iH)(x.h3,o+"memo"),t.content),await(0,H.t8)((0,H.iH)(x.h3,o+"date"),t.edDate),await(0,H.t8)((0,H.iH)(x.h3,o+"gbn"),t.edGbn),console.log("onPostSubmit.fullIndex",L),void 0===L){const e=await(0,m.MB)("".concat(o,"fullIndex"));void 0!==e&&await(0,H.t8)((0,H.iH)(x.h3,"home/".concat(e,"/title")),t.edTitle)}else await(0,H.t8)((0,H.iH)(x.h3,"home/".concat(L,"/title")),t.edTitle);W.current=!1,G(!1),v()},onNewSubmit:async(t,e)=>{const n="home_txt/";for(let c=0;c<e.length;c++){const t=e[c].object,o=(0,j.Z)(t.name),a={ext:o,name:t.name,use:"Y"},s=(0,H.VF)((0,H.iU)((0,H.iH)(x.h3),n+"image")).key;(0,H.t8)((0,H.iH)(x.h3,n+"image/".concat(s)),a);const l=await(0,i.iH)(x.IG,"home/".concat(Y,"/").concat(s,".").concat(o));await(0,i.KV)(l,t)}const o=(0,H.VF)((0,H.iU)((0,H.iH)(x.h3),n)).key;(0,H.t8)((0,H.iH)(x.h3,n+o+"/title"),t.edTitle),(0,H.t8)((0,H.iH)(x.h3,n+o+"/memo"),t.content),(0,H.t8)((0,H.iH)(x.h3,n+o+"/date"),t.edDate),(0,H.t8)((0,H.iH)(x.h3,n+o+"/gbn"),t.edGbn),void 0!==L&&(0,H.t8)((0,H.iH)(x.h3,"home/".concat(L,"/sub/").concat(o,"/title")),t.edTitle),T("/homemng/".concat(o)),W.current=!1,G(!1),v()},onCancel:()=>{G(!1)},title:n.current,gbn:r.current,date:d.current,content:u,imageList:g}),(0,p.jsxs)(o.Z,{sx:{my:2,overflow:"hidden",overflowX:"auto"},children:[r.current,(0,p.jsx)(M.O,{show:!Z,text:u}),!Z&&(0,p.jsx)(S.J,{imageList:g}),b&&(0,p.jsx)(o.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:(0,p.jsx)(y.Z,{sx:{mt:5}})})]}),(0,p.jsx)(C._,{userId:R.uid,open:F,data:t.data,onClose:()=>N(!1),onPost:async t=>{try{const e="home";await(async(t,e,n)=>{try{const o=await(0,m.MB)(t+"_txt/"+n);if(void 0===o)return void alert("\uc774\ub3d9\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.[code:110]");if(void 0===o.fullIndex)return void alert("\uc774\ub3d9\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.[code:120]");const i=await(0,m.MB)(t+"_txt/"+e);if(void 0===i)return void alert("\uc774\ub3d9\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.[code:210]");if(void 0===i.fullIndex)return void alert("\uc774\ub3d9\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.[code2120]");const a=await(0,m.MB)("".concat(t,"_txt/").concat(i.fullIndex));a.fullIndex="".concat(o.fullIndex,"/sub/").concat(e);const s="".concat(t,"/").concat(o.fullIndex,"/sub/").concat(e);(0,c.t8)((0,c.iH)(x.h3,s),a);const l="".concat(t,"/").concat(i.fullIndex,"/sub/").concat(e);(0,c.t8)((0,c.iH)(x.h3,l),null)}catch(o){}})(e,Y,t)}catch(e){}finally{N(!1)}}})]})}),(0,p.jsx)(_.d,{})]})},F=t=>{const e=(0,s.s0)(),{user:n}=(0,f.$)(),[H,y]=(0,a.useState)(!1),I=(0,a.useRef)(),[Z]=(0,g.V)("home"),[k,M]=(0,a.useState)(""),C=(0,a.useRef)();(0,a.useEffect)((()=>{}),[n]);const S=()=>{y(!0)},P=async(t,e)=>{const o="home_txt/".concat(n.uid,"/");for(let n=0;n<e.length;n++){const t=e[n].object,a=(0,j.Z)(t.name),s={ext:a,name:t.name,use:"Y"},l=(0,c.VF)((0,c.iU)((0,c.iH)(x.h3),o+"image")).key;(0,c.t8)((0,c.iH)(x.h3,o+"image/".concat(l)),s);const r=await(0,i.iH)(x.IG,"home/".concat(k,"/").concat(l,".").concat(a));await(0,i.KV)(r,t)}const a=(0,m.K9)(o),s={title:t.edTitle,date:t.edDate,gbn:t.edGbn,memo:t.content,fullIndex:a,up:a,bookmark:"N"};(0,m.hb)("".concat(o).concat(a),s);const l={gbn:"",property:"m",title:t.title,up:a};(0,m.hb)("home/".concat(a),l),y(!1)},{height:B,width:D}=(0,b.Z)();if(!n)return(0,p.jsx)(p.Fragment,{});"I3cTgdCxwjhBBno4mtZYvnODPJu1"!==n.uid&&e("/");const _=(0,p.jsxs)(o.Z,{sx:{minHeight:110,flexGrow:1,minWidth:100,maxHeight:B},children:[(0,p.jsx)(d.j,{}),(0,p.jsx)(r.x,{onNewMemoBtn:S,onSearchDataBtn:t=>{I.current=t}}),(0,p.jsx)(o.Z,{sx:{flexGrow:1,minWidth:100,minHeight:110,maxHeight:B-220,height:B-220},children:(0,p.jsx)(a.Suspense,{fallback:(0,p.jsx)(l.g,{}),children:(0,p.jsx)(u.Z,{data:Z,onDetail:(t,n)=>{C.current=n,M(t),e("/homemng/".concat(t),{state:{fullIndex:n}})},maxHeight:B-150})})})]});return(0,p.jsxs)(w.j,{title:"\ud648 \uad00\ub9ac",drawerWidth:220,width:D,sideContents:_,children:[(0,p.jsxs)(s.Z5,{children:[(0,p.jsx)(s.AW,{path:"/",element:(0,p.jsx)(v.MemoMain,{searchWord:I.current,data:Z,onNewMemoBtn:S,title:"\ud648\ud398\uc774\uc9c0 \uad00\ub9ac"})}),(0,p.jsx)(s.AW,{path:"/:homeId",element:(0,p.jsx)(G,{searchWord:I.current,data:Z})})]}),H&&(0,p.jsx)(h.Z,{show:H,newMode:H.current,onPostSubmit:P,onNewSubmit:P,onCancel:()=>{y(!1)},title:"",content:"",imageList:[]})]})}},71473:(t,e,n)=>{n.r(e),n.d(e,{MemoMain:()=>s,default:()=>l});var o=n(21587),c=n(53431),i=n(96821),a=n(46417);const s=t=>{const{user:e}=(0,i.$)();const n=e&&"I3cTgdCxwjhBBno4mtZYvnODPJu1"===e.uid?(0,a.jsx)(c.nf,{to:"/homemng",children:" \ud648\ud398\uc774\uc9c0 \uad00\ub9ac"}):"";return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h3",{children:t.title}),"\uc0ac\uc774\ub4dc \uba54\ub274\uc5d0\uc11c",(0,a.jsx)(o.ZP,{disableElevation:!0,fullWidth:!0,type:"button",variant:"outlined",color:"success",onClick:function(){return t.onNewMemoBtn(),!1},children:"\uc0c8\uae00"}),"\ubc84\ud2bc\uc744 \uc0ac\uc6a9\ud574 \uba54\ubaa8\ub97c \uc791\uc131\ud569\ub2c8\ub2e4.",n]})},l=s}}]);