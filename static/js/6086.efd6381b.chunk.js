"use strict";(self.webpackChunksiny_memo=self.webpackChunksiny_memo||[]).push([[6086,7652],{3424:(e,t,n)=>{n.r(t),n.d(t,{default:()=>q});var o=n(16491),s=n(59749),i=n(39751),r=n(9950),l=n(28429),a=n(9798),c=n(64127),m=n(32920),d=n(26232),u=n(65746),h=n(8542),x=n(85881),g=n(9519),f=n(15568),j=n(54562),w=n(98497),y=n(76660),b=n(7652),p=n(23730),v=n(46639),A=n(19808),M=n(7041),$=n(44414);const S=e=>(0,$.jsxs)(o.A,{sx:{flexGrow:1,my:2,width:"100%",display:"flex",flexDirection:"row",alignItems:"center",alignContent:"center",justifyContent:"center",textAlign:"center"},children:[(0,$.jsx)(M.Ay,{type:"button",size:"small",variant:"outlined",color:"success",onClick:e.onEdit,children:"\uc218\uc815"}),(0,$.jsx)(M.Ay,{type:"button",size:"small",variant:"outlined",onClick:e.onNewMemo,children:"\uc0c8\uae00"}),(0,$.jsx)(M.Ay,{type:"button",size:"small",variant:"outlined",color:"warning",onClick:e.onMove,children:"\uc774\ub3d9"}),(0,$.jsx)(M.Ay,{type:"button",size:"small",variant:"outlined",color:"error",onClick:e.onDelete,children:"\uc0ad\uc81c"})]});var C=n(45184),k=n(1574),I=n(97834),R=n(15265),_=n(10611),D=n(86608),N=(n(48992),n(86635)),H=n(11298),E=n(53743);const F=e=>{const{title:t,gbn:n,date:s,text:i,image:c,setFireId:m,isLoading:u,onReload:f}=(0,_.x)(),[j,w]=(0,r.useState)(!1),[y,b]=(0,r.useState)(!1),M=(0,l.Zp)(),F=(0,r.useRef)(),L=(0,r.useRef)();L.current=e.searchWord;const{homeId:q}=(0,l.g)(),G=`${n.current}/sub/${q}`;console.log("HomeMngDetail.fullIndex=",G);const{user:W}=(0,g.b)(),{settings:z,saveSettings:B}=(0,D.t)();return(0,r.useEffect)(()=>{B({...z,nodeId:q}),w(!1),m(`home_txt/${q}`,`home/${q}`,L.current)},[q,W]),(0,r.useEffect)(()=>{null!==i&&document.querySelectorAll("pre").forEach(e=>{e.innerHTML=(0,E.L)(e.innerHTML)})},[i]),""===q||void 0===W?(0,$.jsx)($.Fragment,{}):(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(R.O,{children:t.current}),(0,$.jsx)(r.Suspense,{fallback:(0,$.jsx)(a.R,{}),children:(0,$.jsxs)(A.A,{className:"container",sx:{p:0,width:"100%"},children:[!j&&(0,$.jsx)(S,{onEdit:()=>{F.current=!1,!1===u&&w(!0)},onNewMemo:()=>{F.current=!0,!1===u&&w(!0)},onMove:()=>{b(!0)},onDelete:()=>{window.confirm("\ud558\uc704 \uc790\ub8cc\uac00 \uc788\ub294 \uacbd\uc6b0 \uac19\uc774 \uc0ad\uc81c\ub429\ub2c8\ub2e4.\n\uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&(async()=>{console.log("handleDelete.homeId=",q);const e=`home_txt/${q}`,t=await(0,H.Zz)(e,"home");console.log("handleDelete.result=",t),void 0!==t?M("/homemng"):alert("\uc0ad\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.[code:d02]")})()}}),j&&(0,$.jsx)(d.A,{newMode:F.current,onPostSubmit:async(e,t,n)=>{const o="home";if(await(0,H.Q9)("home_txt",o,q,t),await(0,H.y1)(q,"home_txt/","home/",G,e),await(0,H.F)("home_txt","home",q,n),void 0===G){const t=await(0,h.eC)(`${o}fullIndex`);void 0!==t&&await(0,p.hZ)((0,p.KR)(x.mr,`home/${t}/title`),e.edTitle)}F.current=!1,w(!1),f()},onNewSubmit:async(e,t)=>{const n=await(0,H.y1)(void 0,"home_txt/","home/",e.edGbn,e);console.log("onNewSubmit.newKey=",n,", homeId=",q);const o=await(0,H.F)("home_txt","home",n,t);console.log("onNewSubmit.imageResult",o),void 0!==n&&M(`/homemng/${n}`),F.current=!1,w(!1),f()},onCancel:()=>{w(!1)},title:t.current,gbn:n.current,date:s.current,content:i,imageList:c}),(0,$.jsxs)(o.A,{sx:{my:2,overflow:"hidden",overflowX:"auto"},children:[n.current,(0,$.jsx)(C.t,{show:!j,text:i}),!j&&(0,$.jsx)(I.P,{imageList:c}),u&&(0,$.jsx)(o.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:(0,$.jsx)(v.A,{sx:{mt:5}})})]}),(0,$.jsx)(k.T,{userId:W.uid,open:y,data:e.data,onClose:()=>b(!1),onPost:async e=>{try{const t="home",o=await(0,H._1)(t,n.current,q,e);console.log("onMoveSubmit.result=",o)}catch(t){}finally{b(!1)}}})]})}),(0,$.jsx)(N.n,{})]})};var L=n(9343);const q=()=>{const e=(0,l.Zp)(),{user:t}=(0,g.b)(),[n,p]=(0,r.useState)(!1),v=(0,r.useRef)(),[A]=(0,f.U)("home"),[M,S]=(0,r.useState)(""),C=(0,r.useRef)();(0,r.useEffect)(()=>{},[t]);const k=()=>{p(!0)},I=async(e,n)=>{const o=`home_txt/${t.uid}/`;for(let t=0;t<n.length;t++){const e=n[t].object,r=(0,w.A)(e.name),l={ext:r,name:e.name,use:"Y"},a=(0,s.VC)((0,s.jf)((0,s.KR)(x.mr),o+"image")).key;(0,s.hZ)((0,s.KR)(x.mr,o+`image/${a}`),l);const c=await(0,i.KR)(x.Pf,`home/${M}/${a}.${r}`);await(0,i.D)(c,e)}const r=(0,h.Og)(o),l={title:e.edTitle,date:e.edDate,gbn:e.edGbn,memo:e.content,fullIndex:r,up:r,bookmark:"N"};(0,h.fq)(`${o}${r}`,l);const a={gbn:"",property:"m",title:e.title,up:r};(0,h.fq)(`home/${r}`,a),p(!1)},{height:R,width:_}=(0,y.A)();if(!t)return(0,$.jsx)($.Fragment,{});t.uid!==L.q3&&e("/");const D=(0,$.jsxs)(o.A,{sx:{minHeight:110,flexGrow:1,minWidth:100,maxHeight:R},children:[(0,$.jsx)(m.G,{}),(0,$.jsx)(c._,{onNewMemoBtn:k,onSearchDataBtn:e=>{v.current=e}}),(0,$.jsx)(o.A,{sx:{flexGrow:1,minWidth:100,minHeight:110,maxHeight:R-220,height:R-220},children:(0,$.jsx)(r.Suspense,{fallback:(0,$.jsx)(a.R,{}),children:(0,$.jsx)(u.A,{data:A,onDetail:(t,n)=>{C.current=n,S(t),e(`/homemng/${t}`,{state:{fullIndex:n}})},maxHeight:R-150})})})]});return(0,$.jsxs)(j.i,{title:"\ud648 \uad00\ub9ac",drawerWidth:320,width:_,sideContents:D,children:[(0,$.jsxs)(l.BV,{children:[(0,$.jsx)(l.qh,{path:"/",element:(0,$.jsx)(b.MemoMain,{searchWord:v.current,data:A,onNewMemoBtn:k,title:"\ud648\ud398\uc774\uc9c0 \uad00\ub9ac"})}),(0,$.jsx)(l.qh,{path:"/:homeId",element:(0,$.jsx)(F,{searchWord:v.current,data:A})})]}),n&&(0,$.jsx)(d.A,{show:n,newMode:n.current,onPostSubmit:I,onNewSubmit:I,onCancel:()=>{p(!1)},title:"",content:"",imageList:[]})]})}},7652:(e,t,n)=>{n.r(t),n.d(t,{MemoMain:()=>i,default:()=>r});var o=n(7041),s=n(44414);const i=e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{children:e.title}),"\uc0ac\uc774\ub4dc \uba54\ub274\uc5d0\uc11c",(0,s.jsx)(o.Ay,{disableElevation:!0,type:"button",variant:"outlined",color:"success",onClick:function(){return e.onNewMemoBtn(),!1},children:"\uc0c8\uae00"}),"\ubc84\ud2bc\uc744 \uc0ac\uc6a9\ud574 \uba54\ubaa8\ub97c \uc791\uc131\ud569\ub2c8\ub2e4."]}),r=i}}]);